{
  "hash": "1d0c9182ea51b83bb2ccc6bd04233bdf",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"YUIMA 入門\"\nauthor: \"司馬博文\"\ndate: 5/17/2024\ndate-modified: 9/17/2024\ncategories: [Stan, R, YUIMA, Process]\nbibliography: \n    - ../../../assets/mathematics.bib\n    - ../../../assets/bib.bib\n    - ../../../assets/bib1.bib\n    - YUIMA.bib\ncsl: ../../../assets/apalike.csl\nabstract-title: 概要\nabstract: R パッケージ `yuima` は確率過程のモデリングとその統計推測を可能にするフレームワークです．従来の i.i.d. 仮定の下での統計推測から，一般の確率過程の統計推測への橋渡しを目標としています．鋭意開発中のパッケージですが，すでに広範なクラスの確率微分方程式のシミュレーションが可能です．本稿では基本的な使い方を紹介します．\nexecute:\n  cache: true\ncode-fold: false\ncode-overflow: wrap\nlisting: \n  -   id: lst-yuima\n      type: grid\n      sort: false\n      contents:\n          - YUIMA1.qmd\n          - YUIMA2.qmd\n          - adastan.qmd\n      date-format: iso\n      fields: [title,image,date,subtitle]\n---\n::: {.hidden}\n\n::: {.content-visible when-format=\"html\"}\n\nA Blog Entry on Bayesian Computation by an Applied Mathematician\n\n$$\n\n\\renewcommand{\\P}{\\operatorname{P}}\\newcommand{\\E}{\\operatorname{E}}\n\\newcommand{\\R}{\\mathbb{R}}\\newcommand{\\F}{\\mathcal{F}}\n\\newcommand{\\abs}[1]{\\lvert#1\\rvert}\\newcommand{\\Abs}[1]{\\left|#1\\right|}\\newcommand{\\ABs}[1]{\\biggl|#1\\biggr|}\\newcommand{\\norm}[1]{\\|#1\\|}\\newcommand{\\Norm}[1]{\\left\\|#1\\right\\|}\\newcommand{\\NOrm}[1]{\\biggl\\|#1\\biggr\\|}\\newcommand{\\Brace}[1]{\\left\\{#1\\right\\}}\\newcommand{\\BRace}[1]{\\biggl\\{#1\\biggr\\}}\\newcommand{\\paren}[1]{\\left(#1\\right)}\\newcommand{\\Paren}[1]{\\biggr(#1\\biggl)}\\newcommand{\\brac}[1]{\\langle#1\\rangle}\\newcommand{\\Brac}[1]{\\left\\langle#1\\right\\rangle}\\newcommand{\\BRac}[1]{\\biggl\\langle#1\\biggr\\rangle}\\newcommand{\\bra}[1]{\\left\\langle#1\\right|}\\newcommand{\\ket}[1]{\\left|#1\\right\\rangle}\\newcommand{\\Square}[1]{\\left[#1\\right]}\\newcommand{\\SQuare}[1]{\\biggl[#1\\biggr]}\\newcommand{\\rN}{\\mathrm{N}}\\newcommand{\\ov}[1]{\\overline{#1}}\\newcommand{\\un}[1]{\\underline{#1}}\\newcommand{\\wt}[1]{\\widetilde{#1}}\\newcommand{\\wh}[1]{\\widehat{#1}}\\newcommand{\\pp}[2]{\\frac{\\partial #1}{\\partial #2}}\\newcommand{\\ppp}[3]{\\frac{\\partial #1}{\\partial #2\\partial #3}}\\newcommand{\\dd}[2]{\\frac{d #1}{d #2}}\\newcommand{\\floor}[1]{\\lfloor#1\\rfloor}\\newcommand{\\Floor}[1]{\\left\\lfloor#1\\right\\rfloor}\\newcommand{\\ceil}[1]{\\lceil#1\\rceil}\\newcommand{\\ocinterval}[1]{(#1]}\\newcommand{\\cointerval}[1]{[#1)}\\newcommand{\\COinterval}[1]{\\left[#1\\right)}\\newcommand{\\iso}{\\overset{\\sim}{\\to}}\n\n\n\n\\newcommand{\\y}{\\b{y}}\\newcommand{\\mi}{\\,|\\,}\\newcommand{\\Mark}{\\mathrm{Mark}}\n\\newcommand{\\argmax}{\\operatorname*{argmax}}\\newcommand{\\argmin}{\\operatorname*{argmin}}\n\n\\newcommand{\\pr}{\\mathrm{pr}}\\newcommand{\\Conv}{\\operatorname{Conv}}\\newcommand{\\cU}{\\mathcal{U}}\n\\newcommand{\\Map}{\\mathrm{Map}}\\newcommand{\\dom}{\\mathrm{Dom}\\;}\\newcommand{\\cod}{\\mathrm{Cod}\\;}\\newcommand{\\supp}{\\mathrm{supp}\\;}\n\\newcommand{\\grad}{\\operatorname{grad}}\\newcommand{\\rot}{\\operatorname{rot}}\\renewcommand{\\div}{\\operatorname{div}}\\newcommand{\\tr}{\\operatorname{tr}}\\newcommand{\\Tr}{\\operatorname{Tr}}\\newcommand{\\KL}{\\operatorname{KL}}\\newcommand{\\JS}{\\operatorname{JS}}\\newcommand{\\ESS}{\\operatorname{ESS}}\\newcommand{\\MSE}{\\operatorname{MSE}}\\newcommand{\\erf}{\\operatorname{erf}}\\newcommand{\\arctanh}{\\operatorname{arctanh}}\\newcommand{\\pl}{\\operatorname{pl}}\\newcommand{\\minimize}{\\operatorname{minimize}}\\newcommand{\\subjectto}{\\operatorname{subject to}}\\newcommand{\\sinc}{\\operatorname{sinc}}\\newcommand{\\Ent}{\\operatorname{Ent}}\\newcommand{\\Polya}{\\operatorname{Polya}}\\newcommand{\\Exp}{\\operatorname{Exp}}\\newcommand{\\codim}{\\operatorname{codim}}\\newcommand{\\sgn}{\\operatorname{sgn}}\\newcommand{\\rank}{\\operatorname{rank}}\n\n\\newcommand{\\vctr}[2]{\\begin{pmatrix}#1\\\\#2\\end{pmatrix}}\\newcommand{\\vctrr}[3]{\\begin{pmatrix}#1\\\\#2\\\\#3\\end{pmatrix}}\\newcommand{\\mtrx}[4]{\\begin{pmatrix}#1&#2\\\\#3&#4\\end{pmatrix}}\\newcommand{\\smtrx}[4]{\\paren{\\begin{smallmatrix}#1&#2\\\\#3&#4\\end{smallmatrix}}}\\newcommand{\\Ker}{\\mathrm{Ker}\\;}\\newcommand{\\Coker}{\\mathrm{Coker}\\;}\\newcommand{\\Coim}{\\mathrm{Coim}\\;}\\newcommand{\\lcm}{\\mathrm{lcm}}\\newcommand{\\GL}{\\mathrm{GL}}\\newcommand{\\SL}{\\mathrm{SL}}\\newcommand{\\alt}{\\mathrm{alt}}\n\n\\renewcommand{\\Re}{\\mathrm{Re}\\;}\\renewcommand{\\Im}{\\mathrm{Im}\\,}\\newcommand{\\Gal}{\\mathrm{Gal}}\\newcommand{\\PGL}{\\mathrm{PGL}}\\newcommand{\\PSL}{\\mathrm{PSL}}\\newcommand{\\Log}{\\mathrm{Log}\\,}\\newcommand{\\Res}{\\mathrm{Res}\\,}\\newcommand{\\on}{\\mathrm{on}\\;}\\newcommand{\\hatC}{\\widehat{\\C}}\\newcommand{\\hatR}{\\hat{\\R}}\\newcommand{\\PV}{\\mathrm{P.V.}}\\newcommand{\\diam}{\\mathrm{diam}}\\newcommand{\\Area}{\\mathrm{Area}}\\newcommand{\\Lap}{\\Laplace}\\newcommand{\\f}{\\mathbf{f}}\\newcommand{\\cR}{\\mathcal{R}}\\newcommand{\\const}{\\mathrm{const.}}\\newcommand{\\Om}{\\Omega}\\newcommand{\\Cinf}{C^\\infty}\\newcommand{\\ep}{\\epsilon}\\newcommand{\\dist}{\\mathrm{dist}}\\newcommand{\\opart}{\\o{\\partial}}\\newcommand{\\Length}{\\mathrm{Length}}\n\n\\newcommand{\\cA}{\\mathcal{A}}\\newcommand{\\cO}{\\mathcal{O}}\\newcommand{\\cW}{\\mathcal{W}}\\renewcommand{\\O}{\\mathcal{O}}\\renewcommand{\\S}{\\mathcal{S}}\\newcommand{\\U}{\\mathcal{U}}\\newcommand{\\V}{\\mathrm{V}}\\newcommand{\\N}{\\mathbb{N}}\\newcommand{\\bN}{\\mathbb{N}}\\newcommand{\\C}{\\mathrm{C}}\\newcommand{\\bC}{\\mathbb{C}}\\newcommand{\\Z}{\\mathcal{Z}}\\newcommand{\\Q}{\\mathbb{Q}}\\newcommand{\\bQ}{\\mathbb{Q}}\\newcommand{\\TV}{\\mathrm{TV}}\\newcommand{\\ORD}{\\mathrm{ORD}}\\newcommand{\\Card}{\\mathrm{Card}\\,}\\newcommand{\\Top}{\\mathrm{Top}}\\newcommand{\\Disc}{\\mathrm{Disc}}\\newcommand{\\Codisc}{\\mathrm{Codisc}}\\newcommand{\\CoDisc}{\\mathrm{CoDisc}}\\newcommand{\\Ult}{\\mathrm{Ult}}\\newcommand{\\ord}{\\mathrm{ord}}\\newcommand{\\bS}{\\mathbb{S}}\\newcommand{\\PConn}{\\mathrm{PConn}}\\newcommand{\\mult}{\\mathrm{mult}}\\newcommand{\\inv}{\\mathrm{inv}}\n\n\\newcommand{\\Der}{\\mathrm{Der}}\\newcommand{\\osub}{\\overset{\\mathrm{open}}{\\subset}}\\newcommand{\\osup}{\\overset{\\mathrm{open}}{\\supset}}\\newcommand{\\al}{\\alpha}\\newcommand{\\K}{\\mathbb{K}}\\newcommand{\\Sp}{\\mathrm{Sp}}\\newcommand{\\g}{\\mathfrak{g}}\\newcommand{\\h}{\\mathfrak{h}}\\newcommand{\\Imm}{\\mathrm{Imm}}\\newcommand{\\Imb}{\\mathrm{Imb}}\\newcommand{\\Gr}{\\mathrm{Gr}}\n\n\\newcommand{\\Ad}{\\mathrm{Ad}}\\newcommand{\\finsupp}{\\mathrm{fin\\;supp}}\\newcommand{\\SO}{\\mathrm{SO}}\\newcommand{\\SU}{\\mathrm{SU}}\\newcommand{\\acts}{\\curvearrowright}\\newcommand{\\mono}{\\hookrightarrow}\\newcommand{\\epi}{\\twoheadrightarrow}\\newcommand{\\Stab}{\\mathrm{Stab}}\\newcommand{\\nor}{\\mathrm{nor}}\\newcommand{\\T}{\\mathbb{T}}\\newcommand{\\Aff}{\\mathrm{Aff}}\\newcommand{\\rsup}{\\triangleright}\\newcommand{\\subgrp}{\\overset{\\mathrm{subgrp}}{\\subset}}\\newcommand{\\Ext}{\\mathrm{Ext}}\\newcommand{\\sbs}{\\subset}\\newcommand{\\sps}{\\supset}\\newcommand{\\In}{\\mathrm{in}\\;}\\newcommand{\\Tor}{\\mathrm{Tor}}\\newcommand{\\p}{\\b{p}}\\newcommand{\\q}{\\mathfrak{q}}\\newcommand{\\m}{\\mathfrak{m}}\\newcommand{\\cS}{\\mathcal{S}}\\newcommand{\\Frac}{\\mathrm{Frac}\\,}\\newcommand{\\Spec}{\\mathrm{Spec}\\,}\\newcommand{\\bA}{\\mathbb{A}}\\newcommand{\\Sym}{\\mathrm{Sym}}\\newcommand{\\Ann}{\\mathrm{Ann}}\\newcommand{\\Her}{\\mathrm{Her}}\\newcommand{\\Bil}{\\mathrm{Bil}}\\newcommand{\\Ses}{\\mathrm{Ses}}\\newcommand{\\FVS}{\\mathrm{FVS}}\n\n\\newcommand{\\Ho}{\\mathrm{Ho}}\\newcommand{\\CW}{\\mathrm{CW}}\\newcommand{\\lc}{\\mathrm{lc}}\\newcommand{\\cg}{\\mathrm{cg}}\\newcommand{\\Fib}{\\mathrm{Fib}}\\newcommand{\\Cyl}{\\mathrm{Cyl}}\\newcommand{\\Ch}{\\mathrm{Ch}}\n\\newcommand{\\rP}{\\mathrm{P}}\\newcommand{\\rE}{\\mathrm{E}}\\newcommand{\\e}{\\b{e}}\\renewcommand{\\k}{\\b{k}}\\newcommand{\\Christ}[2]{\\begin{Bmatrix}#1\\\\#2\\end{Bmatrix}}\\renewcommand{\\Vec}[1]{\\overrightarrow{\\mathrm{#1}}}\\newcommand{\\hen}[1]{\\mathrm{#1}}\\renewcommand{\\b}[1]{\\boldsymbol{#1}}\n\n\\newcommand{\\Inc}{\\mathrm{Inc}}\\newcommand{\\aInc}{\\mathrm{aInc}}\\newcommand{\\HS}{\\mathrm{HS}}\\newcommand{\\loc}{\\mathrm{loc}}\\newcommand{\\Lh}{\\mathrm{L.h.}}\\newcommand{\\Epi}{\\mathrm{Epi}}\\newcommand{\\slim}{\\mathrm{slim}}\\newcommand{\\Ban}{\\mathrm{Ban}}\\newcommand{\\Hilb}{\\mathrm{Hilb}}\\newcommand{\\Ex}{\\mathrm{Ex}}\\newcommand{\\Co}{\\mathrm{Co}}\\newcommand{\\sa}{\\mathrm{sa}}\\newcommand{\\nnorm}[1]{{\\left\\vert\\kern-0.25ex\\left\\vert\\kern-0.25ex\\left\\vert #1 \\right\\vert\\kern-0.25ex\\right\\vert\\kern-0.25ex\\right\\vert}}\\newcommand{\\dvol}{\\mathrm{dvol}}\\newcommand{\\Sconv}{\\mathrm{Sconv}}\\newcommand{\\I}{\\mathcal{I}}\\newcommand{\\nonunital}{\\mathrm{nu}}\\newcommand{\\cpt}{\\mathrm{cpt}}\\newcommand{\\lcpt}{\\mathrm{lcpt}}\\newcommand{\\com}{\\mathrm{com}}\\newcommand{\\Haus}{\\mathrm{Haus}}\\newcommand{\\proper}{\\mathrm{proper}}\\newcommand{\\infinity}{\\mathrm{inf}}\\newcommand{\\TVS}{\\mathrm{TVS}}\\newcommand{\\ess}{\\mathrm{ess}}\\newcommand{\\ext}{\\mathrm{ext}}\\newcommand{\\Index}{\\mathrm{Index}\\;}\\newcommand{\\SSR}{\\mathrm{SSR}}\\newcommand{\\vs}{\\mathrm{vs.}}\\newcommand{\\fM}{\\mathfrak{M}}\\newcommand{\\EDM}{\\mathrm{EDM}}\\newcommand{\\Tw}{\\mathrm{Tw}}\\newcommand{\\fC}{\\mathfrak{C}}\\newcommand{\\bn}{\\boldsymbol{n}}\\newcommand{\\br}{\\boldsymbol{r}}\\newcommand{\\Lam}{\\Lambda}\\newcommand{\\lam}{\\lambda}\\newcommand{\\one}{\\mathbf{1}}\\newcommand{\\dae}{\\text{-a.e.}}\\newcommand{\\das}{\\text{-a.s.}}\\newcommand{\\td}{\\text{-}}\\newcommand{\\RM}{\\mathrm{RM}}\\newcommand{\\BV}{\\mathrm{BV}}\\newcommand{\\normal}{\\mathrm{normal}}\\newcommand{\\lub}{\\mathrm{lub}\\;}\\newcommand{\\Graph}{\\mathrm{Graph}}\\newcommand{\\Ascent}{\\mathrm{Ascent}}\\newcommand{\\Descent}{\\mathrm{Descent}}\\newcommand{\\BIL}{\\mathrm{BIL}}\\newcommand{\\fL}{\\mathfrak{L}}\\newcommand{\\De}{\\Delta}\n\n\\newcommand{\\calA}{\\mathcal{A}}\\newcommand{\\calB}{\\mathcal{B}}\\newcommand{\\D}{\\mathcal{D}}\\newcommand{\\Y}{\\mathcal{Y}}\\newcommand{\\calC}{\\mathcal{C}}\\renewcommand{\\ae}{\\mathrm{a.e.}\\;}\\newcommand{\\cZ}{\\mathcal{Z}}\\newcommand{\\fF}{\\mathfrak{F}}\\newcommand{\\fI}{\\mathfrak{I}}\\newcommand{\\rV}{\\mathrm{V}}\\newcommand{\\cE}{\\mathcal{E}}\\newcommand{\\sMap}{\\sigma\\textrm{-}\\mathrm{Map}}\\newcommand{\\cC}{\\mathcal{C}}\\newcommand{\\comp}{\\complement}\\newcommand{\\J}{\\mathcal{J}}\\newcommand{\\sumN}[1]{\\sum_{#1\\in\\N}}\\newcommand{\\cupN}[1]{\\cup_{#1\\in\\N}}\\newcommand{\\capN}[1]{\\cap_{#1\\in\\N}}\\newcommand{\\Sum}[1]{\\sum_{#1=1}^\\infty}\\newcommand{\\sumn}{\\sum_{n=1}^\\infty}\\newcommand{\\summ}{\\sum_{m=1}^\\infty}\\newcommand{\\sumk}{\\sum_{k=1}^\\infty}\\newcommand{\\sumi}{\\sum_{i=1}^\\infty}\\newcommand{\\sumj}{\\sum_{j=1}^\\infty}\\newcommand{\\cupn}{\\cup_{n=1}^\\infty}\\newcommand{\\capn}{\\cap_{n=1}^\\infty}\\newcommand{\\cupk}{\\cup_{k=1}^\\infty}\\newcommand{\\cupi}{\\cup_{i=1}^\\infty}\\newcommand{\\cupj}{\\cup_{j=1}^\\infty}\\newcommand{\\limn}{\\lim_{n\\to\\infty}}\\renewcommand{\\L}{\\mathcal{L}}\\newcommand{\\cL}{\\mathcal{L}}\\newcommand{\\Cl}{\\mathrm{Cl}}\\newcommand{\\cN}{\\mathcal{N}}\\newcommand{\\Ae}{\\textrm{-a.e.}\\;}\\renewcommand{\\csub}{\\overset{\\textrm{closed}}{\\subset}}\\renewcommand{\\csup}{\\overset{\\textrm{closed}}{\\supset}}\\newcommand{\\wB}{\\wt{B}}\\newcommand{\\cG}{\\mathcal{G}}\\newcommand{\\Lip}{\\mathrm{Lip}}\\newcommand{\\AC}{\\mathrm{AC}}\\newcommand{\\Mol}{\\mathrm{Mol}}\n\n\\newcommand{\\Pe}{\\mathrm{Pe}}\\newcommand{\\wR}{\\wh{\\mathbb{\\R}}}\\newcommand*{\\Laplace}{\\mathop{}\\!\\mathbin\\bigtriangleup}\\newcommand*{\\DAlambert}{\\mathop{}\\!\\mathbin\\Box}\\newcommand{\\bT}{\\mathbb{T}}\\newcommand{\\dx}{\\dslash x}\\newcommand{\\dt}{\\dslash t}\\newcommand{\\ds}{\\dslash s}\n\n\\newcommand{\\round}{\\mathrm{round}}\\newcommand{\\cond}{\\mathrm{cond}}\\newcommand{\\diag}{\\mathrm{diag}}\n\\newcommand{\\Adj}{\\mathrm{Adj}}\\newcommand{\\Pf}{\\mathrm{Pf}}\\newcommand{\\Sg}{\\mathrm{Sg}}\n\n\n\\newcommand{\\aseq}{\\overset{\\text{a.s.}}{=}}\\newcommand{\\deq}{\\overset{\\text{d}}{=}}\\newcommand{\\cV}{\\mathcal{V}}\\newcommand{\\FM}{\\mathrm{FM}}\\newcommand{\\KR}{\\mathrm{KR}}\\newcommand{\\rba}{\\mathrm{rba}}\\newcommand{\\rca}{\\mathrm{rca}}\\newcommand{\\Prob}{\\mathrm{Prob}}\\newcommand{\\X}{\\mathcal{X}}\\newcommand{\\Meas}{\\mathrm{Meas}}\\newcommand{\\as}{\\;\\text{a.s.}}\\newcommand{\\io}{\\;\\mathrm{i.o.}}\\newcommand{\\fe}{\\;\\text{f.e.}}\\newcommand{\\bF}{\\mathbb{F}}\\newcommand{\\W}{\\mathcal{W}}\\newcommand{\\Pois}{\\mathrm{Pois}}\\newcommand{\\iid}{\\text{i.i.d.}}\\newcommand{\\wconv}{\\rightsquigarrow}\\newcommand{\\Var}{\\mathrm{Var}}\\newcommand{\\xrightarrown}{\\xrightarrow{n\\to\\infty}}\\newcommand{\\au}{\\mathrm{au}}\\newcommand{\\cT}{\\mathcal{T}}\\newcommand{\\wto}{\\overset{\\text{w}}{\\to}}\\newcommand{\\dto}{\\overset{\\text{d}}{\\to}}\\newcommand{\\sto}{\\overset{\\text{s}}{\\to}}\\newcommand{\\pto}{\\overset{\\text{p}}{\\to}}\\newcommand{\\mto}{\\overset{\\text{m}}{\\to}}\\newcommand{\\vto}{\\overset{v}{\\to}}\\newcommand{\\Cont}{\\mathrm{Cont}}\\newcommand{\\stably}{\\mathrm{stably}}\\newcommand{\\Np}{\\mathbb{N}^+}\\newcommand{\\oM}{\\overline{\\mathcal{M}}}\\newcommand{\\fP}{\\mathfrak{P}}\\newcommand{\\sign}{\\mathrm{sign}}\n\\newcommand{\\Borel}{\\mathrm{Borel}}\\newcommand{\\Mid}{\\,|\\,}\\newcommand{\\middleMid}{\\;\\middle|\\;}\\newcommand{\\CP}{\\mathrm{CP}}\\newcommand{\\bD}{\\mathbb{D}}\\newcommand{\\bL}{\\mathbb{L}}\\newcommand{\\fW}{\\mathfrak{W}}\\newcommand{\\DL}{\\mathcal{D}\\mathcal{L}}\\renewcommand{\\r}[1]{\\mathrm{#1}}\\newcommand{\\rC}{\\mathrm{C}}\\newcommand{\\qqquad}{\\qquad\\quad}\n\n\\newcommand{\\bit}{\\mathrm{bit}}\n\n\\newcommand{\\err}{\\mathrm{err}}\n\n\\newcommand{\\varparallel}{\\mathbin{\\!/\\mkern-5mu/\\!}}\\newcommand{\\Ri}{\\mathrm{Ri}}\\newcommand{\\Cone}{\\mathrm{Cone}}\\newcommand{\\Int}{\\mathrm{Int}}\n\n\\newcommand{\\pre}{\\mathrm{pre}}\\newcommand{\\om}{\\omega}\n\n\n\\newcommand{\\del}{\\partial}\n\\newcommand{\\LHS}{\\mathrm{LHS}}\\newcommand{\\RHS}{\\mathrm{RHS}}\\newcommand{\\bnu}{\\boldsymbol{\\nu}}\\newcommand{\\interior}{\\mathrm{in}\\;}\\newcommand{\\SH}{\\mathrm{SH}}\\renewcommand{\\v}{\\boldsymbol{\\nu}}\\newcommand{\\n}{\\mathbf{n}}\\newcommand{\\ssub}{\\Subset}\\newcommand{\\curl}{\\mathrm{curl}}\n\n\\newcommand{\\Ei}{\\mathrm{Ei}}\\newcommand{\\sn}{\\mathrm{sn}}\\newcommand{\\wgamma}{\\widetilde{\\gamma}}\n\n\\newcommand{\\Ens}{\\mathrm{Ens}}\n\n\\newcommand{\\cl}{\\mathrm{cl}}\\newcommand{\\x}{\\boldsymbol{x}}\n\n\\newcommand{\\Do}{\\mathrm{Do}}\\newcommand{\\IV}{\\mathrm{IV}}\n\n\\newcommand{\\AIC}{\\mathrm{AIC}}\\newcommand{\\mrl}{\\mathrm{mrl}}\\newcommand{\\dotx}{\\dot{x}}\\newcommand{\\UMV}{\\mathrm{UMV}}\\newcommand{\\BLU}{\\mathrm{BLU}}\n\n\\newcommand{\\comb}[2]{\\begin{pmatrix}#1\\\\#2\\end{pmatrix}}\\newcommand{\\bP}{\\mathbb{P}}\\newcommand{\\compsub}{\\overset{\\textrm{cpt}}{\\subset}}\\newcommand{\\lip}{\\textrm{lip}}\\newcommand{\\BL}{\\mathrm{BL}}\\newcommand{\\G}{\\mathbb{G}}\\newcommand{\\NB}{\\mathrm{NB}}\\newcommand{\\oR}{\\ov{\\R}}\\newcommand{\\liminfn}{\\liminf_{n\\to\\infty}}\\newcommand{\\limsupn}{\\limsup_{n\\to\\infty}}\\newcommand{\\esssup}{\\mathrm{ess.sup}}\\newcommand{\\asto}{\\xrightarrow{\\as}}\\newcommand{\\Cov}{\\mathrm{Cov}}\\newcommand{\\cQ}{\\mathcal{Q}}\\newcommand{\\VC}{\\mathrm{VC}}\\newcommand{\\mb}{\\mathrm{mb}}\\newcommand{\\Avar}{\\mathrm{Avar}}\\newcommand{\\bB}{\\mathbb{B}}\\newcommand{\\bW}{\\mathbb{W}}\\newcommand{\\sd}{\\mathrm{sd}}\\newcommand{\\w}[1]{\\widehat{#1}}\\newcommand{\\bZ}{\\mathbb{Z}}\\newcommand{\\Bernoulli}{\\mathrm{Ber}}\\newcommand{\\Ber}{\\mathrm{Ber}}\\newcommand{\\Mult}{\\mathrm{Mult}}\\newcommand{\\BPois}{\\mathrm{BPois}}\\newcommand{\\fraks}{\\mathfrak{s}}\\newcommand{\\frakk}{\\mathfrak{k}}\\newcommand{\\IF}{\\mathrm{IF}}\\newcommand{\\bX}{\\boldsymbol{X}}\\newcommand{\\bx}{\\boldsymbol{x}}\\newcommand{\\indep}{\\perp\\!\\!\\!\\perp}\\newcommand{\\IG}{\\mathrm{IG}}\\newcommand{\\Levy}{\\mathrm{Levy}}\\newcommand{\\MP}{\\mathrm{MP}}\\newcommand{\\Hermite}{\\mathrm{Hermite}}\\newcommand{\\Skellam}{\\mathrm{Skellam}}\\newcommand{\\Dirichlet}{\\mathrm{Dirichlet}}\\renewcommand{\\Beta}{\\operatorname{Beta}}\\newcommand{\\bE}{\\mathbb{E}}\\newcommand{\\bG}{\\mathbb{G}}\\newcommand{\\MISE}{\\mathrm{MISE}}\\newcommand{\\logit}{\\mathtt{logit}}\\newcommand{\\expit}{\\mathtt{expit}}\\newcommand{\\cK}{\\mathcal{K}}\\newcommand{\\dl}{\\dot{l}}\\newcommand{\\dotp}{\\dot{p}}\\newcommand{\\wl}{\\wt{l}}\\newcommand{\\Gauss}{\\mathrm{Gauss}}\\newcommand{\\fA}{\\mathfrak{A}}\\newcommand{\\under}{\\mathrm{under}\\;}\\newcommand{\\whtheta}{\\wh{\\theta}}\\newcommand{\\Em}{\\mathrm{Em}}\\newcommand{\\ztheta}{{\\theta_0}}\n\\newcommand{\\rO}{\\mathrm{O}}\\newcommand{\\Bin}{\\mathrm{Bin}}\\newcommand{\\rW}{\\mathrm{W}}\\newcommand{\\rG}{\\mathrm{G}}\\newcommand{\\rB}{\\mathrm{B}}\\newcommand{\\rU}{\\mathrm{U}}\\newcommand{\\HG}{\\mathrm{HG}}\\newcommand{\\GAMMA}{\\mathrm{Gamma}}\\newcommand{\\Cauchy}{\\mathrm{Cauchy}}\\newcommand{\\rt}{\\mathrm{t}}\\newcommand{\\rF}{\\mathrm{F}}\n\\newcommand{\\FE}{\\mathrm{FE}}\\newcommand{\\bV}{\\boldsymbol{V}}\\newcommand{\\GLS}{\\mathrm{GLS}}\\newcommand{\\be}{\\boldsymbol{e}}\\newcommand{\\POOL}{\\mathrm{POOL}}\\newcommand{\\GMM}{\\mathrm{GMM}}\\newcommand{\\MM}{\\mathrm{MM}}\\newcommand{\\SSIV}{\\mathrm{SSIV}}\\newcommand{\\JIV}{\\mathrm{JIV}}\\newcommand{\\AR}{\\mathrm{AR}}\\newcommand{\\ILS}{\\mathrm{ILS}}\\newcommand{\\SLS}{\\mathrm{SLS}}\\newcommand{\\LIML}{\\mathrm{LIML}}\n\n\\newcommand{\\Rad}{\\mathrm{Rad}}\\newcommand{\\bY}{\\boldsymbol{Y}}\\newcommand{\\pone}{{(1)}}\\newcommand{\\ptwo}{{(2)}}\\newcommand{\\ps}[1]{{(#1)}}\\newcommand{\\fsub}{\\overset{\\text{finite}}{\\subset}}\n\n\n\\newcommand{\\varlim}{\\varprojlim}\\newcommand{\\Hom}{\\mathrm{Hom}}\\newcommand{\\Iso}{\\mathrm{Iso}}\\newcommand{\\Mor}{\\mathrm{Mor}}\\newcommand{\\Isom}{\\mathrm{Isom}}\\newcommand{\\Aut}{\\mathrm{Aut}}\\newcommand{\\End}{\\mathrm{End}}\\newcommand{\\op}{\\mathrm{op}}\\newcommand{\\ev}{\\mathrm{ev}}\\newcommand{\\Ob}{\\mathrm{Ob}}\\newcommand{\\Ar}{\\mathrm{Ar}}\\newcommand{\\Arr}{\\mathrm{Arr}}\\newcommand{\\Set}{\\mathrm{Set}}\\newcommand{\\Grp}{\\mathrm{Grp}}\\newcommand{\\Cat}{\\mathrm{Cat}}\\newcommand{\\Mon}{\\mathrm{Mon}}\\newcommand{\\Ring}{\\mathrm{Ring}}\\newcommand{\\CRing}{\\mathrm{CRing}}\\newcommand{\\Ab}{\\mathrm{Ab}}\\newcommand{\\Pos}{\\mathrm{Pos}}\\newcommand{\\Vect}{\\mathrm{Vect}}\\newcommand{\\FinVect}{\\mathrm{FinVect}}\\newcommand{\\FinSet}{\\mathrm{FinSet}}\\newcommand{\\FinMeas}{\\mathrm{FinMeas}}\\newcommand{\\OmegaAlg}{\\Omega\\text{-}\\mathrm{Alg}}\\newcommand{\\OmegaEAlg}{(\\Omega,E)\\text{-}\\mathrm{Alg}}\\newcommand{\\Fun}{\\mathrm{Fun}}\\newcommand{\\Func}{\\mathrm{Func}}\n\n\\newcommand{\\Stoch}{\\mathrm{Stoch}}\\newcommand{\\FinStoch}{\\mathrm{FinStoch}}\\newcommand{\\Copy}{\\mathrm{copy}}\\newcommand{\\Delete}{\\mathrm{delete}}\n\\newcommand{\\Bool}{\\mathrm{Bool}}\\newcommand{\\CABool}{\\mathrm{CABool}}\\newcommand{\\CompBoolAlg}{\\mathrm{CompBoolAlg}}\\newcommand{\\BoolAlg}{\\mathrm{BoolAlg}}\\newcommand{\\BoolRng}{\\mathrm{BoolRng}}\\newcommand{\\HeytAlg}{\\mathrm{HeytAlg}}\\newcommand{\\CompHeytAlg}{\\mathrm{CompHeytAlg}}\\newcommand{\\Lat}{\\mathrm{Lat}}\\newcommand{\\CompLat}{\\mathrm{CompLat}}\\newcommand{\\SemiLat}{\\mathrm{SemiLat}}\\newcommand{\\Stone}{\\mathrm{Stone}}\\newcommand{\\Mfd}{\\mathrm{Mfd}}\\newcommand{\\LieAlg}{\\mathrm{LieAlg}}\n\\newcommand{\\Op}{\\mathrm{Op}}\n\\newcommand{\\Sh}{\\mathrm{Sh}}\n\\newcommand{\\Diff}{\\mathrm{Diff}}\n\\newcommand{\\B}{\\mathcal{B}}\\newcommand{\\cB}{\\mathcal{B}}\\newcommand{\\Span}{\\mathrm{Span}}\\newcommand{\\Corr}{\\mathrm{Corr}}\\newcommand{\\Decat}{\\mathrm{Decat}}\\newcommand{\\Rep}{\\mathrm{Rep}}\\newcommand{\\Grpd}{\\mathrm{Grpd}}\\newcommand{\\sSet}{\\mathrm{sSet}}\\newcommand{\\Mod}{\\mathrm{Mod}}\\newcommand{\\SmoothMnf}{\\mathrm{SmoothMnf}}\\newcommand{\\coker}{\\mathrm{coker}}\\newcommand{\\Ord}{\\mathrm{Ord}}\\newcommand{\\eq}{\\mathrm{eq}}\\newcommand{\\coeq}{\\mathrm{coeq}}\\newcommand{\\act}{\\mathrm{act}}\n\n\\newcommand{\\apf}{\\mathrm{apf}}\\newcommand{\\opt}{\\mathrm{opt}}\\newcommand{\\IS}{\\mathrm{IS}}\\newcommand{\\IR}{\\mathrm{IR}}\\newcommand{\\iidsim}{\\overset{\\text{iid}}{\\sim}}\\newcommand{\\propt}{\\,\\propto\\,}\\newcommand{\\bM}{\\mathbb{M}}\\newcommand{\\cX}{\\mathcal{X}}\\newcommand{\\cY}{\\mathcal{Y}}\\newcommand{\\cP}{\\mathcal{P}}\\newcommand{\\ola}[1]{\\overleftarrow{#1}}\n\n\\renewcommand{\\iff}{\\;\\mathrm{iff}\\;}\n\\newcommand{\\False}{\\mathrm{False}}\\newcommand{\\True}{\\mathrm{True}}\n\\newcommand{\\otherwise}{\\mathrm{otherwise}}\n\\newcommand{\\suchthat}{\\;\\mathrm{s.t.}\\;}\n\n\\newcommand{\\cM}{\\mathcal{M}}\\newcommand{\\M}{\\mathbb{M}}\\newcommand{\\cF}{\\mathcal{F}}\\newcommand{\\cD}{\\mathcal{D}}\\newcommand{\\fX}{\\mathfrak{X}}\\newcommand{\\fY}{\\mathfrak{Y}}\\newcommand{\\fZ}{\\mathfrak{Z}}\\renewcommand{\\H}{\\mathcal{H}}\\newcommand{\\cH}{\\mathcal{H}}\\newcommand{\\fH}{\\mathfrak{H}}\\newcommand{\\bH}{\\mathbb{H}}\\newcommand{\\id}{\\mathrm{id}}\\newcommand{\\A}{\\mathcal{A}}\n\\newcommand{\\lmd}{\\lambda}\n\\newcommand{\\Lmd}{\\Lambda}\n\\newcommand{\\cI}{\\mathcal{I}}\n\n\\newcommand{\\Lrarrow}{\\;\\;\\Leftrightarrow\\;\\;}\n\\DeclareMathOperator{\\des}{des}\n\\DeclareMathOperator{\\nd}{nd}\n\\DeclareMathOperator{\\dsep}{d-sep}\n\\DeclareMathOperator{\\sep}{sep}\n\\newcommand{\\rLL}{\\mathrm{LL}}\n$$\n\n:::\n\n:::\n\n\n\n::: {#lst-yuima}\n:::\n\n## はじめに：[YUIMA](https://r-forge.r-project.org/projects/yuima/)とは？\n\nR パッケージ `yuima` は，Lévy 過程または分数 Brown 運動が駆動する確率微分方程式が定める過程という，極めて一般的なクラスの確率過程を扱うための基盤パッケージである．概観には [@Brouste+2014] が良い．\n\n加えて，シミュレーションと推論のためのメソッドが提供されている．\n\nR で通常の統計推測に用いられる [`formula` オブジェクト](R5.qmd) のように，直感的な記法でモデル（`yuima.model`オブジェクト）を定義できる．\n\n`yuima.model`オブジェクトに対して`toLatex()`関数を適用すると，モデルを LaTeX 記法で記述した文字列に変換することもできる．^[[@Brouste+2014] 第７節も参照．]\n\n::: {.callout-tip title=\"リンク集\" icon=\"false\" appearance=\"simple\"}\n\n* [R-Forge](https://r-forge.r-project.org/projects/yuima/)^[R-Forge とは，SourceForge に似た，R 言語のパッケージ開発者向けの協力的な開発環境を提供するプラットフォーム．]\n* [Stable version on CRAN](https://cran.r-project.org/package=yuima).\n* [GitHub](https://github.com/yuimaproject/yuima)\n* [yuimaGUI package](https://cran.r-project.org/web/packages/yuimaGUI/index.html)\n* [rdrr.io ページ](https://rdrr.io/rforge/yuima/)^[rdrr は CRAN や GitHub だけでなく，Bioconductor や R-Forge も含めて検索可能にしているサイト．]\n* [論文](https://www.jstatsoft.org/article/view/v057i04) [@Brouste+2014]：パッケージ開発者らによるオープンアクセス論文．\n\n:::\n\n::: {.callout-tip title=\"インストール\" icon=\"false\" appearance=\"simple\"}\n\n```r\ninstall.packages(\"yuima\", repos=\"http://R-Forge.R-project.org\")\n```\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(yuima)\n```\n:::\n\n\n```r\n??yuima  # Man pageを開く\n```\n\n:::\n\n## YUIMA の構造と `setModel()`\n\n### クラス構造\n\n各クラスのが持つスロット（上段）とメソッド（下段），そして継承関係は以下の通りである．\n\n\n```{dot}\n#| fig-cap: \"クラス構造．+ は public, - は private．\"\ndigraph ClassDiagram {\n    // クラスのスタイル設定\n    node [shape=record, fontname=Helvetica, fontsize=10];\n    \n    // クラス定義\n    yuima [label=\"{yuima|+model: yuima.model\\l+sampling: yuima.sampling\\l+data: yuima.data\\l- characteristic: yuima.characteristic\\l- functional: yuima.functional\\l|+initialize()\\l+show()\\l+plot()\\l+simulate()\\l}\"];\n    \n    yuima_model [label=\"{yuima.model|+drift: expr\\l+diffusion: expr\\l+hurst: num\\l+time_variable: chr\\l+state_variable: chr\\l+solve_variable: chr\\l- parameter: model_parameter\\l|+simulate()\\l}\"];\n    \n    yuima_sampling [label=\"{yuima.sampling|+Initial: num\\l+Terminal: num\\l+n: num\\l- delta: num\\l- grid: list[num]\\l|}\"];\n    \n    model_parameter [label=\"{model_parameter|+all: list[chr]\\l+common: chr\\l+diffusion: chr\\l+drift: chr\\l+jump: chr\\l+measure: chr\\l|}\"];\n    \n    // 関係の定義\n    yuima -> yuima_model [arrowhead=onormal];\n    yuima -> yuima_sampling [arrowhead=onormal];\n    yuima_model -> model_parameter [arrowhead=onormal];\n}\n```\n\n\n`yuima`クラスは５つのスロット `yuima.model`, `yuima.sampling`, `yuima.data`, `yuima.characteristic`, `yuima.functional` を持ち，それぞれが別のクラスとして実装されている．\n\n`model.parameter` クラスは後述の `setModel()` コンストラクタにより自動で作成され，ユーザーは変更できない．\n\n::: {.callout-important title=\"クラス構造の全貌\" collapse=\"true\" icon=\"false\"}\n\n実際には，`yuima.model` と `yuima.sampling` だけでなく，`yuima` クラスは５つの構成要素を持つ．\n\n\n```{dot}\n#| fig-cap: \"クラス構造．+ は public, - は private．\"\ndigraph ClassDiagram {\n    // クラスのスタイル設定\n    node [shape=record, fontname=Helvetica, fontsize=10];\n    \n    // クラス定義\n    yuima [label=\"{yuima|+model: yuima.model\\l+sampling: yuima.sampling\\l+data: yuima.data\\l- characteristic: yuima.characteristic\\l- functional: yuima.functional\\l|+initialize()\\l+show()\\l+plot()\\l+simulate()\\l}\"];\n    \n    yuima_model [label=\"{yuima.model|+drift: expr\\l+diffusion: expr\\l+hurst: num\\l+time_variable: chr\\l+state_variable: chr\\l+solve_variable: chr\\l- parameter: model_parameter\\l|+simulate()\\l}\"];\n    \n    yuima_sampling [label=\"{yuima.sampling|+Initial: num\\l+Terminal: num\\l+n: num\\l- delta: num\\l- grid: list[num]\\l|}\"];\n    \n    yuima_data [label=\"{yuima.data|+original_data\\l+zoo_data\\l|}\"];\n    \n    model_parameter [label=\"{model_parameter|+all: list[chr]\\l+common: chr\\l+diffusion: chr\\l+drift: chr\\l+jump: chr\\l+measure: chr\\l|}\"];\n    \n    yuima_characteristic [label=\"{yuima.characteristic|+equation_number: int\\l+time_scale: num\\l|}\"];\n    \n    yuima_functional [label=\"{yuima.functional|+F\\l+f: list\\l+xinit: num\\l+e: num\\l|}\"];\n    \n    // 関係の定義\n    yuima -> yuima_model [arrowhead=onormal];\n    yuima -> yuima_sampling [arrowhead=onormal];\n    yuima -> yuima_data [arrowhead=onormal];\n    yuima -> yuima_characteristic [arrowhead=onormal];\n    yuima -> yuima_functional [arrowhead=onormal];\n    \n    yuima_model -> model_parameter [arrowhead=onormal];\n}\n```\n\n\nそれぞれのクラスについての詳細は\n\n```r\n?yuima.model\n```\n\n```r\nisClass(\"yuima.model\")\n```\n\n```r\nmethods(class = \"yuima.model\")\n```\n\nなどの方法で確認可能．\n\n:::\n\n### `setModel()`コンストラクタ {#sec-model-constructor}\n\n[`yuima.model.R`](https://github.com/yuimaproject/yuima/blob/1bbd1291b58d07fed096a2237db7b233081d51f7/R/yuima.model.R#L118)において次の signature を持つ，`yuima.model`オブジェクトのコンストラクタである．\n\n```r\nsetModel <- function(drift=NULL, diffusion=NULL, hurst=0.5, jump.coeff=NULL, measure=list(), measure.type=character(), state.variable=\"x\", jump.variable=\"z\", time.variable=\"t\", solve.variable, xinit=NULL){...}\n```\n\nこの `setModel()` 関数により，最も一般的には次の形をした確率微分方程式が定義できる：\n\n$$\ndX_t=a(t,X_t,\\alpha)dt+b(t,X_t,\\beta)dW_t+c(t,X_t,\\gamma)dZ_t,\\qquad X_0=x_0.\n$$\n\n$W$ としては Brown 運動だけでなく，一般の Hurst 指数 $H$ を持った分数 Brown 運動 $W^H$ を取ることができる．\n\n$c\\ne0$ とすることでジャンプを導入したモデルを指定することもできる．\n\n## 例で見る YUIMA の使い方\n\n### 1次元の場合\n\nOrnstein-Uhlenbeck 過程\n$$\ndX_t=\\theta(\\mu-X_t)\\,dt+\\sigma\\,dW_t,\\quad (\\mu,\\theta,\\sigma,X_0)=(0,1,0.5,0)\n$$\nを定義してシミュレーションを実行するためのサンプルコードは次の通り．^[モデルの左辺 $dX_t$ は `yuima.model` のスロット `solve.variable` が `state.variable` に暗黙のうちに一致させているところから暗黙に読み込んでいる．]\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 確率微分方程式モデルの設定\nmodel <- setModel(drift = \"theta*(mu-X)\", diffusion = \"sigma\", state.variable = \"X\")\n\n# サンプリングスキームの設定\nsampling <- setSampling(Initial = 0, Terminal = 3, n = 1000)\n\n# yuimaオブジェクトの作成\nyuima <- setYuima(model = model, sampling = sampling)\n\n# シミュレーションの実行\nsimulation <- simulate(yuima, true.parameter = c(mu = 0,theta = 1, sigma = 0.5), xinit = 0.02)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(simulation)\n```\n\n::: {.cell-output-display}\n![](YUIMA_files/figure-html/unnamed-chunk-5-1.png){width=576}\n:::\n:::\n\n\n### 多次元の場合\n\nまず，所望のモデルを行列の言葉で書く．例えば，2次元の場合で次のようなモデルを考える：\n$$\n\\vctr{dX_t^{(1)}}{dX_t^{(2)}}=\\vctr{-3X_t^{(1)}}{-X_t^{(1)}2X_t^{(2)}}dt+\\begin{pmatrix}1&0&X_t^{(2)}\\\\X_t^{(1)}&3&0\\end{pmatrix}\\begin{pmatrix}dW_t^{(1)}\\\\dW_t^{(2)}\\\\dW_t^{(3)}\\end{pmatrix}\n$$\n\nシミュレーションは次のように，各項の係数をベクトル・行列の形式で `setModel` へと引き渡すことで行える．^[１次元の場合と違って，左辺を明示するために`solve.variable`のベクトルとしての指定が欠かせなくなる．[@Brouste+2014] 第3.4節 pp.12-13．]\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsolve_variable <- c(\"X1\", \"X2\")\ndrift <- c(\"-3*X1\", \"-X1-2*X2\")\ndiffusion <- matrix(c(\"1\", \"X1\", \"0\", \"3\", \"X2\", \"0\"), 2, 3)\nmodel <- setModel(drift=drift, diffusion=diffusion, solve.variable=solve_variable)\nsimulation <- simulate(model)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(simulation, plot.type=\"single\", lty=1:2)\n```\n\n::: {.cell-output-display}\n![](YUIMA_files/figure-html/unnamed-chunk-7-1.png){width=576}\n:::\n:::\n\n\n### 分数 Gauss なノイズ\n\n::: {.callout-tip appearance=\"simple\" icon=\"false\"}\n\n標準分数 Brown 運動 $W^H$ とは，Hurst 指数 $H\\in(0,1)$ に対して，\n$$\n\\E[W^H_s,W^H_t]=\\frac{1}{2}\\Paren{\\abs{s}^{2H}+\\abs{t}^{2H}-\\abs{t-s}^{2H}}\n$$\nという共分散構造を持った中心 Gauss 過程である．\n\n:::\n\n$H\\ne1/2$ のとき，もはや Markov 過程でもセミマルチンゲールでもない．特に $H>1/2$ のときに，$W^H$ は長期的な依存を持った振る舞いをしこれが多くの応用を呼んでいる．\n\nこの $W^H$ に対して，SDE\n$$\ndX_t=a(X_t)dt+b(X_t)dW_t^H\n$$\nで定まるモデルを定義できる．[@Brouste+2014 3.5節 p.15]\n\n例えば分数 OU 過程\n$$\ndY_t=3Y_tdt+dW_t^H\n$$\nは次のように定義する：\n\n::: {.cell}\n\n```{.r .cell-code}\nmod4A <- setModel(drift=\"3*y\", diffusion=1, hurst=0.3, solve.var=\"y\")\nmod4B <- setModel(drift=\"3*y\", diffusion=1, hurst=0.7, solve.var=\"y\")\nsim1 <- simulate(mod4A, sampling = setSampling(n=1000))\nsim2 <- simulate(mod4B, sampling = setSampling(n=1000))\npar(mfrow=c(2,1), mar=c(2,3,1,1))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(sim1, main=\"H=0.3\")\n```\n\n::: {.cell-output-display}\n![](YUIMA_files/figure-html/unnamed-chunk-9-1.png){width=576}\n:::\n\n```{.r .cell-code}\nplot(sim2, main=\"H=0.7\")\n```\n\n::: {.cell-output-display}\n![](YUIMA_files/figure-html/unnamed-chunk-9-2.png){width=576}\n:::\n:::\n\n\nこのシミュレーション法は Cholesky 法と [@Wood-Chan1994] 法から選択が可能である．`simulate` メソッドのキーワード引数 `methodfGn=\"WoodChan\"`, `methodfGn=\"Cholesky\"` によって利用可能である．\n\n### Lévy 過程\n\n[複合 Poisson 過程](../Process/Poisson.qmd) $Z_t$ とは，Poisson 時間に特定の分布に従うサイズの跳躍が起こるという過程である．\n\n複合 Poisson 過程 $Z_t$ を用いて，\n$$\ndX_t=a(t,X_t,\\theta)dt+b(t,X_t,\\theta)dW_t+dZ_t\n$$\nという SDE を通じてジャンプを持つ過程が定義できる．\n\nさらに $Z_t$ の項に係数 $c$ を持たせるには，$X$ のジャンプを定めるランダム測度（≒確率核）\n$$\n\\mu(dt,dz)=\\sum_{s>0}1_{\\Brace{\\Delta Z_s\\ne0}}\\delta_{(s,\\Delta Z_s)}(dt,dz)\n$$\nにより，複合 Poisson 過程が\n$$\nZ_t=\\int^t_0\\int_{\\abs{z}\\le1}z(\\mu(ds,dz)-\\nu(dz)ds)+\\int^t_0\\int_{\\abs{z}>1}z\\mu(ds,dz)\n$$\nと表せ，ジャンプ過程 $X$ が，一般の関数 $c$ を用いて\n$$\ndX_t=a(t,X_t,\\theta)dt+b(t,X_t,\\theta)dW_t+\\int_{\\abs{z}>1}c(X_{t-},z)\\mu(dt,dz)\n$$\n$$\n\\qquad+\\int_{0<\\abs{z}\\le1}c(X_{t-},z)(\\mu(dt,dz)-\\nu(dz)dt)\n$$\nと表せる．\n\n$\\nu\\in\\cP(\\R^d)$ が [**Lévy 測度**](../Process/Levy.qmd) であるとは， $\\nu(\\{0\\})=0$ かつ\n$$\n\\int_{\\R^d}(1\\land\\abs{z}^2)\\nu(dz)<\\infty\n$$\nを満たすことをいう．\n\n例えば，強度 $\\lambda=10$ で Gauss 分布を跳躍測度に持つ Lévy 過程は，`measure.type=\"CP\"` によって指定する．\n\n平均 $0$ のジャンプ OU 過程\n$$\ndX_t=-\\theta X_tdt+\\sigma dW_t+dZ_t\n$$\nは次のように定義できる：\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod5 <- setModel(drift=c(\"-theta*x\"), diffusion=\"sigma\", jump.coeff=\"1\",\n      measure=list(intensity=\"10\", df=list(\"dnorm(z,0,1)\")), measure.type=\"CP\",\n      solve.variable=\"x\")\nsim5 <- simulate(mod5, true.p = list(theta=1, sigma=3), sampling=setSampling(n=1000))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(sim5)\n```\n\n::: {.cell-output-display}\n![](YUIMA_files/figure-html/unnamed-chunk-11-1.png){width=576}\n:::\n:::\n\n\n一方で，逆正規分布の大きさのジャンプを持つ Lévy 測度 $\\nu$ をもち，Poisson 成分を持たない OU 過程\n$$\ndX_t=-xdt+dZ_t\n$$\nは次のように定義できる：\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod6 <- setModel(drift=\"-x\", xinit=1, jump.coeff=\"1\",\n      measure.type=\"code\", measure=list(df=\"rIG(z,1,0.1)\"))\nsim6 <- simulate(mod6, sampling=setSampling(Terminal=10, n=10000))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(sim6)\n```\n\n::: {.cell-output-display}\n![](YUIMA_files/figure-html/unnamed-chunk-13-1.png){width=576}\n:::\n:::\n\n\n## `simulate()` と `setSampling()`\n\n### `simulate()` 関数の使い方\n\n`simulate()` は `yuima` または `yuima.model` で定められたモデルから，Euler-Maruyama 法によるシミュレーションを実行する関数．^[ただし，分数 Gauss ノイズが仮定された場合は Cholesky 法または [@Wood-Chan1994] の手法による．]\n\nソースコードは [`simulate.R`](https://github.com/yuimaproject/yuima/blob/1bbd1291b58d07fed096a2237db7b233081d51f7/R/simulate.R#L4)．ポリモーフィックな実装がなされている．\n\n```r\nsimulate(object, nsim=1, seed=NULL, xinit, true.parameter, space.discretized = FALSE, increment.W = NULL, increment.L = NULL, method = \"euler\", hurst, methodfGn = \"WoodChan\", sampling=sampling, subsampling=subsampling, ...)\n```\n\n返り値は `yuima` オブジェクトである．しかし，その `yuima.data` フィールドにはシミュレーション結果が格納されており，それに対して `plot()` を使う．\n\n#### 時間離散化 Euler-Maruyama 法\n\n最も広く使われているシミュレーション法である．\n\n時間にグリッド $0=\\tau_0<\\tau_1<\\cdots<\\tau_j<\\cdots$ を導入し，連続過程 $\\{X_t\\}_{t\\in\\R_+}$ の離散化 $\\{\\wt{X}_{\\tau_j}\\}_{j\\in\\N}$ を\n$$\n\\wt{X}_{\\tau_{j+1}}:=\\wt{X}_{\\tau_j}+b(\\tau_j,\\wt{X}_{\\tau_j})(\\tau_{j+1}-\\tau_j)+c(\\tau_j,\\wt{X}_{\\tau_j})(W_{\\tau_{j+1}}-W_{\\tau_j})\n$$\nと定義する．\n\n$W_{\\tau_{j+1}}-W_{\\tau_j}\\iidsim\\rN(0,\\tau_{j+1}-\\tau_j)$ を利用してサンプリングできる．\n\n#### 空間離散 Euler-Maruyama 法\n\n`simulate` メソッドはこの方法も（ジャンプを持たない過程について）実装している．ただし，**現状，駆動過程が1次元のSDEに対してのみである**．\n\nこれは，時間離散化 $\\{\\tau_j\\}_{j\\in\\N}\\subset\\R$ は次のように取る方法である：\n$$\n\\tau_0:=0,\\quad\\tau_{j+1}:=\\inf\\Brace{t>\\tau_j\\mid\\abs{W_t-W_{\\tau_j}}=\\ep}\n$$\nただし，実装の上では\n$$\n\\ep^2:=\\frac{T}{n}=\\Delta_n\n$$\nとしている．\n\nこの方法は通常の時間離散化法よりも3倍高速になることが経験的に知られている．\n\nこれは `space.discretized=TRUE` で指定できる．デフォルトは `=FALSE` となっており，時間離散化の方である．\n\n他にも [@Iacus2008] のシミュレーション法が実装予定である．\n\n### `setSampling`コンストラクタ\n\n`simulate` 関数は `yuima.sampling` オブジェクトも引数として `sampling = samp` と取れる．\n\nそしてこのサンプリングスキームは出力にそのまま引き継がれる．\n\n```{.r filename=\"setSampling.R\"}\nsetSampling(Initial = 0, Terminal = 1, n = 100, delta, \n   grid, random = FALSE, sdelta=as.numeric(NULL), \n   sgrid=as.numeric(NULL), interpolation=\"pt\" )\n```\n\n#### 例\n\n例えば次の2次元モデルを考える\n\n$$\ndX_t^{(1)}=-\\theta X^{(1)}_tdt+dW_t^{(1)}+X_t^{(2)}dW_t^{(3)}\n$$\n$$\ndX_t^{(2)}=-(X_t^{(1)}+\\gamma X_t^{(2)})dt+X_t^{(1)}dW_t^{(1)}+\\delta dW_t^{(2)}\n$$\n\n時区間 $[0,3]$ 上のグリッドから $n=3000$ の粒度で観測するサンプリングオブジェクトは次のように定義する：\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsol <- c(\"x1\", \"x2\")\nb <- c(\"-theta*x1\", \"-x1-gamma*x2\")\ns <- matrix(c(\"1\", \"x1\", \"0\", \"delta\", \"x2\", \"0\"), 2, 3)\nmyModel <- setModel(drift=b, diffusion=s, solve.variable=sol)\nsamp <- setSampling(Terminal=3, n=3000)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsim2 <- simulate(myModel, sampling=samp)\nstr(sim2@sampling)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nFormal class 'yuima.sampling' [package \"yuima\"] with 11 slots\n  ..@ Initial      : num 0\n  ..@ Terminal     : num [1:2] 3 3\n  ..@ n            : int [1:2] 3000 3000\n  ..@ delta        : num 0.001\n  ..@ grid         :List of 1\n  .. ..$ : num [1:3001] 0 0.001 0.002 0.003 0.004 0.005 0.006 0.007 0.008 0.009 ...\n  ..@ random       : logi FALSE\n  ..@ regular      : logi TRUE\n  ..@ sdelta       : num(0) \n  ..@ sgrid        : num(0) \n  ..@ oindex       : num(0) \n  ..@ interpolation: chr \"pt\"\n```\n\n\n:::\n:::\n\n\nこれは`samp`そのものであり，確かに出力に引き継がれている．\n\n### `subsampling`関数の使い方\n\n２つの独立な指数分布を指定することで，Poisson 到着時間を用いてサンプリングすることができる．\n\nこのような `yuima.sampling` オブジェクトは次のように定義する：\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnewsamp <- setSampling(random=list(rdist=c(function(x)\n      + rexp(x, rate=10), function(x) rexp(x, rate=20))))\n```\n:::\n\n\nこれを用いてサブサンプリングを実行できる：\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnewdata <- subsampling(sim2, sampling=newsamp)\nplot(sim2, plot.type=\"single\", lty=c(1,3), ylab=\"sim2\")\npoints(get.zoo.data(newdata)[[1]], col=\"red\")\npoints(get.zoo.data(newdata)[[2]], col=\"green\", pch=18)\n```\n\n::: {.cell-output-display}\n![](YUIMA_files/figure-html/unnamed-chunk-17-1.png){width=576}\n:::\n:::\n\n\n赤が $X_t^{(1)}$，緑が $X_t^{(2)}$ の見本道でどこがサブサンプリングされたかを示している．\n\nこのサンプリング法はランダムに行った．これを示すフラグが`regular`である：\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(newsamp@regular)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n logi FALSE\n```\n\n\n:::\n:::\n\n\n一方で，決定論的に，決まった周波数でサブサンプリングもできる：\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnewsamp2 <- setSampling(delta=c(0.1, 0.2))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in yuima.warn(\"'Terminal' (re)defined.\"): \nYUIMA: 'Terminal' (re)defined.\n```\n\n\n:::\n\n```{.r .cell-code}\nnewdata2 <- subsampling(sim2, sampling=newsamp2)\nplot(sim2, plot.type=\"single\", lty=c(1,3), ylab=\"sim2\")\npoints(get.zoo.data(newdata2)[[1]], col=\"red\")\npoints(get.zoo.data(newdata2)[[2]], col=\"green\", pch=18)\n```\n\n::: {.cell-output-display}\n![](YUIMA_files/figure-html/unnamed-chunk-19-1.png){width=576}\n:::\n:::\n\n\n赤色のサブサンプリングは，緑色の２倍の頻度（半分の周波数）で行われている．\n\n### サンプリングとサブサンプリングの組み合わせ\n\nシミュレーション研究で，よく高頻度のサンプリングを行った後，推定のためにより低い頻度でのデータを抽出する，ということが行われる．これは１行で表現できる：\n\n\n::: {.cell}\n\n```{.r .cell-code}\nY.sub <- simulate(myModel, sampling=setSampling(delta=0.001, n=1000), subsampling=setSampling(delta=0.01, n=100))\nY <- simulate(myModel, sampling=setSampling(delta=0.001, n=1000))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(Y.sub, plot.type=\"single\")\npoints(get.zoo.data(Y.sub)[[1]], col=\"red\")\npoints(get.zoo.data(Y.sub)[[2]], col=\"green\", pch=18)\n```\n\n::: {.cell-output-display}\n![](YUIMA_files/figure-html/unnamed-chunk-21-1.png){width=576}\n:::\n:::\n\n\n### 今後の発展\n\n#### `zoo`との依存関係\n\nサンプリングとサブサンプリングにおいて，`zoo`というパッケージ [@Zeileis-Grothendieck2005] が時系列データを保存するために内部で用いられている．\n\nより柔軟な時系列データの保存法ができたら，この dependency は脱したいと考えられているようである．\n\n\n## これから {.appendix}\n\n* `setYuima()` の help ページに 'PLEASE FINISH THIS' が２箇所ある．\n* help ページによく出てくる `yuimadocs` パッケージとは？",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}