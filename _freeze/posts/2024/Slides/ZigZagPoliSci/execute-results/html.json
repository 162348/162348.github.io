{
  "hash": "0ebfdf287cbf4e46f09c91c290c1dedd",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Zig-Zag Sampler\"\nsubtitle: \"A MCMC Game-Changer\"\nauthor:\n  - name: \"Hirofumi Shiba\"\n    orcid: 0009-0007-8251-1224\n    affiliations: \n      - name: \"Institute of Statistical Mathematics\"\n      - name: \"the University of Tokyo\"\n        url: https://esrp.rcast.u-tokyo.ac.jp/experts/hirofumi-shiba/?lang=en\ndate: \"9/10/2024\"\ncategories: [Slide, MCMC]\nimage: zigzag_fps14_WhiteBackground.gif\ntoc-title: \"Table of Contents\"\nformat:\n  html: default\n  revealjs:\n    output-file: ZigZagPoliSci_Slides.html\n    slide-number: true\n    chalkboard: \n      buttons: false\n    preview-links: auto\n    logo: ../../../assets/profile.jpg\n    css: ../../../assets/slides.css\n    footer: |\n      [Hirofumi Shiba](https://162348.github.io/posts/2024/Slides/ZigZagPoliSci.html)\n    scrollable: true\n    # smaller: true\n    controls: true\n    controls-layout: bottom-right\n    self-contained-math: true\n    shift-heading-level-by: -1\n    toc: true\n    toc-depth: 1\n    toc-title: \"Today's Menu\"\n    number-sections: true\n    theme: serif\n    show-slide-number: all\n    include-in-header: ../../../assets/include-in-header.html\n    tbl-cap-location: bottom\n    margin: 0.05\nbibliography: \n    - ../../../assets/mathematics.bib\n    - ../../../assets/bib.bib\ncsl: ../../../assets/apalike.csl\ndescription: |\n  Slides are available <a href=\"https://162348.github.io/posts/2024/Slides/ZigZagPoliSci_Slides.html\" style=\"text-decoration: underline;\">here</a>.\ncomment: false\ncode-fold: false\nexecute:\n    cache: true\nhtml-math-method: katex\nabstract-title: Abstract\nabstract: |\n  Zig-Zag sampler, known as an instance of 'Continuous-time MCMC', is a cutting-edge sampling method that exhibits scalability and state-of-the-art performance on high-dimensional models including logistic models etc. This talk includes a brief introduction to the Zig-Zag sampler and the two important properties, irreversibility of its dynamics and thinning of Poisson point processes, followed by a few numerical experiments on logistic models with large and unbalanced data.\ncitation: \n  type: speech\n  container-title: University of Seoul, Gwanak (관악) campus, South Korea\nlicense: \"CC BY\"\nformat-links:\n  - text: pdf\n    href: Files/ZigZagPoliSci.pdf\n    icon: file-pdf\n---\n\n## The Zig-Zag Sampler: What Is It? {#sec-Zig-Zag}\n\nA continuous-time variant of MCMC algorithms\n\n![Trajectory for Zig-Zag Sampler. Please attribute Hirofumi Shiba. <i class=\"fa-brands fa-creative-commons\"></i> <i class=\"fa-brands fa-creative-commons-by\"></i>](zigzag_fps14.gif)\n\n::: {.hidden}\n\n::: {.content-visible when-format=\"html\"}\n\nA Blog Entry on Bayesian Computation by an Applied Mathematician\n\n$$\n\n\\renewcommand{\\P}{\\operatorname{P}}\\newcommand{\\E}{\\operatorname{E}}\n\\newcommand{\\R}{\\mathbb{R}}\\newcommand{\\F}{\\mathcal{F}}\n\\newcommand{\\abs}[1]{\\lvert#1\\rvert}\\newcommand{\\Abs}[1]{\\left|#1\\right|}\\newcommand{\\ABs}[1]{\\biggl|#1\\biggr|}\\newcommand{\\norm}[1]{\\|#1\\|}\\newcommand{\\Norm}[1]{\\left\\|#1\\right\\|}\\newcommand{\\NOrm}[1]{\\biggl\\|#1\\biggr\\|}\\newcommand{\\Brace}[1]{\\left\\{#1\\right\\}}\\newcommand{\\BRace}[1]{\\biggl\\{#1\\biggr\\}}\\newcommand{\\paren}[1]{\\left(#1\\right)}\\newcommand{\\Paren}[1]{\\biggr(#1\\biggl)}\\newcommand{\\brac}[1]{\\langle#1\\rangle}\\newcommand{\\Brac}[1]{\\left\\langle#1\\right\\rangle}\\newcommand{\\BRac}[1]{\\biggl\\langle#1\\biggr\\rangle}\\newcommand{\\bra}[1]{\\left\\langle#1\\right|}\\newcommand{\\ket}[1]{\\left|#1\\right\\rangle}\\newcommand{\\Square}[1]{\\left[#1\\right]}\\newcommand{\\SQuare}[1]{\\biggl[#1\\biggr]}\\newcommand{\\rN}{\\mathrm{N}}\\newcommand{\\ov}[1]{\\overline{#1}}\\newcommand{\\un}[1]{\\underline{#1}}\\newcommand{\\wt}[1]{\\widetilde{#1}}\\newcommand{\\wh}[1]{\\widehat{#1}}\\newcommand{\\pp}[2]{\\frac{\\partial #1}{\\partial #2}}\\newcommand{\\ppp}[3]{\\frac{\\partial #1}{\\partial #2\\partial #3}}\\newcommand{\\dd}[2]{\\frac{d #1}{d #2}}\\newcommand{\\floor}[1]{\\lfloor#1\\rfloor}\\newcommand{\\Floor}[1]{\\left\\lfloor#1\\right\\rfloor}\\newcommand{\\ceil}[1]{\\lceil#1\\rceil}\\newcommand{\\ocinterval}[1]{(#1]}\\newcommand{\\cointerval}[1]{[#1)}\\newcommand{\\COinterval}[1]{\\left[#1\\right)}\\newcommand{\\iso}{\\overset{\\sim}{\\to}}\n\n\n\n\\newcommand{\\y}{\\b{y}}\\newcommand{\\mi}{\\,|\\,}\\newcommand{\\Mark}{\\mathrm{Mark}}\n\\newcommand{\\argmax}{\\operatorname*{argmax}}\\newcommand{\\argmin}{\\operatorname*{argmin}}\n\n\\newcommand{\\pr}{\\mathrm{pr}}\\newcommand{\\Conv}{\\operatorname{Conv}}\\newcommand{\\cU}{\\mathcal{U}}\n\\newcommand{\\Map}{\\mathrm{Map}}\\newcommand{\\dom}{\\mathrm{Dom}\\;}\\newcommand{\\cod}{\\mathrm{Cod}\\;}\\newcommand{\\supp}{\\mathrm{supp}\\;}\n\\newcommand{\\grad}{\\operatorname{grad}}\\newcommand{\\rot}{\\operatorname{rot}}\\renewcommand{\\div}{\\operatorname{div}}\\newcommand{\\tr}{\\operatorname{tr}}\\newcommand{\\Tr}{\\operatorname{Tr}}\\newcommand{\\KL}{\\operatorname{KL}}\\newcommand{\\JS}{\\operatorname{JS}}\\newcommand{\\ESS}{\\operatorname{ESS}}\\newcommand{\\MSE}{\\operatorname{MSE}}\\newcommand{\\erf}{\\operatorname{erf}}\\newcommand{\\arctanh}{\\operatorname{arctanh}}\\newcommand{\\pl}{\\operatorname{pl}}\\newcommand{\\minimize}{\\operatorname{minimize}}\\newcommand{\\subjectto}{\\operatorname{subject to}}\\newcommand{\\sinc}{\\operatorname{sinc}}\\newcommand{\\Ent}{\\operatorname{Ent}}\\newcommand{\\Polya}{\\operatorname{Polya}}\\newcommand{\\Exp}{\\operatorname{Exp}}\\newcommand{\\codim}{\\operatorname{codim}}\\newcommand{\\sgn}{\\operatorname{sgn}}\\newcommand{\\rank}{\\operatorname{rank}}\n\n\\newcommand{\\vctr}[2]{\\begin{pmatrix}#1\\\\#2\\end{pmatrix}}\\newcommand{\\vctrr}[3]{\\begin{pmatrix}#1\\\\#2\\\\#3\\end{pmatrix}}\\newcommand{\\mtrx}[4]{\\begin{pmatrix}#1&#2\\\\#3&#4\\end{pmatrix}}\\newcommand{\\smtrx}[4]{\\paren{\\begin{smallmatrix}#1&#2\\\\#3&#4\\end{smallmatrix}}}\\newcommand{\\Ker}{\\mathrm{Ker}\\;}\\newcommand{\\Coker}{\\mathrm{Coker}\\;}\\newcommand{\\Coim}{\\mathrm{Coim}\\;}\\newcommand{\\lcm}{\\mathrm{lcm}}\\newcommand{\\GL}{\\mathrm{GL}}\\newcommand{\\SL}{\\mathrm{SL}}\\newcommand{\\alt}{\\mathrm{alt}}\n\n\\renewcommand{\\Re}{\\mathrm{Re}\\;}\\renewcommand{\\Im}{\\mathrm{Im}\\,}\\newcommand{\\Gal}{\\mathrm{Gal}}\\newcommand{\\PGL}{\\mathrm{PGL}}\\newcommand{\\PSL}{\\mathrm{PSL}}\\newcommand{\\Log}{\\mathrm{Log}\\,}\\newcommand{\\Res}{\\mathrm{Res}\\,}\\newcommand{\\on}{\\mathrm{on}\\;}\\newcommand{\\hatC}{\\widehat{\\C}}\\newcommand{\\hatR}{\\hat{\\R}}\\newcommand{\\PV}{\\mathrm{P.V.}}\\newcommand{\\diam}{\\mathrm{diam}}\\newcommand{\\Area}{\\mathrm{Area}}\\newcommand{\\Lap}{\\Laplace}\\newcommand{\\f}{\\mathbf{f}}\\newcommand{\\cR}{\\mathcal{R}}\\newcommand{\\const}{\\mathrm{const.}}\\newcommand{\\Om}{\\Omega}\\newcommand{\\Cinf}{C^\\infty}\\newcommand{\\ep}{\\epsilon}\\newcommand{\\dist}{\\mathrm{dist}}\\newcommand{\\opart}{\\o{\\partial}}\\newcommand{\\Length}{\\mathrm{Length}}\n\n\\newcommand{\\cA}{\\mathcal{A}}\\newcommand{\\cO}{\\mathcal{O}}\\newcommand{\\cW}{\\mathcal{W}}\\renewcommand{\\O}{\\mathcal{O}}\\renewcommand{\\S}{\\mathcal{S}}\\newcommand{\\U}{\\mathcal{U}}\\newcommand{\\V}{\\mathrm{V}}\\newcommand{\\N}{\\mathbb{N}}\\newcommand{\\bN}{\\mathbb{N}}\\newcommand{\\C}{\\mathrm{C}}\\newcommand{\\bC}{\\mathbb{C}}\\newcommand{\\Z}{\\mathcal{Z}}\\newcommand{\\Q}{\\mathbb{Q}}\\newcommand{\\bQ}{\\mathbb{Q}}\\newcommand{\\TV}{\\mathrm{TV}}\\newcommand{\\ORD}{\\mathrm{ORD}}\\newcommand{\\Card}{\\mathrm{Card}\\,}\\newcommand{\\Top}{\\mathrm{Top}}\\newcommand{\\Disc}{\\mathrm{Disc}}\\newcommand{\\Codisc}{\\mathrm{Codisc}}\\newcommand{\\CoDisc}{\\mathrm{CoDisc}}\\newcommand{\\Ult}{\\mathrm{Ult}}\\newcommand{\\ord}{\\mathrm{ord}}\\newcommand{\\bS}{\\mathbb{S}}\\newcommand{\\PConn}{\\mathrm{PConn}}\\newcommand{\\mult}{\\mathrm{mult}}\\newcommand{\\inv}{\\mathrm{inv}}\n\n\\newcommand{\\Der}{\\mathrm{Der}}\\newcommand{\\osub}{\\overset{\\mathrm{open}}{\\subset}}\\newcommand{\\osup}{\\overset{\\mathrm{open}}{\\supset}}\\newcommand{\\al}{\\alpha}\\newcommand{\\K}{\\mathbb{K}}\\newcommand{\\Sp}{\\mathrm{Sp}}\\newcommand{\\g}{\\mathfrak{g}}\\newcommand{\\h}{\\mathfrak{h}}\\newcommand{\\Imm}{\\mathrm{Imm}}\\newcommand{\\Imb}{\\mathrm{Imb}}\\newcommand{\\Gr}{\\mathrm{Gr}}\n\n\\newcommand{\\Ad}{\\mathrm{Ad}}\\newcommand{\\finsupp}{\\mathrm{fin\\;supp}}\\newcommand{\\SO}{\\mathrm{SO}}\\newcommand{\\SU}{\\mathrm{SU}}\\newcommand{\\acts}{\\curvearrowright}\\newcommand{\\mono}{\\hookrightarrow}\\newcommand{\\epi}{\\twoheadrightarrow}\\newcommand{\\Stab}{\\mathrm{Stab}}\\newcommand{\\nor}{\\mathrm{nor}}\\newcommand{\\T}{\\mathbb{T}}\\newcommand{\\Aff}{\\mathrm{Aff}}\\newcommand{\\rsup}{\\triangleright}\\newcommand{\\subgrp}{\\overset{\\mathrm{subgrp}}{\\subset}}\\newcommand{\\Ext}{\\mathrm{Ext}}\\newcommand{\\sbs}{\\subset}\\newcommand{\\sps}{\\supset}\\newcommand{\\In}{\\mathrm{in}\\;}\\newcommand{\\Tor}{\\mathrm{Tor}}\\newcommand{\\p}{\\b{p}}\\newcommand{\\q}{\\mathfrak{q}}\\newcommand{\\m}{\\mathfrak{m}}\\newcommand{\\cS}{\\mathcal{S}}\\newcommand{\\Frac}{\\mathrm{Frac}\\,}\\newcommand{\\Spec}{\\mathrm{Spec}\\,}\\newcommand{\\bA}{\\mathbb{A}}\\newcommand{\\Sym}{\\mathrm{Sym}}\\newcommand{\\Ann}{\\mathrm{Ann}}\\newcommand{\\Her}{\\mathrm{Her}}\\newcommand{\\Bil}{\\mathrm{Bil}}\\newcommand{\\Ses}{\\mathrm{Ses}}\\newcommand{\\FVS}{\\mathrm{FVS}}\n\n\\newcommand{\\Ho}{\\mathrm{Ho}}\\newcommand{\\CW}{\\mathrm{CW}}\\newcommand{\\lc}{\\mathrm{lc}}\\newcommand{\\cg}{\\mathrm{cg}}\\newcommand{\\Fib}{\\mathrm{Fib}}\\newcommand{\\Cyl}{\\mathrm{Cyl}}\\newcommand{\\Ch}{\\mathrm{Ch}}\n\\newcommand{\\rP}{\\mathrm{P}}\\newcommand{\\rE}{\\mathrm{E}}\\newcommand{\\e}{\\b{e}}\\renewcommand{\\k}{\\b{k}}\\newcommand{\\Christ}[2]{\\begin{Bmatrix}#1\\\\#2\\end{Bmatrix}}\\renewcommand{\\Vec}[1]{\\overrightarrow{\\mathrm{#1}}}\\newcommand{\\hen}[1]{\\mathrm{#1}}\\renewcommand{\\b}[1]{\\boldsymbol{#1}}\n\n\\newcommand{\\Inc}{\\mathrm{Inc}}\\newcommand{\\aInc}{\\mathrm{aInc}}\\newcommand{\\HS}{\\mathrm{HS}}\\newcommand{\\loc}{\\mathrm{loc}}\\newcommand{\\Lh}{\\mathrm{L.h.}}\\newcommand{\\Epi}{\\mathrm{Epi}}\\newcommand{\\slim}{\\mathrm{slim}}\\newcommand{\\Ban}{\\mathrm{Ban}}\\newcommand{\\Hilb}{\\mathrm{Hilb}}\\newcommand{\\Ex}{\\mathrm{Ex}}\\newcommand{\\Co}{\\mathrm{Co}}\\newcommand{\\sa}{\\mathrm{sa}}\\newcommand{\\nnorm}[1]{{\\left\\vert\\kern-0.25ex\\left\\vert\\kern-0.25ex\\left\\vert #1 \\right\\vert\\kern-0.25ex\\right\\vert\\kern-0.25ex\\right\\vert}}\\newcommand{\\dvol}{\\mathrm{dvol}}\\newcommand{\\Sconv}{\\mathrm{Sconv}}\\newcommand{\\I}{\\mathcal{I}}\\newcommand{\\nonunital}{\\mathrm{nu}}\\newcommand{\\cpt}{\\mathrm{cpt}}\\newcommand{\\lcpt}{\\mathrm{lcpt}}\\newcommand{\\com}{\\mathrm{com}}\\newcommand{\\Haus}{\\mathrm{Haus}}\\newcommand{\\proper}{\\mathrm{proper}}\\newcommand{\\infinity}{\\mathrm{inf}}\\newcommand{\\TVS}{\\mathrm{TVS}}\\newcommand{\\ess}{\\mathrm{ess}}\\newcommand{\\ext}{\\mathrm{ext}}\\newcommand{\\Index}{\\mathrm{Index}\\;}\\newcommand{\\SSR}{\\mathrm{SSR}}\\newcommand{\\vs}{\\mathrm{vs.}}\\newcommand{\\fM}{\\mathfrak{M}}\\newcommand{\\EDM}{\\mathrm{EDM}}\\newcommand{\\Tw}{\\mathrm{Tw}}\\newcommand{\\fC}{\\mathfrak{C}}\\newcommand{\\bn}{\\boldsymbol{n}}\\newcommand{\\br}{\\boldsymbol{r}}\\newcommand{\\Lam}{\\Lambda}\\newcommand{\\lam}{\\lambda}\\newcommand{\\one}{\\mathbf{1}}\\newcommand{\\dae}{\\text{-a.e.}}\\newcommand{\\das}{\\text{-a.s.}}\\newcommand{\\td}{\\text{-}}\\newcommand{\\RM}{\\mathrm{RM}}\\newcommand{\\BV}{\\mathrm{BV}}\\newcommand{\\normal}{\\mathrm{normal}}\\newcommand{\\lub}{\\mathrm{lub}\\;}\\newcommand{\\Graph}{\\mathrm{Graph}}\\newcommand{\\Ascent}{\\mathrm{Ascent}}\\newcommand{\\Descent}{\\mathrm{Descent}}\\newcommand{\\BIL}{\\mathrm{BIL}}\\newcommand{\\fL}{\\mathfrak{L}}\\newcommand{\\De}{\\Delta}\n\n\\newcommand{\\calA}{\\mathcal{A}}\\newcommand{\\calB}{\\mathcal{B}}\\newcommand{\\D}{\\mathcal{D}}\\newcommand{\\Y}{\\mathcal{Y}}\\newcommand{\\calC}{\\mathcal{C}}\\renewcommand{\\ae}{\\mathrm{a.e.}\\;}\\newcommand{\\cZ}{\\mathcal{Z}}\\newcommand{\\fF}{\\mathfrak{F}}\\newcommand{\\fI}{\\mathfrak{I}}\\newcommand{\\rV}{\\mathrm{V}}\\newcommand{\\cE}{\\mathcal{E}}\\newcommand{\\sMap}{\\sigma\\textrm{-}\\mathrm{Map}}\\newcommand{\\cC}{\\mathcal{C}}\\newcommand{\\comp}{\\complement}\\newcommand{\\J}{\\mathcal{J}}\\newcommand{\\sumN}[1]{\\sum_{#1\\in\\N}}\\newcommand{\\cupN}[1]{\\cup_{#1\\in\\N}}\\newcommand{\\capN}[1]{\\cap_{#1\\in\\N}}\\newcommand{\\Sum}[1]{\\sum_{#1=1}^\\infty}\\newcommand{\\sumn}{\\sum_{n=1}^\\infty}\\newcommand{\\summ}{\\sum_{m=1}^\\infty}\\newcommand{\\sumk}{\\sum_{k=1}^\\infty}\\newcommand{\\sumi}{\\sum_{i=1}^\\infty}\\newcommand{\\sumj}{\\sum_{j=1}^\\infty}\\newcommand{\\cupn}{\\cup_{n=1}^\\infty}\\newcommand{\\capn}{\\cap_{n=1}^\\infty}\\newcommand{\\cupk}{\\cup_{k=1}^\\infty}\\newcommand{\\cupi}{\\cup_{i=1}^\\infty}\\newcommand{\\cupj}{\\cup_{j=1}^\\infty}\\newcommand{\\limn}{\\lim_{n\\to\\infty}}\\renewcommand{\\L}{\\mathcal{L}}\\newcommand{\\cL}{\\mathcal{L}}\\newcommand{\\Cl}{\\mathrm{Cl}}\\newcommand{\\cN}{\\mathcal{N}}\\newcommand{\\Ae}{\\textrm{-a.e.}\\;}\\renewcommand{\\csub}{\\overset{\\textrm{closed}}{\\subset}}\\renewcommand{\\csup}{\\overset{\\textrm{closed}}{\\supset}}\\newcommand{\\wB}{\\wt{B}}\\newcommand{\\cG}{\\mathcal{G}}\\newcommand{\\Lip}{\\mathrm{Lip}}\\newcommand{\\AC}{\\mathrm{AC}}\\newcommand{\\Mol}{\\mathrm{Mol}}\n\n\\newcommand{\\Pe}{\\mathrm{Pe}}\\newcommand{\\wR}{\\wh{\\mathbb{\\R}}}\\newcommand*{\\Laplace}{\\mathop{}\\!\\mathbin\\bigtriangleup}\\newcommand*{\\DAlambert}{\\mathop{}\\!\\mathbin\\Box}\\newcommand{\\bT}{\\mathbb{T}}\\newcommand{\\dx}{\\dslash x}\\newcommand{\\dt}{\\dslash t}\\newcommand{\\ds}{\\dslash s}\n\n\\newcommand{\\round}{\\mathrm{round}}\\newcommand{\\cond}{\\mathrm{cond}}\\newcommand{\\diag}{\\mathrm{diag}}\n\\newcommand{\\Adj}{\\mathrm{Adj}}\\newcommand{\\Pf}{\\mathrm{Pf}}\\newcommand{\\Sg}{\\mathrm{Sg}}\n\n\n\\newcommand{\\aseq}{\\overset{\\text{a.s.}}{=}}\\newcommand{\\deq}{\\overset{\\text{d}}{=}}\\newcommand{\\cV}{\\mathcal{V}}\\newcommand{\\FM}{\\mathrm{FM}}\\newcommand{\\KR}{\\mathrm{KR}}\\newcommand{\\rba}{\\mathrm{rba}}\\newcommand{\\rca}{\\mathrm{rca}}\\newcommand{\\Prob}{\\mathrm{Prob}}\\newcommand{\\X}{\\mathcal{X}}\\newcommand{\\Meas}{\\mathrm{Meas}}\\newcommand{\\as}{\\;\\text{a.s.}}\\newcommand{\\io}{\\;\\mathrm{i.o.}}\\newcommand{\\fe}{\\;\\text{f.e.}}\\newcommand{\\bF}{\\mathbb{F}}\\newcommand{\\W}{\\mathcal{W}}\\newcommand{\\Pois}{\\mathrm{Pois}}\\newcommand{\\iid}{\\text{i.i.d.}}\\newcommand{\\wconv}{\\rightsquigarrow}\\newcommand{\\Var}{\\mathrm{Var}}\\newcommand{\\xrightarrown}{\\xrightarrow{n\\to\\infty}}\\newcommand{\\au}{\\mathrm{au}}\\newcommand{\\cT}{\\mathcal{T}}\\newcommand{\\wto}{\\overset{\\text{w}}{\\to}}\\newcommand{\\dto}{\\overset{\\text{d}}{\\to}}\\newcommand{\\sto}{\\overset{\\text{s}}{\\to}}\\newcommand{\\pto}{\\overset{\\text{p}}{\\to}}\\newcommand{\\mto}{\\overset{\\text{m}}{\\to}}\\newcommand{\\vto}{\\overset{v}{\\to}}\\newcommand{\\Cont}{\\mathrm{Cont}}\\newcommand{\\stably}{\\mathrm{stably}}\\newcommand{\\Np}{\\mathbb{N}^+}\\newcommand{\\oM}{\\overline{\\mathcal{M}}}\\newcommand{\\fP}{\\mathfrak{P}}\\newcommand{\\sign}{\\mathrm{sign}}\n\\newcommand{\\Borel}{\\mathrm{Borel}}\\newcommand{\\Mid}{\\,|\\,}\\newcommand{\\middleMid}{\\;\\middle|\\;}\\newcommand{\\CP}{\\mathrm{CP}}\\newcommand{\\bD}{\\mathbb{D}}\\newcommand{\\bL}{\\mathbb{L}}\\newcommand{\\fW}{\\mathfrak{W}}\\newcommand{\\DL}{\\mathcal{D}\\mathcal{L}}\\renewcommand{\\r}[1]{\\mathrm{#1}}\\newcommand{\\rC}{\\mathrm{C}}\\newcommand{\\qqquad}{\\qquad\\quad}\n\n\\newcommand{\\bit}{\\mathrm{bit}}\n\n\\newcommand{\\err}{\\mathrm{err}}\n\n\\newcommand{\\varparallel}{\\mathbin{\\!/\\mkern-5mu/\\!}}\\newcommand{\\Ri}{\\mathrm{Ri}}\\newcommand{\\Cone}{\\mathrm{Cone}}\\newcommand{\\Int}{\\mathrm{Int}}\n\n\\newcommand{\\pre}{\\mathrm{pre}}\\newcommand{\\om}{\\omega}\n\n\n\\newcommand{\\del}{\\partial}\n\\newcommand{\\LHS}{\\mathrm{LHS}}\\newcommand{\\RHS}{\\mathrm{RHS}}\\newcommand{\\bnu}{\\boldsymbol{\\nu}}\\newcommand{\\interior}{\\mathrm{in}\\;}\\newcommand{\\SH}{\\mathrm{SH}}\\renewcommand{\\v}{\\boldsymbol{\\nu}}\\newcommand{\\n}{\\mathbf{n}}\\newcommand{\\ssub}{\\Subset}\\newcommand{\\curl}{\\mathrm{curl}}\n\n\\newcommand{\\Ei}{\\mathrm{Ei}}\\newcommand{\\sn}{\\mathrm{sn}}\\newcommand{\\wgamma}{\\widetilde{\\gamma}}\n\n\\newcommand{\\Ens}{\\mathrm{Ens}}\n\n\\newcommand{\\cl}{\\mathrm{cl}}\\newcommand{\\x}{\\boldsymbol{x}}\n\n\\newcommand{\\Do}{\\mathrm{Do}}\\newcommand{\\IV}{\\mathrm{IV}}\n\n\\newcommand{\\AIC}{\\mathrm{AIC}}\\newcommand{\\mrl}{\\mathrm{mrl}}\\newcommand{\\dotx}{\\dot{x}}\\newcommand{\\UMV}{\\mathrm{UMV}}\\newcommand{\\BLU}{\\mathrm{BLU}}\n\n\\newcommand{\\comb}[2]{\\begin{pmatrix}#1\\\\#2\\end{pmatrix}}\\newcommand{\\bP}{\\mathbb{P}}\\newcommand{\\compsub}{\\overset{\\textrm{cpt}}{\\subset}}\\newcommand{\\lip}{\\textrm{lip}}\\newcommand{\\BL}{\\mathrm{BL}}\\newcommand{\\G}{\\mathbb{G}}\\newcommand{\\NB}{\\mathrm{NB}}\\newcommand{\\oR}{\\ov{\\R}}\\newcommand{\\liminfn}{\\liminf_{n\\to\\infty}}\\newcommand{\\limsupn}{\\limsup_{n\\to\\infty}}\\newcommand{\\esssup}{\\mathrm{ess.sup}}\\newcommand{\\asto}{\\xrightarrow{\\as}}\\newcommand{\\Cov}{\\mathrm{Cov}}\\newcommand{\\cQ}{\\mathcal{Q}}\\newcommand{\\VC}{\\mathrm{VC}}\\newcommand{\\mb}{\\mathrm{mb}}\\newcommand{\\Avar}{\\mathrm{Avar}}\\newcommand{\\bB}{\\mathbb{B}}\\newcommand{\\bW}{\\mathbb{W}}\\newcommand{\\sd}{\\mathrm{sd}}\\newcommand{\\w}[1]{\\widehat{#1}}\\newcommand{\\bZ}{\\mathbb{Z}}\\newcommand{\\Bernoulli}{\\mathrm{Ber}}\\newcommand{\\Ber}{\\mathrm{Ber}}\\newcommand{\\Mult}{\\mathrm{Mult}}\\newcommand{\\BPois}{\\mathrm{BPois}}\\newcommand{\\fraks}{\\mathfrak{s}}\\newcommand{\\frakk}{\\mathfrak{k}}\\newcommand{\\IF}{\\mathrm{IF}}\\newcommand{\\bX}{\\boldsymbol{X}}\\newcommand{\\bx}{\\boldsymbol{x}}\\newcommand{\\indep}{\\perp\\!\\!\\!\\perp}\\newcommand{\\IG}{\\mathrm{IG}}\\newcommand{\\Levy}{\\mathrm{Levy}}\\newcommand{\\MP}{\\mathrm{MP}}\\newcommand{\\Hermite}{\\mathrm{Hermite}}\\newcommand{\\Skellam}{\\mathrm{Skellam}}\\newcommand{\\Dirichlet}{\\mathrm{Dirichlet}}\\renewcommand{\\Beta}{\\mathrm{Beta}}\\newcommand{\\bE}{\\mathbb{E}}\\newcommand{\\bG}{\\mathbb{G}}\\newcommand{\\MISE}{\\mathrm{MISE}}\\newcommand{\\logit}{\\mathtt{logit}}\\newcommand{\\expit}{\\mathtt{expit}}\\newcommand{\\cK}{\\mathcal{K}}\\newcommand{\\dl}{\\dot{l}}\\newcommand{\\dotp}{\\dot{p}}\\newcommand{\\wl}{\\wt{l}}\\newcommand{\\Gauss}{\\mathrm{Gauss}}\\newcommand{\\fA}{\\mathfrak{A}}\\newcommand{\\under}{\\mathrm{under}\\;}\\newcommand{\\whtheta}{\\wh{\\theta}}\\newcommand{\\Em}{\\mathrm{Em}}\\newcommand{\\ztheta}{{\\theta_0}}\n\\newcommand{\\rO}{\\mathrm{O}}\\newcommand{\\Bin}{\\mathrm{Bin}}\\newcommand{\\rW}{\\mathrm{W}}\\newcommand{\\rG}{\\mathrm{G}}\\newcommand{\\rB}{\\mathrm{B}}\\newcommand{\\rU}{\\mathrm{U}}\\newcommand{\\HG}{\\mathrm{HG}}\\newcommand{\\GAMMA}{\\mathrm{Gamma}}\\newcommand{\\Cauchy}{\\mathrm{Cauchy}}\\newcommand{\\rt}{\\mathrm{t}}\\newcommand{\\rF}{\\mathrm{F}}\n\\newcommand{\\FE}{\\mathrm{FE}}\\newcommand{\\bV}{\\boldsymbol{V}}\\newcommand{\\GLS}{\\mathrm{GLS}}\\newcommand{\\be}{\\boldsymbol{e}}\\newcommand{\\POOL}{\\mathrm{POOL}}\\newcommand{\\GMM}{\\mathrm{GMM}}\\newcommand{\\MM}{\\mathrm{MM}}\\newcommand{\\SSIV}{\\mathrm{SSIV}}\\newcommand{\\JIV}{\\mathrm{JIV}}\\newcommand{\\AR}{\\mathrm{AR}}\\newcommand{\\ILS}{\\mathrm{ILS}}\\newcommand{\\SLS}{\\mathrm{SLS}}\\newcommand{\\LIML}{\\mathrm{LIML}}\n\n\\newcommand{\\Rad}{\\mathrm{Rad}}\\newcommand{\\bY}{\\boldsymbol{Y}}\\newcommand{\\pone}{{(1)}}\\newcommand{\\ptwo}{{(2)}}\\newcommand{\\ps}[1]{{(#1)}}\\newcommand{\\fsub}{\\overset{\\text{finite}}{\\subset}}\n\n\n\\newcommand{\\varlim}{\\varprojlim}\\newcommand{\\Hom}{\\mathrm{Hom}}\\newcommand{\\Iso}{\\mathrm{Iso}}\\newcommand{\\Mor}{\\mathrm{Mor}}\\newcommand{\\Isom}{\\mathrm{Isom}}\\newcommand{\\Aut}{\\mathrm{Aut}}\\newcommand{\\End}{\\mathrm{End}}\\newcommand{\\op}{\\mathrm{op}}\\newcommand{\\ev}{\\mathrm{ev}}\\newcommand{\\Ob}{\\mathrm{Ob}}\\newcommand{\\Ar}{\\mathrm{Ar}}\\newcommand{\\Arr}{\\mathrm{Arr}}\\newcommand{\\Set}{\\mathrm{Set}}\\newcommand{\\Grp}{\\mathrm{Grp}}\\newcommand{\\Cat}{\\mathrm{Cat}}\\newcommand{\\Mon}{\\mathrm{Mon}}\\newcommand{\\Ring}{\\mathrm{Ring}}\\newcommand{\\CRing}{\\mathrm{CRing}}\\newcommand{\\Ab}{\\mathrm{Ab}}\\newcommand{\\Pos}{\\mathrm{Pos}}\\newcommand{\\Vect}{\\mathrm{Vect}}\\newcommand{\\FinVect}{\\mathrm{FinVect}}\\newcommand{\\FinSet}{\\mathrm{FinSet}}\\newcommand{\\FinMeas}{\\mathrm{FinMeas}}\\newcommand{\\OmegaAlg}{\\Omega\\text{-}\\mathrm{Alg}}\\newcommand{\\OmegaEAlg}{(\\Omega,E)\\text{-}\\mathrm{Alg}}\\newcommand{\\Fun}{\\mathrm{Fun}}\\newcommand{\\Func}{\\mathrm{Func}}\n\n\\newcommand{\\Stoch}{\\mathrm{Stoch}}\\newcommand{\\FinStoch}{\\mathrm{FinStoch}}\\newcommand{\\Copy}{\\mathrm{copy}}\\newcommand{\\Delete}{\\mathrm{delete}}\n\\newcommand{\\Bool}{\\mathrm{Bool}}\\newcommand{\\CABool}{\\mathrm{CABool}}\\newcommand{\\CompBoolAlg}{\\mathrm{CompBoolAlg}}\\newcommand{\\BoolAlg}{\\mathrm{BoolAlg}}\\newcommand{\\BoolRng}{\\mathrm{BoolRng}}\\newcommand{\\HeytAlg}{\\mathrm{HeytAlg}}\\newcommand{\\CompHeytAlg}{\\mathrm{CompHeytAlg}}\\newcommand{\\Lat}{\\mathrm{Lat}}\\newcommand{\\CompLat}{\\mathrm{CompLat}}\\newcommand{\\SemiLat}{\\mathrm{SemiLat}}\\newcommand{\\Stone}{\\mathrm{Stone}}\\newcommand{\\Mfd}{\\mathrm{Mfd}}\\newcommand{\\LieAlg}{\\mathrm{LieAlg}}\n\\newcommand{\\Op}{\\mathrm{Op}}\n\\newcommand{\\Sh}{\\mathrm{Sh}}\n\\newcommand{\\Diff}{\\mathrm{Diff}}\n\\newcommand{\\B}{\\mathcal{B}}\\newcommand{\\cB}{\\mathcal{B}}\\newcommand{\\Span}{\\mathrm{Span}}\\newcommand{\\Corr}{\\mathrm{Corr}}\\newcommand{\\Decat}{\\mathrm{Decat}}\\newcommand{\\Rep}{\\mathrm{Rep}}\\newcommand{\\Grpd}{\\mathrm{Grpd}}\\newcommand{\\sSet}{\\mathrm{sSet}}\\newcommand{\\Mod}{\\mathrm{Mod}}\\newcommand{\\SmoothMnf}{\\mathrm{SmoothMnf}}\\newcommand{\\coker}{\\mathrm{coker}}\\newcommand{\\Ord}{\\mathrm{Ord}}\\newcommand{\\eq}{\\mathrm{eq}}\\newcommand{\\coeq}{\\mathrm{coeq}}\\newcommand{\\act}{\\mathrm{act}}\n\n\\newcommand{\\apf}{\\mathrm{apf}}\\newcommand{\\opt}{\\mathrm{opt}}\\newcommand{\\IS}{\\mathrm{IS}}\\newcommand{\\IR}{\\mathrm{IR}}\\newcommand{\\iidsim}{\\overset{\\text{iid}}{\\sim}}\\newcommand{\\propt}{\\,\\propto\\,}\\newcommand{\\bM}{\\mathbb{M}}\\newcommand{\\cX}{\\mathcal{X}}\\newcommand{\\cY}{\\mathcal{Y}}\\newcommand{\\cP}{\\mathcal{P}}\\newcommand{\\ola}[1]{\\overleftarrow{#1}}\n\n\\renewcommand{\\iff}{\\;\\mathrm{iff}\\;}\n\\newcommand{\\False}{\\mathrm{False}}\\newcommand{\\True}{\\mathrm{True}}\n\\newcommand{\\otherwise}{\\mathrm{otherwise}}\n\\newcommand{\\suchthat}{\\;\\mathrm{s.t.}\\;}\n\n\\newcommand{\\cM}{\\mathcal{M}}\\newcommand{\\M}{\\mathbb{M}}\\newcommand{\\cF}{\\mathcal{F}}\\newcommand{\\cD}{\\mathcal{D}}\\newcommand{\\fX}{\\mathfrak{X}}\\newcommand{\\fY}{\\mathfrak{Y}}\\newcommand{\\fZ}{\\mathfrak{Z}}\\renewcommand{\\H}{\\mathcal{H}}\\newcommand{\\cH}{\\mathcal{H}}\\newcommand{\\fH}{\\mathfrak{H}}\\newcommand{\\bH}{\\mathbb{H}}\\newcommand{\\id}{\\mathrm{id}}\\newcommand{\\A}{\\mathcal{A}}\n\\newcommand{\\lmd}{\\lambda}\n\\newcommand{\\Lmd}{\\Lambda}\n\\newcommand{\\cI}{\\mathcal{I}}\n\n\\newcommand{\\Lrarrow}{\\;\\;\\Leftrightarrow\\;\\;}\n\\DeclareMathOperator{\\des}{des}\n\\DeclareMathOperator{\\nd}{nd}\n\\DeclareMathOperator{\\dsep}{d-sep}\n\\DeclareMathOperator{\\sep}{sep}\n$$\n\n:::\n\n:::\n\n\n\n### Keywords: PDMP (1/2)\n\n[PDMP]{.underline} (Piecewise Deterministic^[Mostly [deterministic]{.color-unite} with the exception of random jumps happens at random times] Markov Process^[[Continuous-time]{.color-unite}, instead of discrete-time processes]) [@Davis1984]\n\n1. Mostly [deterministic]{.color-unite} with the exception of random jumps happens at random times\n2. [Continuous-time]{.color-unite}, instead of discrete-time processes\n\n{{< fa arrow-right >}} Plays a [complementary role]{.color-unite} to SDEs / Diffusions\n\n| Property | PDMP | SDE |\n|:------:|:------:|:------:|\n| Exactly simulatable? | [{{< fa check >}}]{.color-red} | [{{< fa xmark >}}]{.color-blue} |\n| Subject to discretization errors? | [{{< fa xmark >}}]{.color-blue} | [{{< fa check >}}]{.color-red} |\n| Driving noise | Poisson | Gauss |\n\n: {.hover .responsive-sm tbl-colwidths=\"[60,20,20]\"}\n\n::: {.callout-note appearance=\"simple\" title=\"History of PDMP Applications\"}\n\n1. First applications: control theory, operations research, etc. [@Davis1993]\n2. Second applications: Monte Carlo simulation in material sciences [@Peters-deWith2012]\n3. Third applications: Bayesian statistics [@Bouchard-Cote+2018-BPS]\n\n:::\n\n### Keywords: PDMP (2/2)\n\n* We will concentrate on Zig-Zag sampler [@Bierkens+2019]\n* Other PDMPs: Bouncy sampler [@Bouchard-Cote+2018-BPS] , Boomerang sampler [@Bierkens+2020]\n\n![The most famous three PDMPs. Animated by [@Grazzi2020]](pdmps.gif)\n\n### Menu\n\n::: {.callout-tip appearance=\"simple\" icon=\"false\" title=\"What We've Learned\"}\n\nThe new algorithm 'Zig-Zag Sampler' is based on comtinuous-time process called [PDMP]{.color-unite}.\n\n:::\n\n::: {.callout-tip appearance=\"simple\" icon=\"false\" title=\"What We'll Learn in the Rest of this @sec-Zig-Zag\"}\n\nWe will review 3 instances of the standard (discrete-time) MCMC algorithm: [MH]{.color-unite}, [Lifted MH]{.color-unite}, and [MALA]{.color-unite}.\n\n1. Review: [MH]{.color-unite} (Metropolis-Hastings) algorithm\n2. Review: [Lifted MH]{.color-unite}, A method bridging [MH]{.color-unite} and Zig-Zag\n3. Comparison: [MH]{.color-unite} vs. [Lifted MH]{.color-unite} vs. Zig-Zag\n4. Review: [MALA]{.color-unite} (Metropolis Adjusted Langevin Algorithm)\n5. Comparison: Zig-Zag vs. [MALA]{.color-unite}\n\n:::\n\n### Review: Metropolis-Hastings (1/2)\n\n::: {.callout-tip appearance=\"simple\" icon=\"false\" title=\"[@Metropolis+1953]-[@Hastings1970]\"}\n\nInput: Target distribution $p$, (symmetric) proposal distribution $q$\n\n1. Draw a $X_t\\sim q(-|X_{t-1})$\n2. Compute\n  $$\n  \\alpha(X_{t-1}, X_t) = \\frac{p(X_t)}{p(X_{t-1})}\n  $$\n3. Draw a uniform random number $U\\sim\\rU([0,1])$.\n4. If $\\al(X_{t-1},X_t)\\le U$, then $X_t\\gets X_{t-1}$. Do nothing otherwise.\n5. Return to Step 1.\n\n:::\n\n::: aside\n\nMH algorithm works even without $p$'s normalizing constant. Hence, its ubiquity.\n\n:::\n\n### Review: Metropolis-Hastings (2/2)\n\n::: {.small-letter}\n\nAlternative View: MH is a generic procedure to turn a [simple $q$-Markov chain]{.color-unite} into a [Markov chain converging to $p$]{.color-unite}.\n\n:::\n\n::: {.callout-tip appearance=\"simple\" icon=\"false\" title=\"The Choise of Proposal $q$\"}\n\n* [Random Walk Metropolis]{.underline} [@Metropolis+1953]: Uniform / Gaussian\n  $$\n  q(y|x) = q(y-x) \\in\\left\\{ \\dd{\\rU([0,1])}{\\lambda}(y-x),\\dd{\\rN(0,\\Sigma)}{\\lambda}(y-x)\\right\\}\n  $$\n* [Hybrid / Hamiltonian Monte Carlo]{.underline} [@Duane+1987]: Hamiltonian dynamics\n  $$\n  q(y|x) = \\delta_{x + \\ep \\rho},\\qquad\\ep>0,\\;\\rho\\;\\text{: momentum defined via Hamiltonian}\n  $$\n* [Metropolis-adjusted Langevin algorithm]{.underline} (MALA) [@Besag1994]: Langevin diffusion\n  $$\n  q(-|X_t):=\\text{ the transition probability of } X_t \\text{ where } dX_t=\\nabla\\log p(X_t)\\,dt+\\sqrt{2\\beta^{-1}}dB_t.\n  $$\n\n:::\n\n<!-- ![](Files/arrow-right.svg){.absolute right=-250 top=0 width=\"1000\" height=\"100\" style=\"transform: rotate(90deg);\" .color-unite} -->\n\n### Problem: [Reversibility]{.color-unite}\n\n[Reversibility]{.color-unite} (a.k.a detailed balance):\n$$\np(x)q(x|y)=p(y)q(y|x).\n$$\nIn words:\n$$\n\\text{Probability}[\\text{Going}\\;x\\to y]=\\text{Probability}[\\text{Going}\\;y\\to x].\n$$\n{{< fa arrow-right >}} Harder to explore the entire space\n\n{{< fa arrow-right >}} Slow mixing of [MH]{.color-unite}\n\n::: aside\n\nFrom the beginning of 21th century, many efforts have been made to make [MH]{.color-unite} [irreversible]{.color-unite}.\n\n:::\n\n### Lifting (1/3)\n\n::: {.small-letter}\n\n[Lifting]{.color-unite}: A method to make MH's dynamics [irreversible]{.color-unite}\n\nHow?: By adding an auxiliary variable $\\sigma\\in\\{\\pm1\\}$, called [momentum]{.color-unite}\n\n:::\n\n::: {.callout-tip appearance=\"simple\" icon=\"false\" title=\"Lifted MH [@Turitsyn+2011]\"}\n\nInput: Target $p$, [two]{.color-unite} proposals $q^{(+1)},q^{(-1)}$, and [momentum]{.color-unite} $\\sigma\\in\\{\\pm1\\}$\n\n1. Draw $X_t$ from $q^{(\\sigma)}$\n2. Do a MH step\n3. If accepted, go back to Step 1.\n4. If rejected, [flip the momentum]{.color-unite} and go back to Step 1.\n\n:::\n\n### Lifting (2/3)\n\n::: {layout=\"[50,50]\" layout-valign=\"top\" style=\"margin: 0px; !important\"}\n\n::: {#first-column}\n\n![](Files/lifting_illustration.svg)\n\n![](Files/potential.svg)\n\n:::\n\n::: {#second-column}\n\n::: {style=\"margin-bottom: 50px; !important\"}\n\n$q^{(+1)}$: Only propose $\\rightarrow$ moves\n\n$q^{(-1)}$: Only propose $\\leftarrow$ moves\n\n:::\n\n{{< fa arrow-right >}} Once going uphill, it continues to go uphill.\n\n{{< fa arrow-right >}} This is [irreversible]{.color-unite}, since\n\n\\begin{align*}\n  &\\text{Probability}[x\\to y]\\\\\n  &\\qquad\\ne\\text{Probability}[y\\to x].\n\\end{align*}\n\n:::\n\n:::\n\n### Lifting (3/3)\n\nReversible dynamic of MH has '[irreversified]{.color-unite .artificial-align}'\n\n::: {layout-ncol=3}\n\n![MH](Files/MH_traj.svg)\n\n![[Lifted MH]{.color-unite}](Files/LMH_traj.svg)\n\n::: {#third-column}\n\n::: {.callout-caution appearance=\"simple\" title=\"Caution\"}\n\n**Scale is different** in the vertical axis!\n\n:::\n\n::: small-letter\n\n[Lifted MH]{.color-unite} successfully explores the edges of the target distribution.\n\n:::\n\n:::\n\n:::\n\n::: aside\n\n*Irreversibility actually improves the efficiency of MCMC, as we observe in two slides later.\n\n:::\n\n### Comparison: MH vs. LMH vs. Zig-Zag (1/2)\n\n::: {layout-ncol=3}\n![MH](Files/MH_traj.svg)\n\n![Lifted MH](Files/LMH_traj.svg)\n\n![Zig-Zag](Files/zigzag_traj.svg)\n:::\n\nZig-Zag corresponds to the [limiting case of lifted MH]{.color-unite} as the step size of proposal $q$ goes to zero, as we'll learn later.\n\n{{< fa arrow-right >}} Zig-Zag has a maximum [irreversibility]{.color-unite}.\n\n### Comparison: MH vs. LMH vs. Zig-Zag (2/2)\n\n[Irreversibility]{.color-unite} actually improves the efficiency of MCMC.\n\nFaster decay of **autocorrelation** $\\rho_t\\approx\\Corr[X_0,X_t]$ implies\n\n1. faster mixing of MCMC\n2. lower variance of Monte Carlo estimates\n\n::: {layout-ncol=3}\n![](Files/MH_auto.svg)\n\n![](Files/LMH_auto.svg)\n\n![](Files/zigzag_auto.svg)\n\n![MH](Files/MH_traj.svg)\n\n![Lifted MH](Files/LMH_traj.svg)\n\n![Zig-Zag](Files/zigzag_traj.svg)\n\n:::\n\n### Review: MALA\n\n::: {.callout-tip appearance=\"simple\" icon=\"false\"}\n\n**Langevin diffusion**: A diffusion process defined by the following SDE:\n\n$$\ndX_t=\\nabla\\log p(X_t)\\,dt+\\sqrt{2\\beta^{-1}}dB_t.\n$$\n\n**Langevin diffusion** itself converges to the target distribution $p$ in the sense that ^[under fairly general conditions on $p$.]\n$$\n\\norm{p_t-p}_{L^1}\\to0,\\qquad t\\to\\infty.\n$$\n\n:::\n\nTwo MCMC algorithms derived from **Langevin diffusion**:\n\n::: small-letter\n\n[ULA (Unadjusted Langevin Algorithm)]{.underline}<br>\n$\\quad$ Use the discretization of $(X_t)$. [Discretization errors accumulate]{.color-unite}.\n\n[MALA (Metropolis Adjusted Langevin Algorithm)]{.underline}<br>\n$\\quad$ Use ULA as a proposal in MH, erasing the errors by MH steps.\n\n:::\n\n### Comparison: Zig-Zag vs. MALA (1/3)\n\nHow fast do they go back to high-probability regions? ^[The target here is the standard Cauchy distribution $\\rC(0,1)$, equivalent to $\\rt(1)$ distribution. Its heavy tails hinder the convergence of MCMC.]\n\n::: {layout-ncol=2 style=\"margin: 0px; !important\"}\n![Zig-Zag](../Process/ZigZag_1D.svg)\n\n![MALA](../Process/MALA_1D.svg)\n:::\n\n[Irreversibility]{.color-unite} of Zig-Zag accelerates its convergence.\n\n### Comparison: Zig-Zag vs. MALA (2/3)\n\n::: {layout=\"[40,60]\" layout-valign=\"center\"}\n\n::: {#first-column}\n\n![MALA trajectory](../Process/MALA_1D.svg)\n\n:::\n\n::: {#second-column}\n\n::: {.callout-caution appearance=\"simple\" title=\"Caution: Fake Continuity\"}\n\nThe left plot looks continuous, but **it actually is not**.\n\n:::\n\n:::\n\n:::\n\nMH, including MALA, is actually a [discrete-time process]{.underline}.\n\nThe plot is obtained by [connecting the points]{.underline} by line segments.\n\n### Comparison: Zig-Zag vs. MALA (3/3)\n\nMonte Carlo estimation is also done differently:\n\n::: {layout=\"[30,70]\" layout-valign=\"center\" style=\"margin: 0px; !important\"}\n\n::: {#first-column}\n\n![](../Process/MALA_1D.svg)\n\n:::\n\n::: {#second-column}\n\n[MALA]{.underline} outputs $(X_n)_{n\\in[N]}$ defines\n\n$$\n\\frac{1}{N}\\sum_{n=1}^Nf(X_n)\\xrightarrow{N\\to\\infty}\\int_{\\R^d} f(x)p(x)\\,dx.\n$$\n\n:::\n\n:::\n\n::: {layout=\"[30,70]\" layout-valign=\"top\"}\n\n::: {#first-column}\n\n![](../Process/ZigZag_1D.svg)\n\n:::\n\n::: {#second-column}\n\n[Zig-Zag]{.underline} outputs $(X_t)_{t\\in[0,T]}$ defines\n\n$$\n\\int^T_0f(X_t)\\,dt\\xrightarrow{T\\to\\infty}\\int_{\\R^d} f(x)p(x)\\,dx.\n$$\n\n:::\n\n:::\n\n### Recap of @sec-Zig-Zag\n\n* Zig-Zag Sampler's trajectory is a [PDMP]{.underline}.\n* [PDMP]{.underline}, by design, has maximum [irreversibility]{.color-unite}.\n* [Irreversibility]{.color-unite} leads to faster convergence of Zig-Zag in comparisons against [MH]{.color-unite}, [Lifted MH]{.color-unite}, and especially [MALA]{.color-unite}.\n\n::: {layout-ncol=3}\n![](Files/MH_auto.svg)\n\n![](Files/LMH_auto.svg)\n\n![](Files/zigzag_auto.svg)\n\n![MH](Files/MH_traj.svg)\n\n![Lifted MH](Files/LMH_traj.svg)\n\n![Zig-Zag](Files/zigzag_traj.svg)\n\n:::\n\n## The Algorithm: How to Use It? {#sec-Algorithm}\n\nFast and exact simulation of continuous trajectory.\n\n### Review: MH vs. LMH vs. Zig-Zag (1/2)\n\nAs we've learned before, Zig-Zag corresponds to the [limiting case of lifted MH]{.color-unite} as the step size of proposal $q$ goes to zero.\n\n::: {layout-ncol=3}\n![MH](Files/MH_traj.svg)\n\n![Lifted MH](Files/LMH_traj.svg)\n\n![Zig-Zag](Files/zigzag_traj.svg)\n:::\n\n### Review: MH vs. LMH vs. Zig-Zag (2/2)\n\n'[Limiting case of lifted MH]{.color-unite}' means that we only simulate [**where we should flip the momentum**]{.underline} $\\sigma\\in\\{\\pm1\\}$ in Lifted MH.\n\n::: {layout-ncol=3}\n![MH](Files/MH_traj.svg)\n\n![Lifted MH](Files/LMH_traj.svg)\n\n![Zig-Zag](Files/zigzag_traj.svg)\n:::\n\n### Algorithm (1/2)\n\n'[Limiting case of lifted MH]{.color-unite}' means that we only simulate [**where we should flip the momentum**]{.underline} $\\sigma\\in\\{\\pm1\\}$ in Lifted MH.\n\n::: {.callout-tip appearance=\"simple\" icon=\"false\" title=\"[1d ^[Multidimensional extension is straightforward, but we won't cover it today.] Zig Zag sampler @Bierkens+2019]\"}\n\n**Input**: Gradient $\\nabla\\log p$ of log target density $p$\n\nFor $n\\in\\{1,2,\\cdots,N\\}$:\n\n1. Simulate an first arrival time $T_n$ of a [Poisson point process]{.color-unite} (described in the next slide)\n2. Linearly interpolate until time $T_n$:\n    $$\n    X_t = X_{T_{n-1}} + \\sigma(t-T_{n-1}),\\qquad t\\in[T_{n-1},T_n].\n    $$\n3. Go back to Step 1 with the momentum $\\sigma\\in\\{\\pm1\\}$ flipped\n\n:::\n\n### Algorithm (2/2)\n\n::: {.callout-tip title=\"[Fundamental Property of Zig-Zag Sampler (1d) @Bierkens+2019]\" icon=\"false\"}\n\nLet $U(x):=-\\log p(x)$. Simluating a [Poisson point process]{.color-unite} with a rate function\n$$\n\\lambda(x,\\sigma):=\\Paren{\\sigma U'(x)}_++\\;\\gamma(x)\n$$\nensures the Zig-Zag sampler converges to the target $p$, where $\\gamma$ is an arbitrary non-negative function.\n\n:::\n\nIts ergodicity is ensured as long as there exists $c,C>0$ such that^[With some regularity conditions on $U$. [See @Bierkens-Roberts-Zigg2019].]\n$$\np(x)\\le C\\abs{x}^{-c}.\n$$\n\n\n### Core of the Algorithm\n\nGiven a rate function\n$$\n\\lambda(x,\\sigma):=\\Paren{\\sigma U'(x)}_++\\;\\gamma(x)\n$$\nhow to simulate a corresponding [Poisson point process]{.color-unite}?\n\n::: {.callout-tip appearance=\"simple\" icon=\"false\" title=\"What We'll Learn in the Rest of this @sec-Algorithm\"}\n\n1. What is [Poisson Point Process]{.color-unite}?\n2. How to Simulate It?\n3. Core Technique: [Poisson Thinning]{.color-blue}\n\n**Take Away: Zig-Zag sampling reduces to [Poisson Thinning]{.color-blue}**.\n\n:::\n\n### Simulating [Poisson Point Process]{.color-unite} (1/2)\n\n::: {.callout-tip title=\"What is a [Poisson Point Process]{.color-unite} with rate $\\lambda$?\" icon=\"false\"}\n\nThe number of points in $[0,t]$ follows a Poisson distribution with mean $\\int^t_0\\lambda(x_s,\\sigma_s)\\,ds$:\n$$\nN([0,t])\\sim\\Pois\\paren{M(t)},\\qquad M(t):=\\int^t_0\\lambda(x_s,\\sigma_s)\\,ds.\n$$\nWe want to know when the first point $T_1$ falls on $\\cointerval{0,\\infty}$.\n\n:::\n\n::: {layout=\"[30,70]\" layout-valign=\"center\" style=\"margin: 0px; !important\"}\n\n::: {#first-column}\n\n::: {#5c978c4e .cell execution_count=2}\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"400\" height=\"300\" viewBox=\"0 0 1600 1200\">\n<defs>\n  <clipPath id=\"clip140\">\n    <rect x=\"0\" y=\"0\" width=\"1600\" height=\"1200\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip140)\" d=\"M0 1200 L1600 1200 L1600 0 L0 0  Z\" fill=\"#f0f1eb\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip141\">\n    <rect x=\"320\" y=\"0\" width=\"1121\" height=\"1121\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip140)\" d=\"M173.385 1016.92 L1552.76 1016.92 L1552.76 131.032 L173.385 131.032  Z\" fill=\"#f0f1eb\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip142\">\n    <rect x=\"173\" y=\"131\" width=\"1380\" height=\"887\"/>\n  </clipPath>\n</defs>\n<polyline clip-path=\"url(#clip142)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"369.414,1016.92 369.414,131.032 \"/>\n<polyline clip-path=\"url(#clip142)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"749.359,1016.92 749.359,131.032 \"/>\n<polyline clip-path=\"url(#clip142)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1129.3,1016.92 1129.3,131.032 \"/>\n<polyline clip-path=\"url(#clip142)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1509.25,1016.92 1509.25,131.032 \"/>\n<polyline clip-path=\"url(#clip140)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"173.385,1016.92 1552.76,1016.92 \"/>\n<polyline clip-path=\"url(#clip140)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"369.414,1016.92 369.414,998.022 \"/>\n<polyline clip-path=\"url(#clip140)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"749.359,1016.92 749.359,998.022 \"/>\n<polyline clip-path=\"url(#clip140)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1129.3,1016.92 1129.3,998.022 \"/>\n<polyline clip-path=\"url(#clip140)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1509.25,1016.92 1509.25,998.022 \"/>\n<path clip-path=\"url(#clip140)\" d=\"M364.067 1068.98 L380.386 1068.98 L380.386 1072.92 L358.442 1072.92 L358.442 1068.98 Q361.104 1066.23 365.687 1061.6 Q370.293 1056.95 371.474 1055.61 Q373.719 1053.08 374.599 1051.35 Q375.502 1049.59 375.502 1047.9 Q375.502 1045.14 373.557 1043.41 Q371.636 1041.67 368.534 1041.67 Q366.335 1041.67 363.881 1042.43 Q361.451 1043.2 358.673 1044.75 L358.673 1040.03 Q361.497 1038.89 363.951 1038.31 Q366.405 1037.73 368.442 1037.73 Q373.812 1037.73 377.006 1040.42 Q380.201 1043.11 380.201 1047.6 Q380.201 1049.73 379.391 1051.65 Q378.604 1053.54 376.497 1056.14 Q375.918 1056.81 372.817 1060.03 Q369.715 1063.22 364.067 1068.98 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M752.368 1042.43 L740.563 1060.88 L752.368 1060.88 L752.368 1042.43 M751.141 1038.36 L757.021 1038.36 L757.021 1060.88 L761.952 1060.88 L761.952 1064.77 L757.021 1064.77 L757.021 1072.92 L752.368 1072.92 L752.368 1064.77 L736.767 1064.77 L736.767 1060.26 L751.141 1038.36 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M1129.71 1053.78 Q1126.56 1053.78 1124.71 1055.93 Q1122.88 1058.08 1122.88 1061.83 Q1122.88 1065.56 1124.71 1067.73 Q1126.56 1069.89 1129.71 1069.89 Q1132.86 1069.89 1134.69 1067.73 Q1136.54 1065.56 1136.54 1061.83 Q1136.54 1058.08 1134.69 1055.93 Q1132.86 1053.78 1129.71 1053.78 M1138.99 1039.12 L1138.99 1043.38 Q1137.23 1042.55 1135.43 1042.11 Q1133.64 1041.67 1131.89 1041.67 Q1127.26 1041.67 1124.8 1044.79 Q1122.37 1047.92 1122.02 1054.24 Q1123.39 1052.23 1125.45 1051.16 Q1127.51 1050.07 1129.99 1050.07 Q1135.2 1050.07 1138.2 1053.24 Q1141.24 1056.39 1141.24 1061.83 Q1141.24 1067.16 1138.09 1070.37 Q1134.94 1073.59 1129.71 1073.59 Q1123.71 1073.59 1120.54 1069.01 Q1117.37 1064.4 1117.37 1055.67 Q1117.37 1047.48 1121.26 1042.62 Q1125.15 1037.73 1131.7 1037.73 Q1133.46 1037.73 1135.24 1038.08 Q1137.05 1038.43 1138.99 1039.12 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M1509.25 1056.51 Q1505.92 1056.51 1504 1058.29 Q1502.1 1060.07 1502.1 1063.2 Q1502.1 1066.32 1504 1068.11 Q1505.92 1069.89 1509.25 1069.89 Q1512.58 1069.89 1514.5 1068.11 Q1516.43 1066.3 1516.43 1063.2 Q1516.43 1060.07 1514.5 1058.29 Q1512.61 1056.51 1509.25 1056.51 M1504.57 1054.52 Q1501.56 1053.78 1499.87 1051.72 Q1498.21 1049.66 1498.21 1046.69 Q1498.21 1042.55 1501.15 1040.14 Q1504.11 1037.73 1509.25 1037.73 Q1514.41 1037.73 1517.35 1040.14 Q1520.29 1042.55 1520.29 1046.69 Q1520.29 1049.66 1518.6 1051.72 Q1516.93 1053.78 1513.95 1054.52 Q1517.33 1055.3 1519.2 1057.6 Q1521.1 1059.89 1521.1 1063.2 Q1521.1 1068.22 1518.02 1070.91 Q1514.97 1073.59 1509.25 1073.59 Q1503.53 1073.59 1500.45 1070.91 Q1497.4 1068.22 1497.4 1063.2 Q1497.4 1059.89 1499.3 1057.6 Q1501.19 1055.3 1504.57 1054.52 M1502.86 1047.13 Q1502.86 1049.82 1504.53 1051.32 Q1506.22 1052.83 1509.25 1052.83 Q1512.26 1052.83 1513.95 1051.32 Q1515.66 1049.82 1515.66 1047.13 Q1515.66 1044.45 1513.95 1042.94 Q1512.26 1041.44 1509.25 1041.44 Q1506.22 1041.44 1504.53 1042.94 Q1502.86 1044.45 1502.86 1047.13 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M784.947 1102.26 L825.147 1102.26 L825.147 1107.67 L808.278 1107.67 L808.278 1149.78 L801.817 1149.78 L801.817 1107.67 L784.947 1107.67 L784.947 1102.26 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M829.094 1114.14 L834.95 1114.14 L834.95 1149.78 L829.094 1149.78 L829.094 1114.14 M829.094 1100.26 L834.95 1100.26 L834.95 1107.67 L829.094 1107.67 L829.094 1100.26 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M874.959 1120.98 Q877.155 1117.03 880.21 1115.15 Q883.266 1113.28 887.403 1113.28 Q892.973 1113.28 895.997 1117.19 Q899.021 1121.07 899.021 1128.27 L899.021 1149.78 L893.133 1149.78 L893.133 1128.46 Q893.133 1123.33 891.318 1120.85 Q889.504 1118.37 885.78 1118.37 Q881.229 1118.37 878.587 1121.39 Q875.945 1124.42 875.945 1129.64 L875.945 1149.78 L870.057 1149.78 L870.057 1128.46 Q870.057 1123.3 868.243 1120.85 Q866.428 1118.37 862.641 1118.37 Q858.153 1118.37 855.511 1121.42 Q852.87 1124.45 852.87 1129.64 L852.87 1149.78 L846.981 1149.78 L846.981 1114.14 L852.87 1114.14 L852.87 1119.67 Q854.875 1116.4 857.676 1114.84 Q860.477 1113.28 864.328 1113.28 Q868.211 1113.28 870.916 1115.25 Q873.654 1117.22 874.959 1120.98 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M941.194 1130.5 L941.194 1133.36 L914.267 1133.36 Q914.649 1139.41 917.895 1142.59 Q921.174 1145.74 926.998 1145.74 Q930.372 1145.74 933.523 1144.91 Q936.706 1144.09 939.825 1142.43 L939.825 1147.97 Q936.674 1149.31 933.364 1150.01 Q930.054 1150.71 926.648 1150.71 Q918.118 1150.71 913.121 1145.74 Q908.156 1140.78 908.156 1132.31 Q908.156 1123.56 912.866 1118.43 Q917.609 1113.28 925.63 1113.28 Q932.823 1113.28 936.992 1117.92 Q941.194 1122.54 941.194 1130.5 M935.337 1128.78 Q935.274 1123.97 932.632 1121.11 Q930.022 1118.24 925.693 1118.24 Q920.792 1118.24 917.832 1121.01 Q914.903 1123.78 914.458 1128.81 L935.337 1128.78 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><polyline clip-path=\"url(#clip142)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"173.385,991.848 1552.76,991.848 \"/>\n<polyline clip-path=\"url(#clip142)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"173.385,753.064 1552.76,753.064 \"/>\n<polyline clip-path=\"url(#clip142)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"173.385,514.28 1552.76,514.28 \"/>\n<polyline clip-path=\"url(#clip142)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"173.385,275.496 1552.76,275.496 \"/>\n<polyline clip-path=\"url(#clip140)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"173.385,1016.92 173.385,131.032 \"/>\n<polyline clip-path=\"url(#clip140)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"173.385,991.848 192.283,991.848 \"/>\n<polyline clip-path=\"url(#clip140)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"173.385,753.064 192.283,753.064 \"/>\n<polyline clip-path=\"url(#clip140)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"173.385,514.28 192.283,514.28 \"/>\n<polyline clip-path=\"url(#clip140)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"173.385,275.496 192.283,275.496 \"/>\n<path clip-path=\"url(#clip140)\" d=\"M137.441 977.646 Q133.83 977.646 132.001 981.211 Q130.195 984.753 130.195 991.882 Q130.195 998.989 132.001 1002.55 Q133.83 1006.1 137.441 1006.1 Q141.075 1006.1 142.881 1002.55 Q144.709 998.989 144.709 991.882 Q144.709 984.753 142.881 981.211 Q141.075 977.646 137.441 977.646 M137.441 973.943 Q143.251 973.943 146.307 978.549 Q149.385 983.132 149.385 991.882 Q149.385 1000.61 146.307 1005.22 Q143.251 1009.8 137.441 1009.8 Q131.631 1009.8 128.552 1005.22 Q125.496 1000.61 125.496 991.882 Q125.496 983.132 128.552 978.549 Q131.631 973.943 137.441 973.943 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M133.066 766.409 L149.385 766.409 L149.385 770.344 L127.441 770.344 L127.441 766.409 Q130.103 763.654 134.686 759.024 Q139.293 754.372 140.473 753.029 Q142.719 750.506 143.598 748.77 Q144.501 747.011 144.501 745.321 Q144.501 742.566 142.557 740.83 Q140.635 739.094 137.533 739.094 Q135.334 739.094 132.881 739.858 Q130.45 740.622 127.672 742.173 L127.672 737.45 Q130.496 736.316 132.95 735.738 Q135.404 735.159 137.441 735.159 Q142.811 735.159 146.006 737.844 Q149.2 740.529 149.2 745.02 Q149.2 747.149 148.39 749.071 Q147.603 750.969 145.496 753.561 Q144.918 754.233 141.816 757.45 Q138.714 760.645 133.066 766.409 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M139.802 501.074 L127.996 519.523 L139.802 519.523 L139.802 501.074 M138.575 497 L144.455 497 L144.455 519.523 L149.385 519.523 L149.385 523.412 L144.455 523.412 L144.455 531.56 L139.802 531.56 L139.802 523.412 L124.2 523.412 L124.2 518.898 L138.575 497 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M137.857 273.633 Q134.709 273.633 132.858 275.786 Q131.029 277.938 131.029 281.688 Q131.029 285.415 132.858 287.591 Q134.709 289.744 137.857 289.744 Q141.006 289.744 142.834 287.591 Q144.686 285.415 144.686 281.688 Q144.686 277.938 142.834 275.786 Q141.006 273.633 137.857 273.633 M147.14 258.98 L147.14 263.239 Q145.381 262.406 143.575 261.966 Q141.793 261.526 140.033 261.526 Q135.404 261.526 132.95 264.651 Q130.52 267.776 130.172 274.096 Q131.538 272.082 133.598 271.017 Q135.658 269.929 138.135 269.929 Q143.344 269.929 146.353 273.1 Q149.385 276.249 149.385 281.688 Q149.385 287.012 146.237 290.23 Q143.089 293.448 137.857 293.448 Q131.862 293.448 128.691 288.864 Q125.52 284.258 125.52 275.531 Q125.52 267.337 129.408 262.476 Q133.297 257.591 139.848 257.591 Q141.607 257.591 143.39 257.939 Q145.195 258.286 147.14 258.98 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M52.7883 559.537 Q53.2392 559.537 54.302 559.827 L79.4869 566.139 Q85.0908 567.524 89.0199 572.033 Q92.949 576.51 92.949 581.598 Q92.949 584.658 91.3065 586.622 Q89.6962 588.587 87.2164 588.587 Q85.0264 588.587 83.9636 587.428 Q82.933 586.268 82.933 584.883 Q82.933 584.432 83.0618 583.949 Q83.1906 583.466 83.7381 582.951 Q84.2856 582.436 85.2196 582.436 Q86.7333 582.436 87.9249 583.756 Q88.4724 584.4 88.6012 585.012 Q88.73 585.592 88.73 586.59 Q89.6318 586.204 90.2437 585.495 Q90.8556 584.787 91.0811 583.982 Q91.3387 583.176 91.4031 582.661 Q91.4997 582.114 91.4997 581.598 Q91.4997 577.476 87.3452 574.32 Q86.0891 573.386 84.8331 572.709 Q83.6093 572.001 82.0956 571.486 Q80.6141 570.97 79.809 570.745 Q79.0039 570.487 77.1681 570.036 Q80.1633 573.032 80.1633 576.703 Q80.1633 578.249 79.7446 579.634 Q79.3259 580.986 78.4564 582.178 Q77.5546 583.37 75.9765 584.078 Q74.3984 584.754 72.305 584.754 Q70.0828 584.754 67.0555 583.885 Q64.0281 583.015 58.4565 580.922 Q55.3325 579.795 53.8189 579.795 Q53.0781 579.795 52.6273 579.956 Q52.1442 580.117 51.9831 580.439 Q51.7899 580.761 51.7577 580.954 Q51.7255 581.115 51.7255 581.437 Q51.7255 583.337 53.6578 585.109 Q55.5902 586.88 59.9058 588.104 Q60.7109 588.362 60.9042 588.523 Q61.0974 588.684 61.0974 589.167 Q61.0652 589.972 60.4211 589.972 Q60.1634 589.972 59.165 589.682 Q58.1345 589.392 56.6208 588.716 Q55.0749 588.007 53.69 587.041 Q52.273 586.075 51.2746 584.561 Q50.2762 583.015 50.2762 581.244 Q50.2762 578.829 51.8543 577.347 Q53.4002 575.833 55.6868 575.833 Q56.6208 575.833 57.4581 576.091 Q58.2633 576.317 60.4211 577.154 Q69.1167 580.535 73.3678 580.535 Q74.3984 580.535 75.268 580.374 Q76.1053 580.181 76.9427 579.763 Q77.7478 579.344 78.2309 578.507 Q78.6818 577.637 78.6818 576.445 Q78.6818 574.932 77.9733 573.515 Q77.2325 572.065 76.2342 571.164 Q75.2358 570.23 74.3984 569.682 Q73.5289 569.102 73.078 568.974 L61.2262 566.011 L55.9445 564.69 Q53.0781 564.078 52.3696 563.788 Q51.6933 563.402 51.339 562.726 Q50.9848 562.049 50.9848 561.47 Q50.9848 560.664 51.4678 560.117 Q51.9509 559.537 52.7883 559.537 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M218.262 28.9734 L218.262 51.6989 L228.551 51.6989 Q234.263 51.6989 237.382 48.7418 Q240.501 45.7846 240.501 40.3159 Q240.501 34.8877 237.382 31.9305 Q234.263 28.9734 228.551 28.9734 L218.262 28.9734 M210.079 22.2489 L228.551 22.2489 Q238.719 22.2489 243.904 26.8669 Q249.13 31.4444 249.13 40.3159 Q249.13 49.2684 243.904 53.8459 Q238.719 58.4234 228.551 58.4234 L218.262 58.4234 L218.262 82.7289 L210.079 82.7289 L210.079 22.2489 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M274.407 42.5844 Q268.412 42.5844 264.928 47.2835 Q261.445 51.942 261.445 60.0843 Q261.445 68.2266 264.888 72.9257 Q268.372 77.5842 274.407 77.5842 Q280.362 77.5842 283.846 72.8852 Q287.33 68.1861 287.33 60.0843 Q287.33 52.023 283.846 47.324 Q280.362 42.5844 274.407 42.5844 M274.407 36.265 Q284.13 36.265 289.679 42.5844 Q295.229 48.9038 295.229 60.0843 Q295.229 71.2243 289.679 77.5842 Q284.13 83.9036 274.407 83.9036 Q264.645 83.9036 259.095 77.5842 Q253.586 71.2243 253.586 60.0843 Q253.586 48.9038 259.095 42.5844 Q264.645 36.265 274.407 36.265 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M307.584 37.3587 L315.038 37.3587 L315.038 82.7289 L307.584 82.7289 L307.584 37.3587 M307.584 19.6968 L315.038 19.6968 L315.038 29.1354 L307.584 29.1354 L307.584 19.6968 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M359.557 38.6955 L359.557 45.7441 Q356.398 44.1238 352.995 43.3136 Q349.592 42.5034 345.946 42.5034 Q340.397 42.5034 337.602 44.2048 Q334.847 45.9062 334.847 49.3089 Q334.847 51.9015 336.832 53.4003 Q338.817 54.8587 344.812 56.1955 L347.364 56.7626 Q355.304 58.464 358.626 61.5832 Q361.988 64.6618 361.988 70.2116 Q361.988 76.531 356.965 80.2173 Q351.982 83.9036 343.232 83.9036 Q339.586 83.9036 335.617 83.1745 Q331.687 82.4858 327.312 81.068 L327.312 73.3713 Q331.444 75.5183 335.455 76.612 Q339.465 77.6652 343.394 77.6652 Q348.66 77.6652 351.496 75.8828 Q354.332 74.0599 354.332 70.7787 Q354.332 67.7405 352.266 66.1202 Q350.24 64.4998 343.313 63.001 L340.721 62.3933 Q333.794 60.935 330.715 57.9373 Q327.636 54.8992 327.636 49.633 Q327.636 43.2326 332.173 39.7488 Q336.71 36.265 345.055 36.265 Q349.187 36.265 352.833 36.8726 Q356.479 37.4803 359.557 38.6955 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M402.781 38.6955 L402.781 45.7441 Q399.621 44.1238 396.218 43.3136 Q392.815 42.5034 389.17 42.5034 Q383.62 42.5034 380.825 44.2048 Q378.07 45.9062 378.07 49.3089 Q378.07 51.9015 380.055 53.4003 Q382.04 54.8587 388.035 56.1955 L390.587 56.7626 Q398.527 58.464 401.849 61.5832 Q405.211 64.6618 405.211 70.2116 Q405.211 76.531 400.188 80.2173 Q395.205 83.9036 386.455 83.9036 Q382.81 83.9036 378.84 83.1745 Q374.91 82.4858 370.535 81.068 L370.535 73.3713 Q374.667 75.5183 378.678 76.612 Q382.688 77.6652 386.617 77.6652 Q391.884 77.6652 394.719 75.8828 Q397.555 74.0599 397.555 70.7787 Q397.555 67.7405 395.489 66.1202 Q393.463 64.4998 386.536 63.001 L383.944 62.3933 Q377.017 60.935 373.938 57.9373 Q370.859 54.8992 370.859 49.633 Q370.859 43.2326 375.396 39.7488 Q379.933 36.265 388.278 36.265 Q392.41 36.265 396.056 36.8726 Q399.702 37.4803 402.781 38.6955 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M434.661 42.5844 Q428.666 42.5844 425.182 47.2835 Q421.698 51.942 421.698 60.0843 Q421.698 68.2266 425.142 72.9257 Q428.625 77.5842 434.661 77.5842 Q440.616 77.5842 444.1 72.8852 Q447.584 68.1861 447.584 60.0843 Q447.584 52.023 444.1 47.324 Q440.616 42.5844 434.661 42.5844 M434.661 36.265 Q444.383 36.265 449.933 42.5844 Q455.483 48.9038 455.483 60.0843 Q455.483 71.2243 449.933 77.5842 Q444.383 83.9036 434.661 83.9036 Q424.899 83.9036 419.349 77.5842 Q413.84 71.2243 413.84 60.0843 Q413.84 48.9038 419.349 42.5844 Q424.899 36.265 434.661 36.265 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M505.552 55.3448 L505.552 82.7289 L498.098 82.7289 L498.098 55.5878 Q498.098 49.1469 495.587 45.9467 Q493.075 42.7465 488.052 42.7465 Q482.016 42.7465 478.532 46.5948 Q475.049 50.4432 475.049 57.0867 L475.049 82.7289 L467.555 82.7289 L467.555 37.3587 L475.049 37.3587 L475.049 44.4073 Q477.722 40.3159 481.328 38.2905 Q484.973 36.265 489.713 36.265 Q497.531 36.265 501.542 41.1261 Q505.552 45.9467 505.552 55.3448 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M555.297 28.9734 L555.297 51.6989 L565.586 51.6989 Q571.298 51.6989 574.417 48.7418 Q577.537 45.7846 577.537 40.3159 Q577.537 34.8877 574.417 31.9305 Q571.298 28.9734 565.586 28.9734 L555.297 28.9734 M547.114 22.2489 L565.586 22.2489 Q575.754 22.2489 580.939 26.8669 Q586.165 31.4444 586.165 40.3159 Q586.165 49.2684 580.939 53.8459 Q575.754 58.4234 565.586 58.4234 L555.297 58.4234 L555.297 82.7289 L547.114 82.7289 L547.114 22.2489 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M611.443 42.5844 Q605.447 42.5844 601.964 47.2835 Q598.48 51.942 598.48 60.0843 Q598.48 68.2266 601.923 72.9257 Q605.407 77.5842 611.443 77.5842 Q617.397 77.5842 620.881 72.8852 Q624.365 68.1861 624.365 60.0843 Q624.365 52.023 620.881 47.324 Q617.397 42.5844 611.443 42.5844 M611.443 36.265 Q621.165 36.265 626.715 42.5844 Q632.264 48.9038 632.264 60.0843 Q632.264 71.2243 626.715 77.5842 Q621.165 83.9036 611.443 83.9036 Q601.68 83.9036 596.13 77.5842 Q590.621 71.2243 590.621 60.0843 Q590.621 48.9038 596.13 42.5844 Q601.68 36.265 611.443 36.265 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M644.62 37.3587 L652.073 37.3587 L652.073 82.7289 L644.62 82.7289 L644.62 37.3587 M644.62 19.6968 L652.073 19.6968 L652.073 29.1354 L644.62 29.1354 L644.62 19.6968 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M705.383 55.3448 L705.383 82.7289 L697.929 82.7289 L697.929 55.5878 Q697.929 49.1469 695.418 45.9467 Q692.906 42.7465 687.883 42.7465 Q681.847 42.7465 678.364 46.5948 Q674.88 50.4432 674.88 57.0867 L674.88 82.7289 L667.386 82.7289 L667.386 37.3587 L674.88 37.3587 L674.88 44.4073 Q677.553 40.3159 681.159 38.2905 Q684.805 36.265 689.544 36.265 Q697.362 36.265 701.373 41.1261 Q705.383 45.9467 705.383 55.3448 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M727.623 24.4769 L727.623 37.3587 L742.976 37.3587 L742.976 43.1515 L727.623 43.1515 L727.623 67.781 Q727.623 73.3308 729.121 74.9106 Q730.661 76.4905 735.319 76.4905 L742.976 76.4905 L742.976 82.7289 L735.319 82.7289 Q726.691 82.7289 723.41 79.5287 Q720.128 76.2879 720.128 67.781 L720.128 43.1515 L714.66 43.1515 L714.66 37.3587 L720.128 37.3587 L720.128 24.4769 L727.623 24.4769 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M787.657 28.9734 L787.657 51.6989 L797.946 51.6989 Q803.658 51.6989 806.777 48.7418 Q809.896 45.7846 809.896 40.3159 Q809.896 34.8877 806.777 31.9305 Q803.658 28.9734 797.946 28.9734 L787.657 28.9734 M779.474 22.2489 L797.946 22.2489 Q808.114 22.2489 813.299 26.8669 Q818.525 31.4444 818.525 40.3159 Q818.525 49.2684 813.299 53.8459 Q808.114 58.4234 797.946 58.4234 L787.657 58.4234 L787.657 82.7289 L779.474 82.7289 L779.474 22.2489 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M854.011 44.3263 Q852.755 43.5971 851.256 43.2731 Q849.798 42.9085 848.015 42.9085 Q841.696 42.9085 838.293 47.0404 Q834.931 51.1318 834.931 58.8285 L834.931 82.7289 L827.437 82.7289 L827.437 37.3587 L834.931 37.3587 L834.931 44.4073 Q837.281 40.2754 841.048 38.2905 Q844.815 36.265 850.203 36.265 Q850.973 36.265 851.904 36.3865 Q852.836 36.4675 853.97 36.6701 L854.011 44.3263 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M877.587 42.5844 Q871.592 42.5844 868.108 47.2835 Q864.624 51.942 864.624 60.0843 Q864.624 68.2266 868.067 72.9257 Q871.551 77.5842 877.587 77.5842 Q883.542 77.5842 887.026 72.8852 Q890.509 68.1861 890.509 60.0843 Q890.509 52.023 887.026 47.324 Q883.542 42.5844 877.587 42.5844 M877.587 36.265 Q887.309 36.265 892.859 42.5844 Q898.409 48.9038 898.409 60.0843 Q898.409 71.2243 892.859 77.5842 Q887.309 83.9036 877.587 83.9036 Q867.824 83.9036 862.275 77.5842 Q856.765 71.2243 856.765 60.0843 Q856.765 48.9038 862.275 42.5844 Q867.824 36.265 877.587 36.265 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M943.414 39.1006 L943.414 46.0682 Q940.255 44.3263 937.054 43.4756 Q933.895 42.5844 930.654 42.5844 Q923.403 42.5844 919.392 47.2024 Q915.382 51.78 915.382 60.0843 Q915.382 68.3887 919.392 73.0067 Q923.403 77.5842 930.654 77.5842 Q933.895 77.5842 937.054 76.7335 Q940.255 75.8423 943.414 74.1004 L943.414 80.987 Q940.295 82.4453 936.933 83.1745 Q933.611 83.9036 929.844 83.9036 Q919.595 83.9036 913.559 77.4627 Q907.523 71.0218 907.523 60.0843 Q907.523 48.9848 913.6 42.6249 Q919.716 36.265 930.33 36.265 Q933.773 36.265 937.054 36.9942 Q940.336 37.6828 943.414 39.1006 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M995.185 58.1804 L995.185 61.8262 L960.914 61.8262 Q961.4 69.5229 965.532 73.5738 Q969.705 77.5842 977.118 77.5842 Q981.412 77.5842 985.422 76.531 Q989.473 75.4778 993.443 73.3713 L993.443 80.4199 Q989.433 82.1212 985.22 83.0124 Q981.007 83.9036 976.672 83.9036 Q965.816 83.9036 959.456 77.5842 Q953.136 71.2648 953.136 60.4894 Q953.136 49.3494 959.132 42.8275 Q965.168 36.265 975.376 36.265 Q984.531 36.265 989.838 42.1793 Q995.185 48.0531 995.185 58.1804 M987.731 55.9929 Q987.65 49.876 984.288 46.2302 Q980.966 42.5844 975.457 42.5844 Q969.219 42.5844 965.451 46.1087 Q961.724 49.633 961.157 56.0334 L987.731 55.9929 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M1036.34 38.6955 L1036.34 45.7441 Q1033.18 44.1238 1029.78 43.3136 Q1026.38 42.5034 1022.73 42.5034 Q1017.18 42.5034 1014.39 44.2048 Q1011.63 45.9062 1011.63 49.3089 Q1011.63 51.9015 1013.62 53.4003 Q1015.6 54.8587 1021.6 56.1955 L1024.15 56.7626 Q1032.09 58.464 1035.41 61.5832 Q1038.77 64.6618 1038.77 70.2116 Q1038.77 76.531 1033.75 80.2173 Q1028.77 83.9036 1020.02 83.9036 Q1016.37 83.9036 1012.4 83.1745 Q1008.47 82.4858 1004.1 81.068 L1004.1 73.3713 Q1008.23 75.5183 1012.24 76.612 Q1016.25 77.6652 1020.18 77.6652 Q1025.45 77.6652 1028.28 75.8828 Q1031.12 74.0599 1031.12 70.7787 Q1031.12 67.7405 1029.05 66.1202 Q1027.02 64.4998 1020.1 63.001 L1017.51 62.3933 Q1010.58 60.935 1007.5 57.9373 Q1004.42 54.8992 1004.42 49.633 Q1004.42 43.2326 1008.96 39.7488 Q1013.49 36.265 1021.84 36.265 Q1025.97 36.265 1029.62 36.8726 Q1033.26 37.4803 1036.34 38.6955 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M1079.57 38.6955 L1079.57 45.7441 Q1076.41 44.1238 1073 43.3136 Q1069.6 42.5034 1065.95 42.5034 Q1060.4 42.5034 1057.61 44.2048 Q1054.85 45.9062 1054.85 49.3089 Q1054.85 51.9015 1056.84 53.4003 Q1058.82 54.8587 1064.82 56.1955 L1067.37 56.7626 Q1075.31 58.464 1078.63 61.5832 Q1082 64.6618 1082 70.2116 Q1082 76.531 1076.97 80.2173 Q1071.99 83.9036 1063.24 83.9036 Q1059.59 83.9036 1055.62 83.1745 Q1051.69 82.4858 1047.32 81.068 L1047.32 73.3713 Q1051.45 75.5183 1055.46 76.612 Q1059.47 77.6652 1063.4 77.6652 Q1068.67 77.6652 1071.5 75.8828 Q1074.34 74.0599 1074.34 70.7787 Q1074.34 67.7405 1072.27 66.1202 Q1070.25 64.4998 1063.32 63.001 L1060.73 62.3933 Q1053.8 60.935 1050.72 57.9373 Q1047.64 54.8992 1047.64 49.633 Q1047.64 43.2326 1052.18 39.7488 Q1056.72 36.265 1065.06 36.265 Q1069.19 36.265 1072.84 36.8726 Q1076.49 37.4803 1079.57 38.6955 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M1115.9 37.3587 L1123.36 37.3587 L1132.67 72.7637 L1141.95 37.3587 L1150.74 37.3587 L1160.06 72.7637 L1169.33 37.3587 L1176.79 37.3587 L1164.92 82.7289 L1156.13 82.7289 L1146.36 45.5416 L1136.56 82.7289 L1127.77 82.7289 L1115.9 37.3587 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M1188.09 37.3587 L1195.54 37.3587 L1195.54 82.7289 L1188.09 82.7289 L1188.09 37.3587 M1188.09 19.6968 L1195.54 19.6968 L1195.54 29.1354 L1188.09 29.1354 L1188.09 19.6968 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M1218.51 24.4769 L1218.51 37.3587 L1233.86 37.3587 L1233.86 43.1515 L1218.51 43.1515 L1218.51 67.781 Q1218.51 73.3308 1220.01 74.9106 Q1221.55 76.4905 1226.21 76.4905 L1233.86 76.4905 L1233.86 82.7289 L1226.21 82.7289 Q1217.58 82.7289 1214.3 79.5287 Q1211.02 76.2879 1211.02 67.781 L1211.02 43.1515 L1205.55 43.1515 L1205.55 37.3587 L1211.02 37.3587 L1211.02 24.4769 L1218.51 24.4769 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M1281.38 55.3448 L1281.38 82.7289 L1273.93 82.7289 L1273.93 55.5878 Q1273.93 49.1469 1271.42 45.9467 Q1268.9 42.7465 1263.88 42.7465 Q1257.85 42.7465 1254.36 46.5948 Q1250.88 50.4432 1250.88 57.0867 L1250.88 82.7289 L1243.38 82.7289 L1243.38 19.6968 L1250.88 19.6968 L1250.88 44.4073 Q1253.55 40.3159 1257.16 38.2905 Q1260.8 36.265 1265.54 36.265 Q1273.36 36.265 1277.37 41.1261 Q1281.38 45.9467 1281.38 55.3448 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M1356.32 82.8109 Q1356.32 83.5896 1355.42 83.6716 L1353.58 83.6716 Q1351.69 83.6716 1350.87 83.3847 Q1350.05 83.0978 1349.11 81.7861 Q1348.54 80.9663 1347.1 77.1543 Q1345.71 73.3013 1343.66 67.4809 Q1341.65 61.6604 1340.3 58.2173 L1320.09 82.073 Q1318.7 83.8356 1317.3 83.8356 Q1316.28 83.8356 1315.54 83.1388 Q1314.8 82.442 1314.8 81.3762 Q1314.8 80.5974 1315.09 80.1466 Q1315.42 79.6957 1316.28 78.7939 L1339.48 55.7989 L1331.32 32.9679 Q1329.76 28.746 1328.86 27.6803 Q1328 26.6146 1325.87 26.2456 Q1325.09 26.0407 1325.09 25.3849 Q1325.09 24.4831 1326.61 24.4831 Q1334.72 24.4831 1336.85 30.4266 L1353.99 78.1791 Q1354.93 80.9253 1355.91 82.073 Q1356.32 82.6059 1356.32 82.8109 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M1441.94 44.2809 Q1442.43 44.7728 1442.43 45.4696 Q1442.43 46.1664 1441.94 46.6583 Q1441.45 47.1502 1440.75 47.1502 L1388.21 47.1502 Q1387.51 47.1502 1387.02 46.6583 Q1386.53 46.1664 1386.53 45.4696 Q1386.53 44.7728 1387.02 44.2809 Q1387.51 43.7891 1388.21 43.7891 L1440.75 43.7891 Q1441.45 43.7891 1441.94 44.2809 M1441.94 60.5537 Q1442.43 61.0455 1442.43 61.7424 Q1442.43 62.4392 1441.94 62.9311 Q1441.45 63.4229 1440.75 63.4229 L1388.21 63.4229 Q1387.51 63.4229 1387.02 62.9311 Q1386.53 62.4392 1386.53 61.7424 Q1386.53 61.0455 1387.02 60.5537 Q1387.51 60.0618 1388.21 60.0618 L1440.75 60.0618 Q1441.45 60.0618 1441.94 60.5537 M1441.94 76.8264 Q1442.43 77.3183 1442.43 78.0151 Q1442.43 78.7119 1441.94 79.2038 Q1441.45 79.6957 1440.75 79.6957 L1388.21 79.6957 Q1387.51 79.6957 1387.02 79.2038 Q1386.53 78.7119 1386.53 78.0151 Q1386.53 77.3183 1387.02 76.8264 Q1387.51 76.3345 1388.21 76.3345 L1440.75 76.3345 Q1441.45 76.3345 1441.94 76.8264 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip140)\" d=\"M1474.49 34.8124 L1474.49 32.1891 Q1484.57 32.1891 1489.78 26.8195 Q1491.21 26.8195 1491.46 27.1474 Q1491.7 27.4753 1491.7 28.9919 L1491.7 76.0886 Q1491.7 78.589 1492.93 79.3678 Q1494.16 80.1466 1499.53 80.1466 L1502.2 80.1466 L1502.2 82.7289 Q1499.25 82.4829 1488.59 82.4829 Q1477.93 82.4829 1475.02 82.7289 L1475.02 80.1466 L1477.69 80.1466 Q1482.97 80.1466 1484.24 79.4087 Q1485.52 78.6299 1485.52 76.0886 L1485.52 32.599 Q1481.13 34.8124 1474.49 34.8124 Z\" fill=\"#e95420\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><polyline clip-path=\"url(#clip142)\" style=\"stroke:#0096ff; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"212.424,872.456 228.757,872.456 228.757,753.064 349.212,753.064 349.212,633.672 975.507,633.672 975.507,514.28 1083.77,514.28 1083.77,394.888 1268.32,394.888 1268.32,275.496 1513.72,275.496 1513.72,156.104 \"/>\n<circle clip-path=\"url(#clip142)\" cx=\"212.424\" cy=\"991.848\" r=\"18\" fill=\"#e95420\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.4\"/>\n<circle clip-path=\"url(#clip142)\" cx=\"228.757\" cy=\"991.848\" r=\"18\" fill=\"#e95420\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.4\"/>\n<circle clip-path=\"url(#clip142)\" cx=\"349.212\" cy=\"991.848\" r=\"18\" fill=\"#e95420\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.4\"/>\n<circle clip-path=\"url(#clip142)\" cx=\"975.507\" cy=\"991.848\" r=\"18\" fill=\"#e95420\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.4\"/>\n<circle clip-path=\"url(#clip142)\" cx=\"1083.77\" cy=\"991.848\" r=\"18\" fill=\"#e95420\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.4\"/>\n<circle clip-path=\"url(#clip142)\" cx=\"1268.32\" cy=\"991.848\" r=\"18\" fill=\"#e95420\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.4\"/>\n<circle clip-path=\"url(#clip142)\" cx=\"1513.72\" cy=\"991.848\" r=\"18\" fill=\"#e95420\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.4\"/>\n</svg>\n```\n:::\n:::\n\n\n:::\n\n::: {#second-column}\n\nWhen $\\displaystyle\\lambda(x,\\sigma)\\equiv c\\;(\\text{constant})$,\n\n* [blue line]{.color-blue}: [Poisson Process]{.color-blue}\n\n* [red dots]{.color-unite}: [Poisson Point Process]{.color-unite}\n\nsatisfying $\\displaystyle\\textcolor{#0096FF}{N_t}=\\textcolor{#E95420}{N([0,t])}\\sim\\Pois(ct)$.\n\n:::\n\n:::\n\n<!--\n### Simulating [Poisson Point Process]{.color-unite} (2/3)\n\n::: {.callout-tip title=\"Proposition (Simulation of Poisson Point Process)\" icon=\"false\"}\n\nThe first arrival time $T_1$ of a [Poisson Point Process]{.color-unite} with rate $\\lambda$ can be simulated by\n$$\nT_1\\deq M^{-1}(E),\\qquad E\\sim\\Exp(1),M(t):=\\int^t_0\\lambda(x_s,\\sigma_s)\\,ds,\n$$\nwhere $\\Exp(1)$ denotes the exponential distribution with parameter $1$.\n\n:::\n\nReminder: Poisson Process with $\\lambda\\equiv c\\in\\R$ can be simulated as\n$$\nT_1\\sim\\Exp(c).\n$$\nIn addition, $T_{n}-T_{n-1}\\sim\\Exp(c)$ for all $n\\in\\{2,3,\\cdots\\}$.\n-->\n\n### Simulating [Poisson Point Process]{.color-unite} (2/2)\n\n::: {.callout-tip title=\"Proposition (Simulation of Poisson Point Process)\" icon=\"false\"}\n\nThe first arrival time $T_1$ of a [Poisson Point Process]{.color-unite} with rate $\\lambda$ can be simulated by\n$$\nT_1\\deq M^{-1}(E),\\qquad E\\sim\\Exp(1),M(t):=\\int^t_0\\lambda(x_s,\\sigma_s)\\,ds,\n$$\nwhere $\\Exp(1)$ denotes the exponential distribution with parameter $1$.\n\n:::\n\nSince $\\displaystyle\\lambda(x,\\sigma):=\\Paren{\\sigma U'(x)}_++\\;\\gamma(x)$, $M$ can be quite complicated.\n\n{{< fa arrow-right >}} Inverting $M$ can be impossible.\n\n{{< fa arrow-right >}} We need more general techniques: [Poisson Thinning]{.color-blue}.\n\n<!-- \n1d: $x\\in\\R,\\sigma\\in\\{\\pm1\\}$\n$$\n\\lambda(x,\\sigma):=\\Paren{\\sigma U'(x)}_++\\;\\gamma(x)\n$$\n\nMultidimensional: $x\\in\\R^d,\\sigma\\in\\{\\pm1\\}^d$\n$$\n\\lambda_i(x,\\sigma):=\\Paren{\\sigma\\cdot \\nabla U_i(x)}_++\\;\\gamma_i(x,\\sigma_{-i})\n$$\n-->\n\n### [Poisson Thinning]{.color-blue} (1/2)\n\n::: {.callout-tip title=\"[@Lewis-Shedler1979]\" icon=\"false\"}\n\nTo obtain the first arrival time $T_1$ of a [Poisson Point Process]{.color-unite} with rate $\\lambda$,\n\n1. Find a bound $M$ that satisfies\n$$\nm(t):=\\int^t_0\\lambda(x_s,\\sigma_s)\\,ds\\le M(t).\n$$\n2. Simulate a point $T$ from the [Poisson Point Process]{.color-unite} with intensity $M$.\n3. Accept $T$ with probability $\\frac{m(T)}{M(T)}$.\n\n:::\n\n::: small-letter\n\n* $m(t)$: Defined via $\\displaystyle\\lambda(x,\\sigma):=\\Paren{\\sigma U'(x)}_++\\;\\gamma(x)$.\n\n* $M(t)$: Simple upper bound $m\\le M$, such that $M^{-1}$ is analytically tractable.\n\n:::\n\n### [Poisson Thinning]{.color-blue} (2/2)\n\nIn order to simulate a [Poisson Point Process]{.color-unite} with rate\n$$\n\\lambda(x,\\sigma):=\\Paren{\\sigma U'(x)}_++\\;\\gamma(x),\n$$\nwe find a [invertible upper bound $M$]{.color-blue} that satisfies\n$$\n\\int^t_0\\lambda(x_s,\\sigma_s)\\,ds=m(t)\\le\\textcolor{#0096FF}{M}(t).\n$$\nfor all possible Zig-Zag trajectories $\\{(x_s,\\sigma_s)\\}_{s\\in[0,T]}$.\n\n### Recap of @sec-Algorithm\n\n1. Continuous-time MCMC, based on [PDMP]{.underline}, has an entirely different algorithm and strategy.\n2. To simulate [PDMP]{.underline} is to simulate [Poisson Point Process]{.color-unite}.\n3. The core technology to simulate [Poisson Point Process]{.color-unite} is [Poisson Thinning]{.color-blue}.\n4. [Poisson Thinning]{.color-blue} is about finding an [upper bound $M$]{.color-blue}, with tractable inverse $M^{-1}$; Typically a polynomial function.\n5. The [upper bound $M$]{.color-blue} has to be given on a case-by-case basis.\n\n## Proof of Concept: How Good Is It? {#sec-ProofOfConcept}\n\nQuick demonstration of the state-of-the-art performance on a toy example.\n\n### Review: The 3 Steps of Zig-Zag Sampling\n\nGiven a target $p$,\n\n1. Calculate the negative log-likelihood $U(x):=-\\log p(x)$\n2. Fix a refresh rate $\\gamma(x)$ and compute the rate function\n  $$\n  \\lambda(x,\\sigma):=\\Paren{\\sigma U'(x)}_++\\;\\gamma(x).\n  $$\n3. Find an [invertible upper bound $M$]{.color-blue} that satisfies\n  $$\n  \\int^t_0\\lambda(x_s,\\sigma_s)\\,ds=:m(t)\\le\\textcolor{#0096FF}{M}(t).\n  $$\n\n### Model: 1d Gaussian Mean Reconstruction\n\n::: {layout=\"[53,50]\" layout-valign=\"top\" style=\"margin: 0px; !important\"}\n\n::: {#first-column}\n\n::: {.callout-tip appearance=\"simple\" icon=\"false\" title=\"Setting\"}\n\n* [Data]{.underline}: $y_1,\\cdots,y_n\\in\\R$ aquired by\n  $$\n  y_i\\iidsim\\rN(x_0,\\sigma^2),\\qquad i\\in[n],\n  $$\n  with $\\sigma>0$ known, $x_0\\in\\R$ unknown.\n\n* [Prior]{.underline}: $\\rN(0,\\rho^2)$ with known $\\rho>0$.\n\n* [Goal]{.underline}: Sampling from the posterior\n  $$\n  p(x)\\propt\\paren{\\prod_{i=1}^n\\phi(x|y_i,\\sigma^2)}\\phi(x|0,\\rho^2),\n  $$\n  where $\\phi(x|y,\\sigma^2)$ is the $\\rN(y,\\sigma^2)$ density.\n\n:::\n\n:::\n\n::: {#second-column}\n\nThe negative log-likelihood:\n\\begin{align*}\n  U(x)&=-\\log p(x)\\\\\n  &=\\frac{x^2}{2\\rho^2}+\\frac{1}{2\\sigma^2}\\sum_{i=1}^n(x-y_i)^2+\\const,\\\\\n  U'(x)&=\\frac{x}{\\rho^2}+\\frac{1}{\\sigma^2}\\sum_{i=1}^n(x-y_i),\\\\\n  U''(x)&=\\frac{1}{\\rho^2}+\\frac{n}{\\sigma^2}.\n\\end{align*}\n\n:::\n\n:::\n\n### Menu\n\nIn the rest of this @sec-ProofOfConcept, we'll learn:\n\n1. Even a [simple Zig-Zag Sampler with $\\gamma\\equiv0$]{.color-minty} surpasses [MALA]{.color-julia-blue}.\n2. Incorporating sub-sampling, [Zig-Zag with Control Variates]{.color-unite} further improves the efficiency.\n\n![](Files/MeanOfGaussian_addedMALA.svg){fig-align=\"center\"}\n\n### [Simple Zig-Zag Sampler with $\\gamma\\equiv0$]{.color-minty} (1/2)\n\nFixing $\\gamma\\equiv0$, we obtain [the upper bound $M$]{.color-blue}\n\\begin{align*}\n  m(t)&=\\int^t_0\\lambda(x_s,\\sigma_s)\\,ds=\\int^t_0\\Paren{\\sigma U'(x_s)}_+\\,ds\\\\\n  &\\le\\paren{\\frac{\\sigma x}{\\rho^2}+\\frac{\\sigma}{\\sigma^2}\\sum_{i=1}^n(x-y_i)+t\\paren{\\frac{1}{\\rho^2}+\\frac{n}{\\sigma^2}}}_+\\\\\n  &=:(a+bt)_+=\\textcolor{#0096FF}{M}(t),\n\\end{align*}\n\nwhere\n$$\na=\\frac{\\sigma x}{\\rho^2}+\\frac{\\sigma}{\\sigma^2}\\sum_{i=1}^n(x-y_i),\\quad b=\\frac{1}{\\rho^2}+\\frac{n}{\\sigma^2}.\n$$\n\n### Result: 1d Gaussian Mean Reconstruction\n\nWe generated 100 samples from $\\rN(x_0,\\sigma^2)$ with $x_0=1$.\n\n![](Files/MeanOfGaussian_addedMALA.svg){fig-align=\"center\"}\n\n### MSE per Epoch: The Vertical Axis\n\nMSE (Mean Squared Error) of $\\{X_i\\}_{i=1}^n$ is defined as\n$$\n\\frac{1}{n}\\sum_{i=1}^n(X_i-x_0)^2.\n$$\nEpoch: Unit computational cost.\n\n::: {.callout-tip appearance=\"simple\" icon=\"false\" title=\"The following is considered as one epoch:\"}\n\n* One evaluation of a likelihood ratio\n$$\n\\frac{p(X_{n+1})}{p(X_n)}.\n$$\n* One evaluation of a [Poisson Point Process]{.color-unite}.\n\n:::\n\n### Good News!\n\nCase-by-case construction of an [upper bound $M$]{.color-blue} is too complicated / demanding.\n\nTherefore, we are trying to [automate]{.color-unite} the whole procedure.\n\n::: {.callout-tip appearance=\"simple\" icon=\"false\" title=\"Automatic Zig-Zag\"}\n\n1. Automatic Zig-Zag [@Corbella2022]\n2. Concave-Convex PDMP [@Sutton-Fearnhead2023]\n3. NuZZ (numerical Zig-Zag) [@Pagani+2023]\n\n:::\n\n\n## References {.unnumbered .unlisted}\n\n::: {layout=\"[40,60]\" layout-valign=\"top\"}\n\n::: {#first-column}\n\n![Slides and codes are available here](Files/QR_ZigZagPoliSci.svg)\n\n:::\n\n::: {#second-column}\n\n::: {#refs}\n:::\n\n:::\n\n:::\n\n## Appendix: Scalability by Subsampling {.unnumbered .unlisted visibility=\"uncounted\"}\n\nConstruction of [ZZ-CV]{.color-unite} ([Zig-Zag with Control Variates]{.color-unite}).\n\n### Review: 1d Gaussian Mean Reconstruction\n\n$U'$ has an alternative form:\n\n\\begin{align*}\n  U'(x)&=\\frac{x}{\\rho^2}+\\frac{1}{\\sigma^2}\\sum_{i=1}^n(x-y_i)=:\\frac{1}{n}\\sum_{i=1}^nU'_i(x),\n\\end{align*}\nwhere\n$$\nU'_i(x)=\\frac{x}{\\rho^2}+\\frac{n}{\\sigma^2}(x-y_i).\n$$\n\n{{< fa arrow-right >}} We only need one sample $y_i$ to evaluate $U'_i$.\n\n### Randomized Rate Function\n\n::: small-letter\n\nInstead of\n$$\n\\lambda_{\\textcolor{#78C2AD}{\\text{ZZ}}}(x,\\sigma)=\\Paren{\\sigma U'(x)}_+\n$$\nwe use\n$$\n\\lambda_{\\textcolor{#E95420}{\\text{ZZ-CV}}}(x,\\sigma)=\\Paren{\\sigma U'_I(x)}_+,\\qquad I\\sim\\rU([n]).\n$$\nThen, the latter is an unbiased estimator of the former:\n$$\n\\E_{I\\sim\\rU([n])}\\SQuare{\\lambda_{\\textcolor{#E95420}{\\text{ZZ-CV}}}(x,\\sigma)}=\\lambda_{\\textcolor{#78C2AD}{\\text{ZZ}}}(x,\\sigma).\n$$\n\n:::\n\n### Last Step: [Poisson Thinning]{.color-blue}\n\nFind an [invertible upper bound $M$]{.color-blue} that satisfies\n$$\n\\int^t_0\\lambda_{\\textcolor{#E95420}{\\text{ZZ-CV}}}(x_s,\\sigma_s)\\,ds=:m_I(t)\\le\\textcolor{#0096FF}{M}(t),\\qquad I\\sim\\rU([n]).\n$$\nIt is harder to bound $\\lambda_{\\textcolor{#E95420}{\\text{ZZ-CV}}}$, since it is now an estimator (random function).\n\n### [Upper Bound $M$]{.color-blue} with [Control Variates]{.color-unite}\n\n::: {layout=\"[53,50]\" layout-valign=\"center\" style=\"margin: 0px; !important\"}\n\n::: {#first-column}\n\n::: {.callout-tip appearance=\"simple\" icon=\"false\" title=\"Preprocessing (once and for all)\"}\n\n1. Find\n  $$\n  x_*:=\\argmin_{x\\in\\R}U(x)\n  $$\n2. Compute\n  $$\n  U'(x_*)=\\frac{x_*}{\\rho^2}+\\frac{1}{\\sigma^2}\\sum_{i=1}^n(x_*-y_i).\n  $$\n\n:::\n\n:::\n\n::: {#second-column}\n\nThen, with a re-parameterization of $m_i$,\n$$\nm_i(t)\\le M(t):=a+bt,\n$$\n\n\n\n:::\n\n:::\n\nwhere\n$$\na=(\\sigma U'(x_*))_++\\norm{U'}_\\Lip\\norm{x-x_*}_p,\\qquad b:=\\norm{U'}_\\Lip.\n$$\nAnd $m_i$ is redefined as\n$$\nm_i(t)=U'(x_*)+U'_i(x)-U'_i(x_*).\n$$\n\n### Subsampling with Control Variates\n\nZig-Zag sampler with the random rate function\n$$\n\\lambda_{\\textcolor{#E95420}{\\text{ZZ-CV}}}(x,\\sigma)=\\Paren{\\sigma U'_I(x)}_+,\\qquad I\\sim\\rU([n]).\n$$\nand the upper bound\n$$\nM(t)=a+bt\n$$\nis called [Zig-Zag with Control Variates]{.color-unite} [@Bierkens+2019].\n\n### [Zig-Zag with Control Variates]{.color-unite}\n\n1. has $O(1)$ efficiency as the sample size $n$ grows.^[As long as the preprocessing step is properly done.]\n2. is exact (no bias).\n\n![](Files/MeanOfGaussian_addedMALA.svg){fig-align=\"center\"}\n\n### Scalability (1/3) {visibility=\"uncounted\"}\n\nThere are currently two main approaches to scaling up MCMC for large data.\n\n1. [Devide-and-conquer]{.underline}\n\n    Devide the data into smaller **chunks** and run MCMC on each **chunk**.\n\n2. [Subsampling]{.underline}\n\n    Use a subsampling estimate of the likelihood, which does not require the entire data.\n\n### Scalability (2/3) by Devide-and-conquer {visibility=\"uncounted\"}\n\nDevide the data into smaller chunks and run MCMC on each chunk.\n\n| Unbiased? | Method | Reference |\n|:-:|:------:|:------:|\n| [{{< fa xmark >}}]{.color-blue} | WASP | [[@Srivastava+2015]]{.footnote-letter} |\n| [{{< fa xmark >}}]{.color-blue} | Consensus Monte Carlo | [[@Scott+2016]]{.footnote-letter} |\n| [{{< fa check >}}]{.color-red} | Monte Carlo Fusion | [[@Dai+2019]]{.footnote-letter} |\n\n: {.hover .responsive-sm tbl-colwidths=\"[20,50,35]\"}\n\n### Scalability (3/3) by Subsampling {visibility=\"uncounted\"}\n\nUse a subsampling estimate of the likelihood, which does not require the entire data.\n\n| Unbiased? | Method | Reference |\n|:-:|:------:|:------:|\n| [{{< fa xmark >}}]{.color-blue} | Stochastic Gadient MCMC | [[@Welling-Teh2011]]{.footnote-letter} |\n| [{{< fa check >}}]{.color-red} | Zig-Zag with Subsampling | [[@Bierkens+2019]]{.footnote-letter} |\n| [{{< fa xmark >}}]{.color-blue} | Stochastic Gradient PDMP | [[@Fearnhead+2024]]{.footnote-letter} |\n\n: {.hover .responsive-sm tbl-colwidths=\"[20,50,35]\"}\n\n<!-- ## Appendix: Application to Imbalanced Logistic Regression {.unnumbered .unlisted visibility=\"uncounted\"}\n\nScalability and state-of-the-art performance on high-dimensional models, with the example of logistic models. -->\n\n",
    "supporting": [
      "ZigZagPoliSci_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}