{
  "hash": "75e7ee27728b52dc12000347de332cfc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Poisson 過程を見てみよう\"\nsubtitle: \"YUIMA パッケージを用いたシミュレーションを通じて\"\nauthor: \"司馬博文\"\ndate: 6/29/2024\ndate-modified: 6/30/2024\ncategories: [Process, Simulation, Stan, YUIMA, R]\nimage: Poisson_files/figure-html/unnamed-chunk-2-1.png\nbibliography: \n    - ../../../mathematics.bib\n    - ../../../bib.bib\ncsl: ../../../apa.csl\nabstract-title: 概要\nabstract: Poisson 点過程とは，Poisson 分布に従う個数分だけ現れる一様な点がなすランダム測度である．複合 Poisson 点過程を考えることで，互いに素な集合に入る点の個数が独立に決まるようなランダム測度を特徴付けることができる．Lévy 過程としての Poisson 過程，複合 Poisson 過程は，これら点過程に関する積分として理解できる．\ncode-fold: false\n---\n::: {.hidden}\n\nA Blog Entry on Bayesian Computation by an Applied Mathematician\n\n$$\n%%% 汎用コード列\n\\renewcommand{\\P}{\\operatorname{P}}\\newcommand{\\E}{\\operatorname{E}}\n\\newcommand{\\R}{\\mathbb{R}}\\newcommand{\\F}{\\mathcal{F}}\n\\newcommand{\\abs}[1]{\\lvert#1\\rvert}\\newcommand{\\Abs}[1]{\\left|#1\\right|}\\newcommand{\\ABs}[1]{\\biggl|#1\\biggr|}\\newcommand{\\norm}[1]{\\|#1\\|}\\newcommand{\\Norm}[1]{\\left\\|#1\\right\\|}\\newcommand{\\NOrm}[1]{\\biggl\\|#1\\biggr\\|}\\newcommand{\\Brace}[1]{\\left\\{#1\\right\\}}\\newcommand{\\BRace}[1]{\\biggl\\{#1\\biggr\\}}\\newcommand{\\paren}[1]{\\left(#1\\right)}\\newcommand{\\Paren}[1]{\\biggr(#1\\biggl)}\\newcommand{\\brac}[1]{\\langle#1\\rangle}\\newcommand{\\Brac}[1]{\\left\\langle#1\\right\\rangle}\\newcommand{\\BRac}[1]{\\biggl\\langle#1\\biggr\\rangle}\\newcommand{\\bra}[1]{\\left\\langle#1\\right|}\\newcommand{\\ket}[1]{\\left|#1\\right\\rangle}\\newcommand{\\Square}[1]{\\left[#1\\right]}\\newcommand{\\SQuare}[1]{\\biggl[#1\\biggr]}\n\n\\usepackage[all]{xy}\\usepackage{amsmath}\\newcommand{\\y}{\\b{y}}\\newcommand{\\mi}{\\,|\\,}\\newcommand{\\Mark}{\\mathrm{Mark}}\n\n%%% 演算子\n\\DeclareMathOperator{\\grad}{\\mathrm{grad}}\\DeclareMathOperator{\\rot}{\\mathrm{rot}}\\DeclareMathOperator{\\divergence}{\\mathrm{div}}\\DeclareMathOperator{\\tr}{tr}\\DeclareMathOperator{\\Tr}{Tr}\\newcommand{\\pr}{\\mathrm{pr}}\n\\newcommand{\\Map}{\\mathrm{Map}}\\newcommand{\\dom}{\\mathrm{Dom}\\;}\\newcommand{\\cod}{\\mathrm{Cod}\\;}\\newcommand{\\supp}{\\mathrm{supp}\\;}\n\n\n%%% 線型代数学\n\\newcommand{\\vctr}[2]{\\begin{pmatrix}#1\\\\#2\\end{pmatrix}}\\newcommand{\\vctrr}[3]{\\begin{pmatrix}#1\\\\#2\\\\#3\\end{pmatrix}}\\newcommand{\\mtrx}[4]{\\begin{pmatrix}#1&#2\\\\#3&#4\\end{pmatrix}}\\newcommand{\\smtrx}[4]{\\paren{\\begin{smallmatrix}#1&#2\\\\#3&#4\\end{smallmatrix}}}\\newcommand{\\Ker}{\\mathrm{Ker}\\;}\\newcommand{\\Coker}{\\mathrm{Coker}\\;}\\newcommand{\\Coim}{\\mathrm{Coim}\\;}\\DeclareMathOperator{\\rank}{\\mathrm{rank}}\\newcommand{\\lcm}{\\mathrm{lcm}}\\newcommand{\\GL}{\\mathrm{GL}}\\newcommand{\\SL}{\\mathrm{SL}}\\newcommand{\\alt}{\\mathrm{alt}}\\DeclareMathOperator{\\sgn}{sgn}\n%%% 複素解析学\n\\renewcommand{\\Re}{\\mathrm{Re}\\;}\\renewcommand{\\Im}{\\mathrm{Im}\\,}\\newcommand{\\Gal}{\\mathrm{Gal}}\\newcommand{\\PGL}{\\mathrm{PGL}}\\newcommand{\\PSL}{\\mathrm{PSL}}\\newcommand{\\Log}{\\mathrm{Log}\\,}\\newcommand{\\Res}{\\mathrm{Res}\\,}\\newcommand{\\on}{\\mathrm{on}\\;}\\newcommand{\\hatC}{\\widehat{\\C}}\\newcommand{\\hatR}{\\hat{\\R}}\\newcommand{\\PV}{\\mathrm{P.V.}}\\newcommand{\\diam}{\\mathrm{diam}}\\newcommand{\\Area}{\\mathrm{Area}}\\newcommand{\\Lap}{\\Laplace}\\newcommand{\\f}{\\mathbf{f}}\\newcommand{\\cR}{\\mathcal{R}}\\newcommand{\\const}{\\mathrm{const.}}\\newcommand{\\Om}{\\Omega}\\newcommand{\\Cinf}{C^\\infty}\\newcommand{\\ep}{\\epsilon}\\newcommand{\\dist}{\\mathrm{dist}}\\newcommand{\\opart}{\\o{\\partial}}\\newcommand{\\Length}{\\mathrm{Length}}\n%%% 集合と位相\n\\newcommand{\\cA}{\\mathcal{A}}\\newcommand{\\cO}{\\mathcal{O}}\\newcommand{\\cW}{\\mathcal{W}}\\renewcommand{\\O}{\\mathcal{O}}\\renewcommand{\\S}{\\mathcal{S}}\\newcommand{\\U}{\\mathcal{U}}\\newcommand{\\V}{\\mathrm{V}}\\newcommand{\\N}{\\mathbb{N}}\\newcommand{\\bN}{\\mathbb{N}}\\newcommand{\\C}{\\mathrm{C}}\\newcommand{\\bC}{\\mathbb{C}}\\newcommand{\\Z}{\\mathcal{Z}}\\newcommand{\\Q}{\\mathbb{Q}}\\newcommand{\\bQ}{\\mathbb{Q}}\\newcommand{\\TV}{\\mathrm{TV}}\\newcommand{\\ORD}{\\mathrm{ORD}}\\newcommand{\\Card}{\\mathrm{Card}\\,}\\newcommand{\\Top}{\\mathrm{Top}}\\newcommand{\\Disc}{\\mathrm{Disc}}\\newcommand{\\Codisc}{\\mathrm{Codisc}}\\newcommand{\\CoDisc}{\\mathrm{CoDisc}}\\newcommand{\\Ult}{\\mathrm{Ult}}\\newcommand{\\ord}{\\mathrm{ord}}\\DeclareMathOperator{\\maj}{\\mathrm{maj}}\\newcommand{\\bS}{\\mathbb{S}}\\newcommand{\\PConn}{\\mathrm{PConn}}\n\n%%% 形式言語理論\n\\newcommand{\\REGEX}{\\mathrm{REGEX}}\\newcommand{\\RE}{\\mathbf{RE}}\n%%% Graph Theory\n\\newcommand{\\SimpGph}{\\mathrm{SimpGph}}\\newcommand{\\Gph}{\\mathrm{Gph}}\\newcommand{\\mult}{\\mathrm{mult}}\\newcommand{\\inv}{\\mathrm{inv}}\n\n%%% 多様体\n\\newcommand{\\Der}{\\mathrm{Der}}\\newcommand{\\osub}{\\overset{\\mathrm{open}}{\\subset}}\\newcommand{\\osup}{\\overset{\\mathrm{open}}{\\supset}}\\newcommand{\\al}{\\alpha}\\newcommand{\\K}{\\mathbb{K}}\\newcommand{\\Sp}{\\mathrm{Sp}}\\newcommand{\\g}{\\mathfrak{g}}\\newcommand{\\h}{\\mathfrak{h}}\\newcommand{\\Imm}{\\mathrm{Imm}}\\newcommand{\\Imb}{\\mathrm{Imb}}\\newcommand{\\Gr}{\\mathrm{Gr}}\n\\DeclareMathOperator{\\Exp}{Exp}\\DeclareMathOperator{\\codim}{codim}\n%%% 代数\n\\newcommand{\\Ad}{\\mathrm{Ad}}\\newcommand{\\finsupp}{\\mathrm{fin\\;supp}}\\newcommand{\\SO}{\\mathrm{SO}}\\newcommand{\\SU}{\\mathrm{SU}}\\newcommand{\\acts}{\\curvearrowright}\\newcommand{\\mono}{\\hookrightarrow}\\newcommand{\\epi}{\\twoheadrightarrow}\\newcommand{\\Stab}{\\mathrm{Stab}}\\newcommand{\\nor}{\\mathrm{nor}}\\newcommand{\\T}{\\mathbb{T}}\\newcommand{\\Aff}{\\mathrm{Aff}}\\newcommand{\\rsub}{\\triangleleft}\\newcommand{\\rsup}{\\triangleright}\\newcommand{\\subgrp}{\\overset{\\mathrm{subgrp}}{\\subset}}\\newcommand{\\Ext}{\\mathrm{Ext}}\\newcommand{\\sbs}{\\subset}\\newcommand{\\sps}{\\supset}\\newcommand{\\In}{\\mathrm{in}\\;}\\newcommand{\\Tor}{\\mathrm{Tor}}\\newcommand{\\p}{\\b{p}}\\newcommand{\\q}{\\mathfrak{q}}\\newcommand{\\m}{\\mathfrak{m}}\\newcommand{\\cS}{\\mathcal{S}}\\newcommand{\\Frac}{\\mathrm{Frac}\\,}\\newcommand{\\Spec}{\\mathrm{Spec}\\,}\\newcommand{\\bA}{\\mathbb{A}}\\newcommand{\\Sym}{\\mathrm{Sym}}\\newcommand{\\Ann}{\\mathrm{Ann}}\\newcommand{\\Her}{\\mathrm{Her}}\\newcommand{\\Bil}{\\mathrm{Bil}}\\newcommand{\\Ses}{\\mathrm{Ses}}\\newcommand{\\FVS}{\\mathrm{FVS}}\n%%% 代数的位相幾何学\n\\newcommand{\\Ho}{\\mathrm{Ho}}\\newcommand{\\CW}{\\mathrm{CW}}\\newcommand{\\lc}{\\mathrm{lc}}\\newcommand{\\cg}{\\mathrm{cg}}\\newcommand{\\Fib}{\\mathrm{Fib}}\\newcommand{\\Cyl}{\\mathrm{Cyl}}\\newcommand{\\Ch}{\\mathrm{Ch}}\n%%% 微分幾何学\n\\newcommand{\\rP}{\\mathrm{P}}\\newcommand{\\rE}{\\mathrm{E}}\\newcommand{\\e}{\\b{e}}\\renewcommand{\\k}{\\b{k}}\\newcommand{\\Christ}[2]{\\begin{Bmatrix}#1\\\\#2\\end{Bmatrix}}\\renewcommand{\\Vec}[1]{\\overrightarrow{\\mathrm{#1}}}\\newcommand{\\hen}[1]{\\mathrm{#1}}\\renewcommand{\\b}[1]{\\boldsymbol{#1}}\n\n%%% 函数解析\n\\newcommand{\\Inc}{\\mathrm{Inc}}\\newcommand{\\aInc}{\\mathrm{aInc}}\\newcommand{\\HS}{\\mathrm{HS}}\\newcommand{\\loc}{\\mathrm{loc}}\\newcommand{\\Lh}{\\mathrm{L.h.}}\\newcommand{\\Epi}{\\mathrm{Epi}}\\newcommand{\\slim}{\\mathrm{slim}}\\newcommand{\\Ban}{\\mathrm{Ban}}\\newcommand{\\Hilb}{\\mathrm{Hilb}}\\newcommand{\\Ex}{\\mathrm{Ex}}\\newcommand{\\Co}{\\mathrm{Co}}\\newcommand{\\sa}{\\mathrm{sa}}\\newcommand{\\nnorm}[1]{{\\left\\vert\\kern-0.25ex\\left\\vert\\kern-0.25ex\\left\\vert #1 \\right\\vert\\kern-0.25ex\\right\\vert\\kern-0.25ex\\right\\vert}}\\newcommand{\\dvol}{\\mathrm{dvol}}\\newcommand{\\Sconv}{\\mathrm{Sconv}}\\newcommand{\\I}{\\mathcal{I}}\\newcommand{\\nonunital}{\\mathrm{nu}}\\newcommand{\\cpt}{\\mathrm{cpt}}\\newcommand{\\lcpt}{\\mathrm{lcpt}}\\newcommand{\\com}{\\mathrm{com}}\\newcommand{\\Haus}{\\mathrm{Haus}}\\newcommand{\\proper}{\\mathrm{proper}}\\newcommand{\\infinity}{\\mathrm{inf}}\\newcommand{\\TVS}{\\mathrm{TVS}}\\newcommand{\\ess}{\\mathrm{ess}}\\newcommand{\\ext}{\\mathrm{ext}}\\newcommand{\\Index}{\\mathrm{Index}\\;}\\newcommand{\\SSR}{\\mathrm{SSR}}\\newcommand{\\vs}{\\mathrm{vs.}}\\newcommand{\\fM}{\\mathfrak{M}}\\newcommand{\\EDM}{\\mathrm{EDM}}\\newcommand{\\Tw}{\\mathrm{Tw}}\\newcommand{\\fC}{\\mathfrak{C}}\\newcommand{\\bn}{\\boldsymbol{n}}\\newcommand{\\br}{\\boldsymbol{r}}\\newcommand{\\Lam}{\\Lambda}\\newcommand{\\lam}{\\lambda}\\newcommand{\\one}{\\mathbf{1}}\\newcommand{\\dae}{\\text{-a.e.}}\\newcommand{\\das}{\\text{-a.s.}}\\newcommand{\\td}{\\text{-}}\\newcommand{\\RM}{\\mathrm{RM}}\\newcommand{\\BV}{\\mathrm{BV}}\\newcommand{\\normal}{\\mathrm{normal}}\\newcommand{\\lub}{\\mathrm{lub}\\;}\\newcommand{\\Graph}{\\mathrm{Graph}}\\newcommand{\\Ascent}{\\mathrm{Ascent}}\\newcommand{\\Descent}{\\mathrm{Descent}}\\newcommand{\\BIL}{\\mathrm{BIL}}\\newcommand{\\fL}{\\mathfrak{L}}\\newcommand{\\De}{\\Delta}\n%%% 積分論\n\\newcommand{\\calA}{\\mathcal{A}}\\newcommand{\\calB}{\\mathcal{B}}\\newcommand{\\D}{\\mathcal{D}}\\newcommand{\\Y}{\\mathcal{Y}}\\newcommand{\\calC}{\\mathcal{C}}\\renewcommand{\\ae}{\\mathrm{a.e.}\\;}\\newcommand{\\cZ}{\\mathcal{Z}}\\newcommand{\\fF}{\\mathfrak{F}}\\newcommand{\\fI}{\\mathfrak{I}}\\newcommand{\\rV}{\\mathrm{V}}\\newcommand{\\cE}{\\mathcal{E}}\\newcommand{\\sMap}{\\sigma\\textrm{-}\\mathrm{Map}}\\DeclareMathOperator*{\\argmax}{arg\\,max}\\DeclareMathOperator*{\\argmin}{arg\\,min}\\newcommand{\\cC}{\\mathcal{C}}\\newcommand{\\comp}{\\complement}\\newcommand{\\J}{\\mathcal{J}}\\newcommand{\\sumN}[1]{\\sum_{#1\\in\\N}}\\newcommand{\\cupN}[1]{\\cup_{#1\\in\\N}}\\newcommand{\\capN}[1]{\\cap_{#1\\in\\N}}\\newcommand{\\Sum}[1]{\\sum_{#1=1}^\\infty}\\newcommand{\\sumn}{\\sum_{n=1}^\\infty}\\newcommand{\\summ}{\\sum_{m=1}^\\infty}\\newcommand{\\sumk}{\\sum_{k=1}^\\infty}\\newcommand{\\sumi}{\\sum_{i=1}^\\infty}\\newcommand{\\sumj}{\\sum_{j=1}^\\infty}\\newcommand{\\cupn}{\\cup_{n=1}^\\infty}\\newcommand{\\capn}{\\cap_{n=1}^\\infty}\\newcommand{\\cupk}{\\cup_{k=1}^\\infty}\\newcommand{\\cupi}{\\cup_{i=1}^\\infty}\\newcommand{\\cupj}{\\cup_{j=1}^\\infty}\\newcommand{\\limn}{\\lim_{n\\to\\infty}}\\renewcommand{\\L}{\\mathcal{L}}\\newcommand{\\cL}{\\mathcal{L}}\\newcommand{\\Cl}{\\mathrm{Cl}}\\newcommand{\\cN}{\\mathcal{N}}\\newcommand{\\Ae}{\\textrm{-a.e.}\\;}\\newcommand{\\csub}{\\overset{\\textrm{closed}}{\\subset}}\\newcommand{\\csup}{\\overset{\\textrm{closed}}{\\supset}}\\newcommand{\\wB}{\\wt{B}}\\newcommand{\\cG}{\\mathcal{G}}\\newcommand{\\Lip}{\\mathrm{Lip}}\\DeclareMathOperator{\\Dom}{\\mathrm{Dom}}\\newcommand{\\AC}{\\mathrm{AC}}\\newcommand{\\Mol}{\\mathrm{Mol}}\n%%% Fourier解析\n\\newcommand{\\Pe}{\\mathrm{Pe}}\\newcommand{\\wR}{\\wh{\\mathbb{\\R}}}\\newcommand*{\\Laplace}{\\mathop{}\\!\\mathbin\\bigtriangleup}\\newcommand*{\\DAlambert}{\\mathop{}\\!\\mathbin\\Box}\\newcommand{\\bT}{\\mathbb{T}}\\newcommand{\\dx}{\\dslash x}\\newcommand{\\dt}{\\dslash t}\\newcommand{\\ds}{\\dslash s}\n%%% 数値解析\n\\newcommand{\\round}{\\mathrm{round}}\\newcommand{\\cond}{\\mathrm{cond}}\\newcommand{\\diag}{\\mathrm{diag}}\n\\newcommand{\\Adj}{\\mathrm{Adj}}\\newcommand{\\Pf}{\\mathrm{Pf}}\\newcommand{\\Sg}{\\mathrm{Sg}}\n\n%%% 確率論\n\\newcommand{\\aseq}{\\overset{\\text{a.s.}}{=}}\\newcommand{\\deq}{\\overset{\\text{d}}{=}}\\newcommand{\\cV}{\\mathcal{V}}\\newcommand{\\FM}{\\mathrm{FM}}\\newcommand{\\KR}{\\mathrm{KR}}\\newcommand{\\rba}{\\mathrm{rba}}\\newcommand{\\rca}{\\mathrm{rca}}\\newcommand{\\Prob}{\\mathrm{Prob}}\\newcommand{\\X}{\\mathcal{X}}\\newcommand{\\Meas}{\\mathrm{Meas}}\\newcommand{\\as}{\\;\\text{a.s.}}\\newcommand{\\io}{\\;\\mathrm{i.o.}}\\newcommand{\\fe}{\\;\\text{f.e.}}\\newcommand{\\bF}{\\mathbb{F}}\\newcommand{\\W}{\\mathcal{W}}\\newcommand{\\Pois}{\\mathrm{Pois}}\\newcommand{\\iid}{\\text{i.i.d.}}\\newcommand{\\wconv}{\\rightsquigarrow}\\newcommand{\\Var}{\\mathrm{Var}}\\newcommand{\\xrightarrown}{\\xrightarrow{n\\to\\infty}}\\newcommand{\\au}{\\mathrm{au}}\\newcommand{\\cT}{\\mathcal{T}}\\newcommand{\\wto}{\\overset{\\text{w}}{\\to}}\\newcommand{\\dto}{\\overset{\\text{d}}{\\to}}\\newcommand{\\sto}{\\overset{\\text{s}}{\\to}}\\newcommand{\\pto}{\\overset{\\text{p}}{\\to}}\\newcommand{\\mto}{\\overset{\\text{m}}{\\to}}\\newcommand{\\vto}{\\overset{v}{\\to}}\\newcommand{\\Cont}{\\mathrm{Cont}}\\newcommand{\\stably}{\\mathrm{stably}}\\newcommand{\\Np}{\\mathbb{N}^+}\\newcommand{\\oM}{\\overline{\\mathcal{M}}}\\newcommand{\\fP}{\\mathfrak{P}}\\newcommand{\\sign}{\\mathrm{sign}}\n\\DeclareMathOperator{\\Ent}{Ent}\\DeclareMathOperator{\\Polya}{Polya}\\newcommand{\\Borel}{\\mathrm{Borel}}\\newcommand{\\Mid}{\\,|\\,}\\newcommand{\\middleMid}{\\;\\middle|\\;}\\DeclareMathOperator{\\LR}{LR}\\newcommand{\\CP}{\\mathrm{CP}}\\newcommand{\\bD}{\\mathbb{D}}\\newcommand{\\bL}{\\mathbb{L}}\\newcommand{\\fW}{\\mathfrak{W}}\\newcommand{\\DL}{\\mathcal{D}\\mathcal{L}}\\renewcommand{\\r}[1]{\\mathrm{#1}}\\newcommand{\\rC}{\\mathrm{C}}\\newcommand{\\qqquad}{\\qquad\\quad}\n%%% 情報理論\n\\newcommand{\\bit}{\\mathrm{bit}}\\DeclareMathOperator{\\sinc}{sinc}\n%%% 量子論\n\\newcommand{\\err}{\\mathrm{err}}\n%%% 最適化\n\\newcommand{\\varparallel}{\\mathbin{\\!/\\mkern-5mu/\\!}}\\DeclareMathOperator{\\minimize}{minimize}\\DeclareMathOperator{\\subjectto}{subject to}\\newcommand{\\Ri}{\\mathrm{Ri}}\\newcommand{\\Cone}{\\mathrm{Cone}}\\newcommand{\\Int}{\\mathrm{Int}}\n%%% 数理ファイナンス\n\\newcommand{\\pre}{\\mathrm{pre}}\\newcommand{\\om}{\\omega}\n\n%%% 偏微分方程式\n\\DeclareMathOperator{\\div}{div}\n\\newcommand{\\del}{\\partial}\n\\newcommand{\\LHS}{\\mathrm{LHS}}\\newcommand{\\RHS}{\\mathrm{RHS}}\\newcommand{\\bnu}{\\boldsymbol{\\nu}}\\newcommand{\\interior}{\\mathrm{in}\\;}\\newcommand{\\SH}{\\mathrm{SH}}\\renewcommand{\\v}{\\boldsymbol{\\nu}}\\newcommand{\\n}{\\mathbf{n}}\\newcommand{\\ssub}{\\Subset}\\newcommand{\\curl}{\\mathrm{curl}}\n%%% 常微分方程式\n\\newcommand{\\Ei}{\\mathrm{Ei}}\\newcommand{\\sn}{\\mathrm{sn}}\\newcommand{\\wgamma}{\\widetilde{\\gamma}}\n%%% 統計力学\n\\newcommand{\\Ens}{\\mathrm{Ens}}\n%%% 解析力学\n\\newcommand{\\cl}{\\mathrm{cl}}\\newcommand{\\x}{\\boldsymbol{x}}\n\n%%% 統計的因果推論\n\\newcommand{\\Do}{\\mathrm{Do}}\\newcommand{\\IV}{\\mathrm{IV}}\n%%% 応用統計学\n\\DeclareMathOperator{\\pl}{pl}\\newcommand{\\AIC}{\\mathrm{AIC}}\\newcommand{\\mrl}{\\mathrm{mrl}}\\newcommand{\\dotx}{\\dot{x}}\\newcommand{\\UMV}{\\mathrm{UMV}}\\newcommand{\\BLU}{\\mathrm{BLU}}\n%%% 数理統計\n\\DeclareMathOperator{\\arctanh}{arctanh}\\newcommand{\\comb}[2]{\\begin{pmatrix}#1\\\\#2\\end{pmatrix}}\\newcommand{\\bP}{\\mathbb{P}}\\newcommand{\\compsub}{\\overset{\\textrm{cpt}}{\\subset}}\\newcommand{\\lip}{\\textrm{lip}}\\newcommand{\\BL}{\\mathrm{BL}}\\newcommand{\\G}{\\mathbb{G}}\\newcommand{\\NB}{\\mathrm{NB}}\\newcommand{\\oR}{\\ov{\\R}}\\newcommand{\\liminfn}{\\liminf_{n\\to\\infty}}\\newcommand{\\limsupn}{\\limsup_{n\\to\\infty}}\\newcommand{\\esssup}{\\mathrm{ess.sup}}\\newcommand{\\asto}{\\xrightarrow{\\as}}\\newcommand{\\Cov}{\\mathrm{Cov}}\\newcommand{\\cQ}{\\mathcal{Q}}\\newcommand{\\VC}{\\mathrm{VC}}\\newcommand{\\mb}{\\mathrm{mb}}\\newcommand{\\Avar}{\\mathrm{Avar}}\\newcommand{\\bB}{\\mathbb{B}}\\newcommand{\\bW}{\\mathbb{W}}\\newcommand{\\sd}{\\mathrm{sd}}\\newcommand{\\w}[1]{\\widehat{#1}}\\newcommand{\\bZ}{\\mathbb{Z}}\\newcommand{\\Bernoulli}{\\mathrm{Ber}}\\newcommand{\\Ber}{\\mathrm{Ber}}\\newcommand{\\Mult}{\\mathrm{Mult}}\\newcommand{\\BPois}{\\mathrm{BPois}}\\newcommand{\\fraks}{\\mathfrak{s}}\\newcommand{\\frakk}{\\mathfrak{k}}\\newcommand{\\IF}{\\mathrm{IF}}\\newcommand{\\bX}{\\boldsymbol{X}}\\newcommand{\\bx}{\\boldsymbol{x}}\\newcommand{\\indep}{\\perp\\!\\!\\!\\perp}\\newcommand{\\IG}{\\mathrm{IG}}\\newcommand{\\Levy}{\\mathrm{Levy}}\\newcommand{\\MP}{\\mathrm{MP}}\\newcommand{\\Hermite}{\\mathrm{Hermite}}\\newcommand{\\Skellam}{\\mathrm{Skellam}}\\newcommand{\\Dirichlet}{\\mathrm{Dirichlet}}\\newcommand{\\Beta}{\\mathrm{Beta}}\\newcommand{\\bE}{\\mathbb{E}}\\newcommand{\\bG}{\\mathbb{G}}\\newcommand{\\MISE}{\\mathrm{MISE}}\\newcommand{\\logit}{\\mathtt{logit}}\\newcommand{\\expit}{\\mathtt{expit}}\\newcommand{\\cK}{\\mathcal{K}}\\newcommand{\\dl}{\\dot{l}}\\newcommand{\\dotp}{\\dot{p}}\\newcommand{\\wl}{\\wt{l}}\\newcommand{\\Gauss}{\\mathrm{Gauss}}\\newcommand{\\fA}{\\mathfrak{A}}\\newcommand{\\under}{\\mathrm{under}\\;}\\newcommand{\\whtheta}{\\wh{\\theta}}\\newcommand{\\Em}{\\mathrm{Em}}\\newcommand{\\ztheta}{{\\theta_0}}\n\\newcommand{\\rO}{\\mathrm{O}}\\newcommand{\\Bin}{\\mathrm{Bin}}\\newcommand{\\rW}{\\mathrm{W}}\\newcommand{\\rG}{\\mathrm{G}}\\newcommand{\\rB}{\\mathrm{B}}\\newcommand{\\rN}{\\mathrm{N}}\\newcommand{\\rU}{\\mathrm{U}}\\newcommand{\\HG}{\\mathrm{HG}}\\newcommand{\\GAMMA}{\\mathrm{Gamma}}\\newcommand{\\Cauchy}{\\mathrm{Cauchy}}\\newcommand{\\rt}{\\mathrm{t}}\\newcommand{\\rF}{\\mathrm{F}}\n\\DeclareMathOperator{\\erf}{erf}\n%%% 計量経済学\n\\newcommand{\\FE}{\\mathrm{FE}}\\newcommand{\\bV}{\\boldsymbol{V}}\\newcommand{\\GLS}{\\mathrm{GLS}}\\newcommand{\\be}{\\boldsymbol{e}}\\newcommand{\\POOL}{\\mathrm{POOL}}\\newcommand{\\GMM}{\\mathrm{GMM}}\\newcommand{\\MM}{\\mathrm{MM}}\\newcommand{\\SSIV}{\\mathrm{SSIV}}\\newcommand{\\JIV}{\\mathrm{JIV}}\\newcommand{\\AR}{\\mathrm{AR}}\\newcommand{\\ILS}{\\mathrm{ILS}}\\newcommand{\\SLS}{\\mathrm{SLS}}\\newcommand{\\LIML}{\\mathrm{LIML}}\n\n%%% 無限次元統計模型の理論\n\\newcommand{\\Rad}{\\mathrm{Rad}}\\newcommand{\\bY}{\\boldsymbol{Y}}\\newcommand{\\pone}{{(1)}}\\newcommand{\\ptwo}{{(2)}}\\newcommand{\\ps}[1]{{(#1)}}\\newcommand{\\fsub}{\\overset{\\text{finite}}{\\subset}}\n%%% Banach Lattices\n\\newcommand{\\Slv}{\\mathrm{Slv}}\\newcommand{\\Hypo}{\\mathrm{Hypo}}\\newcommand{\\CL}{\\mathrm{CL}}\\DeclareMathOperator{\\ba}{ba}\\DeclareMathOperator{\\ca}{ca}\n\n%%% 圏\n\\newcommand{\\varlim}{\\varprojlim}\\newcommand{\\Hom}{\\mathrm{Hom}}\\newcommand{\\Iso}{\\mathrm{Iso}}\\newcommand{\\Mor}{\\mathrm{Mor}}\\newcommand{\\Isom}{\\mathrm{Isom}}\\newcommand{\\Aut}{\\mathrm{Aut}}\\newcommand{\\End}{\\mathrm{End}}\\newcommand{\\op}{\\mathrm{op}}\\newcommand{\\ev}{\\mathrm{ev}}\\newcommand{\\Ob}{\\mathrm{Ob}}\\newcommand{\\Ar}{\\mathrm{Ar}}\\newcommand{\\Arr}{\\mathrm{Arr}}\\newcommand{\\Set}{\\mathrm{Set}}\\newcommand{\\Grp}{\\mathrm{Grp}}\\newcommand{\\Cat}{\\mathrm{Cat}}\\newcommand{\\Mon}{\\mathrm{Mon}}\\newcommand{\\Ring}{\\mathrm{Ring}}\\newcommand{\\CRing}{\\mathrm{CRing}}\\newcommand{\\Ab}{\\mathrm{Ab}}\\newcommand{\\Pos}{\\mathrm{Pos}}\\newcommand{\\Vect}{\\mathrm{Vect}}\\newcommand{\\FinVect}{\\mathrm{FinVect}}\\newcommand{\\FinSet}{\\mathrm{FinSet}}\\newcommand{\\FinMeas}{\\mathrm{FinMeas}}\\newcommand{\\OmegaAlg}{\\Omega\\text{-}\\mathrm{Alg}}\\newcommand{\\OmegaEAlg}{(\\Omega,E)\\text{-}\\mathrm{Alg}}\\newcommand{\\Fun}{\\mathrm{Fun}}\\newcommand{\\Func}{\\mathrm{Func}}\\newcommand{\\Alg}{\\mathrm{Alg}} %代数の圏\n\\newcommand{\\Met}{\\mathrm{Met}} %Metric space & Contraction maps\n\\newcommand{\\Stoch}{\\mathrm{Stoch}}\\newcommand{\\FinStoch}{\\mathrm{FinStoch}}\\newcommand{\\Copy}{\\mathrm{copy}}\\newcommand{\\Delete}{\\mathrm{delete}} %確率空間とMarkov核の圏\n\\newcommand{\\Bool}{\\mathrm{Bool}}\\newcommand{\\CABool}{\\mathrm{CABool}}\\newcommand{\\CompBoolAlg}{\\mathrm{CompBoolAlg}}\\newcommand{\\BoolAlg}{\\mathrm{BoolAlg}}\\newcommand{\\BoolRng}{\\mathrm{BoolRng}}\\newcommand{\\HeytAlg}{\\mathrm{HeytAlg}}\\newcommand{\\CompHeytAlg}{\\mathrm{CompHeytAlg}}\\newcommand{\\Lat}{\\mathrm{Lat}}\\newcommand{\\CompLat}{\\mathrm{CompLat}}\\newcommand{\\SemiLat}{\\mathrm{SemiLat}}\\newcommand{\\Stone}{\\mathrm{Stone}}\\newcommand{\\Mfd}{\\mathrm{Mfd}}\\newcommand{\\LieAlg}{\\mathrm{LieAlg}}\n\\newcommand{\\Sob}{\\mathrm{Sob}} %Sober space & continuous map\n\\newcommand{\\Op}{\\mathrm{Op}} %Category of open subsets\n\\newcommand{\\Sh}{\\mathrm{Sh}} %Category of sheave\n\\newcommand{\\PSh}{\\mathrm{PSh}} %Category of presheave, PSh(C)=[C^op,set]のこと\n\\DeclareMathOperator{\\Conv}{Conv} %Convergence spaceの圏\n\\newcommand{\\Unif}{\\mathrm{Unif}} %一様空間と一様連続写像の圏\n\\newcommand{\\Frm}{\\mathrm{Frm}} %フレームとフレームの射\n\\newcommand{\\Locale}{\\mathrm{Locale}} %その反対圏\n\\newcommand{\\Diff}{\\mathrm{Diff}} %滑らかな多様体の圏\n\\newcommand{\\Quiv}{\\mathrm{Quiv}} %Quiverの圏\n\\newcommand{\\B}{\\mathcal{B}}\\newcommand{\\cB}{\\mathcal{B}}\\newcommand{\\Span}{\\mathrm{Span}}\\newcommand{\\Corr}{\\mathrm{Corr}}\\newcommand{\\Decat}{\\mathrm{Decat}}\\newcommand{\\Rep}{\\mathrm{Rep}}\\newcommand{\\Grpd}{\\mathrm{Grpd}}\\newcommand{\\sSet}{\\mathrm{sSet}}\\newcommand{\\Mod}{\\mathrm{Mod}}\\newcommand{\\SmoothMnf}{\\mathrm{SmoothMnf}}\\newcommand{\\coker}{\\mathrm{coker}}\\newcommand{\\Ord}{\\mathrm{Ord}}\\newcommand{\\eq}{\\mathrm{eq}}\\newcommand{\\coeq}{\\mathrm{coeq}}\\newcommand{\\act}{\\mathrm{act}}\n\n%%% SMC\n\\newcommand{\\apf}{\\mathrm{apf}}\\newcommand{\\opt}{\\mathrm{opt}}\\newcommand{\\IS}{\\mathrm{IS}}\\newcommand{\\IR}{\\mathrm{IR}}\\newcommand{\\iidsim}{\\overset{\\text{iid}}{\\sim}}\\DeclareMathOperator{\\KL}{KL}\\DeclareMathOperator{\\JS}{JS}\\DeclareMathOperator{\\ESS}{ESS}\\DeclareMathOperator{\\MSE}{MSE}\\newcommand{\\propt}{\\,\\propto\\,}\\newcommand{\\bM}{\\mathbb{M}}\\newcommand{\\cX}{\\mathcal{X}}\\newcommand{\\cY}{\\mathcal{Y}}\\newcommand{\\cP}{\\mathcal{P}}\\newcommand{\\ola}[1]{\\overleftarrow{#1}}\n\n%%% 括弧類\n\\newcommand{\\ov}[1]{\\overline{#1}}\\newcommand{\\un}[1]{\\underline{#1}}\\newcommand{\\wt}[1]{\\widetilde{#1}}\\newcommand{\\wh}[1]{\\widehat{#1}}\n\\newcommand{\\pp}[2]{\\frac{\\partial #1}{\\partial #2}}\\newcommand{\\ppp}[3]{\\frac{\\partial #1}{\\partial #2\\partial #3}}\\newcommand{\\dd}[2]{\\frac{d #1}{d #2}}\n\\newcommand{\\floor}[1]{\\lfloor#1\\rfloor}\\newcommand{\\Floor}[1]{\\left\\lfloor#1\\right\\rfloor}\\newcommand{\\ceil}[1]{\\lceil#1\\rceil}\n\\newcommand{\\ocinterval}[1]{(#1]}\\newcommand{\\cointerval}[1]{[#1)}\\newcommand{\\COinterval}[1]{\\left[#1\\right)}\n\n%%% 予約語\n\\renewcommand{\\iff}{\\;\\mathrm{iff}\\;}\n\\newcommand{\\False}{\\mathrm{False}}\\newcommand{\\True}{\\mathrm{True}}\n\\newcommand{\\otherwise}{\\mathrm{otherwise}}\n\\newcommand{\\suchthat}{\\;\\mathrm{s.t.}\\;}\n\n%%% 略記\n\\newcommand{\\cM}{\\mathcal{M}}\\newcommand{\\M}{\\mathbb{M}}\\newcommand{\\cF}{\\mathcal{F}}\\newcommand{\\cD}{\\mathcal{D}}\\newcommand{\\fX}{\\mathfrak{X}}\\newcommand{\\fY}{\\mathfrak{Y}}\\newcommand{\\fZ}{\\mathfrak{Z}}\\renewcommand{\\H}{\\mathcal{H}}\\newcommand{\\cH}{\\mathcal{H}}\\newcommand{\\fH}{\\mathfrak{H}}\\newcommand{\\bH}{\\mathbb{H}}\\newcommand{\\id}{\\mathrm{id}}\\newcommand{\\A}{\\mathcal{A}}\n\\newcommand{\\lmd}{\\lambda}\n\\newcommand{\\Lmd}{\\Lambda}\n\\newcommand{\\cI}{\\mathcal{I}}\n\n%%% 矢印類\n\\newcommand{\\iso}{\\overset{\\sim}{\\to}}\n\\newcommand{\\Lrarrow}{\\;\\;\\Leftrightarrow\\;\\;}\n$$\n:::\n\n\n\nYUIMAについては次の記事も参照：\n\n\n```{=html}\n<div class=\"article-card-container\">\n  <div class=\"article-card\">\n    <a href=\"https://162348.github.io/posts/2024/Computation/YUIMA.html\" target=\"_blank\">\n      <img src=\"https://162348.github.io/posts/2024/Computation/YUIMA_files/figure-html/unnamed-chunk-5-1.png\" alt=\"Article Image\" class=\"article-image\">\n      <div class=\"article-content\">\n        <h3 class=\"article-title\">YUIMA 入門</h3>\n        <p class=\"article-description\">確率微分方程式のシミュレーションと推測のためのパッケージ`yuima`の構造と使い方をまとめます．</p>\n      </div>\n    </a>\n  </div>\n</div>\n```\n\n\n## Poisson 過程\n\n### 導入\n\nPoisson 過程と言った場合，Poisson 点過程 $\\eta$ と Poisson 計数過程 $N$ の２つを峻別する必要がある．^[[@Nualart2018 p.159] 例9.1.3，[@Revuz-Yor1999 p.471] 定義XII.1.3 などは，Poisson 計数過程の方を Poisson 過程と呼んでおり，[@Last_Penrose2017] などは Poisson 点過程の方を Poisson 過程と呼んでいる．]\n\n::: {.callout-important appearance=\"simple\" icon=\"false\"}\n\n$E=[0,T]$，$\\lambda>0$ とした場合，\n\n* $E$ 上の（一様な） Poisson 点過程 $\\eta$ とは，$X_k\\iidsim\\rU([0,T])$ を一様確率変数，$\\kappa\\sim\\Pois(\\lambda)$ を Poisson 確率変数として，\n    $$\n    \\eta=\\sum_{k=1}^\\kappa\\delta_{X_k}\n    $$\n    で表せる確率核 $\\Om\\to E$ をいう．\n* $E$ 上の（一様な） Poisson 計数過程 $N$ とは，$\\eta$ に対して\n    $$\n    N_t:=\\#\\Brace{n\\in\\N\\mid X_n\\le t}=\\sum_{n=1}^\\infty1_{\\Brace{X_n\\le t}}\n    $$\n    で定まる Lévy 過程をいう．\n\n:::\n\nこのとき，\n$$\n\\eta([0,t])\\sim\\Pois(\\lambda t),\n$$\n$$\nN_t\\sim\\Pois(\\lambda t),\n$$\nが成り立つ．\n\n$N$ は大きさ１の跳躍のみで増加する Lévy 過程として特徴付けられる：$N_t\\sim\\Pois(\\lambda t)$．^[[@Revuz-Yor1999 p.472] 命題XII.1.4など．]\n\n後者は，前者を駆動過程とした積分\n$$\nN_t:=\\int_0^td\\eta_s\n$$\nと理解できる．\n\n### 点過程の定義\n\n::: {.callout-tip title=\"定義 (point process)^[[@Kallenberg2017 p.49]，[@Last_Penrose2017 p.11] 定義2.1 に倣った．全く同じ概念を [@伊藤清1991 p.298] は **偶然配置** と呼ぶ．]\" icon=\"false\"}\n\n$(E,\\cE)$ を測度空間とする．$E$ 上の **点過程** とは，次の条件を満たす確率核 $\\eta:\\Om\\to E$ をいう：\n$$\n\\eta(\\om,B)\\in\\N\\cup\\{\\infty\\},\\qquad\\om\\in\\Om,B\\in\\cE.\n$$\n\n:::\n\n**真の点過程** とは，ある $E$-値確率変数の列 $X_1,X_2,\\cdots$ と，$\\N\\cup\\{\\infty\\}$-値確率変数 $\\kappa$ が存在して，\n$$\n\\eta=\\sum_{n=1}^\\kappa \\delta_{X_n}\\;\\as\n$$\nと表せる点過程をいうこととする．\n\n::: {.callout-important title=\"注（より直感的な定義）\" collapse=\"true\" icon=\"false\"}\n\n[@Revuz-Yor1999 p.471] 定義XII.1.1 は違う定義を与えている：\n\n$E$ 上の点過程とは，$E_\\delta:=E\\cup\\{\\delta\\}$ 上の確率過程 $\\{e_t\\}_{t\\in\\R_+}\\subset\\L(\\Om;E_\\delta)$ であって，次の２条件を満たすものをいう：\n\n1. $(t,\\om)\\mapsto e_t(\\om)$ は $\\B(\\R^+)\\otimes\\F$-可測である．\n2. $D_\\om:=\\Brace{t\\in\\R_+\\mid e_t(\\om)\\ne\\delta}$ は殆ど確実に可算である．\n\n[@Kingman2006] の定義は「$E$ 内のランダムに決まる可算集合」というもので，これに似ている．この定義は，上で与えた確率核による定義よりも強いものである．\n\n確率核の意味での点過程が，追加で次の条件を満たすとき，真の点過程になる：^[[@Last_Penrose2017 p.48] 系6.5 を参照．] 特に，[@Revuz-Yor1999] の意味でも点過程である．\n\n> ある可算な分割 $\\sqcup_{n\\in\\N}B_n=E$ が存在して，\n    $$\n    \\P[\\eta(B_n)<\\infty]=1\n    $$\n    である．\n\n$E$ が Polish 空間で，$\\eta(\\om,-)$ が（殆ど確実に）任意の有界集合上で有限ならば，これを満たす．よって特に，$\\sigma$-有限な強度測度を持つ Poisson 過程はこれを満たす．すなわち，いずれの意味でも点過程である．\n\n:::\n\n### 強度測度\n\n点過程には「各集合 $B\\in\\cE$ に平均何個の点が入るか」を表す **強度測度** が定まる．\n\nこの強度測度に関して，Fubini の定理のような性質\n$$\n\\E\\Square{\\int_E u\\,d\\eta}=\\int_Eu\\E[d\\eta]\n$$\nが成り立つ．\n\n::: {.callout-tip title=\"定義 (intensity measure)^[[@伊藤清1991 p.298] に倣った．]\" icon=\"false\"}\n\n$\\eta$ を点過程とする．$\\eta$ の **強度測度** とは，次で定まる測度 $\\mu:\\cE\\to[0,\\infty]$ をいう：\n$$\n\\lambda(B):=\\E[\\eta(B)],\\qquad B\\in\\cE.\n$$\n\n:::\n\n::: {.callout-tip title=\"命題 [@Campbell1909 の公式]^[[@Last_Penrose2017 p.13] 命題2.7 に倣った．]\" icon=\"false\"}\n\n$\\eta$　を点過程，$\\lambda$ をその強度測度とする．任意の $u\\in\\L(E)$ について，$(\\eta|u)$ は確率変数であり，加えて $u\\in\\L^1(\\lambda)$ または $u\\ge0$ である場合，次が成り立つ：\n$$\n\\E\\Square{\\int_Eu(x)\\eta(dx)}=\\int_Eu(x)\\lambda(dx).\n$$\n\n:::\n\n::: {.callout-note title=\"証明\" icon=\"false\" collapse=\"true\"}\n\n$u$ がある $B\\in\\cE$ の特性関数 $u=1_B$ である場合，\n$$\n\\int_Eu(x)\\eta(dx)=\\eta(B)\n$$\nであり，点過程 $\\eta$ の定義からこれは確率変数である．\n\n期待値の線型性より一般の単関数，単調収束定理より一般の可測関数についても成り立つ．\n\n$u\\in\\L^1(\\lambda)$ であるとき，$u$ に収束する単関数列\n$$\nu_n:=\\sum_{i=1}^{m_n}a_i^{(n)}1_{B_i^{(n)}}\\nearrow u\n$$\nを取ると，Lebesgue の優収束定理より次のように結論づけられる：\n\\begin{align*}\n    \\E\\Square{\\int_Eu(x)\\eta(dx)}&=\\lim_{n\\to\\infty}\\E\\Square{\\int_Eu_n(x)\\eta(dx)}\\\\\n    &=\\lim_{n\\to\\infty}\\E\\Square{\\sum_{i=1}^{m_n}a_i^{(n)}\\eta(B_i^{(n)})}\\\\\n    &=\\lim_{n\\to\\infty}\\sum_{i=1}^{m_n}a_i^{(n)}\\lambda(B_i^{(n)})\\\\\n    &=\\int_Eu(x)\\lambda(dx)=(\\lambda|u)<\\infty.\n\\end{align*}\n\n$u\\ge0$ の場合も同様で，Lebesgue の優収束定理が単調収束定理に変わるのみである．\n\n:::\n\n### Poisson 点過程の定義\n\n::: {.callout-tip title=\"定義 (Poisson process / random measure)^[[@Nualart2018 p.160] 定義9.2.1，[@Sato2013 p.119] 第4章19節，[@Resnick2002 p.303]，[@Last_Penrose2017 p.19] 定義3.1 に倣った．]\" icon=\"false\"}\n\n$(E,\\cE)$ を可測空間，$\\lambda:\\cE\\to[0,\\infty]$ を測度とする．強度 $\\lambda$ の **Poisson 過程** とは，次の２条件を満たす点過程 $\\eta$ をいう：\n\n1. 任意の $B\\in\\cE$ に対して，$\\eta(B)\\sim\\Pois(\\lambda(B))$．\n2. 任意の $m\\in\\N$ と互いに素な可測集合 $B_1,\\cdots,B_m\\in\\cE$ について，$\\eta(B_1),\\cdots,\\eta(B_m)$ は独立である．\n\n:::\n\n$\\lambda,\\lambda'$ が $\\sigma$-有限であるとする．このとき，$\\lambda=\\lambda'$ ならば，これを強度とする Poisson 過程は分布同等である．^[[@Revuz-Yor1999 p.476] 命題 XII.1.12，[@Last_Penrose2017 p.20] 命題3.2 も参照．]\n\n::: {.callout-tip title=\"命題（Poisson 過程は Poisson 点過程と分布同等である）^[[@Nualart2018 p.160] 定理9.2.2 では，$\\lambda$ はアトムを持たないとし，$E$ を Polish 空間として示している．[@Last_Penrose2017 p.22] 系3.7 はここよりも一般的な設定で示している．]\" icon=\"false\"}\n\n$\\lambda$ を $\\sigma$-有限とする．このとき，ある確率変数の列 $\\{X_n\\}\\subset\\L(\\Om;E)$ と $\\N\\cup\\{\\infty\\}$-値確率変数 $\\kappa$ が存在して，\n$$\n\\eta:=\\sum_{n=1}^\\kappa\\delta_{X_n}\n$$\nは強度 $\\lambda$ の Poisson 過程となる．\n\n:::\n\n### 例\n\n#### 二項過程の一般化\n\n$\\mu\\in\\cP(E),\\pi\\in\\cP(\\N)$ とする．$X_k\\iidsim\\mu$ と $\\kappa\\sim\\pi$ について，\n$$\n\\eta:=\\sum_{k=1}^\\kappa\\delta_{X_k}\n$$\nは点過程を定める．これを **サンプリング分布 $\\mu$ を持った $\\pi$-複合二項過程** という．^[[@Last_Penrose2017 p.20] 定義3.4も参照．]\n\nある $\\gamma>0$ に関して $\\pi=\\Pois(\\gamma)$ と取った場合，$\\eta$ は強度 $\\gamma\\mu$ を持った Poisson 過程となる．\n\nこれについて，次が成り立つ：\n\n::: {.callout-tip title=\"命題（有限な強度を持つ Poisson 過程の特徴付け）^[[@Last_Penrose2017 p.23] 命題3.8も参照．]\" icon=\"false\"}\n\n$\\lambda:\\cE\\to(0,\\infty)$ を有限測度とする．このとき，点過程 $\\eta$ について，次の２条件は同値である：\n\n1. $\\eta$ は $\\lambda$ を強度測度とする Poisson 過程である．\n2. サンプリング分布 $\\mu:=\\lambda(E)^{-1}\\lambda$ を持つ $\\Pois(\\lambda(E))$-複合二項過程である．\n\n特に，$\\eta(E)=m$ で条件づけた分布は，$\\delta_{X_1}+\\cdots+\\delta_{X_m}$ に等しい．\n\n:::\n\n#### $\\R_+$ 上の Poisson 過程 {#sec-Poisson-point-process-on-R}\n\n$\\R_+$ の Poisson 過程で，強度が $\\R_+$ 上の Lebesgue 測度の定数倍であるものを **一様 Poisson 過程** といい，$\\lambda>0$ を **レート** ともいう．\n\n::: {.callout-tip title=\"命題（$\\mathbb{R}_+$ 上の Poisson 点過程の特徴付け）^[[@Last_Penrose2017 p.59] 定理7.2参照．]\" icon=\"false\"}\n\n$\\eta$ を $\\R_+$ 上の点過程とする．このとき，$\\lambda>0$ に関して次は同値：\n\n1. $\\eta$ はレート $\\lambda$ を持った一様 Poisson 過程である．\n2. 到着時刻\n    $$\n    T_n(\\om):=\\inf\\Brace{t\\ge0\\mid \\eta(\\om,[0,t])\\ge n}\n    $$\n    の間隔は $\\Exp(\\lambda)$ の独立同分布である．\n\n:::\n\n### 印付き過程 {#sec-marked-process}\n\n::: {.callout-tip title=\"定義 ($K$-marking)^[[@Last_Penrose2017 p.40] 定義5.3 に倣った．[@Kingman1992 p.55] 5.2節も参照．]\" icon=\"false\"}\n\n$\\eta$ を $E$ 上の真の点過程，$K:E\\to F$ を確率核，$\\{Y_n\\}\\subset\\L(\\Om;F)$ を確率変数列とする．加えて，任意の $m\\in\\N\\cup\\{\\infty\\}$ について\n$$\n(Y_n)_{n\\le m}\\mi\\kappa=m,(X_n)_{n\\le m}\\deq \\otimes_{n=1}^mK(X_n,-)\n$$\nが成り立つとする．このとき，$X$ の **$K$-付印過程** とは，$E\\times F$ 上の真の点過程\n$$\n\\xi:=\\sum_{n=1}^\\kappa\\delta_{(X_n,Y_n)}\n$$\nをいう．\n\n:::\n\n$\\eta$ を $\\sigma$-有限な強度 $\\lambda$ を持つ Poisson 過程とするとき，$\\eta$ の任意の可測写像 $T:E\\to F$ による像は $T_*\\lambda$ を強度とする Poisson 過程となり，$\\eta$ の任意の $K$-印付き過程もやはり Poisson 過程になる．^[例えば [@Kingman1992 p.55]，[@Last_Penrose2017 p.42] 命題5.5 を参照．]\n\n$K:E\\to\\cP(F)$ が定値関数になる場合（すなわち $\\{Y_n\\}$ が $X_n$ の値に依らずに独立同分布に定まる場合），これを **独立 $K$-付印** という．\n\n::: {.callout-caution title=\"例（降水量の時系列）\" collapse=\"true\" icon=\"false\"}\n\n雨がふるという事象が Poisson 点過程に従い，その際の降水量がランダムに決まるため，降水量の時系列は古くから独立付印 Poisson 過程としてモデル化されている [@Todorovic-Yevjevich1969]．^[日本語文献としては，[@西村克己-江藤剛治1981] も参照．]\n\n:::\n\n::: {.callout-tip title=\"命題（一様 Poisson 過程の独立付印過程の特徴付け）\" icon=\"false\"}\n\n$$\n\\xi=\\sum_{n=1}^\\infty1_{\\Brace{T_n<\\infty}}\\delta_{(T_n,Y_n)}\n$$\nを $\\R_+\\times E$ 上の点過程，\n$$\n\\eta=\\sum_{n=1}^\\infty1_{\\Brace{T_n<\\infty}}\\delta_{T_n}\n$$\nを $\\R_+$ 上の点過程とする．\n\n$\\gamma>0$ と $\\mu\\in\\cP(E)$ について，次は同値：\n\n1. $\\xi$ はレート $\\gamma$ を持つ一様 Poisson 過程 $\\eta$ の $\\mu$-独立付印である．\n2. $T_1,Y_1,T_2-T_1,Y_2,\\cdots$ は独立で，$T_n-T_{n-1}\\sim\\Exp(\\gamma)$ かつ $Y_n\\iidsim\\mu$ である．\n\n:::\n\n### 剪定\n\n::: {.callout-tip title=\"定義 ($p$-thinning)^[[@Last_Penrose2017 p.43] 定義5.7 に従った．]\" icon=\"false\"}\n\n$p:E\\to[0,1]$ を可測関数とし，確率核 $K:E\\to2$ を次で定める：\n$$\nK_p(x,-):=\\Paren{1-p(x)}\\delta_0+p(x)\\delta_1.\n$$\n\n$E$ 上の真の点過程 $X$ の，この確率核に関する $E\\times2$ 上の $K$-印付き過程 $M$ に対して，\n$$\n(\\om,B)\\mapsto M(\\om,B\\times\\{1\\})\n$$\nで定まる $E$ 上の真の点過程を $X$ の **$p$-剪定** という．\n\n:::\n\nすなわち，点 $x\\in E$ に定まる所定の確率 $p(x)$ に関して，確率 $p(X_n)$ で点 $X_n$ を脱落させて得る点過程を，$p$-剪定という．\n\n$p$-剪定は強度 $p(x)\\lambda(dx)$ を持つ Poisson 過程となる．加えて，$1-p$-剪定と違いに独立になる．^[[@Last_Penrose2017 p.44] 系5.9 参照．]\n\n::: {.callout-caution title=\"例（非一様な Poisson 過程のシミュレーション）\" collapse=\"true\" icon=\"false\"}\n\nこの剪定によって，連続なレート関数 $\\lambda$ を持つ非一様な Poisson 過程をシミュレーションする方法が [@Lewis-Shedler1979] で提案され，[@Ogata1981] が一般の点過程に拡張した．\n\n実際，`yuima`でもこの方法が採用されている（第 [-@sec-nonhomogeneous-Poisson-process] 節）．\n\nアルゴリズムは次のとおりである：\n\n> $\\lambda\\le\\lambda^*$ を満たす２つのレート関数を持つ Poisson 過程 $\\eta,\\eta^*$ を考える．$\\eta^*([0,x_0])$ 内の点\n> $$\n> X_1^*,X_2^*,\\cdots,X_{\\eta^*([0,x_0])}^*\n> $$\n> を生成し，それぞれの点を確率 $1-\\frac{\\lambda(X_i^*)}{\\lambda^*(X_i^*)}$ で取り除く．すると，残った点は\n> $$\n> \\frac{\\lambda(X_i^*)}{\\lambda^*(X_i^*)}\\lambda^*(dx)=\\lambda(dx)\n> $$\n> をレート関数にもつ Poisson 過程の分布，すなわち $\\eta$ の分布に従う．\n\n最も簡単な場合としては，$\\lambda^*:=\\max_{t\\in[0,x_0]}\\lambda(t)$ などと取れば良い．\n\n:::\n\n### Poisson 過程に関する積分 {#sec-Poisson-integral}\n\n::: {.callout-tip title=\"命題（Poisson 点過程との積分）^[[@Last_Penrose2017 p.111] 命題12.1 参考．]\" icon=\"false\"}\n\n$(E,\\cE,\\lambda)$ を $\\sigma$-有限な測度空間，$\\eta$ を $E$ 上の強度測度 $\\lambda$ を持つ Poisson 点過程とする．\n\nこのとき，$f\\in\\L(E)_+$ について，次は同値：\n\n1. $\\P[(\\eta|f)<\\infty]=1$．\n2. 次が成り立つ：\n$$\n\\int_E(f\\land1)d\\lambda<\\infty.\n$$\n\nまた，これらの条件が成り立たないとき，$\\P[(\\eta|f)=\\infty]=1$ が成り立つ．\n\n:::\n\nBrown 運動に関する伊藤積分と同様に，\n$$\nI(f):=(\\eta|f)-(\\lambda|f)\\in L^2(\\P)\n$$\nは $L^1(\\lambda)\\cap L^2(\\lambda)$ 上の等長作用素で，$L^2(\\lambda)$ 上に有界延長する．^[[@Nualart2018 p.163] 9.3節，[@Last_Penrose2017 p.113] 命題12.4 など．]\n\n::: {.callout-tip title=\"命題（Poisson 積分の分布）^[[@Sato2013 p.123] 定理19.5 による．[@Nualart2018 p.164] は補過程に関する積分に関して述べており，そのために追加で$-iu\\int_Eh(z)\\lambda(dz)$ の項を持つ．．]\" icon=\"false\"}\n\n$(E,\\cE)$ を可測空間，$N$ を強度測度 $\\lambda$ を持つ Poisson 点過程とする．このとき，$N$ に関する $h\\in\\L^2(\\lambda;\\R^d)$ の積分\n$$\n(N|h)=\\int_Eh(z)N(dz)\n$$\nの第二キュムラント母関数は，次のように表される：\n\\begin{align*}\n    \\psi(u)&=\\int_E\\Paren{e^{i(u|h(z))}-1}\\lambda(dz)\\\\\n    &=\\int_E\\Paren{e^{i(u|x)}-1}(h_*\\lambda)(dx).\n\\end{align*}\nすなわち，$(N|h)$ は複合 Poisson 分布 $\\CP(1,h_*\\lambda)$ に従う，平均 $(\\lambda|h)$，分散 $(\\lambda|h^2)$ の確率変数である．\n\n:::\n\n### Poisson 計数過程のシミュレーション\n\n`yuima`パッケージでは，Poisson 計数過程は複合 Poisson 計数過程の特別な場合として扱うため，シミュレーション法は第 [-@sec-simulating-CP] 節で扱い，ここでは結果のみを示す．\n\n#### 一様な Poisson 計数過程\n\n強度 $\\lambda>0$ を持つ（一様な） Poisson 計数過程とは，$\\R_+$ 上のレート $\\lambda>0$ を持つ一様な Poisson 点過程（第 [-@sec-Poisson-point-process-on-R] 節）$\\eta$ に対して，\n$$\nN_t(\\om):=\\eta(\\om,[0,t])\n$$\nで定まる Lévy 過程である．\n\nレート $\\lambda>0$ はジャンプの頻度を表している：\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](Poisson_files/figure-html/unnamed-chunk-2-1.png){width=576}\n:::\n:::\n\n\n#### 非一様な Poisson 計数過程 {#sec-nonhomogeneous-Poisson-process}\n\n強度関数 $\\lambda:\\R_+\\to\\R^+$ を持つ **非一様な Poisson 計数過程** とは，全く同様な定義\n$$\nN_t(\\om):=\\eta(\\om,[0,t])\n$$\nをし，ただ $\\eta$ の強度測度を $\\lambda(t)\\ell_+(dt)$ に置き換えたものである．\n\n例えば，強度関数\n$$\n\\lambda(t)=10e^{-\\frac{t}{5}}\n$$\nを持つ非一様な Poisson 過程は次のような見本道を持つ：\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](Poisson_files/figure-html/unnamed-chunk-4-1.png){width=576}\n:::\n:::\n\n\n時間が経つごとに強度関数 $\\lambda$ の値（赤線）が小さくなり，それに伴ってジャンプの頻度が減少していくことがわかる．\n\n## 複合 Poisson 過程\n\n### 導入\n\n点過程としての複合 Poisson 過程は，Poisson 点過程の印付きから構成される．\n\n#### 計数過程として\n\nPoisson 過程 $N$ は，大きさ１の跳躍のみで増加する Lévy 過程として特徴付けられるのであった．\n\nこの跳躍の大きさを任意の確率分布 $\\mu\\in\\cP(\\R)$ に従ったものに変更したもの\n\\begin{align*}\n    M_t&:=\\sum_{n=1}^{N_t}Y_n\\\\\n    &=\\sum_{k=1}^\\kappa Y_k1_{\\Brace{X_k\\le t}}\n\\end{align*}\nが **複合 Poisson （計数）過程** $\\CP(\\lambda,\\mu)$ である．^[[@Nualart2018 p.159] 例9.1.4，[@Last_Penrose2017 p.155] 例15.5 など．]\n\n$\\mu=\\delta_1$ の場合が Poisson 過程に当たる．^[[@Applebaum2009 p.50] も参照．]\n\n#### 点過程として\n\nこれは，まず， $\\eta$ の印付き過程\n$$\n\\xi:=\\sum_{n=1}^\\kappa\\delta_{(X_n,Y_n)}\n$$\nが $E\\times\\R$ 上の強度測度 $\\mu\\otimes\\lambda\\ell$ を持つ Poisson 点過程であり，各 $X_n$ に $Y_n$ の重みをつけて足し合わせた点過程が基になっている．\n\nこれが複合 Poisson 点過程であり，$\\xi$ に関する積分として $M$ が理解できる（第 [-@sec-Poisson-integral] 節参照）．\n\n<!-- 複合 Poisson 点過程はいわば Poisson 過程の -->\n\n::: {.callout-important title=\"注（Lévy 過程としての見方）\" collapse=\"true\" icon=\"false\"}\n\nPoisson 過程は定数の Lévy 測度 $\\lambda>0$ を持つ，特性量 $(0,0,\\lambda)$ が定める Lévy 過程である．\n\n一方で，複合 Poisson 過程 $\\CP(\\lambda,\\mu)$ は特性量 $(0,0,\\lambda\\mu)$ を持つ Lévy 過程である．\n\nLévy 測度 $\\nu$ について，$\\norm{\\nu}_\\TV$ はジャンプの頻度，$\\norm{\\nu}_\\TV^{-1}\\nu$ がジャンプの分布を表すと言える．\n\n:::\n\n#### 複合 Poisson 点過程の普遍性\n\n違いに素な $A,B\\in\\cE$ に対して $\\xi(A)\\indep\\xi(B)$ を満たすようなランダム測度 $\\xi$ は，固定した原子を持たないならば，ある決定論的な測度と複合 Poisson 点過程の和として表せる．^[[@Last_Penrose2017] 第 15.3 節参照．]\n\n### 複合 Poisson 点過程の定義\n\n#### 一般的な定義\n\n::: {.callout-tip title=\"定義 (compound Poisson process)^[[@Last_Penrose2017 p.153] に倣った．]\" icon=\"false\"}\n\n$(E,\\cE)$ を可測空間とする．$E$ 上の **複合 Poisson 分布** とは，$E\\times\\R^+$ 上の Poisson 過程 $\\eta$ を用いて\n$$\n\\xi(\\om,B)=\\int_{B\\times\\R^+}r\\,\\eta(\\om,dydr),\n$$\n$$\nB\\in\\cE,\n$$\nと表せる確率核 $\\xi:\\Om\\to E$ をいう．\n\n:::\n\n$E\\times\\R^+$ 上の Poisson 点過程 $\\eta$ の第二成分が，$E$ 上のランダム点の「重み」のようなもので，$\\xi$ は重みをつけて点を積分したものと理解できる．\n\n#### ジャンプ時刻とジャンプ幅が独立に決まる場合\n\n第 [-@sec-marked-process] 節で扱ったような，Poisson 点過程の独立付印の場合が特に重要なクラスであり，後ほど（一様な）Lévy 過程の例を提供する．\n\n::: {.callout-tip title=\"命題 ($\\rho_0$-symmetric compound Poisson process with Lévy measure $\\nu$)^[[@Last_Penrose2017 p.155] も参照，]\" icon=\"false\"}\n\nPoisson 点過程 $\\eta$ の強度測度が $\\lambda=\\rho_0\\otimes\\nu$ で表せ，さらに次を満たすとする：\n\n1. $\\rho_0\\in\\cP(E)$ は $\\sigma$-有限．\n2. $\\nu\\in\\cP(\\R^+)$ は\n    $$\n    \\int_0^\\infty(r\\land1)\\nu(dr)<\\infty\n    $$\n    を満たす．\n\nこのとき，次が成り立つ：\n\n1. $\\xi$ は $\\rho_0$-対称である：$\\rho_0(B)=\\rho_0(B')$ ならば，$\\xi(B)\\deq\\xi(B')$．\n2. 任意の $\\ep>0$ について $\\nu(\\cointerval{0,\\infty})<\\infty$．\n\n:::\n\n::: {.callout-caution title=\"例（Lévy 過程に付随する複合 Poisson 点過程）^[[@Nualart2018 p.162] 例9.2.4 を参考．]\" collapse=\"true\" icon=\"false\"}\n\nLévy 測度 $\\nu$ を持つ Lévy 過程 $(L_t)$ を考える．\n\nこのとき $\\nu$ は，$\\nu(\\{0\\})=0$ で，\n$$\n\\int_\\R(1\\land\\abs{z}^2)\\nu(dz)<\\infty\n$$\nを満たすとされる．\n\n$$\n\\cA_\\nu:=\\Brace{A\\in\\B(\\R\\setminus\\{0\\})\\mid \\nu(A)<\\infty}\n$$\nに対して，\n$$\nN([s,t]\\times A):=\\sum_{s\\le r\\le t}1_A(\\Delta L_r)\n$$\nとすると，時刻 $[s,t]$ 間の，幅が $A\\in\\cA_\\nu$ に入るジャンプの数を表す確率変数となる．\n\nこれは $\\R_+\\times\\R\\setminus\\{0\\}$ 上の Poisson 点過程に延長し，強度 $\\ell_+\\otimes\\nu$ を持つ．\n\nすなわち，$N$ は Lévy 測度 $\\nu$ を持つ $\\ell_+$-対称な複合 Poisson 点過程である．この $N$ を **跳躍測度** (jump measure) ともいう．\n\nLévy 測度 $\\nu$ は，単位時間あたり（$\\ell_+$ で測って測度 $1$ の集合あたり）の平均ジャンプ数を表す：\n$$\n\\nu(A)=\\E[N([0,1]\\times A)].\n$$\n\n:::\n\n### 複合 Poisson 点過程に関する積分\n\n$E$ 上の複合 Poisson 点過程 $\\xi$ とは，$E\\times\\R^+$ 上の Poisson 点過程 $\\eta$ に他ならないため，Poisson 点過程に関する積分を通じて，$f\\in\\L^2(\\lambda)$ に関して\n$$\n\\int_Ef\\,d\\xi=\\int_Erf(y)\\eta(dydr)\n$$\nと定義できる．^[[@Nualart2018 p.164] 例9.3.1，[@Last_Penrose2017 p.161] 15.4節なども参照．]\n\n$(r,z)\\mapsto rf(z)$ が $\\eta$ の強度測度 $\\lambda$ に関して可積分ならば，$(\\xi|f)$ も可積分な確率変数である．\n\n::: {.callout-caution title=\"例（Lévy 過程の分解）^[[@Nualart2018 p.164] 例9.3.1，[@Sato2013 p.120] 定理19.2，[@Protter2005 p.31] 定理42 など参照．]\" collapse=\"true\" icon=\"false\"}\n\n$L$ を特性量 $(\\beta,\\al^2,\\nu)$ を持つ Lévy 過程，$N$ を跳躍測度とする．\n\nLévy 測度は\n$$\n\\int_{B^d}z^2\\nu(dz)<\\infty\n$$\nを満たすから，\n$$\n\\int^t_0\\int_{B^d}z\\wh{N}(dsdz)<\\infty\n$$\nは可積分である．ただし，\n$$\n\\wh{N}([0,t]\\times A):=N([0,t]\\times A)-t\\nu(A)\n$$\nを中心化した Poisson 過程とした．これを **Poisson 補過程** (compensated Poisson process) ともいう．\n\nこのとき，$L$ は次の分解を持つ：\n$$\nL_t=\\beta t+\\al B_t+\\int^t_0\\int_{B^d}z\\wh{N}(dsdz)+\\int^t_0\\int_{\\Brace{\\abs{z}>1}}zN(dsdz).\n$$\nこのとき，$B\\indep N$ であり，最後の項は結局有限和である：\n$$\n\\int^t_0\\int_{\\R^d\\setminus B^d}zN(dsdz)=\\sum_{0\\le r\\le t}\\Delta L_r1_{\\R^d\\setminus B^d}(\\Delta L_r).\n$$\nこの項が有限であることは，$\\nu$ が $\\R^d\\setminus B^d$ 上で有限であることによる．\n\n:::\n\n### 複合 Poisson 計数過程の定義\n\n#### 一様な場合\n\n::: {.callout-tip title=\"定義 (compound Poisson processes)^[[@Iacus-Yoshida2018 p.137], p.158，[@Sato2013 p.18] 定理4.3，[@Protter2005 p.33] 例2，[@Baudoin2014-DiffusionProcess p.90] 演習3.44，[@Applebaum2009 p.49] 命題1.3.11 に倣った．]\" icon=\"false\"}\n\n$\\lambda>0$ を正数，$\\mu\\in\\cP(\\R^d)$ を確率分布とする．一様な **複合 Poisson 過程** $\\CP(\\lambda,\\mu)$ とは，強度 $\\lambda$ を持つ（一様な） Poisson 過程 $N$ が定める Lévy 過程 $\\{X_t\\}\\subset\\L(\\Om;\\R^d)$ をいう：\n$$\nX_t:=\\sum_{n=1}^{N_t}Y_n,\n$$\n$$\nY_n\\iidsim\\mu.\n$$\n\n:::\n\nこの $X_t$ は Lévy 過程になっており，$X_t$ の特性関数は\n$$\n\\varphi(u)=\\exp\\paren{\\lambda t\\int_{\\R^d}\\Paren{e^{i(u|y)}-1}\\mu(dy)}\n$$\nで表される．^[[@Sato2013 p.20] 命題4.5など参照．] すなわち，複合 Poisson 分布 $\\CP(\\lambda t,\\mu)$ に従う．\n\n#### 非一様な場合\n\nすなわち，複合 Poisson 分布が一様であるとは，背後にある $\\R^d\\times\\R_+$ 上の Poisson 点過程が\n\n一様とは限らない複合 Poisson 分布は，複合 Poisson 点過程 $\\xi$ を通じて\n$$\nM_t(\\om):=\\xi(\\om,[0,t])\n$$\n\n### シミュレーション {#sec-simulating-CP}\n\n`yuima`パッケージには，複合 Poisson 分布専用のコンストラクタ`setPoisson`が用意されている．このコンストラクタは２つの引数を持つ：\n\n::: {.callout-important appearance=\"simple\" icon=\"false\" title=\"`setPoisson`の引数^[[@Iacus-Yoshida2018 p.137] 参照．]\"}\n\n* `intensity`：強度（関数） $\\lambda>0$ として用いる変数名を文字列で指定する．\n* `df`：跳躍測度 $\\mu\\in\\cP(\\R^d)$ として用いる分布名を，文字列のリストで指定する．\n* `scale=1`：$\\norm{\\nu}_\\TV$ の値のこと．\n* `dimension=1`：$d$ の値．\n\n:::\n\n::: {.callout-caution title=\"例（一様 Poisson 過程の例）^[[@Iacus-Yoshida2018 pp.137-138] も参照．]\" collapse=\"true\" icon=\"false\"}\n\nPoisson 過程はジャンプの大きさが定数１の複合 Poisson 過程であるから，`df`としては $\\delta_1$ を意味する`dconst(z,1)`を指定する．\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(yuima)\n\nmod1 <- setPoisson(intensity=\"lambda\", df=list(\"dconst(z,1)\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nTerminal <- 30\nsamp <- setSampling(Terminal=Terminal, n=3000)\nset.seed(123)\npoisson1 <- simulate(mod1, true.par=list(lambda=1), sampling=samp)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(poisson1)\n```\n\n::: {.cell-output-display}\n![](Poisson_files/figure-html/unnamed-chunk-7-1.png){width=576}\n:::\n:::\n\n\n:::\n\n::: {.callout-caution title=\"例（正規分布に従う跳躍を持つ複合 Poisson 過程）^[[@Iacus-Yoshida2018 p.139] も参照．]\" collapse=\"true\" icon=\"false\"}\n\n`df`として正規分布族`dnorm(z,mu,sigma)`を指定すれば良い．\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod2 <- setPoisson(intensity=\"lambda\", df=list(\"dnorm(z,mu,sigma)\"))\npoisson2 <- simulate(mod2, sampling=samp, true.par=list(lambda=1, mu=0, sigma=2))\n```\n:::\n\n\n跳躍分布が $\\mu=\\rN_1(0,2)$ である場合の複合 Poisson 過程をシミュレーションは次のとおり：\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(poisson2)\n```\n\n::: {.cell-output-display}\n![](Poisson_files/figure-html/unnamed-chunk-9-1.png){width=576}\n:::\n:::\n\n\n:::\n\n### Gamma 過程\n\nGamma 計数過程は，跳躍のみによって増大する複合 Poisson 過程であるが，その強度測度は任意の区間上で無限であり，殆ど至る所でジャンプしており非連続である．\n\n#### Gamma 点過程\n\n$\\sigma$-有限測度 $\\rho_0\\in\\cP(E)$ と Lévy 測度 $\\nu:=\\GAMMA(b,0)$，すなわち\n$$\n\\nu(dr):=\\frac{e^{-br}}{r}dr\n$$\nについて，$\\lambda:=\\rho_0\\otimes\\nu$ で定まる強度測度を持つ $E\\times\\R_+$ 上の Poisson 点過程 $\\xi$ を **Gamma 点過程** という．^[定義は [@Last_Penrose2017 p.155] 例15.6 に倣った．]\n\nこれは\n$$\n\\xi(B)\\sim\\GAMMA(b,\\rho_0(B))\n$$\nを満たす複合 Poisson 点過程である．$\\rho_0$ のことを形状測度ともいう．\n\nしかし，$\\GAMMA(b,0)$ などという分布はなく，\n$$\n\\int^\\infty_0r^{-1}e^{-br}dr=\\infty.\n$$\n\nこのとき，任意の $\\rho_0$ で測って正の測度を持つ集合 $\\rho_0(B)>0\\;(B\\in\\cE)$ に対して，$\\xi(B)=\\infty\\;\\as$ が成り立つ．^[強度測度 $\\lambda$ は $\\sigma$-有限でないので，命題 [-@sec-Poisson-integral] の拡張を用いる必要がある．[@Last_Penrose2017 p.163] 演習15.2も参照．]\n\n#### Gamma 計数過程\n\n一般に，$\\xi$ を $\\R^+$ 上の Lévy 測度 $\\nu\\in\\cP(\\R^+)$ を持つ一様な複合 Poisson 点過程，すなわち $\\ell_+\\otimes\\nu$ を強度測度とする $\\R_+\\times\\R^+$ 上の Poisson 点過程とすると，\n$$\nY_t(\\om):=\\xi(\\om,[0,t])\n$$\nで定まる過程 $Y$ は，一般に Lévy 測度 $\\nu$ を持つ **従属過程** (subordinator) という．\n\nLévy 測度 $\\nu\\in\\cP(\\R^+)$ を\n$$\n\\nu(dr):=\\delta\\frac{e^{-\\gamma r}}{r}dr\n$$\n$$\n\\delta,\\gamma>0,\n$$\nで与えたとき，付随する従属過程 $\\{Y_t\\}$ を **Gamma 過程** といい，$\\GAMMA(\\delta,\\gamma)$ で表す．\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](Poisson_files/figure-html/unnamed-chunk-11-1.png){width=576}\n:::\n:::\n\n\n目視できないジャンプが無数に存在することが窺える．\n\n<!-- ```{R}\n#| echo: false\n#| warning: false\nsamp <- setSampling(Terminal=1, n=10000)\nGyuima <- setYuima(model=Gmodel, sampling=samp)\nresult <- simulate(Gyuima)\nplot(result,xlim=c(0,0.1),ylim=c(-0.05,0.05), main=\"Paths of gamma process\")\n``` -->\n\n#### 分散 Gamma 過程\n\n２つの独立な Gamma 過程\n$$\nX^+\\sim\\GAMMA(\\delta,\\gamma^-),X^-\\sim\\GAMMA(\\delta,\\gamma^+)\n$$\nに対して，\n$$\nX^0_t=X^+_t-X^-_t\n$$\nと表せる Lévy 過程 $X^0$ を [**分散 Gamma 過程**](https://en.wikipedia.org/wiki/Variance_gamma_process) という．^[[@Iacus-Yoshida2018 p.160] に倣った．]\n\n::: {.cell}\n::: {.cell-output-display}\n![](Poisson_files/figure-html/unnamed-chunk-12-1.png){width=576}\n:::\n:::\n\n分散 Gamma 過程は，オプション価格の対数のモデルとして，Brown 運動より柔軟なモデルとしても用いられる [@Madan+1998]．",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}