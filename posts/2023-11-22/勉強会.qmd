---
title: "確率論講義（1）第1章第1節"
author: "Hirofumi Shiba"
date: "11/22/2023"
categories: [草野数理法務]
toc: true
number-sections: true
website:
    twitter-card: true
bibliography: bib.bib
csl: apa.csl
abstract-title: 概要
abstract: 教科書第1章第1節(pp.1-14)までの内容を，確率論の公理と数学の考え方を補足しながら，自分の言葉で導出しなおした．
---

[@草野耕一2016] の勉強会第1回の補足として，確率論の数学的枠組みを紹介する．

![本勉強会の指定教科書](img.jpg){width=300}

## 今回の内容

### 本書の概観

本書は「数理法務」＝「法の数理分析」に関する発展的内容を扱った書籍で，内容は大きく次の4つからなる：

1. 法の行動分析：法律家がとるべき行動を数理を用いて分析する．
2. 法の統計分析：事実の推定や因果関係の推定に統計手法を応用する．
3. 法の財務分析：企業や金融に関わる法事象をファイナンス理論を用いて分析する．
4. 法の経済分析：法を経済学的な観点から分析する．

第1回勉強会では第1章「行動分析(1)事実認定」を扱った．事実認定を，Bayes推論の枠組みで捉え直し，法律家として誤謬やバイアスに陥ってしまうことを避けるツールとして，確率論を導入しており，「法の数理分析は役に立つ」ことを端的に実感できる，導入として極めて鮮やかな章になっている．

### 主観確率とBayes統計学

> 人は，確率論のもった政治的，社会的意義を忘れてはならない．理知を一切の尺度として「代数学の炉火によって倫理学及び政治学を照さん」(Condorcet) という時代精神，神の啓示に代らんとする確率論，それはフランス革命の思想的基礎に連関することを見失ってはならないのである．[@北川敏男49-統計学の認識]

まず，第1章は，事実認定の文脈で妥当な確率概念は「主観確率」であり，今後「確率」とはこの意味で用いることを注意喚起する内容から始まる．

主観確率と客観確率の詳細な定義は本書を参照願いたいが，一言で言えば，後者は「人間に不可知な真の値」というものの存在を前提とするのに対し，前者はそれを仮定しない．従って，主観確率の考え方は，より多くのものに「確率」を導入することを可能にし，より柔軟な議論が可能であるが，その分数理的な困難も増し，真に発展が進んだと言えるのは，計算機が十分に爛熟した21世紀になってのことであると言える．この統計学分野をBayes計算 (Bayesian Computation) といい，筆者の研究分野である．

大雑把に言って，客観確率に基づく統計手法を **頻度論的手法** (frequentist methods)，主観確率に対する統計手法を **Bayes手法** (Bayesian methods)という．一般に後者は前者を包含する（前者は後者の特別な場合^[[@McElreath20-StatisticalRethinking] 1.3節．頻度論はさらに「仮想的な反復」(imaginary resampling of data)を想定する，という性質を除けば，不確実性が観測からくるもののみである特別な場合が頻度論であると捉えられる．]）と考えられる．しかしこれは「確率の解釈」が違うのみであり，数学としては確率の定義は1つである．「確率の解釈」については，双方の立場の中でもそれぞれ複数の立場が乱立しており，ここでは立ち入らない．と言っても，この注記も教科書的なもので，実用上不便を生じる場面はほとんどないだろう．

律家による事実認定の文脈においても，「真実はいつも1つだからそれを推定したい」と考えても，「不確実な中でも，判断を誤らないようにしたい」と考えても，どちらから議論しても良いことは納得いただけるだろう．ただ，一般の人の素朴な「確率」の理解は，Bayes流のものに近いと言われている．^[[@McElreath20-StatisticalRethinking] 1.3節，[@Rubin84-ABC]．] そのこともあり，本書で主観確率の考え方を採用するというのは，「確率の解釈の議論はここではしない」「主観的な確信度合いの意味で，現実から多少の乖離を許す」という程度の意味であろう．

しかし，本書の「主観確率」の議論は中途半端な取り扱いでは終わらず，興味深いことに，One More Step 1-1 (pp.9-10) にてDonald Gilliesによる主観確率の測定による基礎付けの議論が紹介されていた．数理的な研究では全くない観点であり，己の議論の正統性・基礎付けに細心の注意を施す法律家の心が現れていると筆者は見た．

## 【深掘り】確率の公理 {#sec-2}

{{< include _preamble.qmd >}}

本書1.1節では確率の性質が列挙されている．1.2節以降では，これらの性質が「確率の定義」として引用されるが，いまいちどれを指して「定義」と呼んでいるのか定かでない．

数学的な議論に慣れたあとはそれでも良いかも知れないが，**法学も初学の間は逐一根拠条文に戻ることが大切であるように，数学もはっきりと定義を列挙し，「それのみを根拠とすること」を徹底することが大事である**．

なお，数学では何を定義として採用するかに任意性がある場合が多いが，唯一やってはいけないことは「定義が曖昧な状態で進むこと」である．そこで，せっかくであるから，現代数学が定義する最も筋の良い定義を採用して，本書の内容を俯瞰することにする．

現代数学において，確率を特徴付けるものは「代数的性質」であり，それは次の3つのみに集約される．^[Wikipediaページ[確率の公理](https://ja.wikipedia.org/wiki/%E7%A2%BA%E7%8E%87%E3%81%AE%E5%85%AC%E7%90%86)も参照．]

::: {.callout-tip icon="false" title="定義（確率） [@Kolmogorov-31]"}

| 集合 $\Omega$ 上の確率とは，次の3条件を満たす関数 $P:\mathcal{P}(\Omega)\to\R$ である：^[関数とは，入力と出力の集合 $X,Y$ の間に定まる対応であって，任意の入力 $x\in X$ に対してただ一つの出力 $y\in Y$ が対応するもののことをいう．この対応を $f(x)=y$ と表す．]
|    [P1] $P(\Omega)=1$．
|    [P2] $A\cap B=\emptyset$ ならば， $P(A\sqcup B)=P(A)+P(B)$．
|    [P3] 任意の事象 $A\subset\Omega$ について， $0\le P(A)$．^[後ろの2条件[P2], [P3] のみを満たす関数 $P$ は「測度」という．そのため，確率は測度でもある．数学用語では「確率分布」は「確率測度」ともいう（例えば[このwikipediaページ](https://ja.wikipedia.org/wiki/%E7%A2%BA%E7%8E%87%E6%B8%AC%E5%BA%A6)）．]

ただし，

* $P$ の定義域 $\mathcal{P}(\Omega)$ は「$\Omega$ の部分集合全体の集合」のことである．これを $\Om$ の**冪集合**という．
* $A\sqcup B$ とは， $A\cap B=\emptyset$ が成り立つときの $A,B$ の合併 $A\cup B$ を，$A\cap B=\emptyset$ を強調して書き分ける記法とする．
:::

この公理から，我々が日常的な感覚から「確率に成り立っていて欲しい性質」が全て導ける，ということが現代数学の重要な発見である．性質を見ていく前に，「定義」として，主要な概念に親しみやすい名前を付ける．そのすべての過程において，上の[P1], [P2], [P3]以外を用いていないことを確認することは，数学入門の際には非常に大事な営みである．^[[P1] などの P は Probability のつもりである．]

::: {.callout-tip icon="false" title="確率論に関連する用語"}

全体集合 $\Omega$ は所与のものとする．^[集合にも公理があり，現代数学は[ZFC公理系](https://ja.wikipedia.org/wiki/%E5%85%AC%E7%90%86%E7%9A%84%E9%9B%86%E5%90%88%E8%AB%96)の下で展開される．が，ここでは深入りしない．]

1. **事象** とは，部分集合 $A\subset\Omega$ のことをいう．
2. 事象 $A\subset\Om$ の補集合$$A^\comp=\Om\setminus A=\ov{A}:=\Brace{\om\in\Om\mid \om\notin A}$$を $A$ の**余事象**という．左から順に，数学で一般によく使われる記号である．^[$\lnot A$ という記法について，$\lnot$ は論理記号であるから，集合 $A$ に用いることは好ましくない．]
3. 2つの事象 $A,B\subset\Om$ が **排反** であるとは，集合として共通部分を持たないことをいう： $A\cap B=\emptyset$．

:::

この3性質から，本書第1.1節にいう「確率の推論法則」が全て導出できる．

### 式(1.1) p.4の証明

::: {.callout-tip icon="false" title="式(1.1) p.4"}
任意の事象 $A\subset\Omega$ について，$0\le P(A)\le 1$．^[確率は必ず$0$から$1$の値を取る，ということを主張している命題である．初学者はこれが「示すべき内容」として提示されていることに戸惑いを覚えるだろうが，現代数学では「これが示せるような必要最小限の定義が見つかった」ことに価値を見出す．]
:::

::: {.callout-tip icon="false" title="式(1.2) p.5"}
任意の事象 $A\subset\Omega$ について，
$$
P(A)+P(A^\comp)=1.
$$
:::

::: {.callout-note icon="false"}

## 証明

$0\le P(A)$ は[P3]に他ならない．式(1.2)も[P2]から従う．$A\subset\Om$ の補集合を $A^\comp:=\Omega\setminus A$ で表すと， $P(A^\comp)\ge0$ も成り立つから，
$$
\begin{align*}
P(A)&\le P(A)+P(A^\comp)\\
&=P(A\sqcup A^\comp)\\
&=P(\Om)=1.
\end{align*}
$$

:::

### 式(1.3) p.5の証明

::: {.callout-tip icon="false" title="式(1.3) p.5"}
任意の $n\ge1$ について， $n$ 個の事象 $A_1,\cdots,A_n\subset\Om$ が互いに排反であるとき，
$$
P(A_1)+P(A_2)+\cdots+P(A_n)=P(A_1\sqcup A_2\sqcup\cdots\sqcup A_n).
$$
:::

::: {.callout-note icon="false"}

## 証明

$n$ に関する数学的帰納法による．

:::

### 式(1.4) p.6の証明

::: {.callout-tip icon="false" title="式(1.4) p.6"}
任意の事象 $A,B\subset\Om$ について，
$$
P(A)+P(B)=P(A\cup B)+P(A\cap B).
$$
:::

[P2] の条件は，$A_1,A_2$ が排反である場合に限定しており，その制限が邪魔であった．ここで一般の加法公式を得ることになる．

::: {.callout-note icon="false"}

## 証明

$C:=A\cap B$ とおくと，3つの集合 $A\setminus B,C,B\setminus A$ が互いに排反であることから，

$$
\begin{align*}
P(A)+P(B)&=\Paren{P(A\setminus B)+P(C)}+\Paren{P(C)+P(B\setminus A)}\\
&=\Paren{P(A\setminus B)+P(C)+P(B\setminus A)}+P(C)\\
&=P(A\cup B)+P(A\cap B).
\end{align*}
$$

:::

```{python}
#| echo: false
import matplotlib.pyplot as plt
from matplotlib_venn import venn2

# 集合を定義
setA = set(['A', 'B', 'C', 'D'])
setB = set(['B', 'C', 'E', 'F'])

# Venn図を描画
venn = venn2([setA, setB], ('集合A', '集合B'))

# 共通部分にテキストを設定
venn.get_label_by_id('10').set_text('A\B')
venn.get_label_by_id('01').set_text('B\A')
venn.get_label_by_id('11').set_text('C=A∩B')

# 表示
plt.title("Venn Diagram")
plt.show()
```

### 条件付き確率の定義

::: {.callout-tip icon="false" title="定義（条件付き確率）"}

$A,B\subset\Om$ を事象とする．
事象 $A$ が起こった場合の，事象 $B$ の**条件付き確率**とは，
$$
P(B|A):=\begin{cases}\frac{P(A\cap B)}{P(A)}&P(A)\ne0\;\text{のとき}\\0&P(A)=0\;\text{のとき}\end{cases}
$$
という値を指す．^[ここでは $P(A)=0$ の場合は $0$ としたが，実際はどんな値でも良い．]

:::

### 式(1.7) p.7の証明

::: {.callout-tip icon="false" title="式(1.7) p.7"}
$A,B\subset\Om$ を事象，$P(A)>0$ とする．
$$
P(A|B)+P(A^\comp|B)=1.
$$
:::

::: {.callout-note icon="false"}

## 証明

$$
\begin{align*}
P(A|B)+P(A^\comp|B)&=\frac{P(A\cap B)}{P(B)}+\frac{P(A^\comp\cap B)}{P(B)}\\
&\overset{\text{[P2]}}{=}\frac{P((A\cap B)\sqcup (A^\comp\cap B))}{P(B)}\\
&=\frac{P(B)}{P(B)}=1.
\end{align*}
$$

:::

## 【重要概念】統計的独立性

### 定義

::: {.callout-tip icon="false" title="定義（独立性）"}

2つの事象 $A,B\subset\Om$ が**独立**であるとは，次を満たすことをいう：
$$
P(A\cap B)=P(A)P(B).
$$
このとき， $A\perp\!\!\!\perp B$ と表す．
:::

この式は本書p.7 (1.8)式に一致している．これを「積の公式」として導出しているが，これは**実は独立性の定義とすべき性質である**．その意味するところを次節で解説する．

### 条件付き確率による特徴付け

@sec-2 で「数学では何を定義として採用するかに任意性がある場合が多い」と言った．今回の「独立性」概念も，2つの同値な定義がある．しかし，「唯一やってはいけないことは定義が曖昧な状態で進むことである」とも言った．従って，どちらか片方を定義とし，「定義ともう一つの条件が同値である」という命題が生まれることになる．

この形の命題のことを（数学概念の）**特徴付け** という．このことを解説する[Wikipediaページ](https://ja.wikipedia.org/wiki/%E7%89%B9%E5%BE%B4%E3%81%A5%E3%81%91_(%E6%95%B0%E5%AD%A6))もある．

::: {.callout-tip icon="false" title="命題（独立性の特徴付け）"}

2つの事象 $A,B\subset\Om$ について，次の2条件は同値：

1. $A,B$ は独立である：$A\perp\!\!\!\perp B$．
2. $P(B|A)=P(B)$．

:::

::: {.callout-note icon="false"}

## 証明

$P[A]=0$ の場合，任意の $B$ について(1),(2)はいずれも常に成り立つ．
あとは，$P[A]\ne0$の場合を考える．
すると，条件付き確率の定義
$$P[A\cap B]=P[A]P[B|A]$$
を考えれば，この右辺が$P[A]P[B]$に等しいことと，$P[B|A]=P[B]$であることとは同値．

:::

本書では2.の性質の方を定義としているが， $P(B|A)$ という量は， $P(A)=0$ の場合に定義に任意性が残る．従って，1.の方が定義として明瞭ということになる．

さらに重要なことには，1.の方が一般個数の事象 $A_1,\cdots,A_n$ の場合に「独立性」の概念の拡張が可能であり，より本質的な定義だと思われる，ということが確率論の示唆である．実は，無限個の事象が独立であることも同様に定義する．

::: {.callout-tip icon="false" title="定義（独立性）"}

集合族 $\{A_\lambda\}_{\lambda\in\Lambda}\subset\F$ が**独立**であるとは，任意の $n\in\N$ 個の相異なる元 $A_{\lambda_1},\cdots,A_{\lambda_n}$ に対して，
$$P[A_{\lambda_1}\cap\cdots\cap A_{\lambda_n}]=P[A_{\lambda_1}]\cdots P[A_{\lambda_n}]$$
が成り立つことをいう．
:::

## 【余談】数学について

ここまでを読んだ読者の中で，「集合」「写像」の言葉に，定義が十分に提示されていないと感じたものがあるなら，あなたは極めて筋が良い．実は，これらの裏に全て厳密な定義があるのが数学であるが，今回は確率論に集中するために省いた．

実際，確率論をKolmogorovによる確率の公理的な定義 [@Kolmogorov-31] から始まる数学分野だとするならば，これはまだ100年の歴史もない，数学分野にしては極めて珍しい若い分野である．

確率論の確率が遅れた理由は，「確率」の概念がつかみどころのない日常に根ざした概念であり，抽象化が本質的に難しいこともあるだろうが，第一に「集合」「写像」といった概念が十分に数学者の間で理解が深まるのを待つ必要があったということがある．

現代の確率論では，「確率は測度の特別なものである」という態度をとっていることは本文中でも述べたが，この「測度」という概念の成立が，そもそもLebesgueによる積分論が確立される20世紀に入るのを待つ必要があった．