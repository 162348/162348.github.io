---
title: "粒子フィルターとは何か | About Particle Filters（執筆中）"
author: "Hirofumi Shiba"
date: "11/25/2023"
categories: [Particles]
toc: true
number-sections: true
website:
    twitter-card: true
bibliography: bib.bib
csl: apa.csl
abstract-title: 概要
abstract: 粒子フィルターは今年で30周年を迎える「万能」非線型フィルタリング手法である．相関を持つ粒子系によって分布を逐次的に近似する遺伝的アルゴリズムであり，多くの科学分野にまたがる応用を持つと同時に，数理的対象としても豊かな構造を持つ．その概要と今後の研究方向を紹介する．
---

## 背景

### フィルタリング問題とは？

### 粒子フィルターの発明

線型性や正規性の仮定を一才必要としないフィルタリングアルゴリズムとして，[@Gordon+1993] がbootstrap filterという名前で発表し，角度観測のみによる物体追跡 (bearings only tracking)への応用を付した．この角度情報のみから物体を追跡するという問題は古典的な非線型フィルタリング問題で，従来の拡張Kalmanフィルタの方法では精度が全く伸びず，これに比べてbootstrap filterでは圧倒的に性能が改善したのであった．

このように，粒子フィルターの発明から防衛，特に物体追跡が大きな応用先の一つであり，これを扱った一冊の本もある [@Ristic+2004]．

なお，北川源四郎も同年（1993年）のカンファレンスでMonte Carlo filterの名前で同様のアルゴリズムを発表している．そのジャーナル版は [@北川1996]．^[[Del MoralのWebサイト](https://people.bordeaux.inria.fr/pierre.delmoral/simulinks.html)も歴史的背景に詳しい．]

### 粒子フィルターの一般の逐次推定問題への応用

こうして，粒子フィルターはフィルタリング問題の文脈で発明されたMonte Carlo法であるが，フィルタリング問題に限らず，多くの逐次推定問題，更には（逐次的構造を持たない）一般の推定問題にも応用できる．この観点から，粒子フィルターは「逐次Monte Carlo法（Sequential Monte Carlo methods 略して **SMC** ）」ともいう．^[[@Chopin-Papaspiliopoulos20-SMC] 第3章参照．]

逐次的ではない通常の設定，いわば「静的」な設定の下でのBayes推論にSMCを用いる方法は [@Chopin2002] が草分け的な仕事をした．この枠組みでは，Bayes事後分布 $\pi(\theta|y_1,\cdots,y_N)$ の近似において，途中の $\pi(\theta|y_1,\cdots,y_n)$ を経由して逐次的に近似することが，自然な計算コスト削減法として理解できる．

### 粒子フィルターの欠点

粒子フィルターは高い汎用性の代償として，計算量が多いことを欠点に持つ．従って，粒子フィルターは，他の手法が実行不可能なほどの非線型性・非正規性を示す問題に（のみ）用いるべきというものである．

## 粒子フィルター入門

### 重点サンプリング

### 逐次重点サンプリングの修正としての粒子フィルター

逐次重点サンプリングは，次元が上がっていくにつれて分散が指数増大するという致命的欠点がある．そこで，「リサンプリング」（「選択（セレクション）」ともいう）という新たな機構を各段階に取り入れることを考える．この機構により，次元の呪いを克服し，推定精度が保たれるのであるが，一方で粒子の間に相関が導入されるために，理論的解析を困難にする．この点から粒子フィルターは「（平均場）相関粒子法」「遺伝型粒子フィルター」^[[@DelMoral-Horton2023-EnKF] など] ともいう．^[呼び方については[@DelMoral13-MeanFieldSimulation]と[この記事](https://162348.github.io/posts/2023-11-9/) も参照．]

## 技術的障壁と今後の研究

粒子フィルターの応用には次の点の研究が肝要である．^[[@Ristic+2004] Epilogueに次の言葉がある
> "The key factors for a successful application of particle filters in practice are therefore a good choice of the importance density and Rao-Blackwellization if possible.""
]

### 提案分布の取り方

### 部分的な線型構造の利用

周辺化粒子フィルター，またはRao-Blackwellized particle filterとも呼ばれる方法である．これは多くの場面で，仮定されている状態空間モデルが部分的に線型である場合に，線型の部分をKalmanフィルターによって正確に解き，残った部分のみを粒子フィルターで解くことで，精度の向上とアルゴリズムの効率化を図る方法である．

[@Ristic+2004 p.287] では，探知前追跡 (track-before-detect) の問題^[探知前追跡とは，信号が弱い，またはノイズが強い環境下において，信頼のおける初期信号を頼りにせずとも，物体追跡を実行するための手法．]において，周辺化粒子フィルタが，必要な粒子数を大きく削減してくれることを紹介している．

その他にも，問題毎の特有の構造を利用して計算量を削減・パフォーマンスを最適化することは重要な営みである．

### 粒子数に関する漸近論

目前の問題を，所与の精度で解くために必要な粒子数は幾ばくか？という問題は実用上も有益だと思われる．^[[@Ristic+2004 p.288] に示唆されている．]