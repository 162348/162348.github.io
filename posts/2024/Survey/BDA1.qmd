---
title: "ベイズデータ解析５"
subtitle: "回帰モデルの概観"
author: "司馬 博文"
date: 12/5/2024
date-modified: 12/5/2024
categories: [Bayesian, Statistics]
bibliography: 
    - ../../../assets/mathematics.bib
    - ../../../assets/bib.bib
    - ../../../assets/bib1.bib
csl: ../../../assets/apalike.csl
# abstract-title: 概要
# abstract: |
    
image: Files/BayesANOVA.png
listing: 
    -   id: lst-survey
        type: grid
        sort: false
        contents:
            - "../Computation/brms.qmd"
            - "BDA2.qmd"
            - "Survey1.qmd"
            - "Survey2.qmd"
            - "Survey3.qmd"
            - "Survey4.qmd"
        date-format: iso
        fields: [title,image,date,subtitle]
---

{{< include ../../../assets/_preamble.qmd >}}

## 関連記事 {.unnumbered .unlisted}

::: {#lst-survey}
:::

## 回帰分析の一般事項

### はじめに：正規線型回帰

回帰分析とは，２つの確率変数 $X,Y$ の実現と見られるデータが得られている際に，その条件付き期待値 $\E[Y|X]$ に対して，$x\in\cX$ に依存するモデル
$$
\cX\ni x\mapsto P_{\theta,x}\in\cP(\cY)
$$
を考えることをいう．例えば
$$
P_{\theta,x}=\rN(\beta^\top x,\sigma^2),\qquad\theta=(\beta,\sigma),
$$
とした場合を **正規線型回帰** (normal linear model) という．

### ベイズ回帰分析

しかしベイズ回帰分析では，条件付き期待値 $\E[Y|X]$ を推定するというより，本質的には結合変数 $(X,Y)$ の結合分布をモデリングしているとみなすべきである．

実際，ベイズ回帰分析では事前分布 $P_\varphi$ も併せて次の２つのモデルが想定される：
$$
Y|X\sim P_{\theta,x},\qquad X\sim P_\varphi.
$$

この結果，パラメータの空間 $(\theta,\varphi)$ 上からの確率核
$$
(\theta,\varphi)\mapsto P_{\theta,x}P_\varphi(dx)\in\cP(\cX\times\cY)
$$
が想定されることになる．これを **尤度** という．

尤度によりデータの空間 $\cX\times\cY$ 上の確率分布に関する問題を，パラメータの空間上に移送することが **（ベイズ）推論** である．

ベイズ回帰分析とは，尤度を $P_{\theta}(x,dy)P_\varphi(dx)$ と分解された形で与える場合のベイズモデリングに過ぎない．換言すれば，$Y|X$ の依存構造に焦点がある際に行うベイズ推論である．

$\Theta\indep\Phi$ の仮定を置いていることが特徴であるが，$(X,Y)$ の結合分布の想定が簡単になる点が，ここまで人口に膾炙している理由であると思われる．

### ベイズ回帰分析ワークフロー

1. $(X,Y)$ の依存構造が単純（線型）になるような変数変換を行う．
2. $(\Theta,\Phi)$ の事前分布を設定する．
3. 事後分布を計算し，事後予測分布を見てデータが再現できているかを基にモデルを検証する．

その後，十分に階層化をして，パラメータの空間上の事前分布がほとんど情報を持たなくて良いようにする，完全ベイズ推論が一つの悲願とされる．

モデルの挙動がもはや事前分布に依存しなくなった際，モデルの階層構造や尤度の構造が十分にデータを反映できていると思われるためである．^[一方で多くの頻度論的な手法は，無情報事前分布を仮定したベイズ推論とみなせる．そこでベイズの，有効な頻度論的モデルを探索するための方法としての美点が見えてくるのである．]

> 推定すべきものはモデルの尤度であってパラメターの値ではないというのが赤池氏の主張です．いいかえると，推定すべきは確率構造であってパラメターではないというのです．[@田邉國士2010]

この階層化と尤度の推定を探索的に実行できる点がベイズの真の美点だと筆者は考える．そして一度モデルの構造・尤度が明瞭化された際は，もはやベイズである必要はない場合が多い．^[この点については [@Gelman2014] も参照．大統領選における有権者の行動のモデリングを，ベイズ階層モデルに基づいて探索的に実行しており，"multilevel Bayesian modeling can be considered as an elaborate form of exploratory data analysis" と結論している．]

## 階層モデル

### はじめに

階層モデルは複雑なモデルを構築するための強力なツールであり，ベイズのワークフローにおいて基本的な要素になる．

層別抽出やクラスター抽出をはじめとして，多くの場合階層別に知識が存在し，これらを系統的に組み込んだ形でモデルを構築できる．