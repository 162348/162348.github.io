<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="司馬 博文">

<title>ベイズ階層多ハザードモデル – Hirofumi Shiba</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../assets/profile.jpg" rel="icon" type="image/jpeg">
<script src="../../../site_libs/quarto-listing/list.min.js"></script>
<script src="../../../site_libs/quarto-listing/quarto-listing.js"></script>
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-cf7929f4d66a2bdccc4ecf0c4d40c672.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-62adebfec53d4c95a7ec1fcfb398e1f1.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "?",
    "H"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>

  window.document.addEventListener("DOMContentLoaded", function (_event) {
    const listingTargetEl = window.document.querySelector('#listing-lst-zigzag .list');
    if (!listingTargetEl) {
      // No listing discovered, do not attach.
      return; 
    }

    const options = {
      valueNames: ['listing-title','listing-image','listing-date','listing-subtitle',{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
      
      searchColumns: ["listing-title","listing-author","listing-date","listing-image","listing-description"],
    };

    window['quarto-listings'] = window['quarto-listings'] || {};
    window['quarto-listings']['listing-lst-zigzag'] = new List('listing-lst-zigzag', options);

    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  });

  window.addEventListener('hashchange',() => {
    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  })
  

  window.document.addEventListener("DOMContentLoaded", function (_event) {
    const listingTargetEl = window.document.querySelector('#listing-lst-listing .list');
    if (!listingTargetEl) {
      // No listing discovered, do not attach.
      return; 
    }

    const options = {
      valueNames: ['listing-title','listing-image','listing-subtitle',{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
      
      searchColumns: ["listing-title","listing-author","listing-date","listing-image","listing-description"],
    };

    window['quarto-listings'] = window['quarto-listings'] || {};
    window['quarto-listings']['listing-lst-listing'] = new List('listing-lst-listing', options);

    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  });

  window.addEventListener('hashchange',() => {
    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  })
  </script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-36GX2G6GLL"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-36GX2G6GLL', { 'anonymize_ip': true});
</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Zen+Kurenaido&amp;display=swap" rel="stylesheet">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=BIZ+UDPGothic&amp;display=swap" rel="stylesheet">

<style>
  .navbar-title, .menu-text {
      font-family: "Zen Kurenaido", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
  h1, .title, .description, .subtitle {
    font-family: "Zen Kurenaido", sans-serif !important;
  }
</style>

<!-- <style>
  .menu-text {
      font-family: "Gill Sans", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
  .navbar-title {
      font-family: "Gill Sans", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
</style> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../assets/styles.css">
<meta property="og:title" content="ベイズ階層多ハザードモデル – Hirofumi Shiba">
<meta property="og:description" content="医療技術評価における生存解析では，打ち切りデータを最もよく外挿できるハザードモデルが探索される． そこでモデルの選択が重要な課題になるが，ベイズの方法だとモデル平均というアイデアが使える． これを polyhazard model で実行するためのベイズ階層モデルとモデル平均法を紹介する． キーとなる記述は Zig-Zag サンプラーである．">
<meta property="og:image" content="https://162348.github.io/posts/2024/TransDimensionalModels/Images/Polyhazard.png">
<meta property="og:site_name" content="Hirofumi Shiba">
<meta property="og:image:height" content="1096">
<meta property="og:image:width" content="1510">
<meta name="twitter:title" content="ベイズ階層多ハザードモデル – Hirofumi Shiba">
<meta name="twitter:description" content="医療技術評価における生存解析では，打ち切りデータを最もよく外挿できるハザードモデルが探索される． そこでモデルの選択が重要な課題になるが，ベイズの方法だとモデル平均というアイデアが使える． これを polyhazard model で実行するためのベイズ階層モデルとモデル平均法を紹介する． キーとなる記述は Zig-Zag サンプラーである．">
<meta name="twitter:image" content="https://162348.github.io/posts/2024/TransDimensionalModels/Images/Polyhazard.png">
<meta name="twitter:creator" content="@ano2math5">
<meta name="twitter:image-height" content="1096">
<meta name="twitter:image-width" content="1510">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Hirofumi Shiba</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../static/English.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Sessions.html"> 
<span class="menu-text">Sessions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../blog.html"> 
<span class="menu-text">ブログ</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Japanese.html"> 
<span class="menu-text">自己紹介</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/162348/162348.github.io/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">ベイズ階層多ハザードモデル</h1>
            <p class="subtitle lead">Zig-Zag サンプラーによるモデル平均法</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Bayesian</div>
                <div class="quarto-category">MCMC</div>
                <div class="quarto-category">Statistics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>司馬 博文 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">9/12/2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">10/07/2024</p>
      </div>
    </div>
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="block-title">概要</div>
      <p>医療技術評価における生存解析では，打ち切りデータを最もよく外挿できるハザードモデルが探索される． そこでモデルの選択が重要な課題になるが，ベイズの方法だとモデル平均というアイデアが使える． これを polyhazard model で実行するためのベイズ階層モデルとモデル平均法を紹介する． キーとなる記述は Zig-Zag サンプラーである．</p>
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目次</h2>
   
  <ul>
  <li><a href="#ベイズ階層多ハザードモデル" id="toc-ベイズ階層多ハザードモデル" class="nav-link active" data-scroll-target="#ベイズ階層多ハザードモデル"><span class="header-section-number">1</span> ベイズ階層多ハザードモデル</a>
  <ul class="collapse">
  <li><a href="#sec-polyhazard-model" id="toc-sec-polyhazard-model" class="nav-link" data-scroll-target="#sec-polyhazard-model"><span class="header-section-number">1.1</span> 多ハザードモデルの表現力</a></li>
  <li><a href="#ベイズ階層多ハザードモデル-1" id="toc-ベイズ階層多ハザードモデル-1" class="nav-link" data-scroll-target="#ベイズ階層多ハザードモデル-1"><span class="header-section-number">1.2</span> ベイズ階層多ハザードモデル</a></li>
  </ul></li>
  <li><a href="#pdmp-によるベイズ競合リスク分析" id="toc-pdmp-によるベイズ競合リスク分析" class="nav-link" data-scroll-target="#pdmp-によるベイズ競合リスク分析"><span class="header-section-number">2</span> PDMP によるベイズ競合リスク分析</a>
  <ul class="collapse">
  <li><a href="#はじめに" id="toc-はじめに" class="nav-link" data-scroll-target="#はじめに"><span class="header-section-number">2.1</span> はじめに</a></li>
  <li><a href="#sec-theta" id="toc-sec-theta" class="nav-link" data-scroll-target="#sec-theta"><span class="header-section-number">2.2</span> <span class="math inline">\(\theta\)</span> の Zig-Zag サンプリング</a></li>
  <li><a href="#ハイパーパラメータ-phi-のサンプリング" id="toc-ハイパーパラメータ-phi-のサンプリング" class="nav-link" data-scroll-target="#ハイパーパラメータ-phi-のサンプリング"><span class="header-section-number">2.3</span> ハイパーパラメータ <span class="math inline">\(\phi\)</span> のサンプリング</a></li>
  <li><a href="#変数選択-gamma-のサンプリング" id="toc-変数選択-gamma-のサンプリング" class="nav-link" data-scroll-target="#変数選択-gamma-のサンプリング"><span class="header-section-number">2.4</span> 変数選択 <span class="math inline">\(\gamma\)</span> のサンプリング</a></li>
  <li><a href="#kd-のサンプリング" id="toc-kd-のサンプリング" class="nav-link" data-scroll-target="#kd-のサンプリング"><span class="header-section-number">2.5</span> <span class="math inline">\(K,D\)</span> のサンプリング</a></li>
  </ul></li>
  
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="前稿" class="level2 unlisted unnumbered">
<h2 class="unlisted unnumbered anchored" data-anchor-id="前稿">前稿</h2>
<div id="listing-lst-listing" class="listing quarto-float quarto-figure quarto-figure-left quarto-listing quarto-listing-container-grid anchored">
<div class="list grid quarto-listing-cols-1">
<div class="g-col-1" data-index="0" data-categories="QmF5ZXNpYW4lMkNNQ01DJTJDU3RhdGlzdGljcw==" data-listing-date-sort="1726099200000" data-listing-file-modified-sort="1733731964463" data-listing-date-modified-sort="1728259200000" data-listing-reading-time-sort="2" data-listing-word-count-sort="391">
<a href="../../../posts/2024/TransDimensionalModels/SurvivalAnalysis.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-center">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/TransDimensionalModels/Images/Polyhazard.png" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
ベイズ生存時間解析
</h5>
<div class="card-subtitle listing-subtitle">
生存曲線のベイズ階層モデルによる外挿
</div>
</div>
</div>
</a>
</div>
</div>
<div class="listing-no-matching d-none">
No matching items
</div>
</div>
<p>Zig-Zag サンプラーについては次の記事も参照：</p>
<div id="listing-lst-zigzag" class="listing quarto-float quarto-figure quarto-figure-left quarto-listing quarto-listing-container-grid anchored">
<div class="list grid quarto-listing-cols-3">
<div class="g-col-1" data-index="0" data-categories="UHJvY2VzcyUyQ1NhbXBsaW5nJTJDSnVsaWElMkNNQ01D" data-listing-date-sort="1719964800000" data-listing-file-modified-sort="1733731963355" data-listing-date-modified-sort="1721260800000" data-listing-reading-time-sort="13" data-listing-word-count-sort="2593">
<a href="../../../posts/2024/Process/ZigZag.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top"><img src="../Process/ZigZag2D_Gaussian.svg" style="height: 150px;"  class="thumbnail-image card-img"/></p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
Zig-Zag 過程によるサンプリング
</h5>
<div class="card-subtitle listing-subtitle">
ジャンプと確定的な動きによる新たな MCMC 手法
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-07-03
</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="1" data-categories="TUNNQyUyQ0NvbXB1dGF0aW9uJTJDSnVsaWElMkNTYW1wbGluZw==" data-listing-date-sort="1721260800000" data-listing-file-modified-sort="1733731964395" data-listing-date-modified-sort="1724889600000" data-listing-reading-time-sort="14" data-listing-word-count-sort="2629">
<a href="../../../posts/2024/Stat/ZigZagSubsampling.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/Stat/MeanOfGaussian.svg" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
Zig-Zag サンプラーのサブサンプリングによるスケーラビリティ
</h5>
<div class="card-subtitle listing-subtitle">
大規模モデル・大規模データに対する MCMC を目指して
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-07-18
</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="2" data-categories="UHJvY2VzcyUyQ1NhbXBsaW5nJTJDUg==" data-listing-date-sort="1706659200000" data-listing-file-modified-sort="1733731963351" data-listing-date-modified-sort="1719878400000" data-listing-reading-time-sort="7" data-listing-word-count-sort="1230">
<a href="../../../posts/2024/Process/PureJump.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/Process/PureJump_files/figure-html/unnamed-chunk-1-1.png" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
純粋跳躍過程の生成作用素と区分的確定的 Markov 過程
</h5>
<div class="card-subtitle listing-subtitle">
ジャンプと確定的な動きによる新たな MCMC 手法
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-01-31
</div>
</div>
</div>
</div>
</a>
</div>
</div>
<div class="listing-no-matching d-none">
No matching items
</div>
</div>
<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
<p>$$</p>
<p>$$</p>
</div>
</section>
<section id="ベイズ階層多ハザードモデル" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="ベイズ階層多ハザードモデル"><span class="header-section-number">1</span> ベイズ階層多ハザードモデル</h2>
<section id="sec-polyhazard-model" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="sec-polyhazard-model"><span class="header-section-number">1.1</span> 多ハザードモデルの表現力</h3>
<p>Polyhazard model もハザード関数をモデリングするが， <span class="math display">\[
h_Y(y)=\sum_{j=1}^Kh_j(y)
\]</span> という形でモデリングし，個々の <span class="math inline">\(h_j\)</span> にパラメトリックな仮定をおく．</p>
<p>仮に <span class="math inline">\(h_j\)</span> として，形状母数 <span class="math inline">\(\nu&gt;0\)</span> と位置母数 <span class="math inline">\(\mu:=\alpha^{-\nu}&gt;0\)</span> を持つ Weibull 分布 <span class="math inline">\(\mathrm{W}(\nu,\mu)\)</span> のハザード関数 <span class="math display">\[
h_{\mathrm{W}}(y):=\mu\nu y^{\nu-1}
\]</span> と対数ロジスティック分布 <span class="math inline">\(\mathrm{LL}(\nu,\mu)\)</span> のハザード関数 <span class="math display">\[
h_{\mathrm{LL}}(y):=\frac{\left(\frac{\nu}{\mu}\right)\left(\frac{y}{\mu}\right)^{\nu-1}}{1+\left(\frac{y}{\mu}\right)^\nu}
\]</span> の２つのみを考えたとしても，複数のパラメトリックモデルを足し合わせることで驚異的な表現力を達成することができる．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/Polyhazard.png" class="img-fluid figure-img"></p>
<figcaption><span class="citation" data-cites="Hardcastle+2024">(<a href="#ref-Hardcastle+2024" role="doc-biblioref">Hardcastle et al., 2024, p. 5</a>)</span> より．</figcaption>
</figure>
</div>
</section>
<section id="ベイズ階層多ハザードモデル-1" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="ベイズ階層多ハザードモデル-1"><span class="header-section-number">1.2</span> ベイズ階層多ハザードモデル</h3>
<p><span class="citation" data-cites="Hardcastle+2024">(<a href="#ref-Hardcastle+2024" role="doc-biblioref">Hardcastle et al., 2024</a>)</span> では <a href="../../../posts/2024/TransDimensionalModels/SurvivalAnalysis.html#sec-HTA">HTA</a> への応用を念頭に，完全なベイズ階層多ハザードモデルの推定を試みている．</p>
<section id="第１階層" class="level4" data-number="1.2.1">
<h4 data-number="1.2.1" class="anchored" data-anchor-id="第１階層"><span class="header-section-number">1.2.1</span> 第１階層</h4>
<p>各個別要因 <span class="math inline">\(k\in[K]\)</span> の形状母数 <span class="math inline">\(\nu_k\)</span> と位置母数 <span class="math inline">\(\mu_k\)</span> に階層構造 <span id="eq-nu"><span class="math display">\[
\log(\nu_k)=\alpha_k\sim\mathrm{N}(0,\sigma_\alpha^2)
\tag{1}\]</span></span> <span id="eq-mu"><span class="math display">\[
\log(\mu_k)=\beta_{k,0}+\sum_{j\in\left\{j\in[p]\mid\gamma_{kj}=1\right\}}x_j\beta_{k,j},\qquad\beta_{k,0}\sim\mathrm{N}(0,\sigma_{\beta_0}^2)
\tag{2}\]</span></span> を考える．ただし，<span class="math inline">\(\gamma_{k,j}\in2\)</span> は共変量 <span class="math inline">\(x_j\)</span> が <span class="math inline">\(k\in[K]\)</span> 番目の部分モデルに参加するかどうかを決める指示変数とする．</p>
<p>式 (<a href="#eq-mu" class="quarto-xref">2</a>) で残っているパラメータ <span class="math inline">\(\beta_{k,j}\;(j\in[p])\)</span> には <span class="math display">\[
\beta_{k,j}\sim(1-\omega)\delta_0+\omega\operatorname{N}(0,\sigma_\beta^2)
\]</span> と spike-and-slab 事前分布 <span class="citation" data-cites="Mitchell-Beauchamp1988">(<a href="#ref-Mitchell-Beauchamp1988" role="doc-biblioref">Mitchell and Beauchamp, 1988</a>)</span> を仮定し，変数選択を促進する．選択された変数については <span class="math inline">\(\gamma_{k,j}=1\)</span> とする．</p>
<p>以降，<span class="math inline">\(\theta_k=(\nu_k,\mu_k)\)</span> とし，<span class="math inline">\((K,\gamma,\theta)\)</span> を本モデルのパラメータと理解する（<span class="math inline">\(K\)</span> の事前分布は後述 <a href="#sec-prior-of-PX" class="quarto-xref">1.2.3</a>）．</p>
</section>
<section id="第２階層" class="level4" data-number="1.2.2">
<h4 data-number="1.2.2" class="anchored" data-anchor-id="第２階層"><span class="header-section-number">1.2.2</span> 第２階層</h4>
<p><span class="math inline">\(\sigma_\alpha^2=2,\sigma_{\beta_0}^2=5\)</span> は固定してしまうと，<span class="math inline">\(\phi:=(\omega,\sigma_\beta)\)</span> がハイパーパラメータとして残っている．これには <span class="math display">\[
\omega\sim\operatorname{Beta}(a,b)
\]</span> <span class="math display">\[
\sigma_\beta\sim\operatorname{HalfCauchy}(0,1)
\]</span> という事前分布をおき，<span class="math inline">\(a=b=4\)</span> と固定する．</p>
<p>前者はモデルのサイズについて Beta-二項分布を仮定することに等価である <span class="citation" data-cites="Ley-Steel2009">(3.1 節 <a href="#ref-Ley-Steel2009" role="doc-biblioref">Ley and Steel, 2009</a>)</span>．後者は <span class="citation" data-cites="Gelman2006">(<a href="#ref-Gelman2006" role="doc-biblioref">Gelman, 2006</a>)</span>, <span class="citation" data-cites="Polson-Scott2012">(<a href="#ref-Polson-Scott2012" role="doc-biblioref">Polson and Scott, 2012</a>)</span> の推奨の通りである．</p>
</section>
<section id="sec-prior-of-PX" class="level4" data-number="1.2.3">
<h4 data-number="1.2.3" class="anchored" data-anchor-id="sec-prior-of-PX"><span class="header-section-number">1.2.3</span> <span class="math inline">\(\mathcal{P}(E)\)</span> 上の事前分布</h4>
<p>実はまだ第一階層のパラメータが残っている．ハザードの数 <span class="math inline">\(K\)</span> と <span class="math inline">\(h_k\)</span> の関数形をどうするかである．</p>
<p>ここでは Weibull 分布 <span class="math inline">\(\mathrm{W}(\nu,\mu)\)</span> と対数ロジスティック分布 <span class="math inline">\(\mathrm{LL}(\nu,\mu)\)</span> の２つ <span class="math display">\[
D=\{\mathrm{W}(\nu,\mu),\mathrm{LL}(\nu,\mu)\}
\]</span> から等確率で <span class="math display">\[
K\sim\mathrm{Pois}_{&gt;0}(\xi)
\]</span> 個選ぶこととする．</p>
<p>ハイパーパラメータ <span class="math inline">\(\xi\)</span> については，<span class="citation" data-cites="Hardcastle+2024">(<a href="#ref-Hardcastle+2024" role="doc-biblioref">Hardcastle et al., 2024</a>)</span> では <span class="math inline">\(\xi=2\)</span> としている．その根拠の１つに <span class="math display">\[
\operatorname{P}[K\ge5]\approx0.061
\]</span> を満たす性質が，実際の応用で５つ以上の競合リスクが存在する場面は稀であることに整合することを挙げている：</p>
<div id="7b1386ea" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display" data-execution_count="2">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewbox="0 0 2400 1600">
<defs>
  <clippath id="clip840">
    <rect x="0" y="0" width="2400" height="1600"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip840)" d="M0 1600 L2400 1600 L2400 8.88178e-14 L0 8.88178e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip841">
    <rect x="480" y="0" width="1681" height="1600"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip840)" d="M219.38 1423.18 L2352.76 1423.18 L2352.76 123.472 L219.38 123.472  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip842">
    <rect x="219" y="123" width="2134" height="1301"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="531.336,1423.18 531.336,123.472 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1034.49,1423.18 1034.49,123.472 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1537.65,1423.18 1537.65,123.472 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2040.8,1423.18 2040.8,123.472 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="219.38,1386.4 2352.76,1386.4 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="219.38,994.702 2352.76,994.702 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="219.38,603.008 2352.76,603.008 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="219.38,211.315 2352.76,211.315 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="219.38,1423.18 2352.76,1423.18 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="531.336,1423.18 531.336,1404.28 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1034.49,1423.18 1034.49,1404.28 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1537.65,1423.18 1537.65,1404.28 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2040.8,1423.18 2040.8,1404.28 "></polyline>
<path clip-path="url(#clip840)" d="M525.989 1481.64 L542.308 1481.64 L542.308 1485.58 L520.364 1485.58 L520.364 1481.64 Q523.026 1478.89 527.609 1474.26 Q532.216 1469.61 533.396 1468.27 Q535.642 1465.74 536.521 1464.01 Q537.424 1462.25 537.424 1460.56 Q537.424 1457.8 535.48 1456.07 Q533.558 1454.33 530.456 1454.33 Q528.257 1454.33 525.804 1455.09 Q523.373 1455.86 520.595 1457.41 L520.595 1452.69 Q523.419 1451.55 525.873 1450.97 Q528.327 1450.39 530.364 1450.39 Q535.734 1450.39 538.929 1453.08 Q542.123 1455.77 542.123 1460.26 Q542.123 1462.39 541.313 1464.31 Q540.526 1466.2 538.419 1468.8 Q537.841 1469.47 534.739 1472.69 Q531.637 1475.88 525.989 1481.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1037.5 1455.09 L1025.69 1473.54 L1037.5 1473.54 L1037.5 1455.09 M1036.27 1451.02 L1042.15 1451.02 L1042.15 1473.54 L1047.08 1473.54 L1047.08 1477.43 L1042.15 1477.43 L1042.15 1485.58 L1037.5 1485.58 L1037.5 1477.43 L1021.9 1477.43 L1021.9 1472.92 L1036.27 1451.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1538.05 1466.44 Q1534.9 1466.44 1533.05 1468.59 Q1531.22 1470.74 1531.22 1474.49 Q1531.22 1478.22 1533.05 1480.39 Q1534.9 1482.55 1538.05 1482.55 Q1541.2 1482.55 1543.03 1480.39 Q1544.88 1478.22 1544.88 1474.49 Q1544.88 1470.74 1543.03 1468.59 Q1541.2 1466.44 1538.05 1466.44 M1547.33 1451.78 L1547.33 1456.04 Q1545.57 1455.21 1543.77 1454.77 Q1541.99 1454.33 1540.23 1454.33 Q1535.6 1454.33 1533.14 1457.45 Q1530.71 1460.58 1530.37 1466.9 Q1531.73 1464.89 1533.79 1463.82 Q1535.85 1462.73 1538.33 1462.73 Q1543.54 1462.73 1546.55 1465.9 Q1549.58 1469.05 1549.58 1474.49 Q1549.58 1479.82 1546.43 1483.03 Q1543.28 1486.25 1538.05 1486.25 Q1532.06 1486.25 1528.88 1481.67 Q1525.71 1477.06 1525.71 1468.33 Q1525.71 1460.14 1529.6 1455.28 Q1533.49 1450.39 1540.04 1450.39 Q1541.8 1450.39 1543.58 1450.74 Q1545.39 1451.09 1547.33 1451.78 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M2040.8 1469.17 Q2037.47 1469.17 2035.55 1470.95 Q2033.65 1472.73 2033.65 1475.86 Q2033.65 1478.98 2035.55 1480.77 Q2037.47 1482.55 2040.8 1482.55 Q2044.13 1482.55 2046.05 1480.77 Q2047.98 1478.96 2047.98 1475.86 Q2047.98 1472.73 2046.05 1470.95 Q2044.16 1469.17 2040.8 1469.17 M2036.12 1467.18 Q2033.11 1466.44 2031.43 1464.38 Q2029.76 1462.32 2029.76 1459.35 Q2029.76 1455.21 2032.7 1452.8 Q2035.66 1450.39 2040.8 1450.39 Q2045.96 1450.39 2048.9 1452.8 Q2051.84 1455.21 2051.84 1459.35 Q2051.84 1462.32 2050.15 1464.38 Q2048.49 1466.44 2045.5 1467.18 Q2048.88 1467.96 2050.75 1470.26 Q2052.65 1472.55 2052.65 1475.86 Q2052.65 1480.88 2049.57 1483.57 Q2046.52 1486.25 2040.8 1486.25 Q2035.08 1486.25 2032 1483.57 Q2028.95 1480.88 2028.95 1475.86 Q2028.95 1472.55 2030.85 1470.26 Q2032.74 1467.96 2036.12 1467.18 M2034.41 1459.79 Q2034.41 1462.48 2036.08 1463.98 Q2037.77 1465.49 2040.8 1465.49 Q2043.81 1465.49 2045.5 1463.98 Q2047.21 1462.48 2047.21 1459.79 Q2047.21 1457.11 2045.5 1455.6 Q2043.81 1454.1 2040.8 1454.1 Q2037.77 1454.1 2036.08 1455.6 Q2034.41 1457.11 2034.41 1459.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1314.48 1517.53 Q1314.48 1517.95 1314.39 1518.24 Q1314.29 1518.5 1314.06 1518.62 Q1313.84 1518.75 1313.71 1518.79 Q1313.58 1518.82 1313.29 1518.85 Q1311.91 1518.98 1310.94 1519.2 Q1310.01 1519.43 1307.69 1520.59 Q1305.4 1521.75 1302.53 1523.84 L1291 1532.76 L1289.07 1534.28 Q1289.07 1534.37 1289.14 1534.57 Q1289.2 1534.73 1289.27 1534.95 Q1289.36 1535.15 1289.39 1535.21 L1298.77 1556.82 Q1299.51 1558.56 1300.41 1559.17 Q1301.31 1559.78 1303.34 1559.82 Q1303.66 1559.82 1303.79 1559.85 Q1303.95 1559.85 1304.18 1559.91 Q1304.43 1559.94 1304.53 1560.11 Q1304.66 1560.27 1304.66 1560.52 Q1304.66 1561.84 1303.47 1561.84 Q1302.73 1561.84 1300.22 1561.75 Q1297.7 1561.65 1297 1561.65 Q1295.67 1561.65 1292.97 1561.75 Q1290.26 1561.84 1288.94 1561.84 Q1288.01 1561.84 1288.01 1561.1 Q1288.01 1560.49 1288.24 1560.2 Q1288.49 1559.88 1288.72 1559.85 Q1288.94 1559.82 1289.46 1559.82 Q1289.85 1559.82 1290.26 1559.78 Q1290.72 1559.72 1291.36 1559.56 Q1292.04 1559.36 1292.45 1558.91 Q1292.91 1558.43 1292.91 1557.75 Q1292.91 1557.21 1292.1 1555.44 L1284.47 1537.69 L1274.64 1545.35 L1272 1555.73 Q1271.94 1556.11 1271.78 1556.79 Q1271.62 1557.46 1271.49 1557.95 Q1271.39 1558.43 1271.39 1558.62 Q1271.39 1559.04 1271.65 1559.3 Q1271.94 1559.56 1272.65 1559.69 Q1273.36 1559.78 1273.9 1559.82 Q1274.48 1559.82 1275.67 1559.82 Q1277.16 1559.82 1277.41 1560.07 Q1277.54 1560.23 1277.54 1560.52 Q1277.54 1560.97 1277.41 1561.3 Q1277.29 1561.59 1277.03 1561.68 Q1276.8 1561.78 1276.64 1561.81 Q1276.48 1561.84 1276.22 1561.84 Q1275.55 1561.84 1274.1 1561.78 Q1272.68 1561.72 1271.94 1561.72 L1267.72 1561.65 L1259.35 1561.84 Q1258.35 1561.84 1258.35 1561.04 Q1258.35 1560.43 1258.61 1560.17 Q1258.86 1559.88 1259.15 1559.85 Q1259.44 1559.82 1260.18 1559.82 Q1261.79 1559.82 1262.76 1559.72 Q1263.73 1559.62 1264.34 1559.49 Q1264.98 1559.33 1265.3 1558.88 Q1265.66 1558.43 1265.82 1558.04 Q1265.98 1557.63 1266.21 1556.69 L1275.03 1521.26 Q1275.29 1520.2 1275.29 1520.04 Q1275.29 1519.49 1274.97 1519.3 Q1274.68 1519.07 1273.84 1518.98 Q1272.23 1518.85 1271.01 1518.85 Q1270.2 1518.85 1269.88 1518.82 Q1269.59 1518.79 1269.33 1518.62 Q1269.1 1518.43 1269.1 1518.04 Q1269.1 1516.79 1270.43 1516.79 L1278.93 1516.98 L1287.37 1516.79 Q1288.3 1516.79 1288.3 1517.53 Q1288.3 1518.46 1287.85 1518.66 Q1287.43 1518.85 1286.05 1518.85 Q1283.63 1518.85 1282.53 1519.17 Q1281.47 1519.46 1281.15 1519.98 Q1280.86 1520.46 1280.51 1521.88 L1275.22 1543.04 L1300.96 1523.26 Q1303.34 1521.26 1303.34 1520.23 Q1303.34 1519.56 1302.86 1519.27 Q1302.41 1518.95 1301.28 1518.85 Q1300.47 1518.72 1300.47 1518.11 Q1300.47 1517.5 1300.7 1517.21 Q1300.96 1516.88 1301.15 1516.85 Q1301.38 1516.79 1301.73 1516.79 Q1302.92 1516.79 1305.4 1516.88 Q1307.88 1516.98 1309.07 1516.98 Q1309.88 1516.98 1311.46 1516.88 Q1313.03 1516.79 1313.74 1516.79 Q1314.1 1516.79 1314.29 1517.05 Q1314.48 1517.27 1314.48 1517.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="219.38,1423.18 219.38,123.472 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="219.38,1386.4 238.278,1386.4 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="219.38,994.702 238.278,994.702 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="219.38,603.008 238.278,603.008 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="219.38,211.315 238.278,211.315 "></polyline>
<path clip-path="url(#clip840)" d="M126.205 1372.19 Q122.593 1372.19 120.765 1375.76 Q118.959 1379.3 118.959 1386.43 Q118.959 1393.54 120.765 1397.1 Q122.593 1400.64 126.205 1400.64 Q129.839 1400.64 131.644 1397.1 Q133.473 1393.54 133.473 1386.43 Q133.473 1379.3 131.644 1375.76 Q129.839 1372.19 126.205 1372.19 M126.205 1368.49 Q132.015 1368.49 135.07 1373.1 Q138.149 1377.68 138.149 1386.43 Q138.149 1395.16 135.07 1399.76 Q132.015 1404.35 126.205 1404.35 Q120.394 1404.35 117.316 1399.76 Q114.26 1395.16 114.26 1386.43 Q114.26 1377.68 117.316 1373.1 Q120.394 1368.49 126.205 1368.49 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M146.366 1397.8 L151.251 1397.8 L151.251 1403.68 L146.366 1403.68 L146.366 1397.8 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M171.436 1372.19 Q167.825 1372.19 165.996 1375.76 Q164.19 1379.3 164.19 1386.43 Q164.19 1393.54 165.996 1397.1 Q167.825 1400.64 171.436 1400.64 Q175.07 1400.64 176.876 1397.1 Q178.704 1393.54 178.704 1386.43 Q178.704 1379.3 176.876 1375.76 Q175.07 1372.19 171.436 1372.19 M171.436 1368.49 Q177.246 1368.49 180.301 1373.1 Q183.38 1377.68 183.38 1386.43 Q183.38 1395.16 180.301 1399.76 Q177.246 1404.35 171.436 1404.35 Q165.626 1404.35 162.547 1399.76 Q159.491 1395.16 159.491 1386.43 Q159.491 1377.68 162.547 1373.1 Q165.626 1368.49 171.436 1368.49 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M127.431 980.501 Q123.82 980.501 121.992 984.065 Q120.186 987.607 120.186 994.737 Q120.186 1001.84 121.992 1005.41 Q123.82 1008.95 127.431 1008.95 Q131.066 1008.95 132.871 1005.41 Q134.7 1001.84 134.7 994.737 Q134.7 987.607 132.871 984.065 Q131.066 980.501 127.431 980.501 M127.431 976.797 Q133.242 976.797 136.297 981.403 Q139.376 985.987 139.376 994.737 Q139.376 1003.46 136.297 1008.07 Q133.242 1012.65 127.431 1012.65 Q121.621 1012.65 118.543 1008.07 Q115.487 1003.46 115.487 994.737 Q115.487 985.987 118.543 981.403 Q121.621 976.797 127.431 976.797 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M147.593 1006.1 L152.478 1006.1 L152.478 1011.98 L147.593 1011.98 L147.593 1006.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M163.473 1008.05 L171.112 1008.05 L171.112 981.681 L162.802 983.348 L162.802 979.089 L171.065 977.422 L175.741 977.422 L175.741 1008.05 L183.38 1008.05 L183.38 1011.98 L163.473 1011.98 L163.473 1008.05 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M127.802 588.807 Q124.191 588.807 122.362 592.372 Q120.556 595.913 120.556 603.043 Q120.556 610.15 122.362 613.714 Q124.191 617.256 127.802 617.256 Q131.436 617.256 133.242 613.714 Q135.07 610.15 135.07 603.043 Q135.07 595.913 133.242 592.372 Q131.436 588.807 127.802 588.807 M127.802 585.103 Q133.612 585.103 136.667 589.71 Q139.746 594.293 139.746 603.043 Q139.746 611.77 136.667 616.376 Q133.612 620.96 127.802 620.96 Q121.992 620.96 118.913 616.376 Q115.857 611.77 115.857 603.043 Q115.857 594.293 118.913 589.71 Q121.992 585.103 127.802 585.103 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M147.964 614.409 L152.848 614.409 L152.848 620.288 L147.964 620.288 L147.964 614.409 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M167.061 616.353 L183.38 616.353 L183.38 620.288 L161.436 620.288 L161.436 616.353 Q164.098 613.599 168.681 608.969 Q173.288 604.316 174.468 602.974 Q176.714 600.45 177.593 598.714 Q178.496 596.955 178.496 595.265 Q178.496 592.511 176.551 590.775 Q174.63 589.039 171.528 589.039 Q169.329 589.039 166.876 589.802 Q164.445 590.566 161.667 592.117 L161.667 587.395 Q164.491 586.261 166.945 585.682 Q169.399 585.103 171.436 585.103 Q176.806 585.103 180.001 587.789 Q183.195 590.474 183.195 594.964 Q183.195 597.094 182.385 599.015 Q181.598 600.913 179.491 603.506 Q178.913 604.177 175.811 607.395 Q172.709 610.589 167.061 616.353 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M126.853 197.113 Q123.242 197.113 121.413 200.678 Q119.607 204.22 119.607 211.349 Q119.607 218.456 121.413 222.021 Q123.242 225.562 126.853 225.562 Q130.487 225.562 132.292 222.021 Q134.121 218.456 134.121 211.349 Q134.121 204.22 132.292 200.678 Q130.487 197.113 126.853 197.113 M126.853 193.41 Q132.663 193.41 135.718 198.016 Q138.797 202.599 138.797 211.349 Q138.797 220.076 135.718 224.683 Q132.663 229.266 126.853 229.266 Q121.043 229.266 117.964 224.683 Q114.908 220.076 114.908 211.349 Q114.908 202.599 117.964 198.016 Q121.043 193.41 126.853 193.41 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M147.015 222.715 L151.899 222.715 L151.899 228.595 L147.015 228.595 L147.015 222.715 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M176.251 209.961 Q179.607 210.678 181.482 212.947 Q183.38 215.215 183.38 218.548 Q183.38 223.664 179.862 226.465 Q176.343 229.266 169.862 229.266 Q167.686 229.266 165.371 228.826 Q163.079 228.41 160.626 227.553 L160.626 223.039 Q162.57 224.173 164.885 224.752 Q167.2 225.331 169.723 225.331 Q174.121 225.331 176.413 223.595 Q178.727 221.859 178.727 218.548 Q178.727 215.493 176.575 213.78 Q174.445 212.044 170.626 212.044 L166.598 212.044 L166.598 208.201 L170.811 208.201 Q174.26 208.201 176.089 206.836 Q177.917 205.447 177.917 202.854 Q177.917 200.192 176.019 198.78 Q174.144 197.345 170.626 197.345 Q168.704 197.345 166.505 197.762 Q164.306 198.178 161.667 199.058 L161.667 194.891 Q164.329 194.15 166.644 193.78 Q168.982 193.41 171.042 193.41 Q176.366 193.41 179.468 195.84 Q182.57 198.248 182.57 202.368 Q182.57 205.238 180.926 207.229 Q179.283 209.197 176.251 209.961 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M35.1993 826.48 Q31.2526 824.283 29.3747 821.228 Q27.4968 818.172 27.4968 814.035 Q27.4968 808.465 31.4117 805.441 Q35.2948 802.417 42.4881 802.417 L64.0042 802.417 L64.0042 808.306 L42.679 808.306 Q37.5546 808.306 35.072 810.12 Q32.5894 811.934 32.5894 815.658 Q32.5894 820.209 35.6131 822.851 Q38.6368 825.493 43.8567 825.493 L64.0042 825.493 L64.0042 831.381 L42.679 831.381 Q37.5228 831.381 35.072 833.195 Q32.5894 835.01 32.5894 838.797 Q32.5894 843.285 35.6449 845.927 Q38.6686 848.569 43.8567 848.569 L64.0042 848.569 L64.0042 854.457 L28.3562 854.457 L28.3562 848.569 L33.8944 848.569 Q30.616 846.563 29.0564 843.763 Q27.4968 840.962 27.4968 837.11 Q27.4968 833.227 29.4702 830.522 Q31.4436 827.785 35.1993 826.48 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M46.0847 774.535 Q46.0847 781.633 47.7079 784.37 Q49.3312 787.108 53.2461 787.108 Q56.3653 787.108 58.2114 785.071 Q60.0256 783.002 60.0256 779.469 Q60.0256 774.599 56.5881 771.671 Q53.1188 768.711 47.3897 768.711 L46.0847 768.711 L46.0847 774.535 M43.6657 762.854 L64.0042 762.854 L64.0042 768.711 L58.5933 768.711 Q61.8398 770.716 63.3994 773.708 Q64.9272 776.7 64.9272 781.028 Q64.9272 786.503 61.8716 789.75 Q58.7843 792.964 53.6281 792.964 Q47.6125 792.964 44.5569 788.954 Q41.5014 784.912 41.5014 776.923 L41.5014 768.711 L40.9285 768.711 Q36.8862 768.711 34.6901 771.384 Q32.4621 774.026 32.4621 778.832 Q32.4621 781.888 33.1941 784.784 Q33.9262 787.681 35.3903 790.354 L29.9795 790.354 Q28.7381 787.14 28.1334 784.116 Q27.4968 781.092 27.4968 778.228 Q27.4968 770.493 31.5072 766.674 Q35.5176 762.854 43.6657 762.854 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M29.4065 728.066 L34.9447 728.066 Q33.6716 730.548 33.035 733.222 Q32.3984 735.896 32.3984 738.76 Q32.3984 743.121 33.7352 745.317 Q35.072 747.481 37.7456 747.481 Q39.7826 747.481 40.9603 745.922 Q42.1061 744.362 43.1565 739.651 L43.6021 737.646 Q44.9389 731.408 47.3897 728.798 Q49.8086 726.156 54.1691 726.156 Q59.1344 726.156 62.0308 730.103 Q64.9272 734.018 64.9272 740.893 Q64.9272 743.757 64.3543 746.876 Q63.8132 749.964 62.6992 753.401 L56.6518 753.401 Q58.3387 750.155 59.198 747.004 Q60.0256 743.853 60.0256 740.765 Q60.0256 736.628 58.6251 734.4 Q57.1929 732.172 54.6147 732.172 Q52.2276 732.172 50.9545 733.795 Q49.6813 735.386 48.5037 740.829 L48.0262 742.866 Q46.8804 748.309 44.5251 750.728 Q42.138 753.147 38.0002 753.147 Q32.9713 753.147 30.2341 749.582 Q27.4968 746.017 27.4968 739.46 Q27.4968 736.214 27.9743 733.349 Q28.4517 730.485 29.4065 728.066 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M29.4065 694.105 L34.9447 694.105 Q33.6716 696.587 33.035 699.261 Q32.3984 701.935 32.3984 704.799 Q32.3984 709.16 33.7352 711.356 Q35.072 713.52 37.7456 713.52 Q39.7826 713.52 40.9603 711.961 Q42.1061 710.401 43.1565 705.69 L43.6021 703.685 Q44.9389 697.447 47.3897 694.837 Q49.8086 692.195 54.1691 692.195 Q59.1344 692.195 62.0308 696.142 Q64.9272 700.057 64.9272 706.932 Q64.9272 709.796 64.3543 712.915 Q63.8132 716.003 62.6992 719.44 L56.6518 719.44 Q58.3387 716.194 59.198 713.043 Q60.0256 709.892 60.0256 706.804 Q60.0256 702.667 58.6251 700.439 Q57.1929 698.211 54.6147 698.211 Q52.2276 698.211 50.9545 699.834 Q49.6813 701.425 48.5037 706.868 L48.0262 708.905 Q46.8804 714.348 44.5251 716.767 Q42.138 719.186 38.0002 719.186 Q32.9713 719.186 30.2341 715.621 Q27.4968 712.056 27.4968 705.499 Q27.4968 702.253 27.9743 699.388 Q28.4517 696.524 29.4065 694.105 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1094.53 72.6775 L1094.53 70.0951 L1096.54 70.0951 Q1101.09 70.0951 1102.11 69.3573 Q1103.18 68.5785 1103.18 66.1192 L1103.18 21.8918 Q1103.18 19.4734 1102.11 18.7356 Q1101.05 17.9568 1096.54 17.9568 L1094.53 17.9568 L1094.53 15.3335 L1124.16 15.3335 Q1132.65 15.3335 1138.31 20.0062 Q1143.96 24.679 1143.96 30.9504 Q1143.96 37.1808 1138.18 41.6896 Q1132.44 46.1574 1124.82 46.1574 L1110.64 46.1574 L1110.64 66.1192 Q1110.64 68.5376 1111.66 69.3163 Q1112.73 70.0951 1117.28 70.0951 L1119.29 70.0951 L1119.29 72.6775 Q1116.34 72.4315 1106.87 72.4315 Q1097.48 72.4315 1094.53 72.6775 M1110.39 43.985 L1121.95 43.985 Q1125.72 43.985 1128.47 42.9193 Q1131.21 41.8535 1132.44 40.5829 Q1133.72 39.2712 1134.41 37.1808 Q1135.15 35.0493 1135.23 33.9016 Q1135.31 32.7129 1135.31 30.9504 Q1135.31 29.1059 1135.23 27.9582 Q1135.15 26.7695 1134.41 24.679 Q1133.72 22.5476 1132.44 21.2769 Q1131.21 19.9653 1128.47 18.9815 Q1125.76 17.9568 1121.95 17.9568 L1114.49 17.9568 Q1111.62 17.9568 1111.01 18.5306 Q1110.39 19.1045 1110.39 21.3179 L1110.39 43.985 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1162.48 68.1686 Q1156.95 62.6761 1156.95 54.7242 Q1156.95 46.7313 1162.36 40.9108 Q1167.81 35.0493 1175.6 35.0493 Q1183.22 35.0493 1188.67 40.8698 Q1194.17 46.6493 1194.17 54.7242 Q1194.17 62.6351 1188.63 68.1277 Q1183.14 73.6202 1175.52 73.6202 Q1168.06 73.6202 1162.48 68.1686 M1163.92 54.0273 Q1163.92 62.1842 1166.05 65.8732 Q1169.33 71.4888 1175.6 71.4888 Q1178.71 71.4888 1181.29 69.8082 Q1183.92 68.1277 1185.35 65.2994 Q1187.2 61.6104 1187.2 54.0273 Q1187.2 45.9525 1184.98 42.3864 Q1181.7 36.9348 1175.52 36.9348 Q1172.81 36.9348 1170.15 38.3694 Q1167.52 39.7631 1165.92 42.5503 Q1163.92 46.2394 1163.92 54.0273 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1196.84 72.6775 L1196.84 70.0951 Q1201.31 70.0951 1202.33 69.5623 Q1203.35 68.9884 1203.35 66.2831 L1203.35 43.698 Q1203.35 40.5829 1202.29 39.8451 Q1201.26 39.1073 1197.17 39.1073 L1197.17 36.4839 L1208.89 35.5822 L1208.89 66.3651 Q1208.89 68.8655 1209.79 69.4803 Q1210.69 70.0951 1214.79 70.0951 L1214.79 72.6775 Q1206.22 72.4315 1206.06 72.4315 Q1204.91 72.4315 1196.84 72.6775 M1200.36 20.949 Q1200.36 19.2684 1201.63 17.9158 Q1202.94 16.5222 1204.79 16.5222 Q1206.63 16.5222 1207.95 17.7928 Q1209.26 19.0225 1209.26 20.99 Q1209.26 22.9165 1207.95 24.1872 Q1206.63 25.4168 1204.79 25.4168 Q1202.86 25.4168 1201.59 24.0642 Q1200.36 22.7115 1200.36 20.949 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1222.21 71.5708 L1222.21 60.5037 Q1222.21 59.5609 1222.25 59.233 Q1222.29 58.9051 1222.54 58.6591 Q1222.78 58.4132 1223.27 58.4132 Q1223.85 58.4132 1224.05 58.6591 Q1224.3 58.9051 1224.46 59.8478 Q1225.73 65.6273 1228.44 68.7015 Q1231.18 71.7347 1236.14 71.7347 Q1240.86 71.7347 1243.23 69.6443 Q1245.61 67.5538 1245.61 64.1107 Q1245.61 57.9623 1236.88 56.4047 Q1231.84 55.38 1229.75 54.7242 Q1227.66 54.0273 1225.81 52.5107 Q1222.21 49.5595 1222.21 45.3786 Q1222.21 41.1977 1225.36 38.1235 Q1228.56 35.0493 1235.61 35.0493 Q1240.32 35.0493 1243.52 37.4267 Q1244.46 36.6889 1244.96 36.074 Q1246.06 35.0493 1246.64 35.0493 Q1247.29 35.0493 1247.42 35.5002 Q1247.54 35.9101 1247.54 37.0988 L1247.54 45.5426 Q1247.54 46.4853 1247.5 46.8132 Q1247.46 47.1411 1247.21 47.3871 Q1246.96 47.592 1246.43 47.592 Q1245.49 47.592 1245.45 46.8132 Q1244.79 36.6479 1235.61 36.6479 Q1230.65 36.6479 1228.44 38.5744 Q1226.22 40.4599 1226.22 43.0422 Q1226.22 44.4768 1226.88 45.5836 Q1227.58 46.6493 1228.44 47.3051 Q1229.34 47.9199 1230.98 48.5348 Q1232.62 49.1086 1233.6 49.3136 Q1234.63 49.5185 1236.55 49.9284 Q1243.28 51.1991 1246.1 53.9454 Q1249.63 57.4704 1249.63 61.9383 Q1249.63 66.898 1246.27 70.2591 Q1242.91 73.6202 1236.14 73.6202 Q1230.69 73.6202 1226.88 69.9722 Q1226.39 70.464 1226.02 70.9149 Q1225.65 71.3248 1225.49 71.4888 Q1225.36 71.6527 1225.32 71.7757 Q1225.28 71.8577 1225.2 71.9397 Q1223.52 73.6202 1223.11 73.6202 Q1222.45 73.6202 1222.33 73.1693 Q1222.21 72.7594 1222.21 71.5708 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1274.63 97.9915 Q1274.63 97.6472 1274.89 97.4463 Q1275.17 97.2742 1276.03 96.8725 L1304.73 83.7026 Q1306.96 82.641 1308.11 82.1819 Q1306.93 81.7228 1304.73 80.6612 L1276.03 67.4914 Q1275.92 67.434 1275.66 67.3192 Q1275.4 67.2044 1275.23 67.1184 Q1275.09 67.0323 1274.94 66.9175 Q1274.8 66.774 1274.71 66.6593 Q1274.63 66.5445 1274.63 66.3723 Q1274.63 65.7985 1275.29 65.7985 Q1275.57 65.7985 1276.75 66.3723 L1309.34 81.2351 Q1309.4 81.2351 1309.55 81.3211 Q1309.72 81.4072 1309.83 81.522 Q1309.95 81.6081 1310.06 81.6941 Q1310.18 81.7802 1310.23 81.895 Q1310.29 82.0098 1310.29 82.1819 Q1310.23 82.6984 1308.6 83.4731 L1276.75 97.9915 Q1275.57 98.5653 1275.29 98.5653 Q1274.63 98.5653 1274.63 97.9915 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1336.2 78.0789 Q1336.2 69.4424 1338.38 64.7369 Q1341.42 57.7359 1348.59 57.7359 Q1350.11 57.7359 1351.69 58.1663 Q1353.3 58.568 1355.31 60.1461 Q1357.35 61.7242 1358.58 64.3065 Q1360.93 69.299 1360.93 78.0789 Q1360.93 86.6579 1358.75 91.3348 Q1355.57 98.1636 1348.54 98.1636 Q1345.9 98.1636 1343.2 96.8151 Q1340.53 95.4665 1338.84 92.2243 Q1336.2 87.3753 1336.2 78.0789 M1341.08 77.3616 Q1341.08 86.2276 1341.71 89.7567 Q1342.43 93.5728 1344.38 95.237 Q1346.36 96.8725 1348.54 96.8725 Q1350.89 96.8725 1352.84 95.1222 Q1354.82 93.3433 1355.42 89.5272 Q1356.08 85.7685 1356.05 77.3616 Q1356.05 69.1842 1355.48 65.9133 Q1354.71 62.0972 1352.64 60.5765 Q1350.6 59.0271 1348.54 59.0271 Q1347.76 59.0271 1346.93 59.2566 Q1346.13 59.4861 1344.95 60.1461 Q1343.77 60.806 1342.86 62.4415 Q1341.97 64.0769 1341.54 66.5445 Q1341.08 69.7294 1341.08 77.3616 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1374.26 51.691 Q1374.26 37.5087 1379.55 26.0727 Q1381.8 21.2769 1384.96 17.26 Q1388.11 13.243 1390.2 11.4805 Q1392.29 9.71794 1392.87 9.71794 Q1393.69 9.71794 1393.73 10.5377 Q1393.73 10.9476 1392.62 11.9723 Q1379.09 25.7447 1379.14 51.691 Q1379.14 77.7191 1392.29 90.9587 Q1393.73 92.3933 1393.73 92.8442 Q1393.73 93.664 1392.87 93.664 Q1392.29 93.664 1390.28 91.9834 Q1388.28 90.3029 1385.16 86.4499 Q1382.05 82.5969 1379.79 77.8831 Q1374.26 66.4471 1374.26 51.691 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1401.79 72.6775 Q1401.79 71.1609 1401.91 70.71 Q1402.07 70.2591 1402.73 69.5623 L1418.84 51.609 Q1427.65 41.6896 1427.65 33.0408 Q1427.65 27.4253 1424.7 23.4084 Q1421.79 19.3914 1416.42 19.3914 Q1412.73 19.3914 1409.62 21.6458 Q1406.5 23.9002 1405.07 27.9172 Q1405.31 27.8352 1406.17 27.8352 Q1408.26 27.8352 1409.41 29.1469 Q1410.6 30.4585 1410.6 32.2211 Q1410.6 34.4755 1409.12 35.5822 Q1407.69 36.6479 1406.26 36.6479 Q1405.68 36.6479 1404.9 36.5249 Q1404.16 36.402 1402.98 35.2543 Q1401.79 34.0656 1401.79 31.9751 Q1401.79 26.1136 1406.21 21.4409 Q1410.68 16.7681 1417.49 16.7681 Q1425.19 16.7681 1430.23 21.3589 Q1435.32 25.9087 1435.32 33.0408 Q1435.32 35.5412 1434.54 37.8366 Q1433.8 40.091 1432.78 41.8535 Q1431.79 43.6161 1429.09 46.4443 Q1426.38 49.2726 1424.21 51.2811 Q1422.04 53.2895 1417.16 57.5524 L1408.26 66.2012 L1423.39 66.2012 Q1430.77 66.2012 1431.34 65.5453 Q1432.16 64.3566 1433.18 58.0853 L1435.32 58.0853 L1432.94 72.6775 L1401.79 72.6775 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1445.37 92.8442 Q1445.37 92.4343 1446.44 91.4096 Q1459.97 77.6372 1459.97 51.691 Q1459.97 25.6628 1446.97 12.5052 Q1445.37 10.9886 1445.37 10.5377 Q1445.37 9.71794 1446.19 9.71794 Q1446.77 9.71794 1448.78 11.3985 Q1450.83 13.0791 1453.9 16.9321 Q1457.01 20.785 1459.31 25.4988 Q1464.84 36.9348 1464.84 51.691 Q1464.84 65.8732 1459.56 77.3093 Q1457.3 82.105 1454.15 86.122 Q1450.99 90.1389 1448.9 91.9014 Q1446.81 93.664 1446.19 93.664 Q1445.37 93.664 1445.37 92.8442 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><circle clip-path="url(#clip842)" cx="279.759" cy="160.256" r="14.4" fill="#78c2ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"></circle>
<circle clip-path="url(#clip842)" cx="531.336" cy="160.256" r="14.4" fill="#78c2ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"></circle>
<circle clip-path="url(#clip842)" cx="782.913" cy="568.969" r="14.4" fill="#78c2ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"></circle>
<circle clip-path="url(#clip842)" cx="1034.49" cy="977.683" r="14.4" fill="#78c2ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"></circle>
<circle clip-path="url(#clip842)" cx="1286.07" cy="1222.91" r="14.4" fill="#78c2ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"></circle>
<circle clip-path="url(#clip842)" cx="1537.65" cy="1331.9" r="14.4" fill="#78c2ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"></circle>
<circle clip-path="url(#clip842)" cx="1789.22" cy="1370.83" r="14.4" fill="#78c2ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"></circle>
<circle clip-path="url(#clip842)" cx="2040.8" cy="1382.5" r="14.4" fill="#78c2ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"></circle>
<circle clip-path="url(#clip842)" cx="2292.38" cy="1385.53" r="14.4" fill="#78c2ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"></circle>
<polyline clip-path="url(#clip842)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="279.759,1386.4 279.759,160.256 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="531.336,1386.4 531.336,160.256 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="782.913,1386.4 782.913,568.969 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1034.49,1386.4 1034.49,977.683 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1286.07,1386.4 1286.07,1222.91 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1537.65,1386.4 1537.65,1331.9 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1789.22,1386.4 1789.22,1370.83 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="2040.8,1386.4 2040.8,1382.5 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="2292.38,1386.4 2292.38,1385.53 "></polyline>
<path clip-path="url(#clip840)" d="M1694.26 270.476 L2281.64 270.476 L2281.64 166.796 L1694.26 166.796  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1694.26,270.476 2281.64,270.476 2281.64,166.796 1694.26,166.796 1694.26,270.476 "></polyline>
<circle clip-path="url(#clip840)" cx="1789.07" cy="218.636" r="20.48" fill="#78c2ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="4.55111"></circle>
<path clip-path="url(#clip840)" d="M1883.89 201.356 L1913.13 201.356 L1913.13 205.291 L1900.86 205.291 L1900.86 235.916 L1896.16 235.916 L1896.16 205.291 L1883.89 205.291 L1883.89 201.356 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1939.01 220.268 L1939.01 235.916 L1934.75 235.916 L1934.75 220.407 Q1934.75 216.726 1933.31 214.897 Q1931.88 213.069 1929.01 213.069 Q1925.56 213.069 1923.57 215.268 Q1921.58 217.467 1921.58 221.263 L1921.58 235.916 L1917.29 235.916 L1917.29 199.897 L1921.58 199.897 L1921.58 214.018 Q1923.1 211.68 1925.16 210.522 Q1927.25 209.365 1929.95 209.365 Q1934.42 209.365 1936.71 212.143 Q1939.01 214.897 1939.01 220.268 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1969.68 221.888 L1969.68 223.971 L1950.09 223.971 Q1950.37 228.369 1952.73 230.684 Q1955.12 232.976 1959.35 232.976 Q1961.81 232.976 1964.1 232.374 Q1966.41 231.772 1968.68 230.569 L1968.68 234.596 Q1966.39 235.568 1963.98 236.078 Q1961.58 236.587 1959.1 236.587 Q1952.89 236.587 1949.26 232.976 Q1945.65 229.365 1945.65 223.207 Q1945.65 216.842 1949.08 213.115 Q1952.52 209.365 1958.36 209.365 Q1963.59 209.365 1966.62 212.745 Q1969.68 216.101 1969.68 221.888 M1965.42 220.638 Q1965.37 217.143 1963.45 215.059 Q1961.55 212.976 1958.4 212.976 Q1954.84 212.976 1952.69 214.99 Q1950.56 217.004 1950.23 220.661 L1965.42 220.638 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1986.71 212.976 Q1983.29 212.976 1981.3 215.661 Q1979.31 218.323 1979.31 222.976 Q1979.31 227.629 1981.27 230.314 Q1983.26 232.976 1986.71 232.976 Q1990.12 232.976 1992.11 230.291 Q1994.1 227.606 1994.1 222.976 Q1994.1 218.37 1992.11 215.684 Q1990.12 212.976 1986.71 212.976 M1986.71 209.365 Q1992.27 209.365 1995.44 212.976 Q1998.61 216.587 1998.61 222.976 Q1998.61 229.342 1995.44 232.976 Q1992.27 236.587 1986.71 236.587 Q1981.14 236.587 1977.96 232.976 Q1974.82 229.342 1974.82 222.976 Q1974.82 216.587 1977.96 212.976 Q1981.14 209.365 1986.71 209.365 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M2020.7 213.971 Q2019.98 213.555 2019.12 213.37 Q2018.29 213.161 2017.27 213.161 Q2013.66 213.161 2011.71 215.522 Q2009.79 217.86 2009.79 222.258 L2009.79 235.916 L2005.51 235.916 L2005.51 209.99 L2009.79 209.99 L2009.79 214.018 Q2011.13 211.657 2013.29 210.522 Q2015.44 209.365 2018.52 209.365 Q2018.96 209.365 2019.49 209.434 Q2020.02 209.481 2020.67 209.596 L2020.7 213.971 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M2046.3 221.888 L2046.3 223.971 L2026.71 223.971 Q2026.99 228.369 2029.35 230.684 Q2031.74 232.976 2035.97 232.976 Q2038.43 232.976 2040.72 232.374 Q2043.03 231.772 2045.3 230.569 L2045.3 234.596 Q2043.01 235.568 2040.6 236.078 Q2038.2 236.587 2035.72 236.587 Q2029.51 236.587 2025.88 232.976 Q2022.27 229.365 2022.27 223.207 Q2022.27 216.842 2025.7 213.115 Q2029.14 209.365 2034.98 209.365 Q2040.21 209.365 2043.24 212.745 Q2046.3 216.101 2046.3 221.888 M2042.04 220.638 Q2041.99 217.143 2040.07 215.059 Q2038.17 212.976 2035.02 212.976 Q2031.46 212.976 2029.31 214.99 Q2027.18 217.004 2026.85 220.661 L2042.04 220.638 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M2057.5 202.629 L2057.5 209.99 L2066.27 209.99 L2066.27 213.3 L2057.5 213.3 L2057.5 227.374 Q2057.5 230.545 2058.36 231.448 Q2059.24 232.351 2061.9 232.351 L2066.27 232.351 L2066.27 235.916 L2061.9 235.916 Q2056.97 235.916 2055.09 234.087 Q2053.22 232.235 2053.22 227.374 L2053.22 213.3 L2050.09 213.3 L2050.09 209.99 L2053.22 209.99 L2053.22 202.629 L2057.5 202.629 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M2071.88 209.99 L2076.13 209.99 L2076.13 235.916 L2071.88 235.916 L2071.88 209.99 M2071.88 199.897 L2076.13 199.897 L2076.13 205.291 L2071.88 205.291 L2071.88 199.897 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M2103.7 210.985 L2103.7 214.967 Q2101.9 213.971 2100.07 213.485 Q2098.26 212.976 2096.41 212.976 Q2092.27 212.976 2089.98 215.615 Q2087.69 218.231 2087.69 222.976 Q2087.69 227.721 2089.98 230.36 Q2092.27 232.976 2096.41 232.976 Q2098.26 232.976 2100.07 232.49 Q2101.9 231.981 2103.7 230.985 L2103.7 234.92 Q2101.92 235.754 2100 236.17 Q2098.1 236.587 2095.95 236.587 Q2090.09 236.587 2086.64 232.906 Q2083.19 229.226 2083.19 222.976 Q2083.19 216.633 2086.67 212.999 Q2090.16 209.365 2096.23 209.365 Q2098.19 209.365 2100.07 209.782 Q2101.94 210.175 2103.7 210.985 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M2122.89 222.883 Q2117.73 222.883 2115.74 224.064 Q2113.75 225.244 2113.75 228.092 Q2113.75 230.36 2115.23 231.703 Q2116.74 233.022 2119.31 233.022 Q2122.85 233.022 2124.98 230.522 Q2127.13 227.999 2127.13 223.832 L2127.13 222.883 L2122.89 222.883 M2131.39 221.124 L2131.39 235.916 L2127.13 235.916 L2127.13 231.981 Q2125.67 234.342 2123.5 235.476 Q2121.32 236.587 2118.17 236.587 Q2114.19 236.587 2111.83 234.365 Q2109.49 232.119 2109.49 228.369 Q2109.49 223.994 2112.41 221.772 Q2115.35 219.55 2121.16 219.55 L2127.13 219.55 L2127.13 219.133 Q2127.13 216.194 2125.19 214.596 Q2123.26 212.976 2119.77 212.976 Q2117.55 212.976 2115.44 213.508 Q2113.33 214.041 2111.39 215.106 L2111.39 211.17 Q2113.73 210.268 2115.93 209.828 Q2118.13 209.365 2120.21 209.365 Q2125.83 209.365 2128.61 212.282 Q2131.39 215.198 2131.39 221.124 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M2140.16 199.897 L2144.42 199.897 L2144.42 235.916 L2140.16 235.916 L2140.16 199.897 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M2173.26 205.198 L2173.26 218.184 L2179.14 218.184 Q2182.41 218.184 2184.19 216.495 Q2185.97 214.805 2185.97 211.68 Q2185.97 208.578 2184.19 206.888 Q2182.41 205.198 2179.14 205.198 L2173.26 205.198 M2168.59 201.356 L2179.14 201.356 Q2184.95 201.356 2187.92 203.995 Q2190.9 206.61 2190.9 211.68 Q2190.9 216.795 2187.92 219.411 Q2184.95 222.027 2179.14 222.027 L2173.26 222.027 L2173.26 235.916 L2168.59 235.916 L2168.59 201.356 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M2197.18 201.356 L2204.14 201.356 L2212.96 224.874 L2221.83 201.356 L2228.8 201.356 L2228.8 235.916 L2224.24 235.916 L2224.24 205.569 L2215.32 229.272 L2210.62 229.272 L2201.71 205.569 L2201.71 235.916 L2197.18 235.916 L2197.18 201.356 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M2238.08 201.356 L2257.94 201.356 L2257.94 205.291 L2242.75 205.291 L2242.75 215.476 L2256.46 215.476 L2256.46 219.411 L2242.75 219.411 L2242.75 235.916 L2238.08 235.916 L2238.08 201.356 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
</section>
</section>
</section>
<section id="pdmp-によるベイズ競合リスク分析" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="pdmp-によるベイズ競合リスク分析"><span class="header-section-number">2</span> PDMP によるベイズ競合リスク分析</h2>
<section id="はじめに" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="はじめに"><span class="header-section-number">2.1</span> はじめに</h3>
<p>前節で定義されたモデルのパラメータ空間 <span class="math display">\[
(K,D,\gamma,\phi,\theta)
\]</span> 上での事後分布サンプリングを行うことを考える．<span class="math inline">\(\phi=(\omega,\sigma_\beta)\)</span> はハイパーパラメータである．</p>
<p>基本的には <span class="math inline">\(\theta=(\theta_k)=(\nu_k,\mu_k)\)</span> の事後分布サンプリングを考えるのであるが，<span class="math inline">\(K,\gamma\)</span> の如何によって <span class="math inline">\(\theta\)</span> の次元が変化する．</p>
<p>加えて <span class="math inline">\(D\)</span> の如何によって尤度が変化するから，Poisson 点過程の強度関数に解析的な上界が見つかるはずもないため，Automatic Zig-Zag <span class="citation" data-cites="Corbella+2022">(<a href="#ref-Corbella+2022" role="doc-biblioref">Corbella et al., 2022</a>)</span> と Concave-Convex PDMP <span class="citation" data-cites="Sutton-Fearnhead2023">(<a href="#ref-Sutton-Fearnhead2023" role="doc-biblioref">Sutton and Fearnhead, 2023</a>)</span> を組み合わせて用いる．</p>
</section>
<section id="sec-theta" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="sec-theta"><span class="header-section-number">2.2</span> <span class="math inline">\(\theta\)</span> の Zig-Zag サンプリング</h3>
<p>polyhazard model の標準的なサンプラーには Gibbs サンプラーや NUTS サンプラーがあり得るが，いずれも複数の次元の間を飛び回れるように拡張するには，空間の間の跳躍をうまく設計する必要がある．</p>
<p>この点で Zig-Zag サンプラーは従来のサンプリング法と対等であるが，今回の設定には多峰性の懸念も存在する．</p>
<p>というのも，<span class="math inline">\(D\)</span> によって指定される分布は互いに交換可能であるため，混合モデリングにおける label switching problem <span class="citation" data-cites="Jasra+2005">(<a href="#ref-Jasra+2005" role="doc-biblioref">Jasra et al., 2005</a>)</span> 同様に事後分布は必然的に多峰性（対称性）を帯びるはずである．</p>
<p>多峰性への対処という点では，Zig-Zag サンプラーに軍配が上がるはずである <span class="citation" data-cites="Andrieu-Livingstone2021">(<a href="#ref-Andrieu-Livingstone2021" role="doc-biblioref">Andrieu and Livingstone, 2021</a>)</span>．</p>
</section>
<section id="ハイパーパラメータ-phi-のサンプリング" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="ハイパーパラメータ-phi-のサンプリング"><span class="header-section-number">2.3</span> ハイパーパラメータ <span class="math inline">\(\phi\)</span> のサンプリング</h3>
<p><span class="math inline">\((\theta,\phi)\)</span> 上から結合分布を Zig-Zag サンプリングすることも可能であるが，<span class="math inline">\(\theta\)</span> は <span class="math inline">\(\phi\)</span> に依存するため，事後分布は強い相関構造を持つと予想される．</p>
<p>一方でこの条件付き構造は Gibbs サンプラーの発想で有効に利用したいものである．これには Zig-Zag within Gibbs <span class="citation" data-cites="Sachs+2023">(<a href="#ref-Sachs+2023" role="doc-biblioref">Sachs et al., 2023</a>)</span> を用いることができる．</p>
<p>この方法によれば，ハイパーパラメータ <span class="math inline">\(\phi=(\omega,\sigma_\beta)\)</span> を固定した下で他の変数をサンプリングすることになる．この設定では次に論じるように変数選択の指示変数 <span class="math inline">\(\gamma\)</span> に対する効率的なシミュレーション法も導く．</p>
</section>
<section id="変数選択-gamma-のサンプリング" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="変数選択-gamma-のサンプリング"><span class="header-section-number">2.4</span> 変数選択 <span class="math inline">\(\gamma\)</span> のサンプリング</h3>
<p>一般にベイズ変数選択は <span class="math inline">\(\gamma\)</span> のような指示変数のサンプリングに問題を帰着させる方法 <span class="citation" data-cites="Zanella2020">(<a href="#ref-Zanella2020" role="doc-biblioref">Zanella, 2020</a>)</span> が state-of-the-art とされる．</p>
<p>しかし各 <span class="math inline">\(\gamma\in 2^{Kp}\)</span> に対応するモデルの（周辺）尤度の計算が困難な場面は多く，特に今回の生存モデルはその一例である <span class="citation" data-cites="Liang+2023">(<a href="#ref-Liang+2023" role="doc-biblioref">Liang et al., 2023</a>)</span>．</p>
<p>しかし Zig-Zag サンプラーでは <span class="math inline">\(\{\beta_{k,j}=0\}\)</span> のなす部分空間を通過する際に一定の確率でランダムな時間ここに囚われることで，自然な形で trans-dimensional なサンプリングが可能になることが <span class="citation" data-cites="Chevallier+2023">(<a href="#ref-Chevallier+2023" role="doc-biblioref">Augustin Chevallier and Sutton, 2023</a>)</span>, <span class="citation" data-cites="Bierkens+2023">(<a href="#ref-Bierkens+2023" role="doc-biblioref">Bierkens et al., 2022</a>)</span> により同時に提案されている．</p>
<p>この際 <span class="math inline">\(\{\beta_{k,j}=0\}\)</span> から脱出する確率は時刻や位置に依らず（ハイパーパラメータ <span class="math inline">\(\omega\)</span> の下で）一定であり，一様な Poisson 点過程のシミュレーションにより実現される．この意味で Zig-Zag サンプラーによる変数選択は，周辺尤度の計算を回避した効率的な計算法を提供する．</p>
</section>
<section id="kd-のサンプリング" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="kd-のサンプリング"><span class="header-section-number">2.5</span> <span class="math inline">\(K,D\)</span> のサンプリング</h3>
<p>ここでは birth-death-swap 過程を用いる．というのも，３つの Poisson 点過程 <span class="math inline">\(\Lambda^b,\Lambda^d,\Lambda^s\)</span> を用いて，これが到着するごとに確率核 <span class="math inline">\(q_b,q_d,q_s\)</span> に従って新たなハザード関数の追加・消去・取り替えが起こる．</p>
<p>取り替えは必ずしも必要がないが，これの追加により多峰性の問題 <a href="#sec-theta" class="quarto-xref">2.2</a> が解決され，サンプラーの収束が改善されるという．</p>
<p>birth-death 過程は次の詳細釣り合い条件を満たせば良い： <span class="math display">\[
\Lambda^b(t)\pi(\theta,D,K)q_b(u)=\Lambda^d(t)\pi(\theta',D',K')q_d(u').
\]</span></p>
<p>この方法は Zig-Zag within Gibbs <span class="citation" data-cites="Sachs+2023">(<a href="#ref-Sachs+2023" role="doc-biblioref">Sachs et al., 2023</a>)</span> の Gibbs 核を，<span class="citation" data-cites="Green1995">(<a href="#ref-Green1995" role="doc-biblioref">Green, 1995</a>)</span> の超次元跳躍核に取り替えていることに等しい．</p>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="文献紹介" class="level2 appendix" data-number="3"><h2 class="quarto-appendix-heading"></h2><div class="quarto-appendix-contents">





</div></section><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">3 文献紹介</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Andrieu-Livingstone2021" class="csl-entry" role="listitem">
Andrieu, C., and Livingstone, S. (2021). <a href="https://doi.org/10.1214/20-AOS2008"><span class="nocase">Peskun–Tierney ordering for Markovian Monte Carlo: Beyond the reversible scenario</span></a>. <em>The Annals of Statistics</em>, <em>49</em>(4), 1958–1981.
</div>
<div id="ref-Chevallier+2023" class="csl-entry" role="listitem">
Augustin Chevallier, P. F., and Sutton, M. (2023). <a href="https://doi.org/10.1080/01621459.2022.2099402">Reversible jump PDMP samplers for variable selection</a>. <em>Journal of the American Statistical Association</em>, <em>118</em>(544), 2915–2927.
</div>
<div id="ref-Bierkens+2023" class="csl-entry" role="listitem">
Bierkens, J., Grazzi, S., Meulen, F. van der, and Schauer, M. (2022). <a href="https://doi.org/10.1007/s11222-022-10180-5"><span class="nocase">Sticky PDMP Samplers for Sparse and Local Inference Problems</span></a>. <em>Statistics and Computing</em>, <em>33</em>(1), 8.
</div>
<div id="ref-Corbella+2022" class="csl-entry" role="listitem">
Corbella, A., Spencer, S. E. F., and Roberts, G. O. (2022). <a href="https://doi.org/10.1007/s11222-022-10142-x"><span class="nocase">Automatic Zig-Zag Sampling in Practice</span></a>. <em>Statistics and Computing</em>, <em>32</em>(6), 107.
</div>
<div id="ref-Gelman2006" class="csl-entry" role="listitem">
Gelman, A. (2006). <a href="https://doi.org/10.1214/06-BA117A"><span class="nocase">Prior distributions for variance parameters in hierarchical models (comment on article by Browne and Draper)</span></a>. <em>Bayesian Analysis</em>, <em>1</em>(3), 515–534.
</div>
<div id="ref-Green1995" class="csl-entry" role="listitem">
Green, P. J. (1995). <a href="http://www.jstor.org/stable/2337340">Reversible jump markov chain monte carlo computation and bayesian model determination</a>. <em>Biometrika</em>, <em>82</em>(4), 711–732.
</div>
<div id="ref-Hardcastle+2024" class="csl-entry" role="listitem">
Hardcastle, L., Livingstone, S., and Baio, G. (2024). <a href="https://arxiv.org/abs/2406.14182">Averaging polyhazard models using piecewise deterministic monte carlo with applications to data with long-term survivors</a>.
</div>
<div id="ref-Jasra+2005" class="csl-entry" role="listitem">
Jasra, A., Holmes, C. C., and Stephens, D. A. (2005). <a href="https://doi.org/10.1214/088342305000000016"><span class="nocase">Markov Chain Monte Carlo Methods and the Label Switching Problem in Bayesian Mixture Modeling</span></a>. <em>Statistical Science</em>, <em>20</em>(1), 50–67.
</div>
<div id="ref-Ley-Steel2009" class="csl-entry" role="listitem">
Ley, E., and Steel, M. F. J. (2009). <a href="https://doi.org/10.1002/jae.1057">On the effect of prior assumptions in bayesian model averaging with applications to growth regression</a>. <em>Journal of Applied Econometrics</em>, <em>24</em>(4), 651–674.
</div>
<div id="ref-Liang+2023" class="csl-entry" role="listitem">
Liang, X., Livingstone, S., and Griffin, J. (2023). <a href="https://doi.org/10.3390/e25091310">Adaptive MCMC for bayesian variable selection in generalised linear models and survival models</a>. <em>Entropy</em>, <em>25</em>(9).
</div>
<div id="ref-Mitchell-Beauchamp1988" class="csl-entry" role="listitem">
Mitchell, T. J., and Beauchamp, J. J. (1988). <a href="http://www.jstor.org/stable/2290129">Bayesian variable selection in linear regression</a>. <em>Journal of the American Statistical Association</em>, <em>83</em>(404), 1023–1032.
</div>
<div id="ref-Polson-Scott2012" class="csl-entry" role="listitem">
Polson, N. G., and Scott, J. G. (2012). <a href="https://doi.org/10.1214/12-BA730"><span class="nocase">On the Half-Cauchy Prior for a Global Scale Parameter</span></a>. <em>Bayesian Analysis</em>, <em>7</em>(4), 887–902.
</div>
<div id="ref-Sachs+2023" class="csl-entry" role="listitem">
Sachs, M., Sen, D., Lu, J., and Dunson, D. (2023). <a href="https://doi.org/10.1214/22-BA1319"><span class="nocase">Posterior Computation with the Gibbs Zig-Zag Sampler</span></a>. <em>Bayesian Analysis</em>, <em>18</em>(3), 909–927.
</div>
<div id="ref-Sutton-Fearnhead2023" class="csl-entry" role="listitem">
Sutton, M., and Fearnhead, P. (2023). <a href="https://doi.org/10.1080/10618600.2023.2203735"><span class="nocase">Concave-Convex PDMP-based Sampling</span></a>. <em>Journal of Computational and Graphical Statistics</em>, <em>32</em>(4), 1425–1435.
</div>
<div id="ref-Zanella2020" class="csl-entry" role="listitem">
Zanella, G. (2020). <a href="https://doi.org/10.1080/01621459.2019.1585255">Informed proposals for local MCMC in discrete spaces</a>. <em>Journal of the American Statistical Association</em>, <em>115</em>(530), 852–865.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/162348\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="162348/162348.github.io" data-repo-id="R_kgDOKlfKYQ" data-category="Announcements" data-category-id="DIC_kwDOKlfKYc4CgDmb" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" data-loading="lazy" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://162348.github.io/">
<p>Hirofumi Shiba</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/162348/162348.github.io/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ano2math5">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:shiba.hirofumi@ism.ac.jp">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../../blog.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>