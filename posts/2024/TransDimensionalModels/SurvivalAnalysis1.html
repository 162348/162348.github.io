<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="司馬 博文">

<title>ベイズ階層多ハザードモデル – Hirofumi Shiba</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../assets/Shiba2.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-listing/list.min.js"></script>
<script src="../../../site_libs/quarto-listing/quarto-listing.js"></script>
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-17fe1cf3e956a182c91ebc961519b7ef.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-0f2480df0810fd4b271b6821b38b6b3d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "?",
    "H"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>

  window.document.addEventListener("DOMContentLoaded", function (_event) {
    const listingTargetEl = window.document.querySelector('#listing-lst-zigzag .list');
    if (!listingTargetEl) {
      // No listing discovered, do not attach.
      return; 
    }

    const options = {
      valueNames: ['listing-title','listing-image','listing-date','listing-subtitle',{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
      
      searchColumns: ["listing-title","listing-author","listing-date","listing-image","listing-description"],
    };

    window['quarto-listings'] = window['quarto-listings'] || {};
    window['quarto-listings']['listing-lst-zigzag'] = new List('listing-lst-zigzag', options);

    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  });

  window.addEventListener('hashchange',() => {
    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  })
  

  window.document.addEventListener("DOMContentLoaded", function (_event) {
    const listingTargetEl = window.document.querySelector('#listing-lst-listing .list');
    if (!listingTargetEl) {
      // No listing discovered, do not attach.
      return; 
    }

    const options = {
      valueNames: ['listing-title','listing-image','listing-subtitle',{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
      
      searchColumns: ["listing-title","listing-author","listing-date","listing-image","listing-description"],
    };

    window['quarto-listings'] = window['quarto-listings'] || {};
    window['quarto-listings']['listing-lst-listing'] = new List('listing-lst-listing', options);

    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  });

  window.addEventListener('hashchange',() => {
    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  })
  </script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-36GX2G6GLL"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-36GX2G6GLL', { 'anonymize_ip': true});
</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Zen+Kurenaido&amp;display=swap" rel="stylesheet">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=BIZ+UDPGothic&amp;display=swap" rel="stylesheet">

<style>
  h1, .title, .description, .subtitle {
    font-family: "Zen Kurenaido", sans-serif !important;
  }
</style>

<!-- <style>
  .menu-text {
      font-family: "Gill Sans", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
  .navbar-title {
      font-family: "Gill Sans", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
</style> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../assets/styles.css">
<meta property="og:title" content="ベイズ階層多ハザードモデル – Hirofumi Shiba">
<meta property="og:description" content="医療技術評価における生存解析では，打ち切りデータを最もよく外挿できるハザードモデルが探索される． そこでモデルの選択が重要な課題になるが，ベイズの方法だとモデル平均というアイデアが使える． これを polyhazard model で実行するためのベイズ階層モデルとモデル平均法を紹介する． キーとなる記述は Zig-Zag サンプラーである．">
<meta property="og:image" content="https://162348.github.io/posts/2024/TransDimensionalModels/Images/Polyhazard.png">
<meta property="og:site_name" content="Hirofumi Shiba">
<meta property="og:image:height" content="1096">
<meta property="og:image:width" content="1510">
<meta name="twitter:title" content="ベイズ階層多ハザードモデル – Hirofumi Shiba">
<meta name="twitter:description" content="医療技術評価における生存解析では，打ち切りデータを最もよく外挿できるハザードモデルが探索される． そこでモデルの選択が重要な課題になるが，ベイズの方法だとモデル平均というアイデアが使える． これを polyhazard model で実行するためのベイズ階層モデルとモデル平均法を紹介する． キーとなる記述は Zig-Zag サンプラーである．">
<meta name="twitter:image" content="https://162348.github.io/posts/2024/TransDimensionalModels/Images/Polyhazard.png">
<meta name="twitter:creator" content="@ano2math5">
<meta name="twitter:image-height" content="1096">
<meta name="twitter:image-width" content="1510">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Hirofumi Shiba</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-notes" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Notes</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-notes">    
        <li>
    <a class="dropdown-item" href="../../../static/English.html">
 <span class="dropdown-text">English Notes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../blog.html">
 <span class="dropdown-text">ノート (Japanese)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Materials.html"> 
<span class="menu-text">Materials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/162348/162348.github.io/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">ベイズ階層多ハザードモデル</h1>
            <p class="subtitle lead">Zig-Zag サンプラーによるモデル平均法</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Bayesian</div>
                <div class="quarto-category">MCMC</div>
                <div class="quarto-category">Statistics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>司馬 博文 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">9/12/2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">11/12/2024</p>
      </div>
    </div>
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="block-title">概要</div>
      <p>医療技術評価における生存解析では，打ち切りデータを最もよく外挿できるハザードモデルが探索される． そこでモデルの選択が重要な課題になるが，ベイズの方法だとモデル平均というアイデアが使える． これを polyhazard model で実行するためのベイズ階層モデルとモデル平均法を紹介する． キーとなる記述は Zig-Zag サンプラーである．</p>
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目次</h2>
   
  <ul>
  <li><a href="#ベイズ階層多ハザードモデル" id="toc-ベイズ階層多ハザードモデル" class="nav-link active" data-scroll-target="#ベイズ階層多ハザードモデル"><span class="header-section-number">1</span> ベイズ階層多ハザードモデル</a>
  <ul class="collapse">
  <li><a href="#sec-polyhazard-model" id="toc-sec-polyhazard-model" class="nav-link" data-scroll-target="#sec-polyhazard-model"><span class="header-section-number">1.1</span> 多ハザードモデルの表現力</a></li>
  <li><a href="#ベイズ階層多ハザードモデル-1" id="toc-ベイズ階層多ハザードモデル-1" class="nav-link" data-scroll-target="#ベイズ階層多ハザードモデル-1"><span class="header-section-number">1.2</span> ベイズ階層多ハザードモデル</a></li>
  </ul></li>
  <li><a href="#pdmp-によるベイズ競合リスク分析" id="toc-pdmp-によるベイズ競合リスク分析" class="nav-link" data-scroll-target="#pdmp-によるベイズ競合リスク分析"><span class="header-section-number">2</span> PDMP によるベイズ競合リスク分析</a>
  <ul class="collapse">
  <li><a href="#はじめに" id="toc-はじめに" class="nav-link" data-scroll-target="#はじめに"><span class="header-section-number">2.1</span> はじめに</a></li>
  <li><a href="#sec-theta" id="toc-sec-theta" class="nav-link" data-scroll-target="#sec-theta"><span class="header-section-number">2.2</span> <span class="math inline">\(\theta\)</span> の Zig-Zag サンプリング</a></li>
  <li><a href="#ハイパーパラメータ-phi-のサンプリング" id="toc-ハイパーパラメータ-phi-のサンプリング" class="nav-link" data-scroll-target="#ハイパーパラメータ-phi-のサンプリング"><span class="header-section-number">2.3</span> ハイパーパラメータ <span class="math inline">\(\phi\)</span> のサンプリング</a></li>
  <li><a href="#変数選択-gamma-のサンプリング" id="toc-変数選択-gamma-のサンプリング" class="nav-link" data-scroll-target="#変数選択-gamma-のサンプリング"><span class="header-section-number">2.4</span> 変数選択 <span class="math inline">\(\gamma\)</span> のサンプリング</a></li>
  <li><a href="#kd-のサンプリング" id="toc-kd-のサンプリング" class="nav-link" data-scroll-target="#kd-のサンプリング"><span class="header-section-number">2.5</span> <span class="math inline">\(K,D\)</span> のサンプリング</a></li>
  </ul></li>
  
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="前稿" class="level2 unlisted unnumbered">
<h2 class="unlisted unnumbered anchored" data-anchor-id="前稿">前稿</h2>
<div id="listing-lst-listing" class="listing quarto-float quarto-figure quarto-figure-left quarto-listing quarto-listing-container-grid anchored">
<div class="list grid quarto-listing-cols-1">
<div class="g-col-1" data-index="0" data-categories="QmF5ZXNpYW4lMkNNQ01DJTJDU3RhdGlzdGljcw==" data-listing-date-sort="1726099200000" data-listing-file-modified-sort="1755513581156" data-listing-date-modified-sort="1747872000000" data-listing-reading-time-sort="3" data-listing-word-count-sort="413">
<a href="../../../posts/2024/TransDimensionalModels/SurvivalAnalysis.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-center">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/TransDimensionalModels/Images/Polyhazard.png" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
ベイズ生存時間解析
</h5>
<div class="card-subtitle listing-subtitle">
生存曲線のベイズ階層モデルによる外挿
</div>
</div>
</div></a>
</div>
</div>
<div class="listing-no-matching d-none">No matching items</div>
</div>
<p>Zig-Zag サンプラーについては次の記事も参照：</p>
<div id="listing-lst-zigzag" class="listing quarto-float quarto-figure quarto-figure-left quarto-listing quarto-listing-container-grid anchored">
<div class="list grid quarto-listing-cols-3">
<div class="g-col-1" data-index="0" data-categories="UHJvY2VzcyUyQ1NhbXBsaW5nJTJDSnVsaWElMkNNQ01D" data-listing-date-sort="1719964800000" data-listing-file-modified-sort="1755513579350" data-listing-date-modified-sort="1721260800000" data-listing-reading-time-sort="13" data-listing-word-count-sort="2488">
<a href="../../../posts/2024/Process/ZigZag.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top"><img src="../Process/ZigZag2D_Gaussian.svg" style="height: 150px;"  class="thumbnail-image card-img"/></p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
Zig-Zag 過程によるサンプリング
</h5>
<div class="card-subtitle listing-subtitle">
ジャンプと確定的な動きによる新たな MCMC 手法
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-07-03
</div>
</div>
</div>
</div></a>
</div>
<div class="g-col-1" data-index="1" data-categories="TUNNQyUyQ0NvbXB1dGF0aW9uJTJDSnVsaWElMkNTYW1wbGluZw==" data-listing-date-sort="1721260800000" data-listing-file-modified-sort="1755513580391" data-listing-date-modified-sort="1724889600000" data-listing-reading-time-sort="14" data-listing-word-count-sort="2629">
<a href="../../../posts/2024/Stat/ZigZagSubsampling.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/Stat/MeanOfGaussian.svg" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
Zig-Zag サンプラーのサブサンプリングによるスケーラビリティ
</h5>
<div class="card-subtitle listing-subtitle">
大規模モデル・大規模データに対する MCMC を目指して
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-07-18
</div>
</div>
</div>
</div></a>
</div>
<div class="g-col-1" data-index="2" data-categories="UHJvY2VzcyUyQ1NhbXBsaW5nJTJDUg==" data-listing-date-sort="1706659200000" data-listing-file-modified-sort="1755513579347" data-listing-date-modified-sort="1719878400000" data-listing-reading-time-sort="7" data-listing-word-count-sort="1230">
<a href="../../../posts/2024/Process/PureJump.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/Process/PureJump_files/figure-html/unnamed-chunk-1-1.png" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
純粋跳躍過程の生成作用素と区分的確定的 Markov 過程
</h5>
<div class="card-subtitle listing-subtitle">
ジャンプと確定的な動きによる新たな MCMC 手法
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-01-31
</div>
</div>
</div>
</div></a>
</div>
</div>
<div class="listing-no-matching d-none">No matching items</div>
</div>
<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
<p>$$</p>
<p>$$</p>
</div>
</section>
<section id="ベイズ階層多ハザードモデル" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="ベイズ階層多ハザードモデル"><span class="header-section-number">1</span> ベイズ階層多ハザードモデル</h2>
<section id="sec-polyhazard-model" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="sec-polyhazard-model"><span class="header-section-number">1.1</span> 多ハザードモデルの表現力</h3>
<p>Polyhazard model もハザード関数をモデリングするが， <span class="math display">\[
h_Y(y)=\sum_{j=1}^Kh_j(y)
\]</span> という形でモデリングし，個々の <span class="math inline">\(h_j\)</span> にパラメトリックな仮定をおく．</p>
<p>仮に <span class="math inline">\(h_j\)</span> として，形状母数 <span class="math inline">\(\nu&gt;0\)</span> と位置母数 <span class="math inline">\(\mu:=\alpha^{-\nu}&gt;0\)</span> を持つ Weibull 分布 <span class="math inline">\(\mathrm{W}(\nu,\mu)\)</span> のハザード関数 <span class="math display">\[
h_{\mathrm{W}}(y):=\mu\nu y^{\nu-1}
\]</span> と対数ロジスティック分布 <span class="math inline">\(\mathrm{LL}(\nu,\mu)\)</span> のハザード関数 <span class="math display">\[
h_{\mathrm{LL}}(y):=\frac{\left(\frac{\nu}{\mu}\right)\left(\frac{y}{\mu}\right)^{\nu-1}}{1+\left(\frac{y}{\mu}\right)^\nu}
\]</span> の２つのみを考えたとしても，複数のパラメトリックモデルを足し合わせることで驚異的な表現力を達成することができる．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/Polyhazard.png" class="img-fluid figure-img"></p>
<figcaption><span class="citation" data-cites="Hardcastle+2024">(<a href="#ref-Hardcastle+2024" role="doc-biblioref">Hardcastle et al., 2024, p. 5</a>)</span> より．</figcaption>
</figure>
</div>
</section>
<section id="ベイズ階層多ハザードモデル-1" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="ベイズ階層多ハザードモデル-1"><span class="header-section-number">1.2</span> ベイズ階層多ハザードモデル</h3>
<p><span class="citation" data-cites="Hardcastle+2024">(<a href="#ref-Hardcastle+2024" role="doc-biblioref">Hardcastle et al., 2024</a>)</span> では <a href="../../../posts/2024/TransDimensionalModels/SurvivalAnalysis.html#sec-HTA">HTA</a> への応用を念頭に，完全なベイズ階層多ハザードモデルの推定を試みている．</p>
<section id="第１階層" class="level4" data-number="1.2.1">
<h4 data-number="1.2.1" class="anchored" data-anchor-id="第１階層"><span class="header-section-number">1.2.1</span> 第１階層</h4>
<p>各個別要因 <span class="math inline">\(k\in[K]\)</span> の形状母数 <span class="math inline">\(\nu_k\)</span> と位置母数 <span class="math inline">\(\mu_k\)</span> に階層構造 <span id="eq-nu"><span class="math display">\[
\log(\nu_k)=\alpha_k\sim\mathrm{N}(0,\sigma_\alpha^2)
\tag{1}\]</span></span> <span id="eq-mu"><span class="math display">\[
\log(\mu_k)=\beta_{k,0}+\sum_{j\in\left\{j\in[p]\mid\gamma_{kj}=1\right\}}x_j\beta_{k,j},\qquad\beta_{k,0}\sim\mathrm{N}(0,\sigma_{\beta_0}^2)
\tag{2}\]</span></span> を考える．ただし，<span class="math inline">\(\gamma_{k,j}\in2\)</span> は共変量 <span class="math inline">\(x_j\)</span> が <span class="math inline">\(k\in[K]\)</span> 番目の部分モデルに参加するかどうかを決める指示変数とする．</p>
<p>式 (<a href="#eq-mu" class="quarto-xref">2</a>) で残っているパラメータ <span class="math inline">\(\beta_{k,j}\;(j\in[p])\)</span> には <span class="math display">\[
\beta_{k,j}\sim(1-\omega)\delta_0+\omega\operatorname{N}(0,\sigma_\beta^2)
\]</span> と spike-and-slab 事前分布 <span class="citation" data-cites="Mitchell-Beauchamp1988">(<a href="#ref-Mitchell-Beauchamp1988" role="doc-biblioref">Mitchell and Beauchamp, 1988</a>)</span> を仮定し，変数選択を促進する．選択された変数については <span class="math inline">\(\gamma_{k,j}=1\)</span> とする．</p>
<p>以降，<span class="math inline">\(\theta_k=(\nu_k,\mu_k)\)</span> とし，<span class="math inline">\((K,\gamma,\theta)\)</span> を本モデルのパラメータと理解する（<span class="math inline">\(K\)</span> の事前分布は後述 <a href="#sec-prior-of-PX" class="quarto-xref">1.2.3</a>）．</p>
</section>
<section id="第２階層" class="level4" data-number="1.2.2">
<h4 data-number="1.2.2" class="anchored" data-anchor-id="第２階層"><span class="header-section-number">1.2.2</span> 第２階層</h4>
<p><span class="math inline">\(\sigma_\alpha^2=2,\sigma_{\beta_0}^2=5\)</span> は固定してしまうと，<span class="math inline">\(\phi:=(\omega,\sigma_\beta)\)</span> がハイパーパラメータとして残っている．これには <span class="math display">\[
\omega\sim\operatorname{Beta}(a,b)
\]</span> <span class="math display">\[
\sigma_\beta\sim\operatorname{HalfCauchy}(0,1)
\]</span> という事前分布をおき，<span class="math inline">\(a=b=4\)</span> と固定する．</p>
<p>前者はモデルのサイズについて Beta-二項分布を仮定することに等価である <span class="citation" data-cites="Ley-Steel2009">(3.1 節 <a href="#ref-Ley-Steel2009" role="doc-biblioref">Ley and Steel, 2009</a>)</span>．後者は <span class="citation" data-cites="Gelman2006">(<a href="#ref-Gelman2006" role="doc-biblioref">Gelman, 2006</a>)</span>, <span class="citation" data-cites="Polson-Scott2012">(<a href="#ref-Polson-Scott2012" role="doc-biblioref">Polson and Scott, 2012</a>)</span> の推奨の通りである．</p>
</section>
<section id="sec-prior-of-PX" class="level4" data-number="1.2.3">
<h4 data-number="1.2.3" class="anchored" data-anchor-id="sec-prior-of-PX"><span class="header-section-number">1.2.3</span> <span class="math inline">\(\mathcal{P}(E)\)</span> 上の事前分布</h4>
<p>実はまだ第一階層のパラメータが残っている．ハザードの数 <span class="math inline">\(K\)</span> と <span class="math inline">\(h_k\)</span> の関数形をどうするかである．</p>
<p>ここでは Weibull 分布 <span class="math inline">\(\mathrm{W}(\nu,\mu)\)</span> と対数ロジスティック分布 <span class="math inline">\(\mathrm{LL}(\nu,\mu)\)</span> の２つ <span class="math display">\[
D=\{\mathrm{W}(\nu,\mu),\mathrm{LL}(\nu,\mu)\}
\]</span> から等確率で <span class="math display">\[
K\sim\mathrm{Pois}_{&gt;0}(\xi)
\]</span> 個選ぶこととする．</p>
<p>ハイパーパラメータ <span class="math inline">\(\xi\)</span> については，<span class="citation" data-cites="Hardcastle+2024">(<a href="#ref-Hardcastle+2024" role="doc-biblioref">Hardcastle et al., 2024</a>)</span> では <span class="math inline">\(\xi=2\)</span> としている．その根拠の１つに <span class="math display">\[
\operatorname{P}[K\ge5]\approx0.061
\]</span> を満たす性質が，実際の応用で５つ以上の競合リスクが存在する場面は稀であることに整合することを挙げている：</p>
<div id="a0c3c9c4" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display" data-execution_count="2">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip310">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip310)" d="M0 1920 L2688 1920 L2688 -4.26326e-14 L0 -4.26326e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip311">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip310)" d="M225.654 1734.12 L2640.76 1734.12 L2640.76 127.792 L225.654 127.792  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip312">
    <rect x="225" y="127" width="2416" height="1607"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="578.806,1734.12 578.806,127.792 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1148.41,1734.12 1148.41,127.792 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1718,1734.12 1718,127.792 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2287.6,1734.12 2287.6,127.792 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="225.654,1688.65 2640.76,1688.65 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="225.654,1204.56 2640.76,1204.56 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="225.654,720.457 2640.76,720.457 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="225.654,236.358 2640.76,236.358 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="225.654,1734.12 2640.76,1734.12 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="578.806,1734.12 578.806,1715.22 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1148.41,1734.12 1148.41,1715.22 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1718,1734.12 1718,1715.22 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2287.6,1734.12 2287.6,1715.22 "></polyline>
<path clip-path="url(#clip310)" d="M573.459 1794.89 L589.778 1794.89 L589.778 1798.82 L567.834 1798.82 L567.834 1794.89 Q570.496 1792.13 575.079 1787.5 Q579.686 1782.85 580.866 1781.51 Q583.112 1778.98 583.991 1777.25 Q584.894 1775.49 584.894 1773.8 Q584.894 1771.04 582.95 1769.31 Q581.028 1767.57 577.926 1767.57 Q575.727 1767.57 573.274 1768.34 Q570.843 1769.1 568.065 1770.65 L568.065 1765.93 Q570.889 1764.79 573.343 1764.21 Q575.797 1763.64 577.834 1763.64 Q583.204 1763.64 586.399 1766.32 Q589.593 1769.01 589.593 1773.5 Q589.593 1775.63 588.783 1777.55 Q587.996 1779.45 585.889 1782.04 Q585.311 1782.71 582.209 1785.93 Q579.107 1789.12 573.459 1794.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M1151.41 1768.34 L1139.61 1786.78 L1151.41 1786.78 L1151.41 1768.34 M1150.19 1764.26 L1156.07 1764.26 L1156.07 1786.78 L1161 1786.78 L1161 1790.67 L1156.07 1790.67 L1156.07 1798.82 L1151.41 1798.82 L1151.41 1790.67 L1135.81 1790.67 L1135.81 1786.16 L1150.19 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M1718.41 1779.68 Q1715.26 1779.68 1713.41 1781.83 Q1711.58 1783.98 1711.58 1787.73 Q1711.58 1791.46 1713.41 1793.64 Q1715.26 1795.79 1718.41 1795.79 Q1721.56 1795.79 1723.39 1793.64 Q1725.24 1791.46 1725.24 1787.73 Q1725.24 1783.98 1723.39 1781.83 Q1721.56 1779.68 1718.41 1779.68 M1727.69 1765.02 L1727.69 1769.28 Q1725.93 1768.45 1724.13 1768.01 Q1722.35 1767.57 1720.59 1767.57 Q1715.96 1767.57 1713.5 1770.7 Q1711.07 1773.82 1710.72 1780.14 Q1712.09 1778.13 1714.15 1777.06 Q1716.21 1775.97 1718.69 1775.97 Q1723.9 1775.97 1726.91 1779.15 Q1729.94 1782.29 1729.94 1787.73 Q1729.94 1793.06 1726.79 1796.27 Q1723.64 1799.49 1718.41 1799.49 Q1712.41 1799.49 1709.24 1794.91 Q1706.07 1790.3 1706.07 1781.58 Q1706.07 1773.38 1709.96 1768.52 Q1713.85 1763.64 1720.4 1763.64 Q1722.16 1763.64 1723.94 1763.98 Q1725.75 1764.33 1727.69 1765.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2287.6 1782.41 Q2284.27 1782.41 2282.35 1784.19 Q2280.45 1785.97 2280.45 1789.1 Q2280.45 1792.22 2282.35 1794.01 Q2284.27 1795.79 2287.6 1795.79 Q2290.94 1795.79 2292.86 1794.01 Q2294.78 1792.2 2294.78 1789.1 Q2294.78 1785.97 2292.86 1784.19 Q2290.96 1782.41 2287.6 1782.41 M2282.93 1780.42 Q2279.92 1779.68 2278.23 1777.62 Q2276.56 1775.56 2276.56 1772.59 Q2276.56 1768.45 2279.5 1766.04 Q2282.47 1763.64 2287.6 1763.64 Q2292.77 1763.64 2295.71 1766.04 Q2298.65 1768.45 2298.65 1772.59 Q2298.65 1775.56 2296.96 1777.62 Q2295.29 1779.68 2292.3 1780.42 Q2295.68 1781.21 2297.56 1783.5 Q2299.46 1785.79 2299.46 1789.1 Q2299.46 1794.12 2296.38 1796.81 Q2293.32 1799.49 2287.6 1799.49 Q2281.89 1799.49 2278.81 1796.81 Q2275.75 1794.12 2275.75 1789.1 Q2275.75 1785.79 2277.65 1783.5 Q2279.55 1781.21 2282.93 1780.42 M2281.22 1773.03 Q2281.22 1775.72 2282.88 1777.22 Q2284.57 1778.73 2287.6 1778.73 Q2290.61 1778.73 2292.3 1777.22 Q2294.02 1775.72 2294.02 1773.03 Q2294.02 1770.35 2292.3 1768.84 Q2290.61 1767.34 2287.6 1767.34 Q2284.57 1767.34 2282.88 1768.84 Q2281.22 1770.35 2281.22 1773.03 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M1461.62 1832.79 Q1461.62 1833.2 1461.52 1833.49 Q1461.43 1833.75 1461.2 1833.88 Q1460.98 1834.01 1460.85 1834.04 Q1460.72 1834.07 1460.43 1834.11 Q1459.04 1834.24 1458.08 1834.46 Q1457.14 1834.69 1454.83 1835.85 Q1452.54 1837.01 1449.67 1839.1 L1438.14 1848.02 L1436.21 1849.53 Q1436.21 1849.63 1436.27 1849.82 Q1436.34 1849.98 1436.4 1850.21 Q1436.5 1850.4 1436.53 1850.47 L1445.9 1872.08 Q1446.64 1873.82 1447.55 1874.43 Q1448.45 1875.04 1450.48 1875.07 Q1450.8 1875.07 1450.93 1875.1 Q1451.09 1875.1 1451.31 1875.17 Q1451.57 1875.2 1451.67 1875.36 Q1451.8 1875.52 1451.8 1875.78 Q1451.8 1877.1 1450.61 1877.1 Q1449.87 1877.1 1447.35 1877 Q1444.84 1876.91 1444.13 1876.91 Q1442.81 1876.91 1440.11 1877 Q1437.4 1877.1 1436.08 1877.1 Q1435.15 1877.1 1435.15 1876.36 Q1435.15 1875.75 1435.37 1875.46 Q1435.63 1875.14 1435.86 1875.1 Q1436.08 1875.07 1436.6 1875.07 Q1436.98 1875.07 1437.4 1875.04 Q1437.85 1874.98 1438.5 1874.81 Q1439.17 1874.62 1439.59 1874.17 Q1440.04 1873.69 1440.04 1873.01 Q1440.04 1872.46 1439.24 1870.69 L1431.6 1852.95 L1421.78 1860.61 L1419.14 1870.98 Q1419.08 1871.37 1418.92 1872.05 Q1418.75 1872.72 1418.63 1873.2 Q1418.53 1873.69 1418.53 1873.88 Q1418.53 1874.3 1418.79 1874.56 Q1419.08 1874.81 1419.79 1874.94 Q1420.49 1875.04 1421.04 1875.07 Q1421.62 1875.07 1422.81 1875.07 Q1424.29 1875.07 1424.55 1875.33 Q1424.68 1875.49 1424.68 1875.78 Q1424.68 1876.23 1424.55 1876.55 Q1424.42 1876.84 1424.17 1876.94 Q1423.94 1877.04 1423.78 1877.07 Q1423.62 1877.1 1423.36 1877.1 Q1422.68 1877.1 1421.23 1877.04 Q1419.82 1876.97 1419.08 1876.97 L1414.86 1876.91 L1406.48 1877.1 Q1405.49 1877.1 1405.49 1876.3 Q1405.49 1875.68 1405.74 1875.43 Q1406 1875.14 1406.29 1875.1 Q1406.58 1875.07 1407.32 1875.07 Q1408.93 1875.07 1409.9 1874.98 Q1410.86 1874.88 1411.48 1874.75 Q1412.12 1874.59 1412.44 1874.14 Q1412.8 1873.69 1412.96 1873.3 Q1413.12 1872.88 1413.34 1871.95 L1422.17 1836.52 Q1422.43 1835.46 1422.43 1835.3 Q1422.43 1834.75 1422.1 1834.56 Q1421.81 1834.33 1420.98 1834.24 Q1419.37 1834.11 1418.14 1834.11 Q1417.34 1834.11 1417.02 1834.07 Q1416.73 1834.04 1416.47 1833.88 Q1416.24 1833.69 1416.24 1833.3 Q1416.24 1832.05 1417.56 1832.05 L1426.07 1832.24 L1434.5 1832.05 Q1435.44 1832.05 1435.44 1832.79 Q1435.44 1833.72 1434.99 1833.91 Q1434.57 1834.11 1433.18 1834.11 Q1430.77 1834.11 1429.67 1834.43 Q1428.61 1834.72 1428.29 1835.23 Q1428 1835.72 1427.64 1837.13 L1422.36 1858.29 L1448.09 1838.52 Q1450.48 1836.52 1450.48 1835.49 Q1450.48 1834.82 1449.99 1834.53 Q1449.54 1834.2 1448.42 1834.11 Q1447.61 1833.98 1447.61 1833.37 Q1447.61 1832.75 1447.84 1832.46 Q1448.09 1832.14 1448.29 1832.11 Q1448.51 1832.05 1448.87 1832.05 Q1450.06 1832.05 1452.54 1832.14 Q1455.02 1832.24 1456.21 1832.24 Q1457.02 1832.24 1458.59 1832.14 Q1460.17 1832.05 1460.88 1832.05 Q1461.23 1832.05 1461.43 1832.3 Q1461.62 1832.53 1461.62 1832.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="225.654,1734.12 225.654,127.792 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="225.654,1688.65 244.552,1688.65 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="225.654,1204.56 244.552,1204.56 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="225.654,720.457 244.552,720.457 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="225.654,236.358 244.552,236.358 "></polyline>
<path clip-path="url(#clip310)" d="M128.159 1674.45 Q124.548 1674.45 122.719 1678.02 Q120.913 1681.56 120.913 1688.69 Q120.913 1695.8 122.719 1699.36 Q124.548 1702.9 128.159 1702.9 Q131.793 1702.9 133.599 1699.36 Q135.427 1695.8 135.427 1688.69 Q135.427 1681.56 133.599 1678.02 Q131.793 1674.45 128.159 1674.45 M128.159 1670.75 Q133.969 1670.75 137.025 1675.36 Q140.103 1679.94 140.103 1688.69 Q140.103 1697.42 137.025 1702.02 Q133.969 1706.61 128.159 1706.61 Q122.349 1706.61 119.27 1702.02 Q116.214 1697.42 116.214 1688.69 Q116.214 1679.94 119.27 1675.36 Q122.349 1670.75 128.159 1670.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M148.321 1700.06 L153.205 1700.06 L153.205 1705.93 L148.321 1705.93 L148.321 1700.06 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M173.39 1674.45 Q169.779 1674.45 167.95 1678.02 Q166.145 1681.56 166.145 1688.69 Q166.145 1695.8 167.95 1699.36 Q169.779 1702.9 173.39 1702.9 Q177.024 1702.9 178.83 1699.36 Q180.659 1695.8 180.659 1688.69 Q180.659 1681.56 178.83 1678.02 Q177.024 1674.45 173.39 1674.45 M173.39 1670.75 Q179.2 1670.75 182.256 1675.36 Q185.334 1679.94 185.334 1688.69 Q185.334 1697.42 182.256 1702.02 Q179.2 1706.61 173.39 1706.61 Q167.58 1706.61 164.501 1702.02 Q161.446 1697.42 161.446 1688.69 Q161.446 1679.94 164.501 1675.36 Q167.58 1670.75 173.39 1670.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M129.386 1190.35 Q125.775 1190.35 123.946 1193.92 Q122.14 1197.46 122.14 1204.59 Q122.14 1211.7 123.946 1215.26 Q125.775 1218.8 129.386 1218.8 Q133.02 1218.8 134.825 1215.26 Q136.654 1211.7 136.654 1204.59 Q136.654 1197.46 134.825 1193.92 Q133.02 1190.35 129.386 1190.35 M129.386 1186.65 Q135.196 1186.65 138.251 1191.26 Q141.33 1195.84 141.33 1204.59 Q141.33 1213.32 138.251 1217.92 Q135.196 1222.51 129.386 1222.51 Q123.576 1222.51 120.497 1217.92 Q117.441 1213.32 117.441 1204.59 Q117.441 1195.84 120.497 1191.26 Q123.576 1186.65 129.386 1186.65 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M149.548 1215.96 L154.432 1215.96 L154.432 1221.84 L149.548 1221.84 L149.548 1215.96 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M165.427 1217.9 L173.066 1217.9 L173.066 1191.54 L164.756 1193.2 L164.756 1188.94 L173.02 1187.28 L177.696 1187.28 L177.696 1217.9 L185.334 1217.9 L185.334 1221.84 L165.427 1221.84 L165.427 1217.9 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M129.756 706.256 Q126.145 706.256 124.316 709.82 Q122.511 713.362 122.511 720.492 Q122.511 727.598 124.316 731.163 Q126.145 734.704 129.756 734.704 Q133.39 734.704 135.196 731.163 Q137.025 727.598 137.025 720.492 Q137.025 713.362 135.196 709.82 Q133.39 706.256 129.756 706.256 M129.756 702.552 Q135.566 702.552 138.622 707.158 Q141.7 711.742 141.7 720.492 Q141.7 729.218 138.622 733.825 Q135.566 738.408 129.756 738.408 Q123.946 738.408 120.867 733.825 Q117.812 729.218 117.812 720.492 Q117.812 711.742 120.867 707.158 Q123.946 702.552 129.756 702.552 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M149.918 731.857 L154.802 731.857 L154.802 737.737 L149.918 737.737 L149.918 731.857 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M169.015 733.802 L185.334 733.802 L185.334 737.737 L163.39 737.737 L163.39 733.802 Q166.052 731.047 170.635 726.417 Q175.242 721.765 176.422 720.422 Q178.668 717.899 179.547 716.163 Q180.45 714.404 180.45 712.714 Q180.45 709.959 178.506 708.223 Q176.584 706.487 173.483 706.487 Q171.284 706.487 168.83 707.251 Q166.399 708.015 163.622 709.566 L163.622 704.844 Q166.446 703.709 168.899 703.131 Q171.353 702.552 173.39 702.552 Q178.76 702.552 181.955 705.237 Q185.149 707.922 185.149 712.413 Q185.149 714.543 184.339 716.464 Q183.552 718.362 181.446 720.955 Q180.867 721.626 177.765 724.843 Q174.663 728.038 169.015 733.802 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M128.807 222.157 Q125.196 222.157 123.367 225.721 Q121.562 229.263 121.562 236.393 Q121.562 243.499 123.367 247.064 Q125.196 250.605 128.807 250.605 Q132.441 250.605 134.247 247.064 Q136.075 243.499 136.075 236.393 Q136.075 229.263 134.247 225.721 Q132.441 222.157 128.807 222.157 M128.807 218.453 Q134.617 218.453 137.673 223.059 Q140.751 227.643 140.751 236.393 Q140.751 245.119 137.673 249.726 Q134.617 254.309 128.807 254.309 Q122.997 254.309 119.918 249.726 Q116.863 245.119 116.863 236.393 Q116.863 227.643 119.918 223.059 Q122.997 218.453 128.807 218.453 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M148.969 247.758 L153.853 247.758 L153.853 253.638 L148.969 253.638 L148.969 247.758 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M178.205 235.004 Q181.561 235.721 183.436 237.99 Q185.334 240.258 185.334 243.592 Q185.334 248.707 181.816 251.508 Q178.297 254.309 171.816 254.309 Q169.64 254.309 167.325 253.869 Q165.034 253.453 162.58 252.596 L162.58 248.082 Q164.524 249.217 166.839 249.795 Q169.154 250.374 171.677 250.374 Q176.075 250.374 178.367 248.638 Q180.682 246.902 180.682 243.592 Q180.682 240.536 178.529 238.823 Q176.399 237.087 172.58 237.087 L168.552 237.087 L168.552 233.244 L172.765 233.244 Q176.214 233.244 178.043 231.879 Q179.872 230.49 179.872 227.897 Q179.872 225.235 177.973 223.823 Q176.098 222.388 172.58 222.388 Q170.659 222.388 168.46 222.805 Q166.26 223.221 163.622 224.101 L163.622 219.934 Q166.284 219.194 168.598 218.823 Q170.936 218.453 172.997 218.453 Q178.321 218.453 181.422 220.883 Q184.524 223.291 184.524 227.411 Q184.524 230.281 182.881 232.272 Q181.237 234.24 178.205 235.004 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M32.8336 984.108 Q28.8869 981.912 27.009 978.856 Q25.1311 975.801 25.1311 971.663 Q25.1311 966.093 29.046 963.07 Q32.9291 960.046 40.1224 960.046 L61.6384 960.046 L61.6384 965.934 L40.3133 965.934 Q35.1889 965.934 32.7063 967.748 Q30.2237 969.563 30.2237 973.287 Q30.2237 977.838 33.2474 980.48 Q36.2711 983.122 41.491 983.122 L61.6384 983.122 L61.6384 989.01 L40.3133 989.01 Q35.1571 989.01 32.7063 990.824 Q30.2237 992.638 30.2237 996.426 Q30.2237 1000.91 33.2792 1003.56 Q36.3029 1006.2 41.491 1006.2 L61.6384 1006.2 L61.6384 1012.09 L25.9905 1012.09 L25.9905 1006.2 L31.5287 1006.2 Q28.2503 1004.19 26.6907 1001.39 Q25.1311 998.59 25.1311 994.739 Q25.1311 990.856 27.1045 988.15 Q29.0779 985.413 32.8336 984.108 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M43.719 932.164 Q43.719 939.262 45.3422 941.999 Q46.9655 944.736 50.8804 944.736 Q53.9996 944.736 55.8457 942.699 Q57.6599 940.63 57.6599 937.097 Q57.6599 932.228 54.2224 929.299 Q50.7531 926.339 45.0239 926.339 L43.719 926.339 L43.719 932.164 M41.3 920.483 L61.6384 920.483 L61.6384 926.339 L56.2276 926.339 Q59.4741 928.345 61.0337 931.336 Q62.5615 934.328 62.5615 938.657 Q62.5615 944.132 59.5059 947.378 Q56.4186 950.593 51.2623 950.593 Q45.2467 950.593 42.1912 946.582 Q39.1357 942.54 39.1357 934.551 L39.1357 926.339 L38.5628 926.339 Q34.5205 926.339 32.3244 929.013 Q30.0964 931.655 30.0964 936.461 Q30.0964 939.516 30.8284 942.413 Q31.5605 945.309 33.0246 947.983 L27.6137 947.983 Q26.3724 944.768 25.7677 941.744 Q25.1311 938.721 25.1311 935.856 Q25.1311 928.122 29.1415 924.302 Q33.1519 920.483 41.3 920.483 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M27.0408 885.694 L32.579 885.694 Q31.3059 888.177 30.6693 890.851 Q30.0327 893.524 30.0327 896.389 Q30.0327 900.749 31.3695 902.945 Q32.7063 905.11 35.3799 905.11 Q37.4169 905.11 38.5946 903.55 Q39.7404 901.991 40.7908 897.28 L41.2364 895.275 Q42.5732 889.036 45.0239 886.426 Q47.4429 883.785 51.8034 883.785 Q56.7687 883.785 59.6651 887.731 Q62.5615 891.646 62.5615 898.521 Q62.5615 901.386 61.9886 904.505 Q61.4475 907.592 60.3335 911.03 L54.2861 911.03 Q55.973 907.783 56.8323 904.632 Q57.6599 901.481 57.6599 898.394 Q57.6599 894.256 56.2594 892.028 Q54.8271 889.8 52.249 889.8 Q49.8619 889.8 48.5887 891.424 Q47.3156 893.015 46.1379 898.458 L45.6605 900.495 Q44.5147 905.937 42.1594 908.356 Q39.7722 910.775 35.6345 910.775 Q30.6056 910.775 27.8684 907.21 Q25.1311 903.646 25.1311 897.089 Q25.1311 893.842 25.6085 890.978 Q26.086 888.113 27.0408 885.694 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M27.0408 851.733 L32.579 851.733 Q31.3059 854.216 30.6693 856.89 Q30.0327 859.563 30.0327 862.428 Q30.0327 866.788 31.3695 868.984 Q32.7063 871.149 35.3799 871.149 Q37.4169 871.149 38.5946 869.589 Q39.7404 868.03 40.7908 863.319 L41.2364 861.314 Q42.5732 855.075 45.0239 852.465 Q47.4429 849.824 51.8034 849.824 Q56.7687 849.824 59.6651 853.77 Q62.5615 857.685 62.5615 864.56 Q62.5615 867.425 61.9886 870.544 Q61.4475 873.631 60.3335 877.069 L54.2861 877.069 Q55.973 873.822 56.8323 870.671 Q57.6599 867.52 57.6599 864.433 Q57.6599 860.295 56.2594 858.067 Q54.8271 855.839 52.249 855.839 Q49.8619 855.839 48.5887 857.462 Q47.3156 859.054 46.1379 864.497 L45.6605 866.534 Q44.5147 871.976 42.1594 874.395 Q39.7722 876.814 35.6345 876.814 Q30.6056 876.814 27.8684 873.249 Q25.1311 869.685 25.1311 863.128 Q25.1311 859.881 25.6085 857.017 Q26.086 854.152 27.0408 851.733 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M1241.66 72.6777 L1241.66 70.0954 L1243.67 70.0954 Q1248.22 70.0954 1249.25 69.3575 Q1250.31 68.5787 1250.31 66.1194 L1250.31 21.892 Q1250.31 19.4736 1249.25 18.7358 Q1248.18 17.957 1243.67 17.957 L1241.66 17.957 L1241.66 15.3337 L1271.3 15.3337 Q1279.78 15.3337 1285.44 20.0065 Q1291.1 24.6792 1291.1 30.9506 Q1291.1 37.181 1285.32 41.6898 Q1279.58 46.1576 1271.95 46.1576 L1257.77 46.1576 L1257.77 66.1194 Q1257.77 68.5378 1258.8 69.3166 Q1259.86 70.0954 1264.41 70.0954 L1266.42 70.0954 L1266.42 72.6777 Q1263.47 72.4317 1254 72.4317 Q1244.61 72.4317 1241.66 72.6777 M1257.53 43.9852 L1269.08 43.9852 Q1272.86 43.9852 1275.6 42.9195 Q1278.35 41.8537 1279.58 40.5831 Q1280.85 39.2714 1281.54 37.181 Q1282.28 35.0495 1282.36 33.9018 Q1282.45 32.7131 1282.45 30.9506 Q1282.45 29.1061 1282.36 27.9584 Q1282.28 26.7697 1281.54 24.6792 Q1280.85 22.5478 1279.58 21.2771 Q1278.35 19.9655 1275.6 18.9817 Q1272.9 17.957 1269.08 17.957 L1261.62 17.957 Q1258.75 17.957 1258.14 18.5308 Q1257.53 19.1047 1257.53 21.3181 L1257.53 43.9852 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M1309.61 68.1689 Q1304.08 62.6763 1304.08 54.7244 Q1304.08 46.7315 1309.49 40.911 Q1314.94 35.0495 1322.73 35.0495 Q1330.36 35.0495 1335.81 40.87 Q1341.3 46.6495 1341.3 54.7244 Q1341.3 62.6353 1335.77 68.1279 Q1330.27 73.6204 1322.65 73.6204 Q1315.19 73.6204 1309.61 68.1689 M1311.05 54.0276 Q1311.05 62.1844 1313.18 65.8735 Q1316.46 71.489 1322.73 71.489 Q1325.85 71.489 1328.43 69.8084 Q1331.05 68.1279 1332.49 65.2996 Q1334.33 61.6106 1334.33 54.0276 Q1334.33 45.9527 1332.12 42.3866 Q1328.84 36.935 1322.65 36.935 Q1319.94 36.935 1317.28 38.3696 Q1314.66 39.7633 1313.06 42.5506 Q1311.05 46.2396 1311.05 54.0276 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M1343.97 72.6777 L1343.97 70.0954 Q1348.44 70.0954 1349.46 69.5625 Q1350.49 68.9886 1350.49 66.2833 L1350.49 43.6983 Q1350.49 40.5831 1349.42 39.8453 Q1348.4 39.1075 1344.3 39.1075 L1344.3 36.4841 L1356.02 35.5824 L1356.02 66.3653 Q1356.02 68.8657 1356.92 69.4805 Q1357.83 70.0954 1361.93 70.0954 L1361.93 72.6777 Q1353.36 72.4317 1353.19 72.4317 Q1352.05 72.4317 1343.97 72.6777 M1347.5 20.9492 Q1347.5 19.2686 1348.77 17.916 Q1350.08 16.5224 1351.92 16.5224 Q1353.77 16.5224 1355.08 17.793 Q1356.39 19.0227 1356.39 20.9902 Q1356.39 22.9167 1355.08 24.1874 Q1353.77 25.417 1351.92 25.417 Q1350 25.417 1348.73 24.0644 Q1347.5 22.7117 1347.5 20.9492 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M1369.34 71.571 L1369.34 60.5039 Q1369.34 59.5611 1369.38 59.2332 Q1369.42 58.9053 1369.67 58.6593 Q1369.92 58.4134 1370.41 58.4134 Q1370.98 58.4134 1371.19 58.6593 Q1371.43 58.9053 1371.6 59.848 Q1372.87 65.6275 1375.57 68.7017 Q1378.32 71.7349 1383.28 71.7349 Q1387.99 71.7349 1390.37 69.6445 Q1392.75 67.554 1392.75 64.1109 Q1392.75 57.9625 1384.02 56.4049 Q1378.98 55.3802 1376.88 54.7244 Q1374.79 54.0276 1372.95 52.511 Q1369.34 49.5597 1369.34 45.3788 Q1369.34 41.1979 1372.5 38.1237 Q1375.7 35.0495 1382.75 35.0495 Q1387.46 35.0495 1390.66 37.4269 Q1391.6 36.6891 1392.09 36.0742 Q1393.2 35.0495 1393.77 35.0495 Q1394.43 35.0495 1394.55 35.5004 Q1394.67 35.9103 1394.67 37.099 L1394.67 45.5428 Q1394.67 46.4855 1394.63 46.8134 Q1394.59 47.1414 1394.35 47.3873 Q1394.1 47.5922 1393.57 47.5922 Q1392.62 47.5922 1392.58 46.8134 Q1391.93 36.6481 1382.75 36.6481 Q1377.79 36.6481 1375.57 38.5746 Q1373.36 40.4601 1373.36 43.0424 Q1373.36 44.4771 1374.02 45.5838 Q1374.71 46.6495 1375.57 47.3053 Q1376.47 47.9202 1378.11 48.535 Q1379.75 49.1088 1380.74 49.3138 Q1381.76 49.5187 1383.69 49.9286 Q1390.41 51.1993 1393.24 53.9456 Q1396.76 57.4707 1396.76 61.9385 Q1396.76 66.8982 1393.4 70.2593 Q1390.04 73.6204 1383.28 73.6204 Q1377.83 73.6204 1374.02 69.9724 Q1373.52 70.4643 1373.15 70.9151 Q1372.79 71.325 1372.62 71.489 Q1372.5 71.6529 1372.46 71.7759 Q1372.42 71.8579 1372.34 71.9399 Q1370.65 73.6204 1370.24 73.6204 Q1369.59 73.6204 1369.47 73.1695 Q1369.34 72.7597 1369.34 71.571 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M1421.77 97.9796 Q1421.77 97.6353 1422.02 97.4344 Q1422.31 97.2623 1423.17 96.8606 L1451.86 83.6907 Q1454.1 82.6291 1455.25 82.17 Q1454.07 81.7109 1451.86 80.6493 L1423.17 67.4795 Q1423.06 67.4221 1422.8 67.3073 Q1422.54 67.1925 1422.37 67.1065 Q1422.22 67.0204 1422.08 66.9056 Q1421.94 66.7621 1421.85 66.6474 Q1421.77 66.5326 1421.77 66.3605 Q1421.77 65.7866 1422.43 65.7866 Q1422.71 65.7866 1423.89 66.3605 L1456.48 81.2232 Q1456.54 81.2232 1456.68 81.3092 Q1456.86 81.3953 1456.97 81.5101 Q1457.09 81.5962 1457.2 81.6822 Q1457.32 81.7683 1457.37 81.8831 Q1457.43 81.9979 1457.43 82.17 Q1457.37 82.6865 1455.74 83.4612 L1423.89 97.9796 Q1422.71 98.5534 1422.43 98.5534 Q1421.77 98.5534 1421.77 97.9796 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M1483.34 78.067 Q1483.34 69.4306 1485.52 64.725 Q1488.56 57.724 1495.73 57.724 Q1497.25 57.724 1498.83 58.1544 Q1500.44 58.5561 1502.45 60.1342 Q1504.48 61.7123 1505.72 64.2946 Q1508.07 69.2871 1508.07 78.067 Q1508.07 86.646 1505.89 91.3229 Q1502.7 98.1517 1495.67 98.1517 Q1493.04 98.1517 1490.34 96.8032 Q1487.67 95.4546 1485.98 92.2124 Q1483.34 87.3634 1483.34 78.067 M1488.21 77.3497 Q1488.21 86.2157 1488.85 89.7448 Q1489.56 93.5609 1491.51 95.2251 Q1493.49 96.8606 1495.67 96.8606 Q1498.03 96.8606 1499.98 95.1103 Q1501.96 93.3314 1502.56 89.5153 Q1503.22 85.7566 1503.19 77.3497 Q1503.19 69.1723 1502.62 65.9014 Q1501.84 62.0853 1499.78 60.5646 Q1497.74 59.0152 1495.67 59.0152 Q1494.9 59.0152 1494.07 59.2447 Q1493.26 59.4743 1492.09 60.1342 Q1490.91 60.7941 1489.99 62.4296 Q1489.1 64.0651 1488.67 66.5326 Q1488.21 69.7175 1488.21 77.3497 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M1521.4 51.6912 Q1521.4 37.5089 1526.68 26.0729 Q1528.94 21.2771 1532.1 17.2602 Q1535.25 13.2432 1537.34 11.4807 Q1539.43 9.71814 1540.01 9.71814 Q1540.83 9.71814 1540.87 10.5379 Q1540.87 10.9478 1539.76 11.9726 Q1526.23 25.745 1526.27 51.6912 Q1526.27 77.7194 1539.43 90.9589 Q1540.87 92.3935 1540.87 92.8444 Q1540.87 93.6642 1540.01 93.6642 Q1539.43 93.6642 1537.42 91.9836 Q1535.42 90.3031 1532.3 86.4501 Q1529.18 82.5971 1526.93 77.8833 Q1521.4 66.4473 1521.4 51.6912 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M1548.93 72.6777 Q1548.93 71.1611 1549.05 70.7102 Q1549.21 70.2593 1549.87 69.5625 L1565.98 51.6092 Q1574.79 41.6898 1574.79 33.041 Q1574.79 27.4255 1571.84 23.4086 Q1568.93 19.3916 1563.56 19.3916 Q1559.87 19.3916 1556.76 21.646 Q1553.64 23.9004 1552.21 27.9174 Q1552.45 27.8354 1553.31 27.8354 Q1555.4 27.8354 1556.55 29.1471 Q1557.74 30.4587 1557.74 32.2213 Q1557.74 34.4757 1556.26 35.5824 Q1554.83 36.6481 1553.39 36.6481 Q1552.82 36.6481 1552.04 36.5251 Q1551.3 36.4022 1550.12 35.2545 Q1548.93 34.0658 1548.93 31.9753 Q1548.93 26.1139 1553.35 21.4411 Q1557.82 16.7683 1564.63 16.7683 Q1572.33 16.7683 1577.37 21.3591 Q1582.46 25.9089 1582.46 33.041 Q1582.46 35.5414 1581.68 37.8368 Q1580.94 40.0912 1579.91 41.8537 Q1578.93 43.6163 1576.23 46.4445 Q1573.52 49.2728 1571.35 51.2813 Q1569.18 53.2897 1564.3 57.5526 L1555.4 66.2014 L1570.53 66.2014 Q1577.91 66.2014 1578.48 65.5455 Q1579.3 64.3569 1580.32 58.0855 L1582.46 58.0855 L1580.08 72.6777 L1548.93 72.6777 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M1592.51 92.8444 Q1592.51 92.4345 1593.58 91.4098 Q1607.11 77.6374 1607.11 51.6912 Q1607.11 25.663 1594.11 12.5054 Q1592.51 10.9888 1592.51 10.5379 Q1592.51 9.71814 1593.33 9.71814 Q1593.91 9.71814 1595.92 11.3987 Q1597.97 13.0793 1601.04 16.9323 Q1604.16 20.7852 1606.45 25.499 Q1611.98 36.935 1611.98 51.6912 Q1611.98 65.8735 1606.7 77.3095 Q1604.44 82.1052 1601.29 86.1222 Q1598.13 90.1391 1596.04 91.9016 Q1593.95 93.6642 1593.33 93.6642 Q1592.51 93.6642 1592.51 92.8444 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><circle clip-path="url(#clip312)" cx="294.006" cy="173.254" r="14.4" fill="#78c2ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></circle>
<circle clip-path="url(#clip312)" cx="578.806" cy="173.254" r="14.4" fill="#78c2ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></circle>
<circle clip-path="url(#clip312)" cx="863.606" cy="678.388" r="14.4" fill="#78c2ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></circle>
<circle clip-path="url(#clip312)" cx="1148.41" cy="1183.52" r="14.4" fill="#78c2ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></circle>
<circle clip-path="url(#clip312)" cx="1433.21" cy="1486.6" r="14.4" fill="#78c2ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></circle>
<circle clip-path="url(#clip312)" cx="1718" cy="1621.3" r="14.4" fill="#78c2ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></circle>
<circle clip-path="url(#clip312)" cx="2002.8" cy="1669.41" r="14.4" fill="#78c2ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></circle>
<circle clip-path="url(#clip312)" cx="2287.6" cy="1683.84" r="14.4" fill="#78c2ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></circle>
<circle clip-path="url(#clip312)" cx="2572.4" cy="1687.59" r="14.4" fill="#78c2ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></circle>
<polyline clip-path="url(#clip312)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="294.006,1688.65 294.006,173.254 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="578.806,1688.65 578.806,173.254 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="863.606,1688.65 863.606,678.388 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1148.41,1688.65 1148.41,1183.52 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1433.21,1688.65 1433.21,1486.6 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1718,1688.65 1718,1621.3 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="2002.8,1688.65 2002.8,1669.41 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="2287.6,1688.65 2287.6,1683.84 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="2572.4,1688.65 2572.4,1687.59 "></polyline>
<path clip-path="url(#clip310)" d="M1944.69 285.016 L2560.25 285.016 L2560.25 181.336 L1944.69 181.336  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1944.69,285.016 2560.25,285.016 2560.25,181.336 1944.69,181.336 1944.69,285.016 "></polyline>
<circle clip-path="url(#clip310)" cx="2052.03" cy="233.176" r="20.48" fill="#78c2ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="5.46133"></circle>
<path clip-path="url(#clip310)" d="M2159.37 215.896 L2188.61 215.896 L2188.61 219.831 L2176.34 219.831 L2176.34 250.456 L2171.64 250.456 L2171.64 219.831 L2159.37 219.831 L2159.37 215.896 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2214.48 234.808 L2214.48 250.456 L2210.23 250.456 L2210.23 234.947 Q2210.23 231.267 2208.79 229.438 Q2207.35 227.609 2204.48 227.609 Q2201.04 227.609 2199.04 229.808 Q2197.05 232.007 2197.05 235.804 L2197.05 250.456 L2192.77 250.456 L2192.77 214.438 L2197.05 214.438 L2197.05 228.558 Q2198.58 226.22 2200.64 225.063 Q2202.73 223.906 2205.43 223.906 Q2209.9 223.906 2212.19 226.683 Q2214.48 229.438 2214.48 234.808 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2245.16 236.429 L2245.16 238.512 L2225.57 238.512 Q2225.85 242.91 2228.21 245.225 Q2230.6 247.516 2234.83 247.516 Q2237.29 247.516 2239.58 246.915 Q2241.89 246.313 2244.16 245.109 L2244.16 249.137 Q2241.87 250.109 2239.46 250.618 Q2237.05 251.128 2234.58 251.128 Q2228.37 251.128 2224.74 247.516 Q2221.13 243.905 2221.13 237.748 Q2221.13 231.382 2224.55 227.655 Q2228 223.906 2233.84 223.906 Q2239.07 223.906 2242.1 227.285 Q2245.16 230.642 2245.16 236.429 M2240.9 235.179 Q2240.85 231.683 2238.93 229.6 Q2237.03 227.517 2233.88 227.517 Q2230.32 227.517 2228.17 229.53 Q2226.04 231.544 2225.71 235.202 L2240.9 235.179 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2262.19 227.517 Q2258.77 227.517 2256.78 230.202 Q2254.79 232.864 2254.79 237.517 Q2254.79 242.169 2256.75 244.854 Q2258.74 247.516 2262.19 247.516 Q2265.6 247.516 2267.59 244.831 Q2269.58 242.146 2269.58 237.517 Q2269.58 232.91 2267.59 230.225 Q2265.6 227.517 2262.19 227.517 M2262.19 223.906 Q2267.75 223.906 2270.92 227.517 Q2274.09 231.128 2274.09 237.517 Q2274.09 243.882 2270.92 247.516 Q2267.75 251.128 2262.19 251.128 Q2256.61 251.128 2253.44 247.516 Q2250.29 243.882 2250.29 237.517 Q2250.29 231.128 2253.44 227.517 Q2256.61 223.906 2262.19 223.906 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2296.17 228.512 Q2295.46 228.095 2294.6 227.91 Q2293.77 227.702 2292.75 227.702 Q2289.14 227.702 2287.19 230.063 Q2285.27 232.401 2285.27 236.799 L2285.27 250.456 L2280.99 250.456 L2280.99 224.531 L2285.27 224.531 L2285.27 228.558 Q2286.61 226.197 2288.77 225.063 Q2290.92 223.906 2294 223.906 Q2294.44 223.906 2294.97 223.975 Q2295.5 224.021 2296.15 224.137 L2296.17 228.512 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2321.78 236.429 L2321.78 238.512 L2302.19 238.512 Q2302.47 242.91 2304.83 245.225 Q2307.22 247.516 2311.45 247.516 Q2313.91 247.516 2316.2 246.915 Q2318.51 246.313 2320.78 245.109 L2320.78 249.137 Q2318.49 250.109 2316.08 250.618 Q2313.67 251.128 2311.2 251.128 Q2304.99 251.128 2301.36 247.516 Q2297.75 243.905 2297.75 237.748 Q2297.75 231.382 2301.17 227.655 Q2304.62 223.906 2310.46 223.906 Q2315.69 223.906 2318.72 227.285 Q2321.78 230.642 2321.78 236.429 M2317.52 235.179 Q2317.47 231.683 2315.55 229.6 Q2313.65 227.517 2310.5 227.517 Q2306.94 227.517 2304.79 229.53 Q2302.66 231.544 2302.33 235.202 L2317.52 235.179 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2332.98 217.169 L2332.98 224.531 L2341.75 224.531 L2341.75 227.841 L2332.98 227.841 L2332.98 241.915 Q2332.98 245.086 2333.84 245.989 Q2334.72 246.891 2337.38 246.891 L2341.75 246.891 L2341.75 250.456 L2337.38 250.456 Q2332.45 250.456 2330.57 248.628 Q2328.7 246.776 2328.7 241.915 L2328.7 227.841 L2325.57 227.841 L2325.57 224.531 L2328.7 224.531 L2328.7 217.169 L2332.98 217.169 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2347.35 224.531 L2351.61 224.531 L2351.61 250.456 L2347.35 250.456 L2347.35 224.531 M2347.35 214.438 L2351.61 214.438 L2351.61 219.831 L2347.35 219.831 L2347.35 214.438 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2379.18 225.526 L2379.18 229.507 Q2377.38 228.512 2375.55 228.026 Q2373.74 227.517 2371.89 227.517 Q2367.75 227.517 2365.46 230.155 Q2363.16 232.771 2363.16 237.517 Q2363.16 242.262 2365.46 244.901 Q2367.75 247.516 2371.89 247.516 Q2373.74 247.516 2375.55 247.03 Q2377.38 246.521 2379.18 245.526 L2379.18 249.461 Q2377.4 250.294 2375.48 250.711 Q2373.58 251.128 2371.43 251.128 Q2365.57 251.128 2362.12 247.447 Q2358.67 243.767 2358.67 237.517 Q2358.67 231.174 2362.15 227.54 Q2365.64 223.906 2371.71 223.906 Q2373.67 223.906 2375.55 224.322 Q2377.42 224.716 2379.18 225.526 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2398.37 237.424 Q2393.21 237.424 2391.22 238.604 Q2389.23 239.785 2389.23 242.632 Q2389.23 244.901 2390.71 246.243 Q2392.22 247.563 2394.78 247.563 Q2398.33 247.563 2400.46 245.063 Q2402.61 242.54 2402.61 238.373 L2402.61 237.424 L2398.37 237.424 M2406.87 235.665 L2406.87 250.456 L2402.61 250.456 L2402.61 246.521 Q2401.15 248.882 2398.97 250.016 Q2396.8 251.128 2393.65 251.128 Q2389.67 251.128 2387.31 248.905 Q2384.97 246.66 2384.97 242.91 Q2384.97 238.535 2387.89 236.313 Q2390.83 234.091 2396.64 234.091 L2402.61 234.091 L2402.61 233.674 Q2402.61 230.734 2400.66 229.137 Q2398.74 227.517 2395.25 227.517 Q2393.03 227.517 2390.92 228.049 Q2388.81 228.581 2386.87 229.646 L2386.87 225.711 Q2389.21 224.808 2391.4 224.368 Q2393.6 223.906 2395.69 223.906 Q2401.31 223.906 2404.09 226.822 Q2406.87 229.739 2406.87 235.665 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2415.64 214.438 L2419.9 214.438 L2419.9 250.456 L2415.64 250.456 L2415.64 214.438 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2448.74 219.739 L2448.74 232.725 L2454.62 232.725 Q2457.89 232.725 2459.67 231.035 Q2461.45 229.345 2461.45 226.22 Q2461.45 223.118 2459.67 221.429 Q2457.89 219.739 2454.62 219.739 L2448.74 219.739 M2444.07 215.896 L2454.62 215.896 Q2460.43 215.896 2463.4 218.535 Q2466.38 221.151 2466.38 226.22 Q2466.38 231.336 2463.4 233.952 Q2460.43 236.567 2454.62 236.567 L2448.74 236.567 L2448.74 250.456 L2444.07 250.456 L2444.07 215.896 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2472.65 215.896 L2479.62 215.896 L2488.44 239.415 L2497.31 215.896 L2504.27 215.896 L2504.27 250.456 L2499.71 250.456 L2499.71 220.109 L2490.8 243.813 L2486.1 243.813 L2477.19 220.109 L2477.19 250.456 L2472.65 250.456 L2472.65 215.896 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2513.56 215.896 L2533.42 215.896 L2533.42 219.831 L2518.23 219.831 L2518.23 230.017 L2531.94 230.017 L2531.94 233.952 L2518.23 233.952 L2518.23 250.456 L2513.56 250.456 L2513.56 215.896 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
</section>
</section>
</section>
<section id="pdmp-によるベイズ競合リスク分析" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="pdmp-によるベイズ競合リスク分析"><span class="header-section-number">2</span> PDMP によるベイズ競合リスク分析</h2>
<section id="はじめに" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="はじめに"><span class="header-section-number">2.1</span> はじめに</h3>
<p>前節で定義されたモデルのパラメータ空間 <span class="math display">\[
(K,D,\gamma,\phi,\theta)
\]</span> 上での事後分布サンプリングを行うことを考える．<span class="math inline">\(\phi=(\omega,\sigma_\beta)\)</span> はハイパーパラメータである．</p>
<p>基本的には <span class="math inline">\(\theta=(\theta_k)=(\nu_k,\mu_k)\)</span> の事後分布サンプリングを考えるのであるが，<span class="math inline">\(K,\gamma\)</span> の如何によって <span class="math inline">\(\theta\)</span> の次元が変化する．</p>
<p>加えて <span class="math inline">\(D\)</span> の如何によって尤度が変化するから，Poisson 点過程の強度関数に解析的な上界が見つかるはずもないため，Automatic Zig-Zag <span class="citation" data-cites="Corbella+2022">(<a href="#ref-Corbella+2022" role="doc-biblioref">Corbella et al., 2022</a>)</span> と Concave-Convex PDMP <span class="citation" data-cites="Sutton-Fearnhead2023">(<a href="#ref-Sutton-Fearnhead2023" role="doc-biblioref">Sutton and Fearnhead, 2023</a>)</span> を組み合わせて用いる．</p>
</section>
<section id="sec-theta" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="sec-theta"><span class="header-section-number">2.2</span> <span class="math inline">\(\theta\)</span> の Zig-Zag サンプリング</h3>
<p>polyhazard model の標準的なサンプラーには Gibbs サンプラーや NUTS サンプラーがあり得るが，いずれも複数の次元の間を飛び回れるように拡張するには，空間の間の跳躍をうまく設計する必要がある．</p>
<p>この点で Zig-Zag サンプラーは従来のサンプリング法と対等であるが，今回の設定には多峰性の懸念も存在する．</p>
<p>というのも，<span class="math inline">\(D\)</span> によって指定される分布は互いに交換可能であるため，混合モデリングにおける label switching problem <span class="citation" data-cites="Jasra+2005">(<a href="#ref-Jasra+2005" role="doc-biblioref">Jasra et al., 2005</a>)</span> 同様に事後分布は必然的に多峰性（対称性）を帯びるはずである．</p>
<p>多峰性への対処という点では，Zig-Zag サンプラーに軍配が上がるはずである <span class="citation" data-cites="Andrieu-Livingstone2021">(<a href="#ref-Andrieu-Livingstone2021" role="doc-biblioref">Andrieu and Livingstone, 2021</a>)</span>．</p>
</section>
<section id="ハイパーパラメータ-phi-のサンプリング" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="ハイパーパラメータ-phi-のサンプリング"><span class="header-section-number">2.3</span> ハイパーパラメータ <span class="math inline">\(\phi\)</span> のサンプリング</h3>
<p><span class="math inline">\((\theta,\phi)\)</span> 上から結合分布を Zig-Zag サンプリングすることも可能であるが，<span class="math inline">\(\theta\)</span> は <span class="math inline">\(\phi\)</span> に依存するため，事後分布は強い相関構造を持つと予想される．</p>
<p>一方でこの条件付き構造は Gibbs サンプラーの発想で有効に利用したいものである．これには Zig-Zag within Gibbs <span class="citation" data-cites="Sachs+2023">(<a href="#ref-Sachs+2023" role="doc-biblioref">Sachs et al., 2023</a>)</span> を用いることができる．</p>
<p>この方法によれば，ハイパーパラメータ <span class="math inline">\(\phi=(\omega,\sigma_\beta)\)</span> を固定した下で他の変数をサンプリングすることになる．この設定では次に論じるように変数選択の指示変数 <span class="math inline">\(\gamma\)</span> に対する効率的なシミュレーション法も導く．</p>
</section>
<section id="変数選択-gamma-のサンプリング" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="変数選択-gamma-のサンプリング"><span class="header-section-number">2.4</span> 変数選択 <span class="math inline">\(\gamma\)</span> のサンプリング</h3>
<p>一般にベイズ変数選択は <span class="math inline">\(\gamma\)</span> のような指示変数のサンプリングに問題を帰着させる方法 <span class="citation" data-cites="Zanella2020">(<a href="#ref-Zanella2020" role="doc-biblioref">Zanella, 2020</a>)</span> が state-of-the-art とされる．</p>
<p>しかし各 <span class="math inline">\(\gamma\in 2^{Kp}\)</span> に対応するモデルの（周辺）尤度の計算が困難な場面は多く，特に今回の生存モデルはその一例である <span class="citation" data-cites="Liang+2023">(<a href="#ref-Liang+2023" role="doc-biblioref">Liang et al., 2023</a>)</span>．</p>
<p>しかし Zig-Zag サンプラーでは <span class="math inline">\(\{\beta_{k,j}=0\}\)</span> のなす部分空間を通過する際に一定の確率でランダムな時間ここに囚われることで，自然な形で trans-dimensional なサンプリングが可能になることが <span class="citation" data-cites="Chevallier+2023">(<a href="#ref-Chevallier+2023" role="doc-biblioref">Chevallier et al., 2023</a>)</span>, <span class="citation" data-cites="Bierkens+2023">(<a href="#ref-Bierkens+2023" role="doc-biblioref">Bierkens et al., 2023</a>)</span> により同時に提案されている．</p>
<p>この際 <span class="math inline">\(\{\beta_{k,j}=0\}\)</span> から脱出する確率は時刻や位置に依らず（ハイパーパラメータ <span class="math inline">\(\omega\)</span> の下で）一定であり，一様な Poisson 点過程のシミュレーションにより実現される．この意味で Zig-Zag サンプラーによる変数選択は，周辺尤度の計算を回避した効率的な計算法を提供する．</p>
</section>
<section id="kd-のサンプリング" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="kd-のサンプリング"><span class="header-section-number">2.5</span> <span class="math inline">\(K,D\)</span> のサンプリング</h3>
<p>ここでは birth-death-swap 過程を用いる．というのも，３つの Poisson 点過程 <span class="math inline">\(\Lambda^b,\Lambda^d,\Lambda^s\)</span> を用いて，これが到着するごとに確率核 <span class="math inline">\(q_b,q_d,q_s\)</span> に従って新たなハザード関数の追加・消去・取り替えが起こる．</p>
<p>取り替えは必ずしも必要がないが，これの追加により多峰性の問題 <a href="#sec-theta" class="quarto-xref">2.2</a> が解決され，サンプラーの収束が改善されるという．</p>
<p>birth-death 過程は次の詳細釣り合い条件を満たせば良い： <span class="math display">\[
\Lambda^b(t)\pi(\theta,D,K)q_b(u)=\Lambda^d(t)\pi(\theta',D',K')q_d(u').
\]</span></p>
<p>この方法は Zig-Zag within Gibbs <span class="citation" data-cites="Sachs+2023">(<a href="#ref-Sachs+2023" role="doc-biblioref">Sachs et al., 2023</a>)</span> の Gibbs 核を，<span class="citation" data-cites="Green1995">(<a href="#ref-Green1995" role="doc-biblioref">Green, 1995</a>)</span> の超次元跳躍核に取り替えていることに等しい．</p>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="文献紹介" class="level2 appendix" data-number="3"><h2 class="quarto-appendix-heading"></h2><div class="quarto-appendix-contents">





</div></section><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">3 文献紹介</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Andrieu-Livingstone2021" class="csl-entry" role="listitem">
Andrieu, C., and Livingstone, S. (2021). <a href="https://doi.org/10.1214/20-AOS2008"><span class="nocase">Peskun–Tierney ordering for Markovian Monte Carlo: Beyond the reversible scenario</span></a>. <em>The Annals of Statistics</em>, <em>49</em>(4), 1958–1981.
</div>
<div id="ref-Bierkens+2023" class="csl-entry" role="listitem">
Bierkens, J., Grazzi, S., Meulen, F. van der, and Schauer, M. (2023). <a href="https://doi.org/10.1007/s11222-022-10180-5"><span class="nocase">Sticky PDMP Samplers for Sparse and Local Inference Problems</span></a>. <em>Statistics and Computing</em>, <em>33</em>(1), 8.
</div>
<div id="ref-Chevallier+2023" class="csl-entry" role="listitem">
Chevallier, A., Fearnhead, P., and Sutton, M. (2023). <a href="https://doi.org/10.1080/01621459.2022.2099402">Reversible jump PDMP samplers for variable selection</a>. <em>Journal of the American Statistical Association</em>, <em>118</em>(544), 2915–2927.
</div>
<div id="ref-Corbella+2022" class="csl-entry" role="listitem">
Corbella, A., Spencer, S. E. F., and Roberts, G. O. (2022). <a href="https://doi.org/10.1007/s11222-022-10142-x"><span class="nocase">Automatic Zig-Zag Sampling in Practice</span></a>. <em>Statistics and Computing</em>, <em>32</em>(6), 107.
</div>
<div id="ref-Gelman2006" class="csl-entry" role="listitem">
Gelman, A. (2006). <a href="https://doi.org/10.1214/06-BA117A"><span class="nocase">Prior distributions for variance parameters in hierarchical models (comment on article by Browne and Draper)</span></a>. <em>Bayesian Analysis</em>, <em>1</em>(3), 515–534.
</div>
<div id="ref-Green1995" class="csl-entry" role="listitem">
Green, P. J. (1995). <a href="http://www.jstor.org/stable/2337340">Reversible jump markov chain monte carlo computation and bayesian model determination</a>. <em>Biometrika</em>, <em>82</em>(4), 711–732.
</div>
<div id="ref-Hardcastle+2024" class="csl-entry" role="listitem">
Hardcastle, L., Livingstone, S., and Baio, G. (2024). <a href="https://arxiv.org/abs/2406.14182">Averaging polyhazard models using piecewise deterministic monte carlo with applications to data with long-term survivors</a>.
</div>
<div id="ref-Jasra+2005" class="csl-entry" role="listitem">
Jasra, A., Holmes, C. C., and Stephens, D. A. (2005). <a href="https://doi.org/10.1214/088342305000000016"><span class="nocase">Markov Chain Monte Carlo Methods and the Label Switching Problem in Bayesian Mixture Modeling</span></a>. <em>Statistical Science</em>, <em>20</em>(1), 50–67.
</div>
<div id="ref-Ley-Steel2009" class="csl-entry" role="listitem">
Ley, E., and Steel, M. F. J. (2009). <a href="https://doi.org/10.1002/jae.1057">On the effect of prior assumptions in bayesian model averaging with applications to growth regression</a>. <em>Journal of Applied Econometrics</em>, <em>24</em>(4), 651–674.
</div>
<div id="ref-Liang+2023" class="csl-entry" role="listitem">
Liang, X., Livingstone, S., and Griffin, J. (2023). <a href="https://doi.org/10.3390/e25091310">Adaptive MCMC for bayesian variable selection in generalised linear models and survival models</a>. <em>Entropy</em>, <em>25</em>(9).
</div>
<div id="ref-Mitchell-Beauchamp1988" class="csl-entry" role="listitem">
Mitchell, T. J., and Beauchamp, J. J. (1988). <a href="http://www.jstor.org/stable/2290129">Bayesian variable selection in linear regression</a>. <em>Journal of the American Statistical Association</em>, <em>83</em>(404), 1023–1032.
</div>
<div id="ref-Polson-Scott2012" class="csl-entry" role="listitem">
Polson, N. G., and Scott, J. G. (2012). <a href="https://doi.org/10.1214/12-BA730"><span class="nocase">On the Half-Cauchy Prior for a Global Scale Parameter</span></a>. <em>Bayesian Analysis</em>, <em>7</em>(4), 887–902.
</div>
<div id="ref-Sachs+2023" class="csl-entry" role="listitem">
Sachs, M., Sen, D., Lu, J., and Dunson, D. (2023). <a href="https://doi.org/10.1214/22-BA1319"><span class="nocase">Posterior Computation with the Gibbs Zig-Zag Sampler</span></a>. <em>Bayesian Analysis</em>, <em>18</em>(3), 909–927.
</div>
<div id="ref-Sutton-Fearnhead2023" class="csl-entry" role="listitem">
Sutton, M., and Fearnhead, P. (2023). <a href="https://doi.org/10.1080/10618600.2023.2203735"><span class="nocase">Concave-Convex PDMP-based Sampling</span></a>. <em>Journal of Computational and Graphical Statistics</em>, <em>32</em>(4), 1425–1435.
</div>
<div id="ref-Zanella2020" class="csl-entry" role="listitem">
Zanella, G. (2020). <a href="https://doi.org/10.1080/01621459.2019.1585255">Informed proposals for local MCMC in discrete spaces</a>. <em>Journal of the American Statistical Association</em>, <em>115</em>(530), 852–865.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/162348\.github\.io\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
        for (let i=0; i<annoteTargets.length; i++) {
          const annoteTarget = annoteTargets[i];
          const targetCell = annoteTarget.getAttribute("data-target-cell");
          const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
          const contentFn = () => {
            const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            if (content) {
              const tipContent = content.cloneNode(true);
              tipContent.classList.add("code-annotation-tip-content");
              return tipContent.outerHTML;
            }
          }
          const config = {
            allowHTML: true,
            content: contentFn,
            onShow: (instance) => {
              selectCodeLines(instance.reference);
              instance.reference.classList.add('code-annotation-active');
              window.tippy.hideAll();
            },
            onHide: (instance) => {
              unselectCodeLines();
              instance.reference.classList.remove('code-annotation-active');
            },
            maxWidth: 300,
            delay: [50, 0],
            duration: [200, 0],
            offset: [5, 10],
            arrow: true,
            trigger: 'click',
            appendTo: function(el) {
              return el.parentElement.parentElement.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'quarto',
            placement: 'right',
            positionFixed: true,
            popperOptions: {
              modifiers: [
              {
                name: 'flip',
                options: {
                  flipVariations: false, // true by default
                  allowedAutoPlacements: ['right'],
                  fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                },
              },
              {
                name: 'preventOverflow',
                options: {
                  mainAxis: false,
                  altAxis: false
                }
              }
              ]        
            }      
          };
          window.tippy(annoteTarget, config); 
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
<script>
  function loadGiscus() {
    // Function to get the theme based on body class
    const getTheme = () => {
      let baseTheme = document.getElementById('giscus-base-theme').value;
      let altTheme = document.getElementById('giscus-alt-theme').value;
      return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
    };
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "162348/162348.github.io";
    script.dataset.repoId = "R_kgDOKlfKYQ";
    script.dataset.category = "Announcements";
    script.dataset.categoryId = "DIC_kwDOKlfKYc4CgDmb";
    script.dataset.mapping = "pathname";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "top";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  }
  loadGiscus();
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://162348.github.io/">
<p>Hirofumi Shiba</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/162348/162348.github.io/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ano2math5">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:shiba.hirofumi@ism.ac.jp">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../../blog.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>