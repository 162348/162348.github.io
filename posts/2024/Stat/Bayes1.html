<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="司馬博文">

<title>ベイズ統計学と統計物理学 – Hirofumi Shiba</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../assets/Shiba2.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-listing/list.min.js"></script>
<script src="../../../site_libs/quarto-listing/quarto-listing.js"></script>
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-efd6ff7163e34c65f10ccb003a1f55f5.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark-4b10d88bc01b3c2b62a30403842a2cd1.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-efd6ff7163e34c65f10ccb003a1f55f5.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-4c09742be2272f701a3e51422777528f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark-4c09742be2272f701a3e51422777528f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-4c09742be2272f701a3e51422777528f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "?",
    "H"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>

  window.document.addEventListener("DOMContentLoaded", function (_event) {
    const listingTargetEl = window.document.querySelector('#listing-lst-Bayes .list');
    if (!listingTargetEl) {
      // No listing discovered, do not attach.
      return; 
    }

    const options = {
      valueNames: ['listing-title','listing-image','listing-date','listing-subtitle',{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
      
      searchColumns: ["listing-title","listing-author","listing-date","listing-image","listing-description"],
    };

    window['quarto-listings'] = window['quarto-listings'] || {};
    window['quarto-listings']['listing-lst-Bayes'] = new List('listing-lst-Bayes', options);

    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  });

  window.addEventListener('hashchange',() => {
    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  })
  

  window.document.addEventListener("DOMContentLoaded", function (_event) {
    const listingTargetEl = window.document.querySelector('#listing-lst-Bayes2 .list');
    if (!listingTargetEl) {
      // No listing discovered, do not attach.
      return; 
    }

    const options = {
      valueNames: ['listing-title','listing-image','listing-date','listing-subtitle',{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
      
      searchColumns: ["listing-date","listing-title","listing-author","listing-subtitle","listing-image","listing-description"],
    };

    window['quarto-listings'] = window['quarto-listings'] || {};
    window['quarto-listings']['listing-lst-Bayes2'] = new List('listing-lst-Bayes2', options);

    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  });

  window.addEventListener('hashchange',() => {
    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  })
  

  window.document.addEventListener("DOMContentLoaded", function (_event) {
    const listingTargetEl = window.document.querySelector('#listing-lst-Bayes22 .list');
    if (!listingTargetEl) {
      // No listing discovered, do not attach.
      return; 
    }

    const options = {
      valueNames: ['listing-title','listing-image','listing-date','listing-subtitle',{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
      
      searchColumns: ["listing-date","listing-title","listing-author","listing-subtitle","listing-image","listing-description"],
    };

    window['quarto-listings'] = window['quarto-listings'] || {};
    window['quarto-listings']['listing-lst-Bayes22'] = new List('listing-lst-Bayes22', options);

    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  });

  window.addEventListener('hashchange',() => {
    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  })
  </script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-36GX2G6GLL"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-36GX2G6GLL', { 'anonymize_ip': true});
</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Zen+Kurenaido&amp;display=swap" rel="stylesheet">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=BIZ+UDPGothic&amp;display=swap" rel="stylesheet">

<style>
  h1, .title, .description, .subtitle {
    font-family: "Zen Kurenaido", sans-serif !important;
  }
</style>

<!-- <style>
  .menu-text {
      font-family: "Gill Sans", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
  .navbar-title {
      font-family: "Gill Sans", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
</style> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../assets/styles.css">
<meta property="og:title" content="ベイズ統計学と統計物理学 – Hirofumi Shiba">
<meta property="og:description" content="ノイズ付きで観測された情報を復元するデノイジング問題は，ベイズ推定問題として扱える．これを統計力学の観点からランダムエネルギーモデルとして解析することで，データ数無限大の極限における振る舞いを理解できる．一般に，ベイズ統計モデルはスピングラスモデルと同一視することができ，その漸近論（特に比例的高次元極限）に閾値現象が出現することはスピングラス系の常磁性相とスピングラス相の相転移と深い対応を持つ．">
<meta property="og:image" content="https://162348.github.io/posts/2024/Stat/posterior.svg">
<meta property="og:site_name" content="Hirofumi Shiba">
<meta name="twitter:title" content="ベイズ統計学と統計物理学 – Hirofumi Shiba">
<meta name="twitter:description" content="ノイズ付きで観測された情報を復元するデノイジング問題は，ベイズ推定問題として扱える．これを統計力学の観点からランダムエネルギーモデルとして解析することで，データ数無限大の極限における振る舞いを理解できる．一般に，ベイズ統計モデルはスピングラスモデルと同一視することができ，その漸近論（特に比例的高次元極限）に閾値現象が出現することはスピングラス系の常磁性相とスピングラス相の相転移と深い対応を持つ．">
<meta name="twitter:image" content="https://162348.github.io/posts/2024/Stat/posterior.svg">
<meta name="twitter:creator" content="@ano2math5">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Hirofumi Shiba</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-notes" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Notes</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-notes">    
        <li>
    <a class="dropdown-item" href="../../../static/English.html">
 <span class="dropdown-text">English Notes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../blog.html">
 <span class="dropdown-text">ノート (Japanese)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Materials.html"> 
<span class="menu-text">Materials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/162348/162348.github.io/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">ベイズ統計学と統計物理学</h1>
            <p class="subtitle lead">スパース符号の復元を題材として</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Bayesian</div>
                <div class="quarto-category">Nature</div>
                <div class="quarto-category">Information</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>司馬博文 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">6/20/2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">6/28/2024</p>
      </div>
    </div>
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="block-title">概要</div>
      ノイズ付きで観測された情報を復元するデノイジング問題は，ベイズ推定問題として扱える．これを統計力学の観点からランダムエネルギーモデルとして解析することで，データ数無限大の極限における振る舞いを理解できる．一般に，ベイズ統計モデルはスピングラスモデルと同一視することができ，その漸近論（特に比例的高次元極限）に閾値現象が出現することはスピングラス系の常磁性相とスピングラス相の相転移と深い対応を持つ．
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目次</h2>
   
  <ul>
  <li><a href="#bayes-推定" id="toc-bayes-推定" class="nav-link active" data-scroll-target="#bayes-推定"><span class="header-section-number">1</span> Bayes 推定</a>
  <ul class="collapse">
  <li><a href="#デノイジング問題としての設定" id="toc-デノイジング問題としての設定" class="nav-link" data-scroll-target="#デノイジング問題としての設定"><span class="header-section-number">1.1</span> デノイジング問題としての設定</a></li>
  <li><a href="#sec-example" id="toc-sec-example" class="nav-link" data-scroll-target="#sec-example"><span class="header-section-number">1.2</span> 例：Delta-Gauss 混合</a></li>
  <li><a href="#map-推定量" id="toc-map-推定量" class="nav-link" data-scroll-target="#map-推定量"><span class="header-section-number">1.3</span> MAP 推定量</a></li>
  <li><a href="#ベイズ最適推定量" id="toc-ベイズ最適推定量" class="nav-link" data-scroll-target="#ベイズ最適推定量"><span class="header-section-number">1.4</span> ベイズ最適推定量</a></li>
  </ul></li>
  <li><a href="#統計物理からの視点" id="toc-統計物理からの視点" class="nav-link" data-scroll-target="#統計物理からの視点"><span class="header-section-number">2</span> 統計物理からの視点</a>
  <ul class="collapse">
  <li><a href="#sec-straightforward-identification" id="toc-sec-straightforward-identification" class="nav-link" data-scroll-target="#sec-straightforward-identification"><span class="header-section-number">2.1</span> 事後分布をある物理系の平衡分布と見る</a></li>
  <li><a href="#sec-identification" id="toc-sec-identification" class="nav-link" data-scroll-target="#sec-identification"><span class="header-section-number">2.2</span> もう一つの見方</a></li>
  <li><a href="#sec-Nishimori-symmetry" id="toc-sec-Nishimori-symmetry" class="nav-link" data-scroll-target="#sec-Nishimori-symmetry"><span class="header-section-number">2.3</span> 西森対称性</a></li>
  <li><a href="#sec-MMSE-via-Nishimori" id="toc-sec-MMSE-via-Nishimori" class="nav-link" data-scroll-target="#sec-MMSE-via-Nishimori"><span class="header-section-number">2.4</span> 最小自乗誤差推定量</a></li>
  <li><a href="#sec-I-MMSE" id="toc-sec-I-MMSE" class="nav-link" data-scroll-target="#sec-I-MMSE"><span class="header-section-number">2.5</span> KL 乖離度の微分としての分散</a></li>
  <li><a href="#sec-Steins-lemma" id="toc-sec-Steins-lemma" class="nav-link" data-scroll-target="#sec-Steins-lemma"><span class="header-section-number">2.6</span> Stein の補題</a></li>
  </ul></li>
  <li><a href="#sec-sparse-vector-denoising" id="toc-sec-sparse-vector-denoising" class="nav-link" data-scroll-target="#sec-sparse-vector-denoising"><span class="header-section-number">3</span> スパースベクトルの復号</a>
  <ul class="collapse">
  <li><a href="#sec-settings" id="toc-sec-settings" class="nav-link" data-scroll-target="#sec-settings"><span class="header-section-number">3.1</span> 設定</a></li>
  <li><a href="#スピングラス系との同一視" id="toc-スピングラス系との同一視" class="nav-link" data-scroll-target="#スピングラス系との同一視"><span class="header-section-number">3.2</span> スピングラス系との同一視</a></li>
  <li><a href="#自由エネルギー密度の計算" id="toc-自由エネルギー密度の計算" class="nav-link" data-scroll-target="#自由エネルギー密度の計算"><span class="header-section-number">3.3</span> 自由エネルギー密度の計算</a></li>
  <li><a href="#sec-bounds-on-Phi" id="toc-sec-bounds-on-Phi" class="nav-link" data-scroll-target="#sec-bounds-on-Phi"><span class="header-section-number">3.4</span> 自由エネルギーの上下評価</a></li>
  <li><a href="#解釈" id="toc-解釈" class="nav-link" data-scroll-target="#解釈"><span class="header-section-number">3.5</span> 解釈</a></li>
  <li><a href="#自由エネルギーのさらに鋭い評価" id="toc-自由エネルギーのさらに鋭い評価" class="nav-link" data-scroll-target="#自由エネルギーのさらに鋭い評価"><span class="header-section-number">3.6</span> 自由エネルギーのさらに鋭い評価</a></li>
  <li><a href="#まとめ" id="toc-まとめ" class="nav-link" data-scroll-target="#まとめ"><span class="header-section-number">3.7</span> まとめ</a></li>
  </ul></li>
  
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
<p>$$</p>
<p>$$</p>
</div>
<p>本稿では全ての結果に数学的に厳密な証明をつけることを優先し，簡単なモデルを取り上げた．</p>
<p>一般のモデルと，スピングラス理論との大局観は，次稿を参照：</p>
<div id="listing-lst-Bayes" class="listing quarto-float quarto-figure quarto-figure-left quarto-listing quarto-listing-container-grid anchored">
<div class="list grid quarto-listing-cols-3">
<div class="g-col-1" data-index="0" data-categories="QmF5ZXNpYW4lMkNOYXR1cmUlMkNJbmZvcm1hdGlvbg==" data-listing-date-sort="1719100800000" data-listing-file-modified-sort="1768808202244" data-listing-date-modified-sort="1719532800000" data-listing-reading-time-sort="8" data-listing-word-count-sort="1507">
<a href="../../../posts/2024/Stat/Bayes2.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/Stat/phase_regular_rev.jpeg" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
ベイズ統計学とスピングラス
</h5>
<div class="card-subtitle listing-subtitle">
誤り訂正符号を題材にして
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-06-23
</div>
</div>
</div>
</div></a>
</div>
<div class="g-col-1" data-index="1" data-categories="QmF5ZXNpYW4lMkNOYXR1cmUlMkNDb21wdXRhdGlvbg==" data-listing-date-sort="1721952000000" data-listing-file-modified-sort="1768808202244" data-listing-date-modified-sort="1722038400000" data-listing-reading-time-sort="3" data-listing-word-count-sort="556">
<a href="../../../posts/2024/Stat/Bayes3.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/Stat/posterior.svg" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
信念伝搬アルゴリズム
</h5>
<div class="card-subtitle listing-subtitle">
変分平均場近似
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-07-26
</div>
</div>
</div>
</div></a>
</div>
<div class="g-col-1" data-index="2" data-categories="TmF0dXJlJTJDRGVlcA==" data-listing-date-sort="1712448000000" data-listing-file-modified-sort="1768808200205" data-listing-date-modified-sort="1719619200000" data-listing-reading-time-sort="5" data-listing-word-count-sort="859">
<a href="../../../posts/2024/Nature/StatisticalMechanics1.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/Nature/Lennard-Jones.svg" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
統計力学における基本的な模型の総覧
</h5>
<div class="card-subtitle listing-subtitle">
数学者のための統計力学１：Ising 模型とスピングラス
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-04-07
</div>
</div>
</div>
</div></a>
</div>
</div>
<div class="listing-no-matching d-none">No matching items</div>
</div>
<section id="bayes-推定" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="bayes-推定"><span class="header-section-number">1</span> Bayes 推定</h2>
<p>符号の誤り訂正，または denoising の文脈で Bayes 推定を考える．</p>
<p>雑音が加わる通信路から受け取った観測から真の信号を推定するというデノイジング問題は，Bayes 推定が自然に選好される格好の設定である．</p>
<section id="デノイジング問題としての設定" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="デノイジング問題としての設定"><span class="header-section-number">1.1</span> デノイジング問題としての設定</h3>
<p>情報源は無記憶で，確率分布 <span class="math inline">\(p(x)dx\)</span> に従うとし，通信路は，確率核 <span class="math inline">\(p(y|x)dy\)</span> に従うとする．</p>
<p>送信符号は１つの実数 <span class="math inline">\(x^*\sim p(x)dx\)</span> であったとし，この単一の入力 <span class="math inline">\(x^*\)</span> を <span class="math inline">\(n\)</span> 回独立に観測する： <span class="math display">\[
y_1,\cdots,y_n\overset{\text{iid}}{\sim}p(y|x^*)dy.
\]</span></p>
<p>この観測を経たあと，送信符号 <span class="math inline">\(x^*\)</span> はいったい何だったのかを推定することを考えると，極めて自然に Bayes 推定が選択される．</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="純粋な解釈を持つ Bayes 推定">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>純粋な解釈を持つ Bayes 推定
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>まず，何の観測もない場合，<span class="math inline">\(x^*\)</span> の確率分布は <span class="math inline">\(p(x)dx\)</span> である（設定上）．</p>
<p>しかし，すでに観測 <span class="math inline">\(y_1,\cdots,y_n\)</span> を経ている．よってこの事象の上での <span class="math inline">\(x^*\)</span> の条件付き分布を計算すれば良いことになる： <span class="math display">\[
p(x|y_1,\cdots,y_n) = \frac{p(\boldsymbol{y}|x)p(x)}{p(\boldsymbol{y})}
\]</span> <span id="eq-bayes"><span class="math display">\[
= \frac{\displaystyle p(y_1|x)\cdots p(y_n|x)p(x)}{\displaystyle\int_\mathbb{R}p(y_1|x)\cdots p(y_n|x)p(x)\,dx}
\tag{1}\]</span></span></p>
<p>こうして，誤り訂正符号の文脈では，Bayes 事前確率・事後確率が純粋に確率（または頻度）としての解釈を持つ．通常の統計的枠組みよりも仮定が多いが，その仮定の形式が Bayes 推定の形式にピッタリなのである．</p>
<p>信号処理と Bayesian formalism の類似性は <span class="citation" data-cites="Iba1999">(<a href="#ref-Iba1999" role="doc-biblioref">Iba, 1999, p. 3876</a>)</span>，<span class="citation" data-cites="Zdeborova-Krzakala2016">(<a href="#ref-Zdeborova-Krzakala2016" role="doc-biblioref">Zdeborová and Krzakala, 2016, p. 456</a>)</span> でも指摘されている．</p>
<p>また，統計力学をベイズ推定の特殊な場合とみなせるという見方は，<span class="citation" data-cites="Jaynes1957">(<a href="#ref-Jaynes1957" role="doc-biblioref">Jaynes, 1957</a>)</span> から始まる．<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
</div>
</div>
</div>
</section>
<section id="sec-example" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="sec-example"><span class="header-section-number">1.2</span> 例：Delta-Gauss 混合</h3>
<p>入力は <span class="math inline">\(1/2\)</span> の確率で <span class="math inline">\(x=0\)</span> だが，もう <span class="math inline">\(1/2\)</span> の確率で標準正規分布 <span class="math inline">\(\mathrm{N}(0,1)\)</span> に従うとする： <span class="math display">\[
p(x)dx=\frac{1}{2}\delta_0(dx)+\frac{1}{2}\mathrm{N}(0,1)(dx).
\]</span> 通信路は加法的 Gauss 型であるとする： <span class="math display">\[
p(x,y)=\frac{1}{\sqrt{2\pi}}\exp\left(-\frac{(x-y)^2}{2}\right).
\]</span> では真値を <span class="math inline">\(x^*=1\)</span> として，<span class="math inline">\(n=10\)</span> 回の観測データを生成してみる：</p>
<div id="6df7aff2" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="bu">Random</span>.<span class="fu">seed!</span>(<span class="fl">123</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> <span class="fl">1</span> <span class="op">.+</span> <span class="fu">randn</span>(<span class="fl">10</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1.8082879284649667, -0.12207250811417336, -0.10463610232929588, 0.5830073648350667, 1.2875879806238557, 1.2298186980518677, 0.5782313356003073, -0.355590621101197, -0.08821851393628699, 1.7037583257923017]</code></pre>
</div>
</div>
<p>愚直な計算から，<span class="math inline">\(p(\boldsymbol{y})\)</span> は次の積分から得られる：</p>
<div class="script-size">
<p><span class="math display">\[\begin{align*}
    p(\boldsymbol{y})&amp;=\int_\mathbb{R}p(\boldsymbol{y}|x)p(x)dx\\
    &amp;=\int_\mathbb{R}\prod_{i=1}^n p(y_i|x)p(x)dx\\
    &amp;=\frac{1}{2}\frac{1}{(2\pi)^{n+1}}\int_\mathbb{R}\exp\left(-\frac{1}{2}\sum_{i=1}^n(y_i-x)^2+x^2\right)dx\\
    &amp;\qquad+\frac{1}{2}\frac{1}{(2\pi)^n}\exp\left(-\frac{1}{2}\sum_{i=1}^n(y_i-x)^2\right)dx.
\end{align*}\]</span></p>
</div>
<p>これを実際に計算した結果は <span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala and Zdeborová, 2024, p. 117</a>)</span> で与えられている．</p>
<p>ここでは，邪教のような計算を啓示するのではなく，Julia と Turing を通じて計算する方法を紹介する <span class="citation" data-cites="Storopoli2021">(<a href="#ref-Storopoli2021" role="doc-biblioref">Storopoli, 2021</a>)</span>．</p>
<div id="bc2038a5" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span>, <span class="bu">Distributions</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>prior <span class="op">=</span> <span class="fu">MixtureModel</span>([<span class="fu">Normal</span>(<span class="fl">0.0</span>, <span class="fl">1.0</span>), <span class="fu">Normal</span>(<span class="fl">0.0</span>, <span class="fl">0.005</span>)], [<span class="fl">0.5</span>, <span class="fl">0.5</span>])</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">mixed_normal_model</span>(data)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    μ <span class="op">~</span> prior</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(data)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        data[i] <span class="op">~</span> <span class="fu">Normal</span>(μ, <span class="fl">1</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">mixed_normal_model</span>(data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="00f2c5da" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(model, <span class="fu">NUTS</span>(), <span class="fl">100000</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a2736dd3" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MCMCChains</span>, <span class="bu">Plots</span>, <span class="bu">StatsPlots</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(chain[<span class="op">:</span>μ], seriestype <span class="op">=</span> <span class="op">:</span>density, xlabel <span class="op">=</span> <span class="st">"x*"</span>, ylabel <span class="op">=</span> <span class="st">"Density"</span>, title <span class="op">=</span> <span class="st">"Posterior Distribution"</span>, color <span class="op">=</span> <span class="st">"#78C2AD"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vline!</span>([<span class="fl">1</span>], color <span class="op">=</span> <span class="op">:</span>pink, linewidth <span class="op">=</span> <span class="fl">2</span>, label <span class="op">=</span> <span class="st">"x^* = 1"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="576" height="384" viewbox="0 0 2304 1536">
<defs>
  <clippath id="clip680">
    <rect x="0" y="0" width="2304" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip680)" d="M0 1536 L2304 1536 L2304 8.52651e-14 L0 8.52651e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip681">
    <rect x="460" y="0" width="1614" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip680)" d="M218.906 1359.82 L2256.76 1359.82 L2256.76 123.472 L218.906 123.472  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip682">
    <rect x="218" y="123" width="2039" height="1237"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="449.17,1359.82 449.17,123.472 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="775.53,1359.82 775.53,123.472 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1101.89,1359.82 1101.89,123.472 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1428.25,1359.82 1428.25,123.472 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1754.61,1359.82 1754.61,123.472 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2080.97,1359.82 2080.97,123.472 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,1359.82 2256.76,1359.82 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="449.17,1359.82 449.17,1340.92 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="775.53,1359.82 775.53,1340.92 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1101.89,1359.82 1101.89,1340.92 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1428.25,1359.82 1428.25,1340.92 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1754.61,1359.82 1754.61,1340.92 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2080.97,1359.82 2080.97,1340.92 "></polyline>
<path clip-path="url(#clip680)" d="M396.196 1404.62 L425.872 1404.62 L425.872 1408.56 L396.196 1408.56 L396.196 1404.62 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M445.964 1389.97 Q442.353 1389.97 440.525 1393.54 Q438.719 1397.08 438.719 1404.21 Q438.719 1411.31 440.525 1414.88 Q442.353 1418.42 445.964 1418.42 Q449.599 1418.42 451.404 1414.88 Q453.233 1411.31 453.233 1404.21 Q453.233 1397.08 451.404 1393.54 Q449.599 1389.97 445.964 1389.97 M445.964 1386.27 Q451.774 1386.27 454.83 1390.87 Q457.909 1395.46 457.909 1404.21 Q457.909 1412.93 454.83 1417.54 Q451.774 1422.12 445.964 1422.12 Q440.154 1422.12 437.075 1417.54 Q434.02 1412.93 434.02 1404.21 Q434.02 1395.46 437.075 1390.87 Q440.154 1386.27 445.964 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M466.126 1415.57 L471.01 1415.57 L471.01 1421.45 L466.126 1421.45 L466.126 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M481.242 1386.89 L499.598 1386.89 L499.598 1390.83 L485.524 1390.83 L485.524 1399.3 Q486.543 1398.95 487.561 1398.79 Q488.58 1398.6 489.598 1398.6 Q495.385 1398.6 498.765 1401.78 Q502.145 1404.95 502.145 1410.36 Q502.145 1415.94 498.672 1419.04 Q495.2 1422.12 488.881 1422.12 Q486.705 1422.12 484.436 1421.75 Q482.191 1421.38 479.784 1420.64 L479.784 1415.94 Q481.867 1417.08 484.089 1417.63 Q486.311 1418.19 488.788 1418.19 Q492.793 1418.19 495.131 1416.08 Q497.469 1413.98 497.469 1410.36 Q497.469 1406.75 495.131 1404.65 Q492.793 1402.54 488.788 1402.54 Q486.913 1402.54 485.038 1402.96 Q483.186 1403.37 481.242 1404.25 L481.242 1386.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M752.914 1389.97 Q749.303 1389.97 747.474 1393.54 Q745.669 1397.08 745.669 1404.21 Q745.669 1411.31 747.474 1414.88 Q749.303 1418.42 752.914 1418.42 Q756.548 1418.42 758.354 1414.88 Q760.183 1411.31 760.183 1404.21 Q760.183 1397.08 758.354 1393.54 Q756.548 1389.97 752.914 1389.97 M752.914 1386.27 Q758.724 1386.27 761.78 1390.87 Q764.859 1395.46 764.859 1404.21 Q764.859 1412.93 761.78 1417.54 Q758.724 1422.12 752.914 1422.12 Q747.104 1422.12 744.025 1417.54 Q740.97 1412.93 740.97 1404.21 Q740.97 1395.46 744.025 1390.87 Q747.104 1386.27 752.914 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M773.076 1415.57 L777.96 1415.57 L777.96 1421.45 L773.076 1421.45 L773.076 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M798.145 1389.97 Q794.534 1389.97 792.706 1393.54 Q790.9 1397.08 790.9 1404.21 Q790.9 1411.31 792.706 1414.88 Q794.534 1418.42 798.145 1418.42 Q801.78 1418.42 803.585 1414.88 Q805.414 1411.31 805.414 1404.21 Q805.414 1397.08 803.585 1393.54 Q801.78 1389.97 798.145 1389.97 M798.145 1386.27 Q803.956 1386.27 807.011 1390.87 Q810.09 1395.46 810.09 1404.21 Q810.09 1412.93 807.011 1417.54 Q803.956 1422.12 798.145 1422.12 Q792.335 1422.12 789.257 1417.54 Q786.201 1412.93 786.201 1404.21 Q786.201 1395.46 789.257 1390.87 Q792.335 1386.27 798.145 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1079.77 1389.97 Q1076.16 1389.97 1074.33 1393.54 Q1072.53 1397.08 1072.53 1404.21 Q1072.53 1411.31 1074.33 1414.88 Q1076.16 1418.42 1079.77 1418.42 Q1083.41 1418.42 1085.21 1414.88 Q1087.04 1411.31 1087.04 1404.21 Q1087.04 1397.08 1085.21 1393.54 Q1083.41 1389.97 1079.77 1389.97 M1079.77 1386.27 Q1085.58 1386.27 1088.64 1390.87 Q1091.72 1395.46 1091.72 1404.21 Q1091.72 1412.93 1088.64 1417.54 Q1085.58 1422.12 1079.77 1422.12 Q1073.96 1422.12 1070.88 1417.54 Q1067.83 1412.93 1067.83 1404.21 Q1067.83 1395.46 1070.88 1390.87 Q1073.96 1386.27 1079.77 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1099.93 1415.57 L1104.82 1415.57 L1104.82 1421.45 L1099.93 1421.45 L1099.93 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1115.05 1386.89 L1133.41 1386.89 L1133.41 1390.83 L1119.33 1390.83 L1119.33 1399.3 Q1120.35 1398.95 1121.37 1398.79 Q1122.39 1398.6 1123.41 1398.6 Q1129.19 1398.6 1132.57 1401.78 Q1135.95 1404.95 1135.95 1410.36 Q1135.95 1415.94 1132.48 1419.04 Q1129.01 1422.12 1122.69 1422.12 Q1120.51 1422.12 1118.24 1421.75 Q1116 1421.38 1113.59 1420.64 L1113.59 1415.94 Q1115.67 1417.08 1117.9 1417.63 Q1120.12 1418.19 1122.6 1418.19 Q1126.6 1418.19 1128.94 1416.08 Q1131.28 1413.98 1131.28 1410.36 Q1131.28 1406.75 1128.94 1404.65 Q1126.6 1402.54 1122.6 1402.54 Q1120.72 1402.54 1118.85 1402.96 Q1116.99 1403.37 1115.05 1404.25 L1115.05 1386.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1395.4 1417.52 L1403.04 1417.52 L1403.04 1391.15 L1394.73 1392.82 L1394.73 1388.56 L1402.99 1386.89 L1407.67 1386.89 L1407.67 1417.52 L1415.31 1417.52 L1415.31 1421.45 L1395.4 1421.45 L1395.4 1417.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1424.75 1415.57 L1429.64 1415.57 L1429.64 1421.45 L1424.75 1421.45 L1424.75 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1449.82 1389.97 Q1446.21 1389.97 1444.38 1393.54 Q1442.58 1397.08 1442.58 1404.21 Q1442.58 1411.31 1444.38 1414.88 Q1446.21 1418.42 1449.82 1418.42 Q1453.46 1418.42 1455.26 1414.88 Q1457.09 1411.31 1457.09 1404.21 Q1457.09 1397.08 1455.26 1393.54 Q1453.46 1389.97 1449.82 1389.97 M1449.82 1386.27 Q1455.63 1386.27 1458.69 1390.87 Q1461.77 1395.46 1461.77 1404.21 Q1461.77 1412.93 1458.69 1417.54 Q1455.63 1422.12 1449.82 1422.12 Q1444.01 1422.12 1440.93 1417.54 Q1437.88 1412.93 1437.88 1404.21 Q1437.88 1395.46 1440.93 1390.87 Q1444.01 1386.27 1449.82 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1722.26 1417.52 L1729.9 1417.52 L1729.9 1391.15 L1721.59 1392.82 L1721.59 1388.56 L1729.85 1386.89 L1734.53 1386.89 L1734.53 1417.52 L1742.17 1417.52 L1742.17 1421.45 L1722.26 1421.45 L1722.26 1417.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1751.61 1415.57 L1756.49 1415.57 L1756.49 1421.45 L1751.61 1421.45 L1751.61 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1766.73 1386.89 L1785.08 1386.89 L1785.08 1390.83 L1771.01 1390.83 L1771.01 1399.3 Q1772.03 1398.95 1773.05 1398.79 Q1774.06 1398.6 1775.08 1398.6 Q1780.87 1398.6 1784.25 1401.78 Q1787.63 1404.95 1787.63 1410.36 Q1787.63 1415.94 1784.16 1419.04 Q1780.68 1422.12 1774.37 1422.12 Q1772.19 1422.12 1769.92 1421.75 Q1767.68 1421.38 1765.27 1420.64 L1765.27 1415.94 Q1767.35 1417.08 1769.57 1417.63 Q1771.8 1418.19 1774.27 1418.19 Q1778.28 1418.19 1780.62 1416.08 Q1782.95 1413.98 1782.95 1410.36 Q1782.95 1406.75 1780.62 1404.65 Q1778.28 1402.54 1774.27 1402.54 Q1772.4 1402.54 1770.52 1402.96 Q1768.67 1403.37 1766.73 1404.25 L1766.73 1386.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M2052.21 1417.52 L2068.53 1417.52 L2068.53 1421.45 L2046.58 1421.45 L2046.58 1417.52 Q2049.24 1414.76 2053.83 1410.13 Q2058.43 1405.48 2059.61 1404.14 Q2061.86 1401.61 2062.74 1399.88 Q2063.64 1398.12 2063.64 1396.43 Q2063.64 1393.67 2061.7 1391.94 Q2059.78 1390.2 2056.67 1390.2 Q2054.47 1390.2 2052.02 1390.97 Q2049.59 1391.73 2046.81 1393.28 L2046.81 1388.56 Q2049.64 1387.42 2052.09 1386.85 Q2054.54 1386.27 2056.58 1386.27 Q2061.95 1386.27 2065.15 1388.95 Q2068.34 1391.64 2068.34 1396.13 Q2068.34 1398.26 2067.53 1400.18 Q2066.74 1402.08 2064.64 1404.67 Q2064.06 1405.34 2060.96 1408.56 Q2057.85 1411.75 2052.21 1417.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M2078.34 1415.57 L2083.22 1415.57 L2083.22 1421.45 L2078.34 1421.45 L2078.34 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M2103.41 1389.97 Q2099.8 1389.97 2097.97 1393.54 Q2096.16 1397.08 2096.16 1404.21 Q2096.16 1411.31 2097.97 1414.88 Q2099.8 1418.42 2103.41 1418.42 Q2107.04 1418.42 2108.85 1414.88 Q2110.68 1411.31 2110.68 1404.21 Q2110.68 1397.08 2108.85 1393.54 Q2107.04 1389.97 2103.41 1389.97 M2103.41 1386.27 Q2109.22 1386.27 2112.28 1390.87 Q2115.35 1395.46 2115.35 1404.21 Q2115.35 1412.93 2112.28 1417.54 Q2109.22 1422.12 2103.41 1422.12 Q2097.6 1422.12 2094.52 1417.54 Q2091.47 1412.93 2091.47 1404.21 Q2091.47 1395.46 2094.52 1390.87 Q2097.6 1386.27 2103.41 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1238.05 1467.6 L1225.16 1484.94 L1238.72 1503.24 L1231.82 1503.24 L1221.44 1489.24 L1211.06 1503.24 L1204.16 1503.24 L1218 1484.59 L1205.33 1467.6 L1212.24 1467.6 L1221.69 1480.3 L1231.15 1467.6 L1238.05 1467.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1271.51 1463.55 L1260.08 1469.73 L1271.51 1475.93 L1269.66 1479.05 L1258.97 1472.59 L1258.97 1484.59 L1255.34 1484.59 L1255.34 1472.59 L1244.64 1479.05 L1242.8 1475.93 L1254.22 1469.73 L1242.8 1463.55 L1244.64 1460.4 L1255.34 1466.86 L1255.34 1454.86 L1258.97 1454.86 L1258.97 1466.86 L1269.66 1460.4 L1271.51 1463.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,1324.83 2256.76,1324.83 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,1138.23 2256.76,1138.23 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,951.629 2256.76,951.629 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,765.029 2256.76,765.029 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,578.429 2256.76,578.429 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,391.828 2256.76,391.828 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,205.228 2256.76,205.228 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,1359.82 218.906,123.472 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,1324.83 237.804,1324.83 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,1138.23 237.804,1138.23 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,951.629 237.804,951.629 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,765.029 237.804,765.029 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,578.429 237.804,578.429 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,391.828 237.804,391.828 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,205.228 237.804,205.228 "></polyline>
<path clip-path="url(#clip680)" d="M127.171 1310.63 Q123.56 1310.63 121.731 1314.19 Q119.925 1317.73 119.925 1324.86 Q119.925 1331.97 121.731 1335.53 Q123.56 1339.08 127.171 1339.08 Q130.805 1339.08 132.61 1335.53 Q134.439 1331.97 134.439 1324.86 Q134.439 1317.73 132.61 1314.19 Q130.805 1310.63 127.171 1310.63 M127.171 1306.92 Q132.981 1306.92 136.036 1311.53 Q139.115 1316.11 139.115 1324.86 Q139.115 1333.59 136.036 1338.2 Q132.981 1342.78 127.171 1342.78 Q121.36 1342.78 118.282 1338.2 Q115.226 1333.59 115.226 1324.86 Q115.226 1316.11 118.282 1311.53 Q121.36 1306.92 127.171 1306.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M147.333 1336.23 L152.217 1336.23 L152.217 1342.11 L147.333 1342.11 L147.333 1336.23 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M172.402 1310.63 Q168.791 1310.63 166.962 1314.19 Q165.157 1317.73 165.157 1324.86 Q165.157 1331.97 166.962 1335.53 Q168.791 1339.08 172.402 1339.08 Q176.036 1339.08 177.842 1335.53 Q179.67 1331.97 179.67 1324.86 Q179.67 1317.73 177.842 1314.19 Q176.036 1310.63 172.402 1310.63 M172.402 1306.92 Q178.212 1306.92 181.268 1311.53 Q184.346 1316.11 184.346 1324.86 Q184.346 1333.59 181.268 1338.2 Q178.212 1342.78 172.402 1342.78 Q166.592 1342.78 163.513 1338.2 Q160.458 1333.59 160.458 1324.86 Q160.458 1316.11 163.513 1311.53 Q166.592 1306.92 172.402 1306.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M128.768 1124.03 Q125.157 1124.03 123.328 1127.59 Q121.523 1131.13 121.523 1138.26 Q121.523 1145.37 123.328 1148.93 Q125.157 1152.48 128.768 1152.48 Q132.402 1152.48 134.208 1148.93 Q136.036 1145.37 136.036 1138.26 Q136.036 1131.13 134.208 1127.59 Q132.402 1124.03 128.768 1124.03 M128.768 1120.32 Q134.578 1120.32 137.634 1124.93 Q140.712 1129.51 140.712 1138.26 Q140.712 1146.99 137.634 1151.6 Q134.578 1156.18 128.768 1156.18 Q122.958 1156.18 119.879 1151.6 Q116.823 1146.99 116.823 1138.26 Q116.823 1129.51 119.879 1124.93 Q122.958 1120.32 128.768 1120.32 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M148.93 1149.63 L153.814 1149.63 L153.814 1155.51 L148.93 1155.51 L148.93 1149.63 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M168.027 1151.57 L184.346 1151.57 L184.346 1155.51 L162.402 1155.51 L162.402 1151.57 Q165.064 1148.82 169.647 1144.19 Q174.254 1139.54 175.434 1138.19 Q177.68 1135.67 178.559 1133.93 Q179.462 1132.18 179.462 1130.49 Q179.462 1127.73 177.518 1126 Q175.596 1124.26 172.494 1124.26 Q170.295 1124.26 167.842 1125.02 Q165.411 1125.79 162.633 1127.34 L162.633 1122.62 Q165.457 1121.48 167.911 1120.9 Q170.365 1120.32 172.402 1120.32 Q177.772 1120.32 180.967 1123.01 Q184.161 1125.69 184.161 1130.18 Q184.161 1132.31 183.351 1134.24 Q182.564 1136.13 180.457 1138.73 Q179.879 1139.4 176.777 1142.62 Q173.675 1145.81 168.027 1151.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M126.685 937.427 Q123.073 937.427 121.245 940.992 Q119.439 944.534 119.439 951.663 Q119.439 958.77 121.245 962.335 Q123.073 965.876 126.685 965.876 Q130.319 965.876 132.124 962.335 Q133.953 958.77 133.953 951.663 Q133.953 944.534 132.124 940.992 Q130.319 937.427 126.685 937.427 M126.685 933.724 Q132.495 933.724 135.55 938.33 Q138.629 942.914 138.629 951.663 Q138.629 960.39 135.55 964.997 Q132.495 969.58 126.685 969.58 Q120.874 969.58 117.796 964.997 Q114.74 960.39 114.74 951.663 Q114.74 942.914 117.796 938.33 Q120.874 933.724 126.685 933.724 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M146.846 963.029 L151.731 963.029 L151.731 968.909 L146.846 968.909 L146.846 963.029 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M174.763 938.423 L162.957 956.872 L174.763 956.872 L174.763 938.423 M173.536 934.349 L179.416 934.349 L179.416 956.872 L184.346 956.872 L184.346 960.761 L179.416 960.761 L179.416 968.909 L174.763 968.909 L174.763 960.761 L159.161 960.761 L159.161 956.247 L173.536 934.349 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M127.009 750.827 Q123.398 750.827 121.569 754.392 Q119.763 757.934 119.763 765.063 Q119.763 772.17 121.569 775.735 Q123.398 779.276 127.009 779.276 Q130.643 779.276 132.448 775.735 Q134.277 772.17 134.277 765.063 Q134.277 757.934 132.448 754.392 Q130.643 750.827 127.009 750.827 M127.009 747.124 Q132.819 747.124 135.874 751.73 Q138.953 756.313 138.953 765.063 Q138.953 773.79 135.874 778.397 Q132.819 782.98 127.009 782.98 Q121.198 782.98 118.12 778.397 Q115.064 773.79 115.064 765.063 Q115.064 756.313 118.12 751.73 Q121.198 747.124 127.009 747.124 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M147.171 776.429 L152.055 776.429 L152.055 782.309 L147.171 782.309 L147.171 776.429 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M172.819 763.165 Q169.67 763.165 167.819 765.318 Q165.99 767.471 165.99 771.221 Q165.99 774.948 167.819 777.123 Q169.67 779.276 172.819 779.276 Q175.967 779.276 177.795 777.123 Q179.647 774.948 179.647 771.221 Q179.647 767.471 177.795 765.318 Q175.967 763.165 172.819 763.165 M182.101 748.513 L182.101 752.772 Q180.342 751.938 178.536 751.499 Q176.754 751.059 174.994 751.059 Q170.365 751.059 167.911 754.184 Q165.481 757.309 165.133 763.628 Q166.499 761.614 168.559 760.549 Q170.619 759.462 173.096 759.462 Q178.305 759.462 181.314 762.633 Q184.346 765.781 184.346 771.221 Q184.346 776.545 181.198 779.762 Q178.05 782.98 172.819 782.98 Q166.823 782.98 163.652 778.397 Q160.481 773.79 160.481 765.063 Q160.481 756.869 164.37 752.008 Q168.258 747.124 174.809 747.124 Q176.569 747.124 178.351 747.471 Q180.156 747.818 182.101 748.513 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M127.263 564.227 Q123.652 564.227 121.823 567.792 Q120.018 571.334 120.018 578.463 Q120.018 585.57 121.823 589.134 Q123.652 592.676 127.263 592.676 Q130.897 592.676 132.703 589.134 Q134.532 585.57 134.532 578.463 Q134.532 571.334 132.703 567.792 Q130.897 564.227 127.263 564.227 M127.263 560.524 Q133.073 560.524 136.129 565.13 Q139.208 569.713 139.208 578.463 Q139.208 587.19 136.129 591.797 Q133.073 596.38 127.263 596.38 Q121.453 596.38 118.374 591.797 Q115.319 587.19 115.319 578.463 Q115.319 569.713 118.374 565.13 Q121.453 560.524 127.263 560.524 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M147.425 589.829 L152.309 589.829 L152.309 595.709 L147.425 595.709 L147.425 589.829 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M172.494 579.297 Q169.161 579.297 167.24 581.079 Q165.342 582.861 165.342 585.986 Q165.342 589.111 167.24 590.894 Q169.161 592.676 172.494 592.676 Q175.828 592.676 177.749 590.894 Q179.67 589.088 179.67 585.986 Q179.67 582.861 177.749 581.079 Q175.851 579.297 172.494 579.297 M167.819 577.306 Q164.809 576.565 163.12 574.505 Q161.453 572.445 161.453 569.482 Q161.453 565.338 164.393 562.931 Q167.356 560.524 172.494 560.524 Q177.656 560.524 180.596 562.931 Q183.536 565.338 183.536 569.482 Q183.536 572.445 181.846 574.505 Q180.18 576.565 177.194 577.306 Q180.573 578.093 182.448 580.385 Q184.346 582.676 184.346 585.986 Q184.346 591.009 181.268 593.695 Q178.212 596.38 172.494 596.38 Q166.777 596.38 163.698 593.695 Q160.643 591.009 160.643 585.986 Q160.643 582.676 162.541 580.385 Q164.439 578.093 167.819 577.306 M166.106 569.922 Q166.106 572.607 167.772 574.111 Q169.462 575.616 172.494 575.616 Q175.504 575.616 177.194 574.111 Q178.906 572.607 178.906 569.922 Q178.906 567.236 177.194 565.732 Q175.504 564.227 172.494 564.227 Q169.462 564.227 167.772 565.732 Q166.106 567.236 166.106 569.922 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M117.981 405.173 L125.62 405.173 L125.62 378.808 L117.31 380.474 L117.31 376.215 L125.573 374.548 L130.249 374.548 L130.249 405.173 L137.888 405.173 L137.888 409.108 L117.981 409.108 L117.981 405.173 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M147.333 403.229 L152.217 403.229 L152.217 409.108 L147.333 409.108 L147.333 403.229 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M172.402 377.627 Q168.791 377.627 166.962 381.192 Q165.157 384.734 165.157 391.863 Q165.157 398.97 166.962 402.534 Q168.791 406.076 172.402 406.076 Q176.036 406.076 177.842 402.534 Q179.67 398.97 179.67 391.863 Q179.67 384.734 177.842 381.192 Q176.036 377.627 172.402 377.627 M172.402 373.923 Q178.212 373.923 181.268 378.53 Q184.346 383.113 184.346 391.863 Q184.346 400.59 181.268 405.196 Q178.212 409.78 172.402 409.78 Q166.592 409.78 163.513 405.196 Q160.458 400.59 160.458 391.863 Q160.458 383.113 163.513 378.53 Q166.592 373.923 172.402 373.923 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M119.578 218.573 L127.217 218.573 L127.217 192.208 L118.907 193.874 L118.907 189.615 L127.171 187.948 L131.847 187.948 L131.847 218.573 L139.485 218.573 L139.485 222.508 L119.578 222.508 L119.578 218.573 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M148.93 216.629 L153.814 216.629 L153.814 222.508 L148.93 222.508 L148.93 216.629 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M168.027 218.573 L184.346 218.573 L184.346 222.508 L162.402 222.508 L162.402 218.573 Q165.064 215.819 169.647 211.189 Q174.254 206.536 175.434 205.194 Q177.68 202.67 178.559 200.934 Q179.462 199.175 179.462 197.485 Q179.462 194.731 177.518 192.995 Q175.596 191.258 172.494 191.258 Q170.295 191.258 167.842 192.022 Q165.411 192.786 162.633 194.337 L162.633 189.615 Q165.457 188.481 167.911 187.902 Q170.365 187.323 172.402 187.323 Q177.772 187.323 180.967 190.008 Q184.161 192.694 184.161 197.184 Q184.161 199.314 183.351 201.235 Q182.564 203.133 180.457 205.726 Q179.879 206.397 176.777 209.615 Q173.675 212.809 168.027 218.573 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M23.6877 854.956 L60.6406 854.956 L60.6406 847.189 Q60.6406 837.354 56.1846 832.803 Q51.7286 828.22 42.1164 828.22 Q32.5679 828.22 28.1437 832.803 Q23.6877 837.354 23.6877 847.189 L23.6877 854.956 M18.4042 861.385 L18.4042 848.176 Q18.4042 834.363 24.1651 827.901 Q29.8943 821.44 42.1164 821.44 Q54.4022 821.44 60.1632 827.933 Q65.9242 834.426 65.9242 848.176 L65.9242 861.385 L18.4042 861.385 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M46.6361 780.954 L49.5006 780.954 L49.5006 807.881 Q55.5481 807.499 58.7309 804.253 Q61.8819 800.974 61.8819 795.15 Q61.8819 791.776 61.0544 788.625 Q60.2269 785.442 58.5718 782.323 L64.1099 782.323 Q65.4467 785.474 66.147 788.784 Q66.8472 792.094 66.8472 795.5 Q66.8472 804.03 61.8819 809.027 Q56.9167 813.992 48.4503 813.992 Q39.6974 813.992 34.5731 809.282 Q29.4168 804.539 29.4168 796.518 Q29.4168 789.325 34.0638 785.156 Q38.6789 780.954 46.6361 780.954 M44.9173 786.811 Q40.1112 786.874 37.2466 789.516 Q34.3821 792.126 34.3821 796.455 Q34.3821 801.356 37.1512 804.316 Q39.9202 807.245 44.9492 807.69 L44.9173 786.811 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M44.4081 741.71 L65.9242 741.71 L65.9242 747.566 L44.599 747.566 Q39.5383 747.566 37.0238 749.539 Q34.5094 751.513 34.5094 755.46 Q34.5094 760.202 37.5331 762.939 Q40.5568 765.677 45.7767 765.677 L65.9242 765.677 L65.9242 771.565 L30.2762 771.565 L30.2762 765.677 L35.8144 765.677 Q32.5997 763.576 31.0083 760.743 Q29.4168 757.879 29.4168 754.155 Q29.4168 748.012 33.2363 744.861 Q37.0238 741.71 44.4081 741.71 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M31.3265 707.303 L36.8647 707.303 Q35.5916 709.786 34.955 712.459 Q34.3184 715.133 34.3184 717.997 Q34.3184 722.358 35.6552 724.554 Q36.992 726.718 39.6656 726.718 Q41.7026 726.718 42.8803 725.159 Q44.0261 723.599 45.0765 718.889 L45.5221 716.883 Q46.8589 710.645 49.3097 708.035 Q51.7286 705.393 56.0891 705.393 Q61.0544 705.393 63.9508 709.34 Q66.8472 713.255 66.8472 720.13 Q66.8472 722.994 66.2743 726.114 Q65.7332 729.201 64.6192 732.639 L58.5718 732.639 Q60.2587 729.392 61.118 726.241 Q61.9456 723.09 61.9456 720.003 Q61.9456 715.865 60.5451 713.637 Q59.1129 711.409 56.5347 711.409 Q54.1476 711.409 52.8745 713.032 Q51.6013 714.624 50.4237 720.066 L49.9462 722.103 Q48.8004 727.546 46.4451 729.965 Q44.058 732.384 39.9202 732.384 Q34.8913 732.384 32.1541 728.819 Q29.4168 725.254 29.4168 718.698 Q29.4168 715.451 29.8943 712.587 Q30.3717 709.722 31.3265 707.303 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M30.2762 696.068 L30.2762 690.211 L65.9242 690.211 L65.9242 696.068 L30.2762 696.068 M16.399 696.068 L16.399 690.211 L23.815 690.211 L23.815 696.068 L16.399 696.068 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M20.1547 672.164 L30.2762 672.164 L30.2762 660.101 L34.8277 660.101 L34.8277 672.164 L54.1794 672.164 Q58.5399 672.164 59.7813 670.987 Q61.0226 669.777 61.0226 666.117 L61.0226 660.101 L65.9242 660.101 L65.9242 666.117 Q65.9242 672.896 63.4097 675.474 Q60.8634 678.053 54.1794 678.053 L34.8277 678.053 L34.8277 682.349 L30.2762 682.349 L30.2762 678.053 L20.1547 678.053 L20.1547 672.164 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M69.2343 637.567 Q75.6 640.049 77.5416 642.405 Q79.4831 644.76 79.4831 648.707 L79.4831 653.385 L74.5815 653.385 L74.5815 649.948 Q74.5815 647.529 73.4357 646.192 Q72.2899 644.855 68.0248 643.232 L65.3512 642.182 L30.2762 656.6 L30.2762 650.394 L58.158 639.254 L30.2762 628.114 L30.2762 621.907 L69.2343 637.567 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M815.099 18.8205 L815.099 41.5461 L825.388 41.5461 Q831.1 41.5461 834.219 38.5889 Q837.338 35.6318 837.338 30.163 Q837.338 24.7348 834.219 21.7777 Q831.1 18.8205 825.388 18.8205 L815.099 18.8205 M806.916 12.096 L825.388 12.096 Q835.556 12.096 840.741 16.714 Q845.967 21.2916 845.967 30.163 Q845.967 39.1155 840.741 43.6931 Q835.556 48.2706 825.388 48.2706 L815.099 48.2706 L815.099 72.576 L806.916 72.576 L806.916 12.096 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M871.245 32.4315 Q865.249 32.4315 861.765 37.1306 Q858.282 41.7891 858.282 49.9314 Q858.282 58.0738 861.725 62.7728 Q865.209 67.4314 871.245 67.4314 Q877.199 67.4314 880.683 62.7323 Q884.167 58.0333 884.167 49.9314 Q884.167 41.8701 880.683 37.1711 Q877.199 32.4315 871.245 32.4315 M871.245 26.1121 Q880.967 26.1121 886.516 32.4315 Q892.066 38.7509 892.066 49.9314 Q892.066 61.0714 886.516 67.4314 Q880.967 73.7508 871.245 73.7508 Q861.482 73.7508 855.932 67.4314 Q850.423 61.0714 850.423 49.9314 Q850.423 38.7509 855.932 32.4315 Q861.482 26.1121 871.245 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M933.345 28.5427 L933.345 35.5912 Q930.185 33.9709 926.782 33.1607 Q923.38 32.3505 919.734 32.3505 Q914.184 32.3505 911.389 34.0519 Q908.634 35.7533 908.634 39.156 Q908.634 41.7486 910.619 43.2475 Q912.604 44.7058 918.6 46.0426 L921.152 46.6097 Q929.091 48.3111 932.413 51.4303 Q935.775 54.509 935.775 60.0587 Q935.775 66.3781 930.752 70.0644 Q925.77 73.7508 917.02 73.7508 Q913.374 73.7508 909.404 73.0216 Q905.475 72.3329 901.1 70.9151 L901.1 63.2184 Q905.232 65.3654 909.242 66.4591 Q913.252 67.5124 917.182 67.5124 Q922.448 67.5124 925.284 65.73 Q928.119 63.9071 928.119 60.6258 Q928.119 57.5877 926.053 55.9673 Q924.028 54.3469 917.101 52.8481 L914.508 52.2405 Q907.581 50.7821 904.502 47.7845 Q901.424 44.7463 901.424 39.4801 Q901.424 33.0797 905.961 29.5959 Q910.498 26.1121 918.843 26.1121 Q922.975 26.1121 926.62 26.7198 Q930.266 27.3274 933.345 28.5427 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M955.017 14.324 L955.017 27.2059 L970.37 27.2059 L970.37 32.9987 L955.017 32.9987 L955.017 57.6282 Q955.017 63.1779 956.516 64.7578 Q958.055 66.3376 962.714 66.3376 L970.37 66.3376 L970.37 72.576 L962.714 72.576 Q954.085 72.576 950.804 69.3758 Q947.523 66.1351 947.523 57.6282 L947.523 32.9987 L942.054 32.9987 L942.054 27.2059 L947.523 27.2059 L947.523 14.324 L955.017 14.324 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1018.98 48.0275 L1018.98 51.6733 L984.71 51.6733 Q985.196 59.3701 989.328 63.421 Q993.501 67.4314 1000.91 67.4314 Q1005.21 67.4314 1009.22 66.3781 Q1013.27 65.3249 1017.24 63.2184 L1017.24 70.267 Q1013.23 71.9684 1009.02 72.8596 Q1004.8 73.7508 1000.47 73.7508 Q989.612 73.7508 983.252 67.4314 Q976.933 61.1119 976.933 50.3365 Q976.933 39.1965 982.928 32.6746 Q988.964 26.1121 999.172 26.1121 Q1008.33 26.1121 1013.63 32.0264 Q1018.98 37.9003 1018.98 48.0275 M1011.53 45.84 Q1011.45 39.7232 1008.08 36.0774 Q1004.76 32.4315 999.253 32.4315 Q993.015 32.4315 989.247 35.9558 Q985.521 39.4801 984.953 45.8805 L1011.53 45.84 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1057.51 34.1734 Q1056.25 33.4443 1054.75 33.1202 Q1053.29 32.7556 1051.51 32.7556 Q1045.19 32.7556 1041.79 36.8875 Q1038.43 40.9789 1038.43 48.6757 L1038.43 72.576 L1030.93 72.576 L1030.93 27.2059 L1038.43 27.2059 L1038.43 34.2544 Q1040.77 30.1225 1044.54 28.1376 Q1048.31 26.1121 1053.7 26.1121 Q1054.47 26.1121 1055.4 26.2337 Q1056.33 26.3147 1057.46 26.5172 L1057.51 34.1734 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1065.32 27.2059 L1072.78 27.2059 L1072.78 72.576 L1065.32 72.576 L1065.32 27.2059 M1065.32 9.54393 L1072.78 9.54393 L1072.78 18.9825 L1065.32 18.9825 L1065.32 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1105.95 32.4315 Q1099.96 32.4315 1096.47 37.1306 Q1092.99 41.7891 1092.99 49.9314 Q1092.99 58.0738 1096.43 62.7728 Q1099.92 67.4314 1105.95 67.4314 Q1111.91 67.4314 1115.39 62.7323 Q1118.88 58.0333 1118.88 49.9314 Q1118.88 41.8701 1115.39 37.1711 Q1111.91 32.4315 1105.95 32.4315 M1105.95 26.1121 Q1115.68 26.1121 1121.23 32.4315 Q1126.78 38.7509 1126.78 49.9314 Q1126.78 61.0714 1121.23 67.4314 Q1115.68 73.7508 1105.95 73.7508 Q1096.19 73.7508 1090.64 67.4314 Q1085.13 61.0714 1085.13 49.9314 Q1085.13 38.7509 1090.64 32.4315 Q1096.19 26.1121 1105.95 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1165.42 34.1734 Q1164.17 33.4443 1162.67 33.1202 Q1161.21 32.7556 1159.43 32.7556 Q1153.11 32.7556 1149.7 36.8875 Q1146.34 40.9789 1146.34 48.6757 L1146.34 72.576 L1138.85 72.576 L1138.85 27.2059 L1146.34 27.2059 L1146.34 34.2544 Q1148.69 30.1225 1152.46 28.1376 Q1156.23 26.1121 1161.61 26.1121 Q1162.38 26.1121 1163.31 26.2337 Q1164.25 26.3147 1165.38 26.5172 L1165.42 34.1734 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1208.12 18.8205 L1208.12 65.8515 L1218 65.8515 Q1230.52 65.8515 1236.31 60.1802 Q1242.15 54.509 1242.15 42.2752 Q1242.15 30.1225 1236.31 24.4918 Q1230.52 18.8205 1218 18.8205 L1208.12 18.8205 M1199.93 12.096 L1216.75 12.096 Q1234.33 12.096 1242.55 19.4281 Q1250.77 26.7198 1250.77 42.2752 Q1250.77 57.9117 1242.51 65.2439 Q1234.25 72.576 1216.75 72.576 L1199.93 72.576 L1199.93 12.096 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1263.49 27.2059 L1270.95 27.2059 L1270.95 72.576 L1263.49 72.576 L1263.49 27.2059 M1263.49 9.54393 L1270.95 9.54393 L1270.95 18.9825 L1263.49 18.9825 L1263.49 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1315.47 28.5427 L1315.47 35.5912 Q1312.31 33.9709 1308.9 33.1607 Q1305.5 32.3505 1301.86 32.3505 Q1296.31 32.3505 1293.51 34.0519 Q1290.76 35.7533 1290.76 39.156 Q1290.76 41.7486 1292.74 43.2475 Q1294.73 44.7058 1300.72 46.0426 L1303.27 46.6097 Q1311.21 48.3111 1314.53 51.4303 Q1317.9 54.509 1317.9 60.0587 Q1317.9 66.3781 1312.87 70.0644 Q1307.89 73.7508 1299.14 73.7508 Q1295.5 73.7508 1291.53 73.0216 Q1287.6 72.3329 1283.22 70.9151 L1283.22 63.2184 Q1287.35 65.3654 1291.36 66.4591 Q1295.37 67.5124 1299.3 67.5124 Q1304.57 67.5124 1307.41 65.73 Q1310.24 63.9071 1310.24 60.6258 Q1310.24 57.5877 1308.18 55.9673 Q1306.15 54.3469 1299.22 52.8481 L1296.63 52.2405 Q1289.7 50.7821 1286.62 47.7845 Q1283.55 44.7463 1283.55 39.4801 Q1283.55 33.0797 1288.08 29.5959 Q1292.62 26.1121 1300.96 26.1121 Q1305.1 26.1121 1308.74 26.7198 Q1312.39 27.3274 1315.47 28.5427 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1337.14 14.324 L1337.14 27.2059 L1352.49 27.2059 L1352.49 32.9987 L1337.14 32.9987 L1337.14 57.6282 Q1337.14 63.1779 1338.64 64.7578 Q1340.18 66.3376 1344.84 66.3376 L1352.49 66.3376 L1352.49 72.576 L1344.84 72.576 Q1336.21 72.576 1332.93 69.3758 Q1329.64 66.1351 1329.64 57.6282 L1329.64 32.9987 L1324.18 32.9987 L1324.18 27.2059 L1329.64 27.2059 L1329.64 14.324 L1337.14 14.324 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1388.59 34.1734 Q1387.33 33.4443 1385.83 33.1202 Q1384.37 32.7556 1382.59 32.7556 Q1376.27 32.7556 1372.87 36.8875 Q1369.51 40.9789 1369.51 48.6757 L1369.51 72.576 L1362.01 72.576 L1362.01 27.2059 L1369.51 27.2059 L1369.51 34.2544 Q1371.86 30.1225 1375.62 28.1376 Q1379.39 26.1121 1384.78 26.1121 Q1385.55 26.1121 1386.48 26.2337 Q1387.41 26.3147 1388.54 26.5172 L1388.59 34.1734 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1396.4 27.2059 L1403.86 27.2059 L1403.86 72.576 L1396.4 72.576 L1396.4 27.2059 M1396.4 9.54393 L1403.86 9.54393 L1403.86 18.9825 L1396.4 18.9825 L1396.4 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1452.02 49.9314 Q1452.02 41.7081 1448.62 37.0496 Q1445.26 32.3505 1439.34 32.3505 Q1433.43 32.3505 1430.03 37.0496 Q1426.66 41.7081 1426.66 49.9314 Q1426.66 58.1548 1430.03 62.8538 Q1433.43 67.5124 1439.34 67.5124 Q1445.26 67.5124 1448.62 62.8538 Q1452.02 58.1548 1452.02 49.9314 M1426.66 34.0924 Q1429.01 30.0415 1432.58 28.0971 Q1436.18 26.1121 1441.17 26.1121 Q1449.43 26.1121 1454.57 32.6746 Q1459.76 39.2371 1459.76 49.9314 Q1459.76 60.6258 1454.57 67.1883 Q1449.43 73.7508 1441.17 73.7508 Q1436.18 73.7508 1432.58 71.8063 Q1429.01 69.8214 1426.66 65.7705 L1426.66 72.576 L1419.17 72.576 L1419.17 9.54393 L1426.66 9.54393 L1426.66 34.0924 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1471.35 54.671 L1471.35 27.2059 L1478.8 27.2059 L1478.8 54.3874 Q1478.8 60.8284 1481.31 64.0691 Q1483.82 67.2693 1488.85 67.2693 Q1494.88 67.2693 1498.36 63.421 Q1501.89 59.5726 1501.89 52.9291 L1501.89 27.2059 L1509.34 27.2059 L1509.34 72.576 L1501.89 72.576 L1501.89 65.6084 Q1499.18 69.7404 1495.57 71.7658 Q1492.01 73.7508 1487.27 73.7508 Q1479.45 73.7508 1475.4 68.8897 Q1471.35 64.0286 1471.35 54.671 M1490.1 26.1121 L1490.1 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1532.07 14.324 L1532.07 27.2059 L1547.42 27.2059 L1547.42 32.9987 L1532.07 32.9987 L1532.07 57.6282 Q1532.07 63.1779 1533.57 64.7578 Q1535.11 66.3376 1539.77 66.3376 L1547.42 66.3376 L1547.42 72.576 L1539.77 72.576 Q1531.14 72.576 1527.86 69.3758 Q1524.57 66.1351 1524.57 57.6282 L1524.57 32.9987 L1519.11 32.9987 L1519.11 27.2059 L1524.57 27.2059 L1524.57 14.324 L1532.07 14.324 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1557.22 27.2059 L1564.68 27.2059 L1564.68 72.576 L1557.22 72.576 L1557.22 27.2059 M1557.22 9.54393 L1564.68 9.54393 L1564.68 18.9825 L1557.22 18.9825 L1557.22 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1597.86 32.4315 Q1591.86 32.4315 1588.38 37.1306 Q1584.89 41.7891 1584.89 49.9314 Q1584.89 58.0738 1588.34 62.7728 Q1591.82 67.4314 1597.86 67.4314 Q1603.81 67.4314 1607.29 62.7323 Q1610.78 58.0333 1610.78 49.9314 Q1610.78 41.8701 1607.29 37.1711 Q1603.81 32.4315 1597.86 32.4315 M1597.86 26.1121 Q1607.58 26.1121 1613.13 32.4315 Q1618.68 38.7509 1618.68 49.9314 Q1618.68 61.0714 1613.13 67.4314 Q1607.58 73.7508 1597.86 73.7508 Q1588.09 73.7508 1582.54 67.4314 Q1577.03 61.0714 1577.03 49.9314 Q1577.03 38.7509 1582.54 32.4315 Q1588.09 26.1121 1597.86 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1668.75 45.1919 L1668.75 72.576 L1661.29 72.576 L1661.29 45.4349 Q1661.29 38.994 1658.78 35.7938 Q1656.27 32.5936 1651.25 32.5936 Q1645.21 32.5936 1641.73 36.4419 Q1638.24 40.2903 1638.24 46.9338 L1638.24 72.576 L1630.75 72.576 L1630.75 27.2059 L1638.24 27.2059 L1638.24 34.2544 Q1640.92 30.163 1644.52 28.1376 Q1648.17 26.1121 1652.91 26.1121 Q1660.73 26.1121 1664.74 30.9732 Q1668.75 35.7938 1668.75 45.1919 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip682)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="276.581,1324.83 286.242,1324.83 295.903,1324.83 305.564,1324.82 315.224,1324.81 324.885,1324.78 334.546,1324.73 344.207,1324.67 353.868,1324.61 363.528,1324.53 373.189,1324.42 382.85,1324.28 392.511,1324.12 402.172,1323.96 411.832,1323.82 421.493,1323.74 431.154,1323.72 440.815,1323.68 450.476,1323.51 460.136,1323.09 469.797,1322.41 479.458,1321.6 489.119,1320.82 498.78,1320.17 508.441,1319.61 518.101,1319.08 527.762,1318.46 537.423,1317.68 547.084,1316.64 556.745,1315.27 566.405,1313.48 576.066,1311.28 585.727,1308.73 595.388,1305.97 605.049,1303.07 614.709,1300.04 624.37,1296.82 634.031,1293.28 643.692,1289.23 653.353,1284.49 663.013,1278.9 672.674,1272.36 682.335,1264.88 691.996,1256.56 701.657,1247.26 711.317,1236.1 720.978,1219.62 730.639,1188.14 740.3,1124.02 749.961,1012.16 759.621,866.515 769.282,744.81 778.943,713.084 788.604,782.578 798.265,897.19 807.925,989.473 817.586,1032.18 827.247,1035.58 836.908,1018.8 846.569,993.996 856.229,966.235 865.89,937.213 875.551,907.738 885.212,878.57 894.873,849.848 904.533,820.351 914.194,787.985 923.855,751.291 933.516,710.801 943.177,669.339 952.837,630.776 962.498,597.306 972.159,567.388 981.82,536.902 991.481,502.608 1001.14,464.46 1010.8,425.378 1020.46,389.272 1030.12,358.442 1039.78,332.359 1049.45,308.971 1059.11,286.522 1068.77,263.961 1078.43,241.032 1088.09,218.807 1097.75,199.392 1107.41,184.48 1117.07,174.191 1126.73,167.354 1136.39,162.712 1146.05,159.712 1155.71,158.463 1165.38,159.264 1175.04,162.112 1184.7,166.588 1194.36,172.237 1204.02,179.155 1213.68,188.427 1223.34,201.76 1233,219.857 1242.66,241.122 1252.32,262.821 1261.98,283.713 1271.64,305.111 1281.3,329.55 1290.97,358.643 1300.63,391.623 1310.29,425.737 1319.95,458.511 1329.61,489.806 1339.27,521.68 1348.93,556.389 1358.59,594.258 1368.25,633.275 1377.91,670.926 1387.57,706.224 1397.23,739.879 1406.9,773.134 1416.56,806.664 1426.22,839.986 1435.88,871.7 1445.54,900.856 1455.2,928.146 1464.86,955.106 1474.52,982.199 1484.18,1008.45 1493.84,1032.93 1503.5,1055.68 1513.16,1077.19 1522.82,1097.76 1532.49,1117.49 1542.15,1136.3 1551.81,1153.82 1561.47,1169.48 1571.13,1183.01 1580.79,1194.74 1590.45,1205.56 1600.11,1216.35 1609.77,1227.22 1619.43,1237.59 1629.09,1247.03 1638.75,1255.72 1648.42,1264.05 1658.08,1272.03 1667.74,1279.21 1677.4,1285.12 1687.06,1289.61 1696.72,1293.03 1706.38,1296.06 1716.04,1299.22 1725.7,1302.54 1735.36,1305.75 1745.02,1308.57 1754.68,1310.94 1764.34,1312.92 1774.01,1314.63 1783.67,1316.15 1793.33,1317.51 1802.99,1318.69 1812.65,1319.68 1822.31,1320.52 1831.97,1321.23 1841.63,1321.83 1851.29,1322.3 1860.95,1322.66 1870.61,1322.94 1880.27,1323.18 1889.94,1323.41 1899.6,1323.64 1909.26,1323.81 1918.92,1323.92 1928.58,1323.95 1938.24,1323.97 1947.9,1324.03 1957.56,1324.12 1967.22,1324.22 1976.88,1324.33 1986.54,1324.46 1996.2,1324.58 2005.86,1324.68 2015.53,1324.71 2025.19,1324.68 2034.85,1324.63 2044.51,1324.59 2054.17,1324.59 2063.83,1324.65 2073.49,1324.72 2083.15,1324.77 2092.81,1324.78 2102.47,1324.76 2112.13,1324.73 2121.79,1324.7 2131.46,1324.71 2141.12,1324.74 2150.78,1324.78 2160.44,1324.81 2170.1,1324.82 2179.76,1324.83 2189.42,1324.83 2199.08,1324.83 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#ffc0cb; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1428.25,2596.17 1428.25,-1112.88 "></polyline>
<path clip-path="url(#clip680)" d="M1799.28 320.204 L2188.83 320.204 L2188.83 164.684 L1799.28 164.684  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1799.28,320.204 2188.83,320.204 2188.83,164.684 1799.28,164.684 1799.28,320.204 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1821.92,216.524 1957.78,216.524 "></polyline>
<path clip-path="url(#clip680)" d="M1994.26 236.211 Q1992.46 240.841 1990.75 242.253 Q1989.03 243.665 1986.16 243.665 L1982.76 243.665 L1982.76 240.1 L1985.26 240.1 Q1987.02 240.1 1987.99 239.267 Q1988.96 238.433 1990.14 235.331 L1990.91 233.387 L1980.42 207.878 L1984.94 207.878 L1993.04 228.156 L2001.14 207.878 L2005.65 207.878 L1994.26 236.211 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M2012.94 229.869 L2020.58 229.869 L2020.58 203.503 L2012.27 205.17 L2012.27 200.91 L2020.54 199.244 L2025.21 199.244 L2025.21 229.869 L2032.85 229.869 L2032.85 233.804 L2012.94 233.804 L2012.94 229.869 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip680)" style="stroke:#ffc0cb; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1821.92,268.364 1957.78,268.364 "></polyline>
<path clip-path="url(#clip680)" d="M2005.07 259.718 L1995.7 272.334 L2005.56 285.644 L2000.54 285.644 L1992.99 275.459 L1985.45 285.644 L1980.42 285.644 L1990.49 272.079 L1981.28 259.718 L1986.3 259.718 L1993.18 268.954 L2000.05 259.718 L2005.07 259.718 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M2029.24 251.084 L2041.81 263.977 L2037.16 263.977 L2026.97 254.834 L2016.79 263.977 L2012.13 263.977 L2024.7 251.084 L2029.24 251.084 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M2069.13 256.778 L2060.82 261.269 L2069.13 265.783 L2067.78 268.051 L2060 263.352 L2060 272.079 L2057.37 272.079 L2057.37 263.352 L2049.59 268.051 L2048.25 265.783 L2056.56 261.269 L2048.25 256.778 L2049.59 254.486 L2057.37 259.186 L2057.37 250.459 L2060 250.459 L2060 259.186 L2067.78 254.486 L2069.13 256.778 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M2090.63 264.116 L2120.31 264.116 L2120.31 268.005 L2090.63 268.005 L2090.63 264.116 M2090.63 273.56 L2120.31 273.56 L2120.31 277.496 L2090.63 277.496 L2090.63 273.56 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M2146.28 281.709 L2153.92 281.709 L2153.92 255.343 L2145.61 257.01 L2145.61 252.75 L2153.87 251.084 L2158.55 251.084 L2158.55 281.709 L2166.18 281.709 L2166.18 285.644 L2146.28 285.644 L2146.28 281.709 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="注（$x^*=0$ でのアトムについて）">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>注（<span class="math inline">\(x^*=0\)</span> でのアトムについて）
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math inline">\(x^*=0\)</span> に原子が存在する．</p>
<p>ここでは密度関数は滑らかに見えるが，実際には <span class="math inline">\(x^*=0\)</span> で不連続である．</p>
<p>これは，計算の都合上，<span class="math inline">\(\delta_0\)</span> を <span class="math inline">\(\mathrm{N}(0,0.005)\)</span> で代用したためである．</p>
</div>
</div>
</div>
</section>
<section id="map-推定量" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="map-推定量"><span class="header-section-number">1.3</span> MAP 推定量</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定義 (maximum a posterior estimator)">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>定義 (maximum a posterior estimator)
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[
\widehat{x}:=\operatorname*{argmax}_{x\in\mathbb{R}}\;p(x|y_1,\cdots,y_n)
\]</span> で定まる推定量 <span class="math inline">\(\mathbb{R}^n\to\mathbb{R}\)</span> を <strong>MAP 推定量</strong> という．</p>
</div>
</div>
<p>例 <a href="#sec-example" class="quarto-xref">1.2</a> などをはじめ，ほとんどの場面では良い推定量を与え，多くの場合の最初のチョイスとして適しているかもしれない．</p>
<p>しかし，例 <a href="#sec-example" class="quarto-xref">1.2</a> をさらに変形することで，次のような事後分布が得られる状況は容易に想像がつく：</p>
<div id="cell-fig-1" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">f</span>(x)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">-</span><span class="fl">1.8</span> <span class="op">&lt;</span> x <span class="op">&lt;</span> <span class="op">-</span><span class="fl">1.6</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">2.5</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elseif</span> <span class="fl">0</span> <span class="op">&lt;</span> x <span class="op">&lt;</span> <span class="fl">1.5</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">1</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">0</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, size<span class="op">=</span>(<span class="fl">600</span>, <span class="fl">400</span>), legend<span class="op">=</span><span class="cn">false</span>, color<span class="op">=</span><span class="st">"#78C2AD"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div id="fig-1" class="cell-output cell-output-display quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="7">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewbox="0 0 2400 1600">
<defs>
  <clippath id="clip810">
    <rect x="0" y="0" width="2400" height="1600"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip810)" d="M0 1600 L2400 1600 L2400 8.88178e-14 L0 8.88178e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip811">
    <rect x="480" y="0" width="1681" height="1600"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip810)" d="M156.112 1486.45 L2352.76 1486.45 L2352.76 47.2441 L156.112 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip812">
    <rect x="156" y="47" width="2198" height="1440"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.281,1486.45 218.281,47.2441 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="736.358,1486.45 736.358,47.2441 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1254.43,1486.45 1254.43,47.2441 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1772.51,1486.45 1772.51,47.2441 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2290.59,1486.45 2290.59,47.2441 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,1486.45 2352.76,1486.45 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.281,1486.45 218.281,1467.55 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="736.358,1486.45 736.358,1467.55 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1254.43,1486.45 1254.43,1467.55 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1772.51,1486.45 1772.51,1467.55 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2290.59,1486.45 2290.59,1467.55 "></polyline>
<path clip-path="url(#clip810)" d="M188.224 1532.02 L217.899 1532.02 L217.899 1535.95 L188.224 1535.95 L188.224 1532.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M232.02 1544.91 L248.339 1544.91 L248.339 1548.85 L226.395 1548.85 L226.395 1544.91 Q229.057 1542.16 233.64 1537.53 Q238.246 1532.88 239.427 1531.53 Q241.672 1529.01 242.552 1527.27 Q243.455 1525.51 243.455 1523.82 Q243.455 1521.07 241.51 1519.33 Q239.589 1517.6 236.487 1517.6 Q234.288 1517.6 231.834 1518.36 Q229.404 1519.13 226.626 1520.68 L226.626 1515.95 Q229.45 1514.82 231.904 1514.24 Q234.358 1513.66 236.395 1513.66 Q241.765 1513.66 244.959 1516.35 Q248.154 1519.03 248.154 1523.52 Q248.154 1525.65 247.344 1527.57 Q246.557 1529.47 244.45 1532.07 Q243.871 1532.74 240.77 1535.95 Q237.668 1539.15 232.02 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M706.115 1532.02 L735.791 1532.02 L735.791 1535.95 L706.115 1535.95 L706.115 1532.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M746.693 1544.91 L754.332 1544.91 L754.332 1518.55 L746.022 1520.21 L746.022 1515.95 L754.286 1514.29 L758.962 1514.29 L758.962 1544.91 L766.601 1544.91 L766.601 1548.85 L746.693 1548.85 L746.693 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M1254.43 1517.37 Q1250.82 1517.37 1248.99 1520.93 Q1247.19 1524.47 1247.19 1531.6 Q1247.19 1538.71 1248.99 1542.27 Q1250.82 1545.82 1254.43 1545.82 Q1258.07 1545.82 1259.87 1542.27 Q1261.7 1538.71 1261.7 1531.6 Q1261.7 1524.47 1259.87 1520.93 Q1258.07 1517.37 1254.43 1517.37 M1254.43 1513.66 Q1260.24 1513.66 1263.3 1518.27 Q1266.38 1522.85 1266.38 1531.6 Q1266.38 1540.33 1263.3 1544.94 Q1260.24 1549.52 1254.43 1549.52 Q1248.62 1549.52 1245.55 1544.94 Q1242.49 1540.33 1242.49 1531.6 Q1242.49 1522.85 1245.55 1518.27 Q1248.62 1513.66 1254.43 1513.66 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M1762.89 1544.91 L1770.53 1544.91 L1770.53 1518.55 L1762.22 1520.21 L1762.22 1515.95 L1770.48 1514.29 L1775.16 1514.29 L1775.16 1544.91 L1782.8 1544.91 L1782.8 1548.85 L1762.89 1548.85 L1762.89 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M2285.24 1544.91 L2301.56 1544.91 L2301.56 1548.85 L2279.61 1548.85 L2279.61 1544.91 Q2282.28 1542.16 2286.86 1537.53 Q2291.47 1532.88 2292.65 1531.53 Q2294.89 1529.01 2295.77 1527.27 Q2296.67 1525.51 2296.67 1523.82 Q2296.67 1521.07 2294.73 1519.33 Q2292.81 1517.6 2289.71 1517.6 Q2287.51 1517.6 2285.05 1518.36 Q2282.62 1519.13 2279.85 1520.68 L2279.85 1515.95 Q2282.67 1514.82 2285.12 1514.24 Q2287.58 1513.66 2289.61 1513.66 Q2294.98 1513.66 2298.18 1516.35 Q2301.37 1519.03 2301.37 1523.52 Q2301.37 1525.65 2300.56 1527.57 Q2299.78 1529.47 2297.67 1532.07 Q2297.09 1532.74 2293.99 1535.95 Q2290.89 1539.15 2285.24 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,1445.72 2352.76,1445.72 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,1174.17 2352.76,1174.17 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,902.62 2352.76,902.62 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,631.072 2352.76,631.072 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,359.524 2352.76,359.524 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,87.9763 2352.76,87.9763 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,1486.45 156.112,47.2441 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,1445.72 175.01,1445.72 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,1174.17 175.01,1174.17 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,902.62 175.01,902.62 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,631.072 175.01,631.072 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,359.524 175.01,359.524 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,87.9763 175.01,87.9763 "></polyline>
<path clip-path="url(#clip810)" d="M62.9365 1431.51 Q59.3254 1431.51 57.4967 1435.08 Q55.6912 1438.62 55.6912 1445.75 Q55.6912 1452.86 57.4967 1456.42 Q59.3254 1459.96 62.9365 1459.96 Q66.5707 1459.96 68.3763 1456.42 Q70.205 1452.86 70.205 1445.75 Q70.205 1438.62 68.3763 1435.08 Q66.5707 1431.51 62.9365 1431.51 M62.9365 1427.81 Q68.7467 1427.81 71.8022 1432.42 Q74.8809 1437 74.8809 1445.75 Q74.8809 1454.48 71.8022 1459.08 Q68.7467 1463.67 62.9365 1463.67 Q57.1264 1463.67 54.0477 1459.08 Q50.9921 1454.48 50.9921 1445.75 Q50.9921 1437 54.0477 1432.42 Q57.1264 1427.81 62.9365 1427.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M83.0984 1457.12 L87.9827 1457.12 L87.9827 1463 L83.0984 1463 L83.0984 1457.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M108.168 1431.51 Q104.557 1431.51 102.728 1435.08 Q100.922 1438.62 100.922 1445.75 Q100.922 1452.86 102.728 1456.42 Q104.557 1459.96 108.168 1459.96 Q111.802 1459.96 113.608 1456.42 Q115.436 1452.86 115.436 1445.75 Q115.436 1438.62 113.608 1435.08 Q111.802 1431.51 108.168 1431.51 M108.168 1427.81 Q113.978 1427.81 117.033 1432.42 Q120.112 1437 120.112 1445.75 Q120.112 1454.48 117.033 1459.08 Q113.978 1463.67 108.168 1463.67 Q102.358 1463.67 99.2789 1459.08 Q96.2234 1454.48 96.2234 1445.75 Q96.2234 1437 99.2789 1432.42 Q102.358 1427.81 108.168 1427.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M63.9319 1159.97 Q60.3208 1159.97 58.4921 1163.53 Q56.6865 1167.07 56.6865 1174.2 Q56.6865 1181.31 58.4921 1184.87 Q60.3208 1188.42 63.9319 1188.42 Q67.5661 1188.42 69.3717 1184.87 Q71.2004 1181.31 71.2004 1174.2 Q71.2004 1167.07 69.3717 1163.53 Q67.5661 1159.97 63.9319 1159.97 M63.9319 1156.26 Q69.742 1156.26 72.7976 1160.87 Q75.8763 1165.45 75.8763 1174.2 Q75.8763 1182.93 72.7976 1187.54 Q69.742 1192.12 63.9319 1192.12 Q58.1217 1192.12 55.043 1187.54 Q51.9875 1182.93 51.9875 1174.2 Q51.9875 1165.45 55.043 1160.87 Q58.1217 1156.26 63.9319 1156.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M84.0938 1185.57 L88.978 1185.57 L88.978 1191.45 L84.0938 1191.45 L84.0938 1185.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M99.2095 1156.89 L117.566 1156.89 L117.566 1160.82 L103.492 1160.82 L103.492 1169.3 Q104.51 1168.95 105.529 1168.79 Q106.547 1168.6 107.566 1168.6 Q113.353 1168.6 116.733 1171.77 Q120.112 1174.94 120.112 1180.36 Q120.112 1185.94 116.64 1189.04 Q113.168 1192.12 106.848 1192.12 Q104.672 1192.12 102.404 1191.75 Q100.159 1191.38 97.7511 1190.64 L97.7511 1185.94 Q99.8345 1187.07 102.057 1187.63 Q104.279 1188.18 106.756 1188.18 Q110.76 1188.18 113.098 1186.08 Q115.436 1183.97 115.436 1180.36 Q115.436 1176.75 113.098 1174.64 Q110.76 1172.54 106.756 1172.54 Q104.881 1172.54 103.006 1172.95 Q101.154 1173.37 99.2095 1174.25 L99.2095 1156.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M53.7467 915.965 L61.3856 915.965 L61.3856 889.599 L53.0754 891.266 L53.0754 887.007 L61.3393 885.34 L66.0152 885.34 L66.0152 915.965 L73.654 915.965 L73.654 919.9 L53.7467 919.9 L53.7467 915.965 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M83.0984 914.02 L87.9827 914.02 L87.9827 919.9 L83.0984 919.9 L83.0984 914.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M108.168 888.419 Q104.557 888.419 102.728 891.983 Q100.922 895.525 100.922 902.655 Q100.922 909.761 102.728 913.326 Q104.557 916.868 108.168 916.868 Q111.802 916.868 113.608 913.326 Q115.436 909.761 115.436 902.655 Q115.436 895.525 113.608 891.983 Q111.802 888.419 108.168 888.419 M108.168 884.715 Q113.978 884.715 117.033 889.321 Q120.112 893.905 120.112 902.655 Q120.112 911.381 117.033 915.988 Q113.978 920.571 108.168 920.571 Q102.358 920.571 99.2789 915.988 Q96.2234 911.381 96.2234 902.655 Q96.2234 893.905 99.2789 889.321 Q102.358 884.715 108.168 884.715 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M54.7421 644.417 L62.381 644.417 L62.381 618.051 L54.0708 619.718 L54.0708 615.459 L62.3347 613.792 L67.0106 613.792 L67.0106 644.417 L74.6494 644.417 L74.6494 648.352 L54.7421 648.352 L54.7421 644.417 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M84.0938 642.472 L88.978 642.472 L88.978 648.352 L84.0938 648.352 L84.0938 642.472 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M99.2095 613.792 L117.566 613.792 L117.566 617.727 L103.492 617.727 L103.492 626.199 Q104.51 625.852 105.529 625.69 Q106.547 625.505 107.566 625.505 Q113.353 625.505 116.733 628.676 Q120.112 631.848 120.112 637.264 Q120.112 642.843 116.64 645.945 Q113.168 649.023 106.848 649.023 Q104.672 649.023 102.404 648.653 Q100.159 648.283 97.7511 647.542 L97.7511 642.843 Q99.8345 643.977 102.057 644.533 Q104.279 645.088 106.756 645.088 Q110.76 645.088 113.098 642.982 Q115.436 640.875 115.436 637.264 Q115.436 633.653 113.098 631.547 Q110.76 629.44 106.756 629.44 Q104.881 629.44 103.006 629.857 Q101.154 630.273 99.2095 631.153 L99.2095 613.792 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M56.9643 372.869 L73.2837 372.869 L73.2837 376.804 L51.3393 376.804 L51.3393 372.869 Q54.0014 370.114 58.5847 365.485 Q63.1911 360.832 64.3717 359.489 Q66.617 356.966 67.4967 355.23 Q68.3994 353.471 68.3994 351.781 Q68.3994 349.027 66.455 347.29 Q64.5337 345.554 61.4319 345.554 Q59.2328 345.554 56.7791 346.318 Q54.3486 347.082 51.5708 348.633 L51.5708 343.911 Q54.3949 342.777 56.8486 342.198 Q59.3023 341.619 61.3393 341.619 Q66.7096 341.619 69.9041 344.304 Q73.0985 346.99 73.0985 351.48 Q73.0985 353.61 72.2883 355.531 Q71.5013 357.429 69.3948 360.022 Q68.8161 360.693 65.7143 363.911 Q62.6124 367.105 56.9643 372.869 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M83.0984 370.925 L87.9827 370.925 L87.9827 376.804 L83.0984 376.804 L83.0984 370.925 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M108.168 345.323 Q104.557 345.323 102.728 348.888 Q100.922 352.429 100.922 359.559 Q100.922 366.665 102.728 370.23 Q104.557 373.772 108.168 373.772 Q111.802 373.772 113.608 370.23 Q115.436 366.665 115.436 359.559 Q115.436 352.429 113.608 348.888 Q111.802 345.323 108.168 345.323 M108.168 341.619 Q113.978 341.619 117.033 346.226 Q120.112 350.809 120.112 359.559 Q120.112 368.286 117.033 372.892 Q113.978 377.475 108.168 377.475 Q102.358 377.475 99.2789 372.892 Q96.2234 368.286 96.2234 359.559 Q96.2234 350.809 99.2789 346.226 Q102.358 341.619 108.168 341.619 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M57.9597 101.321 L74.279 101.321 L74.279 105.256 L52.3347 105.256 L52.3347 101.321 Q54.9967 98.5665 59.58 93.9369 Q64.1865 89.2841 65.367 87.9416 Q67.6124 85.4184 68.492 83.6823 Q69.3948 81.9231 69.3948 80.2333 Q69.3948 77.4786 67.4504 75.7425 Q65.5291 74.0064 62.4272 74.0064 Q60.2282 74.0064 57.7745 74.7703 Q55.344 75.5342 52.5662 77.0851 L52.5662 72.3629 Q55.3903 71.2287 57.8439 70.65 Q60.2976 70.0713 62.3347 70.0713 Q67.705 70.0713 70.8994 72.7565 Q74.0939 75.4416 74.0939 79.9323 Q74.0939 82.062 73.2837 83.9832 Q72.4966 85.8814 70.3902 88.474 Q69.8115 89.1453 66.7096 92.3628 Q63.6078 95.5573 57.9597 101.321 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M84.0938 99.3767 L88.978 99.3767 L88.978 105.256 L84.0938 105.256 L84.0938 99.3767 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M99.2095 70.6963 L117.566 70.6963 L117.566 74.6314 L103.492 74.6314 L103.492 83.1036 Q104.51 82.7564 105.529 82.5944 Q106.547 82.4092 107.566 82.4092 Q113.353 82.4092 116.733 85.5805 Q120.112 88.7517 120.112 94.1684 Q120.112 99.747 116.64 102.849 Q113.168 105.928 106.848 105.928 Q104.672 105.928 102.404 105.557 Q100.159 105.187 97.7511 104.446 L97.7511 99.747 Q99.8345 100.881 102.057 101.437 Q104.279 101.992 106.756 101.992 Q110.76 101.992 113.098 99.8859 Q115.436 97.7795 115.436 94.1684 Q115.436 90.5573 113.098 88.4508 Q110.76 86.3443 106.756 86.3443 Q104.881 86.3443 103.006 86.761 Q101.154 87.1777 99.2095 88.0573 L99.2095 70.6963 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip812)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.281,1445.72 221.654,1445.72 225.027,1445.72 228.4,1445.72 231.773,1445.72 247.367,1445.72 262.961,1445.72 278.555,1445.72 294.149,1445.72 301.946,1445.72 309.743,1445.72 313.641,1445.72 317.54,1445.72 318.514,1445.72 319.489,1445.72 320.464,1445.72 321.438,1445.72 322.413,87.9763 323.388,87.9763 324.362,87.9763 325.337,87.9763 327.286,87.9763 329.235,87.9763 331.185,87.9763 333.134,87.9763 337.032,87.9763 340.931,87.9763 348.728,87.9763 356.525,87.9763 375.267,87.9763 394.01,87.9763 403.381,87.9763 412.753,87.9763 415.095,87.9763 417.438,87.9763 419.781,87.9763 422.124,87.9763 422.71,87.9763 423.295,87.9763 423.881,87.9763 424.467,87.9763 425.052,87.9763 425.638,1445.72 426.224,1445.72 426.809,1445.72 427.981,1445.72 429.152,1445.72 430.324,1445.72 431.495,1445.72 435.457,1445.72 439.418,1445.72 443.38,1445.72 447.342,1445.72 455.265,1445.72 463.188,1445.72 479.035,1445.72 494.882,1445.72 563.737,1445.72 627.216,1445.72 695.272,1445.72 774.122,1445.72 844.194,1445.72 905.641,1445.72 972.634,1445.72 1040.03,1445.72 1077.28,1445.72 1114.54,1445.72 1149.98,1445.72 1185.43,1445.72 1203.86,1445.72 1222.29,1445.72 1231.5,1445.72 1240.72,1445.72 1243.02,1445.72 1245.32,1445.72 1247.63,1445.72 1249.93,1445.72 1251.08,1445.72 1252.23,1445.72 1252.81,1445.72 1253.39,1445.72 1253.96,1445.72 1254.54,902.62 1255.11,902.62 1255.69,902.62 1256.27,902.62 1256.84,902.62 1257.99,902.62 1259.14,902.62 1263.02,902.62 1266.9,902.62 1270.78,902.62 1274.66,902.62 1282.41,902.62 1290.17,902.62 1305.68,902.62 1321.2,902.62 1396.95,902.62 1466.35,902.62 1530.45,902.62 1595.38,902.62 1668.14,902.62 1734.08,902.62 1809.57,902.62 1879.47,902.62 1913.92,902.62 1948.38,902.62 1965.11,902.62 1981.83,902.62 1990.2,902.62 1998.56,902.62 2006.93,902.62 2015.29,902.62 2019.58,902.62 2023.86,902.62 2026.01,902.62 2028.15,902.62 2029.22,902.62 2030.29,902.62 2030.83,902.62 2031.36,902.62 2031.9,1445.72 2032.44,1445.72 2032.97,1445.72 2033.51,1445.72 2034.04,1445.72 2034.58,1445.72 2035.65,1445.72 2036.72,1445.72 2038.87,1445.72 2041.01,1445.72 2045.3,1445.72 2049.58,1445.72 2066.73,1445.72 2083.88,1445.72 2121.45,1445.72 2159.03,1445.72 2213.61,1445.72 2268.19,1445.72 2279.39,1445.72 2290.59,1445.72 "></polyline>
</svg>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;1
</figcaption>
</figure>
</div>
</div>
</section>
<section id="ベイズ最適推定量" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="ベイズ最適推定量"><span class="header-section-number">1.4</span> ベイズ最適推定量</h3>
<p><a href="#fig-1" class="quarto-xref">図&nbsp;1</a> の状況でも，たしかに１点のみを選ぶならば MAP 推定量で良いかもしれないが，<span class="math inline">\(x\le0\)</span> である確率は <span class="math inline">\(x\ge0\)</span> である確率よりも低いため，この意味では，<span class="math inline">\(x\in[0,3/2]\)</span> の範囲に推定量が収まっていた方が好ましいかもしれない．</p>
<p>推定量 <span class="math inline">\(\widehat{x}_n:\mathbb{R}^n\to\mathbb{R}\)</span> を評価するには，何らかのアプリオリな <strong>損失</strong> の概念が必要である．これを損失関数 <span class="math inline">\(L:\mathbb{R}^2\to\mathbb{R}\)</span> という形で与える．</p>
<p>すると，損失の期待値が計算可能になり，これを <strong>危険</strong> という： <span class="math display">\[
R(\widehat{x}_n):=\operatorname{E}[L(\widehat{x}_n(\boldsymbol{Y}),X)].
\]</span></p>
<p>このリスクを最小化する推定量を <strong>ベイズ最適推定量</strong>，その際のリスクを <strong>ベイズリスク</strong> という．<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<section id="sec-MMSE" class="level4" data-number="1.4.1">
<h4 data-number="1.4.1" class="anchored" data-anchor-id="sec-MMSE"><span class="header-section-number">1.4.1</span> <span class="math inline">\(l^2\)</span>-ベイズ最適推定量</h4>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>命題
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(L(x,y):=(x-y)^2\)</span> と定める．このとき，<strong>事後平均</strong> がベイズリスクを達成する： <span class="math display">\[
\widehat{x}(\boldsymbol{y}):=\int_\mathbb{R}xp(x|\boldsymbol{y})\,
dx.
\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-empty-content callout-titled" title="証明">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
<p><a href="#fig-1" class="quarto-xref">図&nbsp;1</a> の場合では，事後平均は約 <span class="math inline">\(0.1\)</span> で，かろうじて正になる．</p>
</section>
<section id="l1-ベイズ最適推定量" class="level4" data-number="1.4.2">
<h4 data-number="1.4.2" class="anchored" data-anchor-id="l1-ベイズ最適推定量"><span class="header-section-number">1.4.2</span> <span class="math inline">\(l^1\)</span>-ベイズ最適推定量</h4>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>命題
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(L(x,y):=\lvert x-y\rvert\)</span> と定める．このとき，<strong>事後中央値</strong> がベイズリスクを達成する．</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-empty-content callout-titled" title="証明">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
<p><a href="#fig-1" class="quarto-xref">図&nbsp;1</a> の場合では，事後中央値は <span class="math inline">\(0.5\)</span> となる．大変頑健な推定だと言えるだろう．</p>
</section>
<section id="最適決定規則" class="level4" data-number="1.4.3">
<h4 data-number="1.4.3" class="anchored" data-anchor-id="最適決定規則"><span class="header-section-number">1.4.3</span> 最適決定規則</h4>
<p>今回の誤り訂正符号の文脈の目標は，<span class="math inline">\(x^*\)</span> の復元であることを思い出せば，今回の損失は <span class="math inline">\(L(x,y)=\delta_0(x-y)\)</span> ととり，復号が成功する確率を最大とする推定量が「最良」と言うべきであろう： <span class="math display">\[
R(\widehat{x}_n)=\operatorname{P}[\widehat{x}_n(\boldsymbol{Y})=X]
\]</span></p>
<p>これは結局 MAP 推定量 <span class="math display">\[
\widehat{x}_n:=\operatorname*{argmax}_{x\in\mathbb{R}}p(x|\boldsymbol{y})
\]</span> で与えられることになる．</p>
</section>
</section>
</section>
<section id="統計物理からの視点" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="統計物理からの視点"><span class="header-section-number">2</span> 統計物理からの視点</h2>
<p>真のシグナル <span class="math inline">\(x^*\in\mathbb{R}\)</span> を，Bayes 事後平均によって点推定する問題を，統計力学の観点から考察する．</p>
<p>次節 <a href="#sec-sparse-vector-denoising" class="quarto-xref">3</a> で，スパースな一般次元のベクトル <span class="math inline">\(x^*\in\mathbb{R}^d\)</span> を復元する問題に拡張する．</p>
<section id="sec-straightforward-identification" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="sec-straightforward-identification"><span class="header-section-number">2.1</span> 事後分布をある物理系の平衡分布と見る</h3>
<p>ベイズの公式 (<a href="#eq-bayes" class="quarto-xref">1</a>) が与える事後分布 <span class="math inline">\(p(x|\boldsymbol{y})\)</span> は，次の Boltzmann-Gibbs 分布として理解できる： <span class="math display">\[
p(x|\boldsymbol{y})=\frac{e^{\log p(\boldsymbol{y}|x)p(x)}}{p(\boldsymbol{y})}
\]</span> <span class="math display">\[
=\frac{e^{-H(x,\boldsymbol{y})}}{Z(\boldsymbol{y})},
\]</span> <span class="math display">\[
H(x,\boldsymbol{y}):=-\log p(\boldsymbol{y}|x)-\log p(x),
\]</span> <span class="math display">\[
Z(\boldsymbol{y}):=p(y).
\]</span></p>
<p>すなわち，Bayes 事後分布 <span class="math inline">\(p(x|\boldsymbol{y})\)</span> は，<span class="math inline">\(\mathbb{R}\times\mathbb{R}^n\)</span> を配位空間に持ち，Hamiltonian <span class="math inline">\(H(x,\boldsymbol{y})\)</span> を持つ正準集団の平衡分布と捉えることができる．</p>
<p>従って，Bayes 事後平均とは，この系に関する熱平均になる．加えて，MAP 推定量とは，この系に関する基底状態となる．</p>
<p>しかし，この系の，物理的な意義どころか，統計的な意義も定かではない．</p>
</section>
<section id="sec-identification" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="sec-identification"><span class="header-section-number">2.2</span> もう一つの見方</h3>
<p>今回，通信路は加法的に Gauss ノイズを加えるものとしたのであった： <span class="math display">\[
p(\boldsymbol{y}|x)d\boldsymbol{y}=\mathrm{N}(x,\sigma^2)^{\otimes n}(d\boldsymbol{y})
\]</span> この場合，前節 <a href="#sec-straightforward-identification" class="quarto-xref">2.1</a> でみた方法の他に，事後分布 <span class="math inline">\(p(x|\boldsymbol{y})\)</span> を次のように理解することもできる： <span class="math display">\[
p(x|\boldsymbol{y})=\frac{e^{-H(x,\boldsymbol{y})}}{Z(\boldsymbol{y})},
\]</span> <span class="math display">\[
H(x,\boldsymbol{y}):=\frac{1}{2\sigma^2}\sum_{i=1}^n(x^2-2xy_i)-\log p(x),
\]</span> <span class="math display">\[
Z(\boldsymbol{y}):=\left(\frac{1}{(2\pi\sigma^2)^{\frac{n}{2}}}\frac{e^{-\frac{\lvert\boldsymbol{y}\rvert^2}{2\sigma^2}}}{p(\boldsymbol{y})}\right)^{-1}.
\]</span></p>
<p>この Hamiltonian <span class="math inline">\(H\)</span> により定まる系の分配関数 <span class="math inline">\(Z(\boldsymbol{y})\)</span> は，情報源 <span class="math inline">\(p(x)\)</span> と Gauss 型通信路 <span class="math inline">\(p(\boldsymbol{y}|x)\)</span> で与えられた観測 <span class="math inline">\(\boldsymbol{y}\)</span> に関する周辺モデル <span class="math inline">\(p(\boldsymbol{y})\)</span> と，完全にランダムなホワイトノイズ <span class="math inline">\(\mathrm{N}(0,\sigma^2)^{\otimes n}\)</span> との尤度比，または <a href="https://ja.wikipedia.org/wiki/ベイズ因子"><strong>ベイズ因子</strong></a> になっている．</p>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="式変形">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>式変形
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math display">\[\begin{align*}
    p(x|\boldsymbol{y})&amp;=p(\boldsymbol{y}|x)\frac{p(x)}{p(\boldsymbol{y})}\\
    &amp;=\frac{p(x)}{p(\boldsymbol{y})}\frac{1}{(2\pi\sigma^2)^{\frac{n}{2}}}e^{-\frac{1}{2\sigma^2}\sum_{i=1}^n(x-y_i)^2}\\
    &amp;=\frac{p(x)}{p(\boldsymbol{y})}\frac{e^{-\frac{1}{2\sigma^2}\sum_{i=1}^ny_i^2}}{(2\pi\sigma^2)^{\frac{n}{2}}}e^{-\frac{1}{2\sigma^2}\sum_{i=1}^n(x^2-2xy_i)}\\
    &amp;=\frac{p(x)e^{-\frac{1}{2\sigma^2}\sum_{i=1}^n(x^2-2xy_i)}}{Z(\boldsymbol{y})}\\
    &amp;=\frac{1}{Z(\boldsymbol{y})}\exp\left(\log p(x)-\frac{1}{2\sigma^2}\sum_{i=1}^n(x^2-2xy_i)\right)
\end{align*}\]</span></p>
</div>
</div>
</div>
<p>さらに，この系 <span class="math inline">\(H\)</span> における自由エントロピーは，<span class="math inline">\(p(\boldsymbol{y})\)</span> と <span class="math inline">\(\mathrm{N}(0,\sigma^2)^{\otimes n}\)</span> との間の KL 乖離度となっている： <span class="math display">\[
F_n:=\int_{\mathbb{R}^n}\log\frac{p(\boldsymbol{y})}{q(\boldsymbol{y})}p(\boldsymbol{y})\,d\boldsymbol{y}=\operatorname{KL}(p,q).
\]</span> ただし，<span class="math inline">\(q\)</span> は <span class="math inline">\(\mathrm{N}(0,\sigma^2)^{\otimes n}\)</span> の密度とした．</p>
<p>この系の他の物理量も，自由エネルギーと定数倍違うのみとなっている：</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（エントロピーと相互情報量）^[[@Krzakala-Zdeborova2024 p.122]．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>命題（エントロピーと相互情報量）<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p>この Hamiltonian <span class="math inline">\(H\)</span> を持つ系について，</p>
<ol type="1">
<li><p>エントロピー <span class="math inline">\(H\)</span> は次で与えられる：</p>
<p><span class="math display">\[\begin{align*}
     H(Y)&amp;:=-\int_{\mathbb{R}^n}(\log p(\boldsymbol{y}))p(\boldsymbol{y})\,d\boldsymbol{y}\\
     &amp;=\frac{n}{2}\log(2\pi\sigma^2)\\
     &amp;\qquad+\frac{1}{2\sigma^2}\int_{\mathbb{R}^n}\lvert\boldsymbol{y}\rvert^2p(\boldsymbol{y})\,d\boldsymbol{y}-F_n.
\end{align*}\]</span></p></li>
<li><p>相互情報量 <span class="math inline">\(I\)</span> は次で与えられる：</p>
<p><span class="math display">\[\begin{align*}
     I(X,Y)&amp;:=\operatorname{KL}(p(x,y),p(x)p(y))\\\\
     &amp;=\frac{n}{2\sigma^2}\int_{\mathbb{R}}x^2p(x)\,dx-F_n.
\end{align*}\]</span></p></li>
</ol>
<p>特に，いずれも自由エネルギーの定数倍である</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>の式変形は次のとおり： <span class="math display">\[\begin{align*}
    H(Y)&amp;:=-\int_{\mathbb{R}^n}(\log p(\boldsymbol{y}))p(\boldsymbol{y})\,d\boldsymbol{y}\\
    &amp;=-\int_{\mathbb{R}^n}p(\boldsymbol{y})d\boldsymbol{y}\log q(\boldsymbol{y})-F_n\\
    &amp;=-\int_{\mathbb{R}^n}\biggr(-\frac{n}{2}\log(2\pi\sigma^2)-\frac{\lvert\boldsymbol{y}\rvert^2}{2\sigma^2}\biggl)p(\boldsymbol{y})d\boldsymbol{y}-F_n\\
    &amp;=\frac{n}{2}\log(2\pi\sigma^2)+\frac{n}{2\sigma^2}\int_{\mathbb{R}}y_i^2p(y_i)\,dy_i-F_n.
\end{align*}\]</span></p></li>
<li><p>次の関係式を用いる： <span class="math display">\[
I(X,Y)=H(Y)-H(Y|X)
\]</span> <span class="math inline">\(H(Y)\)</span> は 1. から判明しており，<span class="math inline">\(H(Y|X)\)</span> は次のように計算できる：</p>
<p><span class="math display">\[\begin{align*}
H(Y|X)&amp;=-\int_{\mathbb{R}^{n+1}}\log p(\boldsymbol{y}|x)p(\boldsymbol{y}|x)p(x)\,dxd\boldsymbol{y}\\
&amp;=-\int_{\mathbb{R}^{n+1}}\log\left(\frac{1}{(2\pi\sigma^2)^{\frac{n}{2}}}\exp\left(-\frac{1}{2\sigma^2}\sum_{i=1}^n(y_i-x)^2\right)\right)p(\boldsymbol{y}|x)p(x)\,dxd\boldsymbol{y}\\
&amp;=\int_{\mathbb{R}^{n+1}}\left(\frac{n}{2}\log(2\pi\sigma^2)+\frac{\sum_{i=1}^n(x-y_i)^2}{2\sigma^2}\right)p(\boldsymbol{y}|x)p(x)\,dxd\boldsymbol{y}\\
&amp;=\frac{n}{2}\log(2\pi\sigma^2)+\frac{1}{2\sigma^2}\int_\mathbb{R}\left(\int_{\mathbb{R}^n}\sum_{i=1}^n(x-y_i)^2p(\boldsymbol{y}|x)\,d\boldsymbol{y}\right)\,p(x)dx\\
&amp;=\frac{n}{2}\log(2\pi\sigma^2)+\frac{n\sigma^2}{2\sigma^2}\int_\mathbb{R}p(x)\,dx\\
&amp;=\frac{n}{2}\log(2\pi\sigma^2)+\frac{n}{2}.
\end{align*}\]</span></p></li>
</ol>
<p>これと，<span class="math inline">\(y_i\)</span> には <span class="math inline">\(x_i\)</span> とこれと独立な分散 <span class="math inline">\(\sigma^2\)</span> のノイズが加わって得られる値であることから，次のように計算できる： <span class="math display">\[\begin{align*}
    I(X,Y)&amp;=H(Y)-\frac{n}{2}\log(2\pi\sigma^2)-\frac{n}{2}\\
    &amp;=-F_n-\frac{n}{2}+\frac{n}{2\sigma^2}\int_\mathbb{R}y_i^2p(y_i)\,dy_i\\
    &amp;=-F_n-\frac{n}{2}+\frac{n}{2\sigma^2}\left(\sigma^2+\int_\mathbb{R}x^2p(x)\,dx\right)\\
    &amp;=-F_n+\frac{n}{2\sigma^2}\int_\mathbb{R}x^2p(x)\,dx.
\end{align*}\]</span></p>
</div>
</div>
</div>
</section>
<section id="sec-Nishimori-symmetry" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="sec-Nishimori-symmetry"><span class="header-section-number">2.3</span> 西森対称性</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題 [@西森1980]^[[@Zdeborova-Krzakala2016 p.464]，[@Krzakala-Zdeborova2024 p.123] 定理13，[@Iba1999 pp.3876-3877] などで扱われている．西森ライン上のみで見られる性質であるため，西森対称性と呼ぶ．西森ラインについては [次項](Bayes2.qmd#sec-Nishimori-line) も参照．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>命題 <span class="citation" data-cites="西森1980">(<a href="#ref-西森1980" role="doc-biblioref">Nishimori, 1980</a>)</span><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(P:\mathbb{R}\to\mathbb{R}^n\)</span> を確率核，<span class="math inline">\(X^*\in\mathcal{L}(\Omega)\)</span> は分布 <span class="math inline">\(\nu\in\mathcal{P}(\mathbb{R})\)</span> を持ち，<span class="math inline">\(Y\in\mathcal{L}(\Omega;\mathbb{R}^n)\)</span> の分布は <span class="math display">\[
\mu(dy)=\int_\mathbb{R}\nu(dx)P(x,dy)
\]</span> で定まるとする．ここで，<span class="math inline">\(Y\)</span> で条件づけた <span class="math inline">\(X^*\)</span> の確率分布を <span class="math inline">\(P^{X|Y}\)</span> とする： <span class="math display">\[
\nu(dx)=\int_{\mathbb{R}^n}\mu(dy)P^{X|Y}(y,dx).
\]</span> <span class="math display">\[
X^{(1)},\cdots,X^{(k)}\overset{\text{iid}}{\sim}P^{X|Y}
\]</span> を独立な確率変数列とすると，次が成り立つ：任意の <span class="math inline">\(f\in\mathcal{L}_b(\mathbb{R}^{n+k})\)</span> について，</p>
<p><span class="math display">\[\begin{align*}
    &amp;\quad\operatorname{E}\biggl[f(Y,X^{(1)},\cdots,X^{(k)})\biggr]\\
    &amp;=\operatorname{E}\left[f(Y,X^{(1)},\cdots,X^{(k-1)},X^*)\right].
\end{align*}\]</span></p>
</div>
</div>
<p><span class="math inline">\(X^{(1)},\cdots,X^{(k)}\)</span> で表した確率変数の <span class="math inline">\(P^{X|Y}\)</span> に関する積分を Boltzmann 積分または熱平均と呼び，観測を作り出す過程 <span class="math inline">\((X^*,Y)\)</span> に関する積分を無秩序積分 (disorder expectation) または quenched average という．<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>この設定の下で，<span class="math inline">\((X^*,Y)\)</span> の結合分布が次の２通りで表せていることに注意： <span class="math display">\[
\nu(dx)P(x,dy)=\mu(dy)P^{X|Y}(y,dx).
\]</span> 従って， <span class="math display">\[\begin{align*}
    &amp;\quad\nu(dx)P(x,dy)P^{X|Y}(y,dx^{(1)},\cdots,dx^{(k)})\\
    &amp;=\mu(dy)P^{X|Y}(y,dx)P^{X|Y}(y,dx^{(1)},\cdots,dx^{(k)})
\end{align*}\]</span> に関して <span class="math inline">\(f(Y,X^{(1)},\cdots,X^{(k)})\)</span> の期待値を取ると，次のように計算できる： <span class="math display">\[\begin{align*}
    &amp;\quad\operatorname{E}\biggl[f(Y,X^{(1)},\cdots,X^{(k)})\biggr]\\
    &amp;=\int_{\mathbb{R}^{n+k}}f(y,x^{(1)},\cdots ,x^{(k-1)},x^{(k)})P^{X|Y}(y,dx^{(1)})\cdots P^{X|Y}(y,dx^{(k)})\mu(dy)\\
    &amp;=\int_{\mathbb{R}^{n+k}}f(y,x^{(1)},\cdots,x^{(k-1)},x)P^{X|Y}(y,dx^{(1)})\cdots P^{X|Y}(y,dx^{(k-1)})\nu(dx)P(x,dy)\\
    &amp;=\operatorname{E}\left[f(Y,X^{(1)},\cdots,X^{(k-1)},X^*)\right].
\end{align*}\]</span></p>
<p>確率核 <span class="math inline">\(P\)</span> にまつわる記法は次の記事も参照：</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/static/Notations.html" target="_blank">
            <img src="https://162348.github.io/static/Notations.svg" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">数学記法一覧</h3>
                <p class="article-description">本サイトで用いる記法と規約</p>
            </div>
        </a>
    </div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="物理的な解釈">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>物理的な解釈
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math inline">\(P^{X|Y}\)</span> に関する積分を <span class="math inline">\(\langle-\rangle\)</span> で表すことで，何をどのように物理的に解釈しているかが明確になる： <span class="math display">\[
\langle X\rangle=\operatorname{E}[X|Y].
\]</span></p>
<p>この見方を採用すると，期待値を <span class="math display">\[
\operatorname{E}\biggl[f(Y,X^{(1)},\cdots,X^{(k)})\biggr]=\operatorname{E}^Y\left[\left\langle f(Y,X^{(1)},\cdots,X^{(k)})\right\rangle\right]
\]</span> と二段階で捉えていることになる．右辺の外側の期待値は単に <span class="math inline">\(Y\)</span> のみに関してとっていることになる．</p>
<p>第 <a href="#sec-identification" class="quarto-xref">2.2</a> 節で考えたモデル <span class="math inline">\(H\)</span> における Boltzmann 分布が <span class="math inline">\(P^{X|Y}\)</span> となり，平均 <span class="math inline">\(\langle-\rangle\)</span> はこれに関する平均となる．</p>
<p>一方で，Hamiltonian <span class="math inline">\(H\)</span> にもランダム性が残っているのであり，これに関する平均が <span class="math inline">\((X^*,Y)\)</span> に関する平均に当たる．</p>
<p>こうして，ベイズ統計モデルはスピングラス系（特にランダムエネルギーモデル <span class="citation" data-cites="Derrida1980">(<a href="#ref-Derrida1980" role="doc-biblioref">Derrida, 1980</a>)</span>）と同一視できるようになる．</p>
<p>だが同時に，スピングラスのサンプリングを困難にする多谷構造も，ベイズ統計に輸入されるのである……．</p>
<p>スピングラスについては，次の記事も参照：</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Nature/StatisticalMechanics1.html" target="_blank">
            <img src="https://162348.github.io/posts/2024/Nature/SG.png" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">数学者のための統計力学１</h3>
                <p class="article-description">Ising 模型とスピングラス</p>
            </div>
        </a>
    </div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-MMSE-via-Nishimori" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="sec-MMSE-via-Nishimori"><span class="header-section-number">2.4</span> 最小自乗誤差推定量</h3>
<p>第 <a href="#sec-MMSE" class="quarto-xref">1.4.1</a> 節で扱った最小自乗誤差推定量の自乗誤差は次のように計算できる：</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（最小自乗誤差の表示）">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>命題（最小自乗誤差の表示）
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(\langle X\rangle:=\operatorname{E}[X|Y]\)</span> と表す．事後平均推定量の自乗誤差は次のように表せる： <span class="math display">\[\begin{align*}
    \DeclareMathOperator{\MMSE}{MMSE}
    \MMSE&amp;:=\operatorname{E}\biggl[\biggr(X-\operatorname{E}[X|Y]\biggl)^2\biggr]\\
    &amp;=\operatorname{E}[X^2]-\operatorname{E}\biggl[\langle X\rangle^2\biggr].
\end{align*}\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math display">\[\begin{align*}
    \operatorname{E}[\mathrm{V}[X|Y]]&amp;=\operatorname{E}\biggl[\biggr(\operatorname{E}[X|Y]-X\biggl)^2\biggr]\\
    &amp;=\operatorname{E}\biggl[\operatorname{E}[X|Y]^2-2X\operatorname{E}[X|Y]+X^2\biggr]\\
    &amp;=\operatorname{E}\biggl[\operatorname{E}[X|Y]^2\biggr]-2\operatorname{E}\biggl[X\operatorname{E}[X|Y]\biggr]+\operatorname{E}[X^2]\\
    &amp;=\operatorname{E}[X^2]-\operatorname{E}\biggl[\operatorname{E}[X|Y]^2\biggr].
\end{align*}\]</span></p>
<p>この変形では，繰り返し期待値の法則 <span class="math display">\[\begin{align*}
    \operatorname{E}\biggl[X\operatorname{E}[X|Y]\biggr]&amp;=\operatorname{E}\biggl[\biggl[X\operatorname{E}[X|Y]\,\bigg|\,Y\biggr]\biggr]\\
    &amp;=\operatorname{E}\biggl[\operatorname{E}[X|Y]^2\biggr]
\end{align*}\]</span> を西森の対称性の代わりに用いたことになる．</p>
<p>換言すれば，西森の対称性を証明したのと同様の方法を本命題にも適用したため，直接命題の適用は回避したことになる．</p>
</div>
</div>
</div>
</section>
<section id="sec-I-MMSE" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="sec-I-MMSE"><span class="header-section-number">2.5</span> KL 乖離度の微分としての分散</h3>
<p>次の定理は，相互情報量 <span class="math inline">\(I\)</span> と MMSE を結びつける定理であるため，<span class="citation" data-cites="Guo+2005">(<a href="#ref-Guo+2005" role="doc-biblioref">Guo et al., 2005</a>)</span> 以来，<strong>I-MMSE 定理</strong> と呼ばれている．</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（自由エネルギーによる特徴付け） [@Guo+2005]^[[@Krzakala-Zdeborova2024 p.124] 定理14．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>命題（自由エネルギーによる特徴付け） <span class="citation" data-cites="Guo+2005">(<a href="#ref-Guo+2005" role="doc-biblioref">Guo et al., 2005</a>)</span><a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p>簡単のため，<span class="math inline">\(n=1\)</span> とする．このとき，<span class="math inline">\(\beta:=\sigma^{-2}\)</span> に関して，次の式が成り立つ：</p>
<ol type="1">
<li><p>自由エネルギー <span class="math inline">\(F_1\)</span> について， <span class="math display">\[
\frac{\partial F_1}{\partial \beta}=\frac{\operatorname{E}[\langle X\rangle^2]}{2}.
\]</span></p></li>
<li><p>相互情報量 <span class="math inline">\(I(X,Y)\)</span> について，</p>
<p><span class="math display">\[\begin{align*}
    \frac{\partial I(X,Y)}{\partial \beta}&amp;=\frac{\operatorname{E}[X^2]-\operatorname{E}[\langle X\rangle^2]}{2}\\
    &amp;=\frac{\MMSE}{2}
\end{align*}\]</span></p></li>
</ol>
<p>ただし，<span class="math inline">\(\langle X\rangle:=\operatorname{E}[X|Y]\)</span> と定めた．</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math display">\[\begin{align*}
    \log\frac{p(y)}{q(y)}&amp;=\frac{\displaystyle\frac{1}{\sqrt{2\pi\sigma^2}}\int_\mathbb{R}e^{-\frac{(x-y)^2}{2\sigma^2}}p(x)\,dx}{\frac{1}{\sqrt{2\pi\sigma^2}}e^{-\frac{y^2}{2\sigma^2}}}\\
    &amp;=\int_\mathbb{R}e^{-\frac{x^2-2xy}{2\sigma^2}}p(x)\,dx.
\end{align*}\]</span></p>
<p>この <span class="math inline">\(p(y)dy\)</span> に関する積分を <span class="math inline">\(\beta\)</span> で微分すれば良いのであるが，<span class="math inline">\(p(y)\)</span> 自体が <span class="math inline">\(\sigma\)</span> に依存し，そのまま計算したのでは大変煩雑になる．</p>
<p>そこで，<span class="math inline">\(y=\sigma z+x^*\)</span> と変数変換をすることで，標準 Gauss 確率変数 <span class="math inline">\(Z\sim\gamma_1\)</span> と真値 <span class="math inline">\(X^*\)</span> は独立で，<span class="math inline">\(\sigma\)</span> も含まないから，次のように計算ができる： <span class="math display">\[\begin{align*}
    F_1(\beta)&amp;=\int_\mathbb{R}\log\frac{p(y)}{q(y)}p(y)\,dy\\
    &amp;=\operatorname{E}\biggl[\log\left(\int_\mathbb{R}e^{-\frac{x^2-2xY}{2\sigma^2}}p(x)\,dx\right)\biggr]\\
    &amp;=\operatorname{E}\biggl[\log\left(\int_\mathbb{R}\exp\left(-\frac{x^2}{2\sigma^2}+\frac{xZ}{\sigma}+\frac{xX^*}{\sigma^2}\right)p(x)\,dx\right)\biggr]\\
    &amp;=\operatorname{E}\biggl[\log\left(\int_\mathbb{R}\exp\left(-\frac{x^2\beta}{2}+xZ\sqrt{\beta}+xX^*\beta\right)p(x)\,dx\right)\biggr].
\end{align*}\]</span></p>
<p>こうして，最右辺の期待値に関する密度はもう <span class="math inline">\(\beta\)</span> に依存しないから，次のように微分が計算できる．ただし， <span class="math display">\[
\exp\left(-\frac{x^2\beta}{2}+xZ\sqrt{\beta}+xX^*\beta\right)p(x)\,dx
\]</span> は <span class="math inline">\(p(x|y)\)</span> の定数倍，すなわち Gibbs 測度 <span class="math inline">\(\frac{e^{-H(x,y)}}{Z(y)}dx\)</span> の定数倍であることに注意して，これらに関する平均を引き続き <span class="math inline">\(\langle-\rangle:=\operatorname{E}[-|Y]\)</span> で表すこととすると，</p>
<p><span class="math display">\[\begin{align*}
    \frac{\partial F_1(\beta)}{\partial \beta}&amp;=
    \operatorname{E}\left[\frac{\displaystyle\int_\mathbb{R}\biggr(-\frac{x^2}{2}+\frac{xZ}{2\sqrt{\beta}}+xX^*\biggl)e^{-\frac{x^2\beta}{2}+xZ\sqrt{\beta}+xX^*\beta}p(x)dx}{\displaystyle\int_\mathbb{R}\exp\left(-\frac{x^2\beta}{2}+xZ\sqrt{\beta}+xX^*\beta\right)p(x)\,dx}\right]\\
    &amp;=-\frac{\operatorname{E}[\langle X^2\rangle]}{2}+\frac{1}{2\sqrt{\beta}}\operatorname{E}[\langle X\rangle Z]+\operatorname{E}[\langle X\rangle X^*].
\end{align*}\]</span></p>
<p><span class="math inline">\(\langle X\rangle\)</span> が中に入っているのは，<span class="math inline">\(\sigma[X^*,Z]\)</span> に関する条件付き期待値を <span class="math inline">\(\operatorname{E}\)</span> 内で取ったためと捉えられる．</p>
<p>まず，第二項は，Stein の補題 <a href="#sec-Steins-lemma" class="quarto-xref">2.6</a> の系から， <span class="math display">\[\begin{align*}
    \frac{1}{2\sqrt{\beta}}\operatorname{E}[\langle X\rangle Z]&amp;=\frac{1}{2\sqrt{\beta}}\sqrt{\beta}\biggr(\operatorname{E}[\langle X^2\rangle]-\operatorname{E}[\langle X\rangle^2]\biggl)\\
    &amp;=\frac{\operatorname{E}[\langle X^2\rangle]}{2}-\frac{\operatorname{E}[\langle X\rangle^2]}{2}
\end{align*}\]</span></p>
<p>第三項は，西森の対称性から， <span class="math display">\[\begin{align*}
    \operatorname{E}[\langle X\rangle X^*]=\operatorname{E}[\langle X\rangle^2].
\end{align*}\]</span></p>
<p>以上を併せると， <span class="math display">\[
\frac{\partial F_1(\beta)}{\partial \beta}=\frac{\operatorname{E}[\langle X\rangle^2]}{2}.
\]</span></p>
<ol type="1">
<li>の主張も，<span class="math inline">\(n=1\)</span> のときは <span class="math display">\[
I(X,Y)=\frac{\beta}{2}\int_\mathbb{R}x^2p(x)\,dx-F_1
\]</span> であったために従う： <span class="math display">\[\begin{align*}
\frac{\partial I(X,Y)}{\partial \beta}&amp;=\frac{\operatorname{E}[X^2]}{2}-\frac{\operatorname{E}[\langle X\rangle^2]}{2}\\
&amp;=\frac{\MMSE}{2}.
\end{align*}\]</span></li>
</ol>
</div>
</div>
</div>
<p><span class="math inline">\(\operatorname{E}[\langle X\rangle^2]\)</span> は <span class="math inline">\(q\)</span> とも表され，スピングラスの <strong>秩序パラメータ</strong> ともいう．<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<p><span class="math inline">\(I\)</span> の <span class="math inline">\(\beta\)</span> に関する二回微分を計算することより，<span class="math inline">\(\beta\)</span> に関する凸関数であることもわかる．</p>
</section>
<section id="sec-Steins-lemma" class="level3" data-number="2.6">
<h3 data-number="2.6" class="anchored" data-anchor-id="sec-Steins-lemma"><span class="header-section-number">2.6</span> Stein の補題</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題 [@Stein1972]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>命題 <span class="citation" data-cites="Stein1972">(<a href="#ref-Stein1972" role="doc-biblioref">Stein, 1972</a>)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>可積分な確率変数 <span class="math inline">\(X\in\mathcal{L}^1(\Omega)\)</span> について，次は同値：</p>
<ol type="1">
<li><span class="math inline">\(X\)</span> の分布は標準Gaussである：<span class="math inline">\(X\sim\gamma_1\)</span>．</li>
<li>任意の <span class="math inline">\(f\in C^1_b(\mathbb{R})\)</span> について， <span class="math display">\[
\operatorname{E}[f'(X)]=\operatorname{E}[Xf(X)]&lt;\infty.
\]</span></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>(1)<span class="math inline">\(\Rightarrow\)</span>(2)</p>
<p><span class="math inline">\(f,f'\)</span> はいずれも有界としたから， <span class="math display">\[
  \operatorname{E}[f'(X)],\operatorname{E}[f(X)]&lt;\infty
  \]</span> が成り立つ．</p>
<p><span class="math inline">\(\gamma_1\)</span> の密度 <span class="math inline">\(\phi\)</span> は <span class="math inline">\(\phi'(x)=-x\phi(x)\)</span> を満たすことに注意すれば，部分積分により， <span class="math display">\[\begin{align*}
      \operatorname{E}[f'(X)]&amp;=-\int_\mathbb{R}f(x)\phi'(x)dx\\
      &amp;=\int_\mathbb{R}f(x)x\phi(x)dx=\operatorname{E}[f(X)X].
  \end{align*}\]</span></p></li>
<li><p>(2)<span class="math inline">\(\Rightarrow\)</span>(1)</p>
<p><span class="math inline">\(X\)</span> は可積分としたから，特性関数 <span class="math inline">\(\varphi(u):=\operatorname{E}[e^{iuX}]\)</span> は少なくとも <span class="math inline">\(C^1(\mathbb{R})\)</span>-級で，その微分は <span class="math inline">\(\phi(x):=e^{iux}\)</span> に関する仮定 <span class="math inline">\(\operatorname{E}[\phi'(X)]=\operatorname{E}[X\phi(X)]\)</span> を通じて <span class="math display">\[\begin{align*}
      \varphi'(u)&amp;=i\operatorname{E}[Xe^{iuX}]=-u\operatorname{E}[e^{iuX}]\\
      &amp;=-u\varphi(u),\qquad u\in\mathbb{R},
  \end{align*}\]</span> と計算できる．</p>
<p>この微分方程式は規格化条件 <span class="math inline">\(\varphi(0)=1\)</span> の下で一意な解 <span class="math inline">\(\varphi(u)=e^{-\frac{u^2}{2}}\)</span> を持つ．</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="系">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>系
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(\langle X\rangle:=\operatorname{E}[X|Y]\)</span> とこれと独立な <span class="math inline">\(Z\sim\gamma_1\)</span> に関して，次が成り立つ：</p>
<p><span class="math display">\[\begin{align*}
    \operatorname{E}[\langle X\rangle Z]&amp;=\operatorname{E}\left[\frac{\partial \langle X\rangle}{\partial Z}\right]\\
    &amp;=\sqrt{\beta}\biggr(\operatorname{E}[\langle X^2\rangle]-\operatorname{E}[\langle X\rangle^2]\biggl)
\end{align*}\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>最初の等号 <span class="math display">\[
\operatorname{E}[\langle X\rangle Z]=\operatorname{E}\left[\frac{\partial \langle X\rangle}{\partial Z}\right]
\]</span> は Stein の補題による．</p>
<p>続いて， <span class="math display">\[
\langle X\rangle=\int_\mathbb{R}xp(x|Y)\,dx
\]</span> は <span class="math inline">\(Y=\sigma Z+X^*\)</span> を通じてのみ <span class="math inline">\(Z\)</span> に依存するから， <span id="eq-chain-rule"><span class="math display">\[
\frac{\partial \langle X\rangle}{\partial Z}=\frac{\partial \langle X\rangle}{\partial Y}\frac{d Y}{d Z}=\sigma\frac{\partial \langle X\rangle}{\partial Y}
\tag{2}\]</span></span> が成り立つ．あとは <span class="math inline">\(\langle X\rangle=\operatorname{E}[X|Y]\)</span> の <span class="math inline">\(Y\)</span> に関する微分を計算すれば良い．</p>
<p><span class="math display">\[
\frac{\partial p(y|x)}{\partial y}=-\frac{y-x}{\sigma^2}p(y|x).
\]</span> また， <span class="math display">\[
p(y)=\frac{1}{\sqrt{2\pi\sigma^2}}\int_\mathbb{R}e^{-\frac{(x-y)^2}{2\sigma^2}}p(x)\,dx
\]</span> であったから， <span class="math display">\[\begin{align*}
    p'(y)&amp;=\frac{1}{\sqrt{2\pi\sigma^2}}\int_\mathbb{R}-\frac{y-x}{\sigma^2}e^{-\frac{(x-y)^2}{2\sigma^2}}p(x)\,dx\\
    &amp;=-\int_\mathbb{R}\frac{y-x}{\sigma^2}p(y|x)p(x)\,dx\\
    &amp;=-\int_\mathbb{R}\frac{y-x}{\sigma^2}p(x|y)p(y)\,dx\\
    &amp;=-\frac{y-\langle X\rangle}{\sigma^2}p(y).
\end{align*}\]</span> <span class="math display">\[
\therefore\quad\frac{p'(Y)}{p(Y)}=\frac{\langle X\rangle-Y}{\sigma^2}
\]</span></p>
<p>に注意すれば，次のように計算できる：</p>
<p><span class="math display">\[\begin{align*}
    \frac{\partial \langle X\rangle}{\partial Y}&amp;=\frac{\partial }{\partial Y}\int_\mathbb{R}xp(x|Y)\,dx\\
    &amp;=\frac{\partial }{\partial Y}\int_\mathbb{R}x\frac{p(Y|x)p(x)}{p(Y)}\,dx\\
    &amp;=\int_\mathbb{R}x\frac{\partial }{\partial Y}\frac{p(Y|x)p(x)}{p(Y)}\,dx\\
    &amp;=\int_\mathbb{R}x\frac{\partial p(Y|x)}{\partial Y}\frac{p(x)}{p(Y)}\,dx\\
    &amp;\qquad+\int_\mathbb{R}x\left(\frac{\partial }{\partial Y}\frac{1}{p(Y)}\right)p(Y|x)p(x)\,dx\\
    &amp;=-\int_\mathbb{R}x\frac{Y-x}{\sigma^2}p(x|Y)\,dx\\
    &amp;\qquad-\frac{p'(Y)}{p(Y)}\int_\mathbb{R}xp(x|Y)\,dx\\
    &amp;=-\frac{Y}{\sigma^2}\langle X\rangle+\frac{\langle X^2\rangle}{\sigma^2}\\
    &amp;\qquad-\langle X\rangle\frac{\langle X\rangle-Y}{\sigma^2}\\
    &amp;=\frac{1}{\sigma^2}\biggr(\langle X^2\rangle-\langle X\rangle^2\biggl).
\end{align*}\]</span></p>
<p>最後，式 (<span class="math inline">\(\ref{eq-chain-rule}\)</span>) より， <span class="math display">\[\begin{align*}
    \frac{\partial \langle X\rangle}{\partial Z}&amp;=\sigma\frac{\partial \langle X\rangle}{\partial Y}\\
    &amp;=\sqrt{\beta}\biggr(\langle X^2\rangle-\langle X\rangle^2\biggl).
\end{align*}\]</span></p>
<!-- 
\begin{align*}
    \E\Square{\pp{\brac{X}}{Z}}&=\E\Square{\pp{}{Z}\E[X|Y=\sigma Z+x^*]}\\
    &=\E\Square{\pp{}{Z}\int_\R xp(x|\sigma Z+x^*)\,dx}
\end{align*}

$p(x|y)$ は Boltzmann 分布である（第 [-@sec-identification] 節）から，次のように計算を進められる：

\begin{align*}
    &\quad\E\Square{\pp{}{Z}\int_\R xp(x|\sigma Z+x^*)\,dx}\\
    &=\E\Square{\pp{}{Z}\int_\R\frac{xe^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}\,dx}\\
    &=\E\Square{\int_\R x\pp{}{Z}\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}\,dx}
\end{align*}

として計算し，結果が絶対可積分であったならば Fubini-Tonelli の定理により，最後の等号が正当化される．

また，記号の混同を避けるため，分配関数は $\cZ$ で表した．$Z\sim\gamma_1$ であった．

$$
H(x,y)=\frac{1}{2\sigma^2}(x^2-2xy)-\log p(x)
$$
$$
\therefore\quad\pp{H(x,y)}{y}=-\frac{x}{\sigma^2}
$$

より，

\begin{align*}
    &\quad\pp{}{Z}\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}\\
    &=-\pp{H(x,\sigma Z+x^*)}{Z}\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}+\pp{}{Z}\paren{\frac{1}{\cZ(\sigma Z+x^*)}}e^{-H(x,\sigma Z+x^*)}\\
    &=\frac{x}{\sigma^2}\sigma\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}-\frac{\cZ'(\sigma Z+x^*)}{\cZ(\sigma Z+x^*)}\sigma\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}
\end{align*}

さらに，$\cZ(y)=\frac{q(y)}{p(y)}$ であるが，
$$
\cZ'(y)=-\frac{1}{\sigma^2}\frac{yq(y)}{p(y)}-\frac{p'(y)q(y)}{p(y)^2}
$$

\begin{align*}
    \frac{\cZ'(Y)}{\cZ(Y)}=-\frac{Y}{\sigma^2}-\frac{p'(Y)}{p(Y)}
\end{align*}

続いて
$$
p(y)=\frac{1}{\sqrt{2\pi\sigma^2}}\int_\R e^{-\frac{(x-y)^2}{2\sigma^2}}p(x)\,dx
$$
であったから，
\begin{align*}
    p'(y)&=\frac{1}{\sqrt{2\pi\sigma^2}}\int_\R-\frac{y-x}{\sigma^2}e^{-\frac{(x-y)^2}{2\sigma^2}}p(x)\,dx\\
    &=-\int_\R\frac{y-x}{\sigma^2}p(y|x)p(x)\,dx\\
    &=-\int_\R\frac{y-x}{\sigma^2}p(x|y)p(y)\,dx\\
    &=-\frac{y-\brac{X}}{\sigma^2}p(y).
\end{align*}
$$
\therefore\quad\frac{p'(Y)}{p(Y)}=\frac{\brac{X}-Y}{\sigma^2}
$$
\begin{align*}
    \therefore\quad\frac{\cZ'(Y)}{\cZ(Y)}&=-\frac{Y}{\sigma^2}-\frac{p'(Y)}{p(Y)}=-\frac{\brac{X}}{\sigma^2}
\end{align*}

と計算できるから，

\begin{align*}
    &\quad\E\Square{\int_\R x\pp{}{Z}\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}\,dx}\\
    &=\E\Square{\int_\R x\Paren{\frac{x}{\sigma^2}\sigma p(x|Y)-\frac{\cZ'(\sigma Z+x^*)}{\cZ(\sigma Z+x^*)}\sigma p(x|Y)}dx}\\
    &=\E\Square{\int_\R\frac{x^2}{\sigma}p(x|Y)\,dx}+\E\Square{\int_\R x\sigma\frac{\brac{X}}{\sigma^2}p(x|Y)dx}\\
    &=\sqrt{\beta}\E[\brac{X^2}]+\sqrt{\beta}\E[\brac{X}^2]
\end{align*}
-->
</div>
</div>
</div>
</section>
</section>
<section id="sec-sparse-vector-denoising" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="sec-sparse-vector-denoising"><span class="header-section-number">3</span> スパースベクトルの復号</h2>
<p>スパースベクトルの信号推定問題を考える．ここまで，<span class="math inline">\(x,x^*\)</span> は <span class="math inline">\(\mathbb{R}\)</span> の点としてきたが，本節では，<span class="math inline">\(\mathbb{R}^d,d=2^N\)</span> の one-hot ベクトルであるとする．</p>
<section id="sec-settings" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="sec-settings"><span class="header-section-number">3.1</span> 設定</h3>
<p>真の信号 <span class="math inline">\(x^*\in\mathbb{R}^d\)</span> は，<span class="math inline">\(d\)</span> 次元の one-hot ベクトルであるとする．すなわち，次の集合 <span class="math inline">\(\Delta_d\)</span> の元であるとする： <span class="math display">\[
\Delta_d:=\left\{x\in\mathbb{Z}^d\mid\|x\|_1=1\right\}.
\]</span></p>
<p>加えて，<span class="math inline">\(\Delta_d\)</span> 上の一様分布に従うとする：<span class="math inline">\(x^*\sim\mathrm{U}(\Delta_d)\)</span>．</p>
<p>これを分散 <span class="math inline">\(\frac{\sigma^2}{N}\)</span> を持った Gauss ノイズを通じて観測する： <span class="math display">\[
Y\sim\mathrm{N}_d\left(x^*,\frac{\sigma^2}{N}I_d\right).
\]</span></p>
<p>事前分布を <span class="math inline">\(p(x)\)</span>，<span class="math inline">\(Y\)</span> の分布を <span class="math inline">\(p(y)\)</span> とすると，Bayes の定理より， <span class="math display">\[\begin{align*}
    p(x|y)&amp;=\frac{p(x)}{p(y)}\prod_{i=1}^d\frac{e^{-\frac{(y_i-x_i)^2}{2\sigma^2/N}}}{\sqrt{2\pi\sigma^2/N}}\\
    &amp;=\frac{\prod_{i=1}^d\phi(y_i;0,\sigma^2/N)}{p(y)}\\
    &amp;\qquad\times \frac{1}{2^N}\prod_{i=1}^d\exp\left(-\frac{x_i^2-2x_iy_i}{2\sigma^2/N}\right)
\end{align*}\]</span></p>
<p>ただし，<span class="math inline">\(\phi(-;\mu,\sigma):=\frac{d \mathrm{N}_1(\mu,\sigma)}{d \ell_1}\)</span> を正規密度とした．</p>
</section>
<section id="スピングラス系との同一視" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="スピングラス系との同一視"><span class="header-section-number">3.2</span> スピングラス系との同一視</h3>
<p>この事後分布 <span class="math inline">\(p(x|y)\)</span> は，次の Hamiltonian <span class="math inline">\(H\)</span> に関する，逆温度 <span class="math inline">\(\beta=\sigma^{-2}\)</span> での Boltzmann 分布とみなせる：</p>
<p><span class="math display">\[\begin{align*}
    p(x|y)&amp;=\frac{1}{\mathcal{Z}}e^{-\beta H(x,y)}\\
    H(x,y)&amp;:=-N\sigma^2\log2\\
    &amp;\qquad-\frac{N}{2}\sum_{i,j=1}^dx_i^*x_j^*\sqrt{(1-2y_i)(1-2y_j)}
\end{align*}\]</span></p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="注">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>注
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>この Hamiltonian は非物理的なものであり，planted ensemble とも呼ばれる．<span class="citation" data-cites="Murphy2023">(<a href="#ref-Murphy2023" role="doc-biblioref">Murphy, 2023, p. 843</a>)</span> での clamped という表現と同じニュアンスである．詳しくは次項参照：</p>
<div id="listing-lst-Bayes2" class="listing quarto-float quarto-figure quarto-figure-left quarto-listing quarto-listing-container-default anchored">
<div class="list quarto-listing-default">
<div class="quarto-post image-right" data-index="0" data-categories="QmF5ZXNpYW4lMkNOYXR1cmUlMkNJbmZvcm1hdGlvbg==" data-listing-date-sort="1719100800000" data-listing-file-modified-sort="1768808202244" data-listing-date-modified-sort="1719532800000" data-listing-reading-time-sort="8" data-listing-word-count-sort="1507">
<div class="thumbnail"><a href="../../../posts/2024/Stat/Bayes2.html" class="no-external">

<img loading="lazy" src="../../../posts/2024/Stat/phase_regular_rev.jpeg" class="thumbnail-image">

</a></div>
<div class="body">
<h3 class="no-anchor listing-title">
<a href="../../../posts/2024/Stat/Bayes2.html" class="no-external">ベイズ統計学とスピングラス</a>
</h3>
<div class="listing-subtitle">
<a href="../../../posts/2024/Stat/Bayes2.html" class="no-external">誤り訂正符号を題材にして</a>
</div>
</div>
<div class="metadata">
<a href="../../../posts/2024/Stat/Bayes2.html" class="no-external">
<div class="listing-date">
2024-06-23
</div>
</a>
</div>
</div>
</div>
<div class="listing-no-matching d-none">No matching items</div>
</div>
<p>また，<span class="math inline">\(H\)</span> の表示については，<span class="math inline">\(x^*\in\Delta_d\)</span> であるから，<span class="math inline">\(i,j\in[d]\)</span> と２つの和をとっているように見えるが，二つの添え字が一致している場合しか非零な値は取らず，結局 <span class="math display">\[
H(x,y)=-\frac{N}{2}\sum_{j=1}^d(2y_j-1)x_j+N\sigma^2\log2
\]</span> であることに注意．</p>
</div>
</div>
</div>
<p>なお，分配関数は <span class="math display">\[
\mathcal{Z}:=\frac{1}{2^N}\sum_{i=1}^d\exp\left(\frac{N}{2\sigma^2}(2y_i-1)\right),
\]</span> と表される．</p>
</section>
<section id="自由エネルギー密度の計算" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="自由エネルギー密度の計算"><span class="header-section-number">3.3</span> 自由エネルギー密度の計算</h3>
<p>系が用意されたら，統計力学はまず，代表的な物理量の熱力学極限を計算する．特に自由エネルギー密度は，熱力学極限 <span class="math inline">\(N\to\infty\)</span> において自己平均性（確率論では集中性という性質）を示すことが期待される．</p>
<p>自由エネルギー密度 <span class="math inline">\(\Phi\)</span> は，熱力学極限を通じて <span class="math display">\[
\Phi(\beta):=\lim_{N\to\infty}\frac{\operatorname{E}[\log\mathcal{Z}]}{N}
\]</span> と定まる．</p>
<p>I-MMSE 定理（第 <a href="#sec-I-MMSE" class="quarto-xref">2.5</a> 節）はこの多次元の <span class="math inline">\(X\)</span> に関しても有効であり， <span class="math display">\[
\Phi_N(\beta):=\frac{\operatorname{E}[\log\mathcal{Z}]}{N}
\]</span> に関して， <span class="math display">\[
\frac{\partial \Phi_N(\beta)}{\partial \beta}=\frac{\operatorname{E}\biggl[\lvert\langle X\rangle\rvert^2\biggr]}{2}
\]</span> が成り立つ．</p>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>まず有限の <span class="math inline">\(N\in\mathbb{N}^+\)</span> で計算する．</p>
<p><span class="math display">\[
\frac{\partial \Phi_N(\beta)}{\partial \beta}=\frac{1}{N}\operatorname{E}\left[\frac{1}{\mathcal{Z}}\frac{\partial \mathcal{Z}}{\partial \beta}\right]
\]</span> の右辺を求めれば良い．</p>
<p><span class="math display">\[
Y_i=X_i^*+\frac{\sigma}{\sqrt{N}}Z_i
\]</span> であり，one-hot ベクトル <span class="math inline">\(x\in\Delta_d\)</span> については <span class="math display">\[
x_j=x_j^2,\quad\lvert x\rvert^2=1
\]</span> でもあることに注意すれば，</p>
<p><span class="math display">\[\begin{align*}
    \mathcal{Z}&amp;=\sum_{i=1}^de^{-H(x^{(i)},Y)}\\
    &amp;=\frac{1}{2^N}\sum_{i=1}^d\exp\left(-\frac{N\beta}{2}\lvert x^{(i)}\rvert^2+N\beta(Y|x^{(i)})\right)\\
    &amp;=\frac{1}{2^N}\sum_{i=1}^d\exp\left(-\frac{N\beta}{2}\lvert x^{(i)}\rvert^2+N(X^*|x^{(i)})\beta+(Z|x^{(i)})\sqrt{N\beta}\right)
\end{align*}\]</span> <span class="math display">\[
\frac{\partial \mathcal{Z}}{\partial \beta}=\sum_{i}^d\biggr(-\frac{N}{2}\lvert x^{(i)}\rvert^2+N(X^*|x^{(i)})+\frac{\sqrt{N}}{2\sqrt{\beta}}(Z|x^{(i)})\biggl)e^{-H(x^{(i)},Y)}
\]</span> <span class="math display">\[
\frac{1}{\mathcal{Z}}\frac{\partial \mathcal{Z}}{\partial \beta}=-\frac{N}{2}\left\langle\lvert X\rvert^2\right\rangle+N\biggl\langle(X^*|X)\biggr\rangle+\frac{\sqrt{N}}{2\sqrt{\beta}}\biggl\langle(Z|X)\biggr\rangle
\]</span> <span class="math display">\[
\frac{1}{N}\operatorname{E}\left[\frac{1}{\mathcal{Z}}\frac{\partial \mathcal{Z}}{\partial \beta}\right]=\operatorname{E}\left[\left\langle-\frac{\langle\lvert X\rvert^2\rangle}{2}+\biggl\langle(X^*|X)\biggr\rangle+\frac{\biggl\langle(Z|X)\biggr\rangle}{2\sqrt{N\beta}}\right\rangle\right]
\]</span> これは１次元の場合の計算（第 <a href="#sec-I-MMSE" class="quarto-xref">2.5</a> 節）と同様に， <span class="math display">\[
\frac{\partial \Phi_N(\beta)}{\partial \beta}=\frac{\operatorname{E}[\lvert\langle X\rangle\rvert^2]}{2}
\]</span> と計算できる．</p>
</div>
</div>
</div>
<p>よって，<span class="math inline">\(N\to\infty\)</span> の極限でも右辺が定数に収束し（右辺は <span class="math inline">\(2^N\)</span> 項和を含む），この種の関係式が成り立ち続けるならば，<span class="math inline">\(\Phi\)</span> は <span class="math inline">\(\beta\)</span> の一次関数の形であるはずである．実際，次が示せる：</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題^[[@Krzakala-Zdeborova2024 p.125] 定理15，[@樺島-杉浦2008 p.14] なども参照．証明は [@Krzakala-Zdeborova2024 p.133] 7.B 節 を参考にした．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>命題<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(\Delta:=\sigma^2\)</span> の関数として，自由エネルギー密度 <span class="math inline">\(\Phi\)</span> は次で定まる関数 <span class="math inline">\(f:\mathbb{R}^+\to\mathbb{R}_+\)</span> に一致する： <span class="math display">\[
f(\Delta):=
\begin{cases}
\frac{1}{2\Delta}-\log 2&amp;\Delta\le\Delta_c,\\
0&amp;\Delta\ge\Delta_c.
\end{cases}
\]</span> <span class="math display">\[
\Delta_c:=\frac{1}{2\log 2}
\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>次節 <a href="#sec-bounds-on-Phi" class="quarto-xref">3.4</a> では <span class="math inline">\(\Phi_N\)</span> を <span class="math inline">\(f\)</span> によって上下から評価することで，数学的に厳密な証明を与える．ここでは，本ベイズモデルをランダムエネルギーモデルとみなし，レプリカ法によって計算した場合の証明の概略を付す．</p>
<p><span class="math inline">\(n\)</span> 個のレプリカを複製した際の，それぞれの配置 <span class="math inline">\((i_1,\cdots,i_n)\in[d]^n\)</span> について足し合わせることで，<span class="math inline">\(Z^n\)</span> の disorder average を取る．</p>
<p>最終的に次の表示を得る： <span class="math display">\[
e^{nN\left(\log 2+\frac{\beta}{2}\right)}\approx\int dQdM\,e^{Ns(Q,M)+N\beta\left(\sum_{a=1}^nM_a+\frac{1}{2}\sum_{a,b=1}^nQ_{a,b}\right)}
\]</span> <span id="eq-Laplace"><span class="math display">\[
=:\int dQdM\,e^{Ng(\Delta,Q,M)}.
\tag{3}\]</span></span> ただし，<span class="math inline">\(M_a:=\delta_{i_a,1}\in2\)</span> は磁化のベクトル，<span class="math inline">\(Q_{ab}:=\delta_{i_a,i_b}\)</span> は overlap matrix と呼ばれる．</p>
<p>積分はこの <span class="math inline">\(M_a,Q_{ab}\)</span> の全体について実行され，同じ <span class="math inline">\(M_a,Q_{ab}\)</span> の値を取る配置の数を <span class="math display">\[
\#(Q,M)=:e^{Ns(Q,M)}
\]</span> と表した．</p>
<p><span class="math inline">\(N\to\infty\)</span> の極限では，式 (<a href="#eq-Laplace" class="quarto-xref">3</a>) に対して Laplace 近似を実行すれば良い．</p>
<p>従って，<span class="math inline">\(Q,M\)</span> の構造のうち，特に支配的なものの特定に成功すれば，解が求まることになる．</p>
<p>最初の仮定として，レプリカ <span class="math inline">\(i_1,\cdots,i_d\)</span> は交換可能で見分けがつかないはずだろう，という replica symmetric ansatz が考えられる．</p>
<p>このレプリカ対称性を仮定すると，次の３通りまでシナリオが絞られる：</p>
<ol type="1">
<li><p>任意のレプリカは同一の状態にある：<span class="math inline">\(i_a\equiv i\in[d]\)</span>．だが，正しいレプリカではない <span class="math inline">\(i\ne1\)</span>．</p>
<p>このとき，<span class="math inline">\(Q_{ab}\equiv 1,M_a\equiv0\)</span> となり，<span class="math inline">\(s(Q,M)=\log2\)</span>，かつ <span class="math inline">\(g(\beta,Q)=\log2+n^2/\Delta\)</span>．</p>
<p>これは <span class="math inline">\(N\to\infty\)</span> の極限で <span class="math inline">\(n\)</span> に関して線型ではなく，物理的な解が得られるとは思えず，レプリカ法も解析接続に失敗する．</p></li>
<li><p>任意のレプリカは全て正しい状態にある：<span class="math inline">\(i_a\equiv1\)</span>．</p>
<p><span class="math inline">\(Q_{ab}=M_a\equiv1\)</span> となり，<span class="math inline">\(s(Q,M)=0,g(\beta,Q)=n/\Delta+n^2/2\Delta\)</span>．</p></li>
<li><p>レプリカ内に少なくとも２つの違う状態がある：</p>
<p>このとき，<span class="math inline">\(g(\beta,Q)=n/2\Delta+n\log2\)</span>．</p></li>
</ol>
<p>２と３の場合から，次の２つが解の候補として回収できた： <span class="math display">\[
\operatorname{E}[Z^n]=e^{-nN\left(\log 2-\frac{\beta}{2}\right)},
\]</span> <span class="math display">\[
\operatorname{E}[Z^n]=0.
\]</span></p>
<p>この２つは，次節 <a href="#sec-bounds-on-Phi" class="quarto-xref">3.4</a> から導かれる厳密な結果に一致する．</p>
<p>最後，自由エネルギーの <span class="math inline">\(\Delta\)</span> に関する凸性と解析性から，結論を得る．</p>
</div>
</div>
</div>
</section>
<section id="sec-bounds-on-Phi" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="sec-bounds-on-Phi"><span class="header-section-number">3.4</span> 自由エネルギーの上下評価</h3>
<p>レプリカ法を回避し，数学的に厳密な証明を与えるには，次のように上下から評価することになる．</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="補題（下界）^[[@Krzakala-Zdeborova2024 p.125]補題８．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>補題（下界）<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[
\Phi_N(\Delta)\ge f(\Delta)
\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>一般に下からの評価は，<span class="math inline">\(Z_i\)</span> に関する項をまとめて無視して良いために，簡単である．</p>
<p><span class="math display">\[
Y_i=X_i^*+\frac{\sigma}{\sqrt{N}}Z_i,
\]</span> <span class="math display">\[
Z_i\overset{\text{iid}}{\sim}\mathrm{N}_1(0,1),
\]</span></p>
<p>であることから，<span class="math inline">\(i^*\)</span> を <span class="math inline">\(X^*_{i^*}=1\)</span> を満たす添字 <span class="math inline">\(i^*\in[d]\)</span> とすると，</p>
<p><span class="math display">\[\begin{align*}
    \mathcal{Z}&amp;=\frac{1}{2^N}\sum_{i=1}^d\exp\left(\frac{NY_i}{\sigma^2}-\frac{N}{2\sigma^2}\right)\\
    &amp;=\frac{1}{2^N}\sum_{i=1}^d\exp\left(\frac{NX^*_i}{\sigma^2}+\frac{\sqrt{N}}{\sigma}Z_i-\frac{N}{2\sigma^2}\right)\\
    &amp;\ge\frac{1}{2^N}\exp\left(\frac{N}{\sigma^2}+\frac{\sqrt{N}}{\sigma}Z_{i^*}-\frac{N}{2\sigma^2}\right)\\
    &amp;=\frac{1}{2^N}\exp\left(\frac{N}{2\sigma^2}+\frac{\sqrt{N}}{\sigma}Z_{i^*}\right)
\end{align*}\]</span></p>
<p>と評価できる．</p>
<p><span class="math display">\[
\log\mathcal{Z}\ge\frac{N}{2\sigma^2}+\frac{\sqrt{N}}{\sigma}Z_{i^*}-N\log 2.
\]</span> <span class="math display">\[\begin{align*}
    \Phi_N(\Delta)&amp;=\frac{\operatorname{E}[\log\mathcal{Z}]}{N}\\
    &amp;\ge\frac{1}{N}\left(\frac{N}{2\sigma^2}-N\log 2\right)\\
    &amp;=\frac{1}{2\Delta}-\log2.
\end{align*}\]</span></p>
<p>これより，低温領域に於ては， <span class="math display">\[
\Phi_N\ge f\;\mathrm{on}\;(0,\Delta_c)
\]</span> が確認できた．</p>
<p>続いて， <span class="math display">\[\begin{align*}
    \frac{\partial \Phi_N(\Delta)}{\partial \Delta}&amp;=\frac{\partial \Phi_N(\Delta)}{\partial \beta}\frac{d \beta}{d \Delta}\\
    &amp;=\frac{\operatorname{E}[\lvert\langle X\rangle\rvert^2]}{2}\left(-\frac{1}{\Delta^2}\right)\le0
\end{align*}\]</span> であることと， <span class="math display">\[
\lim_{\Delta\to\infty}\Phi_N(\Delta)=0
\]</span> であることから，<span class="math inline">\([\Delta_c,\infty)\)</span> 上においても非負であることがわかる．</p>
<p>以上より， <span class="math display">\[
\Phi_N\ge f\;\mathrm{on}\;\mathbb{R}_+.
\]</span></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="補題（上界）^[[@Krzakala-Zdeborova2024 p.126]補題９．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>補題（上界）<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[
\Phi_N(\Delta)\le f(\Delta)+o(1)\quad(N\to\infty)
\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math inline">\(\Phi_N\)</span> の上界は，Boltzmann 分布 <span class="math inline">\(p(x|y)\)</span> に関する期待値に対して，Jensen の不等式を用いることで導かれる．このような不等式は annealed bound とも呼ばれる．</p>
<p>真値 <span class="math inline">\(x^*\)</span> とノイズ <span class="math inline">\(z\)</span> が確定している（従って，<span class="math inline">\(x^*_{i^*}=1\)</span> を満たす <span class="math inline">\(i^*\in[d]\)</span> も確定している）とすると， <span class="math display">\[\begin{align*}
    \mathcal{Z}&amp;=\frac{1}{2^N}\sum_{i=1}^d\exp\left(-\frac{N\beta}{2}+Nx_i^*\beta+z_i\sqrt{N\beta}\right)\\
    &amp;=\frac{1}{2^N}\left(\exp\left(\frac{N\beta}{2}+z_{i^*}\sqrt{N\beta}\right)+\sum_{i\ne i^*}\exp\left(-\frac{N\beta}{2}+z_i\sqrt{N\beta}\right)\right)
\end{align*}\]</span> <span class="math display">\[
\log\mathcal{Z}=\log\left(\exp\left(\frac{N\beta}{2}+z_{i^*}\sqrt{N\beta}-N\log 2\right)+\sum_{i\ne i^*}\frac{1}{2^N}\exp\left(-\frac{N\beta}{2}*Z_i\sqrt{N\beta}\right)\right)
\]</span> と計算できる．凹関数 <span class="math inline">\(\log\)</span> に対する Jensen の不等式より， <span class="math display">\[\begin{align*}
    \operatorname{E}[\log\mathcal{Z}]&amp;\le\operatorname{E}\biggl[\log\biggr(\exp\biggr(\frac{N\beta}{2}+Z_{i^*}\sqrt{N\beta}-N\log 2\biggl)\\
    &amp;\qquad\quad\qquad+\sum_{i\ne i^*}\operatorname{E}_{Z_{-i^*}}\biggl[\frac{1}{2^N}\exp\biggr(-\frac{N\beta}{2}+Z_i\sqrt{N\beta}\biggl)\biggr]\biggl)\biggr]\\
    &amp;=\operatorname{E}\left[\log\left(\exp\left(\frac{N\beta}{2}+Z_{i^*}\sqrt{N\beta}-N\log 2\right)+\frac{2^{N-1}}{2^N}\right)\right]\\
    &amp;\le\operatorname{E}\left[\log\left(\exp\left(\frac{N\beta}{2}+Z_{i^*}\sqrt{N\beta}-N\log 2\right)+1\right)\right]\\
    &amp;=\operatorname{E}\left[\log\biggr(e^{N\left(\frac{\beta}{2}-\log 2\right)}e^{Z_{i^*}\sqrt{N\beta}}+1\biggl)\right].
\end{align*}\]</span></p>
<p>最初の等号にて，<span class="math inline">\(\xi\sim\mathrm{N}(\mu,\sigma^2)\)</span> の積率母関数が <span class="math display">\[
\operatorname{E}[e^{t\xi}]=\exp\left(\mu t+\frac{\sigma^2t^2}{2}\right)
\]</span> で表せることを用いた．</p>
<p>この <span class="math inline">\(Z_{i^*}\)</span> という確率変数は複雑に定まっており，これを直接議論することは後回しにする．</p>
<p>本補題の主張は，純粋に関数 <span class="math display">\[
g(z):=\exp\left(N\left(\frac{\beta}{2}-\log 2\right)+z\sqrt{N\beta}\right)+1
\]</span> の性質を考察するだけで従う．この関数 <span class="math inline">\(g\)</span> を用いると， <span class="math display">\[\begin{align*}
    \Phi_N(\beta)&amp;=\frac{\operatorname{E}[\log\mathcal{Z}]}{N}\\
    &amp;\le\frac{1}{N}\operatorname{E}\biggl[\log(g(Z_{i^*}))\biggr]
\end{align*}\]</span> と表せる．<span class="math inline">\(g\)</span> も <span class="math inline">\(\log g\)</span> も凸関数であるから， <span class="math display">\[\begin{align*}
    \log g(\lvert z\rvert)&amp;\le\log g(0)+\lvert z\rvert\frac{d }{d z}\log g(\lvert z\rvert)\\
    &amp;=\log g(0)+\frac{g'(\lvert z\rvert)}{g(\lvert z\rvert)}\\
    &amp;\le\log g(0)+\lvert z\rvert\sqrt{N\beta}\\
    &amp;=\log\biggr(e^{N\left(\frac{\beta}{2}-\log 2\right)}+1\biggl)+\lvert z\rvert\sqrt{N\beta}.
\end{align*}\]</span></p>
<p>これより， <span class="math display">\[\begin{align*}
    \Phi_N(\beta)&amp;\le\frac{1}{N}\operatorname{E}\biggl[\log(g(\lvert Z_{i^*}\rvert))\biggr]\\
    &amp;\le\frac{1}{N}\log\biggr(e^{N\left(\frac{\beta}{2}-\log 2\right)}+1\biggl)+\sqrt{\frac{\beta}{N}}\operatorname{E}[\lvert Z_{i^*}\rvert].
\end{align*}\]</span></p>
<p>よって，<span class="math inline">\(Z_{i^*}\)</span> が可積分であることさえ認めれば，<span class="math inline">\(N\to\infty\)</span> のとき， <span class="math display">\[
\Delta\ge\Delta_c\quad\Leftrightarrow\quad\frac{\beta}{2}\le\log2
\]</span> のとき，<span class="math inline">\(\log\biggr(e^{N\left(\frac{\beta}{2}-\log 2\right)}+1\biggl)\ge0\)</span> であり，そうでない場合は <span class="math display">\[
\log(1+e^x)\le x\quad x\in\mathbb{R}_+
\]</span> より， <span class="math display">\[
\Phi_N(\Delta)\le\frac{\beta}{2}-\log2+o(1)\quad(N\to\infty)
\]</span> を得る．</p>
</div>
</div>
</div>
</section>
<section id="解釈" class="level3" data-number="3.5">
<h3 data-number="3.5" class="anchored" data-anchor-id="解釈"><span class="header-section-number">3.5</span> 解釈</h3>
<p><span class="math inline">\(N\to\infty\)</span> の極限において，高温領域 <span class="math inline">\(\Delta&gt;\Delta_c\)</span> において，最小自乗誤差（MMSE）は <span class="math inline">\(1\)</span> であり，何をどうしても復号することはできない．Gauss ノイズ <span class="math inline">\(\Delta=\sigma^2\)</span> が大きすぎるのである．</p>
<p>一方で，低温領域 <span class="math inline">\(\Delta&lt;\Delta_c\)</span> において，<span class="math inline">\(\partial_\beta f=\frac{1}{2}\)</span> であり，従って MMSE は <span class="math inline">\(0\)</span> になる．よって完全な誤りのない復号が可能であるはずである．</p>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>設定（第 <a href="#sec-settings" class="quarto-xref">3.1</a> 節）が与えられたならば，立ち所に，<span class="math inline">\(\Delta\)</span> が大きいほど復号が難しいことは予想がつく．しかし，ある閾値 <span class="math inline">\(\Delta_c\)</span> に依存して，少なくとも <span class="math inline">\(N\to\infty\)</span> の極限では，</p>
<ul>
<li>２つの領域で全く異なる振る舞いをすること</li>
<li>２つの振る舞いのみに分類される（ある一定以上の確率で復号が可能である，などの中間状態がない）こと</li>
</ul>
<p>は驚きである．</p>
</div>
</div>
</div>
<p>実は，高温領域 <span class="math inline">\(\Delta&gt;\Delta_c\)</span> では，自由エネルギー <span class="math inline">\(F_N\)</span> が <span class="math inline">\(0\)</span> に指数収束する．<span class="math inline">\(F_N\)</span> とは，完全な Gauss ノイズ <span class="math display">\[
q(y)dy:=\mathrm{N}_d\biggr(0,\frac{\Delta}{N}I_d\biggl)
\]</span> と <span class="math inline">\(p(y)\)</span> との KL 距離距離であったから，メッセージ <span class="math inline">\(x^*\)</span> を完全な雑音と見分けることが加速度的に難しくなっていくのである．</p>
</section>
<section id="自由エネルギーのさらに鋭い評価" class="level3" data-number="3.6">
<h3 data-number="3.6" class="anchored" data-anchor-id="自由エネルギーのさらに鋭い評価"><span class="header-section-number">3.6</span> 自由エネルギーのさらに鋭い評価</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（KL 乖離度は指数収束する）^[[@Krzakala-Zdeborova2024 p.132]補題10．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>命題（KL 乖離度は指数収束する）<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p>高温領域 <span class="math inline">\(\Delta&gt;\Delta_c\)</span> において，ある <span class="math inline">\(C&gt;0\)</span> が存在して，任意の <span class="math inline">\(N\in\mathbb{N}^+\)</span> について次が成り立つ：</p>
<p><span class="math display">\[\begin{align*}
    F_N(\Delta)=\operatorname{KL}\biggr(p(y)\,\bigg|\,q(y)\biggl)\le e^{-CN}
\end{align*}\]</span></p>
<p>ただし，<span class="math inline">\(p\)</span> は観測信号 <span class="math inline">\(Y\sim\mathrm{N}_d\left(X^*,\frac{\Delta}{N}I_d\right)\)</span> の密度，<span class="math inline">\(q\)</span> は <span class="math inline">\(\mathrm{N}_d\left(0,\frac{\Delta}{N}I_d\right)\)</span> の密度とした．</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-31-contents" aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-31" class="callout-31-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>第 <a href="#sec-bounds-on-Phi" class="quarto-xref">3.4</a> 節で示した <span class="math inline">\(\Phi_N\)</span> の上界評価では， <span class="math display">\[\begin{align*}
    \Phi_N(\beta)&amp;=\frac{\operatorname{E}[\log\mathcal{Z}]}{N}\\
    &amp;\le\frac{1}{N}\operatorname{E}\left[\log\left(\exp\left(N\left(\frac{\beta}{2}-\log 2\right)+Z_i^*\sqrt{N\beta}\right)+1\right)\right]
\end{align*}\]</span> を得て，<span class="math inline">\(Z_i^*\)</span> の評価を回避したのであった．</p>
<p>これに正面から取り組むことで，高温領域 <span class="math inline">\(\Delta&gt;\Delta_c\)</span> での <span class="math inline">\(\Phi_N\)</span> の指数収束を示すことができる．</p>
<p>高温領域 <span class="math inline">\(\Delta&gt;\Delta_c\)</span> では， <span class="math display">\[
f:=-\frac{\beta}{2}+\log2&gt;0
\]</span> が成り立つ．</p>
<p><span class="math inline">\(Z_{i^*}\)</span> は，まず <span class="math inline">\(X^*\)</span> によって条件付ければ <span class="math inline">\(Z_{i^*}|X^*\sim\mathrm{N}(0,1)\)</span> であるから， <span class="math display">\[\begin{align*}
    N\Phi_N(\beta)&amp;\le\operatorname{E}\left[\log\biggr(e^{-fN+Z_{i^*}\sqrt{N\beta}}+1\biggl)\right]\\
    &amp;=\int_\mathbb{R}\frac{e^{-\frac{z^2}{2}}}{\sqrt{2\pi}}\log\biggr(e^{-fN+z\sqrt{N\beta}}+1\biggl)\,dz\\
    &amp;=\left(\int^{R}_{-\infty}+\int_{R}^\infty\right)\frac{e^{-\frac{z^2}{2}}}{\sqrt{2\pi}}\log\biggr(e^{-fN+z\sqrt{N\beta}}+1\biggl)\,dz
\end{align*}\]</span> と分解すると，まず <span class="math inline">\((-\infty,R)\)</span> 上の積分は <span class="math inline">\(N\to\infty\)</span> に関して指数収束する．</p>
<p>実際，<span class="math inline">\(R&gt;0\)</span> に対して <span class="math inline">\(N\in\mathbb{N}^+\)</span> を十分大きく取ることで，ある <span class="math inline">\(\epsilon&gt;0\)</span> が存在して <span class="math display">\[
-fN+z\sqrt{N\beta}\le-\epsilon fN
\]</span> を満たすようにできるから，</p>
<p><span class="math display">\[\begin{align*}
    &amp;\quad\int^{R}_{-\infty}\frac{e^{-\frac{z^2}{2}}}{\sqrt{2\pi}}\log\biggr(e^{-fN+z\sqrt{N\beta}}+1\biggl)\,dz\\
    &amp;&lt;\int_\mathbb{R}\frac{e^{-\frac{z^2}{2}}}{\sqrt{2\pi}}\log\biggr(e^{-\epsilon fN}+1\biggl)\,dz\\
    &amp;=\log\left(1+e^{-\epsilon fN}\right)\le e^{-\epsilon fN}.
\end{align*}\]</span> 最後の不等式は <span class="math display">\[
\log(1+x)\le x\quad x\in\mathbb{R}
\]</span> による．</p>
<p>従って，あとは <span class="math inline">\((R,\infty)\)</span> 上の積分が指数収束することを示せば良いが，再び <span class="math inline">\(\log(1+x)\le x\)</span> に注意して <span class="math display">\[\begin{align*}
    &amp;\quad\int^\infty_\mathbb{R}\frac{e^{-\frac{z^2}{2}}}{\sqrt{2\pi}}\log\left(e^{-fN+z\sqrt{N\beta}}+1\right)\,dz\\
    &amp;\le\int^\infty_\mathbb{R}\frac{1}{\sqrt{2\pi}}e^{-fN+z\sqrt{N\beta}-\frac{z^2}{2}}\,dz\\
    &amp;=e^{\frac{N\beta}{2}-fN}\int^\infty_\mathbb{R}\frac{1}{\sqrt{2\pi}}e^{-\frac{(z-\sqrt{N\beta})^2}{2}}\,dz\\
    &amp;=e^{\frac{N\beta}{2}-fN}\operatorname{P}\biggl[Z&gt;R-\sqrt{N\beta}\biggr]
\end{align*}\]</span> と評価できるから，あとは <span class="math inline">\(Z\sim\gamma_1\)</span> の尾部確率が指数収束するかどうか（正確には劣 Gauss 性を持つかどうか）の問題に帰着する．</p>
<p>実はこれは yes である．中心化された確率変数の積率母関数が，ある <span class="math inline">\(\sigma&gt;0\)</span> に関して <span class="math display">\[
\operatorname{E}[e^{\lambda\xi}]\le e^{\frac{\lambda^2\sigma^2}{2}}\quad\lambda\in\mathbb{R}
\]</span> を満たすことは，ある <span class="math inline">\(\kappa&gt;0\)</span> が存在して <span class="math display">\[
\operatorname{P}[\lvert\xi\rvert\ge t]\le 2e^{-\frac{t^2}{2\kappa^2}}
\]</span> を満たすことに同値になる．特に，<span class="math inline">\(\Rightarrow\)</span> 方向には <span class="math inline">\(\kappa=\sigma\)</span> ととれる．<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a> <span class="math inline">\(\Phi_N\)</span> の上界評価（第 <a href="#sec-bounds-on-Phi" class="quarto-xref">3.4</a> 節）で触れたように，（中心化された）Gauss 確率変数はこれを満たす．</p>
<p>よって， <span class="math display">\[\begin{align*}
    &amp;\quad e^{\frac{N\beta}{2}-fN}\operatorname{P}\biggl[Z&gt;R-\sqrt{N\beta}\biggr]\\
    &amp;\le e^{\frac{N\beta}{2}-fN}e^{-\frac{(R-\sqrt{N\beta})^2}{2}}\\
    &amp;=e^{\frac{N\beta}{2}-fN}e^{-\frac{R^2}{2}+\sqrt{N\beta}R-\frac{N\beta}{2}}\\
    &amp;=\exp\left(-\frac{R^2}{2}+\sqrt{N\beta}R-Nf\right).
\end{align*}\]</span></p>
<p>この最右辺，ある定数 <span class="math inline">\(C&gt;0\)</span> が存在して，<span class="math inline">\(e^{-CN}\)</span> で抑えられる．</p>
<div class="footnote-size">
<p>あるいは，任意の <span class="math inline">\(N\in\mathbb{N}^+\)</span> に対して <span class="math display">\[
R:=\sqrt{\frac{N}{\beta}}f-\delta\quad\delta&gt;0
\]</span> と取ることで，<span class="math inline">\((-\infty,R),(R,\infty)\)</span> 上の積分のそれぞれについて，同様の評価を得る．</p>
</div>
<p>以上より， <span class="math display">\[\begin{align*}
    F_N(\Delta)&amp;=N\Phi_N\\
    &amp;\le e^{-KN}.
\end{align*}\]</span></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（劣 Gauss 確率変数の特徴付け）^[[@Vershynin18-HighDimensional p.25]命題2.5.2．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>命題（劣 Gauss 確率変数の特徴付け）<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(X\in L(\Omega)\)</span> を確率変数とする．このとき，次の４条件は同値で，さらに <span class="math inline">\(\{K_1,\cdots,K_5\}\subset\mathbb{R}^+\)</span> はある <span class="math inline">\(C\in\mathbb{R}\)</span> が存在して，<span class="math inline">\(\forall_{i,j\in[5]}\;K_j\le CK_i\)</span> を満たすように取れる．</p>
<ol type="1">
<li>尾部確率の評価：ある <span class="math inline">\(K_1&gt;0\)</span> が存在して，<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a> <span class="math display">\[
\mathrm{P}[\lvert X\rvert\ge t]\le 2e^{-\frac{t^2}{K_1^2}},\qquad t\ge0.
\]</span></li>
<li><span class="math inline">\(L^p\)</span>-ノルムの評価：ある <span class="math inline">\(K_2&gt;0\)</span> が存在して， <span class="math display">\[
\|X\|_{L^p}\le K_2\sqrt{p},\qquad p\ge1.
\]</span></li>
<li><span class="math inline">\(X^2\)</span> の積率母関数の <span class="math inline">\(0\)</span> の近傍での評価：ある <span class="math inline">\(K_3&gt;0\)</span> が存在して， <span class="math display">\[
\lvert\lambda\rvert\le\frac{1}{K_3}\quad\Rightarrow\quad \mathrm{E}[e^{\lambda^2 X^2}]\le e^{K_3^2\lambda^2}.
\]</span></li>
<li><span class="math inline">\(X^2\)</span> の積率母関数のある1点での値：ある <span class="math inline">\(K_4&gt;0\)</span> が存在して， <span class="math display">\[
\operatorname{E}\left[e^{\frac{X^2}{K_4^2}}\right]\le2.
\]</span></li>
<li>さらに，<span class="math inline">\(X\)</span> が中心化されている場合，次とも同値：ある <span class="math inline">\(K_5&gt;0\)</span> が存在して， <span class="math display">\[
\operatorname{E}[e^{\lambda X}]\le e^{K^2_5\lambda^2},\qquad\lambda\in\mathbb{R}.
\]</span></li>
</ol>
<p>以上の同値な条件を満たす確率変数 <span class="math inline">\(X\)</span> を <strong>劣 Gauss</strong> (sub-Gaussian) という．</p>
</div>
</div>
</section>
<section id="まとめ" class="level3" data-number="3.7">
<h3 data-number="3.7" class="anchored" data-anchor-id="まとめ"><span class="header-section-number">3.7</span> まとめ</h3>
<p>大変単純化された設定 toy model であったが，比例的高次元極限 <span class="math inline">\(N\to\infty\)</span> において，厳密に示せる相転移を示す模型である．</p>
<p>すなわち，ただ一つの非零成分 <span class="math inline">\(1\)</span> に対して，ノイズの分散 <span class="math inline">\(\sigma^2\)</span> が <span class="math inline">\((2\log2)^{-1}\)</span> より大きいかどうかで，これが復号可能かどうかが決まる．</p>
<p>この <span class="math inline">\(2\log2\)</span> という値は <span class="citation" data-cites="Donoho-Johnstone1994">(<a href="#ref-Donoho-Johnstone1994" role="doc-biblioref">Donoho and Johnstone, 1994</a>)</span> が universal threshold と呼ぶ値の例であり，ランダムエネルギーモデルのスピングラス相転移境界と対応する．<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a></p>
<p>一般のモデルでは，この臨界温度の値は不明である上に，<span class="math inline">\(\Delta&gt;\Delta_c\)</span> の高温領域での効率的な推定法が見つかっていない場合も多い．</p>
<p>このような，高次元統計推測の問題においては，統計物理学，特にスピングラス理論の知見が活発に応用されて，漸近極限における相図の解明，統計計算手法の開発が目指されている．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="scheme.jpeg" class="img-fluid figure-img"></p>
<figcaption>Schematic representation of a typical high-dimensional inference problem from <span class="citation" data-cites="Zdeborova-Krzakala2016">(<a href="#ref-Zdeborova-Krzakala2016" role="doc-biblioref">Zdeborová and Krzakala, 2016, p. 466</a>)</span></figcaption>
</figure>
</div>
<div id="listing-lst-Bayes22" class="listing quarto-float quarto-figure quarto-figure-left quarto-listing quarto-listing-container-default anchored">
<div class="list quarto-listing-default">
<div class="quarto-post image-right" data-index="0" data-categories="QmF5ZXNpYW4lMkNOYXR1cmUlMkNJbmZvcm1hdGlvbg==" data-listing-date-sort="1719100800000" data-listing-file-modified-sort="1768808202244" data-listing-date-modified-sort="1719532800000" data-listing-reading-time-sort="8" data-listing-word-count-sort="1507">
<div class="thumbnail"><a href="../../../posts/2024/Stat/Bayes2.html" class="no-external">

<img loading="lazy" src="../../../posts/2024/Stat/phase_regular_rev.jpeg" class="thumbnail-image">

</a></div>
<div class="body">
<h3 class="no-anchor listing-title">
<a href="../../../posts/2024/Stat/Bayes2.html" class="no-external">ベイズ統計学とスピングラス</a>
</h3>
<div class="listing-subtitle">
<a href="../../../posts/2024/Stat/Bayes2.html" class="no-external">誤り訂正符号を題材にして</a>
</div>
</div>
<div class="metadata">
<a href="../../../posts/2024/Stat/Bayes2.html" class="no-external">
<div class="listing-date">
2024-06-23
</div>
</a>
</div>
</div>
</div>
<div class="listing-no-matching d-none">No matching items</div>
</div>
</section>
</section>



<div id="quarto-appendix" class="default"><section id="終わりに" class="level2 appendix" data-number="4"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">4</span> 終わりに</h2><div class="quarto-appendix-contents">

<p>第 <a href="#sec-sparse-vector-denoising" class="quarto-xref">3</a> 節において，統計力学の知見は，レプリカ法などの計算手法を通じて，<span class="math inline">\(N\to\infty\)</span> における漸近極限として，「大規模な確率分布から平均値を計算するための”ツールボックス”」<span class="citation" data-cites="樺島祥介2003">(<a href="#ref-樺島祥介2003" role="doc-biblioref">樺島祥介, 2003</a>)</span> として働いている．</p>
<blockquote class="blockquote">
<p>大自由度系では，次元に関して計算量が指数約に爆発してしまう．平衡統計力学の歴史はこの問題との戦いの歴史である，と言っても過言ではない．<span class="citation" data-cites="樺島-杉浦2008">(<a href="#ref-樺島-杉浦2008" role="doc-biblioref">樺島祥介 and 杉浦正康, 2008, p. 22</a>)</span></p>
</blockquote>




</div></section><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Derrida1980" class="csl-entry" role="listitem">
Derrida, B. (1980). <a href="https://doi.org/10.1103/PhysRevLett.45.79">Random-energy model: Limit of a family of disordered models</a>. <em>Phys. Rev. Lett.</em>, <em>45</em>, 79–82.
</div>
<div id="ref-Donoho-Johnstone1994" class="csl-entry" role="listitem">
Donoho, D. L., and Johnstone, I. M. (1994). <a href="http://www.jstor.org/stable/2337118">Ideal spatial adaptation by wavelet shrinkage</a>. <em>Biometrika</em>, <em>81</em>(3), 425–455.
</div>
<div id="ref-Guo+2005" class="csl-entry" role="listitem">
Guo, D., Shamai, S., and Verdu, S. (2005). <a href="https://doi.org/10.1109/TIT.2005.844072">Mutual information and minimum mean-square error in gaussian channels</a>. <em>IEEE Transactions on Information Theory</em>, <em>51</em>(4), 1261–1282.
</div>
<div id="ref-Iba1999" class="csl-entry" role="listitem">
Iba, Y. (1999). <a href="https://doi.org/10.1088/0305-4470/32/21/302"><span class="nocase">The Nishimori line and Bayesian statistics</span></a>. <em>Journal of Physics A: Mathematical and General</em>, <em>32</em>(21), 3875.
</div>
<div id="ref-Jaynes1957" class="csl-entry" role="listitem">
Jaynes, E. T. (1957). <a href="https://doi.org/10.1103/PhysRev.106.620">Information theory and statistical mechanics</a>. <em>Phys. Rev.</em>, <em>106</em>, 620–630.
</div>
<div id="ref-Krzakala-Zdeborova2024" class="csl-entry" role="listitem">
Krazakala, F., and Zdeborová, L. (2024). <em><a href="https://sphinxteam.github.io/EPFLDoctoralLecture2021/Notes.pdf">Statistical physics methods in optimization and machine learning</a></em>.
</div>
<div id="ref-Krzakala+2015" class="csl-entry" role="listitem">
Krzakala, F., Zdeborova, L., Angelini, M. C., and Caltagirone, F. (2015). <em><a href="https://indico.ictp.it/event/a14244/material/10/0.pdf">Statistical physics of inference and bayesian estimation</a></em>.
</div>
<div id="ref-Mezard-Montanari2009" class="csl-entry" role="listitem">
Mézard, M., and Montanari, A. (2009). <em><a href="https://doi.org/10.1093/acprof:oso/9780198570837.001.0001">Information, physics, and computation</a></em>. Oxford University Press.
</div>
<div id="ref-Murphy2023" class="csl-entry" role="listitem">
Murphy, K. P. (2023). <em><a href="http://probml.github.io/book2">Probabilistic machine learning: Advanced topics</a></em>. MIT Press.
</div>
<div id="ref-西森1980" class="csl-entry" role="listitem">
Nishimori, H. (1980). <a href="https://doi.org/10.1088/0022-3719/13/21/012">Exact results and critical properties of the ising model with competing interactions</a>. <em>Journal of Physics C: Solid State Physics</em>, <em>13</em>(21), 4071.
</div>
<div id="ref-Shalev-Shwartz-Ben-David2014" class="csl-entry" role="listitem">
Shalev-Shwartz, S., and Ben-David, S. (2014). <em><a href="https://doi.org/10.1017/CBO9781107298019">Understanding machine learning: From theory to algorithms</a></em>. Cambridge University Press.
</div>
<div id="ref-Stein1972" class="csl-entry" role="listitem">
Stein, C. (1972). <em><span class="nocase">A Bound for the Error in the Normal Approximation to the Distribution of a Sum of Dependent Random Variables</span></em>. Stanford University. Retrieved from <a href="https://purl.stanford.edu/jc818sv7483">https://purl.stanford.edu/jc818sv7483</a>
</div>
<div id="ref-Storopoli2021" class="csl-entry" role="listitem">
Storopoli, J. (2021). <a href="https://storopoli.io/Bayesian-Julia">Bayesian statistics with julia and turing</a>.
</div>
<div id="ref-Vershynin18-HighDimensional" class="csl-entry" role="listitem">
Vershynin, R. (2018). <em>High-dimensional probability</em>,Vol. 47. Cambridge University Press.
</div>
<div id="ref-Zdeborova-Krzakala2016" class="csl-entry" role="listitem">
Zdeborová, L., and Krzakala, F. (2016). <a href="https://doi.org/10.1080/00018732.2016.1211393">Statistical physics of inference: Thresholds and algorithms</a>. <em>Advances in Physics</em>, <em>65</em>(5), 453–552.
</div>
<div id="ref-樺島祥介2003" class="csl-entry" role="listitem">
樺島祥介. (2003). <a href="https://doi.org/10.11316/butsuri1946.58.239">コトの物理学：誤り訂正符号を例として</a>. <em>日本物理学会誌</em>, <em>58</em>(4), 239–246.
</div>
<div id="ref-樺島-杉浦2008" class="csl-entry" role="listitem">
樺島祥介, and 杉浦正康. (2008). <a href="http://hdl.handle.net/2433/142666">コトの物理学</a>. <em>物性研究</em>, <em>91</em>(1), 1–33.
</div>
<div id="ref-西森秀稔2005" class="csl-entry" role="listitem">
西森秀稔. (2005). <em><a href="https://www.kyoritsu-pub.co.jp/book/b10003637.html">相転移・臨界現象の統計物理学</a></em>,Vol. 35. 培風館.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><span class="citation" data-cites="Zdeborova-Krzakala2016">(<a href="#ref-Zdeborova-Krzakala2016" role="doc-biblioref">Zdeborová and Krzakala, 2016, p. 467</a>)</span> も参照．<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><span class="citation" data-cites="Shalev-Shwartz-Ben-David2014">(<a href="#ref-Shalev-Shwartz-Ben-David2014" role="doc-biblioref">Shalev-Shwartz and Ben-David, 2014, p. 25</a>)</span> や <span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala and Zdeborová, 2024, p. 119</a>)</span> に倣った．<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala and Zdeborová, 2024, p. 122</a>)</span>．<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p><span class="citation" data-cites="Zdeborova-Krzakala2016">(<a href="#ref-Zdeborova-Krzakala2016" role="doc-biblioref">Zdeborová and Krzakala, 2016, p. 464</a>)</span>，<span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala and Zdeborová, 2024, p. 123</a>)</span> 定理13，<span class="citation" data-cites="Iba1999">(<a href="#ref-Iba1999" role="doc-biblioref">Iba, 1999, pp. 3876–3877</a>)</span> などで扱われている．西森ライン上のみで見られる性質であるため，西森対称性と呼ぶ．西森ラインについては <a href="../../../posts/2024/Stat/Bayes2.html#sec-Nishimori-line">次項</a> も参照．<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p><span class="citation" data-cites="Mezard-Montanari2009">(<a href="#ref-Mezard-Montanari2009" role="doc-biblioref">Mézard and Montanari, 2009, p. 249</a>)</span> や <span class="citation" data-cites="Iba1999">(<a href="#ref-Iba1999" role="doc-biblioref">Iba, 1999, p. 3876</a>)</span> などでは thermal average と quenched average の用語が採用されている．<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala and Zdeborová, 2024, p. 124</a>)</span> 定理14．<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p><span class="citation" data-cites="西森秀稔2005">(<a href="#ref-西森秀稔2005" role="doc-biblioref">西森秀稔, 2005, p. 123</a>)</span>なども参照．<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala and Zdeborová, 2024, p. 125</a>)</span> 定理15，<span class="citation" data-cites="樺島-杉浦2008">(<a href="#ref-樺島-杉浦2008" role="doc-biblioref">樺島祥介 and 杉浦正康, 2008, p. 14</a>)</span> なども参照．証明は <span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala and Zdeborová, 2024, p. 133</a>)</span> 7.B 節 を参考にした．<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala and Zdeborová, 2024, p. 125</a>)</span>補題８．<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala and Zdeborová, 2024, p. 126</a>)</span>補題９．<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala and Zdeborová, 2024, p. 132</a>)</span>補題10．<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p><span class="citation" data-cites="Vershynin18-HighDimensional">(<a href="#ref-Vershynin18-HighDimensional" role="doc-biblioref">Vershynin, 2018, p. 25</a>)</span>命題2.5.2など．<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p><span class="citation" data-cites="Vershynin18-HighDimensional">(<a href="#ref-Vershynin18-HighDimensional" role="doc-biblioref">Vershynin, 2018, p. 25</a>)</span>命題2.5.2．<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>この定数2は，1よりも真に大きい定数ならばなんでも良い．<span class="citation" data-cites="Vershynin18-HighDimensional">(<a href="#ref-Vershynin18-HighDimensional" role="doc-biblioref">Vershynin, 2018, p. 27</a>)</span>注2.5.3 も参照．<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn15"><p><span class="citation" data-cites="Krzakala+2015">(<a href="#ref-Krzakala+2015" role="doc-biblioref">Krzakala et al., 2015, p. 8</a>)</span> また p.16 も参照すべし．<a href="#fnref15" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/162348\.github\.io\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
        for (let i=0; i<annoteTargets.length; i++) {
          const annoteTarget = annoteTargets[i];
          const targetCell = annoteTarget.getAttribute("data-target-cell");
          const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
          const contentFn = () => {
            const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            if (content) {
              const tipContent = content.cloneNode(true);
              tipContent.classList.add("code-annotation-tip-content");
              return tipContent.outerHTML;
            }
          }
          const config = {
            allowHTML: true,
            content: contentFn,
            onShow: (instance) => {
              selectCodeLines(instance.reference);
              instance.reference.classList.add('code-annotation-active');
              window.tippy.hideAll();
            },
            onHide: (instance) => {
              unselectCodeLines();
              instance.reference.classList.remove('code-annotation-active');
            },
            maxWidth: 300,
            delay: [50, 0],
            duration: [200, 0],
            offset: [5, 10],
            arrow: true,
            trigger: 'click',
            appendTo: function(el) {
              return el.parentElement.parentElement.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'quarto',
            placement: 'right',
            positionFixed: true,
            popperOptions: {
              modifiers: [
              {
                name: 'flip',
                options: {
                  flipVariations: false, // true by default
                  allowedAutoPlacements: ['right'],
                  fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                },
              },
              {
                name: 'preventOverflow',
                options: {
                  mainAxis: false,
                  altAxis: false
                }
              }
              ]        
            }      
          };
          window.tippy(annoteTarget, config); 
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
<script>
  function loadGiscus() {
    // Function to get the theme based on body class
    const getTheme = () => {
      let baseTheme = document.getElementById('giscus-base-theme').value;
      let altTheme = document.getElementById('giscus-alt-theme').value;
      return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
    };
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "162348/162348.github.io";
    script.dataset.repoId = "R_kgDOKlfKYQ";
    script.dataset.category = "Announcements";
    script.dataset.categoryId = "DIC_kwDOKlfKYc4CgDmb";
    script.dataset.mapping = "pathname";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "top";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  }
  loadGiscus();
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://162348.github.io/">
<p>Hirofumi Shiba</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/162348/162348.github.io/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ano2math5">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:shiba.hirofumi@ism.ac.jp">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../../blog.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>