<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="司馬博文">

<title>Zig-Zag サンプラーのサブサンプリングによるスケーラビリティ – Hirofumi Shiba</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../assets/Shiba2.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-listing/list.min.js"></script>
<script src="../../../site_libs/quarto-listing/quarto-listing.js"></script>
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-69a118ed5aa843c5d3f13e92a12ee77e.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark-f8de076aeb9658a6c96d343f1d6c5546.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-69a118ed5aa843c5d3f13e92a12ee77e.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-4c09742be2272f701a3e51422777528f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark-4c09742be2272f701a3e51422777528f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-4c09742be2272f701a3e51422777528f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "?",
    "H"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>

  window.document.addEventListener("DOMContentLoaded", function (_event) {
    const listingTargetEl = window.document.querySelector('#listing-lst-listing .list');
    if (!listingTargetEl) {
      // No listing discovered, do not attach.
      return; 
    }

    const options = {
      valueNames: ['listing-title','listing-image','listing-date','listing-subtitle',{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
      
      searchColumns: ["listing-title","listing-author","listing-date","listing-image","listing-description"],
    };

    window['quarto-listings'] = window['quarto-listings'] || {};
    window['quarto-listings']['listing-lst-listing'] = new List('listing-lst-listing', options);

    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  });

  window.addEventListener('hashchange',() => {
    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  })
  </script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-36GX2G6GLL"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-36GX2G6GLL', { 'anonymize_ip': true});
</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Zen+Kurenaido&amp;display=swap" rel="stylesheet">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=BIZ+UDPGothic&amp;display=swap" rel="stylesheet">

<style>
  h1, .title, .description, .subtitle {
    font-family: "Zen Kurenaido", sans-serif !important;
  }
</style>

<!-- <style>
  .menu-text {
      font-family: "Gill Sans", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
  .navbar-title {
      font-family: "Gill Sans", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
</style> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../assets/styles.css">
<meta property="og:title" content="Zig-Zag サンプラーのサブサンプリングによるスケーラビリティ – Hirofumi Shiba">
<meta property="og:description" content="Zig-Zag サンプラーは，その非対称なダイナミクスにより，収束が速くなることが期待されている MCMC 手法である．それだけでなく，対数尤度の勾配に対する不偏推定量をサブサンプリングにより構成することで，ベイズ推論においてサンプルサイズに依らない一定のコストで効率的な事後分布からのサンプリングが可能である．">
<meta property="og:image" content="https://162348.github.io/posts/2024/Stat/MeanOfGaussian.svg">
<meta property="og:site_name" content="Hirofumi Shiba">
<meta name="twitter:title" content="Zig-Zag サンプラーのサブサンプリングによるスケーラビリティ – Hirofumi Shiba">
<meta name="twitter:description" content="Zig-Zag サンプラーは，その非対称なダイナミクスにより，収束が速くなることが期待されている MCMC 手法である．それだけでなく，対数尤度の勾配に対する不偏推定量をサブサンプリングにより構成することで，ベイズ推論においてサンプルサイズに依らない一定のコストで効率的な事後分布からのサンプリングが可能である．">
<meta name="twitter:image" content="https://162348.github.io/posts/2024/Stat/MeanOfGaussian.svg">
<meta name="twitter:creator" content="@ano2math5">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Hirofumi Shiba</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-notes" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Notes</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-notes">    
        <li>
    <a class="dropdown-item" href="../../../static/English.html">
 <span class="dropdown-text">English Notes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../blog.html">
 <span class="dropdown-text">ノート (Japanese)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Materials.html"> 
<span class="menu-text">Materials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/162348/162348.github.io/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Zig-Zag サンプラーのサブサンプリングによるスケーラビリティ</h1>
            <p class="subtitle lead">大規模モデル・大規模データに対する MCMC を目指して</p>
                                <div class="quarto-categories">
                <div class="quarto-category">MCMC</div>
                <div class="quarto-category">Computation</div>
                <div class="quarto-category">Julia</div>
                <div class="quarto-category">Sampling</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>司馬博文 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">7/18/2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">8/29/2024</p>
      </div>
    </div>
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="block-title">概要</div>
      Zig-Zag サンプラーは，その非対称なダイナミクスにより，収束が速くなることが期待されている MCMC 手法である．それだけでなく，対数尤度の勾配に対する不偏推定量をサブサンプリングにより構成することで，ベイズ推論においてサンプルサイズに依らない一定のコストで効率的な事後分布からのサンプリングが可能である．
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目次</h2>
   
  <ul>
  <li><a href="#対数尤度の勾配を不変推定する" id="toc-対数尤度の勾配を不変推定する" class="nav-link active" data-scroll-target="#対数尤度の勾配を不変推定する"><span class="header-section-number">1</span> 対数尤度の勾配を不変推定する</a></li>
  <li><a href="#サブサンプリングを取り入れた-zig-zag-サンプラー" id="toc-サブサンプリングを取り入れた-zig-zag-サンプラー" class="nav-link" data-scroll-target="#サブサンプリングを取り入れた-zig-zag-サンプラー"><span class="header-section-number">2</span> サブサンプリングを取り入れた Zig-Zag サンプラー</a></li>
  <li><a href="#sec-ZZ-CV" id="toc-sec-ZZ-CV" class="nav-link" data-scroll-target="#sec-ZZ-CV"><span class="header-section-number">3</span> 制御変数による分散低減</a></li>
  <li><a href="#zz-cv-のスケーリング" id="toc-zz-cv-のスケーリング" class="nav-link" data-scroll-target="#zz-cv-のスケーリング"><span class="header-section-number">4</span> ZZ-CV のスケーリング</a></li>
  <li><a href="#数値実験mse-の比較" id="toc-数値実験mse-の比較" class="nav-link" data-scroll-target="#数値実験mse-の比較"><span class="header-section-number">5</span> 数値実験：MSE の比較</a></li>
  <li><a href="#mala-との比較" id="toc-mala-との比較" class="nav-link" data-scroll-target="#mala-との比較"><span class="header-section-number">6</span> MALA との比較</a></li>
  <li><a href="#非一様な部分サンプリング" id="toc-非一様な部分サンプリング" class="nav-link" data-scroll-target="#非一様な部分サンプリング"><span class="header-section-number">7</span> 非一様な部分サンプリング</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
<p>$$</p>
<p>$$</p>
</div>
<div id="listing-lst-listing" class="listing quarto-float quarto-figure quarto-figure-left quarto-listing quarto-listing-container-grid anchored">
<div class="list grid quarto-listing-cols-3">
<div class="g-col-1" data-index="0" data-categories="UHJvY2VzcyUyQ1NhbXBsaW5nJTJDSnVsaWElMkNNQ01D" data-listing-date-sort="1719964800000" data-listing-file-modified-sort="1764770137095" data-listing-date-modified-sort="1721260800000" data-listing-reading-time-sort="13" data-listing-word-count-sort="2488">
<a href="../../../posts/2024/Process/ZigZag.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top"><img src="../Process/ZigZag2D_Gaussian.svg" style="height: 150px;"  class="thumbnail-image card-img"/></p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
Zig-Zag 過程によるサンプリング
</h5>
<div class="card-subtitle listing-subtitle">
ジャンプと確定的な動きによる新たな MCMC 手法
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-07-03
</div>
</div>
</div>
</div></a>
</div>
<div class="g-col-1" data-index="1" data-categories="QmF5ZXNpYW4lMkNDb21wdXRhdGlvbiUyQ0p1bGlhJTJDTUNNQyUyQ1N0YXRpc3RpY3M=" data-listing-date-sort="1720742400000" data-listing-file-modified-sort="1764770138144" data-listing-date-modified-sort="1728259200000" data-listing-reading-time-sort="10" data-listing-word-count-sort="1931">
<a href="../../../posts/2024/Stat/Logistic.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/Stat/Logistic_WhiteBackground.svg" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
大規模な不均衡データに対するロジスティック回帰（前編）
</h5>
<div class="card-subtitle listing-subtitle">
離散時間 MCMC から連続時間 MCMC へ
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-07-12
</div>
</div>
</div>
</div></a>
</div>
<div class="g-col-1" data-index="2" data-categories="QmF5ZXNpYW4lMkNDb21wdXRhdGlvbiUyQ0p1bGlhJTJDTUNNQw==" data-listing-date-sort="1721260800000" data-listing-file-modified-sort="1764770138145" data-listing-date-modified-sort="1728259200000" data-listing-reading-time-sort="22" data-listing-word-count-sort="4355">
<a href="../../../posts/2024/Stat/Logistic2.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/Stat/Logistic2.svg" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
大規模な不均衡データに対するロジスティック回帰（後編）
</h5>
<div class="card-subtitle listing-subtitle">
離散時間 MCMC から連続時間 MCMC へ
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-07-18
</div>
</div>
</div>
</div></a>
</div>
</div>
<div class="listing-no-matching d-none">No matching items</div>
</div>
<!-- ## Subsampling Technology -->
<p>MCMC の計算複雑性のボトルネックは，尤度の評価にある．各ステップで全てのデータを用いて尤度を計算する必要がある点が，MCMC を深層学習などの大規模データの設定への応用を難しくしている <span class="citation" data-cites="Murphy2023">(<a href="#ref-Murphy2023" role="doc-biblioref">Murphy, 2023, p. 647</a>)</span>．</p>
<p>サブサンプリングが可能であることと，複数の効率的なサブサンプリング法の提案により，Zig-Zag 過程は次世代のサンプラーとして圧倒的なスケーラビリティ（Super Efficient Bayesian Inference <span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens et al., 2019</a>)</span>）を示すのではないかと期待されている．<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<section id="対数尤度の勾配を不変推定する" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="対数尤度の勾配を不変推定する"><span class="header-section-number">1</span> 対数尤度の勾配を不変推定する</h2>
<p><span class="math inline">\(p(x)\)</span> を事前分布，<span class="math inline">\(p(y|x)\)</span> を観測のモデル（または尤度）とし，データ <span class="math inline">\(y_1,\cdots,y_n\)</span> は互いに独立であるとする．</p>
<p>このとき，事後分布 <span class="math inline">\(\pi(x):=p(x|y)\)</span> と Hamiltonian <span class="math inline">\(U\)</span> は次のように表せる： <span class="math display">\[
\pi(x)\,\propto\,\left(\prod_{k=1}^n p(y_k|x)\right)p(x)
\]</span> <span class="math display">\[\begin{align*}
   U(x)&amp;=-\sum_{k=1}^n\log p(y_k|x)-\log p(x)\\
   &amp;=\frac{1}{n}\sum_{k=1}^n\biggr(-n\log p(y_k|x)-\log p(x)\biggl)=:\frac{1}{n}\sum_{k=1}^nU^k(x).
\end{align*}\]</span></p>
<p>このとき，<span class="math inline">\(U\)</span> の導関数 <span class="math inline">\(\partial_i U(x)\)</span> は，独立な観測 <span class="math inline">\(y_1,\cdots,y_n\)</span> について項別微分をして平均をとったものに等しい： <span id="eq-decomposition-of-DU"><span class="math display">\[
\partial_iU(x)=\frac{1}{n}\sum_{k=1}^nE^k_i(x),
\tag{1}\]</span></span> <span class="math display">\[
E^k_i(x):=\partial_iU^k(x)=\frac{\partial }{\partial x_i}\biggr(-n\log p(y_k|x)-\log p(x)\biggl).
\]</span></p>
<p>よって，精度は劣るかもしれないが，一様に選んだ <span class="math inline">\(K\sim\mathrm{U}([n])\)</span> から定まる <span class="math inline">\(E^K_i\)</span> の値は <span class="math inline">\(\partial_i U(x)\)</span> の不偏推定量となっている．この発想により，ZZ-SS という新たなアルゴリズムを構成できる．</p>
</section>
<section id="サブサンプリングを取り入れた-zig-zag-サンプラー" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="サブサンプリングを取り入れた-zig-zag-サンプラー"><span class="header-section-number">2</span> サブサンプリングを取り入れた Zig-Zag サンプラー</h2>
<p>この各 <span class="math inline">\(E^K_i\)</span> が定める強度関数 <span class="math display">\[
m^K_i(t):=\biggr(\theta E^K_i(x+\theta t)\biggl)_+=\biggr(\theta\partial_iU^K(x+\theta t)\biggl)_+
\]</span> を用いた Zig-Zag サンプラーを <span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens et al., 2019</a>)</span> では <strong>ZZ-SS</strong> (Zig-Zag with Sub-Sampling) と呼んでいる．</p>
<p><span class="math display">\[
\max_{k\in[n]}m^k_i\le M_i
\]</span> を満たす連続関数 <span class="math inline">\(M_i\)</span> を用いて次のようにシミュレーションすることができる：</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[@Bierkens+2019 p.1303 アルゴリズム３]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span><span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens et al., 2019, p. 1303</a> アルゴリズム３)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>代理強度関数 <span class="math inline">\(M_1,\cdots,M_d\)</span> を持つ互いに独立な <span class="math inline">\(\mathbb{R}_+\)</span> 上の非一様 Poisson 点過程の到着時刻 <span class="math inline">\(T_1,\cdots,T_d\)</span> をシミュレーションする．</li>
<li>最初に到着した座標番号 <span class="math inline">\(j:=\operatorname*{argmin}_{i\in[d]}T_i\)</span> について，確率 <span class="math display">\[
\frac{m^K_j(T_j)}{M_j(T_j)},\qquad K\sim\mathrm{U}([n]),
\]</span> で時刻 <span class="math inline">\(T_j\)</span> に速度成分 <span class="math inline">\(\theta_j\)</span> の符号を反転させる．</li>
<li>１に <span class="math inline">\(t=T_j\)</span> として戻って，繰り返す．</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="部分サンプリングにより不変分布が変わらないことの証明^[[@Vasdekis2021 p.25] や [@Bierkens+2019 p.1302 定理4.1] も参照．]">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>部分サンプリングにより不変分布が変わらないことの証明<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>ZZ-SS によってシミュレートされる過程は，レート関数 <span class="math display">\[
\lambda_i(x,\theta)=\operatorname{E}[(\theta E^K_i(x))_+]=\frac{1}{n}\sum_{k=1}^n(\theta E^k_i(x))_+
\]</span> を持った Zig-Zag 過程に等しい</p>
<p>これは，元々のレート関数に対して， <span class="math display">\[
\gamma_i(x,\theta):=\frac{1}{n}\sum_{k=1}^n(\theta_iE^k_i(x))_+-\left(\theta_i\frac{1}{n}\sum_{k=1}^nE^k_i(x)\right)_+
\]</span> という項を加えて得る Zig-Zag サンプラーともみなすことができる．非負性は関数 <span class="math inline">\((x)_+:=x\lor0\)</span> の凸性から従う．最後に <span class="math inline">\(\gamma_i(x,\theta)=\gamma_i(x,F_i(\theta))\)</span> を確認すれば良い．</p>
<p>これは <span class="math display">\[\begin{align*}
  &amp;\qquad\frac{1}{n}\sum_{k=1}^n\biggr(\theta_iE_i^k(x)\biggl)_+-\frac{1}{n}\sum_{k=1}^n\biggr(-\theta_iE_i^k(x)\biggl)_+\\
  &amp;=\frac{1}{n}\sum_{k=1}^n\left((\theta_iE_i^k(x))_+-(-\theta_iE_i^k(x))_+\right)=\frac{1}{n}\sum_{k=1}^n\theta_iE_i^k(x)
\end{align*}\]</span> であることから従う．</p>
<p>こうして，サブサンプリングの実行による精度の劣化が，<span class="citation" data-cites="Andrieu-Livingstone2021">(<a href="#ref-Andrieu-Livingstone2021" role="doc-biblioref">Andrieu and Livingstone, 2021</a>)</span> の枠組みで捉えられる，ということでもある（レート関数が増加したので，スイッチングイベントが増え，diffusive な動きが増加する）．</p>
</div>
</div>
</div>
<p>例えば <span class="math inline">\(p(y_k|x)\)</span> が Cauchy 密度であるなど <span class="math inline">\(\partial_iU\)</span> が有界であるとき，<span class="math inline">\(M_i:=\max_{x\in\mathbb{R}^d}\partial_iU(x)\)</span> などと選ぶことができる．<span class="math inline">\(M_i\)</span> をより <span class="math inline">\(\partial_iU\)</span> に近く選ぶほど剪定の効率は上がるが，<span class="math inline">\(M_i\)</span> を複雑にしすぎると今度は <span class="math inline">\(M_i\)</span> を強度とする Poisson 点過程のシミュレーションが困難になる．</p>
<p>そのため，ZZ-SS では代理レート関数 <span class="math inline">\(M_i\)</span> は大きく取る必要があり，尤度関数の評価の回数が増える．そのため，アルゴリズムの計算複雑性は上がっていることに注意 <span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens et al., 2019, p. 1302</a> 第４節)</span>．</p>
</section>
<section id="sec-ZZ-CV" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="sec-ZZ-CV"><span class="header-section-number">3</span> 制御変数による分散低減</h2>
<p><span class="math inline">\(\partial_iU(x)\)</span> が Lipschitz 連続であるとき，<span class="math inline">\(E_i^k\)</span> をある参照点 <span class="math inline">\(\partial_iU(x_*)\)</span> とそこからの乖離と取ることで <span class="math inline">\(n\to\infty\)</span> の極限で分散が抑えられる．</p>
<p>こうすることで，<span class="math inline">\(M_i\)</span> を１次関数としたまま，より小さく <span class="math inline">\(E_i^k\)</span> にフィットするように取ることができる．</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>命題
</div>
</div>
<div class="callout-body-container callout-body">
<p>任意の <span class="math inline">\(i\in[d]\)</span> について，ある <span class="math inline">\(C_i&gt;0\)</span> が存在して， <span class="math display">\[
\lvert\partial_iU(x)-\partial_iU(y)\rvert\le C_i\lvert x-y\rvert,\quad(x,y)\in\mathbb{R}^{2d},
\]</span> が成り立つとする．このとき， <span class="math display">\[
M_i(t):=a_i+b_it
\]</span> <span class="math display">\[
a_i:=(\theta_i\partial_iU(x_*))_++C_i\|x-x_*\|_p,\quad b_i:=C_id^{1/p}
\]</span> と定めれば， <span class="math display">\[
m_i^k\le M_i
\]</span> が成り立つ．ただし， <span class="math display">\[
\partial_iU(x)=\frac{1}{n}\sum_{k=1}^nE^k_i(x),\tag{1}
\]</span> <span class="math display">\[
E^k_i(x):=\partial_iU(x_*)+\partial_iU^k(x)-\partial_iU^k(x_*),
\]</span> <span class="math display">\[
m^k_i(t):=\biggr(\theta E_i^k(x+\theta t)\biggl)_+,
\]</span> とした．</p>
</div>
</div>
<p>この仮定は例えば <span class="math inline">\(\partial_iU\)</span> が有界な導関数を持つならば成り立つ．<span class="math inline">\(p(y_k|x)\)</span> が Gauss 密度であるやさらに裾が重いときは成り立つ．</p>
<p>次のようにして参照点 <span class="math inline">\(x_*\)</span> を選ぶ事前処理を行うことで，<strong>データのサイズに依存しない計算複雑性で事後分布からの正確なサンプリングが可能</strong>になる．</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="preprocessing for ZZ-CV">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>preprocessing for ZZ-CV
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><span class="math inline">\(x_*:=\operatorname*{argmin}_{x\in\mathbb{R}^d}U(x)\)</span> を探索する．</li>
<li><span class="math inline">\(\partial_iU(x_*),\partial_iU^k(x_*)\)</span> を計算する．</li>
</ol>
<p>この２つはいずれも <span class="math inline">\(O(n)\)</span> の複雑性で実行できる．</p>
</div>
</div>
</section>
<section id="zz-cv-のスケーリング" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="zz-cv-のスケーリング"><span class="header-section-number">4</span> ZZ-CV のスケーリング</h2>
<p>このとき，<span class="math inline">\(x_*\)</span> を定める事前処理が，<span class="math inline">\(\widehat{x}\)</span> を最尤推定量として， <span class="math display">\[
\|x_*-\widehat{x}\|_p=O(n^{-1/2})\quad(n\to\infty)
\]</span> 程度の正確性があれば，事後分布の最尤推定量周りの漸近展開 <span class="citation" data-cites="Johnson1970">(<a href="#ref-Johnson1970" role="doc-biblioref">Johnson, 1970</a>)</span> を通じて， <span class="math display">\[
\|x-x_*\|_p=O_p(n^{-1/2})\quad(n\to\infty)
\]</span> <span class="math display">\[
\partial_iU(x_*)=O_p(n^{1/2})\quad(n\to\infty)
\]</span> が成り立つ．</p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="Zig-Zag 過程のスケーリング^[[@Bierkens+2019 pp.1306-] 第5.1節参照．]">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Zig-Zag 過程のスケーリング<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>事後分布に対する Zig-Zag 過程は，<span class="math inline">\(\sqrt{n}\)</span> だけ時間を加速したものが <span class="math inline">\(\mathrm{N}_d(0,i(x_0))\)</span> を標的にする Zig-Zag 過程に収束するから，<span class="math inline">\(O(n^{-1/2})\)</span> のタイムステップで区切ってサンプルとすることができる．</p>
<p>しかし <span class="math display">\[
\max_{k\in[n]}\biggr(\theta_i\partial_iU^k(x+\theta t)\biggl)_+\le M_i
\]</span> を満たす <span class="math inline">\(M_i\)</span> は <span class="math inline">\(O(n^{\alpha})\;(\alpha\ge1/2)\)</span> のスケールで増大していく．</p>
<p>各スイッチングイベントにおいて，全データにアクセスする <span class="math inline">\(O(n)\)</span> の計算複雑性が必要であるから，総じて <span class="math inline">\(O(n^{\alpha+1/2})\)</span> の計算複雑性となる．</p>
</div>
</div>
</div>
<p>ZZ-CV が平衡に至っている場合は <span class="math inline">\(x\)</span> はほとんど <span class="math inline">\(x_*\)</span> に集積するため， <span class="math display">\[
\lvert E^k_i(x)\rvert=\biggl|\partial_iU(x_*)+\partial_iU^k(x)-\partial_iU^k(x_*)\biggr|=O(n^{1/2})
\]</span> が成り立つ．よってこれを抑える <span class="math inline">\(M_i\)</span> も <span class="math inline">\(O(n^{1/2})\)</span> で済み，必要以上に大きい代理レート関数を用意して剪定する必要がない．</p>
<p>全データにアクセスする <span class="math inline">\(O(n)\)</span> のステップもないために，事前処理 <a href="#sec-ZZ-CV" class="quarto-xref">3</a> と十分平衡に至っているとみなせるまでの burn-in を除いて，<span class="math inline">\(O(1)\)</span> の計算複雑性でサンプリングが可能である．このことを <span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens et al., 2019</a>)</span> は super-efficiency と呼ぶ．</p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="更なるスケーラブル手法の可能性（事後分布が集中する場合のみ？）">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>更なるスケーラブル手法の可能性（事後分布が集中する場合のみ？）
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>他に，事後分布の集中領域でうまくスイッチング回数が抑えられる <span class="math inline">\(\lambda_i\)</span> が構成できたならば，低い計算複雑性を達成できるだろう．</p>
<p>ZZ-CV では，これに事後分布の Gauss 近似を用いたことになる．</p>
<p>また，<span class="math inline">\(U\)</span> の２階微分が有界でない場合，この枠組みが使えない．実際，<span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens et al., 2019, pp. 1315 第6.5節</a>)</span> ではこの場合での数値実験の結果が示されており，事後分布が集積しないために super-efficiency は得られていない．</p>
<p>参照点 <span class="math inline">\(x_*\)</span> を複数取る拡張なども <span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens et al., 2019, p. 第7節</a>)</span> で考えられている．</p>
</div>
</div>
</div>
</section>
<section id="数値実験mse-の比較" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="数値実験mse-の比較"><span class="header-section-number">5</span> 数値実験：MSE の比較</h2>
<p>ある Gauss 分布に従うデータを生成する： <span class="math display">\[
Y^j\overset{\text{iid}}{\sim}\mathrm{N}(x_0,\sigma^2),\qquad j\in[n],
\]</span> 分散 <span class="math inline">\(\sigma^2\)</span> は既知として，位置母数 <span class="math inline">\(x\in\mathbb{R}\)</span> を推定する問題を考える．</p>
<p>事前分布を <span class="math inline">\(\mathrm{N}(0,\rho^2)\)</span> とすると，定数の違いを除いて <span class="math display">\[\begin{align*}
    U(x)&amp;=\frac{x^2}{2\rho^2}+\frac{1}{2\sigma^2}\sum_{j=1}^n(x-y^j)^2\\
    &amp;=\frac{1}{n}\sum_{j=1}^n\left(\frac{x^2}{2\rho^2}+\frac{n}{2\sigma^2}(x-y^j)^2\right)=:\frac{1}{n}\sum_{j=1}^nU^j(x)
\end{align*}\]</span> であるから， <span class="math display">\[\begin{align*}
    U'(x)&amp;=\frac{x}{\rho^2}+\frac{1}{\sigma^2}\sum_{j=1}^n(x-y^j)\\
    &amp;=\frac{x}{\rho^2}+\frac{n}{\sigma^2}(x-\overline{y}),
\end{align*}\]</span> <span class="math display">\[
U''(x)=\frac{1}{\rho^2}+\frac{n}{\sigma^2}.
\]</span></p>
<p>従って，Zig-Zag 過程のイベントの強度関数は <span class="math display">\[\begin{align*}
    m(t)&amp;=\biggr(\theta U'(x+\theta t)\biggl)_+\\
    &amp;=\left(\frac{\theta(x+\theta t)}{\rho^2}+\frac{\theta}{\sigma^2}\sum_{j=1}^n(x+\theta t-y^j)\right)_+\\
    &amp;=\left(\frac{\theta x}{\rho^2}+\frac{\theta}{\sigma^2}\sum_{j=1}^n(x-y^j)+t\left(\frac{1}{\rho^2}+\frac{n}{\sigma^2}\right)\right)_+
\end{align*}\]</span> と表せ，これは１次関数 <span class="math inline">\((a+bt)_+\)</span> の形であるから直接のシミュレーションが可能である．<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<div id="328d2b9c" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>サブサンプリングなしの Zig-Zag 過程のシミュレーションをする関数 ZZ() を定義</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ZigZagBoomerang</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">λ</span>(∇U, x, θ, F<span class="op">::</span><span class="dt">ZigZag1d</span>) <span class="op">=</span> <span class="fu">pos</span>(<span class="fu">θ*∇U</span>(x)) <span class="co"># rate function on E</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">λ_bar</span>(τ, a, b) <span class="op">=</span> <span class="fu">pos</span>(a <span class="op">+</span> b<span class="op">*</span>τ)  <span class="co"># affine proxy</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="st">`x`: current location, `θ`: current velocity, `t`: current time,</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">move_forward</span>(τ, t, x, θ, <span class="op">::</span><span class="dt">ZigZag1d</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    τ <span class="op">+</span> t, x <span class="op">+</span> θ<span class="op">*</span>τ , θ</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="st">    `∇U`: gradient of the negative log-density</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="st">    `(x,θ)`: initial state</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="st">    `T`: Time Horizon    </span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="st">    `a+bt`: computational bound for intensity m(t)</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="st">    `num`: ポアソン時刻に到着した回数</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="st">    `acc`: 受容回数．`acc/num` は acceptance rate</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">ZZ</span>(∇U, x<span class="op">::</span><span class="dt">Float64</span>, θ<span class="op">::</span><span class="dt">Float64</span>, T<span class="op">::</span><span class="dt">Float64</span>, y, Flow<span class="op">::</span><span class="dt">ZigZagBoomerang.ContinuousDynamics</span>; rng<span class="op">=</span><span class="bu">Random</span>.GLOBAL_RNG, ab<span class="op">=</span>ab_ZZ)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> <span class="fu">zero</span>(T)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    Ξ <span class="op">=</span> [(t, x, θ)]</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    num <span class="op">=</span> acc <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    epoch_list <span class="op">=</span> [num]</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    a, b <span class="op">=</span> <span class="fu">ab</span>(x, θ, Flow)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    t′ <span class="op">=</span>  t <span class="op">+</span> <span class="fu">poisson_time</span>(a, b, <span class="fu">rand</span>())  <span class="co"># イベントは a,b が定める affine proxy に従って生成する</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> t <span class="op">&lt;</span> T</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        τ <span class="op">=</span> t′ <span class="op">-</span> t</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>        t, x, θ <span class="op">=</span> <span class="fu">move_forward</span>(τ, t, x, θ, Flow)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>        l, lb <span class="op">=</span> <span class="fu">λ</span>(∇U, x, θ, Flow), <span class="fu">λ_bar</span>(τ, a, b)  <span class="co"># λ が真のレート, λ_bar が affine proxy</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        num <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="fu">rand</span>()<span class="op">*</span>lb <span class="op">&lt;</span> l</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>            acc <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> l <span class="op">&gt;</span> lb <span class="op">+</span> <span class="fl">0.01</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>                <span class="fu">println</span>(l<span class="op">-</span>lb)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>            θ <span class="op">=</span> <span class="op">-</span>θ</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(Ξ, (t, x, θ))</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(epoch_list, num)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>        a, b <span class="op">=</span> <span class="fu">ab</span>(x, θ, Flow)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>        t′ <span class="op">=</span> t <span class="op">+</span> <span class="fu">poisson_time</span>(a, b, <span class="fu">rand</span>())</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Ξ, epoch_list, acc<span class="op">/</span>num</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="79b869ed" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>今回の設定に応じたレート関数 (a+bt)+ を用意</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pos</span>(x) <span class="op">=</span> <span class="fu">max</span>(<span class="fu">zero</span>(x), x)  <span class="co"># positive part</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">a</span>(x, θ, ρ, σ, y) <span class="op">=</span> θ <span class="op">*</span> x <span class="op">/</span> ρ<span class="op">^</span><span class="fl">2</span> <span class="op">+</span> (θ<span class="op">/</span>σ<span class="op">^</span><span class="fl">2</span>) <span class="op">*</span> <span class="fu">sum</span>(x <span class="op">.-</span> y)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">b</span>(x, θ, ρ, σ, y) <span class="op">=</span> ρ<span class="op">^</span>(<span class="op">-</span><span class="fl">2</span>) <span class="op">+</span> <span class="fu">length</span>(y)<span class="op">/</span>σ<span class="op">^</span><span class="fl">2</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>ρ, σ, x0, θ<span class="fl">0</span> <span class="op">=</span> <span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>n1, n2 <span class="op">=</span> <span class="fl">100</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">4</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>TrueDistribution <span class="op">=</span> <span class="fu">Normal</span>(x0, σ)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> <span class="fu">rand</span>(TrueDistribution, n1)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> <span class="fu">rand</span>(TrueDistribution, n2)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># computational bounds for intensity m(t)</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ab_ZZ_n1</span>(x, θ, <span class="op">::</span><span class="dt">ZigZag1d</span>) <span class="op">=</span> (<span class="fu">a</span>(x, θ, ρ, σ, y1), <span class="fu">b</span>(x, θ, ρ, σ, y1))</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ab_ZZ_n2</span>(x, θ, <span class="op">::</span><span class="dt">ZigZag1d</span>) <span class="op">=</span> (<span class="fu">a</span>(x, θ, ρ, σ, y2), <span class="fu">b</span>(x, θ, ρ, σ, y2))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">∇U1</span>(x) <span class="op">=</span> x<span class="op">/</span>ρ<span class="op">^</span><span class="fl">2</span> <span class="op">+</span> (<span class="fu">length</span>(y1)<span class="op">/</span>σ<span class="op">^</span><span class="fl">2</span>) <span class="op">*</span> (x <span class="op">-</span> <span class="fu">mean</span>(y1)) </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="fu">∇U2</span>(x) <span class="op">=</span> x<span class="op">/</span>ρ<span class="op">^</span><span class="fl">2</span> <span class="op">+</span> (<span class="fu">length</span>(y2)<span class="op">/</span>σ<span class="op">^</span><span class="fl">2</span>) <span class="op">*</span> (x <span class="op">-</span> <span class="fu">mean</span>(y2)) </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># T = 2500.0</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># trace_ZZ1, epochs_ZZ1, acc_ZZ1 = ZZ(∇U1, x0, θ0, T, ZigZag1d(); ab=ab_ZZ_n1)</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># trace_ZZ2, num_ZZ2, acc_ZZ2 = ZZ(∇U2, x0, θ0, T, ZigZag1d(); ab=ab_ZZ_n2)</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co"># dt = 0.01</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># traj_ZZ1 = discretize(trace_ZZ1, ZigZag1d(), dt)</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co"># traj_ZZ2 = discretize(trace_ZZ2, ZigZag1d(), dt)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="18616940" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>N 回 ZZ() を実行して，その事後平均の MSE を計算する関数 experiment() を定義</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">SquaredError</span>(sample<span class="op">::</span><span class="dt">Vector{Float64}</span>, y)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    True_Posterior_Mean <span class="op">=</span> <span class="fu">sum</span>(y) <span class="op">/</span> (<span class="fu">length</span>(y) <span class="op">+</span> <span class="fl">1</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="fu">mean</span>(sample) <span class="op">-</span> True_Posterior_Mean)<span class="op">^</span><span class="fl">2</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="st">    epoch_list: 注目するエポック数のリスト</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="st">    N: 実験回数</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">experiment</span>(epoch_list, T, dt, N, ∇U, x0, θ<span class="fl">0</span>, y, Sampler; ab<span class="op">=</span>ab_ZZ_n1)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    SE_sum <span class="op">=</span> <span class="fu">zero</span>(epoch_list)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    acc_list <span class="op">=</span> []</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>N</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        trace_ZZ1, epochs_ZZ1, acc_ZZ1 <span class="op">=</span> <span class="fu">Sampler</span>(∇U, x0, θ<span class="fl">0</span>, T, y, <span class="fu">ZigZag1d</span>(); ab<span class="op">=</span>ab)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">push!</span>(acc_list, acc_ZZ1)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        traj_ZZ1 <span class="op">=</span> <span class="fu">discretize</span>(trace_ZZ1, <span class="fu">ZigZag1d</span>(), dt)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        SE_list <span class="op">=</span> []</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> T <span class="kw">in</span> epoch_list</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>            epoch <span class="op">=</span> <span class="fu">findfirst</span>(x <span class="op">-&gt;</span> x <span class="op">&gt;</span> T, epochs_ZZ1) <span class="op">-</span> <span class="fl">1</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>            t <span class="op">=</span> <span class="fu">findfirst</span>(x <span class="op">-&gt;</span> x <span class="op">&gt;</span> trace_ZZ1[epoch][<span class="fl">1</span>], traj_ZZ1.t) <span class="op">-</span> <span class="fl">1</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>            SE <span class="op">=</span> <span class="fu">SquaredError</span>(traj_ZZ1.x[<span class="fl">1</span><span class="op">:</span>t], y)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(SE_list, SE)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>        SE_sum <span class="op">+=</span> SE_list</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> SE_sum <span class="op">./</span> N, <span class="fu">mean</span>(acc_list)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="6a62b4cb" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>実験の実行</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="fl">3000.0</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>epoch_list <span class="op">=</span> [<span class="fl">10.0</span>, <span class="fl">100.0</span>, <span class="fl">1000.0</span>, <span class="fl">10000.0</span>]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">11</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>MSE_ZZ1, acc <span class="op">=</span> <span class="fu">experiment</span>(epoch_list, T, dt, N, ∇U1, x0, θ<span class="fl">0</span>, y1, ZZ; ab<span class="op">=</span>ab_ZZ_n1)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fu">plot</span>(<span class="co">#epoch_list, MSE_ZZ1,</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    xscale<span class="op">=:</span>log10,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    yscale<span class="op">=:</span>log10,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"epochs"</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="st">"MSE"</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ,background_color = "#F0F1EB"</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter!</span>(p, epoch_list, MSE_ZZ1,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    marker<span class="op">=:</span>circle,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    markersize<span class="op">=</span><span class="fl">5</span>,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    markeralpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#78C2AD"</span>,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="cn">nothing</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">GLM</span>, <span class="bu">DataFrames</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="fu">DataFrame</span>(X <span class="op">=</span> <span class="fu">log10</span>.(epoch_list), Y <span class="op">=</span> <span class="fu">log10</span>.(MSE_ZZ1))</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">lm</span>(<span class="pp">@formula</span>(Y <span class="op">~</span> X), df)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>X_pred <span class="op">=</span> <span class="fu">range</span>(<span class="fu">minimum</span>(df.X), <span class="fu">maximum</span>(df.X), length<span class="op">=</span><span class="fl">100</span>)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>Y_pred <span class="op">=</span> <span class="fu">predict</span>(model, <span class="fu">DataFrame</span>(X <span class="op">=</span> X_pred))</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(p, <span class="fl">10</span> <span class="op">.^</span> X_pred, <span class="fl">10</span> <span class="op">.^</span> Y_pred,</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=:</span>solid,</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    linewidth<span class="op">=</span><span class="fl">2</span>,</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#78C2AD"</span>,</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">"ZZ"</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="co"># display(p)</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Average acceptance rate: </span><span class="sc">$</span>acc<span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Average acceptance rate: 1.0</code></pre>
</div>
</div>
<p>より，たしかに剪定なしの正確なシミュレーションができている．</p>
<p>一方で， <span class="math display">\[
U^j(x):=\frac{x^2}{2\rho^2}+\frac{n}{2\sigma^2}(x-y^j)^2,
\]</span> <span class="math display">\[
\lambda^j(x,\theta):=\biggr(\theta(U^j)'(x)\biggl)_+
\]</span> としてサブサンプリングを取り入れることを考えるが，これを同じ <span class="math inline">\((a+bt)_+\)</span> ではバウンド出来ない：</p>
<div id="3e195dc3" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>ZZ-SS (ZigZag with Subsampling) の定義</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">λj</span>(j,x,θ,y) <span class="op">=</span> <span class="fu">pos</span>(θ <span class="op">*</span> (x<span class="op">/</span>ρ<span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fu">length</span>(y)<span class="op">/</span>σ<span class="op">^</span><span class="fl">2</span> <span class="op">*</span> (x <span class="op">-</span> y[j])))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">ZZ_SS</span>(∇U, x<span class="op">::</span><span class="dt">Float64</span>, θ<span class="op">::</span><span class="dt">Float64</span>, T<span class="op">::</span><span class="dt">Float64</span>, y, Flow<span class="op">::</span><span class="dt">ZigZagBoomerang.ContinuousDynamics</span>; rng<span class="op">=</span><span class="bu">Random</span>.GLOBAL_RNG, ab<span class="op">=</span>ab_ZZ)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> <span class="fu">zero</span>(T)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    Ξ <span class="op">=</span> [(t, x, θ)]</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    num <span class="op">=</span> acc <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    epoch_list <span class="op">=</span> [num]</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    a, b <span class="op">=</span> <span class="fu">ab</span>(x, θ, Flow)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    t′ <span class="op">=</span>  t <span class="op">+</span> <span class="fu">poisson_time</span>(a, b, <span class="fu">rand</span>())  <span class="co"># イベントは a,b が定める affine proxy に従って生成する</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> t <span class="op">&lt;</span> T</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        τ <span class="op">=</span> t′ <span class="op">-</span> t</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        t, x, θ <span class="op">=</span> <span class="fu">move_forward</span>(τ, t, x, θ, Flow)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>        j <span class="op">=</span> <span class="fu">rand</span>(<span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(y))</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        l, lb <span class="op">=</span> <span class="fu">λj</span>(j, x, θ, y), <span class="fu">λ_bar</span>(τ, a, b)  <span class="co"># λ が真のレート, λ_bar が affine proxy</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        num <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="fu">rand</span>()<span class="op">*</span>lb <span class="op">&lt;</span> l</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> l <span class="op">&gt;</span> lb <span class="op">+</span> <span class="fl">0.01</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>                <span class="co"># println(l-lb)</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>                acc <span class="op">+=</span> <span class="fl">1</span>  <span class="co">#  overflow を数えるように変更済み！注意！</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>            θ <span class="op">=</span> <span class="op">-</span>θ</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(Ξ, (t, x, θ))</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(epoch_list, num)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>        a, b <span class="op">=</span> <span class="fu">ab</span>(x, θ, Flow)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>        t′ <span class="op">=</span> t <span class="op">+</span> <span class="fu">poisson_time</span>(a, b, <span class="fu">rand</span>())</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Ξ, epoch_list, acc<span class="op">/</span>num</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="1bed25e6" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>実験の実行</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LaTeXStrings</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>MSE_ZZ_SS, acc <span class="op">=</span> <span class="fu">experiment</span>(epoch_list, T, dt, N, ∇U1, x0, θ<span class="fl">0</span>, y1, ZZ_SS; ab<span class="op">=</span>ab_ZZ_n1)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(L<span class="st">"上界 </span><span class="sc">$</span>(a<span class="op">+</span>bt)<span class="st">_+$ を超えてしまう平均的割合: "</span>, <span class="st">"</span><span class="sc">$</span>acc<span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>上界 $(a+bt)_+$ を超えてしまう平均的割合: 0.49500662479838825</code></pre>
</div>
</div>
<p>しかし，ZZ-CV アルゴリズムではこのようなことは起こらない．実際，次の等式が成り立つ： <span class="math display">\[
U'(x_*)+(U^j)'(x)-(U^j)'(x_*)=U'(x),\qquad x,x_*\in\mathbb{R}.
\]</span></p>
<p>このモデルにおける MAP 推定量は <span class="math display">\[
\widehat{x}:=\frac{\overline{y}}{1+\frac{\sigma^2}{n\rho^2}}
\]</span> である．</p>
<div id="83920508" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>ZZ-CV (ZigZag with Control Variates) の定義</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x_star <span class="op">=</span> <span class="fu">mean</span>(y1) <span class="op">/</span> (<span class="fl">1</span> <span class="op">+</span> σ<span class="op">^</span><span class="fl">2</span><span class="op">/</span>(<span class="fu">length</span>(y1) <span class="op">*</span> ρ<span class="op">^</span><span class="fl">2</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">C</span>(ρ, σ, y) <span class="op">=</span> ρ<span class="op">^</span>(<span class="op">-</span><span class="fl">2</span>) <span class="op">+</span> <span class="fu">length</span>(y)<span class="op">/</span>σ<span class="op">^</span><span class="fl">2</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">a</span>(x, θ, ρ, σ, y) <span class="op">=</span> <span class="fu">pos</span>(<span class="fu">θ*∇U1</span>(x_star)) <span class="op">+</span> <span class="fu">C</span>(ρ, σ, y) <span class="op">*</span> <span class="fu">abs</span>(x <span class="op">-</span> x_star)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">b</span>(x, θ, ρ, σ, y) <span class="op">=</span> <span class="fu">C</span>(ρ, σ, y)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># New Computational Bounds for ZZ-CV</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ab_ZZ_CV</span>(x, θ, <span class="op">::</span><span class="dt">ZigZag1d</span>) <span class="op">=</span> (<span class="fu">a</span>(x, θ, ρ, σ, y1), <span class="fu">b</span>(x, θ, ρ, σ, y1))</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">ZZ_CV</span>(∇U, x<span class="op">::</span><span class="dt">Float64</span>, θ<span class="op">::</span><span class="dt">Float64</span>, T<span class="op">::</span><span class="dt">Float64</span>, y, Flow<span class="op">::</span><span class="dt">ZigZagBoomerang.ContinuousDynamics</span>; rng<span class="op">=</span><span class="bu">Random</span>.GLOBAL_RNG, ab<span class="op">=</span>ab_ZZ_CV)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> <span class="fu">zero</span>(T)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    Ξ <span class="op">=</span> [(t, x, θ)]</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    num <span class="op">=</span> acc <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    epoch_list <span class="op">=</span> [num]</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    a, b <span class="op">=</span> <span class="fu">ab</span>(x, θ, Flow)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    t′ <span class="op">=</span>  t <span class="op">+</span> <span class="fu">poisson_time</span>(a, b, <span class="fu">rand</span>())  <span class="co"># イベントは a,b が定める affine proxy に従って生成する</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> t <span class="op">&lt;</span> T</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>        τ <span class="op">=</span> t′ <span class="op">-</span> t</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>        t, x, θ <span class="op">=</span> <span class="fu">move_forward</span>(τ, t, x, θ, Flow)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># j = rand(1:length(y))  # 今回はたまたま要らない</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>        l, lb <span class="op">=</span><span class="fu">λ</span>(∇U, x, θ, Flow), <span class="fu">λ_bar</span>(τ, a, b)  <span class="co"># λ が真のレート, λ_bar が affine proxy</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>        num <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="fu">rand</span>()<span class="op">*</span>lb <span class="op">&lt;</span> l</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>            acc <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> l <span class="op">&gt;</span> lb <span class="op">+</span> <span class="fl">0.01</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>                <span class="fu">println</span>(l<span class="op">-</span>lb)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>            θ <span class="op">=</span> <span class="op">-</span>θ</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(Ξ, (t, x, θ))</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(epoch_list, num)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>        a, b <span class="op">=</span> <span class="fu">ab</span>(x, θ, Flow)</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>        t′ <span class="op">=</span> t <span class="op">+</span> <span class="fu">poisson_time</span>(a, b, <span class="fu">rand</span>())</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Ξ, epoch_list, acc<span class="op">/</span>num</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="4bd9fdcc" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>実験の実行</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>MSE_ZZ_CV, acc <span class="op">=</span> <span class="fu">experiment</span>(epoch_list, T, dt, N, ∇U1, x0, θ<span class="fl">0</span>, y1, ZZ_CV; ab<span class="op">=</span>ab_ZZ_CV)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> <span class="fu">scatter</span>(p, epoch_list, MSE_ZZ_CV,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    marker<span class="op">=:</span>circle,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    markersize<span class="op">=</span><span class="fl">5</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    markeralpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#E95420"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="cn">nothing</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="fu">DataFrame</span>(X <span class="op">=</span> <span class="fu">log10</span>.(epoch_list), Y <span class="op">=</span> <span class="fu">log10</span>.(MSE_ZZ_CV))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">lm</span>(<span class="pp">@formula</span>(Y <span class="op">~</span> X), df)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>X_pred <span class="op">=</span> <span class="fu">range</span>(<span class="fu">minimum</span>(df.X), <span class="fu">maximum</span>(df.X), length<span class="op">=</span><span class="fl">100</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>Y_pred <span class="op">=</span> <span class="fu">predict</span>(model, <span class="fu">DataFrame</span>(X <span class="op">=</span> X_pred))</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(q, <span class="fl">10</span> <span class="op">.^</span> X_pred, <span class="fl">10</span> <span class="op">.^</span> Y_pred,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=:</span>dash,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    linewidth<span class="op">=</span><span class="fl">2</span>,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#E95420"</span>,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">"ZZ-CV (without amendment)"</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(q)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="576" height="384" viewbox="0 0 2304 1536">
<defs>
  <clippath id="clip140">
    <rect x="0" y="0" width="2304" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip140)" d="M0 1536 L2304 1536 L2304 8.52651e-14 L0 8.52651e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip141">
    <rect x="460" y="0" width="1614" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip140)" d="M251.804 1347.54 L2256.76 1347.54 L2256.76 47.2441 L251.804 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip142">
    <rect x="251" y="47" width="2006" height="1301"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="939.036,1347.54 939.036,47.2441 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2200.01,1347.54 2200.01,47.2441 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,1347.54 2256.76,1347.54 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="939.036,1347.54 939.036,1328.64 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2200.01,1347.54 2200.01,1328.64 "></polyline>
<path clip-path="url(#clip140)" d="M904.809 1420.89 L912.448 1420.89 L912.448 1394.53 L904.137 1396.19 L904.137 1391.94 L912.401 1390.27 L917.077 1390.27 L917.077 1420.89 L924.716 1420.89 L924.716 1424.83 L904.809 1424.83 L904.809 1420.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M944.16 1393.35 Q940.549 1393.35 938.721 1396.91 Q936.915 1400.45 936.915 1407.58 Q936.915 1414.69 938.721 1418.25 Q940.549 1421.8 944.16 1421.8 Q947.795 1421.8 949.6 1418.25 Q951.429 1414.69 951.429 1407.58 Q951.429 1400.45 949.6 1396.91 Q947.795 1393.35 944.16 1393.35 M944.16 1389.64 Q949.97 1389.64 953.026 1394.25 Q956.105 1398.83 956.105 1407.58 Q956.105 1416.31 953.026 1420.92 Q949.97 1425.5 944.16 1425.5 Q938.35 1425.5 935.271 1420.92 Q932.216 1416.31 932.216 1407.58 Q932.216 1398.83 935.271 1394.25 Q938.35 1389.64 944.16 1389.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M960.675 1394.22 L973.934 1394.22 L973.934 1397.42 L956.105 1397.42 L956.105 1394.22 Q958.268 1391.98 961.992 1388.22 Q965.734 1384.44 966.693 1383.35 Q968.518 1381.3 969.233 1379.89 Q969.966 1378.46 969.966 1377.09 Q969.966 1374.85 968.386 1373.44 Q966.825 1372.03 964.305 1372.03 Q962.518 1372.03 960.525 1372.65 Q958.55 1373.27 956.293 1374.53 L956.293 1370.69 Q958.587 1369.77 960.581 1369.3 Q962.575 1368.83 964.23 1368.83 Q968.593 1368.83 971.189 1371.01 Q973.784 1373.19 973.784 1376.84 Q973.784 1378.57 973.126 1380.13 Q972.486 1381.68 970.775 1383.78 Q970.305 1384.33 967.784 1386.94 Q965.264 1389.54 960.675 1394.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2164.47 1420.89 L2172.11 1420.89 L2172.11 1394.53 L2163.8 1396.19 L2163.8 1391.94 L2172.06 1390.27 L2176.74 1390.27 L2176.74 1420.89 L2184.38 1420.89 L2184.38 1424.83 L2164.47 1424.83 L2164.47 1420.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2203.82 1393.35 Q2200.21 1393.35 2198.38 1396.91 Q2196.57 1400.45 2196.57 1407.58 Q2196.57 1414.69 2198.38 1418.25 Q2200.21 1421.8 2203.82 1421.8 Q2207.45 1421.8 2209.26 1418.25 Q2211.09 1414.69 2211.09 1407.58 Q2211.09 1400.45 2209.26 1396.91 Q2207.45 1393.35 2203.82 1393.35 M2203.82 1389.64 Q2209.63 1389.64 2212.69 1394.25 Q2215.76 1398.83 2215.76 1407.58 Q2215.76 1416.31 2212.69 1420.92 Q2209.63 1425.5 2203.82 1425.5 Q2198.01 1425.5 2194.93 1420.92 Q2191.88 1416.31 2191.88 1407.58 Q2191.88 1398.83 2194.93 1394.25 Q2198.01 1389.64 2203.82 1389.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2228.44 1372.65 L2218.85 1387.64 L2228.44 1387.64 L2228.44 1372.65 M2227.44 1369.34 L2232.22 1369.34 L2232.22 1387.64 L2236.23 1387.64 L2236.23 1390.8 L2232.22 1390.8 L2232.22 1397.42 L2228.44 1397.42 L2228.44 1390.8 L2215.76 1390.8 L2215.76 1387.13 L2227.44 1369.34 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1174.47 1490.1 L1174.47 1492.96 L1147.54 1492.96 Q1147.92 1499.01 1151.17 1502.19 Q1154.45 1505.34 1160.27 1505.34 Q1163.65 1505.34 1166.8 1504.52 Q1169.98 1503.69 1173.1 1502.03 L1173.1 1507.57 Q1169.95 1508.91 1166.64 1509.61 Q1163.33 1510.31 1159.92 1510.31 Q1151.39 1510.31 1146.4 1505.34 Q1141.43 1500.38 1141.43 1491.91 Q1141.43 1483.16 1146.14 1478.03 Q1150.88 1472.88 1158.91 1472.88 Q1166.1 1472.88 1170.27 1477.53 Q1174.47 1482.14 1174.47 1490.1 M1168.61 1488.38 Q1168.55 1483.57 1165.91 1480.71 Q1163.3 1477.84 1158.97 1477.84 Q1154.07 1477.84 1151.11 1480.61 Q1148.18 1483.38 1147.73 1488.41 L1168.61 1488.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1189.75 1504.04 L1189.75 1522.94 L1183.86 1522.94 L1183.86 1473.74 L1189.75 1473.74 L1189.75 1479.15 Q1191.59 1475.97 1194.39 1474.44 Q1197.23 1472.88 1201.14 1472.88 Q1207.64 1472.88 1211.68 1478.03 Q1215.75 1483.19 1215.75 1491.59 Q1215.75 1500 1211.68 1505.15 Q1207.64 1510.31 1201.14 1510.31 Q1197.23 1510.31 1194.39 1508.78 Q1191.59 1507.22 1189.75 1504.04 M1209.67 1491.59 Q1209.67 1485.13 1207 1481.47 Q1204.36 1477.78 1199.71 1477.78 Q1195.06 1477.78 1192.39 1481.47 Q1189.75 1485.13 1189.75 1491.59 Q1189.75 1498.05 1192.39 1501.75 Q1195.06 1505.41 1199.71 1505.41 Q1204.36 1505.41 1207 1501.75 Q1209.67 1498.05 1209.67 1491.59 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1239.27 1477.84 Q1234.56 1477.84 1231.82 1481.54 Q1229.09 1485.2 1229.09 1491.59 Q1229.09 1497.99 1231.79 1501.68 Q1234.53 1505.34 1239.27 1505.34 Q1243.95 1505.34 1246.69 1501.65 Q1249.43 1497.96 1249.43 1491.59 Q1249.43 1485.26 1246.69 1481.57 Q1243.95 1477.84 1239.27 1477.84 M1239.27 1472.88 Q1246.91 1472.88 1251.27 1477.84 Q1255.63 1482.81 1255.63 1491.59 Q1255.63 1500.35 1251.27 1505.34 Q1246.91 1510.31 1239.27 1510.31 Q1231.6 1510.31 1227.24 1505.34 Q1222.91 1500.35 1222.91 1491.59 Q1222.91 1482.81 1227.24 1477.84 Q1231.6 1472.88 1239.27 1472.88 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1290.99 1475.11 L1290.99 1480.58 Q1288.51 1479.21 1286 1478.54 Q1283.51 1477.84 1280.97 1477.84 Q1275.27 1477.84 1272.12 1481.47 Q1268.97 1485.07 1268.97 1491.59 Q1268.97 1498.12 1272.12 1501.75 Q1275.27 1505.34 1280.97 1505.34 Q1283.51 1505.34 1286 1504.67 Q1288.51 1503.97 1290.99 1502.61 L1290.99 1508.02 Q1288.54 1509.16 1285.9 1509.74 Q1283.29 1510.31 1280.33 1510.31 Q1272.28 1510.31 1267.54 1505.25 Q1262.79 1500.19 1262.79 1491.59 Q1262.79 1482.87 1267.57 1477.88 Q1272.37 1472.88 1280.71 1472.88 Q1283.42 1472.88 1286 1473.45 Q1288.58 1473.99 1290.99 1475.11 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1330.81 1487.87 L1330.81 1509.39 L1324.96 1509.39 L1324.96 1488.06 Q1324.96 1483 1322.98 1480.49 Q1321.01 1477.97 1317.06 1477.97 Q1312.32 1477.97 1309.58 1480.99 Q1306.84 1484.02 1306.84 1489.24 L1306.84 1509.39 L1300.96 1509.39 L1300.96 1459.86 L1306.84 1459.86 L1306.84 1479.28 Q1308.95 1476.06 1311.78 1474.47 Q1314.64 1472.88 1318.37 1472.88 Q1324.51 1472.88 1327.66 1476.7 Q1330.81 1480.49 1330.81 1487.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1365.22 1474.79 L1365.22 1480.33 Q1362.74 1479.05 1360.06 1478.42 Q1357.39 1477.78 1354.52 1477.78 Q1350.16 1477.78 1347.97 1479.12 Q1345.8 1480.45 1345.8 1483.13 Q1345.8 1485.16 1347.36 1486.34 Q1348.92 1487.49 1353.63 1488.54 L1355.64 1488.98 Q1361.88 1490.32 1364.49 1492.77 Q1367.13 1495.19 1367.13 1499.55 Q1367.13 1504.52 1363.18 1507.41 Q1359.27 1510.31 1352.39 1510.31 Q1349.53 1510.31 1346.41 1509.74 Q1343.32 1509.19 1339.88 1508.08 L1339.88 1502.03 Q1343.13 1503.72 1346.28 1504.58 Q1349.43 1505.41 1352.52 1505.41 Q1356.66 1505.41 1358.88 1504.01 Q1361.11 1502.57 1361.11 1500 Q1361.11 1497.61 1359.49 1496.34 Q1357.9 1495.06 1352.46 1493.88 L1350.42 1493.41 Q1344.98 1492.26 1342.56 1489.91 Q1340.14 1487.52 1340.14 1483.38 Q1340.14 1478.35 1343.7 1475.62 Q1347.27 1472.88 1353.82 1472.88 Q1357.07 1472.88 1359.93 1473.36 Q1362.8 1473.83 1365.22 1474.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="251.804,1247.77 2256.76,1247.77 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="251.804,886.874 2256.76,886.874 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="251.804,525.979 2256.76,525.979 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="251.804,165.084 2256.76,165.084 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,1347.54 251.804,47.2441 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,1247.77 270.702,1247.77 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,886.874 270.702,886.874 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,525.979 270.702,525.979 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,165.084 270.702,165.084 "></polyline>
<path clip-path="url(#clip140)" d="M115.675 1267.56 L123.314 1267.56 L123.314 1241.2 L115.003 1242.86 L115.003 1238.6 L123.267 1236.94 L127.943 1236.94 L127.943 1267.56 L135.582 1267.56 L135.582 1271.5 L115.675 1271.5 L115.675 1267.56 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M155.026 1240.02 Q151.415 1240.02 149.587 1243.58 Q147.781 1247.12 147.781 1254.25 Q147.781 1261.36 149.587 1264.92 Q151.415 1268.46 155.026 1268.46 Q158.661 1268.46 160.466 1264.92 Q162.295 1261.36 162.295 1254.25 Q162.295 1247.12 160.466 1243.58 Q158.661 1240.02 155.026 1240.02 M155.026 1236.31 Q160.837 1236.31 163.892 1240.92 Q166.971 1245.5 166.971 1254.25 Q166.971 1262.98 163.892 1267.58 Q160.837 1272.17 155.026 1272.17 Q149.216 1272.17 146.138 1267.58 Q143.082 1262.98 143.082 1254.25 Q143.082 1245.5 146.138 1240.92 Q149.216 1236.31 155.026 1236.31 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M166.971 1230.41 L191.082 1230.41 L191.082 1233.61 L166.971 1233.61 L166.971 1230.41 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M207.878 1228.53 Q205.32 1228.53 203.815 1230.28 Q202.329 1232.03 202.329 1235.08 Q202.329 1238.11 203.815 1239.87 Q205.32 1241.62 207.878 1241.62 Q210.436 1241.62 211.921 1239.87 Q213.426 1238.11 213.426 1235.08 Q213.426 1232.03 211.921 1230.28 Q210.436 1228.53 207.878 1228.53 M215.42 1216.63 L215.42 1220.09 Q213.99 1219.41 212.523 1219.05 Q211.075 1218.7 209.646 1218.7 Q205.884 1218.7 203.89 1221.23 Q201.916 1223.77 201.633 1228.91 Q202.743 1227.27 204.417 1226.41 Q206.091 1225.52 208.103 1225.52 Q212.335 1225.52 214.78 1228.1 Q217.244 1230.66 217.244 1235.08 Q217.244 1239.4 214.686 1242.02 Q212.128 1244.63 207.878 1244.63 Q203.006 1244.63 200.43 1240.91 Q197.853 1237.16 197.853 1230.07 Q197.853 1223.42 201.013 1219.47 Q204.173 1215.5 209.495 1215.5 Q210.925 1215.5 212.373 1215.78 Q213.84 1216.06 215.42 1216.63 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M116.615 906.666 L124.254 906.666 L124.254 880.301 L115.944 881.967 L115.944 877.708 L124.208 876.041 L128.884 876.041 L128.884 906.666 L136.522 906.666 L136.522 910.601 L116.615 910.601 L116.615 906.666 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M155.967 879.12 Q152.356 879.12 150.527 882.685 Q148.721 886.227 148.721 893.356 Q148.721 900.463 150.527 904.027 Q152.356 907.569 155.967 907.569 Q159.601 907.569 161.407 904.027 Q163.235 900.463 163.235 893.356 Q163.235 886.227 161.407 882.685 Q159.601 879.12 155.967 879.12 M155.967 875.416 Q161.777 875.416 164.832 880.023 Q167.911 884.606 167.911 893.356 Q167.911 902.083 164.832 906.689 Q161.777 911.273 155.967 911.273 Q150.157 911.273 147.078 906.689 Q144.022 902.083 144.022 893.356 Q144.022 884.606 147.078 880.023 Q150.157 875.416 155.967 875.416 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M167.911 869.518 L192.023 869.518 L192.023 872.715 L167.911 872.715 L167.911 869.518 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M200.261 855.111 L215.175 855.111 L215.175 858.308 L203.74 858.308 L203.74 865.192 Q204.568 864.91 205.395 864.778 Q206.223 864.628 207.05 864.628 Q211.752 864.628 214.498 867.204 Q217.244 869.781 217.244 874.182 Q217.244 878.715 214.423 881.235 Q211.602 883.737 206.467 883.737 Q204.699 883.737 202.856 883.436 Q201.032 883.135 199.076 882.533 L199.076 878.715 Q200.768 879.636 202.574 880.088 Q204.379 880.539 206.392 880.539 Q209.646 880.539 211.545 878.828 Q213.445 877.116 213.445 874.182 Q213.445 871.248 211.545 869.537 Q209.646 867.825 206.392 867.825 Q204.868 867.825 203.345 868.164 Q201.84 868.502 200.261 869.217 L200.261 855.111 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M115.411 545.771 L123.05 545.771 L123.05 519.406 L114.74 521.072 L114.74 516.813 L123.004 515.146 L127.68 515.146 L127.68 545.771 L135.319 545.771 L135.319 549.706 L115.411 549.706 L115.411 545.771 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M154.763 518.225 Q151.152 518.225 149.323 521.79 Q147.518 525.332 147.518 532.461 Q147.518 539.568 149.323 543.132 Q151.152 546.674 154.763 546.674 Q158.397 546.674 160.203 543.132 Q162.032 539.568 162.032 532.461 Q162.032 525.332 160.203 521.79 Q158.397 518.225 154.763 518.225 M154.763 514.521 Q160.573 514.521 163.629 519.128 Q166.707 523.711 166.707 532.461 Q166.707 541.188 163.629 545.794 Q160.573 550.378 154.763 550.378 Q148.953 550.378 145.874 545.794 Q142.819 541.188 142.819 532.461 Q142.819 523.711 145.874 519.128 Q148.953 514.521 154.763 514.521 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M166.707 508.623 L190.819 508.623 L190.819 511.82 L166.707 511.82 L166.707 508.623 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M209.458 497.526 L199.866 512.516 L209.458 512.516 L209.458 497.526 M208.461 494.216 L213.238 494.216 L213.238 512.516 L217.244 512.516 L217.244 515.676 L213.238 515.676 L213.238 522.296 L209.458 522.296 L209.458 515.676 L196.781 515.676 L196.781 512.008 L208.461 494.216 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M116.333 184.876 L123.972 184.876 L123.972 158.51 L115.662 160.177 L115.662 155.918 L123.926 154.251 L128.601 154.251 L128.601 184.876 L136.24 184.876 L136.24 188.811 L116.333 188.811 L116.333 184.876 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M155.685 157.33 Q152.074 157.33 150.245 160.895 Q148.439 164.436 148.439 171.566 Q148.439 178.672 150.245 182.237 Q152.074 185.779 155.685 185.779 Q159.319 185.779 161.124 182.237 Q162.953 178.672 162.953 171.566 Q162.953 164.436 161.124 160.895 Q159.319 157.33 155.685 157.33 M155.685 153.626 Q161.495 153.626 164.55 158.233 Q167.629 162.816 167.629 171.566 Q167.629 180.293 164.55 184.899 Q161.495 189.483 155.685 189.483 Q149.875 189.483 146.796 184.899 Q143.74 180.293 143.74 171.566 Q143.74 162.816 146.796 158.233 Q149.875 153.626 155.685 153.626 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M167.629 147.728 L191.741 147.728 L191.741 150.925 L167.629 150.925 L167.629 147.728 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M211.451 146.261 Q214.178 146.844 215.702 148.687 Q217.244 150.53 217.244 153.238 Q217.244 157.395 214.385 159.671 Q211.526 161.946 206.26 161.946 Q204.492 161.946 202.612 161.589 Q200.75 161.25 198.756 160.554 L198.756 156.887 Q200.336 157.809 202.217 158.279 Q204.097 158.749 206.147 158.749 Q209.721 158.749 211.583 157.338 Q213.464 155.928 213.464 153.238 Q213.464 150.756 211.714 149.364 Q209.984 147.953 206.881 147.953 L203.608 147.953 L203.608 144.831 L207.031 144.831 Q209.834 144.831 211.32 143.722 Q212.805 142.593 212.805 140.487 Q212.805 138.324 211.263 137.176 Q209.74 136.01 206.881 136.01 Q205.32 136.01 203.533 136.349 Q201.746 136.687 199.602 137.402 L199.602 134.017 Q201.765 133.415 203.646 133.114 Q205.546 132.813 207.219 132.813 Q211.545 132.813 214.065 134.788 Q216.586 136.744 216.586 140.092 Q216.586 142.424 215.25 144.041 Q213.915 145.64 211.451 146.261 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M18.4042 761.509 L18.4042 751.929 L50.7419 739.802 L18.4042 727.612 L18.4042 718.031 L65.9242 718.031 L65.9242 724.301 L24.197 724.301 L56.7894 736.555 L56.7894 743.017 L24.197 755.271 L65.9242 755.271 L65.9242 761.509 L18.4042 761.509 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M19.9638 676.781 L26.234 676.781 Q24.4834 680.442 23.624 683.688 Q22.7647 686.935 22.7647 689.958 Q22.7647 695.21 24.8017 698.075 Q26.8387 700.907 30.5945 700.907 Q33.7455 700.907 35.3688 699.03 Q36.9602 697.12 37.9469 691.836 L38.7426 687.953 Q40.1112 680.76 43.5805 677.354 Q47.018 673.917 52.8108 673.917 Q59.7176 673.917 63.2824 678.564 Q66.8472 683.179 66.8472 692.123 Q66.8472 695.497 66.0833 699.316 Q65.3194 703.104 63.8235 707.178 L57.2031 707.178 Q59.3993 703.263 60.5133 699.507 Q61.6273 695.751 61.6273 692.123 Q61.6273 686.616 59.463 683.625 Q57.2986 680.633 53.2882 680.633 Q49.7871 680.633 47.8137 682.797 Q45.8404 684.929 44.8537 689.831 L44.0898 693.746 Q42.6575 700.939 39.602 704.154 Q36.5464 707.369 31.1037 707.369 Q24.8017 707.369 21.1732 702.944 Q17.5448 698.488 17.5448 690.69 Q17.5448 687.348 18.1495 683.879 Q18.7543 680.41 19.9638 676.781 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M18.4042 663.891 L18.4042 633.845 L23.815 633.845 L23.815 657.461 L37.8832 657.461 L37.8832 634.831 L43.2941 634.831 L43.2941 657.461 L60.5133 657.461 L60.5133 633.272 L65.9242 633.272 L65.9242 663.891 L18.4042 663.891 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><circle clip-path="url(#clip142)" cx="308.548" cy="242.811" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip142)" cx="939.036" cy="600.292" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip142)" cx="1569.52" cy="966.696" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip142)" cx="2200.01" cy="1303.7" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<polyline clip-path="url(#clip142)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="308.548,246.014 327.654,256.769 346.759,267.523 365.865,278.278 384.971,289.033 404.076,299.788 423.182,310.542 442.288,321.297 461.393,332.052 480.499,342.807 499.605,353.562 518.711,364.316 537.816,375.071 556.922,385.826 576.028,396.581 595.133,407.335 614.239,418.09 633.345,428.845 652.45,439.6 671.556,450.354 690.662,461.109 709.768,471.864 728.873,482.619 747.979,493.374 767.085,504.128 786.19,514.883 805.296,525.638 824.402,536.393 843.507,547.147 862.613,557.902 881.719,568.657 900.825,579.412 919.93,590.166 939.036,600.921 958.142,611.676 977.247,622.431 996.353,633.186 1015.46,643.94 1034.56,654.695 1053.67,665.45 1072.78,676.205 1091.88,686.959 1110.99,697.714 1130.09,708.469 1149.2,719.224 1168.3,729.978 1187.41,740.733 1206.52,751.488 1225.62,762.243 1244.73,772.997 1263.83,783.752 1282.94,794.507 1302.04,805.262 1321.15,816.017 1340.26,826.771 1359.36,837.526 1378.47,848.281 1397.57,859.036 1416.68,869.79 1435.78,880.545 1454.89,891.3 1474,902.055 1493.1,912.809 1512.21,923.564 1531.31,934.319 1550.42,945.074 1569.52,955.829 1588.63,966.583 1607.74,977.338 1626.84,988.093 1645.95,998.848 1665.05,1009.6 1684.16,1020.36 1703.26,1031.11 1722.37,1041.87 1741.48,1052.62 1760.58,1063.38 1779.69,1074.13 1798.79,1084.89 1817.9,1095.64 1837,1106.4 1856.11,1117.15 1875.22,1127.9 1894.32,1138.66 1913.43,1149.41 1932.53,1160.17 1951.64,1170.92 1970.74,1181.68 1989.85,1192.43 2008.96,1203.19 2028.06,1213.94 2047.17,1224.7 2066.27,1235.45 2085.38,1246.21 2104.48,1256.96 2123.59,1267.72 2142.69,1278.47 2161.8,1289.23 2180.91,1299.98 2200.01,1310.74 "></polyline>
<circle clip-path="url(#clip142)" cx="308.548" cy="92.7337" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip142)" cx="939.036" cy="408.699" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip142)" cx="1569.52" cy="770.806" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip142)" cx="2200.01" cy="1107.14" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<polyline clip-path="url(#clip142)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" stroke-dasharray="32, 20" points="308.548,84.0448 327.654,94.364 346.759,104.683 365.865,115.002 384.971,125.322 404.076,135.641 423.182,145.96 442.288,156.279 461.393,166.599 480.499,176.918 499.605,187.237 518.711,197.556 537.816,207.875 556.922,218.195 576.028,228.514 595.133,238.833 614.239,249.152 633.345,259.471 652.45,269.791 671.556,280.11 690.662,290.429 709.768,300.748 728.873,311.067 747.979,321.387 767.085,331.706 786.19,342.025 805.296,352.344 824.402,362.663 843.507,372.983 862.613,383.302 881.719,393.621 900.825,403.94 919.93,414.26 939.036,424.579 958.142,434.898 977.247,445.217 996.353,455.536 1015.46,465.856 1034.56,476.175 1053.67,486.494 1072.78,496.813 1091.88,507.132 1110.99,517.452 1130.09,527.771 1149.2,538.09 1168.3,548.409 1187.41,558.728 1206.52,569.048 1225.62,579.367 1244.73,589.686 1263.83,600.005 1282.94,610.325 1302.04,620.644 1321.15,630.963 1340.26,641.282 1359.36,651.601 1378.47,661.921 1397.57,672.24 1416.68,682.559 1435.78,692.878 1454.89,703.197 1474,713.517 1493.1,723.836 1512.21,734.155 1531.31,744.474 1550.42,754.793 1569.52,765.113 1588.63,775.432 1607.74,785.751 1626.84,796.07 1645.95,806.389 1665.05,816.709 1684.16,827.028 1703.26,837.347 1722.37,847.666 1741.48,857.986 1760.58,868.305 1779.69,878.624 1798.79,888.943 1817.9,899.262 1837,909.582 1856.11,919.901 1875.22,930.22 1894.32,940.539 1913.43,950.858 1932.53,961.178 1951.64,971.497 1970.74,981.816 1989.85,992.135 2008.96,1002.45 2028.06,1012.77 2047.17,1023.09 2066.27,1033.41 2085.38,1043.73 2104.48,1054.05 2123.59,1064.37 2142.69,1074.69 2161.8,1085.01 2180.91,1095.33 2200.01,1105.65 "></polyline>
<path clip-path="url(#clip140)" d="M1315.01 246.107 L2189.92 246.107 L2189.92 90.5872 L1315.01 90.5872  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1315.01,246.107 2189.92,246.107 2189.92,90.5872 1315.01,90.5872 1315.01,246.107 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1337.29,142.427 1470.95,142.427 "></polyline>
<path clip-path="url(#clip140)" d="M1493.76 125.147 L1520.91 125.147 L1520.91 128.712 L1499.06 155.772 L1521.45 155.772 L1521.45 159.707 L1493.23 159.707 L1493.23 156.142 L1515.08 129.082 L1493.76 129.082 L1493.76 125.147 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1526.24 125.147 L1553.39 125.147 L1553.39 128.712 L1531.54 155.772 L1553.92 155.772 L1553.92 159.707 L1525.71 159.707 L1525.71 156.142 L1547.56 129.082 L1526.24 129.082 L1526.24 125.147 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip140)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" stroke-dasharray="32, 20" points="1337.29,194.267 1470.95,194.267 "></polyline>
<path clip-path="url(#clip140)" d="M1493.76 176.987 L1520.91 176.987 L1520.91 180.552 L1499.06 207.612 L1521.45 207.612 L1521.45 211.547 L1493.23 211.547 L1493.23 207.982 L1515.08 180.922 L1493.76 180.922 L1493.76 176.987 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1526.24 176.987 L1553.39 176.987 L1553.39 180.552 L1531.54 207.612 L1553.92 207.612 L1553.92 211.547 L1525.71 211.547 L1525.71 207.982 L1547.56 180.922 L1526.24 180.922 L1526.24 176.987 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1557.53 196.663 L1570.01 196.663 L1570.01 200.459 L1557.53 200.459 L1557.53 196.663 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1602.86 179.649 L1602.86 184.58 Q1600.5 182.381 1597.81 181.293 Q1595.15 180.205 1592.14 180.205 Q1586.21 180.205 1583.07 183.839 Q1579.92 187.45 1579.92 194.302 Q1579.92 201.131 1583.07 204.765 Q1586.21 208.376 1592.14 208.376 Q1595.15 208.376 1597.81 207.288 Q1600.5 206.2 1602.86 204.001 L1602.86 208.885 Q1600.4 210.552 1597.65 211.385 Q1594.92 212.218 1591.86 212.218 Q1584.02 212.218 1579.5 207.427 Q1574.99 202.612 1574.99 194.302 Q1574.99 185.969 1579.5 181.177 Q1584.02 176.362 1591.86 176.362 Q1594.96 176.362 1597.7 177.196 Q1600.45 178.006 1602.86 179.649 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1618.99 211.547 L1605.8 176.987 L1610.68 176.987 L1621.63 206.084 L1632.6 176.987 L1637.46 176.987 L1624.29 211.547 L1618.99 211.547 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1667.63 175.575 Q1664.52 180.899 1663.02 186.108 Q1661.52 191.316 1661.52 196.663 Q1661.52 202.01 1663.02 207.265 Q1664.55 212.496 1667.63 217.797 L1663.92 217.797 Q1660.45 212.357 1658.71 207.103 Q1657 201.848 1657 196.663 Q1657 191.501 1658.71 186.27 Q1660.43 181.038 1663.92 175.575 L1667.63 175.575 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1673.41 185.621 L1677.67 185.621 L1683 205.853 L1688.3 185.621 L1693.32 185.621 L1698.64 205.853 L1703.95 185.621 L1708.2 185.621 L1701.42 211.547 L1696.4 211.547 L1690.82 190.297 L1685.22 211.547 L1680.2 211.547 L1673.41 185.621 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1714.66 185.621 L1718.92 185.621 L1718.92 211.547 L1714.66 211.547 L1714.66 185.621 M1714.66 175.529 L1718.92 175.529 L1718.92 180.922 L1714.66 180.922 L1714.66 175.529 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1732.05 178.26 L1732.05 185.621 L1740.82 185.621 L1740.82 188.932 L1732.05 188.932 L1732.05 203.006 Q1732.05 206.177 1732.9 207.08 Q1733.78 207.982 1736.45 207.982 L1740.82 207.982 L1740.82 211.547 L1736.45 211.547 Q1731.52 211.547 1729.64 209.718 Q1727.77 207.867 1727.77 203.006 L1727.77 188.932 L1724.64 188.932 L1724.64 185.621 L1727.77 185.621 L1727.77 178.26 L1732.05 178.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1767.97 195.899 L1767.97 211.547 L1763.71 211.547 L1763.71 196.038 Q1763.71 192.357 1762.28 190.529 Q1760.84 188.7 1757.97 188.7 Q1754.52 188.7 1752.53 190.899 Q1750.54 193.098 1750.54 196.894 L1750.54 211.547 L1746.26 211.547 L1746.26 175.529 L1750.54 175.529 L1750.54 189.649 Q1752.07 187.311 1754.13 186.154 Q1756.21 184.996 1758.92 184.996 Q1763.39 184.996 1765.68 187.774 Q1767.97 190.529 1767.97 195.899 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1786.51 188.607 Q1783.09 188.607 1781.1 191.293 Q1779.11 193.955 1779.11 198.607 Q1779.11 203.26 1781.07 205.945 Q1783.07 208.607 1786.51 208.607 Q1789.92 208.607 1791.91 205.922 Q1793.9 203.237 1793.9 198.607 Q1793.9 194.001 1791.91 191.316 Q1789.92 188.607 1786.51 188.607 M1786.51 184.996 Q1792.07 184.996 1795.24 188.607 Q1798.41 192.219 1798.41 198.607 Q1798.41 204.973 1795.24 208.607 Q1792.07 212.218 1786.51 212.218 Q1780.94 212.218 1777.76 208.607 Q1774.62 204.973 1774.62 198.607 Q1774.62 192.219 1777.76 188.607 Q1780.94 184.996 1786.51 184.996 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1805.03 201.316 L1805.03 185.621 L1809.29 185.621 L1809.29 201.154 Q1809.29 204.834 1810.73 206.686 Q1812.16 208.515 1815.03 208.515 Q1818.48 208.515 1820.47 206.316 Q1822.49 204.117 1822.49 200.32 L1822.49 185.621 L1826.75 185.621 L1826.75 211.547 L1822.49 211.547 L1822.49 207.566 Q1820.94 209.927 1818.88 211.084 Q1816.84 212.218 1814.13 212.218 Q1809.66 212.218 1807.35 209.441 Q1805.03 206.663 1805.03 201.316 M1815.75 184.996 L1815.75 184.996 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1839.73 178.26 L1839.73 185.621 L1848.51 185.621 L1848.51 188.932 L1839.73 188.932 L1839.73 203.006 Q1839.73 206.177 1840.59 207.08 Q1841.47 207.982 1844.13 207.982 L1848.51 207.982 L1848.51 211.547 L1844.13 211.547 Q1839.2 211.547 1837.32 209.718 Q1835.45 207.867 1835.45 203.006 L1835.45 188.932 L1832.32 188.932 L1832.32 185.621 L1835.45 185.621 L1835.45 178.26 L1839.73 178.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1880.96 198.515 Q1875.8 198.515 1873.81 199.695 Q1871.82 200.876 1871.82 203.723 Q1871.82 205.992 1873.3 207.334 Q1874.8 208.654 1877.37 208.654 Q1880.91 208.654 1883.04 206.154 Q1885.19 203.631 1885.19 199.464 L1885.19 198.515 L1880.96 198.515 M1889.45 196.756 L1889.45 211.547 L1885.19 211.547 L1885.19 207.612 Q1883.74 209.973 1881.56 211.107 Q1879.38 212.218 1876.24 212.218 Q1872.25 212.218 1869.89 209.996 Q1867.56 207.751 1867.56 204.001 Q1867.56 199.626 1870.47 197.404 Q1873.41 195.182 1879.22 195.182 L1885.19 195.182 L1885.19 194.765 Q1885.19 191.825 1883.25 190.228 Q1881.33 188.607 1877.83 188.607 Q1875.61 188.607 1873.5 189.14 Q1871.4 189.672 1869.45 190.737 L1869.45 186.802 Q1871.79 185.899 1873.99 185.459 Q1876.19 184.996 1878.27 184.996 Q1883.9 184.996 1886.68 187.913 Q1889.45 190.83 1889.45 196.756 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1918.41 190.598 Q1920.01 187.728 1922.23 186.362 Q1924.45 184.996 1927.46 184.996 Q1931.51 184.996 1933.71 187.844 Q1935.91 190.668 1935.91 195.899 L1935.91 211.547 L1931.63 211.547 L1931.63 196.038 Q1931.63 192.311 1930.31 190.506 Q1928.99 188.7 1926.28 188.7 Q1922.97 188.7 1921.05 190.899 Q1919.13 193.098 1919.13 196.894 L1919.13 211.547 L1914.85 211.547 L1914.85 196.038 Q1914.85 192.288 1913.53 190.506 Q1912.21 188.7 1909.45 188.7 Q1906.19 188.7 1904.27 190.922 Q1902.35 193.121 1902.35 196.894 L1902.35 211.547 L1898.07 211.547 L1898.07 185.621 L1902.35 185.621 L1902.35 189.649 Q1903.81 187.265 1905.84 186.131 Q1907.88 184.996 1910.68 184.996 Q1913.5 184.996 1915.47 186.432 Q1917.46 187.867 1918.41 190.598 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1966.58 197.519 L1966.58 199.603 L1947 199.603 Q1947.28 204.001 1949.64 206.316 Q1952.02 208.607 1956.26 208.607 Q1958.71 208.607 1961 208.006 Q1963.32 207.404 1965.59 206.2 L1965.59 210.228 Q1963.3 211.2 1960.89 211.709 Q1958.48 212.218 1956 212.218 Q1949.8 212.218 1946.17 208.607 Q1942.56 204.996 1942.56 198.839 Q1942.56 192.473 1945.98 188.746 Q1949.43 184.996 1955.26 184.996 Q1960.5 184.996 1963.53 188.376 Q1966.58 191.732 1966.58 197.519 M1962.32 196.269 Q1962.28 192.774 1960.36 190.691 Q1958.46 188.607 1955.31 188.607 Q1951.75 188.607 1949.59 190.621 Q1947.46 192.635 1947.14 196.293 L1962.32 196.269 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1995.12 195.899 L1995.12 211.547 L1990.87 211.547 L1990.87 196.038 Q1990.87 192.357 1989.43 190.529 Q1988 188.7 1985.12 188.7 Q1981.68 188.7 1979.68 190.899 Q1977.69 193.098 1977.69 196.894 L1977.69 211.547 L1973.41 211.547 L1973.41 185.621 L1977.69 185.621 L1977.69 189.649 Q1979.22 187.311 1981.28 186.154 Q1983.37 184.996 1986.07 184.996 Q1990.54 184.996 1992.83 187.774 Q1995.12 190.529 1995.12 195.899 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2020.68 189.557 L2020.68 175.529 L2024.94 175.529 L2024.94 211.547 L2020.68 211.547 L2020.68 207.658 Q2019.34 209.973 2017.28 211.107 Q2015.24 212.218 2012.37 212.218 Q2007.67 212.218 2004.71 208.468 Q2001.77 204.719 2001.77 198.607 Q2001.77 192.496 2004.71 188.746 Q2007.67 184.996 2012.37 184.996 Q2015.24 184.996 2017.28 186.131 Q2019.34 187.242 2020.68 189.557 M2006.17 198.607 Q2006.17 203.306 2008.09 205.992 Q2010.03 208.654 2013.41 208.654 Q2016.79 208.654 2018.74 205.992 Q2020.68 203.306 2020.68 198.607 Q2020.68 193.908 2018.74 191.246 Q2016.79 188.561 2013.41 188.561 Q2010.03 188.561 2008.09 191.246 Q2006.17 193.908 2006.17 198.607 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2053.9 190.598 Q2055.49 187.728 2057.72 186.362 Q2059.94 184.996 2062.95 184.996 Q2067 184.996 2069.2 187.844 Q2071.4 190.668 2071.4 195.899 L2071.4 211.547 L2067.12 211.547 L2067.12 196.038 Q2067.12 192.311 2065.8 190.506 Q2064.48 188.7 2061.77 188.7 Q2058.46 188.7 2056.54 190.899 Q2054.62 193.098 2054.62 196.894 L2054.62 211.547 L2050.33 211.547 L2050.33 196.038 Q2050.33 192.288 2049.01 190.506 Q2047.69 188.7 2044.94 188.7 Q2041.68 188.7 2039.75 190.922 Q2037.83 193.121 2037.83 196.894 L2037.83 211.547 L2033.55 211.547 L2033.55 185.621 L2037.83 185.621 L2037.83 189.649 Q2039.29 187.265 2041.33 186.131 Q2043.37 184.996 2046.17 184.996 Q2048.99 184.996 2050.96 186.432 Q2052.95 187.867 2053.9 190.598 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2102.07 197.519 L2102.07 199.603 L2082.49 199.603 Q2082.76 204.001 2085.12 206.316 Q2087.51 208.607 2091.74 208.607 Q2094.2 208.607 2096.49 208.006 Q2098.8 207.404 2101.07 206.2 L2101.07 210.228 Q2098.78 211.2 2096.37 211.709 Q2093.97 212.218 2091.49 212.218 Q2085.29 212.218 2081.65 208.607 Q2078.04 204.996 2078.04 198.839 Q2078.04 192.473 2081.47 188.746 Q2084.92 184.996 2090.75 184.996 Q2095.98 184.996 2099.01 188.376 Q2102.07 191.732 2102.07 197.519 M2097.81 196.269 Q2097.76 192.774 2095.84 190.691 Q2093.94 188.607 2090.8 188.607 Q2087.23 188.607 2085.08 190.621 Q2082.95 192.635 2082.62 196.293 L2097.81 196.269 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2130.61 195.899 L2130.61 211.547 L2126.35 211.547 L2126.35 196.038 Q2126.35 192.357 2124.92 190.529 Q2123.48 188.7 2120.61 188.7 Q2117.16 188.7 2115.17 190.899 Q2113.18 193.098 2113.18 196.894 L2113.18 211.547 L2108.9 211.547 L2108.9 185.621 L2113.18 185.621 L2113.18 189.649 Q2114.71 187.311 2116.77 186.154 Q2118.85 184.996 2121.56 184.996 Q2126.03 184.996 2128.32 187.774 Q2130.61 190.529 2130.61 195.899 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2143.32 178.26 L2143.32 185.621 L2152.09 185.621 L2152.09 188.932 L2143.32 188.932 L2143.32 203.006 Q2143.32 206.177 2144.17 207.08 Q2145.05 207.982 2147.72 207.982 L2152.09 207.982 L2152.09 211.547 L2147.72 211.547 Q2142.79 211.547 2140.91 209.718 Q2139.04 207.867 2139.04 203.006 L2139.04 188.932 L2135.91 188.932 L2135.91 185.621 L2139.04 185.621 L2139.04 178.26 L2143.32 178.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2157.02 175.575 L2160.73 175.575 Q2164.2 181.038 2165.91 186.27 Q2167.65 191.501 2167.65 196.663 Q2167.65 201.848 2165.91 207.103 Q2164.2 212.357 2160.73 217.797 L2157.02 217.797 Q2160.1 212.496 2161.61 207.265 Q2163.13 202.01 2163.13 196.663 Q2163.13 191.316 2161.61 186.108 Q2160.1 180.899 2157.02 175.575 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
<p>一見すると ZZ-CV が負けているように見える．しかし，点線で描いているのは，横軸が epoch であることを正しく考慮していない間違ったプロットであるためである．</p>
<p><span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens et al., 2019, p. 1310</a>)</span> において epoch とは，計算量の１単位分としており，ZZ における１回の到着時刻のシミュレーションは，ZZ-CV の <span class="math inline">\(n\)</span> 回分に当たる．これを考慮に入れてプロットし直すと次の通りになる：</p>
<div id="6f73db0f" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>実験の実行</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>T_SuperEfficient <span class="op">=</span> <span class="fl">300000.0</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>epoch_list_SuperEfficient <span class="op">=</span> [<span class="fl">1000.0</span>, <span class="fl">10000.0</span>, <span class="fl">100000.0</span>, <span class="fl">1000000.0</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="pp">@time</span> MSE_ZZ_CV, acc <span class="op">=</span> <span class="fu">experiment</span>(epoch_list_SuperEfficient, T_SuperEfficient, dt, N, ∇U1, x0, θ<span class="fl">0</span>, y1, ZZ_CV; ab<span class="op">=</span>ab_ZZ_CV)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter!</span>(p, epoch_list, MSE_ZZ_CV,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    marker<span class="op">=:</span>circle,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    markersize<span class="op">=</span><span class="fl">5</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    markeralpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#E95420"</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="cn">nothing</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="fu">DataFrame</span>(X <span class="op">=</span> <span class="fu">log10</span>.(epoch_list), Y <span class="op">=</span> <span class="fu">log10</span>.(MSE_ZZ_CV))</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">lm</span>(<span class="pp">@formula</span>(Y <span class="op">~</span> X), df)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>X_pred <span class="op">=</span> <span class="fu">range</span>(<span class="fu">minimum</span>(df.X), <span class="fu">maximum</span>(df.X), length<span class="op">=</span><span class="fl">100</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>Y_pred <span class="op">=</span> <span class="fu">predict</span>(model, <span class="fu">DataFrame</span>(X <span class="op">=</span> X_pred))</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(p, <span class="fl">10</span> <span class="op">.^</span> X_pred, <span class="fl">10</span> <span class="op">.^</span> Y_pred,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=:</span>solid,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    linewidth<span class="op">=</span><span class="fl">2</span>,</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#E95420"</span>,</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">"ZZ-CV"</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(p)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> 48.490704 seconds (2.48 G allocations: 46.290 GiB, 7.66% gc time)</code></pre>
</div>
<div class="cell-output cell-output-display">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="576" height="384" viewbox="0 0 2304 1536">
<defs>
  <clippath id="clip270">
    <rect x="0" y="0" width="2304" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip270)" d="M0 1536 L2304 1536 L2304 8.52651e-14 L0 8.52651e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip271">
    <rect x="460" y="0" width="1614" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip270)" d="M251.804 1347.54 L2256.76 1347.54 L2256.76 47.2441 L251.804 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip272">
    <rect x="251" y="47" width="2006" height="1301"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="939.036,1347.54 939.036,47.2441 "></polyline>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2200.01,1347.54 2200.01,47.2441 "></polyline>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,1347.54 2256.76,1347.54 "></polyline>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="939.036,1347.54 939.036,1328.64 "></polyline>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2200.01,1347.54 2200.01,1328.64 "></polyline>
<path clip-path="url(#clip270)" d="M904.809 1420.89 L912.448 1420.89 L912.448 1394.53 L904.137 1396.19 L904.137 1391.94 L912.401 1390.27 L917.077 1390.27 L917.077 1420.89 L924.716 1420.89 L924.716 1424.83 L904.809 1424.83 L904.809 1420.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M944.16 1393.35 Q940.549 1393.35 938.721 1396.91 Q936.915 1400.45 936.915 1407.58 Q936.915 1414.69 938.721 1418.25 Q940.549 1421.8 944.16 1421.8 Q947.795 1421.8 949.6 1418.25 Q951.429 1414.69 951.429 1407.58 Q951.429 1400.45 949.6 1396.91 Q947.795 1393.35 944.16 1393.35 M944.16 1389.64 Q949.97 1389.64 953.026 1394.25 Q956.105 1398.83 956.105 1407.58 Q956.105 1416.31 953.026 1420.92 Q949.97 1425.5 944.16 1425.5 Q938.35 1425.5 935.271 1420.92 Q932.216 1416.31 932.216 1407.58 Q932.216 1398.83 935.271 1394.25 Q938.35 1389.64 944.16 1389.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M960.675 1394.22 L973.934 1394.22 L973.934 1397.42 L956.105 1397.42 L956.105 1394.22 Q958.268 1391.98 961.992 1388.22 Q965.734 1384.44 966.693 1383.35 Q968.518 1381.3 969.233 1379.89 Q969.966 1378.46 969.966 1377.09 Q969.966 1374.85 968.386 1373.44 Q966.825 1372.03 964.305 1372.03 Q962.518 1372.03 960.525 1372.65 Q958.55 1373.27 956.293 1374.53 L956.293 1370.69 Q958.587 1369.77 960.581 1369.3 Q962.575 1368.83 964.23 1368.83 Q968.593 1368.83 971.189 1371.01 Q973.784 1373.19 973.784 1376.84 Q973.784 1378.57 973.126 1380.13 Q972.486 1381.68 970.775 1383.78 Q970.305 1384.33 967.784 1386.94 Q965.264 1389.54 960.675 1394.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M2164.47 1420.89 L2172.11 1420.89 L2172.11 1394.53 L2163.8 1396.19 L2163.8 1391.94 L2172.06 1390.27 L2176.74 1390.27 L2176.74 1420.89 L2184.38 1420.89 L2184.38 1424.83 L2164.47 1424.83 L2164.47 1420.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M2203.82 1393.35 Q2200.21 1393.35 2198.38 1396.91 Q2196.57 1400.45 2196.57 1407.58 Q2196.57 1414.69 2198.38 1418.25 Q2200.21 1421.8 2203.82 1421.8 Q2207.45 1421.8 2209.26 1418.25 Q2211.09 1414.69 2211.09 1407.58 Q2211.09 1400.45 2209.26 1396.91 Q2207.45 1393.35 2203.82 1393.35 M2203.82 1389.64 Q2209.63 1389.64 2212.69 1394.25 Q2215.76 1398.83 2215.76 1407.58 Q2215.76 1416.31 2212.69 1420.92 Q2209.63 1425.5 2203.82 1425.5 Q2198.01 1425.5 2194.93 1420.92 Q2191.88 1416.31 2191.88 1407.58 Q2191.88 1398.83 2194.93 1394.25 Q2198.01 1389.64 2203.82 1389.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M2228.44 1372.65 L2218.85 1387.64 L2228.44 1387.64 L2228.44 1372.65 M2227.44 1369.34 L2232.22 1369.34 L2232.22 1387.64 L2236.23 1387.64 L2236.23 1390.8 L2232.22 1390.8 L2232.22 1397.42 L2228.44 1397.42 L2228.44 1390.8 L2215.76 1390.8 L2215.76 1387.13 L2227.44 1369.34 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M1174.47 1490.1 L1174.47 1492.96 L1147.54 1492.96 Q1147.92 1499.01 1151.17 1502.19 Q1154.45 1505.34 1160.27 1505.34 Q1163.65 1505.34 1166.8 1504.52 Q1169.98 1503.69 1173.1 1502.03 L1173.1 1507.57 Q1169.95 1508.91 1166.64 1509.61 Q1163.33 1510.31 1159.92 1510.31 Q1151.39 1510.31 1146.4 1505.34 Q1141.43 1500.38 1141.43 1491.91 Q1141.43 1483.16 1146.14 1478.03 Q1150.88 1472.88 1158.91 1472.88 Q1166.1 1472.88 1170.27 1477.53 Q1174.47 1482.14 1174.47 1490.1 M1168.61 1488.38 Q1168.55 1483.57 1165.91 1480.71 Q1163.3 1477.84 1158.97 1477.84 Q1154.07 1477.84 1151.11 1480.61 Q1148.18 1483.38 1147.73 1488.41 L1168.61 1488.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M1189.75 1504.04 L1189.75 1522.94 L1183.86 1522.94 L1183.86 1473.74 L1189.75 1473.74 L1189.75 1479.15 Q1191.59 1475.97 1194.39 1474.44 Q1197.23 1472.88 1201.14 1472.88 Q1207.64 1472.88 1211.68 1478.03 Q1215.75 1483.19 1215.75 1491.59 Q1215.75 1500 1211.68 1505.15 Q1207.64 1510.31 1201.14 1510.31 Q1197.23 1510.31 1194.39 1508.78 Q1191.59 1507.22 1189.75 1504.04 M1209.67 1491.59 Q1209.67 1485.13 1207 1481.47 Q1204.36 1477.78 1199.71 1477.78 Q1195.06 1477.78 1192.39 1481.47 Q1189.75 1485.13 1189.75 1491.59 Q1189.75 1498.05 1192.39 1501.75 Q1195.06 1505.41 1199.71 1505.41 Q1204.36 1505.41 1207 1501.75 Q1209.67 1498.05 1209.67 1491.59 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M1239.27 1477.84 Q1234.56 1477.84 1231.82 1481.54 Q1229.09 1485.2 1229.09 1491.59 Q1229.09 1497.99 1231.79 1501.68 Q1234.53 1505.34 1239.27 1505.34 Q1243.95 1505.34 1246.69 1501.65 Q1249.43 1497.96 1249.43 1491.59 Q1249.43 1485.26 1246.69 1481.57 Q1243.95 1477.84 1239.27 1477.84 M1239.27 1472.88 Q1246.91 1472.88 1251.27 1477.84 Q1255.63 1482.81 1255.63 1491.59 Q1255.63 1500.35 1251.27 1505.34 Q1246.91 1510.31 1239.27 1510.31 Q1231.6 1510.31 1227.24 1505.34 Q1222.91 1500.35 1222.91 1491.59 Q1222.91 1482.81 1227.24 1477.84 Q1231.6 1472.88 1239.27 1472.88 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M1290.99 1475.11 L1290.99 1480.58 Q1288.51 1479.21 1286 1478.54 Q1283.51 1477.84 1280.97 1477.84 Q1275.27 1477.84 1272.12 1481.47 Q1268.97 1485.07 1268.97 1491.59 Q1268.97 1498.12 1272.12 1501.75 Q1275.27 1505.34 1280.97 1505.34 Q1283.51 1505.34 1286 1504.67 Q1288.51 1503.97 1290.99 1502.61 L1290.99 1508.02 Q1288.54 1509.16 1285.9 1509.74 Q1283.29 1510.31 1280.33 1510.31 Q1272.28 1510.31 1267.54 1505.25 Q1262.79 1500.19 1262.79 1491.59 Q1262.79 1482.87 1267.57 1477.88 Q1272.37 1472.88 1280.71 1472.88 Q1283.42 1472.88 1286 1473.45 Q1288.58 1473.99 1290.99 1475.11 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M1330.81 1487.87 L1330.81 1509.39 L1324.96 1509.39 L1324.96 1488.06 Q1324.96 1483 1322.98 1480.49 Q1321.01 1477.97 1317.06 1477.97 Q1312.32 1477.97 1309.58 1480.99 Q1306.84 1484.02 1306.84 1489.24 L1306.84 1509.39 L1300.96 1509.39 L1300.96 1459.86 L1306.84 1459.86 L1306.84 1479.28 Q1308.95 1476.06 1311.78 1474.47 Q1314.64 1472.88 1318.37 1472.88 Q1324.51 1472.88 1327.66 1476.7 Q1330.81 1480.49 1330.81 1487.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M1365.22 1474.79 L1365.22 1480.33 Q1362.74 1479.05 1360.06 1478.42 Q1357.39 1477.78 1354.52 1477.78 Q1350.16 1477.78 1347.97 1479.12 Q1345.8 1480.45 1345.8 1483.13 Q1345.8 1485.16 1347.36 1486.34 Q1348.92 1487.49 1353.63 1488.54 L1355.64 1488.98 Q1361.88 1490.32 1364.49 1492.77 Q1367.13 1495.19 1367.13 1499.55 Q1367.13 1504.52 1363.18 1507.41 Q1359.27 1510.31 1352.39 1510.31 Q1349.53 1510.31 1346.41 1509.74 Q1343.32 1509.19 1339.88 1508.08 L1339.88 1502.03 Q1343.13 1503.72 1346.28 1504.58 Q1349.43 1505.41 1352.52 1505.41 Q1356.66 1505.41 1358.88 1504.01 Q1361.11 1502.57 1361.11 1500 Q1361.11 1497.61 1359.49 1496.34 Q1357.9 1495.06 1352.46 1493.88 L1350.42 1493.41 Q1344.98 1492.26 1342.56 1489.91 Q1340.14 1487.52 1340.14 1483.38 Q1340.14 1478.35 1343.7 1475.62 Q1347.27 1472.88 1353.82 1472.88 Q1357.07 1472.88 1359.93 1473.36 Q1362.8 1473.83 1365.22 1474.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="251.804,863.771 2256.76,863.771 "></polyline>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="251.804,303.749 2256.76,303.749 "></polyline>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,1347.54 251.804,47.2441 "></polyline>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,863.771 270.702,863.771 "></polyline>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,303.749 270.702,303.749 "></polyline>
<path clip-path="url(#clip270)" d="M115.675 883.564 L123.314 883.564 L123.314 857.198 L115.003 858.865 L115.003 854.605 L123.267 852.939 L127.943 852.939 L127.943 883.564 L135.582 883.564 L135.582 887.499 L115.675 887.499 L115.675 883.564 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M155.026 856.017 Q151.415 856.017 149.587 859.582 Q147.781 863.124 147.781 870.253 Q147.781 877.36 149.587 880.925 Q151.415 884.466 155.026 884.466 Q158.661 884.466 160.466 880.925 Q162.295 877.36 162.295 870.253 Q162.295 863.124 160.466 859.582 Q158.661 856.017 155.026 856.017 M155.026 852.314 Q160.837 852.314 163.892 856.92 Q166.971 861.504 166.971 870.253 Q166.971 878.98 163.892 883.587 Q160.837 888.17 155.026 888.17 Q149.216 888.17 146.138 883.587 Q143.082 878.98 143.082 870.253 Q143.082 861.504 146.138 856.92 Q149.216 852.314 155.026 852.314 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M166.971 846.415 L191.082 846.415 L191.082 849.612 L166.971 849.612 L166.971 846.415 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M207.878 844.534 Q205.32 844.534 203.815 846.283 Q202.329 848.033 202.329 851.079 Q202.329 854.107 203.815 855.875 Q205.32 857.625 207.878 857.625 Q210.436 857.625 211.921 855.875 Q213.426 854.107 213.426 851.079 Q213.426 848.033 211.921 846.283 Q210.436 844.534 207.878 844.534 M215.42 832.629 L215.42 836.09 Q213.99 835.413 212.523 835.055 Q211.075 834.698 209.646 834.698 Q205.884 834.698 203.89 837.237 Q201.916 839.776 201.633 844.911 Q202.743 843.274 204.417 842.409 Q206.091 841.525 208.103 841.525 Q212.335 841.525 214.78 844.102 Q217.244 846.66 217.244 851.079 Q217.244 855.405 214.686 858.02 Q212.128 860.634 207.878 860.634 Q203.006 860.634 200.43 856.91 Q197.853 853.167 197.853 846.077 Q197.853 839.419 201.013 835.469 Q204.173 831.501 209.495 831.501 Q210.925 831.501 212.373 831.783 Q213.84 832.065 215.42 832.629 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M115.411 323.541 L123.05 323.541 L123.05 297.176 L114.74 298.843 L114.74 294.583 L123.004 292.917 L127.68 292.917 L127.68 323.541 L135.319 323.541 L135.319 327.477 L115.411 327.477 L115.411 323.541 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M154.763 295.995 Q151.152 295.995 149.323 299.56 Q147.518 303.102 147.518 310.231 Q147.518 317.338 149.323 320.903 Q151.152 324.444 154.763 324.444 Q158.397 324.444 160.203 320.903 Q162.032 317.338 162.032 310.231 Q162.032 303.102 160.203 299.56 Q158.397 295.995 154.763 295.995 M154.763 292.292 Q160.573 292.292 163.629 296.898 Q166.707 301.481 166.707 310.231 Q166.707 318.958 163.629 323.565 Q160.573 328.148 154.763 328.148 Q148.953 328.148 145.874 323.565 Q142.819 318.958 142.819 310.231 Q142.819 301.481 145.874 296.898 Q148.953 292.292 154.763 292.292 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M166.707 286.393 L190.819 286.393 L190.819 289.59 L166.707 289.59 L166.707 286.393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M209.458 275.296 L199.866 290.286 L209.458 290.286 L209.458 275.296 M208.461 271.986 L213.238 271.986 L213.238 290.286 L217.244 290.286 L217.244 293.446 L213.238 293.446 L213.238 300.066 L209.458 300.066 L209.458 293.446 L196.781 293.446 L196.781 289.778 L208.461 271.986 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M18.4042 761.509 L18.4042 751.929 L50.7419 739.802 L18.4042 727.612 L18.4042 718.031 L65.9242 718.031 L65.9242 724.301 L24.197 724.301 L56.7894 736.555 L56.7894 743.017 L24.197 755.271 L65.9242 755.271 L65.9242 761.509 L18.4042 761.509 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M19.9638 676.781 L26.234 676.781 Q24.4834 680.442 23.624 683.688 Q22.7647 686.935 22.7647 689.958 Q22.7647 695.21 24.8017 698.075 Q26.8387 700.907 30.5945 700.907 Q33.7455 700.907 35.3688 699.03 Q36.9602 697.12 37.9469 691.836 L38.7426 687.953 Q40.1112 680.76 43.5805 677.354 Q47.018 673.917 52.8108 673.917 Q59.7176 673.917 63.2824 678.564 Q66.8472 683.179 66.8472 692.123 Q66.8472 695.497 66.0833 699.316 Q65.3194 703.104 63.8235 707.178 L57.2031 707.178 Q59.3993 703.263 60.5133 699.507 Q61.6273 695.751 61.6273 692.123 Q61.6273 686.616 59.463 683.625 Q57.2986 680.633 53.2882 680.633 Q49.7871 680.633 47.8137 682.797 Q45.8404 684.929 44.8537 689.831 L44.0898 693.746 Q42.6575 700.939 39.602 704.154 Q36.5464 707.369 31.1037 707.369 Q24.8017 707.369 21.1732 702.944 Q17.5448 698.488 17.5448 690.69 Q17.5448 687.348 18.1495 683.879 Q18.7543 680.41 19.9638 676.781 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M18.4042 663.891 L18.4042 633.845 L23.815 633.845 L23.815 657.461 L37.8832 657.461 L37.8832 634.831 L43.2941 634.831 L43.2941 657.461 L60.5133 657.461 L60.5133 633.272 L65.9242 633.272 L65.9242 663.891 L18.4042 663.891 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><circle clip-path="url(#clip272)" cx="308.548" cy="84.0448" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip272)" cx="939.036" cy="361.407" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip272)" cx="1569.52" cy="645.692" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip272)" cx="2200.01" cy="907.167" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<polyline clip-path="url(#clip272)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="308.548,86.53 327.654,94.8744 346.759,103.219 365.865,111.563 384.971,119.908 404.076,128.252 423.182,136.596 442.288,144.941 461.393,153.285 480.499,161.63 499.605,169.974 518.711,178.318 537.816,186.663 556.922,195.007 576.028,203.352 595.133,211.696 614.239,220.04 633.345,228.385 652.45,236.729 671.556,245.074 690.662,253.418 709.768,261.762 728.873,270.107 747.979,278.451 767.085,286.796 786.19,295.14 805.296,303.484 824.402,311.829 843.507,320.173 862.613,328.518 881.719,336.862 900.825,345.207 919.93,353.551 939.036,361.895 958.142,370.24 977.247,378.584 996.353,386.929 1015.46,395.273 1034.56,403.617 1053.67,411.962 1072.78,420.306 1091.88,428.651 1110.99,436.995 1130.09,445.339 1149.2,453.684 1168.3,462.028 1187.41,470.373 1206.52,478.717 1225.62,487.061 1244.73,495.406 1263.83,503.75 1282.94,512.095 1302.04,520.439 1321.15,528.783 1340.26,537.128 1359.36,545.472 1378.47,553.817 1397.57,562.161 1416.68,570.505 1435.78,578.85 1454.89,587.194 1474,595.539 1493.1,603.883 1512.21,612.227 1531.31,620.572 1550.42,628.916 1569.52,637.261 1588.63,645.605 1607.74,653.949 1626.84,662.294 1645.95,670.638 1665.05,678.983 1684.16,687.327 1703.26,695.671 1722.37,704.016 1741.48,712.36 1760.58,720.705 1779.69,729.049 1798.79,737.393 1817.9,745.738 1837,754.082 1856.11,762.427 1875.22,770.771 1894.32,779.115 1913.43,787.46 1932.53,795.804 1951.64,804.149 1970.74,812.493 1989.85,820.837 2008.96,829.182 2028.06,837.526 2047.17,845.871 2066.27,854.215 2085.38,862.559 2104.48,870.904 2123.59,879.248 2142.69,887.593 2161.8,895.937 2180.91,904.281 2200.01,912.626 "></polyline>
<circle clip-path="url(#clip272)" cx="308.548" cy="578.905" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip272)" cx="939.036" cy="866.29" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip272)" cx="1569.52" cy="1096.71" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip272)" cx="2200.01" cy="1287.44" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<polyline clip-path="url(#clip272)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="308.548,603.933 327.654,611.072 346.759,618.212 365.865,625.351 384.971,632.49 404.076,639.63 423.182,646.769 442.288,653.909 461.393,661.048 480.499,668.188 499.605,675.327 518.711,682.466 537.816,689.606 556.922,696.745 576.028,703.885 595.133,711.024 614.239,718.164 633.345,725.303 652.45,732.442 671.556,739.582 690.662,746.721 709.768,753.861 728.873,761 747.979,768.14 767.085,775.279 786.19,782.418 805.296,789.558 824.402,796.697 843.507,803.837 862.613,810.976 881.719,818.116 900.825,825.255 919.93,832.394 939.036,839.534 958.142,846.673 977.247,853.813 996.353,860.952 1015.46,868.092 1034.56,875.231 1053.67,882.37 1072.78,889.51 1091.88,896.649 1110.99,903.789 1130.09,910.928 1149.2,918.068 1168.3,925.207 1187.41,932.346 1206.52,939.486 1225.62,946.625 1244.73,953.765 1263.83,960.904 1282.94,968.043 1302.04,975.183 1321.15,982.322 1340.26,989.462 1359.36,996.601 1378.47,1003.74 1397.57,1010.88 1416.68,1018.02 1435.78,1025.16 1454.89,1032.3 1474,1039.44 1493.1,1046.58 1512.21,1053.72 1531.31,1060.86 1550.42,1068 1569.52,1075.13 1588.63,1082.27 1607.74,1089.41 1626.84,1096.55 1645.95,1103.69 1665.05,1110.83 1684.16,1117.97 1703.26,1125.11 1722.37,1132.25 1741.48,1139.39 1760.58,1146.53 1779.69,1153.67 1798.79,1160.81 1817.9,1167.95 1837,1175.09 1856.11,1182.23 1875.22,1189.37 1894.32,1196.51 1913.43,1203.64 1932.53,1210.78 1951.64,1217.92 1970.74,1225.06 1989.85,1232.2 2008.96,1239.34 2028.06,1246.48 2047.17,1253.62 2066.27,1260.76 2085.38,1267.9 2104.48,1275.04 2123.59,1282.18 2142.69,1289.32 2161.8,1296.46 2180.91,1303.6 2200.01,1310.74 "></polyline>
<path clip-path="url(#clip270)" d="M1845.19 246.107 L2189.92 246.107 L2189.92 90.5872 L1845.19 90.5872  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1845.19,246.107 2189.92,246.107 2189.92,90.5872 1845.19,90.5872 1845.19,246.107 "></polyline>
<polyline clip-path="url(#clip270)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1867.47,142.427 2001.13,142.427 "></polyline>
<path clip-path="url(#clip270)" d="M2023.94 125.147 L2051.1 125.147 L2051.1 128.712 L2029.24 155.772 L2051.63 155.772 L2051.63 159.707 L2023.41 159.707 L2023.41 156.142 L2045.26 129.082 L2023.94 129.082 L2023.94 125.147 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M2056.42 125.147 L2083.57 125.147 L2083.57 128.712 L2061.72 155.772 L2084.11 155.772 L2084.11 159.707 L2055.89 159.707 L2055.89 156.142 L2077.74 129.082 L2056.42 129.082 L2056.42 125.147 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip270)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1867.47,194.267 2001.13,194.267 "></polyline>
<path clip-path="url(#clip270)" d="M2023.94 176.987 L2051.1 176.987 L2051.1 180.552 L2029.24 207.612 L2051.63 207.612 L2051.63 211.547 L2023.41 211.547 L2023.41 207.982 L2045.26 180.922 L2023.94 180.922 L2023.94 176.987 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M2056.42 176.987 L2083.57 176.987 L2083.57 180.552 L2061.72 207.612 L2084.11 207.612 L2084.11 211.547 L2055.89 211.547 L2055.89 207.982 L2077.74 180.922 L2056.42 180.922 L2056.42 176.987 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M2087.72 196.663 L2100.19 196.663 L2100.19 200.459 L2087.72 200.459 L2087.72 196.663 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M2133.04 179.649 L2133.04 184.58 Q2130.68 182.381 2127.99 181.293 Q2125.33 180.205 2122.32 180.205 Q2116.4 180.205 2113.25 183.839 Q2110.1 187.45 2110.1 194.302 Q2110.1 201.131 2113.25 204.765 Q2116.4 208.376 2122.32 208.376 Q2125.33 208.376 2127.99 207.288 Q2130.68 206.2 2133.04 204.001 L2133.04 208.885 Q2130.59 210.552 2127.83 211.385 Q2125.1 212.218 2122.05 212.218 Q2114.2 212.218 2109.68 207.427 Q2105.17 202.612 2105.17 194.302 Q2105.17 185.969 2109.68 181.177 Q2114.2 176.362 2122.05 176.362 Q2125.15 176.362 2127.88 177.196 Q2130.63 178.006 2133.04 179.649 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M2149.17 211.547 L2135.98 176.987 L2140.86 176.987 L2151.81 206.084 L2162.79 176.987 L2167.65 176.987 L2154.48 211.547 L2149.17 211.547 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
<p>これは換言すれば横軸が「ズルい」ということでもあるが，同時に <span class="math inline">\(n\to\infty\)</span> の極限では，圧倒的に ZZ-CV が効率的になるということでもある．<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
</section>
<section id="mala-との比較" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="mala-との比較"><span class="header-section-number">6</span> MALA との比較</h2>
<div id="b07e6c2e" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>MALA のセットアップ</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AdvancedHMC</span>, <span class="bu">AdvancedMH</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StructArrays</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LinearAlgebra</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> LogTargetDensity</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    y<span class="op">::</span><span class="dt">Vector{Float64}</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">U</span>(i, x, y)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    x[<span class="fl">1</span>] <span class="op">*</span> x[<span class="fl">1</span>] <span class="op">/</span> (<span class="fl">2</span> <span class="op">*</span> ρ <span class="op">*</span> ρ) <span class="op">+</span> <span class="fu">length</span>(y) <span class="op">*</span> (x[<span class="fl">1</span>] <span class="op">-</span> y[i]) <span class="op">*</span> (x[<span class="fl">1</span>] <span class="op">-</span> y[i]) <span class="op">/</span> (<span class="fl">2</span> <span class="op">*</span> σ <span class="op">*</span> σ)  <span class="co"># 自動微分のために x は長さ1のベクトルと扱う必要がある</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">U</span>(x, y)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    vec <span class="op">=</span> [<span class="fu">U</span>(i, x, y) for i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(y)]</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">mean</span>(vec)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(p<span class="op">::</span><span class="dt">LogTargetDensity</span>, x) <span class="op">=</span> <span class="fu">U</span>(x, p.y)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(p<span class="op">::</span><span class="dt">LogTargetDensity</span>) <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(<span class="op">::</span><span class="dt">Type{LogTargetDensity}</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>model_with_ad <span class="op">=</span> LogDensityProblemsAD.<span class="fu">ADgradient</span>(<span class="fu">Val</span>(<span class="op">:</span>ForwardDiff), <span class="fu">LogTargetDensity</span>(y1))</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co"># σ² = 0.1 # ほぼ横ばい</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co"># σ² = 0.5 # １回小さいエポック10で効率勝った＋全く横ばいになった</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>σ² <span class="op">=</span> <span class="fl">0.2</span>  <span class="co"># すごく良い感じ</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>spl <span class="op">=</span> <span class="fu">MALA</span>(x <span class="op">-&gt;</span> <span class="fu">MvNormal</span>((σ² <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> x, σ² <span class="op">*</span> I))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="dd1496b7" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>実験の実行</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">experiment_MALA</span>(epoch_list, N, y)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    SE_sum <span class="op">=</span> <span class="fu">zero</span>(epoch_list)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>N</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        chain <span class="op">=</span> <span class="fu">sample</span>(model_with_ad, spl, <span class="fu">Int64</span>(epoch_list[<span class="kw">end</span>]); initial_params<span class="op">=</span>[x0], chain_type<span class="op">=</span>StructArray, param_names<span class="op">=</span>[<span class="st">"x"</span>], stats<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        traj_MALA <span class="op">=</span> <span class="fu">Vector</span><span class="dt">{Float64}</span>(chain.x)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        SE_list <span class="op">=</span> []</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> T <span class="kw">in</span> epoch_list</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>            SE <span class="op">=</span> <span class="fu">SquaredError</span>(traj_MALA[<span class="fl">1</span><span class="op">:</span>T], y)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(SE_list, SE)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>        SE_sum <span class="op">+=</span> SE_list</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> SE_sum <span class="op">./</span> N</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>MSE_MALA <span class="op">=</span> <span class="fu">experiment_MALA</span>(<span class="fu">Vector</span><span class="dt">{Int64}</span>(epoch_list), N, y1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="71048b88" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>結果のプロット</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter!</span>(p, epoch_list, MSE_MALA,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    marker<span class="op">=:</span>circle,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    markersize<span class="op">=</span><span class="fl">5</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    markeralpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"blue"</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="cn">nothing</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="fu">DataFrame</span>(X <span class="op">=</span> <span class="fu">log10</span>.(epoch_list), Y <span class="op">=</span> <span class="fu">log10</span>.(MSE_MALA))</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">lm</span>(<span class="pp">@formula</span>(Y <span class="op">~</span> X), df)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>X_pred <span class="op">=</span> <span class="fu">range</span>(<span class="fu">minimum</span>(df.X), <span class="fu">maximum</span>(df.X), length<span class="op">=</span><span class="fl">100</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>Y_pred <span class="op">=</span> <span class="fu">predict</span>(model, <span class="fu">DataFrame</span>(X <span class="op">=</span> X_pred))</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(p, <span class="fl">10</span> <span class="op">.^</span> X_pred, <span class="fl">10</span> <span class="op">.^</span> Y_pred,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=:</span>solid,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    linewidth<span class="op">=</span><span class="fl">2</span>,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"blue"</span>,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">"MALA"</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(p)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="576" height="384" viewbox="0 0 2304 1536">
<defs>
  <clippath id="clip400">
    <rect x="0" y="0" width="2304" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip400)" d="M0 1536 L2304 1536 L2304 8.52651e-14 L0 8.52651e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip401">
    <rect x="460" y="0" width="1614" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip400)" d="M251.804 1347.54 L2256.76 1347.54 L2256.76 47.2441 L251.804 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip402">
    <rect x="251" y="47" width="2006" height="1301"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="939.036,1347.54 939.036,47.2441 "></polyline>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2200.01,1347.54 2200.01,47.2441 "></polyline>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,1347.54 2256.76,1347.54 "></polyline>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="939.036,1347.54 939.036,1328.64 "></polyline>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2200.01,1347.54 2200.01,1328.64 "></polyline>
<path clip-path="url(#clip400)" d="M904.809 1420.89 L912.448 1420.89 L912.448 1394.53 L904.137 1396.19 L904.137 1391.94 L912.401 1390.27 L917.077 1390.27 L917.077 1420.89 L924.716 1420.89 L924.716 1424.83 L904.809 1424.83 L904.809 1420.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M944.16 1393.35 Q940.549 1393.35 938.721 1396.91 Q936.915 1400.45 936.915 1407.58 Q936.915 1414.69 938.721 1418.25 Q940.549 1421.8 944.16 1421.8 Q947.795 1421.8 949.6 1418.25 Q951.429 1414.69 951.429 1407.58 Q951.429 1400.45 949.6 1396.91 Q947.795 1393.35 944.16 1393.35 M944.16 1389.64 Q949.97 1389.64 953.026 1394.25 Q956.105 1398.83 956.105 1407.58 Q956.105 1416.31 953.026 1420.92 Q949.97 1425.5 944.16 1425.5 Q938.35 1425.5 935.271 1420.92 Q932.216 1416.31 932.216 1407.58 Q932.216 1398.83 935.271 1394.25 Q938.35 1389.64 944.16 1389.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M960.675 1394.22 L973.934 1394.22 L973.934 1397.42 L956.105 1397.42 L956.105 1394.22 Q958.268 1391.98 961.992 1388.22 Q965.734 1384.44 966.693 1383.35 Q968.518 1381.3 969.233 1379.89 Q969.966 1378.46 969.966 1377.09 Q969.966 1374.85 968.386 1373.44 Q966.825 1372.03 964.305 1372.03 Q962.518 1372.03 960.525 1372.65 Q958.55 1373.27 956.293 1374.53 L956.293 1370.69 Q958.587 1369.77 960.581 1369.3 Q962.575 1368.83 964.23 1368.83 Q968.593 1368.83 971.189 1371.01 Q973.784 1373.19 973.784 1376.84 Q973.784 1378.57 973.126 1380.13 Q972.486 1381.68 970.775 1383.78 Q970.305 1384.33 967.784 1386.94 Q965.264 1389.54 960.675 1394.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M2164.47 1420.89 L2172.11 1420.89 L2172.11 1394.53 L2163.8 1396.19 L2163.8 1391.94 L2172.06 1390.27 L2176.74 1390.27 L2176.74 1420.89 L2184.38 1420.89 L2184.38 1424.83 L2164.47 1424.83 L2164.47 1420.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M2203.82 1393.35 Q2200.21 1393.35 2198.38 1396.91 Q2196.57 1400.45 2196.57 1407.58 Q2196.57 1414.69 2198.38 1418.25 Q2200.21 1421.8 2203.82 1421.8 Q2207.45 1421.8 2209.26 1418.25 Q2211.09 1414.69 2211.09 1407.58 Q2211.09 1400.45 2209.26 1396.91 Q2207.45 1393.35 2203.82 1393.35 M2203.82 1389.64 Q2209.63 1389.64 2212.69 1394.25 Q2215.76 1398.83 2215.76 1407.58 Q2215.76 1416.31 2212.69 1420.92 Q2209.63 1425.5 2203.82 1425.5 Q2198.01 1425.5 2194.93 1420.92 Q2191.88 1416.31 2191.88 1407.58 Q2191.88 1398.83 2194.93 1394.25 Q2198.01 1389.64 2203.82 1389.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M2228.44 1372.65 L2218.85 1387.64 L2228.44 1387.64 L2228.44 1372.65 M2227.44 1369.34 L2232.22 1369.34 L2232.22 1387.64 L2236.23 1387.64 L2236.23 1390.8 L2232.22 1390.8 L2232.22 1397.42 L2228.44 1397.42 L2228.44 1390.8 L2215.76 1390.8 L2215.76 1387.13 L2227.44 1369.34 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M1174.47 1490.1 L1174.47 1492.96 L1147.54 1492.96 Q1147.92 1499.01 1151.17 1502.19 Q1154.45 1505.34 1160.27 1505.34 Q1163.65 1505.34 1166.8 1504.52 Q1169.98 1503.69 1173.1 1502.03 L1173.1 1507.57 Q1169.95 1508.91 1166.64 1509.61 Q1163.33 1510.31 1159.92 1510.31 Q1151.39 1510.31 1146.4 1505.34 Q1141.43 1500.38 1141.43 1491.91 Q1141.43 1483.16 1146.14 1478.03 Q1150.88 1472.88 1158.91 1472.88 Q1166.1 1472.88 1170.27 1477.53 Q1174.47 1482.14 1174.47 1490.1 M1168.61 1488.38 Q1168.55 1483.57 1165.91 1480.71 Q1163.3 1477.84 1158.97 1477.84 Q1154.07 1477.84 1151.11 1480.61 Q1148.18 1483.38 1147.73 1488.41 L1168.61 1488.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M1189.75 1504.04 L1189.75 1522.94 L1183.86 1522.94 L1183.86 1473.74 L1189.75 1473.74 L1189.75 1479.15 Q1191.59 1475.97 1194.39 1474.44 Q1197.23 1472.88 1201.14 1472.88 Q1207.64 1472.88 1211.68 1478.03 Q1215.75 1483.19 1215.75 1491.59 Q1215.75 1500 1211.68 1505.15 Q1207.64 1510.31 1201.14 1510.31 Q1197.23 1510.31 1194.39 1508.78 Q1191.59 1507.22 1189.75 1504.04 M1209.67 1491.59 Q1209.67 1485.13 1207 1481.47 Q1204.36 1477.78 1199.71 1477.78 Q1195.06 1477.78 1192.39 1481.47 Q1189.75 1485.13 1189.75 1491.59 Q1189.75 1498.05 1192.39 1501.75 Q1195.06 1505.41 1199.71 1505.41 Q1204.36 1505.41 1207 1501.75 Q1209.67 1498.05 1209.67 1491.59 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M1239.27 1477.84 Q1234.56 1477.84 1231.82 1481.54 Q1229.09 1485.2 1229.09 1491.59 Q1229.09 1497.99 1231.79 1501.68 Q1234.53 1505.34 1239.27 1505.34 Q1243.95 1505.34 1246.69 1501.65 Q1249.43 1497.96 1249.43 1491.59 Q1249.43 1485.26 1246.69 1481.57 Q1243.95 1477.84 1239.27 1477.84 M1239.27 1472.88 Q1246.91 1472.88 1251.27 1477.84 Q1255.63 1482.81 1255.63 1491.59 Q1255.63 1500.35 1251.27 1505.34 Q1246.91 1510.31 1239.27 1510.31 Q1231.6 1510.31 1227.24 1505.34 Q1222.91 1500.35 1222.91 1491.59 Q1222.91 1482.81 1227.24 1477.84 Q1231.6 1472.88 1239.27 1472.88 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M1290.99 1475.11 L1290.99 1480.58 Q1288.51 1479.21 1286 1478.54 Q1283.51 1477.84 1280.97 1477.84 Q1275.27 1477.84 1272.12 1481.47 Q1268.97 1485.07 1268.97 1491.59 Q1268.97 1498.12 1272.12 1501.75 Q1275.27 1505.34 1280.97 1505.34 Q1283.51 1505.34 1286 1504.67 Q1288.51 1503.97 1290.99 1502.61 L1290.99 1508.02 Q1288.54 1509.16 1285.9 1509.74 Q1283.29 1510.31 1280.33 1510.31 Q1272.28 1510.31 1267.54 1505.25 Q1262.79 1500.19 1262.79 1491.59 Q1262.79 1482.87 1267.57 1477.88 Q1272.37 1472.88 1280.71 1472.88 Q1283.42 1472.88 1286 1473.45 Q1288.58 1473.99 1290.99 1475.11 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M1330.81 1487.87 L1330.81 1509.39 L1324.96 1509.39 L1324.96 1488.06 Q1324.96 1483 1322.98 1480.49 Q1321.01 1477.97 1317.06 1477.97 Q1312.32 1477.97 1309.58 1480.99 Q1306.84 1484.02 1306.84 1489.24 L1306.84 1509.39 L1300.96 1509.39 L1300.96 1459.86 L1306.84 1459.86 L1306.84 1479.28 Q1308.95 1476.06 1311.78 1474.47 Q1314.64 1472.88 1318.37 1472.88 Q1324.51 1472.88 1327.66 1476.7 Q1330.81 1480.49 1330.81 1487.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M1365.22 1474.79 L1365.22 1480.33 Q1362.74 1479.05 1360.06 1478.42 Q1357.39 1477.78 1354.52 1477.78 Q1350.16 1477.78 1347.97 1479.12 Q1345.8 1480.45 1345.8 1483.13 Q1345.8 1485.16 1347.36 1486.34 Q1348.92 1487.49 1353.63 1488.54 L1355.64 1488.98 Q1361.88 1490.32 1364.49 1492.77 Q1367.13 1495.19 1367.13 1499.55 Q1367.13 1504.52 1363.18 1507.41 Q1359.27 1510.31 1352.39 1510.31 Q1349.53 1510.31 1346.41 1509.74 Q1343.32 1509.19 1339.88 1508.08 L1339.88 1502.03 Q1343.13 1503.72 1346.28 1504.58 Q1349.43 1505.41 1352.52 1505.41 Q1356.66 1505.41 1358.88 1504.01 Q1361.11 1502.57 1361.11 1500 Q1361.11 1497.61 1359.49 1496.34 Q1357.9 1495.06 1352.46 1493.88 L1350.42 1493.41 Q1344.98 1492.26 1342.56 1489.91 Q1340.14 1487.52 1340.14 1483.38 Q1340.14 1478.35 1343.7 1475.62 Q1347.27 1472.88 1353.82 1472.88 Q1357.07 1472.88 1359.93 1473.36 Q1362.8 1473.83 1365.22 1474.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="251.804,927.245 2256.76,927.245 "></polyline>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="251.804,446.751 2256.76,446.751 "></polyline>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,1347.54 251.804,47.2441 "></polyline>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,927.245 270.702,927.245 "></polyline>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,446.751 270.702,446.751 "></polyline>
<path clip-path="url(#clip400)" d="M115.675 947.037 L123.314 947.037 L123.314 920.671 L115.003 922.338 L115.003 918.079 L123.267 916.412 L127.943 916.412 L127.943 947.037 L135.582 947.037 L135.582 950.972 L115.675 950.972 L115.675 947.037 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M155.026 919.491 Q151.415 919.491 149.587 923.056 Q147.781 926.597 147.781 933.727 Q147.781 940.833 149.587 944.398 Q151.415 947.94 155.026 947.94 Q158.661 947.94 160.466 944.398 Q162.295 940.833 162.295 933.727 Q162.295 926.597 160.466 923.056 Q158.661 919.491 155.026 919.491 M155.026 915.787 Q160.837 915.787 163.892 920.394 Q166.971 924.977 166.971 933.727 Q166.971 942.454 163.892 947.06 Q160.837 951.643 155.026 951.643 Q149.216 951.643 146.138 947.06 Q143.082 942.454 143.082 933.727 Q143.082 924.977 146.138 920.394 Q149.216 915.787 155.026 915.787 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M166.971 909.889 L191.082 909.889 L191.082 913.086 L166.971 913.086 L166.971 909.889 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M207.878 908.008 Q205.32 908.008 203.815 909.757 Q202.329 911.506 202.329 914.553 Q202.329 917.581 203.815 919.349 Q205.32 921.098 207.878 921.098 Q210.436 921.098 211.921 919.349 Q213.426 917.581 213.426 914.553 Q213.426 911.506 211.921 909.757 Q210.436 908.008 207.878 908.008 M215.42 896.102 L215.42 899.563 Q213.99 898.886 212.523 898.529 Q211.075 898.171 209.646 898.171 Q205.884 898.171 203.89 900.71 Q201.916 903.249 201.633 908.384 Q202.743 906.748 204.417 905.882 Q206.091 904.998 208.103 904.998 Q212.335 904.998 214.78 907.575 Q217.244 910.133 217.244 914.553 Q217.244 918.879 214.686 921.493 Q212.128 924.107 207.878 924.107 Q203.006 924.107 200.43 920.383 Q197.853 916.64 197.853 909.55 Q197.853 902.892 201.013 898.942 Q204.173 894.974 209.495 894.974 Q210.925 894.974 212.373 895.256 Q213.84 895.538 215.42 896.102 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M115.411 466.543 L123.05 466.543 L123.05 440.178 L114.74 441.845 L114.74 437.585 L123.004 435.919 L127.68 435.919 L127.68 466.543 L135.319 466.543 L135.319 470.479 L115.411 470.479 L115.411 466.543 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M154.763 438.997 Q151.152 438.997 149.323 442.562 Q147.518 446.104 147.518 453.233 Q147.518 460.34 149.323 463.905 Q151.152 467.446 154.763 467.446 Q158.397 467.446 160.203 463.905 Q162.032 460.34 162.032 453.233 Q162.032 446.104 160.203 442.562 Q158.397 438.997 154.763 438.997 M154.763 435.294 Q160.573 435.294 163.629 439.9 Q166.707 444.483 166.707 453.233 Q166.707 461.96 163.629 466.567 Q160.573 471.15 154.763 471.15 Q148.953 471.15 145.874 466.567 Q142.819 461.96 142.819 453.233 Q142.819 444.483 145.874 439.9 Q148.953 435.294 154.763 435.294 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M166.707 429.395 L190.819 429.395 L190.819 432.592 L166.707 432.592 L166.707 429.395 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M209.458 418.298 L199.866 433.288 L209.458 433.288 L209.458 418.298 M208.461 414.988 L213.238 414.988 L213.238 433.288 L217.244 433.288 L217.244 436.448 L213.238 436.448 L213.238 443.068 L209.458 443.068 L209.458 436.448 L196.781 436.448 L196.781 432.78 L208.461 414.988 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M18.4042 761.509 L18.4042 751.929 L50.7419 739.802 L18.4042 727.612 L18.4042 718.031 L65.9242 718.031 L65.9242 724.301 L24.197 724.301 L56.7894 736.555 L56.7894 743.017 L24.197 755.271 L65.9242 755.271 L65.9242 761.509 L18.4042 761.509 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M19.9638 676.781 L26.234 676.781 Q24.4834 680.442 23.624 683.688 Q22.7647 686.935 22.7647 689.958 Q22.7647 695.21 24.8017 698.075 Q26.8387 700.907 30.5945 700.907 Q33.7455 700.907 35.3688 699.03 Q36.9602 697.12 37.9469 691.836 L38.7426 687.953 Q40.1112 680.76 43.5805 677.354 Q47.018 673.917 52.8108 673.917 Q59.7176 673.917 63.2824 678.564 Q66.8472 683.179 66.8472 692.123 Q66.8472 695.497 66.0833 699.316 Q65.3194 703.104 63.8235 707.178 L57.2031 707.178 Q59.3993 703.263 60.5133 699.507 Q61.6273 695.751 61.6273 692.123 Q61.6273 686.616 59.463 683.625 Q57.2986 680.633 53.2882 680.633 Q49.7871 680.633 47.8137 682.797 Q45.8404 684.929 44.8537 689.831 L44.0898 693.746 Q42.6575 700.939 39.602 704.154 Q36.5464 707.369 31.1037 707.369 Q24.8017 707.369 21.1732 702.944 Q17.5448 698.488 17.5448 690.69 Q17.5448 687.348 18.1495 683.879 Q18.7543 680.41 19.9638 676.781 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M18.4042 663.891 L18.4042 633.845 L23.815 633.845 L23.815 657.461 L37.8832 657.461 L37.8832 634.831 L43.2941 634.831 L43.2941 657.461 L60.5133 657.461 L60.5133 633.272 L65.9242 633.272 L65.9242 663.891 L18.4042 663.891 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><circle clip-path="url(#clip402)" cx="308.548" cy="258.247" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip402)" cx="939.036" cy="496.221" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip402)" cx="1569.52" cy="740.135" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip402)" cx="2200.01" cy="964.478" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<polyline clip-path="url(#clip402)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="308.548,260.379 327.654,267.539 346.759,274.698 365.865,281.858 384.971,289.017 404.076,296.176 423.182,303.336 442.288,310.495 461.393,317.655 480.499,324.814 499.605,331.973 518.711,339.133 537.816,346.292 556.922,353.452 576.028,360.611 595.133,367.771 614.239,374.93 633.345,382.089 652.45,389.249 671.556,396.408 690.662,403.568 709.768,410.727 728.873,417.886 747.979,425.046 767.085,432.205 786.19,439.365 805.296,446.524 824.402,453.683 843.507,460.843 862.613,468.002 881.719,475.162 900.825,482.321 919.93,489.481 939.036,496.64 958.142,503.799 977.247,510.959 996.353,518.118 1015.46,525.278 1034.56,532.437 1053.67,539.596 1072.78,546.756 1091.88,553.915 1110.99,561.075 1130.09,568.234 1149.2,575.394 1168.3,582.553 1187.41,589.712 1206.52,596.872 1225.62,604.031 1244.73,611.191 1263.83,618.35 1282.94,625.509 1302.04,632.669 1321.15,639.828 1340.26,646.988 1359.36,654.147 1378.47,661.307 1397.57,668.466 1416.68,675.625 1435.78,682.785 1454.89,689.944 1474,697.104 1493.1,704.263 1512.21,711.422 1531.31,718.582 1550.42,725.741 1569.52,732.901 1588.63,740.06 1607.74,747.22 1626.84,754.379 1645.95,761.538 1665.05,768.698 1684.16,775.857 1703.26,783.017 1722.37,790.176 1741.48,797.335 1760.58,804.495 1779.69,811.654 1798.79,818.814 1817.9,825.973 1837,833.133 1856.11,840.292 1875.22,847.451 1894.32,854.611 1913.43,861.77 1932.53,868.93 1951.64,876.089 1970.74,883.248 1989.85,890.408 2008.96,897.567 2028.06,904.727 2047.17,911.886 2066.27,919.046 2085.38,926.205 2104.48,933.364 2123.59,940.524 2142.69,947.683 2161.8,954.843 2180.91,962.002 2200.01,969.161 "></polyline>
<circle clip-path="url(#clip402)" cx="308.548" cy="682.832" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip402)" cx="939.036" cy="929.405" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip402)" cx="1569.52" cy="1127.1" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip402)" cx="2200.01" cy="1290.75" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<polyline clip-path="url(#clip402)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="308.548,704.306 327.654,710.431 346.759,716.557 365.865,722.682 384.971,728.808 404.076,734.934 423.182,741.059 442.288,747.185 461.393,753.31 480.499,759.436 499.605,765.561 518.711,771.687 537.816,777.812 556.922,783.938 576.028,790.064 595.133,796.189 614.239,802.315 633.345,808.44 652.45,814.566 671.556,820.691 690.662,826.817 709.768,832.942 728.873,839.068 747.979,845.194 767.085,851.319 786.19,857.445 805.296,863.57 824.402,869.696 843.507,875.821 862.613,881.947 881.719,888.072 900.825,894.198 919.93,900.324 939.036,906.449 958.142,912.575 977.247,918.7 996.353,924.826 1015.46,930.951 1034.56,937.077 1053.67,943.202 1072.78,949.328 1091.88,955.454 1110.99,961.579 1130.09,967.705 1149.2,973.83 1168.3,979.956 1187.41,986.081 1206.52,992.207 1225.62,998.333 1244.73,1004.46 1263.83,1010.58 1282.94,1016.71 1302.04,1022.83 1321.15,1028.96 1340.26,1035.09 1359.36,1041.21 1378.47,1047.34 1397.57,1053.46 1416.68,1059.59 1435.78,1065.71 1454.89,1071.84 1474,1077.96 1493.1,1084.09 1512.21,1090.22 1531.31,1096.34 1550.42,1102.47 1569.52,1108.59 1588.63,1114.72 1607.74,1120.84 1626.84,1126.97 1645.95,1133.09 1665.05,1139.22 1684.16,1145.35 1703.26,1151.47 1722.37,1157.6 1741.48,1163.72 1760.58,1169.85 1779.69,1175.97 1798.79,1182.1 1817.9,1188.22 1837,1194.35 1856.11,1200.48 1875.22,1206.6 1894.32,1212.73 1913.43,1218.85 1932.53,1224.98 1951.64,1231.1 1970.74,1237.23 1989.85,1243.35 2008.96,1249.48 2028.06,1255.61 2047.17,1261.73 2066.27,1267.86 2085.38,1273.98 2104.48,1280.11 2123.59,1286.23 2142.69,1292.36 2161.8,1298.48 2180.91,1304.61 2200.01,1310.74 "></polyline>
<circle clip-path="url(#clip402)" cx="308.548" cy="233.046" r="18" fill="#0000ff" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip402)" cx="939.036" cy="134.554" r="18" fill="#0000ff" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip402)" cx="1569.52" cy="173.087" r="18" fill="#0000ff" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip402)" cx="2200.01" cy="84.0448" r="18" fill="#0000ff" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<polyline clip-path="url(#clip402)" style="stroke:#0000ff; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="308.548,217.453 327.654,216.215 346.759,214.978 365.865,213.74 384.971,212.502 404.076,211.264 423.182,210.027 442.288,208.789 461.393,207.551 480.499,206.313 499.605,205.075 518.711,203.838 537.816,202.6 556.922,201.362 576.028,200.124 595.133,198.886 614.239,197.649 633.345,196.411 652.45,195.173 671.556,193.935 690.662,192.698 709.768,191.46 728.873,190.222 747.979,188.984 767.085,187.746 786.19,186.509 805.296,185.271 824.402,184.033 843.507,182.795 862.613,181.557 881.719,180.32 900.825,179.082 919.93,177.844 939.036,176.606 958.142,175.369 977.247,174.131 996.353,172.893 1015.46,171.655 1034.56,170.417 1053.67,169.18 1072.78,167.942 1091.88,166.704 1110.99,165.466 1130.09,164.228 1149.2,162.991 1168.3,161.753 1187.41,160.515 1206.52,159.277 1225.62,158.04 1244.73,156.802 1263.83,155.564 1282.94,154.326 1302.04,153.088 1321.15,151.851 1340.26,150.613 1359.36,149.375 1378.47,148.137 1397.57,146.899 1416.68,145.662 1435.78,144.424 1454.89,143.186 1474,141.948 1493.1,140.71 1512.21,139.473 1531.31,138.235 1550.42,136.997 1569.52,135.759 1588.63,134.522 1607.74,133.284 1626.84,132.046 1645.95,130.808 1665.05,129.57 1684.16,128.333 1703.26,127.095 1722.37,125.857 1741.48,124.619 1760.58,123.381 1779.69,122.144 1798.79,120.906 1817.9,119.668 1837,118.43 1856.11,117.193 1875.22,115.955 1894.32,114.717 1913.43,113.479 1932.53,112.241 1951.64,111.004 1970.74,109.766 1989.85,108.528 2008.96,107.29 2028.06,106.052 2047.17,104.815 2066.27,103.577 2085.38,102.339 2104.48,101.101 2123.59,99.8635 2142.69,98.6258 2161.8,97.388 2180.91,96.1502 2200.01,94.9124 "></polyline>
<path clip-path="url(#clip400)" d="M1845.19 297.947 L2189.92 297.947 L2189.92 90.5872 L1845.19 90.5872  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1845.19,297.947 2189.92,297.947 2189.92,90.5872 1845.19,90.5872 1845.19,297.947 "></polyline>
<polyline clip-path="url(#clip400)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1867.47,142.427 2001.13,142.427 "></polyline>
<path clip-path="url(#clip400)" d="M2023.94 125.147 L2051.1 125.147 L2051.1 128.712 L2029.24 155.772 L2051.63 155.772 L2051.63 159.707 L2023.41 159.707 L2023.41 156.142 L2045.26 129.082 L2023.94 129.082 L2023.94 125.147 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M2056.42 125.147 L2083.57 125.147 L2083.57 128.712 L2061.72 155.772 L2084.11 155.772 L2084.11 159.707 L2055.89 159.707 L2055.89 156.142 L2077.74 129.082 L2056.42 129.082 L2056.42 125.147 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip400)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1867.47,194.267 2001.13,194.267 "></polyline>
<path clip-path="url(#clip400)" d="M2023.94 176.987 L2051.1 176.987 L2051.1 180.552 L2029.24 207.612 L2051.63 207.612 L2051.63 211.547 L2023.41 211.547 L2023.41 207.982 L2045.26 180.922 L2023.94 180.922 L2023.94 176.987 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M2056.42 176.987 L2083.57 176.987 L2083.57 180.552 L2061.72 207.612 L2084.11 207.612 L2084.11 211.547 L2055.89 211.547 L2055.89 207.982 L2077.74 180.922 L2056.42 180.922 L2056.42 176.987 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M2087.72 196.663 L2100.19 196.663 L2100.19 200.459 L2087.72 200.459 L2087.72 196.663 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M2133.04 179.649 L2133.04 184.58 Q2130.68 182.381 2127.99 181.293 Q2125.33 180.205 2122.32 180.205 Q2116.4 180.205 2113.25 183.839 Q2110.1 187.45 2110.1 194.302 Q2110.1 201.131 2113.25 204.765 Q2116.4 208.376 2122.32 208.376 Q2125.33 208.376 2127.99 207.288 Q2130.68 206.2 2133.04 204.001 L2133.04 208.885 Q2130.59 210.552 2127.83 211.385 Q2125.1 212.218 2122.05 212.218 Q2114.2 212.218 2109.68 207.427 Q2105.17 202.612 2105.17 194.302 Q2105.17 185.969 2109.68 181.177 Q2114.2 176.362 2122.05 176.362 Q2125.15 176.362 2127.88 177.196 Q2130.63 178.006 2133.04 179.649 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M2149.17 211.547 L2135.98 176.987 L2140.86 176.987 L2151.81 206.084 L2162.79 176.987 L2167.65 176.987 L2154.48 211.547 L2149.17 211.547 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip400)" style="stroke:#0000ff; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1867.47,246.107 2001.13,246.107 "></polyline>
<path clip-path="url(#clip400)" d="M2023.41 228.827 L2030.38 228.827 L2039.2 252.346 L2048.06 228.827 L2055.03 228.827 L2055.03 263.387 L2050.47 263.387 L2050.47 233.04 L2041.56 256.744 L2036.86 256.744 L2027.95 233.04 L2027.95 263.387 L2023.41 263.387 L2023.41 228.827 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M2075.87 233.434 L2069.52 250.633 L2082.23 250.633 L2075.87 233.434 M2073.23 228.827 L2078.53 228.827 L2091.7 263.387 L2086.84 263.387 L2083.69 254.521 L2068.11 254.521 L2064.96 263.387 L2060.03 263.387 L2073.23 228.827 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M2096.74 228.827 L2101.42 228.827 L2101.42 259.452 L2118.25 259.452 L2118.25 263.387 L2096.74 263.387 L2096.74 228.827 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M2135.8 233.434 L2129.45 250.633 L2142.16 250.633 L2135.8 233.434 M2133.16 228.827 L2138.46 228.827 L2151.63 263.387 L2146.77 263.387 L2143.62 254.521 L2128.04 254.521 L2124.89 263.387 L2119.96 263.387 L2133.16 228.827 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
</section>
<section id="非一様な部分サンプリング" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="非一様な部分サンプリング"><span class="header-section-number">7</span> 非一様な部分サンプリング</h2>
<p>当然，必ずしも一様な分解 <span class="math display">\[
U(x)=\frac{1}{n}\sum_{j=1}^nU^j(x)
\]</span> に基づいた一様なサブサンプリング <span class="math inline">\(K\sim\mathrm{U}([n])\)</span> を行う必要はない．</p>
<p>剪定の手続きを棄却法とみると，重点サンプリングのアイデアを導入することで制御変数に依らない分散低減が狙える <span class="citation" data-cites="Sen+2020">(<a href="#ref-Sen+2020" role="doc-biblioref">Sen et al., 2020</a> importance subsampling strategy)</span>．</p>
<p>特に，比例的高次元極限や，不均衡データに対する<a href="../../../posts/2024/Stat/Logistic.html">ロジスティック回帰</a>では，事後分布が十分な集中性を持たないために制御変数の方法 <a href="#sec-ZZ-CV" class="quarto-xref">3</a> が十分な効率改善を示さないが，この重点サブサンプリングによれば効率の改善が見込める．</p>
<p>詳しくは，次稿参照：</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Stat/Logistic2.html" target="_blank">
            <img src="https://162348.github.io/posts/2024/Stat/Logistic2.svg" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">大規模な不均衡データに対するロジスティック回帰（後編）</h3>
                <p class="article-description">離散時間 MCMC から連続時間 MCMC へ</p>
            </div>
        </a>
    </div>
</div>




</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Andrieu-Livingstone2021" class="csl-entry" role="listitem">
Andrieu, C., and Livingstone, S. (2021). <a href="https://doi.org/10.1214/20-AOS2008"><span class="nocase">Peskun–Tierney ordering for Markovian Monte Carlo: Beyond the reversible scenario</span></a>. <em>The Annals of Statistics</em>, <em>49</em>(4), 1958–1981.
</div>
<div id="ref-Bierkens+2019" class="csl-entry" role="listitem">
Bierkens, J., Fearnhead, P., and Roberts, G. (2019). <a href="https://doi.org/10.1214/18-AOS1715"><span class="nocase">The Zig-Zag Process and Super-Efficient Sampling for Bayesian Analysis of Big Data</span></a>. <em>The Annals of Statistics</em>, <em>47</em>(3), 1288–1320.
</div>
<div id="ref-Fearnhead+2018-PDMC" class="csl-entry" role="listitem">
Fearnhead, P., Bierkens, J., Pollock, M., and Roberts, G. O. (2018). <a href="https://www.jstor.org/stable/26771007">Piecewise deterministic markov processes for continuous-time monte carlo</a>. <em>Statistical Science</em>, <em>33</em>(3), 386–412.
</div>
<div id="ref-Johnson1970" class="csl-entry" role="listitem">
Johnson, R. A. (1970). <a href="http://www.jstor.org/stable/2239239">Asymptotic expansions associated with posterior distributions</a>. <em>The Annals of Mathematical Statistics</em>, <em>41</em>(3), 851–864.
</div>
<div id="ref-Murphy2023" class="csl-entry" role="listitem">
Murphy, K. P. (2023). <em><a href="http://probml.github.io/book2">Probabilistic machine learning: Advanced topics</a></em>. MIT Press.
</div>
<div id="ref-Sen+2020" class="csl-entry" role="listitem">
Sen, D., Sachs, M., Lu, J., and Dunson, D. B. (2020). <a href="https://doi.org/10.1093/biomet/asaa035"><span class="nocase">Efficient posterior sampling for high-dimensional imbalanced logistic regression</span></a>. <em>Biometrika</em>, <em>107</em>(4), 1005–1012.
</div>
<div id="ref-Vasdekis2021" class="csl-entry" role="listitem">
Vasdekis, G. (2021). <em>On zig-zag extensions and related ergodicity properties</em> (PhD thesis). University of Warwick. Retrieved from <a href="http://webcat.warwick.ac.uk/record=b3714913">http://webcat.warwick.ac.uk/record=b3714913</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>この２点が両方肝心である．効率的なサブサンプリング推定量の開発が <span class="citation" data-cites="Fearnhead+2018-PDMC">(<a href="#ref-Fearnhead+2018-PDMC" role="doc-biblioref">Fearnhead et al., 2018</a>)</span> 以来議論の焦点になっている．<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><span class="citation" data-cites="Vasdekis2021">(<a href="#ref-Vasdekis2021" role="doc-biblioref">Vasdekis, 2021, p. 25</a>)</span> や <span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens et al., 2019, pp. 1302 定理4.1</a>)</span> も参照．<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens et al., 2019, pp. 1306–</a>)</span> 第5.1節参照．<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>実装は <code>ZigZagBoomerang</code> パッケージの <a href="https://github.com/mschauer/ZigZagBoomerang.jl/blob/master/src/zigzagboom1d.jl"><code>zigzagboom1d.jl</code></a> を参考にした．<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>ただし，例えば今回も計算時間で言えば長くなっていることに注意．<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/162348\.github\.io\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
        for (let i=0; i<annoteTargets.length; i++) {
          const annoteTarget = annoteTargets[i];
          const targetCell = annoteTarget.getAttribute("data-target-cell");
          const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
          const contentFn = () => {
            const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            if (content) {
              const tipContent = content.cloneNode(true);
              tipContent.classList.add("code-annotation-tip-content");
              return tipContent.outerHTML;
            }
          }
          const config = {
            allowHTML: true,
            content: contentFn,
            onShow: (instance) => {
              selectCodeLines(instance.reference);
              instance.reference.classList.add('code-annotation-active');
              window.tippy.hideAll();
            },
            onHide: (instance) => {
              unselectCodeLines();
              instance.reference.classList.remove('code-annotation-active');
            },
            maxWidth: 300,
            delay: [50, 0],
            duration: [200, 0],
            offset: [5, 10],
            arrow: true,
            trigger: 'click',
            appendTo: function(el) {
              return el.parentElement.parentElement.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'quarto',
            placement: 'right',
            positionFixed: true,
            popperOptions: {
              modifiers: [
              {
                name: 'flip',
                options: {
                  flipVariations: false, // true by default
                  allowedAutoPlacements: ['right'],
                  fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                },
              },
              {
                name: 'preventOverflow',
                options: {
                  mainAxis: false,
                  altAxis: false
                }
              }
              ]        
            }      
          };
          window.tippy(annoteTarget, config); 
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
<script>
  function loadGiscus() {
    // Function to get the theme based on body class
    const getTheme = () => {
      let baseTheme = document.getElementById('giscus-base-theme').value;
      let altTheme = document.getElementById('giscus-alt-theme').value;
      return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
    };
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "162348/162348.github.io";
    script.dataset.repoId = "R_kgDOKlfKYQ";
    script.dataset.category = "Announcements";
    script.dataset.categoryId = "DIC_kwDOKlfKYc4CgDmb";
    script.dataset.mapping = "pathname";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "top";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  }
  loadGiscus();
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://162348.github.io/">
<p>Hirofumi Shiba</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/162348/162348.github.io/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ano2math5">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:shiba.hirofumi@ism.ac.jp">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../../blog.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>