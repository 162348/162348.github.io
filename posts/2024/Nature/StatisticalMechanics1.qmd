---
title: "数学者のための統計力学１"
subtitle: Ising 模型
author: "司馬博文"
date: 4/7/2024
categories: [Nature, Deep]
bibliography: 
    - ../../../mathematics.bib
    - ../../../bib.bib
csl: ../../../apa.csl
abstract-title: 概要
abstract: 数学者のために，統計力学の場面設定を数学的に理解することを試みる．統計力学の最も代表的なモデルである Ising 模型の数理も概観する．
---
---

{{< include ../../../_preamble.qmd >}}

普通数学者がやらないことであるが，古典粒子系を例にとって，統計力学における基本的な用語を確認する．

統計力学といえども場面設定は力学であり，その形式はハミルトン形式が利用される．

しかし，その運動方程式を解析的に分析するのではなく，相空間 $\Om$ 上の（有界）測度に注目して，確率統計学，果てには計算統計学を利用して展開していく．

ちょうど，統計学ではここのサンプル $\om\in\Om$ よりも全体的な振る舞い $P\in\cP(\Om)$ や統計量 $\Om\to\R$ の平均値や分散などの統計的な振る舞いに興味があるのと同じことである．

## 古典粒子系

### 多様体 $\Om_{\Lambda,N}$

有界集合 $\Lambda\subset\R^3$ に囚われた古典的な $N$ 粒子系を考えると，位置と速度によって各粒子は記述できるから，
$$
\Om_{\Lambda,N}:=(\Lambda\times\R^3)^N
$$
内の点によって系が記述できる．これを **相空間** (phase space) という．^[すなわち，$\Lambda$ 上の線型束である．]

### 関数 $H_{\Lambda,N}$

この上に **エネルギー** が定まるが，これは **ハミルトニアン** ともいう：^[$V$ は境界ポテンシャルといい，外場との相互作用がある場合に現れる．]
$$
\begin{align*}
    H_{\Lambda,N}(Q,V)&=\sum_{i=1}^N\frac{mv_i^2}{2}+\sum_{i<j\in[N]}U(q_i-q_j)\\
    &\qquad\qquad+\sum_{i=1}^NV_b(q_i)
\end{align*}
$$
$$
Q=(q_1,\cdots,q_N)\in\Lambda^{3N}
$$

多くの場合，ポテンシャル関数 $U$ はコンパクト台を持つ，すなわち，**相互作用半径** (radius of interaction) $R$ をもつとする：$\supp U\subset U_R(0)$．^[これは粒子間相互作用が short-range であると仮定しているためである．重力やクーロン力を考えている訳ではない．]

経験則的に，まずは Lennard-Jones ポテンシャル
$$
U(r)=\frac{A}{r^{12}}-\frac{B}{r^6}\quad A,B>0
$$
を用いてモデリングする場合が多い．

系の時間発展は変換の族 $\{S_t\}\subset\Aut(\Om_{\Lambda,N})$ （**動力学** dynamics という）によって記述され，
動力学は運動方程式から導出される．
$$
\dd{q_i}{t}=v_i
$$
$$
m\dd{v_i}{t}=-\sum_{i\ne j}\nabla U(q_j-q_i)-\nabla V_b(q_i)
$$

### 部分多様体 $\Om_{\Lambda,N,E}$ と小正準分布 {#sec-microcanonical}

この動力学 $\{S_t\}$ は体積とエネルギーを保存量にもつ．すなわち，各 $S_t$ は保測的で，等エネルギー集合
$$
\Om_{\Lambda,N,E}:=\Brace{(Q,\Lambda)\in\Om_{\Lambda,N}\mid H_{\Lambda,N}(Q,\Lambda)=E}
$$
を不変部分集合にもつ．

$\Om_{\Lambda,N,E}$ 上の測度
$$
\nu_{\Lambda,N,E}(B):=\lim_{\Delta E\to0}\frac{\ell(\Delta B)}{\Delta E}
$$
は $S_t$ によって保存される．^[[@Petersen1983 p.6] 命題2.2．] これを **小正準分布** (microcanonical measures) または Gelfand-Leray measures という．

ただし，$\Delta B$ は $x\in B$ から始まった $\Om_{\Lambda,N,E}$ の法線（面）で，$\Om_{\Lambda,N,E+\Delta E}$ との交点で終わる線分の $x\in B$ に関する合併である．

他にも，等位集合が $S_t$ によって保存される関数 $I_i:\Om_{\Lambda,N}\to\R$ は存在し得て，その場合は全ての合併 $\Om_{\Lambda,N,E,I_1,\cdots,I_k}$ 上に小正準分布が遺伝する．

### エルゴード仮説

Boltzman のエルゴード仮説は，他の積分 $I_i$ が存在しない場合，$\Om_{\Lambda,N,E}$ 上の $S_t$-不変で $\nu_{\Lambda,N,E}$-絶対連続な測度は，$\nu_{\Lambda,N,E}$ の定数倍に限る，というものである．

これにより，特定の系が運動 $S_t$ によって平衡状態に至った際，相空間上を旅する際に特定の状態が現れる頻度分布は，必ず小正準分布に一致することが帰結される．

### configuration gas

もし粒子が全て動いていないならば，相空間は $\R^{3N}=:\Om_{\Lambda,N}^{\text{conf}}$ で良い．

これを **configuration gas** といい，古典粒子系の更なる理想化に当たる．

## 格子模型

一部は実際の物理系の良いモデルとなっているが，より複雑なモデルの統計物理学的性質の良い第一近似としても用いられる．

加えて，このような離散的なグラフとしての表現を通じて，機械学習や情報科学との関わりを持つ．そのような分野は情報統計力学と呼ばれる [@西森秀稔2003]．^[[統数研プロジェクト紹介](https://www.ism.ac.jp/ism_info_j/labo/project/156.html) も参照．]

### 格子気体

configuration gas から更なるモデルの簡略化を考える．

粒子の位置は必ず格子点上にあるとすれば，配置空間はさらに $\Lambda\subset\bZ^3$ に対して
$$
\begin{align*}
    &\Om_{\Lambda,N}=\\
    &\Brace{Q=(q_1,\cdots,q_N)\in\Lambda^N\mid q_i\ne q_j\;(i\ne j)}
\end{align*}
$$
と簡略化される．

仮に外場もないとすると，ハミルトニアンは単にポテンシャルの和
$$
H(Q)=\sum_{i<j}U(q_i-q_j)
$$
となる．

### スピン系

有限集合 $\Lambda\subset\bZ^3$ が粒子で満ちているとすると，配置空間は縮退する．

その際のスピン系の相空間は，関数の集合
$$
\Om_\Lambda:=S^\Lambda
$$
になる．

$S=\partial U_1(0)\subset\R^3$ の場合を **平面回転子** (planar rotator) モデルという．^[[古典 Heisenberg 模型](https://ja.wikipedia.org/wiki/%E5%8F%A4%E5%85%B8%E3%83%8F%E3%82%A4%E3%82%BC%E3%83%B3%E3%83%99%E3%83%AB%E3%82%AF%E6%A8%A1%E5%9E%8B) はその例である．] $S=\{\pm1\}$ としても（Ising spin），^[[@西森秀稔2003 p.4]．情報統計力学では，スピンをビットやニューロンの状態に見立てる．] 物理系のモデルとして磁性体の第一近似として使える模型になる．

ハミルトニアンは，相互作用と外場の和として
$$
H_\Lambda(\sigma)=\sum_{x\ne y\in\Lambda}U(x-y)\sigma(x)\sigma(y)+h\sum_{x\in\Lambda}\sigma(x)
$$
と与えられる．

#### Ising 模型

関数 $U$ が $U_1(0)\cap\bZ^3$ を台に持つ場合を（狭義の） **Ising 模型** といい，$U$ は $J$ でも表す：^[[@Baxter1982 p.21] では nearest-neighbour Ising model と呼んでいる．]
$$
H_\Lambda(\sigma)=-J_{x,y}\sum_{\abs{x-y}=1}\sigma(x)\sigma(y)-h\sum_{x\in\Lambda}\sigma(x)
$$

$J_{x,y}>0$ である場合，低温秩序相は強磁性体のモデルになっている．$J_{x,y}\equiv J$ という定値性の仮定もよく置かれる．

#### Curie-Weiss 模型

この最近傍 Ising 模型に，Weiss 近似という平均場近似を施し，Curie-Weiss Hamiltonian
$$
H_{\Lambda}(\sigma)=-\frac{dJ}{\abs{\Gamma}}\sum_{x\ne y\in\Lambda}\sigma(x)\sigma(y)-h\sum_{x\in\Lambda}\sigma(x)
$$
を用いる模型を [Curie-Weiss 模型](../Computation/PGM2.qmd#sec-Curie-Weiss) という．

相互作用がもはや最近傍同士ではなくなっている．これを **無限レンジ模型** ともいう [@西森秀稔2003 p.24]．

この式からは，各スピンが，具体的な他のスピンと相互作用するというより，全ての他スピンからなる平均場（**有効磁場**）と相互作用していると読める．^[無限レンジの仮定をおくと，平均場近似は近似でなくなる，という論理的依存関係がある [@西森秀稔2003 p.26]．]

このような平均場近似を施していても，低温の強磁性相と高温の常磁性相が別れることが観察される [@Friedli-Velenik2017 p.62]．

### スピングラス

$J_{x,y}$ の符号がバラバラである場合，これをスピングラスの模型という．^[[@Mezard-Montanari2009 p.168] [@西森秀稔2003 p.16] など．スピングラスはもともと B. Coles が希薄合金の磁性を表現するために造語したが，現在は「全くランダムな状態でスピンが凍結した状態」という意味で使われるようになている [@都福仁1977]．]

このような模型では，低音秩序相が消えて，スピンがバラバラである状態（スピングラス相）も安定たり得ることがわかっている．

特に，安定な状態が複数存在し，温度を少し変えるだけで全く性質の異なる別の状態へ系が移ることもよくある．自由エネルギーが強い多峰性を示すのである．

![[最終講義 スピングラスと計算物性物理](https://ocw.u-tokyo.ac.jp/lecture_files/issp_02/1/notes/ja/takayama-lecture.pdf) p.28](SG.png)

CuMn などはスピン間の相互作用が，RKKY (Ruderman-Kittel-Kazuya-Yoshida) 相互作用
$$
J\propt\frac{\cos(2k_Fr_{12})}{r_{12}^3}
$$
により表され，これは符号が分子の $\cos$ により正にも負にもなり得る．

AuFe もスピングラスである [@Cannella-Mydosh1972]．^[Mydosh による講演が，髙山一氏のスピングラス研究の発端となったという（[最終講義](https://ocw.u-tokyo.ac.jp/lecture_files/issp_02/1/notes/ja/takayama-lecture.pdf)）．]

#### Edwards-Anderson 模型 [@Edwards-Anderson1975]

$(J_{x,y})_{\abs{x-y}=1}$ を，グラフのエッジの集合上に定義された独立な Gauss 確率場とし，外場を考えないものを，**Edwards-Anderson 模型** という：
$$
H(\sigma)=-\sum_{\abs{x-y}=1}J_{x,y}\sigma(x)\sigma(y).
$$

確率変数 $J_{x,y}\sim\rN_1(0,N)$ の平均（配位平均）と，アンサンブル平均という２つの平均を扱う必要がある点で極めて難しい模型となっている．

この模型において自由エネルギーを計算するために，分配関数の対数の平均を，分配関数の積率によって計算する
$$
\E[\log Z]=\lim_{n\to\infty}\frac{\E[Z^n]-1}{n}
$$
という関係式を用いた．これを **レプリカ法** という．ただし，期待値は $J_{x,y}$ に関するもので，アンサンブル平均 $\brac{-}$ とは関係ないことに注意．

現状，特に Talagrand はレプリカ法の数学的妥当性について極めて懐疑的であるが，多くは数値実験により検証されており，何らかの本質を捉えていることは間違いない．^[[@田中利幸2007]]

#### Sherrington-Kirkpatrick 模型 [@Sherrington-Kirkpatrick1975]

EA 模型を無限レンジにすることで，平均場近似が厳密解を与えるようにし，熱力学極限
$$
\lim_{N\to\infty}\frac{\E[\log Z_N]}{N}
$$
を与えることでこれを解いたものである．その際にもレプリカ法が用いられた．

著者のうちの Scott Kirkpatrick は [擬似アニーリング](../../Surveys/SMCSamplers.qmd#sec-SA) [@Kirkpartick+1983] の開発者でもある．

しかしこの解（レプリカ対称な解）は初め低温域では破綻を起こすとされていた．[@Parisi1980] がこの問題を解決し，任意の温度 $T>0$ での厳密解（レプリカ対称性破れ解）が得られた．これは Parisi ansatz と呼ばれる．^[[@Panchenko2012] も参照．] この解は計算機シミュレーションと高い精度で一致し，常磁性相と強磁性相に加えて，スピングラス相を示す．

Parisi はこの業績で 2021 年にノーベル物理学賞を受賞した．その３番目に多く引用されている論文 [@Marinari-Parisi1992] は [**擬似テンパリング**](../../Surveys/SMCSamplers.qmd#sec-ST) の提案論文である．

#### Thouless-Anderson-Plamer 方程式 [@Thouless+1977] と近似メッセージ伝播 [@Bolthausen2014]

一方で，SK 模型に対して高温摂動展開により自由エネルギーを与えるアプローチもある．

特に，熱力学極限に向かって漸近的に成り立つ次の方程式を TAP 方程式という：
$$
\brac{\sigma_i}\approx\tanh\paren{\frac{\beta}{\sqrt{N}}\sum_{j\ne i}J_{ij}\brac{\sigma_j}+h-\beta^2(1-q)\brac{\sigma_i}}
$$

これの数学からの証明も近年試みられている [@Talagrand2003], [@Chatterjee2010]．しかし，厳密な証明は高温に限られ，低温域では解の一意性が失われるのが困難を窺わせる．２つの層の分離面としては Almeida-Thouless 線が提案されている．

しかし [@Bolthausen2014] は **近似メッセージパッシング** に基づいて，この TAP 方程式の解を与えるアルゴリズムを提案した．このアルゴリズムは，高次元統計学において $M$-推定量を計算するのにも応用されている [@Donoho-Montanari2016]．高次元漸近論は計算科学の進歩とともにあるのである．

#### Hopfield 模型 [@Hopfield1982]

のちにスピングラスの理論は **連想記憶** にも応用され，広く情報処理の問題を統計力学の技法によって研究する情報統計力学という新たな分野が開拓された．

[連想記憶のニューラルネットワーク](../Kernels/Deep.qmd#sec-Hopfield) は無限レンジ，すなわち全結合のニューラルネットワークで，素子 $\{S_i\}_{i=1}^N\subset\Map(T;\{\pm1\})$ からなるとき，
$$
S_i(t+\Delta t)=\sgn\paren{\sum_{j\ne i}J_{ij}\frac{S_j(t)+1}{2}-\theta_i}
$$
という規則で運動する．$J_{ij},\theta_i$ がモデルパラメータである．

$J_{ij}$ をうまく「学習」できた際には，一部の初期値について，この運動の収束先として画像が「連想」出来る．記憶しておけるのである．^[パターンを記憶させることを「埋め込む」ともいう [@西森秀稔2003 p.33]．]

実は，$p$ 個のパターン $(\xi^\mu_i)_{i=1}^N\in\Om\;(\mu=1,\cdots,p)$ を記憶させるには，
$$
J_{ij}=1_{\Brace{i\ne j}}\frac{1}{N}\sum_{\mu=1}^p\xi_i^\mu\xi_j^\mu
$$
と設定すると良いことが知られており，これを **Hebb 則** [@Hebb1949] という．

連想記憶がうまくいくためには，互いの直交性
$$
\frac{1}{N}(\xi^\mu|\xi^\nu)=\delta_{\mu,\nu}+O\paren{\frac{1}{\sqrt{N}}}
$$
が重要であることも知られている．

実は，Hebb 則によるパラメータを備えた Hopfield 模型は，結合が対称である $J_{ij}=J_{ji}$ とき，次の Hamiltonian を減少させる方向に運動する：
$$
H=-\frac{1}{2}\sum_{i\ne j}J_{ij}S_iS_j
$$

ここで係数 $J_{ij}$ はデータ $(\xi^\mu)_{\mu=1}^p$ から決まっているという意味では，確率変数であることに注意．

この模型を統計力学的に解析すると，Hopfield 模型は，想起相だけでなく，常磁性相ももち，その間にスピングラス相がある．これは $\al=\frac{p}{N}$ を大きくすると到達することができる [@西森秀稔2003 p.57]．

素子数一定の状況下で，覚えるパターン数を増やしすぎると，ある瞬間に相転移を起こして何も覚えなくなるのである．

### 因子グラフ

特に近距離相互作用のみを仮定している場面では，ハミルトニアン $H$ やその他の物理量の **局所性** が目立った（コンパクト台を持つ関数になっている）．

そのこともあり，物理系はグラフィカルモデル（Bayesian networks, Markov networks）としての表現と親和性があり，特に [**因子グラフ**](../Computation/PGM.qmd#sec-Factor-Graph) も重要な形式として用いられる [@Mezard-Montanari2009 p.100]．

## 参考文献 {.appendix}

[@Minlos2000], [@西森秀稔2003], [@Altieri-Baity-Jesi2024], [@Chatterjee2023], [@Panchenko2012], [@Talagrand2003], [@Bolthausen2014]