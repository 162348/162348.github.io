<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="司馬博文">

<title>確率核という概念 – Hirofumi Shiba</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../assets/Shiba2.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-listing/list.min.js"></script>
<script src="../../../site_libs/quarto-listing/quarto-listing.js"></script>
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-29987c632d9c708eba81ba88d1291502.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark-1df33b310b25e824b5acc70bcebddb02.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-29987c632d9c708eba81ba88d1291502.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-4c09742be2272f701a3e51422777528f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark-4c09742be2272f701a3e51422777528f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-4c09742be2272f701a3e51422777528f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "?",
    "H"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>

  window.document.addEventListener("DOMContentLoaded", function (_event) {
    const listingTargetEl = window.document.querySelector('#listing-kernel-listing .list');
    if (!listingTargetEl) {
      // No listing discovered, do not attach.
      return; 
    }

    const options = {
      valueNames: ['listing-title','listing-image','listing-date','listing-subtitle',{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
      
      searchColumns: ["listing-title","listing-author","listing-date","listing-image","listing-description"],
    };

    window['quarto-listings'] = window['quarto-listings'] || {};
    window['quarto-listings']['listing-kernel-listing'] = new List('listing-kernel-listing', options);

    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  });

  window.addEventListener('hashchange',() => {
    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  })
  </script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-36GX2G6GLL"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-36GX2G6GLL', { 'anonymize_ip': true});
</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Zen+Kurenaido&amp;display=swap" rel="stylesheet">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=BIZ+UDPGothic&amp;display=swap" rel="stylesheet">

<style>
  h1, .title, .description, .subtitle {
    font-family: "Zen Kurenaido", sans-serif !important;
  }
</style>

<!-- <style>
  .menu-text {
      font-family: "Gill Sans", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
  .navbar-title {
      font-family: "Gill Sans", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
</style> -->

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../assets/styles.css">
<meta property="og:title" content="確率核という概念 – Hirofumi Shiba">
<meta property="og:description" content="確率核という概念は現状あまりポピュラーではないと思われるが，数学的にいえば，Markov 過程論，確率論，さらにはデータ解析の中心に据えられるべき中心概念であると言えるかもしれない．例えば，カーネル法とは確率核に沿った埋め込みである．MCMC の性質も，本質的に確率核の性質が決定する．また確率核は，確率空間の圏の射となる．このように，多くのデータ解析手法の中核に位置する数学的本体たる「確率核」への入門を目指すのが本記事である．">
<meta property="og:image" content="https://162348.github.io/posts/2024/Probability/Images/P.svg">
<meta property="og:site_name" content="Hirofumi Shiba">
<meta name="twitter:title" content="確率核という概念 – Hirofumi Shiba">
<meta name="twitter:description" content="確率核という概念は現状あまりポピュラーではないと思われるが，数学的にいえば，Markov 過程論，確率論，さらにはデータ解析の中心に据えられるべき中心概念であると言えるかもしれない．例えば，カーネル法とは確率核に沿った埋め込みである．MCMC の性質も，本質的に確率核の性質が決定する．また確率核は，確率空間の圏の射となる．このように，多くのデータ解析手法の中核に位置する数学的本体たる「確率核」への入門を目指すのが本記事である．">
<meta name="twitter:image" content="https://162348.github.io/posts/2024/Probability/Images/P.svg">
<meta name="twitter:creator" content="@ano2math5">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Hirofumi Shiba</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-notes" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Notes</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-notes">    
        <li>
    <a class="dropdown-item" href="../../../static/English.html">
 <span class="dropdown-text">English Notes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../blog.html">
 <span class="dropdown-text">ノート (Japanese)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Materials.html"> 
<span class="menu-text">Materials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/162348/162348.github.io/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">確率核という概念</h1>
            <p class="subtitle lead">データ解析の営みを確率空間の圏上で理解する</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Probability</div>
                <div class="quarto-category">Kernel</div>
                <div class="quarto-category">Process</div>
                <div class="quarto-category">Functional Analysis</div>
                <div class="quarto-category">P(X)</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>司馬博文 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">3/24/2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">8/15/2024</p>
      </div>
    </div>
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="block-title">概要</div>
      確率核という概念は現状あまりポピュラーではないと思われるが，数学的にいえば，Markov 過程論，確率論，さらにはデータ解析の中心に据えられるべき中心概念であると言えるかもしれない．例えば，カーネル法とは確率核に沿った埋め込みである．MCMC の性質も，本質的に確率核の性質が決定する．また確率核は，確率空間の圏の射となる．<br>このように，多くのデータ解析手法の中核に位置する数学的本体たる「確率核」への入門を目指すのが本記事である．
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目次</h2>
   
  <ul>
  <li><a href="#はじめに" id="toc-はじめに" class="nav-link active" data-scroll-target="#はじめに"><span class="header-section-number">1</span> はじめに</a>
  <ul class="collapse">
  <li><a href="#確率核markov-連鎖の本体" id="toc-確率核markov-連鎖の本体" class="nav-link" data-scroll-target="#確率核markov-連鎖の本体"><span class="header-section-number">1.1</span> 確率核：Markov 連鎖の本体</a></li>
  <li><a href="#次元を上げてランダムネスを消す" id="toc-次元を上げてランダムネスを消す" class="nav-link" data-scroll-target="#次元を上げてランダムネスを消す"><span class="header-section-number">1.2</span> 次元を上げてランダムネスを消す</a></li>
  <li><a href="#mathcalpe-上の幾何学を構築する試み" id="toc-mathcalpe-上の幾何学を構築する試み" class="nav-link" data-scroll-target="#mathcalpe-上の幾何学を構築する試み"><span class="header-section-number">1.3</span> <span class="math inline">\(\mathcal{P}(E)\)</span> 上の幾何学を構築する試み</a></li>
  <li><a href="#確率核が数学的に重要な理由" id="toc-確率核が数学的に重要な理由" class="nav-link" data-scroll-target="#確率核が数学的に重要な理由"><span class="header-section-number">1.4</span> 確率核が数学的に重要な理由</a></li>
  <li><a href="#カーネル法でいうカーネルも確率核" id="toc-カーネル法でいうカーネルも確率核" class="nav-link" data-scroll-target="#カーネル法でいうカーネルも確率核"><span class="header-section-number">1.5</span> カーネル法でいう「カーネル」も確率核</a></li>
  <li><a href="#圏論についての補足" id="toc-圏論についての補足" class="nav-link" data-scroll-target="#圏論についての補足"><span class="header-section-number">1.6</span> 圏論についての補足</a></li>
  <li><a href="#圏論と現代数学" id="toc-圏論と現代数学" class="nav-link" data-scroll-target="#圏論と現代数学"><span class="header-section-number">1.7</span> 圏論と現代数学</a></li>
  <li><a href="#圏論から見た確率核" id="toc-圏論から見た確率核" class="nav-link" data-scroll-target="#圏論から見た確率核"><span class="header-section-number">1.8</span> 圏論から見た「確率核」</a></li>
  <li><a href="#関連ページ" id="toc-関連ページ" class="nav-link" data-scroll-target="#関連ページ"><span class="header-section-number">1.9</span> 関連ページ</a></li>
  </ul></li>
  <li><a href="#核の定義と性質" id="toc-核の定義と性質" class="nav-link" data-scroll-target="#核の定義と性質"><span class="header-section-number">2</span> 核の定義と性質</a>
  <ul class="collapse">
  <li><a href="#sec-def-kernel" id="toc-sec-def-kernel" class="nav-link" data-scroll-target="#sec-def-kernel"><span class="header-section-number">2.1</span> 定義</a></li>
  <li><a href="#sec-exp-kernel" id="toc-sec-exp-kernel" class="nav-link" data-scroll-target="#sec-exp-kernel"><span class="header-section-number">2.2</span> 核の例</a></li>
  <li><a href="#sec-kernel-action" id="toc-sec-kernel-action" class="nav-link" data-scroll-target="#sec-kernel-action"><span class="header-section-number">2.3</span> 確率核の作用</a></li>
  </ul></li>
  <li><a href="#確率核の特徴付け" id="toc-確率核の特徴付け" class="nav-link" data-scroll-target="#確率核の特徴付け"><span class="header-section-number">3</span> 確率核の特徴付け</a>
  <ul class="collapse">
  <li><a href="#sec-kernel-as-function" id="toc-sec-kernel-as-function" class="nav-link" data-scroll-target="#sec-kernel-as-function"><span class="header-section-number">3.1</span> 関数としての確率核</a></li>
  <li><a href="#作用素としての確率核" id="toc-作用素としての確率核" class="nav-link" data-scroll-target="#作用素としての確率核"><span class="header-section-number">3.2</span> 作用素としての確率核</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
<p>$$</p>
<p>$$</p>
</div>
<section id="はじめに" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="はじめに"><span class="header-section-number">1</span> はじめに</h2>
<blockquote class="blockquote">
<p>確率核 <span class="math inline">\(P\)</span> こそが Markov 連鎖の数学的本体である．</p>
</blockquote>
<p></p><div id="tweet-71662"></div><script>tweet=<!DOCTYPE html>
<html lang="en" class="dog">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X / ?</title>
    <meta name="version" content="1">
    <link href="https://abs.twimg.com/favicons/twitter.3.ico" rel="shortcut icon" type="image/x-icon">
    <link rel="stylesheet" href="https://abs.twimg.com/errors/fullscreen_errors-047ca1475a6efac7c9c89a9ff92b7a20.css">
  </head>
  <body dir="auto">
    <div class="top">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1519 200">
        <defs/>
        <path d="M708 103l9-5 13 1 2-2 5 1h8l1-1 42-5h7l7 3v1l12-2a9368 9368 0 0129-6l2-5 12 1 6-2 3 1 2 1v-2l13-2v1l4 2 7-1h1l17-3 1 2 4-1 18-7 3-1 4-1h9l13-1 1-4 3-2 13 1v2l22-2 10-3h6l10 5 16-5 15-3 2-1 8-4 6-2 12-1 7-2 8 5 7 1 22-9h7l5-1v-1l25-3 1 2 5 2v1h11l2 1 8-4h3l-1 1h11l10-6 6 3 9-1 4-1 1 1 1-2 6-1 1-1 10-2h2l7-5v1h4l3-1c11 0 23 2 34-3 2-2 7 0 10 0l12 1 4 1 9 2 12-1 11-3 11 1h4l10-6 17 1 2 1c9 2 19-3 22-11l1-1 9 1 15-5c3-1 9 4 9-5 5 0 5 3 5 7l2 3 4-1 4-2 9-4 3-3h3l8-4 6-3 26 2 7-4h18l7 1c10 3 13-6 17-12l8 4 3-1 14-3 15-2a38 38 0 01-5-1l-8-4 7-8 8-4-10-136-922 71 16 205z"/>
        <path d="M-36 193l9-5 13 1 2-2 5 1h8l1-1 42-5h7l7 3v1l12-2a9328 9328 0 0129-6l2-5 12 1 6-2 3 1 2 1v-2l13-2v1l4 2 7-1h1l17-3 1 2 4-1 18-7 3-1 4-1h9l13-1 1-4 3-2 13 1v2l22-2 10-3h6l10 5 16-5 15-3 2-1 8-4 6-2 12-1 7-2 8 5 7 1 22-9h7l5-1v-1l25-3 1 2 5 2v1h11l2 1 8-4h3l-1 1h9a6 6 0 002 0l10-6 6 3 9-1 4-1a6 6 0 001 1l1-2 6-1 1-1 10-2h2l7-5v1h4l3-1c11 0 23 2 34-3 2-2 7 0 10 0l12 1 4 1 9 2 12-1 11-3 11 1h4l10-6 17 1 2 1c9 2 19-3 22-11l1-1 9 1 15-5c3-1 9 4 9-5 5 0 5 3 5 7l2 3 4-1 4-2 9-4 3-3h3l8-4 6-3 26 2 7-4h18l7 1c10 3 13-6 17-12l8 4 3-1 14-3 15-2a37 37 0 01-5-1l-8-4 7-8 8-4-10-136-922 71 16 205z"/>
      </svg>
    </div>
    <div class="container">
      <div class="content">
        <a href="https://twitter.com" title="X logo">
          <svg viewBox="0 0 24 24" aria-hidden="true" class="x-logo"><g><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></g></svg>
        </a>
        <h1 id="header">Nothing to see here</h1>
        <p id="description">Looks like this page doesn’t exist. Here’s a picture of a poodle sitting in a chair for your trouble.</p>

          <a id="button_search" href="/" class="button">Looking for this?</a>

      </div>
      <img id="image" src="https://abs.twimg.com/errors/ErrorState_NotFound.png" alt="A primped poodle with a bow in its hair sitting in a chair like a human.">
      <div class="footer">
        <ul>
          <li><a href="https://twitter.com/" id="footer_home">Home</a></li>
          <li><a href="https://status.twitterstat.us/" id="footer_status">Status</a></li>
          <li><a href="https://twitter.com/tos" id="footer_tos">Terms of Service</a></li>
          <li><a href="https://twitter.com/privacy" id="footer_privacy">Privacy Policy</a></li>
          <li><a href="https://support.twitter.com/articles/20170514" id="footer_cookie">Cookie Policy</a></li>
          <li><a href="https://legal.twitter.com/imprint" id="footer_imprint">Imprint</a></li>
          <li><a href="https://business.twitter.com/en/help/troubleshooting/how-twitter-ads-work.html" id="footer_ads">Ads info</a></li>
          <li dir="ltr">&copy; X Corp. <span id="copyright-year">&emsp;&emsp;&emsp;&emsp;</span></li>
        </ul>
      </div>
    </div>
  </body>
  <script src="https://abs.twimg.com/errors/404-8651f633fd193e0b546010676a4fac06.js"></script>

;document.getElementById("tweet-71662").innerHTML = tweet["html"];<p></p>
<section id="確率核markov-連鎖の本体" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="確率核markov-連鎖の本体"><span class="header-section-number">1.1</span> 確率核：Markov 連鎖の本体</h3>
<p><span class="math inline">\((E,\mathcal{E}),(F,\mathcal{F})\)</span> を可測空間とする．確率核とは関数 <span class="math inline">\(E\to\mathcal{P}(F)\)</span> のことをいう（ほとんどの場合可測になる：第 <a href="#sec-kernel-as-function" class="quarto-xref">3.1</a> 節）．ただし，<span class="math inline">\(\mathcal{P}(F)\)</span> は <span class="math inline">\(F\)</span> 上の確率測度全体の集合とした．</p>
<p>多くの場合，<span class="math inline">\(\mathcal{P}(E)\)</span> は Banach 空間内の <span class="math inline">\(w^*\)</span>-閉な凸集合になっている．このことが，最終的に <a href="../../../posts/2023/KernelMethods/KernelMethods4Mathematicians.html#sec-Kernel">カーネルトリック</a> の基となる．</p>
<p><span class="math inline">\(E\)</span> 上の確率核 <span class="math inline">\(P:E\to\mathcal{P}(E)\)</span> が定まると，任意のスタート地点 <span class="math inline">\(x\in E\)</span> に対して，これを起点とする Markov 連鎖 <span class="math inline">\(\{X^x_n\}_{n=0}^\infty\subset\mathcal{L}(\Omega)\)</span> が構成できる．</p>
<p>ここで，確率変数 <span class="math inline">\(X^x_n\)</span> を定義するために謎の標本空間 <span class="math inline">\((\Omega,\mathcal{F},\operatorname{P})\)</span> が出てきた．これは数学的に確率変数を定義するために必要であるが，ご存知の通り <span class="math inline">\(\Omega\)</span> の性質が問題になる場面はほとんどない，純粋に形式的な存在である．一方で数学的な本体は核 <span class="math inline">\(P\)</span> なのである．まさに「核」．</p>
<p>Markov 連鎖の実体は分布であるが，これは確率核 <span class="math inline">\(P\)</span> を用いて <span class="math inline">\(\{(P^*)^n\delta_x\}_{n=0}^\infty\subset\mathcal{P}(E)\)</span> と表せる： <span class="math display">\[
X^x_n\sim (P^*)^n\delta_x,\qquad n\in\mathbb{N}.
\]</span> <span class="math inline">\((P^*)^n\)</span> は第 <a href="#sec-kernel-action" class="quarto-xref">2.3</a> 節参照．<span class="math inline">\(\delta_x\)</span> は <span class="math inline">\(x\in E\)</span> 上のデルタ測度である．</p>
</section>
<section id="次元を上げてランダムネスを消す" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="次元を上げてランダムネスを消す"><span class="header-section-number">1.2</span> 次元を上げてランダムネスを消す</h3>
<p>ここで，<span class="math inline">\(X^x_n\)</span> 自体は確率変数であり，ランダムな存在である．これを捉えるために測度論が必要だったのである．特に確率過程の議論に必要な測度論は大変込み入っている．</p>
<p>しかし分布 <span class="math inline">\((P^*)^n\delta_x\)</span> は空間 <span class="math inline">\(\mathcal{P}(E)\)</span> 上の点であり，全体として <span class="math inline">\(\mathcal{P}(E)\)</span> 上の（確定的な）力学系を定めている．<strong>ランダムネスが消えている</strong>のである！</p>
<p>ただしその代わり，例え <span class="math inline">\(E=\mathbb{R}^d\)</span> であっても，<span class="math inline">\(\mathcal{P}(E)\)</span> は無限次元空間になっている．</p>
<p>Newton 力学が扱う運動は結局，<span class="math inline">\(\mathbb{R}^n\)</span> など有限次元空間上の幾何学に帰着する．<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p><u><strong>一方で確率的な系は，確率核 <span class="math inline">\(P\)</span> を通じて，無限次元空間 <span class="math inline">\(\mathcal{P}(E)\)</span> 上の幾何学に帰着するのである</strong></u>．時代は情報幾何学である．<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
</section>
<section id="mathcalpe-上の幾何学を構築する試み" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="mathcalpe-上の幾何学を構築する試み"><span class="header-section-number">1.3</span> <span class="math inline">\(\mathcal{P}(E)\)</span> 上の幾何学を構築する試み</h3>
<p><span class="math inline">\(\mathcal{P}(E)\)</span> が無限次元と言えど，一度同じく「力学系」に帰着してしまえば，その数学的な大枠は共通するはずである．</p>
<p>まず，物理学で重要な幾何学的原理として，変分原理がある．これは，空間上に自由エネルギーや作用などの汎函数を定義して，これを最小化するものとしてダイナミクスを理解する方法である．</p>
<p>実際，モンテカルロ法が定める <span class="math inline">\(\mathcal{P}(E)\)</span> 上の力学系を，勾配流として理解することが進んでいる <span class="citation" data-cites="Jordan-Kinderlehrer-Otto1998">(<a href="#ref-Jordan-Kinderlehrer-Otto1998" role="doc-biblioref">Jordan et al., 1998</a>)</span>, <span class="citation" data-cites="Chopin+2023">(<a href="#ref-Chopin+2023" role="doc-biblioref">Chopin et al., 2023</a>)</span>．</p>
<p>最適輸送の名前の下で，<span class="math inline">\(\mathcal{P}(E)\)</span> の幾何学を考慮したサンプリング法の開発も進んでいる．</p>
<p>エルゴード理論において，多くの基本的な力学系（減衰振動など）は指数収束をするが，同様にして多くの基本的な Markov 核も指数収束をする．</p>
<!-- これが $x\in E$ に依らずに同じ点に近づくことを **忘却性** (loss of memory)，近づく先がちゃんと確率測度になることを **エルゴード性** (ergodicity) という． -->
</section>
<section id="確率核が数学的に重要な理由" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="確率核が数学的に重要な理由"><span class="header-section-number">1.4</span> 確率核が数学的に重要な理由</h3>
<p>確率核を確率空間の射とみる見方（第 <a href="#sec-def-kernel" class="quarto-xref">2.1</a> 節）が急速に浸透しており，これは <a href="../../../posts/2023/Probability/MarkovCategory.html">Markov 圏</a> の概念にも後押しされて急速に浸透しつつある．</p>
<p>Markov 圏は確率論，情報理論，統計学，因果推論に散らばっている基本的な概念に対して，統一的に形式的な定義を与える枠組みとして期待されている．</p>
<p>例えば，「エントロピー」は情報源や通信路が「決定論的」な状態からどれほどかけ離れているか？の指標として特徴付けることができるという <span class="citation" data-cites="Perrone2024">(<a href="#ref-Perrone2024" role="doc-biblioref">Perrone, 2024</a>)</span>．</p>
<p>また Markov 圏上で一般化された形で，Kolmogorov や Hewitt-Savage の 0-1 法則，Blackwell の定理，エルゴード分解定理などが，純粋に代数的に証明されているという <span class="citation" data-cites="Perrone2024">(<a href="#ref-Perrone2024" role="doc-biblioref">Perrone, 2024</a>)</span>．</p>
<p>この独立性の代数・図式的な特徴付けは，<a href="../../../posts/2024/Computation/PGM1.html">確率的グラフィカルモデル</a> の分野の結果，<span class="citation" data-cites="Hammersley-Clifford1971">(<a href="#ref-Hammersley-Clifford1971" role="doc-biblioref">Hammersley and Clifford, 1971</a>)</span> の定理などと重なる部分も多い．</p>
<p>だが，確率核の概念は，純粋に数学的な文献を除いてまだあまりポピュラーな概念であるとは言えないのが現状であろう．</p>
</section>
<section id="カーネル法でいうカーネルも確率核" class="level3" data-number="1.5">
<h3 data-number="1.5" class="anchored" data-anchor-id="カーネル法でいうカーネルも確率核"><span class="header-section-number">1.5</span> カーネル法でいう「カーネル」も確率核</h3>
<p>実際，カーネル法でいう「カーネル関数」も，（いつでも <a href="../../../posts/2024/Kernels/Kernel.html#sec-Gauss-kernel">RBF カーネル</a> のように確率核になるとは限らないが）核の一種である．</p>
<p>第 <a href="#sec-kernel-as-function" class="quarto-xref">3.1</a> 節で説明するように，核とは可測写像 <span class="math inline">\(K:E\to\mathcal{S}(F)\)</span> でもある．ただし，<span class="math inline">\(\mathcal{S}(F)\)</span> は符号付き測度の集合とした．</p>
<p><span class="math inline">\(\mathcal{S}(F)\)</span> は極めて大きい空間である．例えば <span class="math inline">\(F\)</span> 上の <span class="math inline">\(\sigma\)</span>-有限測度 <span class="math inline">\(\nu\in\mathcal{S}(F)\)</span> を１つ定める毎に，Radon-Nikodym の定理により Banach 空間の同型 <span class="math display">\[
L^1(\nu)\overset{\sim}{\to}\mathcal{S}^1(F)\hookrightarrow\mathcal{S}(F)
\]</span> が引き起こされる．</p>
<p><a href="../../../posts/2023/KernelMethods/KernelMethods4Mathematicians.html">カーネル法</a> とは，核 <span class="math inline">\(K:E\to\mathcal{S}(F)\)</span> に沿って <span class="math inline">\(E\)</span> 上の点を <span class="math inline">\(\mathcal{S}(F)\)</span> 上に埋め込む方法である．</p>
<p>さらに <span class="math inline">\(K\)</span> が半正定値関数が定める変換であった場合，再生核 Hilbert 空間の理論により，<span class="math inline">\(\mathcal{S}(F)\)</span> の部分空間として，内積が <span class="math inline">\(K\)</span> の計算だけで効率的に計算できるようなものが選び出せる．</p>
<p>こうして，<span class="math inline">\(E\)</span> 上のデータ解析を <span class="math inline">\(\mathcal{S}(F)\)</span> 上に写す非線型対応を導く，数学的に統一された方法が<a href="../../../posts/2024/Kernels/Kernel.html">カーネル法</a>である（例 <a href="#sec-exp-kernel" class="quarto-xref">2.2</a> 節も参照）．</p>
</section>
<section id="圏論についての補足" class="level3" data-number="1.6">
<h3 data-number="1.6" class="anchored" data-anchor-id="圏論についての補足"><span class="header-section-number">1.6</span> 圏論についての補足</h3>
<p>なお，<strong>射</strong> という用語も，代数幾何と代数トポロジーから多くの数学分野へ浸透した感があるが，近年は純粋数学のコミュニティからも出つつあると感じられる．</p>
<p>「射」とは代数系の準同型の概念を一般化したものであり，「対象」と共に <a href="https://ncatlab.org/nlab/show/category">圏</a> (category) という代数系の構成要素である．</p>
<p>一般にある対象とある射が圏をなすと言ったとき，その射は，対象の何らかの数学的構造を「保存」する働きを持つと理解される．例えば線型空間における線型写像，順序集合における単調写像，多様体における可微分写像，群や環における準同型が，それぞれの圏における「射」にあたる．</p>
<p>一方で，可測空間や確率空間で可測写像を射に取ると，壊滅的に実りのない圏ができる．一体どうしてだろうか？</p>
</section>
<section id="圏論と現代数学" class="level3" data-number="1.7">
<h3 data-number="1.7" class="anchored" data-anchor-id="圏論と現代数学"><span class="header-section-number">1.7</span> 圏論と現代数学</h3>
<p>数学的対象を中心に据えて数学を整理した <a href="https://ja.wikipedia.org/wiki/ニコラ・ブルバキ">Bourbaki</a> が現代数学の始まりであるという共通認識は一定に確立されている．</p>
<p>しかし近年，実は射の方が重要な対象なのではないか，という共通了解もできつつある：</p>
<blockquote class="blockquote">
<p>余談だが、homomorphism の訳語として、準同形ということばが定着している。これは、同形もどきという意味だから、同形がだいじというブルバキの思想を反映したものといえよう。射のほうが基本的という、より現代的な視点にはそぐわないが、いまさら変えることもできないだろう。<span class="citation" data-cites="斎藤毅2010">(<a href="#ref-斎藤毅2010" role="doc-biblioref">斎藤毅, 2010</a>)</span></p>
</blockquote>
<p>例えば距離空間の射には選択の余地がある．連続関数を取るか，一様連続写像と取るか，<a href="https://ncatlab.org/nlab/show/short+map">非拡大写像</a>を取るかで，圏の振る舞いは全て違う．連続写像と取った場合は，位相空間の圏の充満部分圏になる．つまり，位相構造以外の構造は無理される．一様連続写像を取ると，完備性も見るようになる．非拡大写像を取ると，距離構造の全てが保存されるようになる．</p>
<p>このようにして，Bourbaki は集合の上に構造を添加していく描像を数学に持ったが，現代的には射の選択によって構造を選択していると理解するのである．</p>
</section>
<section id="圏論から見た確率核" class="level3" data-number="1.8">
<h3 data-number="1.8" class="anchored" data-anchor-id="圏論から見た確率核"><span class="header-section-number">1.8</span> 圏論から見た「確率核」</h3>
<p>ここで，確率空間の圏において，射を確率核に取ると，極めて豊かな構造を持った圏 <span class="math inline">\(\mathrm{Stoch}\)</span> を得る．これは <a href="../../../posts/2023/Probability/MarkovCategory.html">Markov category</a> の１つとして調べられている．</p>
<p>すなわち，<strong>確率空間の実体は，その可測空間としての構造にはないと言うべきである</strong>．実際，測度論が確率論において頻出するにも拘らず極めて非本質的に感じられることは，統計を営むものである一定の一致を得るだろう．</p>
<p>この確率核と，これがなす圏の構造を調べることで，「確率空間」を「確率空間」たらしめるものは何か？が考えられている．この分野を<a href="https://ncatlab.org/nlab/show/synthetic+probability+theory">綜合的確率論</a> (synthetic probability theory) という <span class="citation" data-cites="Fritz2020">(<a href="#ref-Fritz2020" role="doc-biblioref">Fritz, 2020</a>)</span>．</p>
</section>
<section id="関連ページ" class="level3" data-number="1.9">
<h3 data-number="1.9" class="anchored" data-anchor-id="関連ページ"><span class="header-section-number">1.9</span> 関連ページ</h3>
<div id="listing-kernel-listing" class="quarto-listing quarto-listing-container-grid">
<div class="list grid quarto-listing-cols-3">
<div class="g-col-1" data-index="0" data-categories="U3RhdGlzdGljcyUyQ0tlcm5lbCUyQ1Byb2JhYmlsaXR5JTJDQmF5ZXNpYW4=" data-listing-date-sort="1723420800000" data-listing-file-modified-sort="1761046311359" data-listing-date-modified-sort="1723593600000" data-listing-reading-time-sort="6" data-listing-word-count-sort="1073">
<a href="../../../posts/2024/Kernels/HierarchicalModel.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/Kernels/Images/MM.svg" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
階層モデル再論
</h5>
<div class="card-subtitle listing-subtitle">
多変量解析から機械学習へ
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-08-12
</div>
</div>
</div>
</div></a>
</div>
<div class="g-col-1" data-index="1" data-categories="S2VybmVs" data-listing-date-sort="1723248000000" data-listing-file-modified-sort="1761046311378" data-listing-date-modified-sort="1723334400000" data-listing-reading-time-sort="3" data-listing-word-count-sort="523">
<a href="../../../posts/2024/Kernels/Kernel.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/Kernels/Images/Gibbs.svg" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
カーネル法の概観
</h5>
<div class="card-subtitle listing-subtitle">
半正定値カーネルから距離学習まで
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-08-10
</div>
</div>
</div>
</div></a>
</div>
<div class="g-col-1" data-index="2" data-categories="S2VybmVs" data-listing-date-sort="1699315200000" data-listing-file-modified-sort="1761046310808" data-listing-date-modified-sort="1710374400000" data-listing-reading-time-sort="2" data-listing-word-count-sort="256">
<a href="../../../posts/2023/KernelMethods/KernelMethods4Mathematicians.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2023/KernelMethods/KernelMethods.svg" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
数学者のためのカーネル法概観
</h5>
<div class="card-subtitle listing-subtitle">
カーネル PCA と SVM を例として
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2023-11-07
</div>
</div>
</div>
</div></a>
</div>
</div>
<div class="listing-no-matching d-none">No matching items</div>
</div>
</section>
</section>
<section id="核の定義と性質" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="核の定義と性質"><span class="header-section-number">2</span> 核の定義と性質</h2>
<section id="sec-def-kernel" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="sec-def-kernel"><span class="header-section-number">2.1</span> 定義</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定義 (kernel, probability kernel / Markov kernel)">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>定義 (kernel, probability kernel / Markov kernel)
</div>
</div>
<div class="callout-body-container callout-body">
<p>２つの可測空間 <span class="math inline">\((E,\mathcal{E}),(F,\mathcal{F})\)</span> について，</p>
<ol type="1">
<li><p>（非負）<strong>核</strong> <span class="math inline">\(K:E\to F\)</span> とは，関数 <span class="math inline">\(E\times\mathcal{F}\to[0,\infty]\)</span> であって次の２条件を満たすものをいう：<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<ol type="a">
<li>任意の <span class="math inline">\(x\in E\)</span> に対して，<span class="math inline">\(K(x,-):\mathcal{F}\to[0,\infty]\)</span> は測度を定める．<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></li>
<li>任意の <span class="math inline">\(A\in\mathcal{F}\)</span> に対して，<span class="math inline">\(K(-,A):E\to[0,\infty]\)</span> は可測関数である．</li>
</ol></li>
<li><p>更に (1) で <span class="math inline">\(K(x,F)=1\;(x\in E)\)</span> も成り立つとき，これを <strong>Markov 核</strong> または <strong>確率核</strong> という．<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p></li>
<li><p>核 <span class="math inline">\(K:E\times\mathcal{F}\to[0,\infty]\)</span> が <strong>有界</strong> であるとは，<span class="math inline">\(\sup_{x\in E}\|K(x,F)\|&lt;\infty\)</span> を満たすことをいう．<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> すなわち，<span class="math inline">\(E\to M^1(F)\)</span> が有界な像を持つことをいう．</p></li>
<li><p><span class="math inline">\(E\)</span> が確率空間でもあるとき，核は <strong>ランダム測度</strong> に等価である．<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p></li>
</ol>
</div>
</div>
<p>核には積と呼ぶべき結合的な演算が定まる．</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定義（核の合成と積）^[[@鎌谷研吾2021 p.382] の呼称に一致．[@Dellacherie-Meyer1988 p.4] は composition，[@Gikhman-Skorokhod2004I p.76] 定理II.4.1 は畳み込みと呼ぶ．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>定義（核の合成と積）<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(E,F,G\)</span> を可測空間とする．</p>
<ol type="1">
<li>核 <span class="math inline">\(S:F\to G\)</span> に対して，<strong>合成</strong> <span class="math inline">\(T\otimes S:E\to F\times G\)</span> を <span class="math display">\[(T\otimes S)(x,A\times B):=\int_AT(x,dy)S(y,B),\qquad(x\in E,A\in\mathcal{F},B\in\mathcal{G}),\]</span> で定める．</li>
<li><strong>積</strong> <span class="math inline">\(TS:E\to G\)</span> を <span class="math display">\[(TS)(x,B):=(T\otimes S)(x,F\times B)=\int_FT(x,dy)S(y,B),\qquad(x\in E,B\in\mathcal{G}),\]</span> で定める．</li>
</ol>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>核は積に関して結合的である：<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> <span class="math display">\[(RS)T=R(ST).\]</span></p>
</div>
</div>
</div>
<p>このことにより，確率空間を対象とし，確率核を射とする圏が定まることになる．これを <span class="math inline">\(\mathrm{Stoch}\)</span> と呼ぼう．単位射は後述の <span class="math inline">\(K_{\mathrm{id}_E}\)</span> が与える．</p>
</section>
<section id="sec-exp-kernel" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="sec-exp-kernel"><span class="header-section-number">2.2</span> 核の例</h3>
<p>核は極めて多くの重要な概念を一般化し，統一的な見方を提供してくれる．</p>
<p>まずなんといっても，確率核は確率行列の無限次元への一般化と捉えられる：</p>
<div class="callout callout-style-simple callout-warning no-icon callout-titled" title="確率行列としての確率核">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>確率行列としての確率核
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(E,F\)</span> が有限集合であるとき，<span class="math inline">\(\mathcal{P}(E),\mathcal{P}(F)\)</span> は行ベクトルの空間と見れる．</p>
<p>すると確率核は（行／右）<a href="https://ja.wikipedia.org/wiki/確率行列">確率行列</a> <span class="math inline">\(P\)</span> と等価になる．</p>
<p>次節で定義する核の作用も，列ベクトル <span class="math inline">\(x_t\in\mathbb{R}^E\)</span> と行ベクトル <span class="math inline">\(\mu_t\)</span> に関する行列積と等価になる： <span class="math display">\[
x_{t+1}=Px_t,\qquad \mu_{t+1}=\mu_t P.
\]</span></p>
</div>
</div>
<p>さらに，<strong>正則な</strong>条件付き確率とは，条件付き確率 <span class="math inline">\(P:E\times\mathcal{F}\to[0,1]\)</span> が確率核になることに他ならない：</p>
<div class="callout callout-style-simple callout-warning no-icon callout-titled" title="正則条件付き確率は確率核^[[@Jacod-Shiryaev2003 p.65]，[@Klenke2020 p.205] 8.3節．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>正則条件付き確率は確率核<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(Y\in\mathcal{L}(\Omega;E)\)</span> を確率変数，<span class="math inline">\(\mathcal{G}\subset\mathcal{F}\)</span> を部分 <span class="math inline">\(\sigma\)</span>-代数とする． <span class="math inline">\(Y\)</span>の<span class="math inline">\(\mathcal{G}\)</span>の下での <strong>正則条件付き確率</strong> とは，次を満たす確率核 <span class="math inline">\(\kappa_{Y,\mathcal{G}}:\Omega\times\mathcal{E}\to[0,1]\)</span> をいう： <span class="math display">\[
\kappa_{Y,\mathcal{G}}(\omega,B)=\operatorname{E}[1_{\left\{Y\in B\right\}}\mid\mathcal{G}](\omega)\;\operatorname{P}\text{-a.s.}\qquad B\in\mathcal{E}.
\]</span></p>
</div>
</div>
<div class="callout callout-style-simple callout-warning no-icon callout-titled" title="測度は退化した核である">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>測度は退化した核である
</div>
</div>
<div class="callout-body-container callout-body">
<p>測度とは一点集合からの核 <span class="math inline">\(\nu:\{*\}\to E\)</span> と考えられる．すなわち，一点集合は圏 <span class="math inline">\(\mathrm{Stoch}\)</span> の終対象である．</p>
</div>
</div>
<p>続いて，そもそも核は決定論的な対象も包含する概念であることを見る：</p>
<div class="callout callout-style-simple callout-warning no-icon callout-titled" title="関数も退化した確率核である^[[@Dellacherie-Meyer1988] 7 p.4，[@Revuz1984 p.9]，[@Revuz1984 p.13] 演習1.13．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>関数も退化した確率核である<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(f:E\to F\)</span> を関数とする．デルタ測度への埋め込み <span class="math inline">\(\delta:F\hookrightarrow\mathcal{P}(F)\)</span> に沿って <span class="math inline">\(f\)</span> は確率核 <span class="math inline">\(E\to\mathcal{P}(F)\)</span> とみなせる： <span class="math display">\[
K_f(x,-):=\delta_{f(x)}(-).
\]</span></p>
<p><span class="math inline">\(F=E,f=\mathrm{id}_E\)</span> とした場合の <span class="math inline">\(K_f\)</span> が <span class="math inline">\(E\)</span> の自己射である．</p>
</div>
</div>
<p><span class="math inline">\(k:E\times E\to\mathbb{C}\)</span> を半正定値関数とすると，<span class="citation" data-cites="Moore39-GeneralAnalysis2">(<a href="#ref-Moore39-GeneralAnalysis2" role="doc-biblioref">Moore, 1939</a>)</span> の定理から，ただ一つの再生核 Hilbert 空間 <span class="math inline">\(H\subset\mathbb{C}^E\)</span> が存在して <span class="math inline">\(k\)</span> を核に持つ．</p>
<p>このとき，特徴写像 <span class="math inline">\(\Phi:E\to H\)</span> は関数である．理想的には全単射であり，カーネルトリック <span class="math display">\[
(\Phi(x)|\Phi(y))=k(x,y)
\]</span> を通じて <span class="math inline">\(E\)</span> 上のデータ解析を <span class="math inline">\(H\)</span> 上に押し出す．</p>
<div class="callout callout-style-simple callout-warning no-icon callout-titled" title="関数の積も核である">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>関数の積も核である
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(f,k:E\to\mathbb{R}\)</span> を関数とする．</p>
<p>核を <span class="math inline">\(K(x,-):=k(x)\delta_x\)</span> と定めると，<span class="math inline">\(K\)</span> による作用とは <span class="math inline">\(k\)</span> との積に一致する： <span class="math display">\[
Kf(x)=\int_Ek(x)\delta_x(dy)f(y)=k(x)f(x).
\]</span></p>
</div>
</div>
<p>これをさらに一般化すると，「核」の語源に辿り着く：</p>
<div class="callout callout-style-simple callout-warning no-icon callout-titled" title="積分変換は核を定める^[[@Dellacherie-Meyer1988 p.5] 7，[@Revuz1984 p.9]，[@Dellacherie-Meyer1988 p.2]．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>積分変換は核を定める<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(\lambda\in\mathcal{M}(E)\)</span> を測度，<span class="math inline">\(k\in\mathcal{L}(E\times E)\)</span> を関数とする．このとき， <span class="math display">\[
K(x,A):=\int_Ak(x,y)\lambda(dy),\qquad x\in E,A\in\mathcal{E},
\]</span> は <span class="math inline">\(E\)</span> 上の（符号付き）核を定める．</p>
<p>すなわち，<span class="math inline">\(K\)</span> が測度 <span class="math inline">\(\lambda\)</span> に関して密度 <span class="math inline">\(k\)</span> を持つとき，これを <span class="math inline">\(k\)</span> を <strong>積分核</strong> とする基底 <span class="math inline">\(\lambda\)</span> に関する積分変換という．</p>
</div>
</div>
</section>
<section id="sec-kernel-action" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="sec-kernel-action"><span class="header-section-number">2.3</span> 確率核の作用</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="確率核の作用^[作用は [@Hairer2021-Convergence], [@Kallenberg2017 p.16], [@Dellacherie-Meyer1988 pp.2-3] が同様に定めている．最後の文献によると，この記法は Hunt によるものだという．$T\otimes S$ の存在は [@Gikhman-Skorokhod2004I p.76] 定理II.4.1 で示されており，$\otimes$ を **直積**，$\cdot$ を **畳み込み** と呼んでいる．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>確率核の作用<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p>核は写像 <span class="math inline">\(E\to\mathcal{M}(F)\)</span> と見れるため，その全体は自然に実線型空間をなす．これを <span class="math inline">\(\mathrm{Hom}_\mathrm{Stoch}(E,F)\)</span> と表す．</p>
<ol type="1">
<li><p><strong>右作用</strong> <span class="math inline">\(\mathcal{S}(E)\times\mathrm{Hom}_\mathrm{Stoch}(E,F)\to\mathcal{S}(E)\)</span> を <span class="math display">\[(\mu T)(A):=\int_E\mu(dx)T(x,A),\qquad A\in\mathcal{F},\]</span> で定める．</p></li>
<li><p><strong>左作用</strong> <span class="math inline">\(\mathrm{Hom}_\mathrm{Stoch}(E,F)\times\mathcal{L}(F)\to\mathcal{L}(E)\)</span> を <span class="math display">\[(Tf)(x):=\int_FT(x,dy)f(y),\qquad x\in E,\]</span> で定める．<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a></p></li>
</ol>
</div>
</div>
<div class="callout callout-style-simple callout-warning no-icon callout-titled" title="決定論的な確率核の作用">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>決定論的な確率核の作用
</div>
</div>
<div class="callout-body-container callout-body">
<p>関数 <span class="math inline">\(f\)</span> が定める核 <span class="math inline">\(K_f:E\to E\)</span> は <span class="math inline">\(\mathcal{L}(E)\)</span> に <span class="math inline">\(f\)</span> の <strong>前合成</strong> として作用し，<span class="math inline">\(\mathcal{S}(E)\)</span> に <span class="math inline">\(f\)</span> による <strong>押し出し</strong> として作用する： <span class="math display">\[
\begin{align*}
K_fg(x)&amp;=\int_F K_f(x,dy)g(y)=\int_F\delta_{f(x)}(dy)g(y)=g\circ f(x),\\
\mu K_f(A)&amp;=\int_E\mu(dx)K_f(x,A)=\int_E\mu(dx)\delta_{f(x)}(A)\\
&amp;=\mu(f^{-1}(A))=f_*\mu(A).
\end{align*}
\]</span></p>
</div>
</div>
<div class="callout callout-style-simple callout-warning no-icon callout-titled" title="畳み込みは強 Feller 核である^[[@Revuz1984 p.10]．p.36 も参照．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>畳み込みは強 Feller 核である<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(\pi\in\mathcal{M}(\mathbb{R}^d)\)</span> を測度として，核 <span class="math inline">\(K\)</span> を <span class="math display">\[
K(x,A):=(\pi*\delta_x)(A)=\int_{\mathbb{R}^d}\delta_x(A-y)\pi(dy)
\]</span> と定めると，<span class="math inline">\(K\)</span> の右作用は測度同士の畳み込みを定める： <span class="math display">\[
\begin{align*}
Kf(x)&amp;=\int_{\mathbb{R}^d}K(x,dz)f(z)=\int_{\mathbb{R}^d}\int_{\mathbb{R}^d}\delta_x(dz-y)\pi(dy)f(z)=\int_{\mathbb{R}^d}f(x+y)\pi(dy),\\
\mu K(A)&amp;=\int_{\mathbb{R}^d}\mu(dx)K(x,A)=\int_{\mathbb{R}^d}\int_{\mathbb{R}^d}\mu(dx)\delta_x(A-y)\pi(dy)\\
&amp;\hphantom{=\int_{\mathbb{R}^d}\mu(dx)K(x,A)}=\int_{\mathbb{R}^d}\mu(A-y)\pi(dy)=\pi*\mu(A).
\end{align*}
\]</span></p>
<p>実は畳み込み核は強 Feller である．すなわち，任意の有界可測関数 <span class="math inline">\(f\in\mathcal{L}_b(E)\)</span> に対して，<span class="math inline">\(Kf\in C(E)\)</span> は連続である．<a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>任意の <span class="math inline">\(x_1,x_2\in E\)</span> について，<span class="math inline">\(f\in\mathcal{L}_b(E)\)</span> であるから，有界収束定理より <span class="math display">\[
\lvert Kf(x_1)-Kf(x_2)\rvert\le\int_E\lvert f(x_1+y)-f(x_2+y)\rvert\pi(dy)\xrightarrow{x_2\to x_1}0.
\]</span></p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="核の自己随伴性^[(1)は [@Revuz1984 p.9] と [@Dellacherie-Meyer1988 5 p.3]，(2)は [@Dellacherie-Meyer1988 7 p.4]．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>核の自己随伴性<a href="#fn17" class="footnote-ref" id="fnref17" role="doc-noteref"><sup>17</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p>自然なペアリング <span class="math inline">\((-|-):\mathcal{S}(E)\times\mathcal{L}(F)\to[-\infty,\infty]\)</span> に関して，核 <span class="math inline">\(T\)</span> は（両辺が意味を持つ限り）自己随伴性を満たす： <span class="math display">\[(\mu T|f)=(\mu|Tf).\]</span></p>
<p>また，<span class="math inline">\((MN)f=M(Nf)\)</span> も成り立つ．</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Fubini の定理より，次のように式変形できる： <span class="math display">\[\begin{align*}
    (\mu|Pf)&amp;=\int_EPf(x)\mu(dx)=\int_E\int_FP(x,dy)f(y)\mu(dx)\\
    &amp;=\int_F\int_E\mu(dx)P(x,dy)f(y)=\int_F\mu P(dy)f(y)=(\mu P|f).
\end{align*}\]</span></p>
</div>
</div>
</div>
<p>確率核の２つの作用は，作用素として非拡大的である．ただし，<span class="math inline">\(\mathcal{L}_b(E)\)</span> 上に一様ノルム，<span class="math inline">\(\mathcal{P}(E)\)</span> 上に全変動ノルムを考えるとする：</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="確率核の作用の非拡大性^[[@Revuz1984 p.12]．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>確率核の作用の非拡大性<a href="#fn18" class="footnote-ref" id="fnref18" role="doc-noteref"><sup>18</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(P\)</span> を確率核とする．</p>
<ol type="1">
<li>左作用 <span class="math inline">\(P:\mathcal{L}_b(E)\to\mathcal{L}_b(E)\)</span> は非拡大写像を定める：<span class="math inline">\(\|Pf\|_\infty\le\|f\|_\infty\)</span>．</li>
<li>右作用 <span class="math inline">\(P^*:\mathcal{P}(E)\to \mathcal{P}(F)\)</span> も非拡大写像を定める：<span class="math inline">\(\|\mu P\|_\mathrm{TV}\le\|\mu\|_\mathrm{TV}\)</span>．</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math display">\[\begin{align*}
    \sup_{x\in E}|Pf(x)|&amp;=\sup_{x\in E}\left|\int_EP(x,dy)f(y)\right|\le\|f\|_\infty\sup_{x\in E}\int_EP(x,dy)=\|f\|_\infty.
\end{align*}\]</span></p>
</div>
</div>
</div>
</section>
</section>
<section id="確率核の特徴付け" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="確率核の特徴付け"><span class="header-section-number">3</span> 確率核の特徴付け</h2>
<section id="sec-kernel-as-function" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="sec-kernel-as-function"><span class="header-section-number">3.1</span> 関数としての確率核</h3>
<p><span class="math inline">\(F\)</span> が可分距離空間であるとき，確率核とは本質的に可測関数 <span class="math inline">\(E\to\mathcal{P}(F)\)</span> である．</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="核の関数としての可測性^[[@Kallenberg2017 p.30] 補題1.14 では Borel 空間について示している．[@Hairer2021-Convergence] ではあらかじめ (2) を定義としている．[@DelMoral04-FeynmanKacFormulae p.7] は最初からこれによって $\sigma$-代数を定義する．[@Ambrosio+2008 p.121] も初めからこれを通じて，可分距離空間 $Y$ に対する Borel 写像 $X\to\cP(Y)$ を定義する．(3) は [@Ambrosio+2008 p.121]．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>核の関数としての可測性<a href="#fn19" class="footnote-ref" id="fnref19" role="doc-noteref"><sup>19</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(F\)</span> を距離化可能とする．このとき，関数 <span class="math inline">\(E\times\mathcal{B}(F)\to[0,1]\)</span> について，(2)<span class="math inline">\(\Rightarrow\)</span>(1) が成り立ち，<span class="math inline">\(F\)</span> が可分であるとき (1)<span class="math inline">\(\Rightarrow\)</span>(2) も成り立ち，２つは同値になる：</p>
<ol type="1">
<li><span class="math inline">\(E\times\mathcal{B}(F)\to[0,1]\)</span> は確率核である．</li>
<li><span class="math inline">\(E\to\mathcal{P}(F)\)</span> は可測である．</li>
</ol>
<ol start="2" type="1">
<li>が成り立つとき， <span class="math display">\[x\in E\mapsto\int_Ff(x,y)P(x,dy),\qquad f\in\mathcal{L}_b(E\times F)\]</span> も可測である．</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>(2)<span class="math inline">\(\Rightarrow\)</span>(1)</p>
<p><span class="math inline">\(\sigma[\{\mathrm{ev}_B\}_{B\in\mathcal{B}(F)}]\subset\mathcal{B}(F)\)</span> が成り立つから，任意の <span class="math inline">\(B\in\mathcal{B}(F)\)</span> について合成 <span class="math inline">\(P(-,B):E\to\mathcal{P}(F)\xrightarrow{\mathrm{ev}_B}[0,1]\)</span> が可測．</p></li>
<li><p>(1)<span class="math inline">\(\Rightarrow\)</span>(2)</p>
<p><span class="math inline">\(F\)</span> が可分に距離化可能であるとき，<span class="math inline">\(\mathcal{B}(F)=\sigma[\{\mathrm{ev}_B\}_{B\in\mathcal{B}(F)}]\)</span> が成り立つから，<span class="math inline">\(E\to\mathcal{P}(F)\)</span> が可測であることは，任意の <span class="math inline">\(B\in\mathcal{B}(F)\)</span> について合成 <span class="math inline">\(P(-,B):E\to\mathcal{P}(F)\xrightarrow{\mathrm{ev}_B}[0,1]\)</span> が可測であることに同値．</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="作用素としての確率核" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="作用素としての確率核"><span class="header-section-number">3.2</span> 作用素としての確率核</h3>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="$\mathcal{P}(E)$ を不変にする線型作用は確率核である^[[@Hairer2018 p.8] 演習2.34．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span><span class="math inline">\(\mathcal{P}(E)\)</span> を不変にする線型作用は確率核である<a href="#fn20" class="footnote-ref" id="fnref20" role="doc-noteref"><sup>20</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(E\)</span> をPolish空間，<span class="math inline">\(T:\mathcal{S}^1(E)\to\mathcal{S}^1(E)\)</span> を線型作用素で，<span class="math inline">\(T(\mathcal{P}(E))\subset\mathcal{P}(E)\)</span> を満たすとする． このとき，ある確率核 <span class="math inline">\(P\)</span> が存在して，<span class="math inline">\(T\)</span> はその作用である： <span class="math display">\[
T\mu(A)=\int_E P(x,A)\mu(dx).
\]</span></p>
</div>
</div>
<p>さらに進んで，次が成り立つ：</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="核の作用の特徴付け^[[@Revuz1984 p.9] 命題1.3．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>核の作用の特徴付け<a href="#fn21" class="footnote-ref" id="fnref21" role="doc-noteref"><sup>21</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\((E,\mathcal{E})\)</span> を可測空間，<span class="math inline">\(K:\mathcal{L}(E)\to\mathcal{L}(E)\)</span> を正な線型写像とする．このとき，次は同値：</p>
<ol type="1">
<li><span class="math inline">\(K\)</span> はある核の作用である．</li>
<li>単調収束定理：任意の増加列 <span class="math inline">\(\{f_n\}\subset\mathcal{L}(E)_+\)</span> に対して， <span class="math display">\[
K\left(\lim_{n\to\infty}f_n\right)=\lim_{n\to\infty}Vf_n.
\]</span></li>
</ol>
</div>
</div>




</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Ambrosio+2008" class="csl-entry" role="listitem">
Ambrosio, L., Gigli, N., and Savaré, G. (2008). <em><a href="https://link.springer.com/book/10.1007/978-3-7643-8722-8"><span class="nocase">Gradient Flows: In Metric Spaces and in the Space of Probability Measures</span></a></em>. Birkhäuser Basel.
</div>
<div id="ref-Bass2011" class="csl-entry" role="listitem">
Bass, R. (2011). <em><a href="https://doi.org/10.1017/CBO9780511997044">Stochastic processes</a></em>,Vol. 33. Cambridge University Press.
</div>
<div id="ref-Bremaud20-Processes" class="csl-entry" role="listitem">
Bremaud, P. (2020). <em>Probability theory and stochastic processes</em>. Springer Cham.
</div>
<div id="ref-Chopin+2023" class="csl-entry" role="listitem">
Chopin, N., Crucinio, F. R., and Korba, A. (2023). <em><a href="https://arxiv.org/abs/2310.11914">A connection between tempering and entropic mirror descent</a></em>.
</div>
<div id="ref-Chopin-Papaspiliopoulos20-SMC" class="csl-entry" role="listitem">
Chopin, N., and Papaspiliopoulos, O. (2020). <em><a href="https://link.springer.com/book/10.1007/978-3-030-47845-2">An introduction to sequential monte carlo</a></em>. Springer Cham.
</div>
<div id="ref-Crisan-Doucet2002" class="csl-entry" role="listitem">
Crisan, D., and Doucet, A. (2002). A survey of convergence results on particle filtering methods for practitioners. <em>IEEE Transactions on Signal Processing</em>, <em>50</em>(3), 736–746.
</div>
<div id="ref-DelMoral04-FeynmanKacFormulae" class="csl-entry" role="listitem">
Del&nbsp;Moral, P. (2004). <em>Feynman-kac formulae</em>. Springer New York.
</div>
<div id="ref-Dellacherie-Meyer1988" class="csl-entry" role="listitem">
Dellacherie, C., and Meyer, P. A. (1988). <em>Probabilities and potential c: Potential theory for discrete and continuous semigroups</em>,Vol. 151. E;sevier Science Publishers B.V.
</div>
<div id="ref-Fritz2020" class="csl-entry" role="listitem">
Fritz, T. (2020). <a href="https://doi.org/10.1016/j.aim.2020.107239"><span class="nocase">A Synthetic Approach to Markov Kernels, Conditional Independence and Theorems on Sufficient Statistics</span></a>. <em>Advances in Mathematics</em>, <em>370</em>, 107239.
</div>
<div id="ref-Gikhman-Skorokhod2004I" class="csl-entry" role="listitem">
Gikhman, I. I., and Skorokhod, A. V. (2004). <em>The theory of stochastic processes i</em>. Springer Berlin, Heidelberg.
</div>
<div id="ref-Hairer2018" class="csl-entry" role="listitem">
Hairer, M. (2018). <em><a href="https://www.hairer.org/notes/Markov.pdf">Ergodic properties of markov processes</a></em>.
</div>
<div id="ref-Hairer2021-Convergence" class="csl-entry" role="listitem">
Hairer, M. (2021). <em><a href="https://www.hairer.org/notes/Convergence.pdf">Convergence of markov processes</a></em>.
</div>
<div id="ref-Hammersley-Clifford1971" class="csl-entry" role="listitem">
Hammersley, J., and Clifford, P. (1971). <em><a href="https://ora.ox.ac.uk/objects/uuid:4ea849da-1511-4578-bb88-6a8d02f457a6">Markov fields on finite graphs and lattices</a></em>.
</div>
<div id="ref-Jacod-Shiryaev2003" class="csl-entry" role="listitem">
Jacod, J., and Shiryaev, A. N. (2003). <em><a href="https://link.springer.com/book/10.1007/978-3-662-05265-5"><span class="nocase">Limit Theorems for Stochastic Processes</span></a></em>,Vol. 288. Springer Berlin, Heidelberg.
</div>
<div id="ref-Jordan-Kinderlehrer-Otto1998" class="csl-entry" role="listitem">
Jordan, R., Kinderlehrer, D., and Otto, F. (1998). <a href="https://doi.org/10.1137/S0036141096303359">The variational formulation of the fokker–planck equation</a>. <em>SIAM Journal on Mathematical Analysis</em>, <em>29</em>(1), 1–17.
</div>
<div id="ref-Kallenberg2017" class="csl-entry" role="listitem">
Kallenberg, O. (2017). <em>Random measures, theory and applications</em>,Vol. 77. Springer Cham.
</div>
<div id="ref-Klenke2020" class="csl-entry" role="listitem">
Klenke, A. (2020). <em>Probability theory: A comprehensive course</em>. Springer Cham.
</div>
<div id="ref-Kolokoltsov2011-Generators" class="csl-entry" role="listitem">
Kolokoltsov, V. N. (2011). <em>Markov processes, semigroups and generators</em>,Vol. 38. De Gruyter.
</div>
<div id="ref-Kulik2018" class="csl-entry" role="listitem">
Kulik, A. (2018). <em><a href="https://doi.org/10.1515/9783110458930">Ergodic behavior of markov processes: With applications to limit theorems</a></em>,Vol. 67. De Gruyter: Berlin, Boston.
</div>
<div id="ref-LeGall2016" class="csl-entry" role="listitem">
Le Gall, J.-F. (2016). <em><a href="https://link.springer.com/book/10.1007/978-3-319-31089-3">Brownian motion, martingales, and stochastic calculus</a></em>,Vol. 274. Springer Cham.
</div>
<div id="ref-Moore39-GeneralAnalysis2" class="csl-entry" role="listitem">
Moore, E. H. (1939). <em>General analysis, part 2</em>,Vol. 1. American Philosophical Society.
</div>
<div id="ref-Perrone2024" class="csl-entry" role="listitem">
Perrone, P. (2024). <a href="https://doi.org/10.1109/TIT.2023.3328825"><span class="nocase">Markov Categories and Entropy</span></a>. <em>IEEE Transactions on Information Theory</em>, <em>70</em>(3), 1671–1692.
</div>
<div id="ref-Revuz1984" class="csl-entry" role="listitem">
Revuz, D. (1984). <em>Markov chains</em>,Vol. 11. North-Holland Publishing Company.
</div>
<div id="ref-Revuz-Yor1999" class="csl-entry" role="listitem">
Revuz, D., and Yor, M. (1999). <em><a href="https://doi.org/10.1007/978-3-662-06400-9">Continuous martingales and brownian motion</a></em>. Springer Berlin, Heidelberg.
</div>
<div id="ref-斎藤毅2010" class="csl-entry" role="listitem">
斎藤毅. (2010). <a href="https://www.ms.u-tokyo.ac.jp/~t-saito/jd/gr.pdf">数学セミナー</a>. In, pages 8–13. 日本評論社.
</div>
<div id="ref-鎌谷研吾2021" class="csl-entry" role="listitem">
鎌谷研吾. (2021). <a href="https://www.jstage.jst.go.jp/article/jjssj/50/2/50_381/_article/-char/ja/">マルコフ連鎖モンテカルロ法における平均回帰</a>. <em>日本統計学会誌</em>, <em>50</em>(2), 381–402.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Hamilton の定式化などを通じて，接束 <span class="math inline">\(T(\mathbb{R}^n)\)</span> または余接束 <span class="math inline">\(T^*(\mathbb{R}^n)\)</span> 上の幾何学に変換されるが，やはり有限次元である．<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>ちょうど，非線型力学系において，Koopman　作用素を導入することで，扱う空間が無限次元になってしまう代わりに，ダイナミクスの線型性を回復することに似ている．非線型力学系を扱うにあたって，非線型性の除去が肝心であるように，確率的な系の分析において，ランダムネスを取り除くことが重要であったようだ．<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><span class="citation" data-cites="Jacod-Shiryaev2003">(<a href="#ref-Jacod-Shiryaev2003" role="doc-biblioref">Jacod and Shiryaev, 2003</a>)</span> p.65，<span class="citation" data-cites="Kolokoltsov2011-Generators">(<a href="#ref-Kolokoltsov2011-Generators" role="doc-biblioref">Kolokoltsov, 2011</a>)</span> 3.5節 p.110, <span class="citation" data-cites="Klenke2020">(<a href="#ref-Klenke2020" role="doc-biblioref">Klenke, 2020</a>)</span> 8.3節 p.204 では transition kernel，<span class="citation" data-cites="Dellacherie-Meyer1988">(<a href="#ref-Dellacherie-Meyer1988" role="doc-biblioref">Dellacherie and Meyer, 1988</a>)</span> p.1，<span class="citation" data-cites="Revuz-Yor1999">(<a href="#ref-Revuz-Yor1999" role="doc-biblioref">Revuz and Yor, 1999</a>)</span> 定義III.1.1.1 p.79，<span class="citation" data-cites="Revuz1984">(<a href="#ref-Revuz1984" role="doc-biblioref">Revuz, 1984</a>)</span> 定義1.1.1.1 p.8，<span class="citation" data-cites="Kallenberg2017">(<a href="#ref-Kallenberg2017" role="doc-biblioref">Kallenberg, 2017</a>)</span> p.16, <span class="citation" data-cites="Bass2011">(<a href="#ref-Bass2011" role="doc-biblioref">Bass, 2011</a>)</span> 定義19.2 p.154 では kernel と呼んでいる．<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p><span class="citation" data-cites="Revuz1984">(<a href="#ref-Revuz1984" role="doc-biblioref">Revuz, 1984</a>)</span> 定義1.1.1.1 p.8 では符号付き測度であることを許しているが，我々はその場合は <strong>符号付き核</strong> と呼ぶこととしよう．<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p><span class="citation" data-cites="Crisan-Doucet2002">(<a href="#ref-Crisan-Doucet2002" role="doc-biblioref">Crisan and Doucet, 2002</a>)</span> p.737 では Markov transition kernel，<span class="citation" data-cites="DelMoral04-FeynmanKacFormulae">(<a href="#ref-DelMoral04-FeynmanKacFormulae" role="doc-biblioref">Del&nbsp;Moral, 2004</a>)</span> p.9 では Markov kernel，<span class="citation" data-cites="Kolokoltsov2011-Generators">(<a href="#ref-Kolokoltsov2011-Generators" role="doc-biblioref">Kolokoltsov, 2011</a>)</span> 3.5節 p.110 では transition probability kernel or simply probability kernel と呼び，<span class="citation" data-cites="Chopin-Papaspiliopoulos20-SMC">(<a href="#ref-Chopin-Papaspiliopoulos20-SMC" role="doc-biblioref">Chopin and Papaspiliopoulos, 2020</a>)</span> 定義4.1 p.36, <span class="citation" data-cites="Bremaud20-Processes">(<a href="#ref-Bremaud20-Processes" role="doc-biblioref">Bremaud, 2020</a>)</span> 3.3.3節 p.135 では propability kernel，<span class="citation" data-cites="Kulik2018">(<a href="#ref-Kulik2018" role="doc-biblioref">Kulik, 2018</a>)</span> p.25 では probability kernel としてさらに半群性も満たす族を transition probability kernels と呼ぶ．<span class="citation" data-cites="LeGall2016">(<a href="#ref-LeGall2016" role="doc-biblioref">Le Gall, 2016</a>)</span> pp.151-152 は Markovian transition kernel と transition semigroup と呼ぶ．<span class="citation" data-cites="Dellacherie-Meyer1988">(<a href="#ref-Dellacherie-Meyer1988" role="doc-biblioref">Dellacherie and Meyer, 1988</a>)</span> p.2 は Markovian kernel．<span class="citation" data-cites="Kallenberg2017">(<a href="#ref-Kallenberg2017" role="doc-biblioref">Kallenberg, 2017</a>)</span> p.29 と <span class="citation" data-cites="Hairer2021-Convergence">(<a href="#ref-Hairer2021-Convergence" role="doc-biblioref">Hairer, 2021</a>)</span> では可測関数 <span class="math inline">\(E\to\mathcal{P}(F)\)</span> と定義しており，transition kernel と呼んでしまう．<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p><span class="citation" data-cites="Dellacherie-Meyer1988">(<a href="#ref-Dellacherie-Meyer1988" role="doc-biblioref">Dellacherie and Meyer, 1988</a>)</span> p.2，<span class="citation" data-cites="Kolokoltsov2011-Generators">(<a href="#ref-Kolokoltsov2011-Generators" role="doc-biblioref">Kolokoltsov, 2011</a>)</span> 3.5節 p.110．<span class="citation" data-cites="DelMoral04-FeynmanKacFormulae">(<a href="#ref-DelMoral04-FeynmanKacFormulae" role="doc-biblioref">Del&nbsp;Moral, 2004, p. 9</a>)</span> は (bounded) integral operator と呼ぶ．<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p><span class="citation" data-cites="Kolokoltsov2011-Generators">(<a href="#ref-Kolokoltsov2011-Generators" role="doc-biblioref">Kolokoltsov, 2011, p. 110</a>)</span> 3.5節 も参照．<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p><span class="citation" data-cites="鎌谷研吾2021">(<a href="#ref-鎌谷研吾2021" role="doc-biblioref">鎌谷研吾, 2021, p. 382</a>)</span> の呼称に一致．<span class="citation" data-cites="Dellacherie-Meyer1988">(<a href="#ref-Dellacherie-Meyer1988" role="doc-biblioref">Dellacherie and Meyer, 1988, p. 4</a>)</span> は composition，<span class="citation" data-cites="Gikhman-Skorokhod2004I">(<a href="#ref-Gikhman-Skorokhod2004I" role="doc-biblioref">Gikhman and Skorokhod, 2004, p. 76</a>)</span> 定理II.4.1 は畳み込みと呼ぶ．<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>これは一般の符号付き核については成り立たない <span class="citation" data-cites="Revuz1984">(<a href="#ref-Revuz1984" role="doc-biblioref">Revuz, 1984, p. 12</a>)</span>．<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p><span class="citation" data-cites="Jacod-Shiryaev2003">(<a href="#ref-Jacod-Shiryaev2003" role="doc-biblioref">Jacod and Shiryaev, 2003, p. 65</a>)</span>，<span class="citation" data-cites="Klenke2020">(<a href="#ref-Klenke2020" role="doc-biblioref">Klenke, 2020, p. 205</a>)</span> 8.3節．<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p><span class="citation" data-cites="Dellacherie-Meyer1988">(<a href="#ref-Dellacherie-Meyer1988" role="doc-biblioref">Dellacherie and Meyer, 1988</a>)</span> 7 p.4，<span class="citation" data-cites="Revuz1984">(<a href="#ref-Revuz1984" role="doc-biblioref">Revuz, 1984, p. 9</a>)</span>，<span class="citation" data-cites="Revuz1984">(<a href="#ref-Revuz1984" role="doc-biblioref">Revuz, 1984, p. 13</a>)</span> 演習1.13．<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p><span class="citation" data-cites="Dellacherie-Meyer1988">(<a href="#ref-Dellacherie-Meyer1988" role="doc-biblioref">Dellacherie and Meyer, 1988, p. 5</a>)</span> 7，<span class="citation" data-cites="Revuz1984">(<a href="#ref-Revuz1984" role="doc-biblioref">Revuz, 1984, p. 9</a>)</span>，<span class="citation" data-cites="Dellacherie-Meyer1988">(<a href="#ref-Dellacherie-Meyer1988" role="doc-biblioref">Dellacherie and Meyer, 1988, p. 2</a>)</span>．<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>作用は <span class="citation" data-cites="Hairer2021-Convergence">(<a href="#ref-Hairer2021-Convergence" role="doc-biblioref">Hairer, 2021</a>)</span>, <span class="citation" data-cites="Kallenberg2017">(<a href="#ref-Kallenberg2017" role="doc-biblioref">Kallenberg, 2017, p. 16</a>)</span>, <span class="citation" data-cites="Dellacherie-Meyer1988">(<a href="#ref-Dellacherie-Meyer1988" role="doc-biblioref">Dellacherie and Meyer, 1988, pp. 2–3</a>)</span> が同様に定めている．最後の文献によると，この記法は Hunt によるものだという．<span class="math inline">\(T\otimes S\)</span> の存在は <span class="citation" data-cites="Gikhman-Skorokhod2004I">(<a href="#ref-Gikhman-Skorokhod2004I" role="doc-biblioref">Gikhman and Skorokhod, 2004, p. 76</a>)</span> 定理II.4.1 で示されており，<span class="math inline">\(\otimes\)</span> を <strong>直積</strong>，<span class="math inline">\(\cdot\)</span> を <strong>畳み込み</strong> と呼んでいる．<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>これが <span class="math inline">\(\mathcal{E}\)</span>-可測であることは，<span class="math inline">\(f\)</span> の単関数近似を考えることで示せる <span class="citation" data-cites="Dellacherie-Meyer1988">(<a href="#ref-Dellacherie-Meyer1988" role="doc-biblioref">Dellacherie and Meyer, 1988, p. 2</a>)</span>．<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn15"><p><span class="citation" data-cites="Revuz1984">(<a href="#ref-Revuz1984" role="doc-biblioref">Revuz, 1984, p. 10</a>)</span>．p.36 も参照．<a href="#fnref15" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn16"><p><span class="citation" data-cites="Revuz1984">(<a href="#ref-Revuz1984" role="doc-biblioref">Revuz, 1984, p. 36</a>)</span>，<span class="citation" data-cites="Revuz-Yor1999">(<a href="#ref-Revuz-Yor1999" role="doc-biblioref">Revuz and Yor, 1999, p. 412</a>)</span>．<a href="#fnref16" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn17"><p>(1)は <span class="citation" data-cites="Revuz1984">(<a href="#ref-Revuz1984" role="doc-biblioref">Revuz, 1984, p. 9</a>)</span> と <span class="citation" data-cites="Dellacherie-Meyer1988">(<a href="#ref-Dellacherie-Meyer1988" role="doc-biblioref">Dellacherie and Meyer, 1988, pp. 5 p.3</a>)</span>，(2)は <span class="citation" data-cites="Dellacherie-Meyer1988">(<a href="#ref-Dellacherie-Meyer1988" role="doc-biblioref">Dellacherie and Meyer, 1988, pp. 7 p.4</a>)</span>．<a href="#fnref17" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn18"><p><span class="citation" data-cites="Revuz1984">(<a href="#ref-Revuz1984" role="doc-biblioref">Revuz, 1984, p. 12</a>)</span>．<a href="#fnref18" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn19"><p><span class="citation" data-cites="Kallenberg2017">(<a href="#ref-Kallenberg2017" role="doc-biblioref">Kallenberg, 2017, p. 30</a>)</span> 補題1.14 では Borel 空間について示している．<span class="citation" data-cites="Hairer2021-Convergence">(<a href="#ref-Hairer2021-Convergence" role="doc-biblioref">Hairer, 2021</a>)</span> ではあらかじめ (2) を定義としている．<span class="citation" data-cites="DelMoral04-FeynmanKacFormulae">(<a href="#ref-DelMoral04-FeynmanKacFormulae" role="doc-biblioref">Del&nbsp;Moral, 2004, p. 7</a>)</span> は最初からこれによって <span class="math inline">\(\sigma\)</span>-代数を定義する．<span class="citation" data-cites="Ambrosio+2008">(<a href="#ref-Ambrosio+2008" role="doc-biblioref">Ambrosio et al., 2008, p. 121</a>)</span> も初めからこれを通じて，可分距離空間 <span class="math inline">\(Y\)</span> に対する Borel 写像 <span class="math inline">\(X\to\cP(Y)\)</span> を定義する．(3) は <span class="citation" data-cites="Ambrosio+2008">(<a href="#ref-Ambrosio+2008" role="doc-biblioref">Ambrosio et al., 2008, p. 121</a>)</span>．<a href="#fnref19" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn20"><p><span class="citation" data-cites="Hairer2018">(<a href="#ref-Hairer2018" role="doc-biblioref">Hairer, 2018, p. 8</a>)</span> 演習2.34．<a href="#fnref20" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn21"><p><span class="citation" data-cites="Revuz1984">(<a href="#ref-Revuz1984" role="doc-biblioref">Revuz, 1984, p. 9</a>)</span> 命題1.3．<a href="#fnref21" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/162348\.github\.io\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
        for (let i=0; i<annoteTargets.length; i++) {
          const annoteTarget = annoteTargets[i];
          const targetCell = annoteTarget.getAttribute("data-target-cell");
          const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
          const contentFn = () => {
            const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            if (content) {
              const tipContent = content.cloneNode(true);
              tipContent.classList.add("code-annotation-tip-content");
              return tipContent.outerHTML;
            }
          }
          const config = {
            allowHTML: true,
            content: contentFn,
            onShow: (instance) => {
              selectCodeLines(instance.reference);
              instance.reference.classList.add('code-annotation-active');
              window.tippy.hideAll();
            },
            onHide: (instance) => {
              unselectCodeLines();
              instance.reference.classList.remove('code-annotation-active');
            },
            maxWidth: 300,
            delay: [50, 0],
            duration: [200, 0],
            offset: [5, 10],
            arrow: true,
            trigger: 'click',
            appendTo: function(el) {
              return el.parentElement.parentElement.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'quarto',
            placement: 'right',
            positionFixed: true,
            popperOptions: {
              modifiers: [
              {
                name: 'flip',
                options: {
                  flipVariations: false, // true by default
                  allowedAutoPlacements: ['right'],
                  fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                },
              },
              {
                name: 'preventOverflow',
                options: {
                  mainAxis: false,
                  altAxis: false
                }
              }
              ]        
            }      
          };
          window.tippy(annoteTarget, config); 
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
<script>
  function loadGiscus() {
    // Function to get the theme based on body class
    const getTheme = () => {
      let baseTheme = document.getElementById('giscus-base-theme').value;
      let altTheme = document.getElementById('giscus-alt-theme').value;
      return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
    };
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "162348/162348.github.io";
    script.dataset.repoId = "R_kgDOKlfKYQ";
    script.dataset.category = "Announcements";
    script.dataset.categoryId = "DIC_kwDOKlfKYc4CgDmb";
    script.dataset.mapping = "pathname";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "top";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  }
  loadGiscus();
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://162348.github.io/">
<p>Hirofumi Shiba</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/162348/162348.github.io/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ano2math5">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:shiba.hirofumi@ism.ac.jp">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../../blog.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="https://platform.twitter.com/widgets.js"></script>
</body></html>