<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="司馬博文">

<title>非線型な次元縮約法の概観 – Hirofumi Shiba</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../assets/profile.jpg" rel="icon" type="image/jpeg">
<script src="../../../site_libs/quarto-listing/list.min.js"></script>
<script src="../../../site_libs/quarto-listing/quarto-listing.js"></script>
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-cf7929f4d66a2bdccc4ecf0c4d40c672.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-62adebfec53d4c95a7ec1fcfb398e1f1.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "?",
    "H"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>

  window.document.addEventListener("DOMContentLoaded", function (_event) {
    const listingTargetEl = window.document.querySelector('#listing-kernel-listing .list');
    if (!listingTargetEl) {
      // No listing discovered, do not attach.
      return; 
    }

    const options = {
      valueNames: ['listing-title','listing-image','listing-date','listing-subtitle',{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
      
      searchColumns: ["listing-title","listing-author","listing-date","listing-image","listing-description"],
    };

    window['quarto-listings'] = window['quarto-listings'] || {};
    window['quarto-listings']['listing-kernel-listing'] = new List('listing-kernel-listing', options);

    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  });

  window.addEventListener('hashchange',() => {
    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  })
  </script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-36GX2G6GLL"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-36GX2G6GLL', { 'anonymize_ip': true});
</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Zen+Kurenaido&amp;display=swap" rel="stylesheet">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=BIZ+UDPGothic&amp;display=swap" rel="stylesheet">

<style>
  .navbar-title, .menu-text {
      font-family: "Zen Kurenaido", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
  h1, .title, .description, .subtitle {
    font-family: "Zen Kurenaido", sans-serif !important;
  }
</style>

<!-- <style>
  .menu-text {
      font-family: "Gill Sans", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
  .navbar-title {
      font-family: "Gill Sans", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
</style> -->

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../assets/styles.css">
<meta property="og:title" content="非線型な次元縮約法の概観 – Hirofumi Shiba">
<meta property="og:description" content="生成・表現学習と深い関係にあるタスクに，次元縮約がある．非線型な次元縮約法は多様体学習の名前の下でも研究されている．表現学習とも関連が深いが，一般に表現学習はパラメトリックであるとするならば，次元縮約ではノンパラメトリックな表現と視覚化の学習が目標である．">
<meta property="og:image" content="https://162348.github.io/posts/2024/Kernels/Images/UMAPvSNE.png">
<meta property="og:site_name" content="Hirofumi Shiba">
<meta property="og:image:height" content="567">
<meta property="og:image:width" content="876">
<meta name="twitter:title" content="非線型な次元縮約法の概観 – Hirofumi Shiba">
<meta name="twitter:description" content="生成・表現学習と深い関係にあるタスクに，次元縮約がある．非線型な次元縮約法は多様体学習の名前の下でも研究されている．表現学習とも関連が深いが，一般に表現学習はパラメトリックであるとするならば，次元縮約ではノンパラメトリックな表現と視覚化の学習が目標である．">
<meta name="twitter:image" content="https://162348.github.io/posts/2024/Kernels/Images/UMAPvSNE.png">
<meta name="twitter:creator" content="@ano2math5">
<meta name="twitter:image-height" content="567">
<meta name="twitter:image-width" content="876">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Hirofumi Shiba</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../static/English.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Sessions.html"> 
<span class="menu-text">Sessions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../blog.html"> 
<span class="menu-text">ブログ</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Japanese.html"> 
<span class="menu-text">自己紹介</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/162348/162348.github.io/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">非線型な次元縮約法の概観</h1>
            <p class="subtitle lead">最古にして最難のタスクと多様体学習</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Deep</div>
                <div class="quarto-category">Nature</div>
                <div class="quarto-category">Statistics</div>
                <div class="quarto-category">Geometry</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>司馬博文 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">7/30/2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">8/15/2024</p>
      </div>
    </div>
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="block-title">概要</div>
      生成・表現学習と深い関係にあるタスクに，次元縮約がある．非線型な次元縮約法は多様体学習の名前の下でも研究されている．表現学習とも関連が深いが，一般に表現学習はパラメトリックであるとするならば，次元縮約ではノンパラメトリックな表現と視覚化の学習が目標である．
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目次</h2>
   
  <ul>
  <li><a href="#はじめに" id="toc-はじめに" class="nav-link active" data-scroll-target="#はじめに"><span class="header-section-number">1</span> はじめに</a>
  <ul class="collapse">
  <li><a href="#多様体仮説" id="toc-多様体仮説" class="nav-link" data-scroll-target="#多様体仮説"><span class="header-section-number">1.1</span> 多様体仮説</a></li>
  <li><a href="#距離学習との関係" id="toc-距離学習との関係" class="nav-link" data-scroll-target="#距離学習との関係"><span class="header-section-number">1.2</span> 距離学習との関係</a></li>
  <li><a href="#例細胞間の類似度" id="toc-例細胞間の類似度" class="nav-link" data-scroll-target="#例細胞間の類似度"><span class="header-section-number">1.3</span> 例：細胞間の類似度</a></li>
  </ul></li>
  <li><a href="#多次元尺度法-mds" id="toc-多次元尺度法-mds" class="nav-link" data-scroll-target="#多次元尺度法-mds"><span class="header-section-number">2</span> 多次元尺度法 (MDS)</a>
  <ul class="collapse">
  <li><a href="#概要" id="toc-概要" class="nav-link" data-scroll-target="#概要"><span class="header-section-number">2.1</span> 概要</a></li>
  <li><a href="#pca-としての-mds" id="toc-pca-としての-mds" class="nav-link" data-scroll-target="#pca-としての-mds"><span class="header-section-number">2.2</span> PCA としての MDS</a></li>
  <li><a href="#kruskal1964-stress" id="toc-kruskal1964-stress" class="nav-link" data-scroll-target="#kruskal1964-stress"><span class="header-section-number">2.3</span> <span class="citation" data-cites="Kruskal1964">(Kruskal, 1964)</span> Stress</a></li>
  <li><a href="#sammon1969-stress" id="toc-sammon1969-stress" class="nav-link" data-scroll-target="#sammon1969-stress"><span class="header-section-number">2.4</span> <span class="citation" data-cites="Sammon1969">(Sammon, 1969)</span> Stress</a></li>
  <li><a href="#sec-MDU" id="toc-sec-MDU" class="nav-link" data-scroll-target="#sec-MDU"><span class="header-section-number">2.5</span> 多次元展開法 (MDU)</a></li>
  <li><a href="#理想点推定" id="toc-理想点推定" class="nav-link" data-scroll-target="#理想点推定"><span class="header-section-number">2.6</span> 理想点推定</a></li>
  <li><a href="#力指向グラフ展開-fdl-se" id="toc-力指向グラフ展開-fdl-se" class="nav-link" data-scroll-target="#力指向グラフ展開-fdl-se"><span class="header-section-number">2.7</span> 力指向グラフ展開 (FDL / SE)</a></li>
  </ul></li>
  <li><a href="#sec-Isomap" id="toc-sec-Isomap" class="nav-link" data-scroll-target="#sec-Isomap"><span class="header-section-number">3</span> Isomap</a></li>
  <li><a href="#最大分散展開-mvu" id="toc-最大分散展開-mvu" class="nav-link" data-scroll-target="#最大分散展開-mvu"><span class="header-section-number">4</span> 最大分散展開 (MVU)</a>
  <ul class="collapse">
  <li><a href="#カーネル-pca-kpca-scholkopf1998" id="toc-カーネル-pca-kpca-scholkopf1998" class="nav-link" data-scroll-target="#カーネル-pca-kpca-scholkopf1998"><span class="header-section-number">4.1</span> カーネル PCA (kPCA) <span class="citation" data-cites="Scholkopf+1998">(Schölkopf et al., 1998)</span></a></li>
  <li><a href="#半正定値埋め込み" id="toc-半正定値埋め込み" class="nav-link" data-scroll-target="#半正定値埋め込み"><span class="header-section-number">4.2</span> 半正定値埋め込み</a></li>
  </ul></li>
  <li><a href="#局所線型埋め込み-lle" id="toc-局所線型埋め込み-lle" class="nav-link" data-scroll-target="#局所線型埋め込み-lle"><span class="header-section-number">5</span> 局所線型埋め込み (LLE)</a>
  <ul class="collapse">
  <li><a href="#はじめに-1" id="toc-はじめに-1" class="nav-link" data-scroll-target="#はじめに-1"><span class="header-section-number">5.1</span> はじめに</a></li>
  <li><a href="#アルゴリズム" id="toc-アルゴリズム" class="nav-link" data-scroll-target="#アルゴリズム"><span class="header-section-number">5.2</span> アルゴリズム</a></li>
  <li><a href="#hessian-埋め込み-he" id="toc-hessian-埋め込み-he" class="nav-link" data-scroll-target="#hessian-埋め込み-he"><span class="header-section-number">5.3</span> Hessian 埋め込み (HE)</a></li>
  <li><a href="#接空間配置-tsa" id="toc-接空間配置-tsa" class="nav-link" data-scroll-target="#接空間配置-tsa"><span class="header-section-number">5.4</span> 接空間配置 (TSA)</a></li>
  </ul></li>
  <li><a href="#sec-LE" id="toc-sec-LE" class="nav-link" data-scroll-target="#sec-LE"><span class="header-section-number">6</span> スペクトル埋め込み (SE / LE)</a></li>
  <li><a href="#t-分布型確率的近傍埋め込み-t-sne" id="toc-t-分布型確率的近傍埋め込み-t-sne" class="nav-link" data-scroll-target="#t-分布型確率的近傍埋め込み-t-sne"><span class="header-section-number">7</span> <span class="math inline">\(t\)</span>-分布型確率的近傍埋め込み (t-SNE)</a>
  <ul class="collapse">
  <li><a href="#概要-1" id="toc-概要-1" class="nav-link" data-scroll-target="#概要-1"><span class="header-section-number">7.1</span> 概要</a></li>
  <li><a href="#sec-SNE" id="toc-sec-SNE" class="nav-link" data-scroll-target="#sec-SNE"><span class="header-section-number">7.2</span> 確率的近傍埋め込み <span class="citation" data-cites="Hinton-Roweis2002">(SNE, Hinton and Roweis, 2002)</span></a></li>
  <li><a href="#目的関数の対称化" id="toc-目的関数の対称化" class="nav-link" data-scroll-target="#目的関数の対称化"><span class="header-section-number">7.3</span> 目的関数の対称化</a></li>
  <li><a href="#t-分布の導入" id="toc-t-分布の導入" class="nav-link" data-scroll-target="#t-分布の導入"><span class="header-section-number">7.4</span> <span class="math inline">\(t\)</span>-分布の導入</a></li>
  <li><a href="#実装" id="toc-実装" class="nav-link" data-scroll-target="#実装"><span class="header-section-number">7.5</span> 実装</a></li>
  <li><a href="#敏捷な埋め込み-ee" id="toc-敏捷な埋め込み-ee" class="nav-link" data-scroll-target="#敏捷な埋め込み-ee"><span class="header-section-number">7.6</span> 敏捷な埋め込み (EE)</a></li>
  <li><a href="#largevis" id="toc-largevis" class="nav-link" data-scroll-target="#largevis"><span class="header-section-number">7.7</span> LargeVis</a></li>
  <li><a href="#umap" id="toc-umap" class="nav-link" data-scroll-target="#umap"><span class="header-section-number">7.8</span> UMAP</a></li>
  <li><a href="#モデルベース手法" id="toc-モデルベース手法" class="nav-link" data-scroll-target="#モデルベース手法"><span class="header-section-number">7.9</span> モデルベース手法</a></li>
  </ul></li>
  <li><a href="#拡散写像" id="toc-拡散写像" class="nav-link" data-scroll-target="#拡散写像"><span class="header-section-number">8</span> 拡散写像</a>
  <ul class="collapse">
  <li><a href="#はじめに-2" id="toc-はじめに-2" class="nav-link" data-scroll-target="#はじめに-2"><span class="header-section-number">8.1</span> はじめに</a></li>
  <li><a href="#phate" id="toc-phate" class="nav-link" data-scroll-target="#phate"><span class="header-section-number">8.2</span> PHATE</a></li>
  </ul></li>
  <li><a href="#自己組織化写像-som" id="toc-自己組織化写像-som" class="nav-link" data-scroll-target="#自己組織化写像-som"><span class="header-section-number">9</span> 自己組織化写像 (SOM)</a>
  <ul class="collapse">
  <li><a href="#ivis" id="toc-ivis" class="nav-link" data-scroll-target="#ivis"><span class="header-section-number">9.1</span> IVIS</a></li>
  </ul></li>
  <li><a href="#mapper" id="toc-mapper" class="nav-link" data-scroll-target="#mapper"><span class="header-section-number">10</span> Mapper</a></li>
  
  
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="関連ページ" class="level1 unnumbered unlisted">
<h1 class="unnumbered unlisted">関連ページ</h1>
<div id="listing-kernel-listing" class="quarto-listing quarto-listing-container-grid">
<div class="list grid quarto-listing-cols-3">
<div class="g-col-1" data-index="0" data-categories="U3RhdGlzdGljcyUyQ0tlcm5lbCUyQ1Byb2JhYmlsaXR5JTJDQmF5ZXNpYW4=" data-listing-date-sort="1723420800000" data-listing-file-modified-sort="1733445284974" data-listing-date-modified-sort="1723593600000" data-listing-reading-time-sort="6" data-listing-word-count-sort="1072">
<a href="../../../posts/2024/Kernels/HierarchicalModel.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/Kernels/Images/MM.svg" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title" data-anchor-id="関連ページ">
階層モデル再論
</h5>
<div class="card-subtitle listing-subtitle">
多変量解析から機械学習へ
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-08-12
</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="1" data-categories="RGVlcA==" data-listing-date-sort="1722211200000" data-listing-file-modified-sort="1733445284994" data-listing-date-modified-sort="1723420800000" data-listing-reading-time-sort="2" data-listing-word-count-sort="385">
<a href="../../../posts/2024/Kernels/NCL.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/Kernels/Images/contrastive_repr4.jpeg" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
表現学習と非線型独立成分分析
</h5>
<div class="card-subtitle listing-subtitle">
「データ理解」に向けた深層潜在変数モデル
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-07-29
</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="2" data-categories="S2VybmVs" data-listing-date-sort="1723248000000" data-listing-file-modified-sort="1733445284994" data-listing-date-modified-sort="1723334400000" data-listing-reading-time-sort="3" data-listing-word-count-sort="581">
<a href="../../../posts/2024/Kernels/Kernel.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/Kernels/Images/Gibbs.svg" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
カーネル法の概観
</h5>
<div class="card-subtitle listing-subtitle">
半正定値カーネルから距離学習まで
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-08-10
</div>
</div>
</div>
</div>
</a>
</div>
</div>
<div class="listing-no-matching d-none">
No matching items
</div>
</div>
<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
<p>$$</p>
<p>$$</p>
</div>
</section>
<section id="はじめに" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> はじめに</h1>
<p>多様体学習とは，非線型な次元削減手法のことをいう．</p>
<section id="多様体仮説" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="多様体仮説"><span class="header-section-number">1.1</span> 多様体仮説</h2>
<p>「多様体」の名前の由来は，「高次元データは低次元の部分多様体としての構造を持つ」という <strong>多様体仮説</strong> <span class="citation" data-cites="Fefferman+2016">(<a href="#ref-Fefferman+2016" role="doc-biblioref">Fefferman et al., 2016</a>)</span> である．<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>特に多様体学習と呼ばれる際は，知識発見やデータ可視化を重視する志向がある．</p>
<p>一方で自己符号化器などによる表現学習では，種々の下流タスクに有用な表現を得るための分布外汎化が重視される，と言えるだろう．</p>
</section>
<section id="距離学習との関係" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="距離学習との関係"><span class="header-section-number">1.2</span> 距離学習との関係</h2>
<p><a href="../../../posts/2024/Kernels/NCL.html#sec-NCL4RL">近年，対照学習による表現学習が注目されている</a>．このアプローチには，目的関数にサンプル間の類似度に関する事前情報を含めやすいという美点がある．</p>
<p>このような表現学習法は <strong>距離学習</strong> (metric learning) とも呼ばれている．</p>
<p>多くの多様体学習手法や，<span class="math inline">\(\mathbb{R}^d\)</span> への埋め込み手法は，なんらかの意味でサンプル間の類似度を保存する埋め込みを求めている <span class="citation" data-cites="Agrawal+2021">(<a href="#ref-Agrawal+2021" role="doc-biblioref">Agrawal et al., 2021</a>)</span>．</p>
<p>この意味で，「距離学習」というキーワードは，表現学習と多様体学習の交差点を意味していると言えるだろう．</p>
</section>
<section id="例細胞間の類似度" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="例細胞間の類似度"><span class="header-section-number">1.3</span> 例：細胞間の類似度</h2>
<p>現代のシークエンサー NGS (Next Generation Sequencer) では，単一の細胞が保持している mRNA の全体 scRNA-seq (single-cell RNA sequencing) を調べることができ，このような場合は極めて高次元のデータが大量に得られることになる．</p>
<p>例えば COVID-19 重症患者の末梢免疫の状態を調べるために末梢血単核細胞 PBMC<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> から scRNA-seq を行った例 <span class="citation" data-cites="Wilk+2020">(<a href="#ref-Wilk+2020" role="doc-biblioref">Wilk et al., 2020</a>)</span> では，全部で <span class="math inline">\(n=44,721\)</span> の細胞のデータが，<span class="math inline">\(p=26361\)</span> 次元のスパースなベクトルを扱っている．<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
</section>
</section>
<section id="多次元尺度法-mds" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> 多次元尺度法 (MDS)</h1>
<section id="概要" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="概要"><span class="header-section-number">2.1</span> 概要</h2>
<p>多次元尺度法 (MDS: Multi-Dimensional Scaling) <span class="citation" data-cites="Torgenson1952">(<a href="#ref-Torgenson1952" role="doc-biblioref">Torgerson, 1952</a>)</span>, <span class="citation" data-cites="Kruskal1964">(<a href="#ref-Kruskal1964" role="doc-biblioref">Kruskal, 1964</a>)</span> は，元のデータの「（非）類似度」を保存したままの低次元表現を探索する手法群である．</p>
<p>後続の手法はいずれも高次元データ <span class="math inline">\(\{y_i\}_{i=1}^n\subset\mathbb{R}^p\)</span> を所与とするが，MDS は本質的には類似度行列 <span class="math inline">\(D\in M_n(\mathbb{R})\)</span> が与えられていればよく，解析対象は必ずしも <span class="math inline">\(\mathbb{R}^p\)</span>-値のデータである必要はない．</p>
<p>類似度行列 <span class="math inline">\(D\)</span> が与えられたのちは，埋め込み <span class="math inline">\(\{z_i\}_{i=1}^n\subset\mathbb{R}^d\)</span> の要素間の類似度が <span class="math inline">\(D\)</span> に近くなるように埋め込みを学習する．</p>
</section>
<section id="pca-としての-mds" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="pca-としての-mds"><span class="header-section-number">2.2</span> PCA としての MDS</h2>
<p>特にデータ <span class="math inline">\(\{x_i\}_{i=1}^n\subset\mathbb{R}^p\)</span> 間の Euclid 距離を <span class="math inline">\(D\)</span> とし，埋め込み <span class="math inline">\(\{z_i\}_{i=1}^n\subset\mathbb{R}^d\)</span> の間の経験共分散が <span class="math inline">\(D\)</span> に Hilbert-Schmidt ノルムに関して最小化することを <span class="citation" data-cites="Torgenson1952">(<a href="#ref-Torgenson1952" role="doc-biblioref">Torgerson, 1952</a>)</span> は考えた．</p>
<p>これは <a href="../../../posts/2024/FunctionalAnalysis/SVD.html"><span class="citation" data-cites="Eckart-Young1936">(<span>Eckart and Young, 1936</span>)</span> の定理</a> を通じて <a href="../../../posts/2024/Kernels/HierarchicalModel.html#sec-PCA">PCA</a> に一致する，線型な次元縮約法となる．</p>
<p><span class="citation" data-cites="Torgenson1952">(<a href="#ref-Torgenson1952" role="doc-biblioref">Torgerson, 1952</a>)</span> のアプローチは <strong>計量</strong>多次元尺度法と呼ばれ，一般のデータに適用可能な <span class="citation" data-cites="Kruskal1964">(<a href="#ref-Kruskal1964" role="doc-biblioref">Kruskal, 1964</a>)</span> のアプローチは<strong>非計量</strong>多次元尺度法と対照される．<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
</section>
<section id="kruskal1964-stress" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="kruskal1964-stress"><span class="header-section-number">2.3</span> <span class="citation" data-cites="Kruskal1964">(<a href="#ref-Kruskal1964" role="doc-biblioref">Kruskal, 1964</a>)</span> Stress</h2>
<p>前述の通り，<span class="math inline">\(D\)</span> は Euclid 距離に基づくとは限らないし，そもそもデータはベクトルなど構造化されているものでなくても良い．</p>
<p>このような一般的な場面で <span class="math inline">\(\{z_i\}_{i=1}^n\subset\mathbb{R}^d\)</span> 間の類似度の <span class="math inline">\(D\)</span> との「近さ」を図る尺度として，Kruskal の Stress-1 <span class="citation" data-cites="Kruskal1964">(<a href="#ref-Kruskal1964" role="doc-biblioref">Kruskal, 1964</a>)</span> がよく用いられる： <span class="math display">\[
\mathcal{L}(E):=\sqrt{\frac{\sum_{i_1&lt;i_2}\left(z_{i_1i_2}-d_{i_1i_2}\right)^2}{\sum_{i_1&lt;i_2}d_{i_1i_2}^2}}.
\]</span></p>
<p>勾配法を用いた最適化ベースの推論手法が使えるが，この目的関数に関しては SMACOF (Scaling by Majorizing a Complementary Function) <span class="citation" data-cites="deLeeuw1977">(<a href="#ref-deLeeuw1977" role="doc-biblioref">de Leeuw, 1977</a>)</span> という凸最適化アルゴリズムが提案されており，<a href="https://scikit-learn.org/stable/modules/generated/sklearn.manifold.smacof.html"><code>scikit-learn</code> にも実装されている</a>．</p>
</section>
<section id="sammon1969-stress" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="sammon1969-stress"><span class="header-section-number">2.4</span> <span class="citation" data-cites="Sammon1969">(<a href="#ref-Sammon1969" role="doc-biblioref">Sammon, 1969</a>)</span> Stress</h2>
<p><span class="citation" data-cites="Sammon1969">(<a href="#ref-Sammon1969" role="doc-biblioref">Sammon, 1969</a>)</span> は探索的データ解析の文脈から，データの「構造」をよく保つために，<span class="math inline">\(z_{i_1i_2}\)</span> の値が小さい場合は小さな変化も重視してくれるようにスケーリングを調整する新たなストレス関数を提案した：</p>
<p><span class="math display">\[
\frac{1}{\sum_{i_1&lt;i_2}z_{i_1i_2}}\sum_{i_1&lt;i_2}\frac{\left(z_{i_1i_2}-d_{i_1i_2}\right)^2}{z_{i_1i_2}}.
\]</span></p>
<p>係数 <span class="math inline">\(\frac{1}{\sum_{i_1&lt;i_2}z_{i_1i_2}}\)</span> の存在は，勾配法による推論を効率的にする．</p>
</section>
<section id="sec-MDU" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="sec-MDU"><span class="header-section-number">2.5</span> 多次元展開法 (MDU)</h2>
<p>多次元展開法 (MDU: Multi-Dimensional Unfolding) は，個人の選考順位データに対処するために <span class="citation" data-cites="Coombs1950">(<a href="#ref-Coombs1950" role="doc-biblioref">Coombs, 1950</a>)</span> が提唱した，多次元尺度法 (MDS) の拡張である <span class="citation" data-cites="足立浩平2000">(<a href="#ref-足立浩平2000" role="doc-biblioref">足立浩平, 2000</a>)</span>．</p>
<p>MDU ではさらに一般的な行列 <span class="math inline">\(D\)</span> を取ることができる．というのも，MDS では暗黙のうちに行と列は同一物であり，<span class="math inline">\(D\)</span> の対角成分は全て一定であるが，MDU では行と列で別の対象を取ることができる．</p>
<p>例えば，個体 <span class="math inline">\(i\)</span> が項目 <span class="math inline">\(j\)</span> をどれくらい好むか？を <span class="math inline">\(D\)</span> と取り，行と列を同一の平面上に <a href="https://en.wikipedia.org/wiki/Biplot">バイプロット</a> <span class="citation" data-cites="Gabriel1971">(<a href="#ref-Gabriel1971" role="doc-biblioref">Gabriel, 1971</a>)</span>, <span class="citation" data-cites="Gower2004">(<a href="#ref-Gower2004" role="doc-biblioref">Gower, 2004</a>)</span> する．</p>
</section>
<section id="理想点推定" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="理想点推定"><span class="header-section-number">2.6</span> <a href="../../../posts/2024/TransDimensionalModels/IdealPoint.html">理想点推定</a></h2>
<p>特に政治科学の分野で用いられる多次元展開手法であり，<span class="math inline">\(\mathbb{R}^d\;(d\le3)\)</span> に埋め込むことが考えられる．</p>
<p>その際は <span class="math inline">\(\mathbb{R}^d\)</span> 上への観測に至るまでの階層モデル（潜在変数モデル）を立てて，全体を MCMC により推定する方法が，<span class="citation" data-cites="Martin-Quinn2002">(<a href="#ref-Martin-Quinn2002" role="doc-biblioref">Martin and Quinn, 2002</a>)</span> 以来中心的である．</p>
<p><span class="citation" data-cites="Imai+2016">(<a href="#ref-Imai+2016" role="doc-biblioref">Imai et al., 2016</a>)</span>，<span class="citation" data-cites="三輪洋文2017">(<a href="#ref-三輪洋文2017" role="doc-biblioref">三輪洋文, 2017</a>)</span> は変分 EM アルゴリズムにより推定している．</p>
</section>
<section id="力指向グラフ展開-fdl-se" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="力指向グラフ展開-fdl-se"><span class="header-section-number">2.7</span> 力指向グラフ展開 (FDL / SE)</h2>
<p><a href="https://ja.wikipedia.org/wiki/力学モデル_(グラフ描画アルゴリズム)">力学モデルによるグラフ描画法</a> (Force-directed layout / Spring Embedder) <span class="citation" data-cites="Tutte1963">(<a href="#ref-Tutte1963" role="doc-biblioref">Tutte, 1963</a>)</span>, <span class="citation" data-cites="Eades1984">(<a href="#ref-Eades1984" role="doc-biblioref">Eades, 1984</a>)</span>, <span class="citation" data-cites="Kamada-Kawai1989">(<a href="#ref-Kamada-Kawai1989" role="doc-biblioref">Kamada and Kawai, 1989</a>)</span> は，グラフの頂点を質点，辺をバネに見立てて，グラフを <span class="math inline">\(\mathbb{R}^2\)</span> 上に展開する方法である．</p>
<p>超大規模集積回路 (VLSI) の設計問題と両輪で発展してきた <span class="citation" data-cites="Fisk+1967">(<a href="#ref-Fisk+1967" role="doc-biblioref">Fisk et al., 1967</a>)</span>, <span class="citation" data-cites="Quinn-Breuer1979">(<a href="#ref-Quinn-Breuer1979" role="doc-biblioref">Quinn and Breuer, 1979</a>)</span>．</p>
<p>このグラフ埋め込み法はポテンシャルエネルギーをストレスと見立てた MDS とみなせる．</p>
</section>
</section>
<section id="sec-Isomap" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Isomap</h1>
<p>MDS 法の難点の１つに，データがある部分多様体上に存在する場合，その部分多様体上の測地距離を尊重できないという点がある．</p>
<p>このデータの部分多様体構造を尊重した測地距離をグラフにより捉え，MDS を実行する手法が Isomap <span class="citation" data-cites="Tenenbaum+2000">(<a href="#ref-Tenenbaum+2000" role="doc-biblioref">Tenenbaum et al., 2000</a>)</span> である．</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Isomap：データの多様体構造を尊重した MDS">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Isomap：データの多様体構造を尊重した MDS
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>データを頂点とした <span class="math inline">\(K\)</span>-近傍グラフを構成する．</li>
<li>測地距離を，このグラフ上の最短距離として近似する．</li>
<li>こうして得た近似測地距離を用いて MDS を行う．</li>
</ol>
</div>
</div>
<p>ステップ２においては Dijkstra 法を用いることができ，高速な計算が可能である．</p>
<p>しかし Isomap はデータの摂動に極めて弱いことが topological instability として知られている <span class="citation" data-cites="Balasubramanian-Schwartz2002">(<a href="#ref-Balasubramanian-Schwartz2002" role="doc-biblioref">Balasubramanian and Schwartz, 2002</a>)</span>．</p>
<p>この安定性をカーネル法に外注する Robust Kernel Isomap <span class="citation" data-cites="Choi-Choi2007">(<a href="#ref-Choi-Choi2007" role="doc-biblioref">Choi and Choi, 2007</a>)</span> も提案されている．</p>
</section>
<section id="最大分散展開-mvu" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> 最大分散展開 (MVU)</h1>
<section id="カーネル-pca-kpca-scholkopf1998" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="カーネル-pca-kpca-scholkopf1998"><span class="header-section-number">4.1</span> <a href="../../../posts/2023/KernelMethods/KernelMethods4Mathematicians.html#sec-KPCA">カーネル PCA</a> (kPCA) <span class="citation" data-cites="Scholkopf+1998">(<a href="#ref-Scholkopf+1998" role="doc-biblioref">Schölkopf et al., 1998</a>)</span></h2>
<p>カーネル法の見地からは，従来の PCA は線型な核を用いた場合のカーネル主成分分析だったと相対化される．</p>
<p>しかし，少なくとも RBF カーネルを用いた場合は <span class="citation" data-cites="Weinberger+2004">(<a href="#ref-Weinberger+2004" role="doc-biblioref">Weinberger et al., 2004</a>)</span>，次元縮約の代わりにより高次元な空間に埋め込みがちである．</p>
</section>
<section id="半正定値埋め込み" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="半正定値埋め込み"><span class="header-section-number">4.2</span> 半正定値埋め込み</h2>
<p>カーネル PCA を次元縮約のために用いたものが <strong>半正定値埋め込み</strong> (semidefinite embedding) または <strong>最大分散展開</strong> (MVU: Maximum Vairance Unfolding) <span class="citation" data-cites="Weinberger+2004">(<a href="#ref-Weinberger+2004" role="doc-biblioref">Weinberger et al., 2004</a>)</span> である．</p>
<p>これは，カーネル PCA による埋め込みの中でも，元データ <span class="math inline">\(y\)</span> と埋め込み <span class="math inline">\(z\)</span> の間で <span class="math display">\[
\|z_i-z_j\|_2=\|y_i-y_j\|_2,\qquad(i,j)\in G
\]</span> を <span class="math inline">\(K\)</span>-近傍 <span class="math inline">\(G\)</span> に関して満たすような埋め込みの中で， <span class="math display">\[
\max_{z\in\mathbb{R}^d}\sum_{i,j}\|z_i-z_j\|_2^2
\]</span> を最大にするものを求めることを考える．</p>
<p>幸い，これを満たすカーネル関数は半正定値計画によって解くことができ，このカーネル関数によるカーネル PCA 法が MVU である．</p>
</section>
</section>
<section id="局所線型埋め込み-lle" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> 局所線型埋め込み (LLE)</h1>
<section id="はじめに-1" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="はじめに-1"><span class="header-section-number">5.1</span> はじめに</h2>
<p>ここまでの手法は畢竟，類似度行列 <span class="math inline">\(Y\)</span> に関して，kPCA は特徴空間上でのスペクトル分解，Isomap はデータのなす <span class="math inline">\(K\)</span>-近傍グラフ上でのスペクトル分解を考えている．</p>
<p>これに対して，スパースなスペクトル分解を用いることで，データの局所的構造がさらに尊重できることが，<strong>局所線型埋め込み</strong> (LLE: Local Linear Embedding) <span class="citation" data-cites="Roweis-Saul2000">(<a href="#ref-Roweis-Saul2000" role="doc-biblioref">Roweis and Saul, 2000</a>)</span> として提案された．</p>
<p>この方法は Isomap よりデータの摂動に関して頑健であることが知られている．</p>
</section>
<section id="アルゴリズム" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="アルゴリズム"><span class="header-section-number">5.2</span> アルゴリズム</h2>
<p>この方法では，データ多様体の接空間に注目する．</p>
<p>まず，各点をその <span class="math inline">\(K\)</span>-近傍点の線型結合で表す方法を，次のように学習する： <span class="math display">\[
\widehat{W}=\min_{W}\sum_{i=1}^n\left(x_i-\sum_{j=1}^nw_{ij}x_j\right)^2,\qquad\operatorname{subject to}\begin{cases}w_{ij}=0&amp;x_i,x_j\,\text{は}\,K\text{-近傍でない}\\\sum_{j=1}^Nw_{ij}=1&amp;\text{任意の}\,i\in[N]\,\text{について}\end{cases}
\]</span> こうして得た <span class="math inline">\(\widehat{W}\)</span> はスパース行列になる．この <span class="math inline">\(W\)</span> を通じて，局所構造を保った低次元埋め込みを構成する： <span class="math display">\[
\widehat{Z}=\operatorname*{argmin}_Z\sum_{i=1}^n\left\|z_i-\sum_{j=1}^n\widehat{w}_{ij}z_j\right\|_2^2.
\]</span></p>
<p>この最適化問題は，<span class="math inline">\(I_n-W\)</span> の <a href="../../../posts/2024/FunctionalAnalysis/SVD.html">特異値分解</a> に帰着する．</p>
</section>
<section id="hessian-埋め込み-he" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="hessian-埋め込み-he"><span class="header-section-number">5.3</span> Hessian 埋め込み (HE)</h2>
<p>Hessian Eigenmaps <span class="citation" data-cites="Donoho-Grimes2003">(<a href="#ref-Donoho-Grimes2003" role="doc-biblioref">Donoho and Grimes, 2003</a>)</span> は微分幾何学的見方を推し進め，Hessian からの情報を取り入れた局所線型埋め込みの変種である．</p>
</section>
<section id="接空間配置-tsa" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="接空間配置-tsa"><span class="header-section-number">5.4</span> 接空間配置 (TSA)</h2>
<p>Tangent Space Alignment <span class="citation" data-cites="Zhang-Zha2004">(<a href="#ref-Zhang-Zha2004" role="doc-biblioref">Zhang and Zha, 2004</a>)</span> はより明示的に接空間の構造に注目する．</p>
</section>
</section>
<section id="sec-LE" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> スペクトル埋め込み (SE / LE)</h1>
<p>Laplacian Eigenmaps または Spectral Embedding <span class="citation" data-cites="Mikhali-Partha2001">(<a href="#ref-Mikhali-Partha2001" role="doc-biblioref">Belkin and Niyogi, 2001</a>)</span> は，データ点の <span class="math inline">\(K\)</span>-近傍グラフ <span class="math inline">\((Y,E)\)</span> 上で <span class="math display">\[
\mathcal{L}(Z):=\sum_{(i,j)\in E}W_{ij}\|z_i-z_j\|_2^2,\qquad W_{ij}:=\exp\left(-\frac{\|y_i-y_j\|_2^2}{2\sigma^2}\right)
\]</span> を最小化する埋め込み <span class="math inline">\(Z\)</span> を求める方法である．</p>
<p>この目的関数 <span class="math inline">\(\mathcal{L}(Z)\)</span> は実は，<span class="math inline">\(K\)</span>-近傍グラフ <span class="math inline">\((Y,E)\)</span> の Laplacian 行列 <span class="math inline">\(L\)</span> に関して <span class="math display">\[
\mathcal{L}(Z)=2\operatorname{Tr}(Z^\top LZ)
\]</span> とも表せる．</p>
<p>この量は，<span class="math inline">\(Z\)</span> をグラフ上の関数と見た際の Dirichlet 汎函数になっており，グラフ上の関数としての「滑らかさ」の尺度となっている．</p>
<p>最も滑らかであるような <span class="math inline">\(Z\)</span> を学習することで，データの局所構造を最も反映した埋め込みが得られる，というアイデアである．</p>
</section>
<section id="t-分布型確率的近傍埋め込み-t-sne" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> <span class="math inline">\(t\)</span>-分布型確率的近傍埋め込み (t-SNE)</h1>
<section id="概要-1" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="概要-1"><span class="header-section-number">7.1</span> 概要</h2>
<p>SNE <span class="citation" data-cites="Hinton-Roweis2002">(<a href="#ref-Hinton-Roweis2002" role="doc-biblioref">Hinton and Roweis, 2002</a>)</span> では，<span class="math inline">\(K\)</span>-近傍グラフを用いた <a href="#sec-Isomap">Isomap</a> を，ハードな帰属からソフトな帰属へ，確率分布を用いて軟化する．</p>
<p>t-SNE <span class="citation" data-cites="Maaten-Hinton2008">(<a href="#ref-Maaten-Hinton2008" role="doc-biblioref">van der Maaten and Hinton, 2008</a>)</span> では SNE が Gauss 核を用いていたところを Laplace 核（<span class="math inline">\(t\)</span>-分布）を用いることで，より分散した表現を得ることを目指す．</p>
</section>
<section id="sec-SNE" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="sec-SNE"><span class="header-section-number">7.2</span> 確率的近傍埋め込み <span class="citation" data-cites="Hinton-Roweis2002">(SNE, <a href="#ref-Hinton-Roweis2002" role="doc-biblioref">Hinton and Roweis, 2002</a>)</span></h2>
<p>ハイパーパラメータ <span class="math inline">\(\sigma_i\)</span> を残して， <span class="math display">\[
p_{j|i}:=\frac{\exp\left(-\frac{\lvert x_i-x_j\rvert^2}{2\sigma_i^2}\right)}{\sum_{k\neq i}\exp\left(-\frac{\lvert x_i-x_k\rvert^2}{2\sigma_i^2}\right)}
\]</span> と定める．</p>
<p>この <span class="math inline">\((p_{j|i})\)</span> と，潜在空間における帰属確率 <span class="math display">\[
q_{j|i}:=\frac{e^{-\lvert z_i-z_j\rvert^2}}{\sum_{k\neq i}e^{-\lvert z_i-z_k\rvert^2}}
\]</span> と一致するように埋め込みを学習する．すなわち，訓練目標は <span class="math display">\[
\mathcal{L}:=\sum_{i=1}^n\operatorname{KL}(p_{-|i},q_{-|i})=\sum_{i,j=1}^np_{j|i}\log\frac{p_{j|i}}{q_{j|i}}
\]</span> と定める．</p>
<p>この目的関数は凸ではなく，SGD で訓練可能であるが特殊なノイズスケジュールなどのテクニックがある．<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<p>SNE は，ある事前分布を課した<a href="#sec-LE">スペクトル埋め込み</a>とも見れる <span class="citation" data-cites="Carreira-Perpinan2010">(<a href="#ref-Carreira-Perpinan2010" role="doc-biblioref">Carreira-Perpiñan, 2010</a>)</span>．</p>
</section>
<section id="目的関数の対称化" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="目的関数の対称化"><span class="header-section-number">7.3</span> 目的関数の対称化</h2>
<p><span class="math inline">\(p_{i|j},q_{i|j}\)</span> ではなく，結合分布 <span class="math inline">\(p_{ij},q_{ij}\)</span> を用いることで，目的関数を対称化することができる．</p>
<p>このとき，目的関数の勾配は次のようになる： <span class="math display">\[
\nabla_{z_i}\mathcal{L}(Z)=2\sum_{j=1}^n(z_j-z_i)(p_{ij}-q_{ij}).
\]</span></p>
</section>
<section id="t-分布の導入" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="t-分布の導入"><span class="header-section-number">7.4</span> <span class="math inline">\(t\)</span>-分布の導入</h2>
<p>t-SNE <span class="citation" data-cites="Maaten-Hinton2008">(<a href="#ref-Maaten-Hinton2008" role="doc-biblioref">van der Maaten and Hinton, 2008</a>)</span> は <span class="math inline">\(p_{j|i}\)</span> の定義に Gauss 核を用いていたところを，Cauchy 分布の密度（Poisson 核）に置き換えたものである： <span class="math display">\[
q_{ij}=\frac{\frac{1}{1+\lvert z_i-z_j\rvert^2}}{\sum_{k&lt;l}\frac{1}{1+\lvert z_k-z_l\rvert^2}}.
\]</span></p>
<p>このことにより，元々遠かったデータ点を引き寄せ過ぎてしまうこと (crowding problem) を回避できる．</p>
<p>勾配は <span class="math display">\[
\nabla_{z_i}\mathcal{L}(Z)=4\sum_{j=1}^n(z_j-z_i)(p_{ij}-q_{ij})\frac{1}{1+\lvert z_i-z_j\rvert^2}
\]</span> で与えられ，対称化された SNE に，<span class="math inline">\(z_i,z_j\)</span> の距離に従って調整する因子が追加された形になっている．</p>
</section>
<section id="実装" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="実装"><span class="header-section-number">7.5</span> 実装</h2>
<p>t-SNE は <span class="math inline">\(O(n^2)\)</span> であるが，埋め込みの次元数が <span class="math inline">\(d=2\)</span> などの低次元であるとき，これを <span class="math inline">\(O(n\log n)\)</span> にまで加速する実装が知られている <span class="citation" data-cites="vanderMaaten2014">(<a href="#ref-vanderMaaten2014" role="doc-biblioref">Maaten, 2014</a>)</span>．</p>
</section>
<section id="敏捷な埋め込み-ee" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="敏捷な埋め込み-ee"><span class="header-section-number">7.6</span> 敏捷な埋め込み (EE)</h2>
<p>t-SNE はハイパーパラメータ <span class="math inline">\(\sigma_i^2\)</span> の設定に敏感である上に訓練が局所解にトラップされるなど不安定で，またデータ内のノイズに弱いことが知られている <span class="citation" data-cites="Wattemnerg+2016">(<a href="#ref-Wattemnerg+2016" role="doc-biblioref">Wattenberg et al., 2016</a>)</span>．</p>
<p><strong>敏捷な埋め込み</strong> (EN: Elastic Net) <span class="citation" data-cites="Carreira-Perpinan2010">(<a href="#ref-Carreira-Perpinan2010" role="doc-biblioref">Carreira-Perpiñan, 2010</a>)</span> という，より安定的でノイズに頑健な手法が目的関数を修正することで得られている．</p>
</section>
<section id="largevis" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="largevis"><span class="header-section-number">7.7</span> LargeVis</h2>
<p>LargeVis <span class="citation" data-cites="Tang+2016">(<a href="#ref-Tang+2016" role="doc-biblioref">Tang et al., 2016</a>)</span> は t-SNE の計算量を軽減させるために，<span class="math inline">\(K\)</span>-近傍グラフの計算に近似手法である <strong>ランダム射影木</strong> <span class="citation" data-cites="DasGupta-Freud2008">(<a href="#ref-DasGupta-Freud2008" role="doc-biblioref">Dasgupta and Freund, 2008</a>)</span> を導入する．</p>
</section>
<section id="umap" class="level2" data-number="7.8">
<h2 data-number="7.8" class="anchored" data-anchor-id="umap"><span class="header-section-number">7.8</span> UMAP</h2>
<p>UMAP (Uniform Manifold Approximation and Projection) <span class="citation" data-cites="McInnes+2018">(<a href="#ref-McInnes+2018" role="doc-biblioref">McInnes et al., 2018</a>)</span> は t-SNE より高速で，大域的構造をより尊重する手法として提案された．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://pair-code.github.io/understanding-umap/"><img src="Images/UMAPvSNE.png" class="img-fluid figure-img" alt="UMAP and t-SNE applied to the Fashion MNIST dataset; tap to visit https://pair-code.github.io/understanding-umap/"></a></p>
<figcaption>UMAP and t-SNE applied to the Fashion MNIST dataset; tap to visit https://pair-code.github.io/understanding-umap/</figcaption>
</figure>
</div>
</section>
<section id="モデルベース手法" class="level2" data-number="7.9">
<h2 data-number="7.9" class="anchored" data-anchor-id="モデルベース手法"><span class="header-section-number">7.9</span> モデルベース手法</h2>
<p>t-SNE, VargeVis, UMAP はいずれも確率を導入しているが，完全にモデルベースの発想をしているわけではない．</p>
<p><span class="citation" data-cites="Saul2020">(<a href="#ref-Saul2020" role="doc-biblioref">Saul, 2020</a>)</span> はこれらの手法を <a href="../../../posts/2024/Kernels/HierarchicalModel.html">潜在変数モデル</a> として定式化し，データサイズに合わせて EM アルゴリズムをはじめとした推定手法を議論している．</p>
</section>
</section>
<section id="拡散写像" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> 拡散写像</h1>
<section id="はじめに-2" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="はじめに-2"><span class="header-section-number">8.1</span> はじめに</h2>
<p><strong>拡散埋め込み</strong> (Diffusion Map) <span class="citation" data-cites="Coifman+2005">(<a href="#ref-Coifman+2005" role="doc-biblioref">Coifman et al., 2005</a>)</span> では，データ上に乱歩を定めることでデータ多様体の局所構造を捉える．</p>
<p>この方法は Isomap <a href="#sec-Isomap" class="quarto-xref">3</a> でグラフを用いて測地距離を近似したよりも，頑健なアルゴリズムを与える．</p>
</section>
<section id="phate" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="phate"><span class="header-section-number">8.2</span> PHATE</h2>
<p>PHATE (Heat Diffusion for Affinity-based Transition Embedding) <span class="citation" data-cites="Moon+2019">(<a href="#ref-Moon+2019" role="doc-biblioref">Moon et al., 2019</a>)</span> は DEMaP (Denoised Embedding Manifold Preservation) という情報理論に基づく距離を定義し，データの局所構造を捉える．</p>
</section>
</section>
<section id="自己組織化写像-som" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> 自己組織化写像 (SOM)</h1>
<p>Self-organizing Map <span class="citation" data-cites="Kohonen1982">(<a href="#ref-Kohonen1982" role="doc-biblioref">Kohonen, 1982</a>)</span>, <span class="citation" data-cites="Kohonen2013">(<a href="#ref-Kohonen2013" role="doc-biblioref">Kohonen, 2013</a>)</span> は，ニューラルネットワークのダイナミクスを利用した，クラスタリングベースの次元縮約法である．</p>
<section id="ivis" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="ivis"><span class="header-section-number">9.1</span> IVIS</h2>
<p>IVIS <span class="citation" data-cites="Szubert+2019">(<a href="#ref-Szubert+2019" role="doc-biblioref">Szubert et al., 2019</a>)</span> は <a href="../../../posts/2024/Kernels/Kernel.html#sec-triplet-loss">三つ子損失を取り入れたシャムネットワーク</a> による距離学習に基づく次元縮約法である．</p>
</section>
</section>
<section id="mapper" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Mapper</h1>
<p>Mapper <span class="citation" data-cites="Singh+2007">(<a href="#ref-Singh+2007" role="doc-biblioref">Singh et al., 2007</a>)</span> は，距離空間 <span class="math inline">\(E\)</span> 上のデータ <span class="math inline">\(\{x_i\}\subset E\)</span> を，関数 <span class="math inline">\(f:E\to\mathbb{R}\)</span> が定める分解を用いてグラフとして図示する方法である．<span class="math inline">\(f\)</span> は <strong>filter function</strong> と呼ばれる．</p>
<p>他手法とは違い，出力が <span class="math inline">\(\mathbb{R}^d\)</span> への埋め込みではなく，グラフである点に注意．</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Mapper アルゴリズム^[このアルゴリズムは Morse 理論における概念である Reeb グラフの拡張と見れる．[@Oudot2016] のスライドや [@Schnider2024] の講義資料も参照．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Mapper アルゴリズム<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>値の空間 <span class="math inline">\(\mathbb{R}\)</span> 上の開被覆 <span class="math inline">\((I_i)\)</span> の引き戻し <span class="math inline">\(\mathcal{U}:=(f^{-1}(I_i))\)</span> として誘導されるグラフを，連結成分のみからなるように細分して <span class="math inline">\(\mathcal{V}=(U_i)_{i\in I}\)</span> を得る．</li>
<li><span class="math inline">\(\mathcal{V}\)</span> の <a href="https://en.wikipedia.org/wiki/Nerve_complex">神経複体</a> <span class="math display">\[
N(\mathcal{V}):=\left\{J\overset{\text{finite}}{\subset}I\,\middle|\,\bigcap_{j\in J}U_j\ne\emptyset\right\}
\]</span> またはその近傍グラフを出力とする．</li>
</ol>
</div>
</div>
<p><span class="citation" data-cites="Emerson+2023">(<a href="#ref-Emerson+2023" role="doc-biblioref">Escolar et al., 2023</a>)</span> では特許のデータを用い，各企業を技術空間 <span class="math inline">\(\mathbb{R}^{430}\)</span> 内に埋め込んだ後，mapper によりグラフ化したところ，企業の独自戦略が可視化できるという：</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/0LQpJiecCvw?si=I-6R3dn8EAAG8xs1" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Mapper アルゴリズムは filter function <span class="math inline">\(f\)</span> の選択が重要になるが，これにハイパーパラメータを導入し <span class="citation" data-cites="Oulhaj+2024">(<a href="#ref-Oulhaj+2024" role="doc-biblioref">Oulhaj, Carrière, et al., 2024</a>)</span>，さらにニューラルネットワークで推定する方法 Deep Mapper <span class="citation" data-cites="Oulhaj+2024DeepMapper">(<a href="#ref-Oulhaj+2024DeepMapper" role="doc-biblioref">Oulhaj, Ishii, et al., 2024</a>)</span> が，分子モデリングと創薬に応用されている．</p>
</section>




<div id="quarto-appendix" class="default"><section id="終わりに" class="level1 appendix" data-number="11"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">11</span> 終わりに</h2><div class="quarto-appendix-contents">

<p>結局機械学習が日々の統計的営みに与えた最大のインパクトは，ニューラルネットワークや生成モデル自体というより，高精度な非線型表現学習であると言えるかもしれない．</p>
<p>例えば <span class="citation" data-cites="Hoffmann+2019">(<a href="#ref-Hoffmann+2019" role="doc-biblioref">Hoffman et al., 2019</a>)</span> は <a href="../../../posts/2024/Samplers/NF.html#sec-NF-Bayes">IAF</a> <span class="citation" data-cites="Kingma+2016">(<a href="#ref-Kingma+2016" role="doc-biblioref">Kingma et al., 2016</a>)</span> を用いて目標分布を学習し，学習された密度 <span class="math inline">\(q\)</span> で変換後の分布から MCMC サンプリングをすることで効率がはるかに改善することを報告した．実際，フローによる変換を受けた後は対象分布は正規分布に近くなることから，MCMC サンプリングを減速させる要因の多くが消滅していることが期待される．</p>
<p>多くの他の統計的な困難も，良い表現学習された空間上（あるいはカーネル空間上）で実行することで回避することができるということになるかもしれない．これが最初に SVM が機械学習に与えた希望の形であったし，ニューラルネットワークに対する飽くなき理論的興味の源泉でもある．データの視覚化や探索的データ解析の意味では，よき潜在表現を必要としているのは人間も然りである．</p>
</div></section><section id="文献" class="level1 appendix" data-number="12"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">12</span> 文献</h2><div class="quarto-appendix-contents">

<p><span class="citation" data-cites="Yao2011">(<a href="#ref-Yao2011" role="doc-biblioref">Yao, 2011</a>)</span> は LLE, Laplacian Eigenmaps, カーネル PCA, Diffusion Maps の関連性を扱っている講義スライドである．</p>
<p><span class="citation" data-cites="Wattemnerg+2016">(<a href="#ref-Wattemnerg+2016" role="doc-biblioref">Wattenberg et al., 2016</a>)</span> はインタラクティブに t-SNE の性質を理解できるウェブページである．<a href="https://pair-code.github.io/understanding-umap/">Understanding UMAP</a> も同様にして，UMAP と t-SNE の比較を与えている．</p>
<p><span class="citation" data-cites="Murphy2022">(<a href="#ref-Murphy2022" role="doc-biblioref">Murphy, 2022</a>)</span> 第20章は次元縮約という題で，PCA, FA から自己符号化器，多様体学習を解説している．<span class="citation" data-cites="Burges2010">(<a href="#ref-Burges2010" role="doc-biblioref">Burges, 2010</a>)</span> が同じテーマのしばらく前のサーベイである．</p>
<p>多様体学習に関しては <span class="citation" data-cites="本武陽一2017">(<a href="#ref-本武陽一2017" role="doc-biblioref">本武陽一, 2017</a>)</span> も注目．</p>
<p>PCA は Kosambi-Karhunen-Loéve 変換ともいう <span class="citation" data-cites="Bishop-Bishop2024">(<a href="#ref-Bishop-Bishop2024" role="doc-biblioref">Bishop and Bishop, 2024, p. 497</a>)</span>．PCA からとにかくスペクトルとの関連が深い．</p>




</div></section><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Agrawal+2021" class="csl-entry" role="listitem">
Agrawal, A., Ali, A., and Boyd, S. (2021). <a href="https://doi.org/10.1561/2200000090">Minimum-distortion embedding</a>. <em>Foundations and Trends<span></span> in Machine Learning</em>, <em>14</em>(3), 211–378.
</div>
<div id="ref-Balasubramanian-Schwartz2002" class="csl-entry" role="listitem">
Balasubramanian, M., and Schwartz, E. L. (2002). <a href="https://doi.org/10.1126/science.295.5552.7a">The isomap algorithm and topological stability</a>. <em>Science</em>, <em>295</em>(5552), 7–7.
</div>
<div id="ref-Mikhali-Partha2001" class="csl-entry" role="listitem">
Belkin, M., and Niyogi, P. (2001). <a href="https://proceedings.neurips.cc/paper_files/paper/2001/file/f106b7f99d2cb30c3db1c3cc0fde9ccb-Paper.pdf">Laplacian eigenmaps and spectral techniques for embedding and clustering</a>. In T. Dietterich, S. Becker, and Z. Ghahramani, editors, <em>Advances in neural information processing systems</em>,Vol. 14. MIT Press.
</div>
<div id="ref-Bishop-Bishop2024" class="csl-entry" role="listitem">
Bishop, C. M., and Bishop, H. (2024). <em><a href="https://link.springer.com/book/10.1007/978-3-031-45468-4">Deep learning: Foundations and concepts</a></em>. Springer Cham.
</div>
<div id="ref-Burges2010" class="csl-entry" role="listitem">
Burges, C. J. C. (2010). <a href="https://doi.org/10.1561/2200000002">Dimension reduction: A guided tour</a>. <em>Foundations and Trends<span></span> in Machine Learning</em>, <em>2</em>(4), 275–365.
</div>
<div id="ref-Carreira-Perpinan2010" class="csl-entry" role="listitem">
Carreira-Perpiñan, M. Á. (2010). The elastic embedding algorithm for dimensionality reduction. In <em>Proceedings of the 27th international conference on international conference on machine learning</em>, pages 167–174. Madison, WI, USA: Omnipress.
</div>
<div id="ref-Choi-Choi2007" class="csl-entry" role="listitem">
Choi, H., and Choi, S. (2007). <a href="https://doi.org/10.1016/j.patcog.2006.04.025">Robust kernel isomap</a>. <em>Pattern Recognition</em>, <em>40</em>(3), 853–862.
</div>
<div id="ref-Coifman+2005" class="csl-entry" role="listitem">
Coifman, R. R., Lafon, S., Lee, A. B., Maggioni, M., Nadler, B., Warner, F., and Zucker, S. W. (2005). <a href="https://doi.org/10.1073/pnas.0500334102">Geometric diffusions as a tool for harmonic analysis and structure definition of data: Diffusion maps</a>. <em>Proceedings of the National Academy of Sciences</em>, <em>102</em>(21), 7426–7431.
</div>
<div id="ref-Coombs1950" class="csl-entry" role="listitem">
Coombs, C. H. (1950). <a href="https://psycnet.apa.org/doi/10.1037/h0060984"><span class="nocase">Psychological Scaling without a Unit of Measurement</span></a>. <em>Psychological Review</em>, <em>57</em>(3), 145–158.
</div>
<div id="ref-DasGupta-Freud2008" class="csl-entry" role="listitem">
Dasgupta, S., and Freund, Y. (2008). <a href="https://doi.org/10.1145/1374376.1374452">Random projection trees and low dimensional manifolds</a>. In <em>Proceedings of the fortieth annual ACM symposium on theory of computing</em>, pages 537–546. New York, NY, USA: Association for Computing Machinery.
</div>
<div id="ref-deLeeuw1977" class="csl-entry" role="listitem">
de Leeuw, J. (1977). <em>Applications of convex analysis to multidimensional scaling</em>. UCLA: Department of Statistics. Retrieved from <a href="https://escholarship.org/uc/item/7wg0k7xq">https://escholarship.org/uc/item/7wg0k7xq</a>
</div>
<div id="ref-Donoho-Grimes2003" class="csl-entry" role="listitem">
Donoho, D. L., and Grimes, C. (2003). <a href="https://doi.org/10.1073/pnas.1031596100">Hessian eigenmaps: Locally linear embedding techniques for high-dimensional data</a>. <em>Proceedings of the National Academy of Sciences</em>, <em>100</em>(10), 5591–5596.
</div>
<div id="ref-Eades1984" class="csl-entry" role="listitem">
Eades, P. (1984). <a href="https://www.cs.ubc.ca/~will/536E/papers/Eades1984.pdf"><span class="nocase">A Heuristic for Graph Drawing</span></a>. <em>Congress Numerantium</em>, <em>42</em>(11), 149–160.
</div>
<div id="ref-Eckart-Young1936" class="csl-entry" role="listitem">
Eckart, C., and Young, G. (1936). <a href="https://doi.org/10.1007/BF02288367">The approximation of one matrix by another of lower rank</a>. <em>Psychometrika</em>, <em>1</em>(3), 211–218.
</div>
<div id="ref-Emerson+2023" class="csl-entry" role="listitem">
Escolar, E. G., Hiraoka, Y., Igami, M., and Ozcan, Y. (2023). <a href="https://doi.org/10.1016/j.respol.2023.104821">Mapping firms’ locations in technological space: A topological analysis of patent statistics</a>. <em>Research Policy</em>, <em>52</em>(8), 104821.
</div>
<div id="ref-Fefferman+2016" class="csl-entry" role="listitem">
Fefferman, C., Mitter, S., and Narayanan, H. (2016). <a href="https://doi.org/10.1090/jams/852">Testing the manifold hypothesis</a>. <em>Journal of the American Mathematical Society</em>, <em>29</em>, 983–1049.
</div>
<div id="ref-Fisk+1967" class="csl-entry" role="listitem">
Fisk, C. J., Caskey, D. L., and West, L. E. (1967). <a href="https://doi.org/10.1109/PROC.1967.6027">ACCEL: Automated circuit card etching layout</a>. <em>Proceedings of the IEEE</em>, <em>55</em>(11), 1971–1982.
</div>
<div id="ref-Gabriel1971" class="csl-entry" role="listitem">
Gabriel, K. R. (1971). <a href="http://www.jstor.org/stable/2334381">The biplot graphic display of matrices with application to principal component analysis</a>. <em>Biometrika</em>, <em>58</em>(3), 453–467.
</div>
<div id="ref-Gower2004" class="csl-entry" role="listitem">
Gower, J. C. (2004). <a href="http://www.jstor.org/stable/20441132">The geometry of biplot scaling</a>. <em>Biometrika</em>, <em>91</em>(3), 705–714.
</div>
<div id="ref-Hinton-Roweis2002" class="csl-entry" role="listitem">
Hinton, G. E., and Roweis, S. (2002). <a href="https://proceedings.neurips.cc/paper_files/paper/2002/file/6150ccc6069bea6b5716254057a194ef-Paper.pdf">Stochastic neighbor embedding</a>. In S. Becker, S. Thrun, and K. Obermayer, editors, <em>Advances in neural information processing systems</em>,Vol. 15. MIT Press.
</div>
<div id="ref-Hoffmann+2019" class="csl-entry" role="listitem">
Hoffman, M., Sountsov, P., Dillon, J. V., Langmore, I., Tran, D., and Vasudevan, S. (2019). <a href="https://arxiv.org/abs/1903.03704">NeuTra-lizing bad geometry in hamiltonian monte carlo using neural transport</a>. In <em>Symposium on advances in approximate bayesian inference</em>.
</div>
<div id="ref-Imai+2016" class="csl-entry" role="listitem">
Imai, K., Lo, J., and Olmsted, J. (2016). <a href=""><span class="nocase">Fast Estimation of Ideal Points with Massive Data</span></a>. <em>American Political Science Review</em>, <em>110</em>(4), 631–656.
</div>
<div id="ref-Kamada-Kawai1989" class="csl-entry" role="listitem">
Kamada, T., and Kawai, S. (1989). <a href="https://doi.org/10.1016/0020-0190(89)90102-6">An algorithm for drawing general undirected graphs</a>. <em>Information Processing Letters</em>, <em>31</em>(1), 7–15.
</div>
<div id="ref-Kingma+2016" class="csl-entry" role="listitem">
Kingma, D., Salimans, T., Jozefowicz, R., Chen, X., Sutskever, I., and Welling, M. (2016). <a href="https://proceedings.neurips.cc/paper_files/paper/2016/file/ddeebdeefdb7e7e7a697e1c3e3d8ef54-Paper.pdf">Improved variational inference with inverse autoregressive flow</a>. In D. Lee, M. Sugiyama, U. Luxburg, I. Guyon, and R. Garnett, editors, <em>Advances in neural information processing systems</em>,Vol. 29. Curran Associates, Inc.
</div>
<div id="ref-Kohonen1982" class="csl-entry" role="listitem">
Kohonen, T. (1982). <a href="https://doi.org/10.1007/BF00337288">Self-organized formation of topologically correct feature maps</a>. <em>Biological Cybernetics</em>, <em>43</em>(1), 59–69.
</div>
<div id="ref-Kohonen2013" class="csl-entry" role="listitem">
Kohonen, T. (2013). <a href="https://doi.org/10.1016/j.neunet.2012.09.018">Essentials of the self-organizing map</a>. <em>Neural Networks</em>, <em>37</em>, 52–65.
</div>
<div id="ref-Kruskal1964" class="csl-entry" role="listitem">
Kruskal, J. B. (1964). <a href="https://doi.org/10.1007/BF02289565">Multidimensional scaling by optimizing goodness of fit to a nonmetric hypothesis</a>. <em>Psychometrika</em>, <em>29</em>(1), 1–27.
</div>
<div id="ref-vanderMaaten2014" class="csl-entry" role="listitem">
Maaten, L. van der. (2014). <a href="http://jmlr.org/papers/v15/vandermaaten14a.html">Accelerating t-SNE using tree-based algorithms</a>. <em>Journal of Machine Learning Research</em>, <em>15</em>(93), 3221–3245.
</div>
<div id="ref-Martin-Quinn2002" class="csl-entry" role="listitem">
Martin, A. D., and Quinn, K. M. (2002). <a href="http://www.jstor.org/stable/25791672">Dynamic ideal point estimation via markov chain monte carlo for the u.s. Supreme court, 1953–1999</a>. <em>Political Analysis</em>, <em>10</em>(2), 134–153.
</div>
<div id="ref-McInnes+2018" class="csl-entry" role="listitem">
McInnes, L., Healy, J., Saul, N., and Großberger, L. (2018). <a href="https://doi.org/10.21105/joss.00861">UMAP: Uniform manifold approximation and projection</a>. <em>Journal of Open Source Software</em>, <em>3</em>(29), 861.
</div>
<div id="ref-Moon+2019" class="csl-entry" role="listitem">
Moon, K. R., Dijk, D. van, Wang, Z., Gigante, S., Burkhardt, D. B., Chen, W. S., … Krishnaswamy, S. (2019). <a href="https://doi.org/10.1038/s41587-019-0336-3">Visualizing structure and transitions in high-dimensional biological data</a>. <em>Nature Biotechnology</em>, <em>37</em>(12), 1482–1492.
</div>
<div id="ref-Murphy2022" class="csl-entry" role="listitem">
Murphy, K. P. (2022). <em><a href="https://probml.github.io/pml-book/book1.html">Probabilistic machine learning: An introduction</a></em>. MIT Press.
</div>
<div id="ref-Oudot2016" class="csl-entry" role="listitem">
Oudot, S. (2016). <em><a href="https://geometrica.saclay.inria.fr/team/Steve.Oudot/courses/EMA/Slides_Reeb_Mapper.pdf">Reeb graph and mapper</a></em>.
</div>
<div id="ref-Oulhaj+2024" class="csl-entry" role="listitem">
Oulhaj, Z., Carrière, M., and Michel, B. (2024). <a href="https://arxiv.org/abs/2402.12854">Differentiable mapper for topological optimization of data representation</a>.
</div>
<div id="ref-Oulhaj+2024DeepMapper" class="csl-entry" role="listitem">
Oulhaj, Z., Ishii, Y., Ohga, K., Yamazaki, K., Wada, M., Umeda, Y., … Kurihara, H. (2024). <a href="https://arxiv.org/abs/2402.19177">Deep mapper graph and its application to visualize plausible pathways on high-dimensional distribution with small time-complexity</a>.
</div>
<div id="ref-Quinn-Breuer1979" class="csl-entry" role="listitem">
Quinn, N., and Breuer, M. (1979). <a href="https://doi.org/10.1109/TCS.1979.1084652">A forced directed component placement procedure for printed circuit boards</a>. <em>IEEE Transactions on Circuits and Systems</em>, <em>26</em>(6), 377–388.
</div>
<div id="ref-Roweis-Saul2000" class="csl-entry" role="listitem">
Roweis, S. T., and Saul, L. K. (2000). <a href="https://doi.org/10.1126/science.290.5500.2323">Nonlinear dimensionality reduction by locally linear embedding</a>. <em>Science</em>, <em>290</em>(5500), 2323–2326.
</div>
<div id="ref-Sammon1969" class="csl-entry" role="listitem">
Sammon, J. W. (1969). <a href="https://doi.org/10.1109/T-C.1969.222678">A nonlinear mapping for data structure analysis</a>. <em>IEEE Transactions on Computers</em>, <em>C-18</em>(5), 401–409.
</div>
<div id="ref-Saul2020" class="csl-entry" role="listitem">
Saul, L. K. (2020). <a href="https://doi.org/10.1073/pnas.1916012117">A tractable latent variable model for nonlinear dimensionality reduction</a>. <em>Proceedings of the National Academy of Sciences</em>, <em>117</em>(27), 15403–15408.
</div>
<div id="ref-Schnider2024" class="csl-entry" role="listitem">
Schnider, P. (2024). <em><a href="https://ti.inf.ethz.ch/ew/courses/TDA24/index.html">Introduction to topological data analysi</a></em>.
</div>
<div id="ref-Scholkopf+1998" class="csl-entry" role="listitem">
Schölkopf, B., Smola, A., and Müller, K.-R. (1998). <a href="https://doi.org/10.1162/089976698300017467">Nonlinear component analysis as a kernel eigenvalue problem</a>. <em>Neural Computation</em>, <em>10</em>(5), 1299–1319.
</div>
<div id="ref-Singh+2007" class="csl-entry" role="listitem">
Singh, G., Memoli, F., and Carlsson, G. (2007). <a href="https://doi.org//10.2312/SPBG/SPBG07/091-100
"><span class="nocase">Topological Methods for the Analysis of High Dimensional Data Sets and 3D Object Recognition </span></a>. In M. Botsch, R. Pajarola, B. Chen, and M. Zwicker, editors, <em>Eurographics symposium on point-based graphics</em>. The Eurographics Association.
</div>
<div id="ref-Szubert+2019" class="csl-entry" role="listitem">
Szubert, B., Cole, J. E., Monaco, C., and Drozdov, I. (2019). <a href="https://doi.org/10.1038/s41598-019-45301-0">Structure-preserving visualisation of high dimensional single-cell datasets</a>. <em>Scientific Reports</em>, <em>9</em>(1), 8914.
</div>
<div id="ref-Tang+2016" class="csl-entry" role="listitem">
Tang, J., Liu, J., Zhang, M., and Mei, Q. (2016). <a href="https://doi.org/10.1145/2872427.2883041">Visualizing large-scale and high-dimensional data</a>. In <em>Proceedings of the 25th international conference on world wide web</em>, pages 287–297. Republic; Canton of Geneva, CHE: International World Wide Web Conferences Steering Committee.
</div>
<div id="ref-Tenenbaum+2000" class="csl-entry" role="listitem">
Tenenbaum, J. B., Silva, V. de, and Langford, J. C. (2000). <a href="https://doi.org/10.1126/science.290.5500.2319"><span class="nocase">A Global Geometric Framework for Nonlinear Dimensionality Reduction</span></a>. <em>Science</em>, <em>290</em>(5500), 2319–2323.
</div>
<div id="ref-Torgenson1952" class="csl-entry" role="listitem">
Torgerson, W. S. (1952). <a href="https://doi.org/10.1007/BF02288916">Multidimensional scaling: I. Theory and method</a>. <em>Psychometrika</em>, <em>17</em>(4), 401–419.
</div>
<div id="ref-Tutte1963" class="csl-entry" role="listitem">
Tutte, W. T. (1963). <a href="https://doi.org/10.1112/plms/s3-13.1.743"><span class="nocase">How to Draw a Graph</span></a>. <em>Proceedings of the London Mathematical Society</em>, <em>s3-13</em>(1), 743–767.
</div>
<div id="ref-Maaten-Hinton2008" class="csl-entry" role="listitem">
van der Maaten, L., and Hinton, G. (2008). <a href="http://jmlr.org/papers/v9/vandermaaten08a.html">Visualizing data using t-SNE</a>. <em>Journal of Machine Learning Research</em>, <em>9</em>(86), 2579–2605.
</div>
<div id="ref-Wattemnerg+2016" class="csl-entry" role="listitem">
Wattenberg, M., Viégas, F., and Johnson, I. (2016). <a href="https://doi.org/10.23915/distill.00002">How to use t-SNE effectively</a>. <em>Distill</em>.
</div>
<div id="ref-Weinberger+2004" class="csl-entry" role="listitem">
Weinberger, K. Q., Sha, F., and Saul, L. K. (2004). <a href="https://doi.org/10.1145/1015330.1015345">Learning a kernel matrix for nonlinear dimensionality reduction</a>. In <em>Proceedings of the twenty-first international conference on machine learning</em>, page 106. New York, NY, USA: Association for Computing Machinery.
</div>
<div id="ref-Wilk+2020" class="csl-entry" role="listitem">
Wilk, A. J., Rustagi, A., Zhao, N. Q., Roque, J., Martı́nez-Colón, G. J., McKechnie, J. L., … Blish, C. A. (2020). <a href="https://doi.org/10.1038/s41591-020-0944-y">A single-cell atlas of the peripheral immune response in patients with severe COVID-19</a>. <em>Nature Medicine</em>, <em>26</em>(7), 1070–1076.
</div>
<div id="ref-Wu-Fischer2020" class="csl-entry" role="listitem">
Wu, T., and Fischer, I. (2020). <a href="https://openreview.net/forum?id=HJloElBYvB">Phase transitions for the information bottleneck in representation learning</a>. In <em>International conference on learning representations</em>.
</div>
<div id="ref-Yao2011" class="csl-entry" role="listitem">
Yao, Y. (2011). <em><a href="https://www.math.pku.edu.cn/teachers/yaoy/Spring2011/">Mathematics of data – laplacian, diffusion, and hessian LLE</a></em>.
</div>
<div id="ref-Young-Hausholder1938" class="csl-entry" role="listitem">
Young, G., and Householder, A. S. (1938). <a href="https://doi.org/10.1007/BF02287916">Discussion of a set of points in terms of their mutual distances</a>. <em>Psychometrika</em>, <em>3</em>(1), 19–22.
</div>
<div id="ref-Zhang-Zha2004" class="csl-entry" role="listitem">
Zhang, Z., and Zha, H. (2004). <a href="https://doi.org/10.1137/S1064827502419154">Principal manifolds and nonlinear dimensionality reduction via tangent space alignment</a>. <em>SIAM Journal on Scientific Computing</em>, <em>26</em>(1), 313–338.
</div>
<div id="ref-三輪洋文2017" class="csl-entry" role="listitem">
三輪洋文. (2017). <a href="https://doi.org/10.14854/jaes.33.1_41">Twitter データによる日本の政治家・言論人・政党・メディアのイデオロギー位置の推定</a>. <em>選挙研究</em>, <em>33</em>(1), 41–56.
</div>
<div id="ref-岡田謙介-加藤淳子2016" class="csl-entry" role="listitem">
岡田謙介, and 加藤淳子. (2016). <a href="https://doi.org/10.2333/jbhmk.43.155">政治学における空間分析と認知空間</a>. <em>行動計量学</em>, <em>43</em>(2), 155–166.
</div>
<div id="ref-本武陽一2017" class="csl-entry" role="listitem">
本武陽一. (2017). <em>高次元データセットに潜む幾何構造と深層学習 : その解析と大自由度力学系への応用</em> (PhD thesis). 東京大学. Retrieved from <a href="https://repository.dl.itc.u-tokyo.ac.jp/records/48134">https://repository.dl.itc.u-tokyo.ac.jp/records/48134</a>
</div>
<div id="ref-足立浩平2000" class="csl-entry" role="listitem">
足立浩平. (2000). <a href="https://doi.org/10.2333/jbhmk.27.12">計量多次元展開法の変量モデル</a>. <em>行動計量学</em>, <em>27</em>(1), 12–23.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><span class="citation" data-cites="本武陽一2017">(<a href="#ref-本武陽一2017" role="doc-biblioref">本武陽一, 2017</a>)</span> も注目．<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>(Peripheral Blood Mononuclear Cell)<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>なお，<span class="citation" data-cites="Wilk+2020">(<a href="#ref-Wilk+2020" role="doc-biblioref">Wilk et al., 2020</a>)</span> では最初の 50 の主成分がプロットされている．<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p><span class="citation" data-cites="岡田謙介-加藤淳子2016">(<a href="#ref-岡田謙介-加藤淳子2016" role="doc-biblioref">岡田謙介 and 加藤淳子, 2016</a>)</span> 参照．大変入門に良い日本語文献である．計量的多次元尺度法は <strong>主座標分析</strong> (PCoA: Principal Coordinate Analysis) <span class="citation" data-cites="Young-Hausholder1938">(<a href="#ref-Young-Hausholder1938" role="doc-biblioref">Young and Householder, 1938</a>)</span> とも呼ばれる．<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>どうやら相転移境界が近いため，アニーリングが必要？<span class="citation" data-cites="Wu-Fischer2020">(<a href="#ref-Wu-Fischer2020" role="doc-biblioref">Wu and Fischer, 2020</a>)</span>．<span class="citation" data-cites="Murphy2022">(<a href="#ref-Murphy2022" role="doc-biblioref">Murphy, 2022, p. 700</a>)</span> 20.4.10.1節も参照．<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>このアルゴリズムは Morse 理論における概念である Reeb グラフの拡張と見れる．<span class="citation" data-cites="Oudot2016">(<a href="#ref-Oudot2016" role="doc-biblioref">Oudot, 2016</a>)</span> のスライドや <span class="citation" data-cites="Schnider2024">(<a href="#ref-Schnider2024" role="doc-biblioref">Schnider, 2024</a>)</span> の講義資料も参照．<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/162348\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="162348/162348.github.io" data-repo-id="R_kgDOKlfKYQ" data-category="Announcements" data-category-id="DIC_kwDOKlfKYc4CgDmb" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" data-loading="lazy" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://162348.github.io/">
<p>Hirofumi Shiba</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/162348/162348.github.io/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ano2math5">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:shiba.hirofumi@ism.ac.jp">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../../blog.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>