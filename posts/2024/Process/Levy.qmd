---
title: "Lévy 過程を見てみよう"
subtitle: "YUIMA パッケージを用いたシミュレーションを通じて"
author: "司馬 博文"
date: 7/1/2024
categories: [Process, Simulation, Stan, YUIMA, R]
bibliography: 
    - ../../../mathematics.bib
    - ../../../bib.bib
csl: ../../../apa.csl
abstract-title: 概要
abstract: Lévy 過程は独立定常増分な Feller-Dynkin 過程のことである．このクラスの過程は，Brown 運動と複合 Poisson 過程の独立和として表現される，というのが Lévy-Ito 分解の大雑把な意味であるが，その正確な消息は極めて微妙で理解が難しい．そこで，YUIMA パッケージを通じてシミュレーションを行いながら，Lévy の特性量 $(A,\nu,\gamma)$ が何に対応するかの直感的理解を試みる．
---

{{< include ../../../_preamble.qmd >}}

YUIMAについては次の記事も参照：

```{=html}
<div class="article-card-container">
  <div class="article-card">
    <a href="https://162348.github.io/posts/2024/Computation/YUIMA.html" target="_blank">
      <img src="https://162348.github.io/posts/2024/Computation/YUIMA_files/figure-html/unnamed-chunk-5-1.png" alt="Article Image" class="article-image">
      <div class="article-content">
        <h3 class="article-title">YUIMA 入門</h3>
        <p class="article-description">確率微分方程式のシミュレーションと推測のためのパッケージ`yuima`の構造と使い方をまとめます．</p>
      </div>
    </a>
  </div>
</div>
```

Poisson 過程と複合 Poisson 過程については次の記事を参照：

```{=html}
<div class="article-card-container">
  <div class="article-card">
    <a href="https://162348.github.io/posts/2024/Process/Poisson.html" target="_blank">
      <img src="https://162348.github.io/posts/2024/Process/Poisson_files/figure-html/unnamed-chunk-2-1.png" alt="Article Image" class="article-image">
      <div class="article-content">
        <h3 class="article-title">Poisson 過程を見てみよう</h3>
        <p class="article-description">YUIMA パッケージを用いたシミュレーションを通じて</p>
      </div>
    </a>
  </div>
</div>
```

## Lévy-Itô 分解

### 加法過程の定義

::: {.callout-tip title="定義 (additive process, Lévy process)^[[@Nualart2018 p.158] 定義9.1.1，[@Sato2013 p.3] 定義1.6，[@Arteaga-Sato2019 pp.12-13] 定義1.31に倣った．[@Protter2005 p.20] では(2)の$D$-過程という部分がないのみで，定理30 [@Protter2005 p.21] で常に$D$-修正が取れることを示している．[@LeGall2016 p.175] 6.5.2節も同様の取り扱いである．[@伊藤清1991 p.306] は時間的一様性を所与のものとはせず，(1), (2), (3), (5)のみをLévy過程の定義としており，さらに(4)も満たすものを **一様Lévy過程** という．[@Baudoin2014-DiffusionProcess pp.89-90] 定義3.40では(5)がない．[@Bottcher+2013 p.14] 例1.17では(1),(2)がない．[@Osswald2012 pp.258-259] は(1), (3), (4)を定義としている．[@Applebaum2009 p.43] は(1), (3), (4), (5)を定義としている．[@佐藤健一1990] では全く同じものを加法過程と呼ぶが，[@佐藤健一2011] は完全に一致する語用法をする（加法過程に確率連続性を課している点を除く）．]" icon="false"}

確率過程 $\{X_t\}\subset\L(\Om;\R^d)$ が **加法過程** であるとは，最初の４条件を満たすことをいう．５条件全てを満たすとき，**Lévy 過程** であるという．

1. $X_0\aseq0$．
2. ある充満集合 $\Om_0\subset\Om$ が存在し，$t\mapsto X_t(\om)$ は càdlàg である．
3. 独立増分：任意の $0\le t_0<\cdots<t_n$ について，
  $$
  X_{t_0},X_{t_1}-X_{t_0},X_{t_2}-X_{t_1},\cdots,X_{t_n}-X_{t_{n-1}}
  $$
  は独立である．
4. 確率連続：任意の $\ep>0$ と $t\ge0$ について，
  $$
  \lim_{s\to t}\P[\abs{X_s-X_t}>\ep]=0
  $$
  が成り立つ．
5. 定常増分：$X_{s+t}-X_s$ の分布は $s\ge0$ に依らない．

:::

### 特性量

加法過程 $\{X_t\}$ について，$X_t$ の分布は必ず $\R^d$ 上の無限可分分布になる．^[[@Sato2013 p.47] 定理9.1 参照．]

加えて，加法過程の分布は１次元の有限次元分布族が特徴付ける．

::: {.callout-tip title="定理（加法過程の分布）^[[@Sato2013 p.51] 定理9.7参照．]" icon="false"}

$\{X_t\}\subset\L(\Om;\R^d)$ を加法過程とする．

1. $\mu_{s,t}$ を $X_t-X_s$ の分布とすると，これは無限可分であり，次を満たす：
$$
\mu_{s,t}*\mu_{t,u}=\mu_{s,u},
$$
$$
\mu_{s,s}=\delta_0,
$$
$$
\mu_{s,t}\to\delta_0\quad(s\nearrow t),
$$
$$
\mu_{s,t}\to\delta_0\qquad(t\searrow s).
$$
2. 確率分布の族 $\{\mu_{s,t}\}\subset\cP(\R^d)$ が上の４式を満たすならば，これはある加法過程 $\{X_t\}$ が定める分布である．
3. ２つの加法過程 $X,X'$ が，
   $$
   X_t\deq X'_t\quad t\in\R_+
   $$
   を満たすならば，$X\deq X'$ が成り立つ．

:::

このことにより，加法過程 $X$ の分布は，各 $X_t$ の分布を特徴付ける特性量 $(A_t,\nu_t,\gamma(t))$ によって特徴付けられる．

::: {.callout-important title="無限可分分布の特徴付け [@Khinchin-Levy1936]^[[@Dudley2002 p.327] 定理9.8.3，[@Sato2013 p.37] 定理8.1，[@Arteaga-Sato2019 p.11] 定理1.28，[@Baudoin2014-DiffusionProcess p.91] 定理3.46，[@Applebaum2009 p.29] 定理1.2.14 など参照．]" collapse="true" icon="false"}

特性関数 $f:\R^d\to\bC$ について，次は同値：

1. $f$ は無限可分である．
2. (Lévy) ある
  $$
  \nu(\{0\})=0,\qquad\int_{\R^d}(\abs{x}^2\land1)\nu(dx)<\infty
  $$
  を満たす測度 $\nu\in\cM(\R^d)$ と対称な半正定値行列 $A\in S_n(\R)_+$ と $\gamma\in\R^d$ が一意的に存在して，次のように表せる：
  $$
  f(z)=\exp\paren{-\frac{1}{2}(z|Az)+i(\gamma|z)+\int_{\R^d}\Paren{e^{i(z|x)}-1-i(z|x)1_{\Brace{B^d}}(x)}\nu(dx)}.
  $$
3. (Khinchin) 
    ある有限測度 $\Psi\in\cM^1(\R^d)$ と $\al\in\R^d$ が存在して，次のように表せる：
    $$
    f(u)=\exp\paren{i(\al|u)+\int_{\R^d}\Paren{e^{i(u|x)}-1-\frac{i(u|x)}{1+\abs{x}^2}}\frac{1+\abs{x}^2}{\abs{x}^2}\Psi(dx)}.
    $$

$A$ を Gauss 共分散，$\nu$ を Lévy 測度，$\Psi$ を **Khintchine測度** という．^[Gauss 共分散の用語は [@Sato2013 p.38] 定義8.2．Khintchine 測度は [@Loeve77-ProbabilityI p.343]，[@Applebaum2009 p.31]，[@Bottcher+2013 p.33]，[@Baudoin2014-DiffusionProcess p.92] など．]

加えて，任意の半正定値行列 $A$，$\gamma\in\R^d$，Lévy 測度 $\nu$ であって $\nu(\{0\})=0$ かつ
$$
\int_{\R^d}(\abs{x}^2\land1)\nu(dx)<\infty
$$
を満たすものに対して，$(A,\nu,\gamma)$ を特性量にもつ無限可分分布が存在する．

Khintchin の表示はより直接的である上に，Khintchin 測度は有限になる．さらに，$(\al,\Psi)$ の収束が過程の収束にも対応する！^[[@Loeve77-ProbabilityI p.343]] だが，確率論的な意味付けに欠けるために，Lévy の表示の方をここでは用いる．

Lévy の表示の被積分関数
$$
e^{i(z|x)}-1-i(z|x)1_{\Brace{B^d}}(x)
$$
は大変複雑であるが，こうしないと $\nu$-可積分にならないのである．

$\nu$ は $O(\abs{x}^2)$ 関数に関してならば $0$ の近傍でも可積分であるから，$e^{i(z|x)}$ から１次以下の項を $0$ の近傍から取り去ることで可積分にしているのである．そのため，最後の項は $1_{\Brace{B^d}}$ でなくとも，
$$
c(x)=1+o(\abs{x})\quad(\abs{x}\to0)
$$
$$
c(x)=O(\abs{x}^{-1})\quad(\abs{x}\to\infty)
$$
の２条件を満たすものならばなんでも良い．だが，取り替える度に１次の項 $\gamma\in\R^d$ を変更する必要がある．

一般に $\gamma$ はドリフトと呼んではいけない．
$$
\int_{B^d}\abs{x}\,\nu(dx)<\infty
$$
を満たす場合のみ，
$$
f(z)=\exp\paren{-\frac{(z|Az)}{2}+i(\gamma_0|z)+\int_{\R^d}\Paren{e^{i(z|x)}-1}\nu(dx)}
$$
と表示でき，この際の $\gamma_0\in\R^d$ を **ドリフト** と呼ぶ．

逆に，
$$
\int_{\R^d\setminus B^d}\abs{x}\,\nu(dx)<\infty
$$
が成り立つとき，
$$
f(z)=\exp\paren{-\frac{(z|Az)}{2}+i(\gamma_1|z)+\int_{\R^d}\Paren{e^{i(z|x)}-1-i(z|x)}\nu(dx)}
$$
と表示でき，$\gamma_1$ は $f$ が定める確率分布の平均に一致する．^[[@Sato2013 p.39] 注8.4．]

:::

Lévy 過程は，$A:=A_1,\nu:=\nu_1,\gamma:=\gamma(1)$ について，
$$
A_t=tA,\quad\nu_t=t\nu,\quad\gamma_t=t\gamma
$$
と表せる場合に当たる．

### 強度測度との関係

$\{(A_t,\nu_t,\gamma_t)\}_{t\in\R_+}$ を加法過程の特性量とする．

このとき，
$$
\wt{\nu}([0,t]\times B):=\nu_t(B),\qquad t\ge0,B\in\B(\R^d)
$$
は $\R_+\times\R^d$ 上に測度を定める．

::: {.callout-tip title="命題（強度測度と特性測度の関係）^[特性測度の名前は [@Revuz-Yor1999 p.478] 演習 XII.1.18 など．命題は [@Sato2013 p.53] 注9.9も参照．]" icon="false"}

測度の族 $\{\nu_t\}\subset\M(\R^d)$ と測度 $\nu\in\cM(\R_+\times\R^d)$ について，次は同値：

1. $\wt{\nu}$ は次の２条件を満たす：
$$
\wt{\nu}(\{t\}\times\R^d)=0,
$$
$$
\int_{[0,t]\times\R^d}(1\land\abs{x}^2)\wt{\nu}(dsdx)<\infty.
$$
2. $\{\nu_t\}$ はある加法過程の特性測度である．

:::

よって，任意の加法過程について，
$$
\int_{\R^d}(1\land\abs{x}^2)\nu_t(dx)<\infty
$$
が必要である．

Lévy 過程であるとき，定常増分であることが必要であるため，跳躍時刻は $\R_+$ 上の一様な Poisson 点過程に従う必要がある．これより，
$$
\wt{\nu}=\ell_+\otimes\nu
$$
と分解できる必要があり，この特性測度 $\nu$ が Lévy 測度である．このとき，$\nu_t=t\nu$ かつ $\wt{\nu}(dsdx)=ds\nu(dx)$．

### 一般の分解

::: {.callout-tip title="定理（[@Ito1941]）" icon="false"}

$\{X_t\}\subset\L(\Om;\R^d)$ を特性量 $\{(A_t,\nu_t,\gamma(t))\}$ を持つ加法過程とする．



:::

## Lévy 測度

### 導入

本節の目的は，Lévy 過程の次の３分類の見本道の違いを理解することである：^[この分類は [@Sato2013 p.65] 定義11.9に倣った．]

::: {.callout-tip appearance="simple" icon="false"}

特性量 $(A,\nu,\gamma)$ を持つ Lévy 過程について，

* A 型：$A=0$ かつ $\nu(\R^d)<\infty$．
* B 型：$A=0$ かつ $\int_{B^d}\abs{x}\,\nu(dx)<\infty$ であるが，A 型ではない．
* C 型：それ以外．

:::

$A$ 型は拡散項を持たず，確定的な動きと複合 Poisson 過程の和で表現される．

$B$ 型も拡散項を持たないが，$\R_+$ 上稠密な可算集合上でジャンプを繰り返し，見本道は殆ど至る所連続ではない．

$A,B$ は殆ど確実に任意の有界区間上で有界変動な見本道を持つが，$C$ 型は有界変動ではない．^[[@Sato2013 p.140] 定理21.9 参照．]



### Lévy 測度が零ならば，Gauss 過程である

::: {.callout-tip title="命題（連続な Lévy 過程の特徴付け）^[[@Sato2013 p.135] 定理21.1．]" icon="false"}
Lévy 過程 $X$ について，次の２条件は同値：

1. $X$ は殆ど確実に連続な見本道を持つ．
2. $\nu=0$ である．
:::

::: {.callout-tip title="命題^[[@Sato2013 p.135] 定理21.2．]" icon="false"}
Lévy 過程 $X$ ついて，次の３条件は同値：

1. $X$ の見本道は，殆ど確実に区分的定数である．
2. $X$ は複合 Poisson 分布であるか，零であるかのいずれかである．
3. $X$ は A 型で，かつ $\gamma_0=0$ である．
:::

### 跳躍時刻

Lévy 過程の見本道は右連続であるから，$\R_+$ 上トータルの跳躍回数は殆ど確実に可算回である．

$\nu(\R^d)=\infty$ の場合は，有限区間上での跳躍回数も無限になる．

さらに，次のことが言える：

::: {.callout-tip title="命題（B 型 Lévy 過程のジャンプ時刻）" icon="false"}

$\nu(\R^d)=\infty$ とする．このとき，跳躍時刻は殆ど確実に $\R_+$ 上稠密である．

:::

### Lévy 過程の単調増加性

::: {.callout-tip title="命題（単調増加性の特徴付け）^[[@Sato2013 p.137] 定理21.5．]" icon="false"}

$d=1$ とし，$X$ を Lévy 過程とする．このとき，次は同値：

1. $X$ は殆ど確実に単調増加な見本道を持つ．すなわち，従属過程である．
2. $A=0,\nu((-\infty,0))=0$ かつ
    $$
    \int_{\cointerval{0,1}}x\,\nu(dx)<\infty
    $$
    加えて $\gamma_0\ge0$ である．

:::

仮に $A=0,\nu((-\infty,0))=0$ だが，
$$
\int_0^1x\,\nu(dx)=\infty
$$
であったとする．

このとき，正なジャンプとドリフトしか持たないはずであるから，場合によっては単調増加過程になっても良さそうなものである．

しかし，このような過程が発散せずに well-defined であるということは，負の方向に無限に強いドリフトを持っており，これが正なジャンプを打ち消していることが必要である．

それ故，単調増加にならず，加えて任意の区間において単調増加にならない．^[[@Sato2013 p.138] も参照．]