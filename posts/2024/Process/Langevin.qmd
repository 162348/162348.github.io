---
title: "Langevin Dynamics の多項式エルゴード性"
author: "司馬 博文"
date: 7/5/2024
date-modified: 7/8/2024
format:
    html:
        toc: true
    # typst: 
    #     margin:
    #         x: 1.5em
    #         y: 1.5em
    #     mainfont: "UDEV Gothic NF"
    pdf: 
        toc: false
        number-sections: true
        urlcolor: minty
        citecolor: minty
        linkcolor: minty
        filecolor: minty
        toccolor: minty
        template-partials: 
            - ../../../before-title.tex
        keep-tex: true
        block-headings: false
        pdf-engine: lualatex
        documentclass: article
        latex-tinytex: true
        fontenc: T1
        fontfamily: kpfonts  # https://tug.org/FontCatalogue/kpsansserif/
        fontfamilyoptions: sfmath
        shift-heading-level-by: -1
# format-links: [pdf, typst]
categories: [Process]
bibliography: 
    - ../../../mathematics.bib
    - ../../../bib.bib
csl: ../../../apalike.csl
---

{{< include ../../../_preamble.qmd >}}

$\R^n$ 上の Langevin 拡散を考える：
$$
dX_t=-\nabla V(X_t)\,dt+\sqrt{2\beta^{-1}}\,dB_t,\qquad X_0=x_0.
$$
ただし，
$$
V(x)=O(\abs{x}^{2k})\qquad(\abs{x}\to\infty)
$$
の仮定をおく．$k\ge1/2$ の場合，指数エルゴード的であるが，$k<1/2$ の場合はそうではない．

$k\in(0,1/2)$ の設定で，次が示したい：
$$
C_1\exp\paren{c_1V(x)-c_2t^{\frac{k}{1-k}}}\le\norm{P_t(x,-)-\mu_*}_\TV
$$
$$
\mu_*(dx)\propt e^{-\beta V(x)}dx
$$

## $G=e^{\kappa V}$ の可積分性について

::: {.callout-tip appearance="simple" icon="false"}

次元 $n=1$ で考えてみる．

$V(x)=\frac{x^2}{2}$ とした場合，$X$ は OU 過程になり，

$$
\E_x[G(X_t)]<\infty\quad\Leftrightarrow\quad t<-\frac{1}{2}\log\paren{1-\frac{\beta}{\kappa}}.
$$

$V(x)=\log x$ とした場合，$X$ は Bessel 過程になり，
$$
\E_x[G(X_t)]<\infty\qquad(\forall_{t>0}).
$$

:::

### 導入

Markov 過程 $X$ に関するドリフト条件
$$
\wh{L}V\le-C\varphi\circ V\qquad\on\R^n\setminus K
$$
からは $V:E\to\R_+$ の可積分性が出る．

::: {.callout-note title="証明" icon="false" collapse="true"}

上のドリフト条件を，[@Hairer2021-Convergence] の最も弱い意味で解釈すると
$$
M_t:=V(X_t)+C\int^t_0\varphi\circ V(X_s)\,ds
$$
が任意の $x\in E$ に関して $\P_x$-局所優マルチンゲールである，ということになる．

これだけの仮定でも，$V$ が下に有界であるために $M_t$ も下に有界であり，下に有界な局所優マルチンゲールは（真の）優マルチンゲールであることから，
$$
\E_x\Square{V(X_t)+C\int^t_0\varphi\circ V(X_s)\,ds}\le V(x).
$$

加えて左辺が下に有界であることから，$\E_x[V(X_t)]<\infty$ でないと矛盾が起こる．

:::

しかし，lower bound を得たい場合，
$$
\wh{L}V\le C\varphi\circ G\qquad\on\R^n
$$
という情報のみから，
$$
\E_x[G(X_t)]\le g(x,t)\;(<\infty)
$$
という評価を得る必要が出てくる．この場合，$\E_x[G(X_t)]<\infty$ は非自明で，ケースバイケースの議論がであるようである．

### OU 過程の場合

An overdamped Langevin dynamics on $\R$ is defined as the solution to the following SDE:
$$
dX_t=-\nabla V(X_t)\,dt+\sqrt{2\beta^{-1}}\,dB_t,\qquad X_0=x_0.
$$

If $V(x)=\frac{x^2}{2}$, $X$ becomes an Ornstein-Uhlenbeck process. Transforming via $f(t,x)=xe^t$ and using Itô's formula, we get
$$
X_t=x_0e^{-t}+\sqrt{2\beta^{-1}}\int^t_0e^{-(t-s)}\,dB_s.
$$
Hence, $X$ is a Gaussian process with $X_t\sim\rN\paren{x_0e^{-t},\beta^{-1}(1-e^{-2t})}$.

In this case, expectation with respect to $G(y)=e^{\kappa V(y)}=e^{\frac{\kappa y^2}{2}}\;(\kappa\in\R)$ is given by

\begin{align*}
    \E_x[G(X_t)]&=\int_{\R} G(y)\frac{1}{\sqrt{2\pi\beta^{-1}(1-e^{-2t})}}\exp\paren{-\frac{(y-xe^{-t})^2}{2\beta^{-1}(1-e^{-2t})}}\,dy\\
    &=\frac{1}{\sqrt{2\pi\beta^{-1}(1-e^{-2t})}}\int_{\R}\exp\paren{\frac{\kappa\beta^{-1}(1-e^{-2t})y^2-(y-xe^{-t})^2}{2\beta^{-1}(1-e^{-2t})}}\,dy.
\end{align*}


Taking a closer look at the numerator inside $\exp$,

\begin{align*}
    &\qquad\kappa\beta^{-1}(1-e^{-2t})y^2-(y-xe^{-t})^2\\
    &=y^2\Paren{\kappa\beta^{-1}(1-e^{-2t})-1}-2xe^{-t}y+x^2e^{-2t}.
\end{align*}


Therefore, we conclude
$$
\E_x[G(X_t)]<\infty\quad\Leftrightarrow\quad\kappa\beta^{-1}(1-e^{-2t})<1.
$$
In other words, $P_tG(x)$ is finite as long as
$$
t<-\frac{1}{2}\log\paren{1-\frac{\beta}{\kappa}}.
$$

### Bessel 過程の場合

$V=a\log x$ ととると，$V'(x)=\frac{a}{x}$ であるから，これに関する Langevin 動力学は，$\beta=1$ のとき，
$$
dX_t=-\frac{a}{X_t}\,dt+dB_t
$$
と，母数 $a$ を持つ Bessel 過程になる．ただし，$0$ への到着時刻 $T_0$ で止めたもの $X^{T_0}$ を考える．

::: {.callout-tip title="[@Lawler2019 p.10 命題2.5]" icon="false"}

母数 $a$ を持つ Bessel 過程 $X^{T_0}$ の密度を $q_t(x,y;a)$ で表す．このとき，
$$
q_t(x,y;1-a)=\paren{\frac{y}{x}}^{1-2a}q_t(x,y;a)
$$
$$
q_t(x,y;a)=q_t(y,x;a)\paren{\frac{y}{x}}^{2a}
$$
$$
q_{r^2t}(rx,ry;a)=\frac{1}{r}q_t(x,y;a)
$$

加えて $a\ge\frac{1}{2}$ でもあるとき，
$$
q_1(x,y;a)=y^{2a}\exp\paren{-\frac{x^2+y^2}{2}}h_a(xy),
$$
$$
h_a(x)\sim\frac{1}{\sqrt{2\pi}}x^{-a}e^x\qquad(\abs{x}\to\infty)
$$

:::

この結果は [@Lawler2019 p.59] をみる限り，修正 Bessel 関数と，Bessel 過程の Fokker-Planck 方程式との考察によって証明されている．

$$
G(y)=e^{\kappa V(y)}=e^{a\kappa\log(y)}=y^{a\kappa}
$$
であるから，密度 $q_t(x,y;a)$ に対してはどうやっても可積分である．

### $k<1/2$ の場合の尾部確率

$k<1/2$ で最も大きく変わる点は，
$$
\nabla V(x)=O(\abs{x}^{2k-1})\qquad(\abs{x}\to\infty)
$$
であるために，$\nabla V$ が $\R^n$ 上で有界になることである．

このため，一般に SDE
$$
dZ_t=b(Z_t)\,dt+\sigma(X_t)\,dB_t
$$
の密度が，任意の $T>0$ に対して，ある $A_T,a_T>a$ と $y\in\R$ が存在して
$$
\frac{1}{A_T\sqrt{2\pi t}}e^{-\frac{a_T\abs{y-x}^2}{2t}}\le p_t(x,y)\le\frac{A_T}{\sqrt{2\pi t}}e^{-\frac{\abs{y-x}^2}{2a_Tt}}
$$
$$
t\in\ocinterval{0,T}
$$
が成り立つことが使える．^[[@Kohatsu-Higa2022] で最初に知った．特に [@Kohatsu-Higa2003] は詳しく扱っており，上からの評価は Malliavin 解析から得られる [@Taniguchi1985]．同様にして熱方程式の基本解としても捉えられるが．]

これによれば，
$$
G(x)=e^{\kappa V(x)}=O(e^{\kappa\abs{x}^{2k}})\quad(\abs{x}\to\infty)
$$
に対して $p_t$ の尾部が勝つため，$P_tG(x)<\infty$ である．


## 微分と拡張生成作用素の関係

::: {.callout-tip appearance="simple" icon="false"}

次の連続性は？

$$
t\mapsto\E_x\SQuare{1_{[0,\tau_n]}(t)\wh{L}G(X_t)}.
$$
これさえ言えれば，$\pp{}{t}P_tG=P_t(\wh{L}G)$ を得る．

:::

$(X_t)$ を $E=\R^n$ 上の Feller-Dynkin 過程，$(P_t)$ をその遷移半群，$\wh{L}$ をその拡張生成作用素とする．

::: {.callout-tip title="命題" icon="false"}

$G\in\cD(\wh{L})$ とする．すなわち，
$$
t\mapsto M_t:=G(X_t)-\int^t_0\wh{L}G(X_s)ds
$$
は任意の $x\in E$ について $\P_x$-局所マルチンゲールである．

このとき，さらに $G$ について次の条件を仮定する：

1. $\E_x[\abs{G(X_t)}]<\infty\;(x\in E,t\in\R_+)$．すなわち，$P_tG:E\to\R$ が定まる．
2. 同様に $\E_x[\abs{\wh{L}(G)(X_t)}]<\infty\;(x\in E,t\in\R_+)$．すなわち，$\wh{L}P_tG:E\to\R$ も定まる．^[元々はある正の定数 $C>0$ が存在して，$\wh{L}G\le CG$．ある凹関数 $\varphi$ について $\wh{L}G\le\varphi\circ G$ が成り立つならばこの仮定は満たされることに注意，としていた．]
3. 任意の $x\in E$ について，$t\mapsto P_t\wh{L}G(x)$ は連続．

このとき，$P_tG(x)$ は $t$ で連続微分可能であり，次が導ける：
$$
\pp{}{t}\E_x[G(X_t)]=\E_x[\wh{L}G(X_t)].
$$

:::

これは，通常の意味での生成作用素 $L$ の性質
$$
\pp{}{t}P_tG=P_t(LG)
$$
が，可積分性の条件の下で，拡張生成作用素 $\wh{L}$ にも引き継がれると理解できる．

::: {.callout-note title="証明" icon="false"}

局所マルチンゲール性の仮定から，還元する停止時の列 $\{\tau_n'\}$ が存在する：$\tau_n'\nearrow\infty\;\as$ かつ $M^{\tau_n'}$ はマルチンゲール．

これに対して，
$$
\tau_n:=\inf\Brace{t\ge0\mid\abs{G(X_t)}\ge n}\land\tau_n'
$$
と定めると，これもやはり還元する停止時の列である．特に，任意の $n\in\N$ について，$M^{\tau_n}$ はマルチンゲールで，
$$
\E_x\Square{G(X_{t\land\tau_n})-\int^{t\land\tau_n}_0\wh{L}G(X_s)ds}=G(x),\qquad  t\ge0,x\in E.
$$ {#eq-1}

いま，$\abs{G(X_{t\land\tau_n})}\le n$ であるから，^[ここで，Markov 過程 $(X_t)$ の見本道が càdlàg であることを使っている．] $\E_x[\abs{G(X_{t\land\tau_n})}]<\infty$ かつ
$$
\E_x\Square{\Abs{\int^{t\land\tau_n}_0\wh{L}G(X_s)ds}}\le \int^t_0\E_x[\abs{\wh{L}G(X_s)}]ds\le t\max_{s\in[0,t]}\E_x[\abs{\wh{L}G(X_s)}]<\infty.
$$
である．仮定２より $\E_x[\wh{L}G(X_s)]<\infty$ であり，仮定３より $s\mapsto\E_x[\wh{L}G(X_s)]$ は連続であることを用いた．

よって，式 ([-@eq-1]) は
$$
\E_x\SQuare{G(X_{t\land\tau_n})}=G(x)+\E_x\SQuare{\int^{t\land\tau_n}_0\wh{L}G(X_s)ds}
$$
とも表せる．ここで，両辺を $t$ に関して微分するが，
$$
\Om\times(0,\infty)\ni(\om,t)\mapsto\int^{t\land\tau_n}_0\wh{L}G(X_s)ds
$$
が任意の $t\in(0,\infty)$ について

1. $\P_x$ について可積分で，
2. 変数 $t$ に関する偏微分係数も $\P_x$ について可積分

であるから，右辺は $t$ で微分可能であり，さらに $\E_x$ と $\pp{}{t}$ とが交換できる：
$$
\pp{}{t}\E_x\SQuare{G(X_{t\land\tau_n})}=\E_x\SQuare{\pp{}{t}\int^{t\land\tau_n}_0\wh{L}G(X_s)ds}=\E_x\SQuare{1_{[0,\tau_n]}(t)\wh{L}G(X_t)},\qquad n\in\N,x\in E,t\in(0,\infty).
$$
これより，左辺の $\E_x[G(X_{t\land\tau_n})]$ も $t\in(0,\infty)$ に関して微分可能だったことがわかる．

両辺の $n\to\infty$ に関する極限を取ると，右辺は $\abs{\wh{L}G(X_t)}$ が $\P_x$-可積分であるから（仮定２），Lebesgue の優収束定理より，
$$
\lim_{n\to\infty}\pp{}{t}\E_x[G(X_{t\land\tau_n})]=\E_x\SQuare{\lim_{n\to\infty}1_{[0,\tau_n]}(t)\wh{L}G(X_t)}=\E_x[\wh{L}G(X_t)],\qquad x\in E,t\in(0,\infty).
$$
この収束は，$t\in(0,\infty)$ に関して広義一様に起こっている．^[$\E_x\SQuare{1_{[0,\tau_n]}(t)\wh{L}G(X_t)}\to\E_x[\wh{L}G(X_t)]$ の収束が広義一様に起こるためである．
\begin{align*}
&\qquad\sup_{t\in[0,T]}\Abs{\pp{}{t}\E_x[G(X_{t\land\tau_n})]-\E_x[\wh{L}G(X_t)]}\\
&=\sup_{t\in[0,T]}\ABs{\E_x[1_{[0,\tau_n]}(t)\wh{L}G(X_t)]-\E_x[\wh{L}G(X_t)]}\\
&=\sup_{t\in[0,T]}\ABs{\E_x\Square{(1_{[0,\tau_n]}(t)-1)\wh{L}G(X_t)}}\\
&\le\E_x\SQuare{\sup_{t\in[0,T]}\paren{1_{[0,\tau_n]}(t)-1}\wh{L}G(X_t)}\xrightarrow{n\to\infty}0.
\end{align*}
ここで $t\mapsto\wh{L}G(X_t)$ の連続性を使った可能性がある．すなわち，拡散過程と $G\in C^2(E)$ に対する拡張生成作用素 $\wh{L}$ の形の知識まで使った可能性がある．
]

よって，あとは
$$
t\mapsto \E_x\SQuare{1_{[0,\tau_n]}(t)\wh{L}G(X_t)}
$$
が連続であることを示せば良い．

:::

## 下界の導出

元来の目的である下界の導出のためには，
$$
\E_x[G(X_t)]\le CG(x)\exp\paren{ct^{\frac{k}{1-k}}}
$$
という評価を得る必要がある．Gronwall の不等式を用いれば，導関数に関する不等式
$$
\pp{}{t}\E_x[G(X_t)]\le\E_x[\wh{L}G(X_t)]\le C\E_x[\varphi\circ G(X_t)]
$$
があれば十分である．

しかし，これを得るためにも，前節で考えたような議論，特に
$$
\pp{}{t}\E_x[G(X_{t\land\tau_n})]\xrightarrow{n\to\infty}\pp{}{t}\E_x[G(X_t)]
$$
の広義一様収束が必要になる．

::: {.callout-tip title="[@Rudin-Principles p.152 定理7.17]^[[@杉浦光夫1980 p.311] 定理13.7系では，$f_n$ に $C^1$-級の仮定を置いている．]" icon="false"}

$f_n:[a,b]\to\R$ を可微分な関数列とし，ある関数 $f:[a,b]\to\R$ に各点収束するものとする．

仮に，導関数列 $\{f'_n\}$ が一様位相に関して Cauchy 列ならば，$f_n\to f$ も一様収束し，加えて $f$ も可微分で，
$$
\lim_{n\to\infty}f'_n(x)=f'(x)
$$
が成り立つ．

:::

いま，$\E_x[G(X_t)]<\infty$ の仮定から，Lebesgue の優収束定理より，
$$
\E_x[G(X_{t\land\tau_n})]\to\E_x[G(X_t)]
$$
である．加えて，導関数もある関数に一様収束する：
$$
\lim_{n\to\infty}\pp{}{t}\E_x[G(X_{t\land\tau_n})]=\E_x[\wh{L}G(X_t)].
$$

これより，$\E_x[G(X_t)]$ も可微分で，
$$
\pp{}{t}\E_x[G(X_t)]=\E_x[\wh{L}G(X_t)]
$$
が成り立つ．