---
title: "Langevin Dynamics の多項式エルゴード性"
author: "司馬 博文"
date: 7/5/2024
format:
    html:
        toc: true
    pdf: 
        toc: false
        urlcolor: minty
        template-partials: 
            - ../../../before-title.tex
        keep-tex: true
        block-headings: false
        fontsize: 11pt
        lang: ja
        pdf-engine: lualatex
        documentclass: bxjsarticle
        latex-tinytex: true
format-links: [pdf]
categories: [Process]
bibliography: 
    - ../../../mathematics.bib
    - ../../../bib.bib
csl: ../../../apa.csl
---

{{< include ../../../_preamble.qmd >}}

::: {.callout-important appearance="simple" icon="false"}

* $n=1$ で $V(x)=\frac{x^2}{2}$ とした場合，

    $$
    \E_x[G(X_t)]<\infty\quad\Leftrightarrow\quad t<-\frac{1}{2}\log\paren{1-\frac{\beta}{\kappa}}.
    $$

* 次の連続性は？

    $$
    t\mapsto\E_x\SQuare{1_{[0,\tau_n]}(t)\wh{L}G(X_t)}.
    $$
    これさえ言えれば，$\pp{}{t}P_tG=P_t(\wh{L}G)$ を得る．

:::

## $G=e^{\kappa V}$ の可積分性について

### 導入

Markov 過程 $X$ に関するドリフト条件
$$
\wh{L}V\le-C\varphi\circ V\qquad\on\R^n\setminus K
$$
からは $V:E\to\R_+$ の可積分性が出る．

::: {.callout-note title="証明" icon="false" collapse="true"}

上のドリフト条件を，[@Hairer2021-Convergence] の最も弱い意味で解釈すると
$$
M_t:=V(X_t)+C\int^t_0\varphi\circ V(X_s)\,ds
$$
が任意の $x\in E$ に関して $\P_x$-局所優マルチンゲールである，ということになる．

これだけの仮定でも，$V$ が下に有界であるために $M_t$ も下に有界であり，下に有界な局所優マルチンゲールは（真の）優マルチンゲールであることから，
$$
\E_x\Square{V(X_t)+C\int^t_0\varphi\circ V(X_s)\,ds}\le V(x).
$$

加えて左辺が下に有界であることから，$\E_x[V(X_t)]<\infty$ でないと矛盾が起こる．

:::

しかし，lower bound を得たい場合，
$$
\wh{L}V\le C\varphi\circ G\qquad\on\R^n
$$
という情報のみから，
$$
\E_x[G(X_t)]\le g(x,t)\;(<\infty)
$$
という評価を得る必要が出てくる．この場合，$\E_x[G(X_t)]<\infty$ は非自明で，ケースバイケースの議論がであるようである．

### Langevin 動力学の場合

An overdamped Langevin dynamics on $\R$ is defined as the solution to the following SDE:
$$
dX_t=-\nabla V(X_t)\,dt+\sqrt{2\beta^{-1}}\,dB_t,\qquad X_0=x_0.
$$

If $V(x)=\frac{x^2}{2}$, $X$ becomes an Ornstein-Uhlenbeck process. Transforming via $f(t,x)=xe^t$ and using Itô's formula, we get
$$
X_t=x_0e^{-t}+\sqrt{2\beta^{-1}}\int^t_0e^{-(t-s)}\,dB_s.
$$
Hence, $X$ is a Gaussian process with $X_t\sim\rN\paren{x_0e^{-t},\beta^{-1}(1-e^{-2t})}$.

In this case, expectation with respect to $G(y)=e^{\kappa V(y)}=e^{\frac{\kappa y^2}{2}}\;(\kappa\in\R)$ is given by

\begin{align*}
    \E_x[G(X_t)]&=\int_{\R} G(y)\frac{1}{\sqrt{2\pi\beta^{-1}(1-e^{-2t})}}\exp\paren{-\frac{(y-xe^{-t})^2}{2\beta^{-1}(1-e^{-2t})}}\,dy\\
    &=\frac{1}{\sqrt{2\pi\beta^{-1}(1-e^{-2t})}}\int_{\R}\exp\paren{\frac{\kappa\beta^{-1}(1-e^{-2t})y^2-(y-xe^{-t})^2}{2\beta^{-1}(1-e^{-2t})}}\,dy.
\end{align*}


Taking a closer look at the numerator inside $\exp$,

\begin{align*}
    &\qquad\kappa\beta^{-1}(1-e^{-2t})y^2-(y-xe^{-t})^2\\
    &=y^2\Paren{\kappa\beta^{-1}(1-e^{-2t})-1}-2xe^{-t}y+x^2e^{-2t}.
\end{align*}


Therefore, we conclude
$$
\E_x[G(X_t)]<\infty\quad\Leftrightarrow\quad\kappa\beta^{-1}(1-e^{-2t})<1.
$$
In other words, $P_tG(x)$ is finite as long as
$$
t<-\frac{1}{2}\log\paren{1-\frac{\beta}{\kappa}}.
$$

## 微分と拡張生成作用素の関係

まず極めて一般的な仮定で，次のことが言えそうである．

$(X_t)$ を $E=\R^n$ 上の Feller-Dynkin 過程，$(P_t)$ をその遷移半群，$\wh{L}$ をその拡張生成作用素とする．

::: {.callout-tip title="命題" icon="false"}

$G\in\cD(\wh{L})$ とする．すなわち，
$$
t\mapsto M_t:=G(X_t)-\int^t_0\wh{L}G(X_s)ds
$$
は任意の $x\in E$ について $\P_x$-局所マルチンゲールである．

このとき，さらに $G$ について次の条件を仮定する：

1. $\E_x[\abs{G(X_t)}]<\infty\;(x\in E,t\in\R_+)$．すなわち，$P_tG:E\to\R$ が定まる．
2. 同様に $\E_x[\abs{\wh{L}(G)(X_t)}]<\infty\;(x\in E,t\in\R_+)$．すなわち，$\wh{L}P_tG:E\to\R$ も定まる．^[元々はある正の定数 $C>0$ が存在して，$\wh{L}G\le CG$．ある凹関数 $\varphi$ について $\wh{L}G\le\varphi\circ G$ が成り立つならばこの仮定は満たされることに注意，としていた．]
3. 任意の $x\in E$ について，$t\mapsto P_t\wh{L}G(x)$ は連続．

このとき，$P_tG(x)$ は $t$ で連続微分可能であり，次が導ける：
$$
\pp{}{t}\E_x[G(X_t)]=\E_x[\wh{L}G(X_t)].
$$

:::

これは，通常の意味での生成作用素 $L$ の性質
$$
\pp{}{t}P_tG=P_t(LG)
$$
が，可積分性の条件の下で，拡張生成作用素 $\wh{L}$ にも引き継がれると理解できる．

::: {.callout-note title="証明" icon="false"}

局所マルチンゲール性の仮定から，還元する停止時の列 $\{\tau_n'\}$ が存在する：$\tau_n'\nearrow\infty\;\as$ かつ $M^{\tau_n'}$ はマルチンゲール．

これに対して，
$$
\tau_n:=\inf\Brace{t\ge0\mid\abs{G(X_t)}\ge n}\land\tau_n'
$$
と定めると，これもやはり還元する停止時の列である．特に，任意の $n\in\N$ について，$M^{\tau_n}$ はマルチンゲールで，
$$
\E_x\Square{G(X_{t\land\tau_n})-\int^{t\land\tau_n}_0\wh{L}G(X_s)ds}=G(x),\qquad  t\ge0,x\in E.
$$ {#eq-1}

いま，$\abs{G(X_{t\land\tau_n})}\le n$ であるから，^[ここで，Markov 過程 $(X_t)$ の見本道が càdlàg であることを使っている．] $\E_x[\abs{G(X_{t\land\tau_n})}]<\infty$ かつ
$$
\E_x\Square{\Abs{\int^{t\land\tau_n}_0\wh{L}G(X_s)ds}}\le \int^t_0\E_x[\abs{\wh{L}G(X_s)}]ds\le t\max_{s\in[0,t]}\E_x[\abs{\wh{L}G(X_s)}]<\infty.
$$
である．仮定２より $\E_x[\wh{L}G(X_s)]<\infty$ であり，仮定３より $s\mapsto\E_x[\wh{L}G(X_s)]$ は連続であることを用いた．

よって，式 ([-@eq-1]) は
$$
\E_x\SQuare{G(X_{t\land\tau_n})}=G(x)+\E_x\SQuare{\int^{t\land\tau_n}_0\wh{L}G(X_s)ds}
$$
とも表せる．ここで，両辺を $t$ に関して微分するが，
$$
\Om\times(0,\infty)\ni(\om,t)\mapsto\int^{t\land\tau_n}_0\wh{L}G(X_s)ds
$$
が任意の $t\in(0,\infty)$ について

1. $\P_x$ について可積分で，
2. 変数 $t$ に関する偏微分係数も $\P_x$ について可積分

であるから，右辺は $t$ で微分可能であり，さらに $\E_x$ と $\pp{}{t}$ とが交換できる：
$$
\pp{}{t}\E_x\SQuare{G(X_{t\land\tau_n})}=\E_x\SQuare{\pp{}{t}\int^{t\land\tau_n}_0\wh{L}G(X_s)ds}=\E_x\SQuare{1_{[0,\tau_n]}(t)\wh{L}G(X_t)},\qquad n\in\N,x\in E,t\in(0,\infty).
$$
これより，左辺の $\E_x[G(X_{t\land\tau_n})]$ も $t\in(0,\infty)$ に関して微分可能だったことがわかる．

両辺の $n\to\infty$ に関する極限を取ると，右辺は $\abs{\wh{L}G(X_t)}$ が $\P_x$-可積分であるから（仮定２），Lebesgue の優収束定理より，
$$
\lim_{n\to\infty}\pp{}{t}\E_x[G(X_{t\land\tau_n})]=\E_x\SQuare{\lim_{n\to\infty}1_{[0,\tau_n]}(t)\wh{L}G(X_t)}=\E_x[\wh{L}G(X_t)],\qquad x\in E,t\in(0,\infty).
$$
この収束は，$t\in(0,\infty)$ に関して広義一様に起こっている．^[$\E_x\SQuare{1_{[0,\tau_n]}(t)\wh{L}G(X_t)}\to\E_x[\wh{L}G(X_t)]$ の収束が広義一様に起こるためである．

\begin{align*}
&\qquad\sup_{t\in[0,T]}\Abs{\pp{}{t}\E_x[G(X_{t\land\tau_n})]-\E_x[\wh{L}G(X_t)]}\\
&=\sup_{t\in[0,T]}\ABs{\E_x[1_{[0,\tau_n]}(t)\wh{L}G(X_t)]-\E_x[\wh{L}G(X_t)]}\\
&=\sup_{t\in[0,T]}\ABs{\E_x\Square{(1_{[0,\tau_n]}(t)-1)\wh{L}G(X_t)}}\\
&\le\E_x\SQuare{\sup_{t\in[0,T]}\paren{1_{[0,\tau_n]}(t)-1}\wh{L}G(X_t)}\xrightarrow{n\to\infty}0.
\end{align*}

ここで $t\mapsto\wh{L}G(X_t)$ の連続性を使った可能性がある．すなわち，拡散過程と $G\in C^2(E)$ に対する拡張生成作用素 $\wh{L}$ の形の知識まで使った可能性がある．
]

よって，あとは
$$
t\mapsto \E_x\SQuare{1_{[0,\tau_n]}(t)\wh{L}G(X_t)}
$$
が連続であることを示せば良い．

:::