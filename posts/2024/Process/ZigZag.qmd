---
title: "Zig-Zag サンプラー"
subtitle: "ジャンプと確定的な動きによる新たな MCMC 手法"
author: "司馬 博文"
date: 7/3/2024
categories: [Process, Simulation, R, MCMC]
image: PureJump.png
bibliography: 
    - ../../../mathematics.bib
    - ../../../bib.bib
csl: ../../../apa.csl
abstract-title: 概要
abstract: Zig-Zag サンプラーの挙動を詳細に解析する．
---

{{< include ../../../_preamble.qmd >}}

## シミュレーション

### パッケージ

[Joris Bierkens](https://diamhomes.ewi.tudelft.nl/~jorisbierkens/pdmps.html) ら開発の R パッケージ `RZigZag` ([GitHub](https://github.com/jbierkens/RZigZag) / [CRAN](https://cran.r-project.org/web/packages/RZigZag/index.html)) が最も手軽に実行できる．

```r
install.packages("Rcpp")
install.packages("RcppEigen")
install.packages("RZigZag")
```

一方で，[@Bierkens+2022] では Julia によるパッケージ `ZigZagBoomerang`（[GitHub](https://github.com/mschauer/ZigZagBoomerang.jl) / [ANN](https://discourse.julialang.org/t/ann-zigzagboomerang-jl/57287)） も提供している．

### ２次元の場合

```{r}
#| fig-cap: "$\\rN_2\\paren{\\vctr{2}{2},\\mtrx{3}{1}{1}{3}}$ に対する Zig-Zag 過程"
library(RZigZag)
library(ggplot2)
V <- matrix(c(3,1,1,3),nrow=2)
mu <- c(2,2)
result <- ZigZagGaussian(V, mu, 100)
ggplot() +
   geom_path(aes(x=result$Positions[1,], y=result$Positions[2,]), color="#80c4ac") +
   geom_point(aes(x=result$Positions[1,], y=result$Positions[2,]), color="#80c4ac") +
   labs(x="", y="", title="Zig-Zag Sampler") +
   theme_void() +
   theme(text=element_text(size=12), axis.title=element_text(color="#80c4ac"), plot.title=element_text(color="#80c4ac"))
```

```{r}
#| fig-cap: "Cauchy 分布 $\\rC(0,1)=\\rt(1)$ に対する Zig-Zag 過程"
set.seed(123)
dim <- 2
dof <- 1
result <- ZigZagStudentT(dof, dim, n_iter=1000, sphericallySymmetric = TRUE)
ggplot() +
   geom_path(aes(x=result$Positions[1,], y=result$Positions[2,]), color="#80c4ac") +
   geom_point(aes(x=result$Positions[1,], y=result$Positions[2,]), color="#80c4ac") +
   labs(x="", y="", title="Zig-Zag Sampler") +
   theme_void() +
   theme(text=element_text(size=12), axis.title=element_text(color="#80c4ac"), plot.title=element_text(color="#80c4ac"))
```
