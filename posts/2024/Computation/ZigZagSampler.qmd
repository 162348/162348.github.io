---
title: "Zig-Zag サンプラー"
subtitle: "物理のくびきを超える MCMC"
author: "司馬博文"
date: "7/25/2024"
categories: [Slide, MCMC, Julia]
image: ../Process/ZigZag_1D.svg
format:
  html: default
  revealjs: 
    output-file: ZigZagSampler_Slides.html
    slide-number: true
    chalkboard: 
      buttons: false
    preview-links: auto
    logo: ../../../profile.jpg
    css: ../../../slides.css
    footer: |
      [司馬博文](https://162348.github.io/posts/2024/Computation/ZigZagSampler.html)
    scrollable: true
    smaller: false
    controls: true
    controls-layout: bottom-right
    self-contained-math: true
    shift-heading-level-by: -1
    toc: true
    toc-depth: 1
    toc-title: 目次
    number-sections: true
    theme: serif
    show-slide-number: all
    include-in-header: ../../../include-in-header.html
bibliography: 
    - ../../../mathematics.bib
    - ../../../bib.bib
csl: ../../../apalike.csl
description: |
  スライドは<a href="https://162348.github.io/posts/2024/Computation/ZigZagSampler_Slides.html" style="text-decoration: underline;">こちら</a>．
# image: Images/Bayes.svg
comment: false
code-fold: false
execute:
    cache: true
html-math-method: katex
abstract-title: 概要
abstract: |
  本郷キャンパスにて発表．
  スライドは[こちら](https://162348.github.io/posts/2024/Computation/ZigZagSampler_Slides.html)．
  より発展的な内容については，[こちらの稿](../Process/ZigZag.qmd)も参照．
---

## Zig-Zag サンプラー

{{< include ../../../_preamble.qmd >}}

### 他手法との違い：非対称なダイナミクス

標準 Cauchy 分布 $f(x)=\frac{1}{\pi\sigma}\frac{1}{1+\paren{\frac{x-\mu}{\sigma}}^2}$ に対して：

::: {layout-ncol=2}
![Zig-Zag サンプラー](../Process/ZigZag_1D.svg)

![Metropolis-adjusted Langevin Algorithm](../Process/MALA_1D.svg)
:::

### 区分確定的モンテカルロ法

PDMP (Piecewise Deterministic Markov Process)：ランダムな時刻にランダムな動きをする以外は，確定的な動き

![区分確定的モンテカルロ法 Animated by [@Grazzi2020]](pdmps.gif)

### Zig-Zag サンプラーの美点

1. [ダイナミクスが良い]{.underline}

    [前スライドで見た通り，**非対称な**ダイナミクス]{.small-letter}

2. [シミュレーションが簡単]{.underline}

    [PDMP (Piecewise Deterministic Markov Process)：離散化誤差なしで簡単にシミュレーションできる稀有な連続過程]{.small-letter}

3. [スケーラブルなサンプリング手法]{.underline}

    [全データにアクセスする必要はなく，一部で良い（サブサンプリング）]{.small-letter}

    [**バイアスが入らない**サブサンプリングが可能]{.small-letter}

### Zig-Zag 過程のシミュレーション

::: {.callout-tip appearance="simple" icon="false"}

1. 後述のレート関数 $\lambda_1,\cdots,\lambda_d$ から定まる強度関数
    $$
    m_i(t):=\lambda_i(x+\theta t,\theta),\qquad i\in[d],
    $$
    を持つ，$d$ 個の独立な $\R_+$ 上の非一様 Poisson 点過程の，最初の到着時刻 $T_1,\cdots,T_d$ をシミュレーションする．
2. 最初に到着した座標番号 $j:=\argmin_{i\in[d]}T_i$ について，時刻 $T_j$ に速度成分 $\theta_j$ を反転させる．すなわち，関数
    $$
    F_j(\theta)_i:=\begin{cases}-\theta_i&i=j\\\theta_i&i\ne j\end{cases}
    $$
    に従ってジャンプする．
3. １に $t=T_j$ として戻って，くり返す．

:::

### 等価な定義



## ダイナミクスとエルゴード性

## 大規模データに対するベイズ推論

### 大規模データに対する２つのアプローチ

[1. Devide-and-conquer]{.underline}

データをチャンクにわけ，それぞれで MCMC を回し，あとから結果を総合する．

* WASP [@Srivastava+2015]
* [@Li+2017]
* Monte Carlo Fusion [@Dai+2019]

### 大規模データに対する２つのアプローチ

[2. Subsampling]{.underline}

尤度評価（全データが必要）を，リサンプリングから得た推定量で代用する．

* [@Welling-Teh2011]

## ロジスティック回帰での例

## 参考文献