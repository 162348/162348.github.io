---
title: "R（５）統計処理"
author: "司馬 博文"
date: 5/7/2021
date-modified: 6/7/2024
categories: [Computation, R]
bibliography: 
    - ../../../mathematics.bib
    - ../../../bib.bib
csl: ../../../apa.csl
abstract-title: 概要
abstract: R は統計計算のための言語です．
format:
  html:
    code-fold: false
---

## 統計処理

### Stats

* `runif(n [,min=0, max=1])`：区間上の一様分布
    * `dunif`：density
    * `punif`：distribution function
    * `qunif`：quantile function
* ``rnorm(n [, mean=0, sd=1])`：正規分布
    * `dnorm`
    * `pnorm`
    * `qnorm`
* `sample(x, size [,replace=FALSE, prob=NULL])`：ベクトル`x`の中から`size`個をランダム抽出
    * 元々が非復元抽出なので，`size=length(x)`とすると置換．`replace=TRUE`とすると復元抽出．
    * `prob`に vector を引かせると，`x`の要素にでやすさの重みがつく．

### 時系列分析
* {ts.plot()}

### Graphics

* `hist(x, …)`
    * `breaks=“Starges”`：bin の数を Starges の公式で定めているところを，scaler `n`で指定できる．
    * `col=“NULL”`：bars を fill する色．`lightgreen`などにできる．
    * `main`, `xlab`, `ylab`：`title()`で get する attribution
    * `right=“TRUE”`：デフォルトでは bin は right-closed である．
* `plot(x[, y, …])`
    * `x`が適切な構造を持つなら{y}はいらない．
    * array を渡すと，タイル図になる．
    * df を渡すと，散布図になる．
* `image(x)`

### grDevices

* `hcl.colors(n)`：`n`色の pallete を作成する．

### Datasets
`data()`で一覧を見れる

* `co2`
    * Mauna Loa の CO2 concentration
* `volcano`
    * Aukland’s Maunga Whau の topographic data
    * 10m×10m 範囲
* `Titanic`
    * 4-dimentional array
* `airquality`
    * New York Airquality Measurement
    * ６変数についての data frame
* `jpdata`
    * 統計局からの県別データで utf8 なので`read.csv(file=“”, fileEncoding=“utf8”)`が安全．
    * `jpdata1.csv`：対象データ
    * `jpdata2.csv`：対象データの内容
    * `jpdata3.csv`：圏別と地域の対応関係
* `tokyo_weather`
    * 気象庁からのデータ．
* `tokyo_covid19`
    * 東京の stopcovid19.metro.tokyo.lg.jp のデータ項目．

### `formula`クラス
a symbolic description of the model to be fitted

#### 構成

```r
y ~ x1 + x2 + ...
```

| | |
|:---:|:---:|
| `class` | `formula` |
| `typeof` | `language` |
| `mode` | `call` |

: {.active .hover .bordered .responsive-sm}

::: {.callout-caution title="例" collapse="true"}
```{r}
formula <- y ~ x1 + x2 + x3
```

```{r}
typeof(formula)
```

```{r}
class(formula)
```

```{r}
class(formula)
```

```{r}
str(formula)
```
:::


#### メソッド
* `summary(object, ...)`

#### 線型モデルのフィッチxイング
```r
lm(formula, data, subset, weights, na.action, method = "qr", model = TRUE, x = FALSE, y = FALSE, qr = TRUE, singular.ok = TRUE, contrasts = NULL, offset, ...)
```
* `formula`：`vector ~ vector`の形の
* 最小二乗法を使って，formula `y~x`を関係式 $y = a + bx$ の $a,b$ の値を定める．
    * 推定値は `$coefficients` に格納される．