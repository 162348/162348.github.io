---
title: "Peters and de With (2012) Rejection-Free Monte Carlo Sampling for General Potentials"
author: "司馬 博文"
date: 4/6/2024
categories: [Review]
bibliography: 
    - ../../../mathematics.bib
    - ../../../bib.bib
csl: ../../../apa.csl
abstract-title: 概要
abstract: |
    [@Peters-deWith2012] は対称とは限らないエルゴード的な Markov 連鎖の収束レートを，カップリングの方法を用いて導出した仕事．
---

{{< include ../../../_preamble.qmd >}}

## 概要

統計用語でいう Bouncy Particle Sampler を，Metropolis-Hastings 法の連続時間極限として初めて提案した論文であるが，これが [@Bouchard-Cote+2018-BPS] に発見されるには６年の時間を要した．

## 背景

（古典）統計力学に従って粒子系をシミュレーションする際には，MD (molecular dynamics) と MC (Monte Carlo methods) の組み合わせを用いることになるが，現状いずれも Metropolis [@Metropolis+1953] の採択-棄却の枠組みで実行されるのが最も一般的である．

Metropolis の方法だと，

* 凝縮系では MD 法としてのタイムステップは小さく取る必要があると同時に棄却率が高くなる．
* 希薄系ではタイムスケールは分子の衝突過程に依存するので，シミュレーション時間のほとんどは無駄に使う必要が出る．

という難点があるが，これは最初の MD 法 [@Alder-Wainwright1959] で取られたような event-driven な方法で改善できる．

### 分子動力学

分子動力学法 (MD: Molecular Dynamics simulation) は，系のミクロなダイナミクスを実験的に調べる代わりに，シミュレーションによって必要条件を絞り込んでいく構成的な・計算機集約的なアプローチである．

特に，多体系の運動方程式を計算機を用いて数値的に解くことを指す [@Alder-Wainwright1959]．それ故，物理や化学はもちろん，生化学，物質科学，さらには工学分野にまで幅広く用いられるシミュレーション法になる．

> the inescapable conclusion is that MD will — if it hasn’t already — become an indispensable part of the theorist’s toolbox. [@Rapaport2004 p.ix]

従来は実験と理論が相補的な関係にあったが，まるで基盤モデルが強化学習のための効率的な世界モデルになるように，計算機シミュレーションと Monte Carlo 法が新時代の科学の第三の要素になるのかも知れない．^["What distinguishes computer simulation in general from other forms of computation, if such a distinction can be made, is the manner in which the computer is used: instead of merely performing a calculation, the computer becomes the virtual laboratory in which a system is studied - a numerical experiment." [@Rapaport2004 p.3]．]

アイデア自体は当然極めてナイーブであり，Laplace の悪魔や気体分子運動論の時代から大変に意識されたが，その最初の非自明な適用はデジタルコンピュータ完成のあとであった [@Alder-Wainwright1958], [@Alder-Wainwright1959]．

彼らの関心は，ポロニウムなどの剛体球 (hard-sphere) の系とみれる物質の温度に依存した相転移現象にあった [@Alder-Wainwright1957]．[@Alder-Wainwright1959] では撃力相互作用 (impulsive interaction) が問題であったので，event-driven なシミュレーション (ED-MD scheme) が取られていたことは [@Peters-deWith2012] でも言及されている．当時の計算機では，500個の粒子を扱うことが限界であったことが興味深い．

その他に，粒子に内部構造がない場合は time-driven な Newton 力学のシミュレーションで良いかもしれないが，剛体で体積を持つ場合は Euler 方程式，内部構造を持つ場合は Langrange 方程式のシミュレーションも伴うかもしれない [@Rapaport2004 p.4]．

通常の平衡状態の（エネルギー・体積・粒子数一定の）分子系は小正準集団に対応するが，特定の温度条件下での物性を考えたい場合は，運動方程式を修正してシミュレーションする方法もある．この方法の欠点は，物性を再現できても，個々の分子の軌道を正しく模倣しているわけではないという点であるが，そもそもそのカオス的な振る舞いから，正しい軌道を得ることは諦めることが多い．このこともあり，MD 法で用いられる数値積分法は比較的低次元で軽量なものでも十分なのである [@Rapaport2004 p.4]．^[内部構造がある分子をシミュレーションする場合はよりやわらかい相互作用を考える必要があり，その際は積分は高次元になる上に，内部の運動が高速であるためにタイムステップも細かくする必要が出てくる．さらに拘束条件が存在する場合は，積分法よりも高い精度で取り扱う必要があり，特別な注意を要する．]

#### 他手法との比較

セルオートマトンや格子ボルツマン法などの格子ベースの手法の方が計算量は安価であるが，表現力に劣ることになる．

Lanvegin 方程式に基づいた Brownian dynamics などのさらに連続時間ベースの手法もある．

### 統計力学で用いる分子動力学法

統計力学において，マクロ物理量はアンサンブル平均として計算され，エルゴード仮説の下では１つの系の時間発展を追うことで計算できることになる．これに MD を用いることになるため，自然と Monte Carlo 法として MD を用いることになるが，タイムステップが系の特徴的な事象をよく捉えるように注意して取る必要がある．

特に MD シミュレーション自体が（温度と粒子数が一定な）小正準集団に対応することになる [@Rapaport2004 p.6]．

