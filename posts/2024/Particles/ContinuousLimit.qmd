---
title: "粒子フィルターの連続極限"
author: "Draft Draft"
date: 1/23/2024
categories: [Particles, Process]
toc: true
number-sections: true
code-block-bg: true
code-block-border-left: "#31BAE9"
code-overflow: wrap
code-fold: true
bibliography: 
    - ../../../mathematics.bib
    - ../../../bib.bib
csl: ../../../apa.csl
crossref:
    sec-prefix: 節
    eq-prefix: 式
    def-prefix: 定義
    def-title: 定義
    thm-prefix: 定理
    thm-title: 定理
    fig-prefix: 図
    fig-title: 図
abstract-title: 概要
abstract: 粒子フィルターを，拡散過程に対して適用することを考える．
---

{{< include ../../../_preamble.qmd >}}

## 枠組み

リサンプリングと，粒子フィルターは $(\Om,\F,\P)$ 上の関数とする．

観測対象は $(\Om',\F',\P')$ 上の過程 $z:\R_+\times\Om'\to\R^d$ とする．

２つの分布の間の関係を導く．

### リサンプリング

::: {.callout-tip}
## 定義（リサンプリング）

1. 積空間 $[N]^{[N]}$ を **附番の空間** といい，$a\in[N]^{[N]}$ で表す．

2. 粒子数 $N$ に関する **リサンプリング法** とは，荷重に応じて，附番の空間上の確率分布を対応させる関数
$$
r:\R_+^N\to\cP([N]^{[N]})
$$
をいう．ここでは，$\cP([N]^{[N]})$ は質量関数 $[N]^{[N]}\to[0,1]$ の全体に，各点収束の位相を考えたものと同一視する．

3. リサンプリング法 $r$ が **不偏** であるとは，任意の番号 $j\in[N]$ に対して，その番号を得る粒子数の期待値が，荷重の通りになることをいう：$A\sim r(w)$ ならば，
$$
\E[A^{-1}(j)]=\E\Square{\sum_{i=1}^N1_{\Brace{A(i)=j}}}=N\frac{w_j}{\norm{w}_1}
$$

:::

::: {.callout-caution icon="false" collapse="true" title="PAC-Bayes × リサンプリング？"}
問題構成がすごく PAC-Bayes っぽい．というより，Gibbs classifier っぽい．
:::

このリサンプリング法の一様極限における性質を，関数
$$
\iota:\R_+^N\times(0,1)\to\R_+^N
$$
を通じて調べる：
$$
\iota(w,\Delta):=\frac{r(e^{-\Delta w})}{\Delta}.
$$
この $\iota$ は $\R^N_+\times(0,1)$ 上で連続になるとする．これは，$r:\R_+^N\to\cP([N]^{[N]})$ が連続ならば成り立つ．
^[$\cP([N]^{[N]})$ 上の弱位相は，質量関数の各点収束に同値．よって，任意の附番 $a\in[N]^{[N]}$ に対して，$r(e^{-\Delta w})(a)\in[0,1]$ が連続であることに同値．つまり，$a\in[N]^{[N]}$ の通りにリサンプリングされる確率が，荷重 $w\in\R_+^N$ の変化に対して連続的に変化することを要請している．]

任意の荷重 $w\in\R_+^N$ に対して，$\Delta\to0$ の極限で
$$
\iota(w,0):=\lim_{\Delta\to0}\frac{r(e^{-\Delta w})}{\Delta}\quad\in\cM([N]^{[N]})
$$
が $\id_{[N]}$ 上を除いて存在するとし，延長 $\iota:\R_+^N\times[0,1]\to\R_+^N$ が連続であるとする．

これは上の収束が $w\in\R_+^N$ に関して一様に成り立つならば，成り立つ．

$\iota(w,0)$ は **極限リサンプリング測度** であり，総和を取ったもの
$$
\iota^*(w):=\sum_{a\in[N]^{[N]}}\iota(w,0)(a)\quad\in\R_+
$$
は **リサンプリング率** と呼べる．

### 粒子フィルターの構成

::: {.callout-tip icon="false"}
## 目標となる Feynman-Kac 測度

$\R^d$ 上の伊藤拡散 $\{z_t\}\subset\L(\Om';\R^d)$ は，
$$
b_i,\sigma_{ij}\in\Lip_b(\R^d)\quad(i,j\in[d])
$$
が定める確率微分方程式
$$
z_t=b(z_t)dt+\sigma(z_t)dB_t
$$
で定まるものとする．

これを参照過程とし，ポテンシャル $V\in C_b(\R^d)_+$ が定める Feynman-Kac 測度を $\Pi\in C_c(D_{\R^d}(\R_+))^*$ と表す．
:::

この $D_{\R^d}(\R_+)$ 上の Feynman-Kac 測度を，離散時間粒子フィルターがどこまで近似できるかを考える．

::: {.callout-tip icon="false"}
## 粒子フィルターの構成

粒子フィルター $\{X^\Delta_k\}\subset\L(\Om;M_{Nd}(\R))$ は最も自然に構成する．

粒子数 $N$ のリサンプリング法 $r$ に関して，サンプリング間隔を $\Delta>0$ として，
$$
\begin{align*}
    (X^\Delta_k)^i&:=(X_{k-1}^\Delta)^{A_k(i)}+\Delta\cdot b\paren{(X_{k-1}^\Delta)^{A_k(i)}}\\
    &\qquad+\sigma\paren{(X_{k-1}^\Delta)^{A_k(i)}}(B_{k\Delta}^i-B_{(k-1)\Delta}^i)\\
    &\qquad\qquad(i\in[N],k\in\N)\\
    A_k&\iidsim r(e^{-\Delta V(X^\Delta_k)})
\end{align*}
$$
と再帰的に定める．

これを $D_{\R^d}(\R_+)$-過程と見たものを
$$
Z_t^\Delta:=X_{\Floor{\frac{t}{\Delta}}}^\Delta
$$
と表す．フィルトレーション $\F_t$ は $(B_s)_{s\in[0,t]}$ と $\paren{A_{\Floor{\frac{s}{\Delta}}}}_{s\in[0,t]}$ とが生成するものの，完備右連続化とする．

:::

1. 任意の単調減少列 $\{\Delta_n\}\subset\R^+$ に対して，粒子フィルターの列
$$
\{X^{\Delta_n}\}\subset\L(\Om;D_{M_{Nd}(\R)}(\R_+))
$$
は一様に緊密である．

::: {.callout-tip icon="false"}
## 定理

次を仮定する：

1. $b_i,\sigma_{ij}\in\Lip_b(\R^d)\quad(i,j\in[d])$．
2. $\inf_{x\in\R^d}\inf_{\substack{\theta\in\R^d\\\norm{\theta}_2=1}}\norm{\sigma(x)\theta}_2>0$．
3. $\iota:\R_+^{N}\times[0,1]\to\R_+^{d}$ は連続．^[その結果，任意の $a\in[N]^{[N]}\setminus\{\id_{[N]}\}$ に関して，$\R^{dN}\ni x\mapsto\iota(V(x^1,\cdots,x^N),0)(a)$ が有界連続になる．]

このとき，次が成り立つ：

1. 

:::