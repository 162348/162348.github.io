% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
]{article}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage[sfmath]{kpfonts}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{5}


\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother
% definitions for citeproc citations
\NewDocumentCommand\citeproctext{}{}
\NewDocumentCommand\citeproc{mm}{%
  \begingroup\def\citeproctext{#2}\cite{#1}\endgroup}
\makeatletter
 % allow citations to break across lines
 \let\@cite@ofmt\@firstofone
 % avoid brackets around text for \cite:
 \def\@biblabel#1{}
 \def\@cite#1#2{{#1\if@tempswa , #2\fi}}
\makeatother
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newenvironment{CSLReferences}[2] % #1 hanging-indent, #2 entry-spacing
 {\begin{list}{}{%
  \setlength{\itemindent}{0pt}
  \setlength{\leftmargin}{0pt}
  \setlength{\parsep}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
   \setlength{\leftmargin}{\cslhangindent}
   \setlength{\itemindent}{-1\cslhangindent}
  \fi
  % set entry spacing
  \setlength{\itemsep}{#2\baselineskip}}}
 {\end{list}}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{\hfill\break\parbox[t]{\linewidth}{\strut\ignorespaces#1\strut}}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}

\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{図}
\else
  \newcommand\figurename{図}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother

\usepackage{bookmark}

\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={PDMP によりスパイク付きの非絶対連続分布からもサンプリングが可能になる},
  pdfauthor={司馬 博文（総合研究大学院大学先端学術院統計科学コース５年一貫博士課程２年）},
  colorlinks=true,
  linkcolor={minty},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={minty},
  pdfcreator={LaTeX via pandoc}}

%%% Layout
  %\PassOptionsToPackage{top=15truemm,bottom=15truemm,left=10truemm,right=10truemm}{geometry}
\usepackage[top=15truemm,bottom=15truemm,left=10truemm,right=10truemm]{geometry}
% Floats
\usepackage{picture}\usepackage{footnote}
% Decorations
\usepackage{fontawesome5}
\definecolor{minty}{HTML}{80c4ac}\definecolor{ParisGreen}{cmyk}{1,0.07,0.10,0.10}\definecolor{ISMBlue}{HTML}{2F579C}
% Links
\usepackage{url}\PassOptionsToPackage{colorlinks,linkcolor=minty,urlcolor=minty,citecolor=minty}{hyperref}

%%% Language & Mathematics
% Mathematics
\usepackage{mathtools} %内部でamsmathを呼び出すことに注意．
\usepackage{amsfonts} %mathfrak, mathcal, mathbbなど．
\usepackage{amsthm} %定理環境．
\usepackage{amssymb} %AMSFontsを使うためのパッケージ．
\usepackage{ascmac} %screen, itembox, shadebox環境．全てLATEX2εの標準機能の範囲で作られたもの．
\everymath{\displaystyle}
% Fonts
  % \usepackage[math]{anttor}\DeclareMathAlphabet{\mathcal}{OMS}{cmsy}{m}{n}  % LaTeX Error: Math alphabet identifier \mathrm  is undefined in math version `antt'.
% Japanese
\usepackage{luatexja}
% \usepackage{xeCJK}  % ダウンロード長すぎる
% \setCJKmainfont{UDEVGothicNF-Regular.ttf}  % UDEVGothicNF-Regular.ttf が使いたい
% \usepackage{luatexja-fontspec}
% \setmainfont{みかちゃん.ttf}  % 英語だけ動いた．何？


%%% Environments
\usepackage{enumerate} %enumerate環境を凝らせる．
\renewcommand{\labelenumi}{(\arabic{enumi})} %(1),(2),...がデフォルトであって欲しい
\renewcommand{\labelenumii}{(\roman{enumii})}
\renewcommand{\labelenumiii}{(\alph{enumiii})}
% Bibliography
% \usepackage{etoolbox}
% \AtBeginEnvironment{CSLReferences}{% thebibliography 環境の前にフックを追加
%   \setlength{\itemsep}{1pt} % \bibitem 間のスペースを0ptに設定
%   \setlength{\parskip}{1pt} % 段落間のスペースを0ptに設定
% }
% Theorems
\usepackage{amsthm}\newtheoremstyle{StatementsWithUnderline}% ?name?
{3pt}% ?Space above? 1
{3pt}% ?Space below? 1
{}% ?Body font?
{}% ?Indent amount? 2
{\bfseries}% ?Theorem head font?
{\textbf{.}}% ?Punctuation after theorem head?
{.5em}% ?Space after theorem head? 3
{\textbf{\underline{\textup{#1~\thetheorem{}}}}\;\thmnote{(#3)}}% ?Theorem head spec (can be left empty, meaning ‘normal’)?
\definecolor{darkolivegreen}{rgb}{0.33, 0.42, 0.18}\newenvironment{Proof}[1][\bf\underline{［証明］}]{\proof[#1]\color{darkolivegreen}}{\endproof}
\theoremstyle{StatementsWithUnderline}\newtheorem{theorem}{定理}[section]\newtheorem{definition}[theorem]{定義}\newtheorem{corollary}[theorem]{系}\newtheorem{proposition}[theorem]{命題}\newtheorem{lemma}[theorem]{補題}\newtheorem{example}[theorem]{例}
\theoremstyle{definition}\newtheorem{notation}[theorem]{記法}\newtheorem{algorithm}[theorem]{算譜}\newtheorem{remarks}[theorem]{要諦}\newtheorem{remark}[theorem]{注}
\usepackage{etoolbox}\AtEndEnvironment{example}{\hfill\ensuremath{\Box}}\renewcommand{\thefootnote}{\dag\arabic{footnote}}\renewcommand{\thempfootnote}{\dag\arabic{mpfootnote}}
% 行間調整
\renewcommand{\baselinestretch}{1.5}  % なぜか行間がものすごく詰まってしまうので．


% \titleformat{\subsection}[block]
% {}{}{0pt}
% {
%     \colorbox{minty}{\begin{picture}(0,10)\end{picture}}
%     \hspace{0pt}
%     \normalfont \Large\bfseries
%     \hspace{-4pt}
% }
% [
% \begin{picture}(100,0)
%     \put(3,18){\color{minty}\line(1,0){300}}
% \end{picture}
% \\
% \vspace{-30pt}
% ]

% \titlespacing{\subsection}{0pc}{3.5ex plus .1ex minus .2ex}{1.5ex minus .1ex}

% \renewcommand{\labelitemi}{\textcolor{minty}{\faCheckCircle}} %https://mirrors.ibiblio.org/CTAN/fonts/fontawesome/doc/fontawesome.pdf
% \faPaperclip が文献の列挙に良いかも．



\title{\Large PDMP
によりスパイク付きの非絶対連続分布からもサンプリングが可能になる}
\author{司馬
博文（総合研究大学院大学先端学術院統計科学コース５年一貫博士課程２年）}
\date{2/25/2025}

\begin{document}
\maketitle
\begin{abstract}
区分確定的マルコフ過程 (PDMP)
とはマルコフ連鎖，拡散過程に続いて，近年活発にモンテカルロ法に利用されつつある連続時間マルコフ過程のクラスである．より速く収束するサンプラーが構成しやすいこと，モンテカルロ推定量にバイアスを導入しないようなサブサンプリング（バッチ実行）が可能であることから，近年特に統計・機械学習の分野でも注目が高まっている．

本ポスター発表ではPDMPとMCMCの違いを明確にすると同時に，
PDMPのシミュレーション法に紙面を割き，最新のアルゴリズムと筆者開発のパッケージの実装の強みを紹介する．
加えて「
\(\delta\)-部分を持った非絶対連続確率分布からも正確なサンプリングが可能」という
PDMP
に基づくモンテカルロ法の第３の利点に焦点を当て，特にベイズ変数選択を応用として取り上げる．
\end{abstract}


\section{導入：新たなモンテカルロ法の出現}\label{ux5c0eux5165ux65b0ux305fux306aux30e2ux30f3ux30c6ux30abux30ebux30edux6cd5ux306eux51faux73fe}

　マルコフ連鎖モンテカルロ法 (MCMC: Markov Chain Monte Carlo)
や逐次モンテカルロ法 (SMC: Sequential Monte Carlo)
などのモンテカルロ法は，
21世紀に入って計算機が普及してのち，ベイズ統計の応用範囲を爆発的に拡大する立役者となった
(Gilks et al., 1996), (Doucet et al., 2001), (Martin et al., 2024)．
近年提案された\textbf{区分確定的マルコフ過程} (PDMP: Piecewise
Deterministic Markov Process)
を利用した新たなモンテカルロ法も，この系列に続くものと理解できる．

　MCMCとSMCはいずれも離散時間のマルコフ過程 \((X_n)_{n=1}^\infty\)
のシミュレーションに基づく． ここでは特にMCMCに焦点を当てる．
ベイズ統計では事後分布 \(\pi\)
を導くことで推論を実行するが，事前分布や尤度の選択範囲を大きく制限しない限り，\(\pi\)
は既知の分布とはならない． たとえ \(\pi\)
の関数形がわかっていても，事後分布 \(\pi\)
の平均を求めるなど，これを後続の統計解析に供することは必ずしも簡単ではない．
そんな中でも，事後分布 \(\pi\)
を平衡分布にもつエルゴード的なマルコフ連鎖 \((X_n)\)
を設計することができれば，大数の強法則
\begin{equation}\phantomsection\label{eq-LLN}{
\frac{1}{N}\sum_{n=1}^Nf(X_n)\xrightarrow{N\to\infty}\int f(x)\pi(dx)\;\;\text{a.s.}\qquad f\in\mathcal{L}^1(\pi)
}\end{equation} が成り立つ (Kulik, 2018, pp.
175--176)．この事実を用いて事後分布 \(\pi\)
を近似する枠組みがMCMCであり， 条件を満たす \((X_n)\)
の構成法にGibbsサンプラー (Geman and Geman, 1984)
やランダムウォークMetropolis-Hastings法 (Hastings, 1970) などがある．

　多くの MCMC 法は物理学に由来する．例えば Gibbs サンプラーは Ising
モデル (Glauber, 1963)，Metropolis-Hastings 法は状態方程式 (Metropolis
et al., 1953) のシミュレーションにおいて最初に提案された．
MCMCという名前は (Geman and Geman, 1984) や (Hastings, 1970)
などで統計学における確率分布からのサンプリングの問題に応用されて初めて付いたものである．

　連続時間のマルコフ過程であるPDMPを用いた新しいモンテカルロ法も，やはり物理学における研究
(Bernard et al., 2009), (Peters and de~With, 2012) で最初に使われ始め，
初の氷の液相転移の全原子シミュレーションも成功させている (Faulkner et
al., 2018)． これに倣い統計でもBouncy Particle Sampler (BPS)
(Bouchard-Côté et al., 2018) や Zig-Zag Sampler (Bierkens et al.,
2019)，Forward PDMC (Michel et al., 2020)
などの汎用アルゴリズムが提案され， この手法群に PDMP
に由来する\textbf{区分確定的モンテカルロ法} (PDMC: Piecewise
Deterministic Monte Carlo) の名前がついた．

\subsection{ポスターと本稿の構成}\label{ux30ddux30b9ux30bfux30fcux3068ux672cux7a3fux306eux69cbux6210}

　本ポスターでは紙面を３つにわける．
本稿もこれに対応する３つの節を用意し，それぞれを詳説する．
初めにPDMCとMCMC（従来法）の違いを，シミュレートされるマルコフ過程の違いとアルゴリズムの違いの両面からみる（第
\ref{sec-1} 節）．
続いてPoisson剪定をはじめとするPDMPのシミュレーションの自動化法を解説し，
筆者が開発したパッケージ \texttt{PDMPFlux.jl} (Shiba, 2025)
ではどのようなアプローチを取っているかを解説する（第 \ref{sec-2} 節）．
最後にMCMCでは不可能であったがPDMCで可能になることとして，デルタ部分を持つ非絶対連続分布
\begin{equation}\phantomsection\label{eq-spike-and-slab}{
p(dx)=\prod_{i=1}^d\biggr(\omega_ip_i(x_i)\,dx_i+(1-\omega_i)\delta_0(dx_i)\biggl)
}\end{equation}
からのサンプリング法を紹介し，ベイズ変数選択への応用に触れる（第
\ref{sec-3} 節）．

\section{PDMCとMCMCの違い}\label{sec-1}

　既存のPDMC法はいずれも， \begin{equation}\phantomsection\label{eq-pi}{
\pi(x)\,\propto\,e^{-U(x)},\qquad U\in C^1(\mathbb{R}^d),
}\end{equation}
という表示を持つ確率分布を対象に扱う．定数の差を除いて負の対数密度
\(-\log\pi\) にあたる \(U\)
をポテンシャルとも呼び，PDMCアルゴリズムはその勾配 \(\nabla U\)
のみを入力に取る．さらに \(\nabla U(x)\)
の計算コストが高い場合は，\(\nabla U(x)\)
の不偏推定量を代わりに使うだけでも，Poisson 剪定（命題
\ref{prop-thinning}）を通じて正確に \(\pi\) に収束する PDMP
のシミュレーションが可能である (Bierkens et al., 2019)．MCMC
では各イテレーションでデータの一部のみを用いたバッチ実行を，収束先
\(\pi\) を変えずに行うことが難しかったために，PDMC
は特に大規模データを用いたベイズ推論への応用が期待されている．

　PDMCとMCMCの最大の違いはアルゴリズムであるが，これはシミュレートしようとしているマルコフ過程の性質の違いに起因する．
例えば最も広く使われているMCMC法の１つである Metropolis-adjusted
Langevin法 (MALA, Besag, 1994) は， ポテンシャル \(U\)
が定めるLangevin拡散過程
\begin{equation}\phantomsection\label{eq-Langevin}{
dL_t=-\nabla U(L_t)\,dt+\sqrt{2}\,dB_t,
}\end{equation} に基づくが，\((L_t)\)
は正確なシミュレーションが困難であり，Euler-Maruyama法などの離散化が必要になる．
この段階で数値誤差が入り，このままでは大数の法則 (\ref{eq-LLN})
が成り立たなくなる．
これを防ぐためにはMetropolis-Hastings様の棄却法を用いる必要がある．
こうして，最終的にシミュレートされるマルコフ過程は離散時間過程になり，さらに人工的な対称性が導入され，収束が遅くなる．

　PDMPとは式 (\ref{eq-Langevin}) のような拡散過程から，拡散項 \(dB_t\)
を除いた代わりに，ランダムなジャンプ項を加えたものを言う．
このクラスのマルコフ過程は，ジャンプの時刻を棄却法によりシミュレートすることで，離散化誤差を伴わない正確なシミュレーションが可能である．
その結果人工的な対称性が少なく，一般にその分収束を速くすることができる
(Andrieu and Livingstone, 2021)．

　式 (\ref{eq-pi}) で与えられる確率分布 \(\pi\) を平衡分布にもつPDMP
\((X_t,V_t)\) は，次の２ステップの繰り返しでシミュレートできる． まず，
\begin{equation}\phantomsection\label{eq-intensity}{
m(t)=\biggr(v\cdot\nabla U(x_0+tv_0)\biggl),\qquad i=1,2,\cdots
}\end{equation} を強度関数に持つ非一様Poisson点過程の最初の到着時刻
\(T_1\) をシミュレートし，時刻 \(T_1\) まで初期速度 \(v_0\)
で決定論的に運動する． このイベント発生地点を新しい \(x_1:=x_0+T_1v_0\)
とし，新たな速度 \(v_1\) をサンプリングして同じことを繰り返す．
前述のBPS，Zig-Zag Sampler，Forward
PDMCなどの既存手法はいずれもこの枠組みの下で設計されており，新たな速度
\(v_1\) の決め方のみが違う．

　式 (\ref{eq-intensity})
の強度を持つ非一様Poisson点過程のシミュレーションでは，\textbf{Poisson
剪定} (thinning, Lewis and Shedler, 1979)
と呼ばれる棄却法が主流であるが，その実行には \(m\) の上界 \(M\)
を構成する必要がある（命題 \ref{prop-thinning}）．ポテンシャル \(U\)
はモデルの尤度を含み，大変複雑である．従って\(\nabla U\)
が有界になるロジスティックモデルなど，PDMC
の応用先は限られると考えられていた．

\section{\texorpdfstring{自動Poisson剪定と \texttt{PDMPFlux}
パッケージの紹介}{自動Poisson剪定と PDMPFlux パッケージの紹介}}\label{sec-2}

\begin{proposition}[Poisson 剪定]\label{prop-thinning}
  $m\le M$ を関数とする．$M$ を強度にもつ Poisson 点過程の点 $T_1,T_2,\cdots$ のそれぞれについて，確率 $m(T_1)/M(T_1),m(T_2)/M(T_2),\cdots$ のみで採択し，他を取り除いて残る点群は，$m$ を強度にもつ Poisson 点過程に従う．
\end{proposition}

　\([0,t_{\text{max}}]\) 上の点と \([t_{\text{max}},2t_{\text{max}}]\)
上の点とは互いに独立に決まるため，\(t_{\text{max}}>0\)
はアルゴリズムのハイパーパラメータとし，最初の点 \(T_1\)
が採択されるまで幅 \(t_{\text{max}}\)
の区間上での剪定を繰り返せば良い．(Andral and Kamatani, 2024)
にて，一般の関数 \(m\) に対して，その \([0,t_{\text{max}}]\)
上での上界を自動的に求めながら剪定を実行する方法が提案された．その方法とは次の通りである．まずグリッドの数
\(n\) を固定し，\([0,t_{\text{max}}]\) の \(n\) 等分点
\(\{0=t_0<t_1<\cdots<t_n=t_{\text{max}}\}\) を考え，各点 \(t_i\)
上での接線を自動微分 (Baydin et al., 2017)
を用いて計算する．続いてそれらの接線同士の交点を求め，その \(y\)
座標と両端点 \(m(t_i),m(t_{i+1})\) の３点の最大値を，小区間
\([t_i,t_{i+1}]\) 上での \(m\) の上界とする．

　こうして得られた \([0,t_{\text{max}}]\) 上の区分定数関数 \(M\)
は，\(t_{\text{max}}\to0\) または \(n\to\infty\) の極限で \(m\)
の上界を与えるが，\(m\) が \([0,t_{\text{max}}]\)
上で激しく変化する場合，\(m\) の上界になっていない場合がある．そこで
(Andral and Kamatani, 2024) は，Poisson 剪定の最中に評価される比
\(m(t)/M(t)>1\) が１を超えた場合，\(t_{\text{max}}\) の値を縮めて
\([0,t_{\text{max}}]\) 上での剪定をやり直す．Andral は Python パッケージ
\href{https://github.com/charlyandral/pdmp_jax}{\texttt{pdmp\_jax}}
にこのアルゴリズムを実装し，BPS, Zig-Zag Sampler, Forward PDMC
を含む５つのサンプラーを利用可能にした．

　しかし，この方法は \(M(t)<m(t)\) が発生してしまっている点 \(t\)
を検出できずに，\(t<T_1\) を満たす到着時刻 \(T_1\)
を提案してしまった場合に，シミュレートしているPDMPに漸近的に消えないバイアスを導入してしまう．従って
\(U\) の性質に対してグリッド数 \(n\) を小さく，または \(t_{\text{max}}\)
を大きく取りすぎた場合，\(M\)
の誤りを検出できず，使用者が知らないうちに大数の法則 (\ref{eq-LLN})
が成り立たなくなってしまっている可能性がある．

　筆者の開発したパッケージ \texttt{PDMPFlux} (Shiba, 2025)
ではこの問題の解決を図った．\(M(t)<m(t)\) が小区間 \(t\in[t_i,t_{i+1}]\)
で発生するためには，\(m\) が \([t_i,t_{i+1}]\)
上で１つ以上の変曲点を持つ必要があることに注目する．そこでグリッド
\(\{t_i\}_{i=0}^N\) 上で接線だけでなく２階微分係数も計算し，\(m\) が
\([0,t_{\text{max}}]\) 上で高々１つしか変曲点を持たないように
\(t_{\text{max}}\) を調整することを提案した．このことにより，\(U\) の
Lipscthiz
係数に関する一定の仮定の下で，\(t_{\text{max}}\to0,N\to\infty\)
の極限を考えずとも，\(m<M\) の成立を保証できるようになる．

　こうしてパッケージ \texttt{PDMPFlux} はポテンシャル \(U\)
を与えるだけで \(\pi\) からの正確な PDMP
サンプリングを実行することのできるほとんど唯一のパッケージとなった．加えて，第
\ref{sec-3} 節で後述する Sticky Zig-Zag
を加えた６つのアルゴリズムが利用可能である．MCMC
ベースのベイズ推論エンジンである Stan
に替わる，新たなバックエンドとしての利用も可能である．

\section{スパイク付きの非絶対連続分布からのサンプリング}\label{sec-3}

　MCMC では難しく，PDMC で真に新たに可能になったこととして，式
(\ref{eq-spike-and-slab})
で与えられるような，\(\delta\)-部分を持った非絶対連続確率分布 \(p\)
からのサンプリングが挙げられる．この事実は次のようにも理解できる．式
(\ref{eq-spike-and-slab}) で与えられるような
\(\delta_0\)-部分を持った分布 \(p\)
は，\(\delta_0\)-部分を分散が小さい正規分布
\(\operatorname{N}(dx_i;0,\epsilon^2)\) に近似した
\begin{equation}\phantomsection\label{eq-continuous-spike-and-slab}{
p_\epsilon(dx)=\prod_{i=1}^d\biggr(\omega_ip_i(x_i)\,dx_i+(1-\omega_i)\operatorname{N}(dx_i;0,\epsilon^2)\biggl)
}\end{equation} という絶対連続分布の，分散が小さくなる極限
\(\epsilon\to0\) と理解できる．多くの標準的な MCMC は \(p_\epsilon\)
からのサンプリングは可能でも，\(\epsilon\to0\) の極限で誤った分布
\(\otimes_{i=1}^dp_i\ne p\)
に収束するマルコフ過程に収束してしまう（未発表原稿）．さらに
\(\epsilon>0\)
が小さいほど，長時間の相関が強くなり，非現実的なほど長い時間アルゴリズムを実行しない限り，大きなバイアスを持ってしまう．

　一方で標準的な PDMP は \(\epsilon\to0\) の極限でもまた別の PDMP
になり，これは正確に \(p\)
に収束する．この極限過程を直接シミュレーションすることで，\(p\)
からのサンプリングを効率的に実現する手法 Sticky PDMP が (Bierkens et
al., 2023) により提案された．

　Sticky PDMP はベイズ変数選択に大きな応用を持つ．(Mitchell and
Beauchamp, 1988) で提案された spike-and-slab 事前分布はまさに式
(\ref{eq-spike-and-slab}) で与えられる形をしているが，従来の MCMC
では直接の事後分布サンプリングが難しかったため，モデルの空間
\(\{0,1\}^d\) 上で動く Gibbs
サンプラーと組み合わせてサンプリングをしたり (George and McCulloch,
1993)，連続近似 (\ref{eq-continuous-spike-and-slab})
を代わりに用いたりされることが多かった．しかし，連続近似をベイズ変数選択に用いた場合は，説明変数
\(x_i\) がモデルに含まれる事後確率 (PIP: Posterior Inclusion
Probability) を正確に計算するために追加の処理が必要になる (Hahn and
Carvalho, 2015)．

　筆者は Sticky PDMP のダイナミクスを分析すると同時に，Sticky Zig-Zag
アルゴリズムを \texttt{PDMPFlux}
に実装することで，\(\delta\)-部分を持った非絶対連続分布 \(p\)
からのサンプリングが可能であることの，ベイズ変数選択以外への応用も模索している．例えば，特定の密度推定の問題においてミニマックス最適なベイズ事後密度推定量を与える事前分布は離散分布になる
(Gangopadhyay and Mukherjee, 2021)
ように，非絶対連続事前分布を用いることで正確に計算可能なベイズ推定量の幅が広がる可能性がある．

\section{参考文献}\label{ux53c2ux8003ux6587ux732e}

\setlength{\baselineskip}{1pt}

\phantomsection\label{refs}
\begin{CSLReferences}{1}{1}
\bibitem[\citeproctext]{ref-Andral-Kamatani2024}
Andral, C., and Kamatani, K. (2024).
\href{https://arxiv.org/abs/2408.03682}{Automated techniques for
efficient sampling of piecewise-deterministic markov processes}.

\bibitem[\citeproctext]{ref-Andrieu-Livingstone2021}
Andrieu, C., and Livingstone, S. (2021).
\href{https://doi.org/10.1214/20-AOS2008}{{Peskun--Tierney ordering for
Markovian Monte Carlo: Beyond the reversible scenario}}. \emph{The
Annals of Statistics}, \emph{49}(4), 1958--1981.

\bibitem[\citeproctext]{ref-Baydin+2017}
Baydin, A. G., Pearlmutter, B. A., Radul, A. A., and Siskind, J. M.
(2017). \href{http://www.jmlr.org/papers/v18/17-468.html}{Automatic
differentiation in machine learning: A survey}. \emph{J. Mach. Learn.
Res.}, \emph{18}(1), 5595--5637.

\bibitem[\citeproctext]{ref-Bernard+2009}
Bernard, E. P., Krauth, W., and Wilson, D. B. (2009).
\href{https://doi.org/10.1103/PhysRevE.80.056704}{Event-chain monte
carlo algorithms for hard-sphere systems}. \emph{Phys. Rev. E},
\emph{80}, 056704.

\bibitem[\citeproctext]{ref-Besag1994}
Besag, J. E. (1994).
\href{https://www.jstor.org/stable/2346184}{{Comments on
{``Representations of Knowledge in Complex Systems''} by U. Grenander
and M. I. Miller}}. \emph{Journal of the Royal Statistical Society.
Series B (Methodological)}, \emph{56}(4), 591--592.

\bibitem[\citeproctext]{ref-Bierkens+2019}
Bierkens, J., Fearnhead, P., and Roberts, G. (2019).
\href{https://doi.org/10.1214/18-AOS1715}{{The Zig-Zag Process and
Super-Efficient Sampling for Bayesian Analysis of Big Data}}. \emph{The
Annals of Statistics}, \emph{47}(3), 1288--1320.

\bibitem[\citeproctext]{ref-Bierkens+2023}
Bierkens, J., Grazzi, S., Meulen, F. van der, and Schauer, M. (2023).
\href{https://doi.org/10.1007/s11222-022-10180-5}{{Sticky PDMP Samplers
for Sparse and Local Inference Problems}}. \emph{Statistics and
Computing}, \emph{33}(1), 8.

\bibitem[\citeproctext]{ref-Bouchard-Cote+2018-BPS}
Bouchard-Côté, A., Vollmer, S. J., and Doucet, A. (2018).
\href{https://www.tandfonline.com/doi/full/10.1080/01621459.2017.1294075}{The
bouncy particle sampler: A nonreversible rejection-free markov chain
monte carlo method}. \emph{Journal of the American Statistical
Association}, \emph{113}(522), 855--867.

\bibitem[\citeproctext]{ref-Doucet+2001}
Doucet, A., Freitas, N., and Gordon, N. (Eds.). (2001).
\emph{\href{https://doi.org/10.1007/978-1-4757-3437-9}{{Sequential Monte
Carlo Methods in Practice}}}. Springer New York.

\bibitem[\citeproctext]{ref-Faulkner+2018}
Faulkner, M. F., Qin, L., Maggs, A. C., and Krauth, W. (2018).
\href{https://doi.org/10.1063/1.5036638}{All-atom computations with
irreversible markov chains}. \emph{The Journal of Chemical Physics},
\emph{149}(6), 064113.

\bibitem[\citeproctext]{ref-Gangopadhyay-Muhkerjee2021}
Gangopadhyay, U., and Mukherjee, G. (2021).
\href{https://doi.org/10.1214/21-EJS1818}{{On discrete priors and sparse
minimax optimal predictive densities}}. \emph{Electronic Journal of
Statistics}, \emph{15}(1), 1636--1660.

\bibitem[\citeproctext]{ref-Geman-Geman1984}
Geman, S., and Geman, D. (1984).
\href{https://doi.org/10.1109/TPAMI.1984.4767596}{{Stochastic
Relaxation, Gibbs Distributions, and the Bayesian Restoration of
Images}}. \emph{IEEE Transactions on Pattern Analysis and Machine
Intelligence}, \emph{PAMI-6}(6), 721--741.

\bibitem[\citeproctext]{ref-George-McCulloch1993}
George, E. I., and McCulloch, R. E. (1993).
\href{http://www.jstor.org/stable/2290777}{Variable selection via gibbs
sampling}. \emph{Journal of the American Statistical Association},
\emph{88}(423), 881--889.

\bibitem[\citeproctext]{ref-InPractice1996}
Gilks, W. R., Richardson, S., and Spiegelhalter, D. (Eds.). (1996).
\emph{\href{https://doi.org/10.1201/b14835}{{Markov Chain Monte Carlo in
Practice}}}. Chapman \& Hall.

\bibitem[\citeproctext]{ref-Glauber1963}
Glauber, R. J. (1963).
\href{https://doi.org/10.1063/1.1703954}{{Time-Dependent Statistics of
the Ising Model}}. \emph{Journal of Mathematical Physics}, \emph{4}(2),
294--307.

\bibitem[\citeproctext]{ref-Hahn-Carvalho2015}
Hahn, P. R., and Carvalho, C. M. (2015).
\href{https://doi.org/10.1080/01621459.2014.993077}{Decoupling shrinkage
and selection in bayesian linear models: A posterior summary
perspective}. \emph{Journal of the American Statistical Association},
\emph{110}(509), 435--448. doi: 10.1080/01621459.2014.993077.

\bibitem[\citeproctext]{ref-Hastings1970}
Hastings, W. K. (1970).
\href{https://www.jstor.org/stable/2334940}{{Monte Carlo Sampling
Methods Using Markov Chains and Their Applications}}. \emph{Biometrika},
\emph{57}(1), 97--109.

\bibitem[\citeproctext]{ref-Kulik2018}
Kulik, A. (2018).
\emph{\href{https://doi.org/10.1515/9783110458930}{Ergodic behavior of
markov processes: With applications to limit theorems}},Vol. 67. De
Gruyter: Berlin, Boston.

\bibitem[\citeproctext]{ref-Lewis-Shedler1979}
Lewis, P. A. W., and Shedler, G. S. (1979).
\href{https://doi.org/10.1002/nav.3800260304}{Simulation of
nonhomogeneous poisson processes by thinning}. \emph{Naval Research
Logistics Quarterly}, \emph{26}(3), 403--413.

\bibitem[\citeproctext]{ref-Martin+2024}
Martin, G. M., Fraizier, D. T., and Robert, C. P. (2024).
\href{https://projecteuclid.org/journals/statistical-science/volume-39/issue-1/Computing-Bayes-From-Then-Til-Now/10.1214/22-STS876.short}{Computing
bayes: From then `til now}. \emph{Statistical Science}, \emph{Advanced
Publication}, 1--17.

\bibitem[\citeproctext]{ref-Metropolis+1953}
Metropolis, N., Rosenbluth, A. W., Rosenbluth, M. N., Teller, A. H., and
Teller, E. (1953). \href{https://doi.org/10.1063/1.1699114}{Equation of
state calculations by fast computing machines}. \emph{The Journal of
Chemical Physics}, \emph{21}(6), 1087--1092.

\bibitem[\citeproctext]{ref-Michel+2020}
Michel, M., Durmus, A., and Sénécal, S. (2020).
\href{https://doi.org/10.1080/10618600.2020.1750417}{Forward event-chain
monte carlo: Fast sampling by randomness control in irreversible markov
chains}. \emph{Journal of Computational and Graphical Statistics},
\emph{29}(4), 689--702.

\bibitem[\citeproctext]{ref-Mitchell-Beauchamp1988}
Mitchell, T. J., and Beauchamp, J. J. (1988).
\href{http://www.jstor.org/stable/2290129}{Bayesian variable selection
in linear regression}. \emph{Journal of the American Statistical
Association}, \emph{83}(404), 1023--1032.

\bibitem[\citeproctext]{ref-Peters-deWith2012}
Peters, E. A. J. F., and de~With, G. (2012).
\href{https://journals.aps.org/pre/abstract/10.1103/PhysRevE.85.026703}{Rejection-free
monte carlo sampling for general potentials}. \emph{Physical Review E},
\emph{85}(2).

\bibitem[\citeproctext]{ref-PDMPFlux2025}
Shiba, H. (2025).
\href{https://doi.org/10.5281/zenodo.14792019}{PDMPFlux v0.3.3}. Package
Release.

\end{CSLReferences}




\end{document}
