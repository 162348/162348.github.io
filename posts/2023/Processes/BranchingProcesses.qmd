---
title: "分岐過程"
author: "司馬博文"
date: 12/23/2023
categories: [Process]
toc: true
number-sections: true
code-block-bg: true
code-block-border-left: "#31BAE9"
code-overflow: wrap
code-fold: true
bibliography: ../../../mathematics.bib
csl: ../../../apa.csl
crossref:
    sec-prefix: 節
    eq-prefix: 式
    def-prefix: 定義
    def-title: 定義
    thm-prefix: 定理
    thm-title: 定理
---

{{< include ../../../_preamble.qmd >}}

## 離散分岐過程

### 定義

::: {#def-linearly-separable}
## Bienaymé-Galton-Watson 過程 [@Bienayme1845], [@Watson-Galton1875]

$Y_1,Y_2,\cdots$ を $\bZ$-値確率変数の列とし，$\mu\in\cP(\bZ)$ を初期分布とする．これに対して
$$
Z_0\sim\mu,\quad Z_{n+1}:=1_{\Brace{Z_n\ge1}}\sum_{j=T_{n-1}+1}^{T_{n-1}+Z_n}Y_j,
$$
$$
T_{-1}:=0,\quad T_n:=\sum_{j=0}^nZ_j\quad(n\in\N),
$$
と定める．この過程 $\{Z_n\}$ を **分岐過程** といい，分布を $\P_\mu$ と表す．

特に $\{Y_n\}_{n=1}^\infty\subset\L(\Om;\N)$ が非負で独立同分布である場合，過程 $\{Z_n\}_{n=0}^\infty$ を **Bienaymé-Galton-Watson 分岐過程** という．
^[この一般的な定義は [@Quine-Szczotka1994] を参考にした．歴史は [@Kendall1975], [@Heyde-Seneta1977] が詳しい．]
:::

$Z_n\le0$ となった場合は以降も常に $Z_m=0\;(m\ge n)$ が成り立ち，吸収点となる．

それ以外の場合は，第 $n$ 世代（個体数 $Z_n$）がそれぞれ $Y_{T_{n-1}+i}\;(i=1,\cdots,Z_n)$ だけの子孫を残して消滅し，これら子孫が第 $n+1$ 世代 $Z_{n+1}$ を構成する．

$T_n$ は世代 $n$ までを含め，存在し得た全個体数である．

$Z_n,Y_n$ に負の整数値も許す場合は，2つの種族の個体数の差を考える場合などと解釈できる．

### Markov性

BGW 過程 $\{Z_n\}_{n=0}^\infty$ の遷移確率は，直前の状態のみに依存する：

$$
\begin{align*}
    &\P[Z_{n+1}=j|Z_n=i]\\
    &=\P\Square{\sum_{k=1}^iY_k=j}.
\end{align*}
$$

これより $\{Z_n\}_{n=0}^\infty$ は Markov 過程である．

### 生存確率

::: {#thm-survival}
## 生存確率

$\{Z_n\}_{n=0}^\infty$ を BGW 過程で，$\P[Y_1\in 2]<1$ とする．このとき，
^[[@Schinazi14-ClassicalProcesses p.19] 第2章定理1.1．]

1. $\E[Y_1]\le1$ ならば，
$$
\P_1[\forall_{n\in\N}\;Z_n\ge1]=0.
$$

2. $\E[Y_1]>1$ ならば，ある $q\in\cointerval{0,1}$ が存在して
$$
\P_1[\forall_{n\in\N}\;Z_n\ge1]=1-q>0
$$
を満たし，$q$ は $Y_1$ の確率母関数
$$
g(z)=\sum_{k=0}^\infty\P[Y_1=k]z^k
$$
に関する方程式 $g(z)=z$ の $\cointerval{0,1}$ 上でのただ一つの解である．
:::

すなわち，絶滅するかどうかの事象は $Y_1$ の期待値のみに依存するが，その確率 $q$ は $Y_1$ の分布によって定まる．