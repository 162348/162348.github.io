---
title: "分岐過程"
author: "司馬博文"
date: 12/23/2023
categories: [Process]
toc: true
number-sections: true
code-block-bg: true
code-block-border-left: "#31BAE9"
code-overflow: wrap
code-fold: true
bibliography: ../../../mathematics.bib
csl: ../../../apa.csl
abstract-title: 概要
abstract: 分岐過程の定義と歴史，性質についてまとめる．
crossref:
    sec-prefix: 節
    eq-prefix: 式
    def-prefix: 定義
    def-title: 定義
    thm-prefix: 定理
    thm-title: 定理
---

{{< include ../../../_preamble.qmd >}}

## 離散分岐過程

### 定義

::: {#def-BGW .callout-tip}
## Bienaymé-Galton-Watson 過程 [@Bienayme1845], [@Watson-Galton1875]

$Y_1,Y_2,\cdots$ を $\bZ$-値確率変数の列とし，$\mu\in\cP(\bZ)$ を初期分布とする．これに対して
$$
X_0\sim\mu,\quad X_{n+1}:=1_{\Brace{X_n\ge1}}\sum_{j=T_{n-1}+1}^{T_{n-1}+X_n}Y_j,
$$
$$
T_{-1}:=0,\quad T_n:=\sum_{j=0}^nX_j\quad(n\in\N),
$$
と定める．この過程 $\{X_n\}_{n=0}^\infty$ を **分岐過程** といい，分布を $\P_\mu$ と表す．

特に $\{Y_n\}_{n=1}^\infty\subset\L(\Om;\N)$ が非負で独立同分布である場合，過程 $\{X_n\}_{n=0}^\infty$ を **Bienaymé-Galton-Watson 分岐過程** という．
^[この一般的な定義は [@Quine-Szczotka1994] を参考にした．歴史は [@Kendall1975], [@Heyde-Seneta1977] が詳しい．]
:::

$X_n\le0$ となった場合は以降も常に $X_m=0\;(m\ge n)$ が成り立ち，吸収点となる．

それ以外の場合は，第 $n$ 世代（個体数 $X_n$）を構成する個体がそれぞれ $Y_{T_{n-1}+i}\;(i=1,\cdots,X_n)$ 人の家族を遺して消滅し，これら子孫が第 $n+1$ 世代 $X_{n+1}$ を構成する．

$T_n$ は世代 $n$ までを含め，存在し得た全個体数である．

$X_n,Y_n$ に負の整数値も許す場合は，2つの種族の個体数の差を考える場合などと解釈できる．

### 乱歩への埋め込み

初期分布を $\mu=\delta_1$ とすると，$T_0=X_0=1$．すると，任意の $m\in\N^+$ について，事象 $\Brace{X_m\ge1}$ の上では，
$$
T_{n}=1+\sum_{j=1}^{T_{n-1}}Y_j\quad(0\le n\le m+1)
$$ {#eq-Tn}
$$
\begin{align*}
    X_{n}&=T_{n}-T_{n-1}\\
    &=1+\sum_{j=1}^{T_{n-1}}Y_j-T_{n-1}\\
    &=1+\sum_{j=1}^{T_{n-1}}\wt{Y}_j\quad(0\le n\le m+1)
\end{align*}
$$ {#eq-Xn}
$$
\wt{Y}_j:=Y_j-1\quad(j\in\N^+)
$$
が成り立つ．

よって，絶滅しないという事象
$$
\bigcap_{m\in\N^+}\Brace{X_m\ge1}=\Brace{\lim_{n\to\infty}T_n=\infty}
$$
の上では，$X_0=1$ から始まる乱歩 (random walk)
$$
X_n=1+\wt{S}_{T_{n-1}}\quad(n\in\N)
$$
$$
\wt{S}_n:=\sum_{j=1}^n\wt{Y}_j\quad(n\in\N)
$$
と理解できる．

### Markov性

::: {#prop-Markov-property .callout-tip}
## Markov性
$\{X_n\}_{n=0}^\infty\subset\L(\Om;\bZ)$ を，初期分布 $\mu=\delta_1$ と $\{Y_n\}_{n=1}^\infty\subset\L(\Om;\bZ)$ が定める分岐過程，$\F_n:=\sigma(X_k|k\in n+1)$ を自然な filtration とする．^[[@Quine-Szczotka1994 p.1208] 命題1．]

1. 任意の $n\in\N^+$ について $\E_{\delta_1}[Y_{n+1}|Y_1,\cdots,Y_n]=a$ ならば，
$$
\E_{\delta_1}[X_{n+1}|\F_n]=aX_n^+,\quad n\in\N.
$$
:::

::: {.callout-note icon="false" title="証明"}
1. 任意の $\{r_k\}_{k=0}^n\subset\bZ$ について，等式
$$
\E_{\delta_1}[X_{n+1}|X_1=r_1,\cdots,X_n=r_n]=ar_n^+
$$
を示せば良い．$r_n\le0$ の場合は直ちに従うから，$r_n\ge1$ として考える．この下では変形 @eq-Tn を用いることが出来るから，
$$
\begin{align*}
    &\Brace{\forall_{j\in[n]}\;X_j=r_j}\\
    &=\Brace{\forall_{j\in[n-1]}\;T_j=i_j,X_n=r_n}\\
    &=\Brace{\forall_{j\in[n-1]}\;\sum_{k=1}^{i_{j-1}}Y_k=i_j-1,\sum_{j=i_{n-2}+1}^{i_{n-1}}Y_j=r_n}\\
    &=:B_n
\end{align*}
$$
$$
i_j:=1+r_1+\cdots+r_j,\quad j\in[n-1],
$$
が成り立つから，
:::

BGW 過程 $\{Z_n\}_{n=0}^\infty$ の遷移確率は，直前の状態のみに依存する：

$$
\begin{align*}
    &\P[Z_{n+1}=j|Z_n=i]\\
    &=\P\Square{\sum_{k=1}^iY_k=j}.
\end{align*}
$$

これより $\{Z_n\}_{n=0}^\infty$ は Markov 過程である．

### 生存確率

::: {#thm-survival .callout-tip}
## 生存確率

$\{Z_n\}_{n=0}^\infty$ を BGW 過程で，$\P[Y_1\in 2]<1$ とする．このとき，$\mu:=\E[Y_1]\in[0,\infty]$ について，
^[[@Schinazi14-ClassicalProcesses p.19] 第2章定理1.1，[@Bhattacharya-Waymire2021 p.114] 定理9.1 など．]

1. $\mu\le1$ ならば，
$$
\P_1[\forall_{n\in\N}\;Z_n\ge1]=0.
$$

2. $\mu>1$ ならば，ある $q\in\cointerval{0,1}$ が存在して
$$
\P_1[\forall_{n\in\N}\;Z_n\ge1]=1-q>0
$$
を満たし，$q\in\cointerval{0,1}$ は $Y_1$ の確率母関数
$$
g(z):=\sum_{k=0}^\infty\P[Y_1=k]z^k
$$
に関する方程式 $g(z)=z$ の $\cointerval{0,1}$ 上でのただ一つの解である．
:::

すなわち，「未来永劫絶滅しない」確率が正であるかどうかは $Y_1$ の期待値 $\mu$ のみに依存するが，その確率 $1-q$ は $Y_1$ の分布によって定まる．
^[この $\mu$ を **基本再生産数** と呼ぶこともある [Wikipedia](https://en.wikipedia.org/wiki/Branching_process)．]

::: {.callout-note icon="false" title="証明"}

:::