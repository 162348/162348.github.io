---
title: "相関粒子系の社会実装"
author: "Hirofumi Shiba"
date: "11/6/2023"
date-modified: "12/19/2023"
categories: [Particles, Survey]
abstract: 相関粒子系がどのように社会で活躍出来るか？という問いに対する1つの案として，「ビジネスモデルのモデル」が提示される．ここでは「状態空間モデル」の構造を人間社会に見つけることが肝要になる．
abstract-title: 概要
toc: true
number-sections: true
bibliography: ../../../mathematics.bib
csl: ../../../apa.csl
crossref:
    sec-prefix: 節
    eq-prefix: 式
---

## 粒子「ビジネスモデル」モデルの基幹技術

### 「状態空間モデル」とその逐次推論 {#sec-SSM}

要は僕の専門分野である訳だが，これが今回のビジネスモデルの「骨格」の部分になる．

{{< include ../../../_preamble.qmd >}}

::: {.callout-tip icon="false" title="定義 (State Space Model)"}

[**状態空間モデル**](https://ja.wikipedia.org/wiki/%E7%8A%B6%E6%85%8B%E7%A9%BA%E9%96%93_(%E5%88%B6%E5%BE%A1%E7%90%86%E8%AB%96))^[ここでの定義は [@Chopin-Papaspiliopoulos20-SMC p.42] に倣った．隠れMarkovモデルともいうが，こう言ったときは状態空間が有限集合であるという制約が暗につく．]とは，**状態変数** $\{X_t\}_{t=0}^T$ と，**観測変数** $\{Y_t\}_{t=1}^T$ の組からなる確率過程
$$
\{(X_t,Y_t)\}\subset\L(\Om;\cX\times\cY)
$$
であって，初期状態 $X_0$ の分布と，$X_t,Y_t$ の間の関係として次の2つの条件付き分布

1. **システムモデル**
$$
X_{t+1}|X_t\quad(t\in T)
$$
2. **観測モデル**
$$
Y_t|X_t\quad(t\in[T])
$$

を想定したものをいう．^[他の依存関係は仮定しないので，その図示は [DAG](https://ja.wikipedia.org/wiki/%E6%9C%89%E5%90%91%E9%9D%9E%E5%B7%A1%E5%9B%9E%E3%82%B0%E3%83%A9%E3%83%95) となっている．状態空間モデル（＝隠れ Markov モデル）は [Bayesian Network](https://ja.wikipedia.org/wiki/%E3%83%99%E3%82%A4%E3%82%B8%E3%82%A2%E3%83%B3%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF) の例である．記法 $T,[T]$ については [本サイトの数学記法一覧](../../Surveys/Notations.qmd#sec-numbers) を参照．]

![状態空間モデルの図示](SSM.png)

:::

ただし，$X_t$ は観測不能で，$Y_t$ のみを観測するものとする．従って，目標は $Y_1,\cdots,Y_T$ の値から $X_1,\cdots,X_T$ の値を推定することである．

各時点 $t\in[T]$ において，現在までの観測 $Y_1,\cdots,Y_t$ から現在の状態 $X_t$ を推定することを考える（[フィルタリング問題](../Surveys/ParticleFilter.qmd)^[一方で $Y_t$ から，未来の値 $Y_{t+1}$ を予測する問題を「予測問題」，$Y_{1},\cdots,Y_t$から，過去の状態変数の値 $X_{s}\;(s<t)$ を推定する問題を「平滑化問題」という．]）．特に Bayes の枠組みでは，条件付き分布
$$
\L[X_t|Y_1,\cdots,Y_t]\quad(t\in [T])
$$
を（逐次的に）決定することを目指す．^[記法 $\L$ については [本サイトの数学記法一覧](../../Surveys/Notations.qmd#sec-probability-space) を参照．ベイズ手法については [ベイズ計算とは何か](../Surveys/BayesianComp.qmd) を参照．]

::: {.callout-caution icon="false" title="状態空間モデルに関する注意" collapse="true"}
厳密には，初期状態 $X_0$ の分布のモデル $\{\bP_0^\theta\}$．Markov過程 $\{X_t\}$ の遷移核のモデル $\{P_t^\theta\}$，観測のモデル $\{F_t^\theta\}$ の3-組 $(\bP_0^\theta,P_t^\theta,F_t^\theta)$ を **状態空間モデル** という．また，過程 $\{(X_t,Y_t)\}$ もMarkov過程になることが示せる．このため，状態空間モデルのことを **部分的に観測されるMarkov過程** とも表現する．
:::

この状態空間モデルのフィルタリング問題を解くためのアルゴリズムは多く知られているが，そのうち，モデル $X_{t+1}|X_t,Y_t|X_t$ が複雑で尤度が明示的な表示を持たない場合でも通用する手法は**粒子フィルターのみ**である．^[$Y_t|X_t,X_{t+1}|X_t$ のいずれも線型Gaussなモデルを仮定した場合は，Kalman filter （とその変種）というもっと効率の良い安価なアルゴリズムが使える．]

粒子フィルターは，$X_t$ の観測 $Y_t$ に関する事後分布を $N$ 個（大量）の粒子によって近似する Bayes 推定手法で，各 $Y_t$ の尤度の情報を重点リサンプリングによって取り入れながらも，計算コストを抑えながら $X_t$ の事後分布を逐次近似していく．[粒子フィルターとは何か？](../Surveys/ParticleFilter.qmd) も参照．

### 状態空間モデルがビジネスになるか？

要は，$Y_t$ を安価に集めて，$X_t$ を高値で売ることを考える．本当にこれがビジネスになるためには，２つの条件

* $X_t$ は多くの人がリアルタイムに知りたいが，（少なくともリアルタイムには）知れない
* $Y_t$ をたくさん集めれば $X_t$ を推測できるが，簡単には推測するのに十分な次元の $Y_t$ を用意できない

を満たす必要がある．が，意外とこのようなものは多いかも知れない．

一方で我々の売りは

::: {.callout-tip title="今回のビジネスモデルのコア"}
どんなに推定しにくい $X_t$ でも（モデルが複雑で尤度が解析的な表示を持たなくても），十分な情報を含む観測データ $Y_t$ が得られれば，逐次推定できる．
:::

ということになる．

時系列データのオンライン推論は，需要が高い一方で実装が難しい．ここの乖離が好機になる可能性がある．

## どんな $X_t$ が売れるか？

### マクロ指標のナウキャスト

最も示唆的と思われる例は，$X_t$ としてGDP，商業販売額などのマクロ指標を取った場合だと思われる．

マクロ指標は，各企業単体では推測できず，たとえ業界を絞っても各企業の売り上げデータやATM取引データなど，多くのデータを集めて高次元な $Y_t$ を構成しなければ，信頼できる $X_t$ の推定はできないだろう．高次元な $Y_t$ から $X_t$ をフィルタリング際の粒子法は安定せず，現在でも解決されていないオープンクエスチョンである．必然的にブルーオーシャンで誰も参入できない．

さらに，マクロ指標はフィルタリングすること＝今現在の値を知ることに意味がある．理論的な障壁や技術的な障壁は高いが，経営判断に使ったり，投資判断に使ったり，需要は大きいと思われる．

$Y_t$ はデータとして広く流通しているわけではないならば（ATM利用データなど），技術力だけでなく，「信頼を得てデータを提供してもらっている」ことが競争力に加わっていき得る．

### 天気予報

$Y_t$ が天気（降水量）というのがよくある．$X_t$ が高次元になり，データ同化の問題になる．

この天気予報とデリバティブとの関係は？

### 属人化医療 {#sec-personalized-medicine}

個人的には，$X_t$ は個人の体調スコア（あるいは特定の病気のリスク）で，$Y_t$ がApple Watchなどのスマートデバイスからの心拍や体温や移動距離などの測定データ，という属人化医療の場面設定をよく考える．

## サーベイ

まとめると，我々が提供できるものは高次元・大規模状態空間モデルの逐次推定手法の研究開発力．足りないものは研究成果と実装する時間と仲間と交渉力である．その代わり初期投資は極めて少なくて済む．

まずは，前節での「$Y_t$ を集めて $X_t$ を売る」ビジネスモデルの実現に向けて，既存の成功事例を調べる．

### 生態学

生態学のモデリングにも状態空間モデルはよく使われる [@Auger-Methe+2021]．特に非線型性が強く，粒子フィルターが有効になる [@Chopin-Papaspiliopoulos20-SMC p.19]．

### ナウキャスト

元々は星野研究室の次の研究を知って，新里さんに紹介したときに得た着想であった．

```{=html}
<a class="embedly-card" href="https://hoshinoseminar.com/pdf/2022_Seven_slide.pdf">Card</a><script async src="//cdn.embedly.com/widgets/platform.js" charset="UTF-8"></script>
```

「ナウキャスト」「オルタナティブデータを活用した経済分析」と言った言葉でビジネス界で議論されているようだ．特に「ナウキャスト」という名前の会社はこの分野を開拓している．

```{=html}
<a class="embedly-card" href="https://prtimes.jp/main/html/rd/p/000000327.000012138.html">ナウキャストとエム・データ、機関投資家向けオルタナティブデータ活用で協業</a><script async src="//cdn.embedly.com/widgets/platform.js" charset="UTF-8"></script>
```

```{=html}
<a class="embedly-card" href="https://www.jstage.jst.go.jp/article/jkg/72/10/72_390/_article/-char/ja/">オルタナティブデータを用いた経済活動分析</a><script async src="//cdn.embedly.com/widgets/platform.js" charset="UTF-8"></script>
```