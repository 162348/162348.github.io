<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Hirofumi Shiba">
<meta name="dcterms.date" content="2023-12-06">

<title>Ano2math5 - ベイズ計算とは何か | About Bayesian Computation（執筆中）</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../profile.jpg" rel="icon" type="image/jpeg">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-36GX2G6GLL"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-36GX2G6GLL', { 'anonymize_ip': true});
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Ano2math5 - ベイズ計算とは何か | About Bayesian Computation（執筆中）">
<meta property="og:description" content="A Blog by a Bayesian Computation Researcher">
<meta property="og:image" content="https://github.com/162348/posts/2023-12-6/BayesainComp_files/figure-html/cell-2-output-1.png">
<meta property="og:site-name" content="Ano2math5">
<meta property="og:image:height" content="751">
<meta property="og:image:width" content="1028">
<meta name="twitter:title" content="Ano2math5 - ベイズ計算とは何か | About Bayesian Computation（執筆中）">
<meta name="twitter:image" content="https://github.com/162348/posts/2023-12-6/BayesainComp_files/figure-html/cell-2-output-1.png">
<meta name="twitter:image-height" content="751">
<meta name="twitter:image-width" content="1028">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Ano2math5</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../static/Lectures.html" rel="" target="">
 <span class="menu-text">Sessions</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">ベイズ計算とは何か | About Bayesian Computation（執筆中）</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Survey</div>
                <div class="quarto-category">Computation</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Hirofumi Shiba </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 6, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#ベイズ計算のベイズとは何者か" id="toc-ベイズ計算のベイズとは何者か" class="nav-link active" data-scroll-target="#ベイズ計算のベイズとは何者か"><span class="header-section-number">1</span> 「ベイズ計算」の「ベイズ」とは何者か？</a>
  <ul class="collapse">
  <li><a href="#ベイズのアイデア" id="toc-ベイズのアイデア" class="nav-link" data-scroll-target="#ベイズのアイデア"><span class="header-section-number">1.1</span> ベイズのアイデア</a></li>
  <li><a href="#ベイズ統計学の基本問題" id="toc-ベイズ統計学の基本問題" class="nav-link" data-scroll-target="#ベイズ統計学の基本問題"><span class="header-section-number">1.2</span> ベイズ統計学の基本問題</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="ベイズ計算のベイズとは何者か" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> 「ベイズ計算」の「ベイズ」とは何者か？</h1>
<section id="ベイズのアイデア" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="ベイズのアイデア"><span class="header-section-number">1.1</span> ベイズのアイデア</h2>
<p><a href="https://ja.wikipedia.org/wiki/%E3%83%88%E3%83%BC%E3%83%9E%E3%82%B9%E3%83%BB%E3%83%99%E3%82%A4%E3%82%BA">Thomas Bayes</a> 1701-1761 は英国の牧師である．</p>
<p>当時は統計的推定の問題が肝要であった．その中でも，次のような「区間推定」の問題を考えていた．</p>
<div class="hidden">
$$
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
%%% 偏微分方程式
<p>%%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="問題">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
問題
</div>
</div>
<div class="callout-body-container callout-body">
<p>2値のデータ <span class="math inline">\(Y_i\in\{0,1\}\)</span> は，ある未知の「成功率」 <span class="math inline">\(\theta\in(0,1)\)</span> に従って，確率 <span class="math inline">\(\theta\)</span> で <span class="math inline">\(Y_i=1\)</span>，確率 <span class="math inline">\(1-\theta\)</span> で <span class="math inline">\(Y_i=0\)</span> となるとする．<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> 仮に，<span class="math inline">\(Y_i\)</span> は性別で，<span class="math inline">\(\theta\)</span> は男児が生まれる確率だと捉えることとしよう．<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> このようなデータが独立に観測されて，<span class="math inline">\(Y_1,\cdots,Y_n\)</span> と得られているとする．真の成功率 <span class="math inline">\(\theta\)</span> が区間 <span class="math inline">\((a,b)\subset(0,1)\)</span> に入っているという確率をどう見積もれば良いか？</p>
</div>
</div>
<p>彼の発想は極めてシンプルである．</p>
<ol type="1">
<li>まず<strong>事前分布</strong> <span class="math inline">\(p(\theta)\)</span> と呼ばれる，最初の <span class="math inline">\(\theta\)</span> に対する予想を自由に表現する．</li>
<li>これをデータを用いて修正して，<strong>事後分布</strong> <span class="math inline">\(p(\theta|Y_1,\cdots,Y_n)\)</span> を得る．これは「データ <span class="math inline">\(Y_1,\cdots,Y_n\)</span> が得られた，という条件の下で考えた条件付き分布」である．</li>
<li>この事後分布の形から区間推定を実行する．</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="[@Bayes1763] のアイデア">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="citation" data-cites="Bayes1763">(<a href="#ref-Bayes1763" role="doc-biblioref">Bayes, 1763</a>)</span> のアイデア
</div>
</div>
<div class="callout-body-container callout-body">
<p>事前分布として最初の予想をすると言っても，<span class="math inline">\(\theta\in(0,1)\)</span> は全く予想がつかないとして，ここでは「どんな <span class="math inline">\(\theta\)</span> もあり得る」という意味で，<span class="math inline">\(p(\theta)\)</span> を一様分布に設定しよう：</p>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the range for x-axis</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Uniform distribution density function is constant</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.ones_like(x)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the graph</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>)) <span class="co"># Size suitable for a smartphone screen</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y, label<span class="op">=</span><span class="st">'Uniform Distribution (0,1)'</span>, color<span class="op">=</span>(<span class="fl">0.35</span>, <span class="fl">0.71</span>, <span class="fl">0.73</span>, <span class="dv">1</span>))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, y, color<span class="op">=</span>(<span class="fl">0.35</span>, <span class="fl">0.71</span>, <span class="fl">0.73</span>, <span class="fl">0.3</span>))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'x'</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="fl">1.5</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Density'</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Density Function of Uniform Distribution on (0,1)'</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="BayesainComp_files/figure-html/cell-2-output-1.png" width="514" height="376"></p>
</div>
</div>
<p>このように，一様分布とは「どのような <span class="math inline">\(\theta\)</span> の値も同様に確からしい」という予想の表現である．しかし，データ <span class="math inline">\(Y_1,\cdots,Y_n\)</span> が得られている今，どんな <span class="math inline">\(\theta\)</span> も等しく尤もらしいという訳ではない．そこで，「データ <span class="math inline">\(Y_1,\cdots,Y_n\)</span> に関する条件付き分布」を計算することとする．実は，簡単な確率の法則から，次の公式を得ることができる：<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> <span id="eq-Bayes-formula"><span class="math display">\[
p(\theta|Y_1,\cdots,Y_n)=\frac{p(Y_1,\cdots,Y_n|\theta)p(\theta)}{\int_\Theta p(Y_1,\cdots,Y_n|\theta)p(\theta)\,d\theta}
\tag{1}\]</span></span></p>
<p>これを用いて，条件付き分布 <span class="math inline">\(p(\theta|Y_1,\cdots,Y_n)\)</span> を計算する．例えば<a href="https://www.e-stat.go.jp/dbview?sid=0003411595">日本の2021年の出生児性別のデータ</a>を用いると次のようになる．</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> beta</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># パラメータの設定</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">811622</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>male <span class="op">=</span> <span class="dv">415903</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>female <span class="op">=</span> n <span class="op">-</span> male</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ベータ分布のPDFを計算</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> beta.pdf(x, <span class="dv">1</span><span class="op">+</span>male, <span class="dv">1</span><span class="op">+</span>female)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># プロット</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y, label<span class="op">=</span><span class="ss">f'Beta(</span><span class="sc">{</span><span class="dv">1</span><span class="op">+</span>male<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span><span class="dv">1</span><span class="op">+</span>female<span class="sc">}</span><span class="ss">)'</span>, color<span class="op">=</span>(<span class="fl">0.35</span>, <span class="fl">0.71</span>, <span class="fl">0.73</span>, <span class="dv">1</span>))</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, y, color<span class="op">=</span>(<span class="fl">0.35</span>, <span class="fl">0.71</span>, <span class="fl">0.73</span>, <span class="fl">0.3</span>))</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'p'</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="fl">0.4</span>, <span class="fl">0.6</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Probability Density'</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Bayesian Posterior Distribution'</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="BayesainComp_files/figure-html/cell-3-output-1.png" width="538" height="376"></p>
</div>
</div>
<p>こうして極めて鋭い事後分布が出来た．では区間推定の例として，<span class="math inline">\((a,b)=(0.5,1.0)\)</span> として，「男児の方が女児よりも多い確率」を推定しよう．これは次を計算することになる： <span class="math display">\[
\mathrm{P}\left[\frac{1}{2}&lt;\theta&lt;1\right]=\int^1_{\frac{1}{2}}p(Y_1,\cdots,Y_n|\theta)\,d\theta.
\]</span></p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">sum</span>(y[<span class="dv">500</span>:<span class="dv">600</span>])<span class="op">/</span><span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1.003097768300707</code></pre>
</div>
</div>
<p>もはや丸め誤差により <span class="math inline">\(1\)</span> を越してしまっている．ほとんど確実に「男児の方が生まれる確率が高い」と結論づけて良いだろう．</p>
</div>
</div>
<p>この <span class="citation" data-cites="Bayes1763">(<a href="#ref-Bayes1763" role="doc-biblioref">Bayes, 1763</a>)</span> が実行したように，<strong>事後確率 <span class="math inline">\(p(\theta|Y_1,\cdots,Y_n)\)</span> をみて <span class="math inline">\(\theta\)</span> に関する推論をする</strong>，という立場からの統計的営み全体を，<strong>ベイズ統計学</strong>という．</p>
</section>
<section id="ベイズ統計学の基本問題" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="ベイズ統計学の基本問題"><span class="header-section-number">1.2</span> ベイズ統計学の基本問題</h2>
<p>事後確率を導く際に用いた公式 <a href="#eq-Bayes-formula">Equation&nbsp;1</a> は<strong>Bayesの公式</strong>と呼ばれており，従ってベイズ統計学の最も肝要なパーツである．今回の場合では，Pythonコードをご覧になった方はわかったかもしれないが， <span class="math display">\[
p(\theta|Y_1,\cdots,Y_n)\,\propto\,\int^1_0\theta^m(1-\theta)^{n-m}
\]</span> となっており，これは<a href="../../posts/2023-11-24/Beta-Gamma.html">Beta分布</a>と呼ばれるものである．<strong>こんな簡単な設定でも，この積分が殆ど計算できないことはBayes自身もよくわかっていた</strong>．</p>
<p>さらに悪いことに，現代のBayes統計学の多くの統計量は，ある関数 <span class="math inline">\(g:\Theta\to\mathbb{R}\)</span> を用いて <span class="math display">\[
\mathrm{E}[g(\theta)|Y_1,\cdots,Y_n]=\int_{\Theta}g(\theta)p(\theta|Y_1,\cdots,Y_n)\,d\theta
\]</span> と表される．ここでも積分が登場するのである．先ほどのBayesの区間推定の例では <span class="math inline">\(g=1_{(a,b)}\)</span> と取った場合に当たる．<span class="math inline">\(g(\theta)=\theta^p\)</span> と取った場合，事後積率という統計量になる．等に <span class="math inline">\(p=1\)</span> の場合が事後平均である．</p>
<p>そこでBayesは，<span class="math inline">\(g=1_{(a,b)}\)</span> と取った場合の積分 <span class="math inline">\(\mathrm{E}[g(\theta)|Y_1,\dots,Y_n]\)</span> の値を，男児の数 <span class="math display">\[m:=\#\left\{i\in[n]\mid Y_i=1\right\}\]</span> が非常に多いか，非常に少ない場合については，被積分関数を二項展開して項別積分により計算することを提案した．しかしこの手法は明らかに今回の例では使えず（我々は男女の出生率にそこまで偏りがないことを経験的に知っている），真に興味のある場合を包含していない．この場合について，Bayesは <span class="math inline">\(\mathrm{E}[g(\theta)|Y_1,\dots,Y_n]\)</span> の値を上下から評価するにとどまった．</p>
<p>そのこともあってか，文献 <span class="citation" data-cites="Bayes1763">(<a href="#ref-Bayes1763" role="doc-biblioref">Bayes, 1763</a>)</span> は実はBayesの死後にRichard Priceによって投稿されたものであり，生前に自ら投稿・発表した訳ではなかった．<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> 当然，発表当時は全く注目を受けなかった．</p>
<p>まとめると，Bayesのアプローチは非常に自然で，特に確率分布を簡単にプロットできる現代では不確実性が明確に図示できるという美点がある．しかしながら，その肝心の「事後分布の公式（Bayesの公式）」がほとんどの場合で計算不可能なのである！そこでBayesは計算法の開発を余儀なくされた．このように，<strong>Bayes統計学は当初からBayes計算の問題を懐胎していた</strong>のである．</p>
<p>実際，Bayes統計学はそのポテンシャルが評価されているだけであった期間が長く，真に日の目を見たと言えるのはここ30年のことである．</p>
<blockquote class="blockquote">
<p>In fact, until Bayesians discovered MCMC, the only computational methodology that seemed to offer much chance of making practical Bayesian statistics practical was the portfolio of quadrature methods developed under Adrian Smith’s leadership at Nottingham (Naylor and Smith 1982; Smith et al.&nbsp;1985, 1987). <span class="citation" data-cites="Green+2015">(<a href="#ref-Green+2015" role="doc-biblioref">Green et al., 2015, p. 836</a>)</span></p>
</blockquote>



</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list">
<div id="ref-Bayes1763" class="csl-entry" role="listitem">
Bayes, T. (1763). An essay towards solving a problem in the doctrine of chances. By the late rev. Mr. Bayes, f. R. S. Communicated by mr. Price, in a letter to john canton, a. M. F. R. s. <em>Philosophical Transactions</em>, <em>53</em>(1763), 370–418. <a href="https://www.jstor.org/stable/105741">https://www.jstor.org/stable/105741</a>
</div>
<div id="ref-Green+2015" class="csl-entry" role="listitem">
Green, P. J., Łatuszyński, K., Pereyra, M., &amp; Robert, C. P. (2015). Bayesian computation: A summary of the current state, and samples backwards and forwards. <em>Statistics and Computing</em>, <em>25</em>(4), 835–862. <a href="https://link.springer.com/article/10.1007/s11222-015-9574-5">https://link.springer.com/article/10.1007/s11222-015-9574-5</a>
</div>
<div id="ref-Martin+2023-history" class="csl-entry" role="listitem">
Martin, G. M., Fraizier, D. T., &amp; Robert, C. P. (2023). Computing bayes: From then ‘til now. <em>Statistical Science</em>, <em>Advanced Publication</em>, 1–17.
</div>
<div id="ref-Stigler1990" class="csl-entry" role="listitem">
Stigler, S. M. (1990). <em>The history of statistics: The measurement of uncertainty before 1990</em>. Harvard University Press.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>これはBernoulli分布 <span class="math inline">\(Y_i|\theta\overset{\mathrm{i.i.d.}}{\sim}\mathrm{Ber}(\theta)\)</span> を仮定するということである．<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Bayes自身は「テーブル上にボールを転がしていく」という表現をしたという <span class="citation" data-cites="Martin+2023-history">(<a href="#ref-Martin+2023-history" role="doc-biblioref">Martin et al., 2023</a>)</span>．<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>各 <span class="math inline">\(\theta\)</span> の下で目の前のデータ <span class="math inline">\(Y_1,\cdots,Y_n\)</span> が生成される確率 <span class="math inline">\(p(Y_1,\cdots,Y_n|\theta)\)</span> が低いということは，「その <span class="math inline">\(\theta\)</span> から生成されたデータである確率は低い」という逆の発想ができる．そこで <span class="math inline">\(p(Y_1,\cdots,Y_n|\theta)\)</span> という条件付き確率を<strong>尤度</strong>ともいう．<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>なお，<span class="citation" data-cites="Stigler1990">(<a href="#ref-Stigler1990" role="doc-biblioref">Stigler, 1990</a>)</span> によると実際の出版年は1764年であったという．<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>