<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="司馬博文">

<title>ベイズデータ解析１ – Hirofumi Shiba</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../assets/profile.jpg" rel="icon" type="image/jpeg">
<script src="../../../site_libs/quarto-listing/list.min.js"></script>
<script src="../../../site_libs/quarto-listing/quarto-listing.js"></script>
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-cf7929f4d66a2bdccc4ecf0c4d40c672.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-6440ae36dcaea21c2c7d45a955744ce0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "?",
    "H"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>

  window.document.addEventListener("DOMContentLoaded", function (_event) {
    const listingTargetEl = window.document.querySelector('#listing-lst-survey .list');
    if (!listingTargetEl) {
      // No listing discovered, do not attach.
      return; 
    }

    const options = {
      valueNames: ['listing-title','listing-image','listing-date','listing-subtitle',{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
      
      searchColumns: ["listing-title","listing-author","listing-date","listing-image","listing-description"],
    };

    window['quarto-listings'] = window['quarto-listings'] || {};
    window['quarto-listings']['listing-lst-survey'] = new List('listing-lst-survey', options);

    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  });

  window.addEventListener('hashchange',() => {
    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  })
  </script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-36GX2G6GLL"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-36GX2G6GLL', { 'anonymize_ip': true});
</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Zen+Kurenaido&amp;display=swap" rel="stylesheet">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=BIZ+UDPGothic&amp;display=swap" rel="stylesheet">

<style>
  .navbar-title, .menu-text {
      font-family: "Zen Kurenaido", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
  h1, .title, .description, .subtitle {
    font-family: "Zen Kurenaido", sans-serif !important;
  }
</style>

<!-- <style>
  .menu-text {
      font-family: "Gill Sans", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
  .navbar-title {
      font-family: "Gill Sans", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
</style> -->

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../assets/styles.css">
<meta property="og:title" content="ベイズデータ解析１ – Hirofumi Shiba">
<meta property="og:description" content="心理学などの人間を対象にする研究では変数の数が多く，正しいモデルを見つけるために分散分析 (ANOVA) が広く用いられる． しかし古典的な ANOVA 解析手法である F-検定や t-検定は，データの一側面しか伝えない． これらの問題点を解決策としてベイズの方法を導入し，ベイズ ANOVA，ベイズ推論とモデル比較が ANOVA の発展として得られることをみる． この拡張は，ANOVA の線型モデルとしての解釈を通じてなされ，ANOVA の「同じ係数を共有するクタスタ構造の特定手法」というより広い理解へ導かれる．">
<meta property="og:image" content="https://162348.github.io/posts/2024/Survey/Files/BayesANOVA.png">
<meta property="og:site_name" content="Hirofumi Shiba">
<meta property="og:image:height" content="435">
<meta property="og:image:width" content="452">
<meta name="twitter:title" content="ベイズデータ解析１ – Hirofumi Shiba">
<meta name="twitter:description" content="心理学などの人間を対象にする研究では変数の数が多く，正しいモデルを見つけるために分散分析 (ANOVA) が広く用いられる． しかし古典的な ANOVA 解析手法である F-検定や t-検定は，データの一側面しか伝えない． これらの問題点を解決策としてベイズの方法を導入し，ベイズ ANOVA，ベイズ推論とモデル比較が ANOVA の発展として得られることをみる． この拡張は，ANOVA の線型モデルとしての解釈を通じてなされ，ANOVA の「同じ係数を共有するクタスタ構造の特定手法」というより広い理解へ導かれる．">
<meta name="twitter:image" content="https://162348.github.io/posts/2024/Survey/Files/BayesANOVA.png">
<meta name="twitter:creator" content="@ano2math5">
<meta name="twitter:image-height" content="435">
<meta name="twitter:image-width" content="452">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Hirofumi Shiba</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../static/English.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Sessions.html"> 
<span class="menu-text">Sessions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../blog.html"> 
<span class="menu-text">ブログ</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Japanese.html"> 
<span class="menu-text">自己紹介</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/162348/162348.github.io/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">ベイズデータ解析１</h1>
            <p class="subtitle lead">分散分析</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Bayesian</div>
                <div class="quarto-category">Statistics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>司馬博文 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">9/23/2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">12/08/2024</p>
      </div>
    </div>
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="block-title">概要</div>
      <p>心理学などの人間を対象にする研究では変数の数が多く，正しいモデルを見つけるために分散分析 (ANOVA) が広く用いられる． しかし古典的な ANOVA 解析手法である F-検定や t-検定は，データの一側面しか伝えない． これらの問題点を解決策としてベイズの方法を導入し，ベイズ ANOVA，ベイズ推論とモデル比較が ANOVA の発展として得られることをみる． この拡張は，ANOVA の線型モデルとしての解釈を通じてなされ，ANOVA の「同じ係数を共有するクタスタ構造の特定手法」というより広い理解へ導かれる．</p>
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目次</h2>
   
  <ul>
  <li><a href="#分散分析" id="toc-分散分析" class="nav-link active" data-scroll-target="#分散分析"><span class="header-section-number">1</span> 分散分析</a>
  <ul class="collapse">
  <li><a href="#はじめに" id="toc-はじめに" class="nav-link" data-scroll-target="#はじめに"><span class="header-section-number">1.1</span> はじめに</a></li>
  <li><a href="#分散分析の抽象的な説明" id="toc-分散分析の抽象的な説明" class="nav-link" data-scroll-target="#分散分析の抽象的な説明"><span class="header-section-number">1.2</span> 分散分析の抽象的な説明</a></li>
  <li><a href="#gauss-markov-の仮定" id="toc-gauss-markov-の仮定" class="nav-link" data-scroll-target="#gauss-markov-の仮定"><span class="header-section-number">1.3</span> Gauss-Markov の仮定</a></li>
  <li><a href="#検定に対する注意喚起" id="toc-検定に対する注意喚起" class="nav-link" data-scroll-target="#検定に対する注意喚起"><span class="header-section-number">1.4</span> 「検定」に対する注意喚起</a></li>
  </ul></li>
  <li><a href="#ベイズ分散分析" id="toc-ベイズ分散分析" class="nav-link" data-scroll-target="#ベイズ分散分析"><span class="header-section-number">2</span> ベイズ分散分析</a>
  <ul class="collapse">
  <li><a href="#はじめに-1" id="toc-はじめに-1" class="nav-link" data-scroll-target="#はじめに-1"><span class="header-section-number">2.1</span> はじめに</a></li>
  <li><a href="#sec-JZS-factor" id="toc-sec-JZS-factor" class="nav-link" data-scroll-target="#sec-JZS-factor"><span class="header-section-number">2.2</span> JZS 因子</a></li>
  <li><a href="#p-値との違い" id="toc-p-値との違い" class="nav-link" data-scroll-target="#p-値との違い"><span class="header-section-number">2.3</span> <span class="math inline">\(p\)</span>-値との違い</a></li>
  <li><a href="#sec-lm-ANOVA" id="toc-sec-lm-ANOVA" class="nav-link" data-scroll-target="#sec-lm-ANOVA"><span class="header-section-number">2.4</span> １元配置 ANOVA の線型モデル解釈</a></li>
  <li><a href="#anova-でのベイズ因子" id="toc-anova-でのベイズ因子" class="nav-link" data-scroll-target="#anova-でのベイズ因子"><span class="header-section-number">2.5</span> ANOVA でのベイズ因子</a></li>
  <li><a href="#多元配置ベイズ-anova" id="toc-多元配置ベイズ-anova" class="nav-link" data-scroll-target="#多元配置ベイズ-anova"><span class="header-section-number">2.6</span> 多元配置ベイズ ANOVA</a></li>
  <li><a href="#ベイズ因子に関する注意喚起" id="toc-ベイズ因子に関する注意喚起" class="nav-link" data-scroll-target="#ベイズ因子に関する注意喚起"><span class="header-section-number">2.7</span> 「ベイズ因子」に関する注意喚起</a></li>
  </ul></li>
  <li><a href="#ベイズ推論に基づく方法" id="toc-ベイズ推論に基づく方法" class="nav-link" data-scroll-target="#ベイズ推論に基づく方法"><span class="header-section-number">3</span> ベイズ推論に基づく方法</a>
  <ul class="collapse">
  <li><a href="#はじめに-2" id="toc-はじめに-2" class="nav-link" data-scroll-target="#はじめに-2"><span class="header-section-number">3.1</span> はじめに</a></li>
  <li><a href="#事後予測によるモデル検証" id="toc-事後予測によるモデル検証" class="nav-link" data-scroll-target="#事後予測によるモデル検証"><span class="header-section-number">3.2</span> 事後予測によるモデル検証</a></li>
  <li><a href="#ベイズ事後-p-値" id="toc-ベイズ事後-p-値" class="nav-link" data-scroll-target="#ベイズ事後-p-値"><span class="header-section-number">3.3</span> ベイズ事後 <span class="math inline">\(p\)</span>-値</a></li>
  <li><a href="#rope-region-of-practical-equivalence" id="toc-rope-region-of-practical-equivalence" class="nav-link" data-scroll-target="#rope-region-of-practical-equivalence"><span class="header-section-number">3.4</span> ROPE (Region of Practical Equivalence)</a></li>
  <li><a href="#混合モデリングによる方法" id="toc-混合モデリングによる方法" class="nav-link" data-scroll-target="#混合モデリングによる方法"><span class="header-section-number">3.5</span> 混合モデリングによる方法</a></li>
  <li><a href="#ハイパーモデル上の推論による解決" id="toc-ハイパーモデル上の推論による解決" class="nav-link" data-scroll-target="#ハイパーモデル上の推論による解決"><span class="header-section-number">3.6</span> ハイパーモデル上の推論による解決</a></li>
  </ul></li>
  <li><a href="#ベイズ統計解析に関する文献案内" id="toc-ベイズ統計解析に関する文献案内" class="nav-link" data-scroll-target="#ベイズ統計解析に関する文献案内"><span class="header-section-number">4</span> ベイズ統計解析に関する文献案内</a></li>
  
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
<p>$$</p>
<p>$$</p>
</div>
<section id="関連記事" class="level2 unnumbered unlisted">
<h2 class="unnumbered unlisted anchored" data-anchor-id="関連記事">関連記事</h2>
<div id="listing-lst-survey" class="listing quarto-float quarto-figure quarto-figure-left quarto-listing quarto-listing-container-grid anchored">
<div class="list grid quarto-listing-cols-3">
<div class="g-col-1" data-index="0" data-categories="QmF5ZXNpYW4lMkNTdGF0aXN0aWNzJTJDUg==" data-listing-date-sort="1727103600000" data-listing-file-modified-sort="1733732956590" data-listing-date-modified-sort="1733670000000" data-listing-reading-time-sort="5" data-listing-word-count-sort="848">
<a href="../../../posts/2024/Survey/BayesANOVA.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/Survey/Files/House.png" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
ベイズ分散分析のモデル解析
</h5>
<div class="card-subtitle listing-subtitle">
心理学実験を題材として
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-09-24
</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="1" data-categories="QmF5ZXNpYW4lMkNNQ01DJTJDUiUyQ1N0YW4lMkNTdGF0aXN0aWNz" data-listing-date-sort="1715439600000" data-listing-file-modified-sort="1733625497731" data-listing-date-modified-sort="1733583600000" data-listing-reading-time-sort="8" data-listing-word-count-sort="1529">
<a href="../../../posts/2024/Computation/brms.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/Computation/brms_files/figure-html/unnamed-chunk-4-1.png" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
R によるベイズ混合モデリング入門
</h5>
<div class="card-subtitle listing-subtitle">
brms を用いた混合効果モデリング入門
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-05-12
</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="2" data-categories="U3RhdGlzdGljcw==" data-listing-date-sort="1727017200000" data-listing-file-modified-sort="1727660630084" data-listing-date-modified-sort="1727535600000" data-listing-reading-time-sort="3" data-listing-word-count-sort="466">
<a href="../../../posts/2024/Survey/Survey2.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/Survey/Files/ATE.svg" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
ベイズデータ解析２
</h5>
<div class="card-subtitle listing-subtitle">
平均処置効果の推定とセミパラメトリック法
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-09-23
</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="3" data-categories="QmF5ZXNpYW4lMkNTdGF0aXN0aWNz" data-listing-date-sort="1727103600000" data-listing-file-modified-sort="1733662192688" data-listing-date-modified-sort="1727535600000" data-listing-reading-time-sort="6" data-listing-word-count-sort="1038">
<a href="../../../posts/2024/Survey/Survey3.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/Survey/Files/Horvitz-Thompson.svg" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
ベイズデータ解析３
</h5>
<div class="card-subtitle listing-subtitle">
標本調査データと欠測データの扱い
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-09-24
</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="4" data-categories="QmF5ZXNpYW4lMkNTdGF0aXN0aWNz" data-listing-date-sort="1733324400000" data-listing-file-modified-sort="1733793223426" data-listing-date-modified-sort="1733583600000" data-listing-reading-time-sort="2" data-listing-word-count-sort="344">
<a href="../../../posts/2024/Survey/BDA1.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/Survey/Files/BayesianWorkflow.svg" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
ベイズデータ解析５
</h5>
<div class="card-subtitle listing-subtitle">
回帰モデルの概観
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-12-05
</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="5" data-categories="QmF5ZXNpYW4lMkNTdGF0aXN0aWNz" data-listing-date-sort="1733324400000" data-listing-file-modified-sort="1733791232328" data-listing-date-modified-sort="1733670000000" data-listing-reading-time-sort="2" data-listing-word-count-sort="214">
<a href="../../../posts/2024/Survey/BDA2.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../../posts/2024/Survey/Files/BayesianWorkflow.svg" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
ベイズデータ解析６
</h5>
<div class="card-subtitle listing-subtitle">
応答が質的変数の場合
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-12-05
</div>
</div>
</div>
</div>
</a>
</div>
</div>
<div class="listing-no-matching d-none">
No matching items
</div>
</div>
</section>
<section id="分散分析" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="分散分析"><span class="header-section-number">1</span> 分散分析</h2>
<section id="はじめに" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="はじめに"><span class="header-section-number">1.1</span> はじめに</h3>
<p>分散分析 (ANOVA: Analysis of Variance) は標本がある因子 <span class="math inline">\(A,B,\cdots\)</span> によって層別されている場合に，層間の平均効果 <span class="math inline">\(\mu_i\)</span> に差があるかどうかを検定する手法である： <span class="math display">\[
H_0:\mu_1=\cdots=\mu_p\quad\text{v.s.}\quad H_1:\exists_{i,j\in[p]}\;\mu_i\ne\mu_j.
\]</span></p>
<p>因子 <span class="math inline">\(A,B,\cdots\)</span> の総数に応じて，<span class="math inline">\(A\)</span> のみの場合を一元配置分散分析，<span class="math inline">\(A,B\)</span> の場合を二元配置分散分析などという．</p>
<p>多くの場合，観測のモデルには <strong>線型 Gauss</strong> の仮定が置かれる．例えば一元配置である場合， <span id="eq-ANOVA"><span class="math display">\[
Y_{ij}=\mu_i+\epsilon_{ij},\qquad i\in[p],j\in[n_i],\epsilon_{ij}\sim\mathrm{N}(0,\sigma^2),
\tag{1}\]</span></span> というモデルを仮定し，パラメータ <span class="math inline">\(\mu_i\)</span> に関して検定を行う．</p>
<p>二元配置では <span class="math display">\[
Y_{ij}=\mu+\alpha_i+\beta_j+\epsilon_{ij}
\]</span> となり，集団は２つの軸 <span class="math inline">\(A,B\)</span> で層別されており（分割表の状態），それぞれの因子からの効果 <span class="math inline">\(\alpha_i,\beta_j\)</span> が説明変数に加法的に加えられる．</p>
</section>
<section id="分散分析の抽象的な説明" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="分散分析の抽象的な説明"><span class="header-section-number">1.2</span> 分散分析の抽象的な説明</h3>
<p>分散分析では観測 <span class="math inline">\(Y_{ij}\)</span> の変動のうち，<span class="math inline">\(H_0\)</span> の仮定の下で説明されなかった部分（残差） <span class="math inline">\(R_1^2\)</span> と，そもそも線型 Gauss 模型 (<a href="#eq-ANOVA" class="quarto-xref">1</a>) では説明しきれない部分 <span class="math inline">\(R_0^2\)</span> とに関して， <span class="math display">\[
F:=\frac{(R^2_1-R^2_0)/q}{R^2_0/(n-r)}
\]</span> を考える．ただし，<span class="math inline">\(r:=\operatorname{rank}(X)\)</span> はデータの自由度とした．</p>
<p>この <span class="math inline">\(F\)</span> は，各群への所属表すダミー変数を用いた回帰分析の残差 <span class="math inline">\(R_0\)</span> と，各群への所属を考慮しない回帰分析による残差 <span class="math inline">\(R_1\)</span> とを，自由度を考慮して比を取った形をしている．</p>
<p>この <span class="math inline">\(F\)</span> は一般に非心 F-分布に従い，仮定 <span class="math inline">\(H_0\)</span> が成り立つときのみ <strong>中心</strong> F-分布 <span class="math inline">\(\mathrm{F}(q,n-r)\)</span> に従う．これは各群への所属情報に何の情報量もない場合には，<span class="math inline">\(F\)</span> が<u>同じ平均を持つ</u>正規確率変数の自乗和の比になるためである．</p>
<p>換言すれば，非心パラメータ <span class="math display">\[
\delta:=\frac{1}{\sigma^2}\sum_{i=1}^pn_i(\mu_i-\overline{\mu})^2
\]</span> に関して <span class="math inline">\(H_0:\delta=0\)</span> を検定することに等しい <span class="citation" data-cites="Bertolino+1990">(<a href="#ref-Bertolino+1990" role="doc-biblioref">Bertolino et al., 1990</a>)</span>, <span class="citation" data-cites="Solari+2008">(<a href="#ref-Solari+2008" role="doc-biblioref">Solari et al., 2008</a>)</span>．</p>
<p>この <span class="math inline">\(F\)</span> （または等価な <span class="math inline">\(t,\delta\)</span>）を検定統計量として仮設検定を実行するのが (repeated measures) ANOVA である．</p>
</section>
<section id="gauss-markov-の仮定" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="gauss-markov-の仮定"><span class="header-section-number">1.3</span> Gauss-Markov の仮定</h3>
<p>「標本が正規分布に従う母集団からの独立標本である」という帰無仮説を持つ検定に，<span class="citation" data-cites="Shapiro-Wilk1965">(<a href="#ref-Shapiro-Wilk1965" role="doc-biblioref">Shapiro and Wilk, 1965</a>)</span> の検定などがある．</p>
<p>探索的な方法には Q-Q plot などがある．<span class="citation" data-cites="vandenBergh+2020">(<a href="#ref-vandenBergh+2020" role="doc-biblioref">Bergh et al., 2020</a>)</span> も参照．</p>
<p>等分散の仮定をチェックする検定には <span class="citation" data-cites="Mauchly1940">(<a href="#ref-Mauchly1940" role="doc-biblioref">Mauchly, 1940</a>)</span> の検定や <span class="citation" data-cites="Brown-Forsythe1974">(<a href="#ref-Brown-Forsythe1974" role="doc-biblioref">Brown and Forsythe, 1974</a>)</span> の検定などがある．</p>
<p>仮にこれらの仮定が破られた場合は，<span class="citation" data-cites="Kruskal-Wallis1952">(<a href="#ref-Kruskal-Wallis1952" role="doc-biblioref">Kruskal and Wallis, 1952</a>)</span> 検定などのランクベースの ANOVA 手法を用いることができる．<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>ただし，検定はデータの一側面しか伝えていない．例えば，データが帰無仮説をどれほど支持しているかの尺度は検定では得られない．</p>
<p>それゆえ，ANOVA などのモデルの仮定を確認するためには，検定だけでなく他の探索的手法と組み合わせることが推奨される．<span class="citation" data-cites="Tijmstra2018">(<a href="#ref-Tijmstra2018" role="doc-biblioref">Tijmstra, 2018</a>)</span> も参照．</p>
</section>
<section id="検定に対する注意喚起" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="検定に対する注意喚起"><span class="header-section-number">1.4</span> 「検定」に対する注意喚起</h3>
<p>一方で ANOVA を含めた検定は一面のみを強調する構造となっており，一連の統計解析の中で自然な位置付けを持つものでない．</p>
<p>特に，<span class="math inline">\(p\)</span>-値による仮設検定は「データが不十分であることにより判断ができない」ことと，「データと帰無仮説は激しく矛盾する」こととを区別できない．この意味でも限定的な情報量しか持たない．</p>
<p>例えば <span class="math inline">\(p\)</span>-値が小さく帰無仮説が棄却されたとしても，<span class="math inline">\(p\)</span>-値はモデルの変化に対して頑健ではないかもしれず，実際はほとんど帰無仮説が成り立つことが真実かもしれない．</p>
<p>このような全貌を探索的に捉えるためには，検定を金科玉条とするのではなく，広くモデル比較・モデル選択の観点からアプローチすることが大切である．同様のことが <span class="citation" data-cites="Rouder+2016">(<a href="#ref-Rouder+2016" role="doc-biblioref">Rouder et al., 2016</a>)</span> でも論じられている．</p>
<p>ANOVA は，特に大規模なものが，現在でも実験心理学などの分野で広く用いられている．これは心理学では多くの因子 <span class="math inline">\(A,B,C,\cdots\)</span> が存在し，それぞれが複雑な関係にあるためである．</p>
<p>しかし推定法も従来の <span class="math inline">\(F\)</span>-検定を用いたのではその力を十分に発揮できない．解決は丁寧な階層モデリングとベイズによる探索的な解析にある．<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<blockquote class="blockquote">
<p>”if you have a complicated data structure and are trying to set up a model, it can help to use multilevel modeling”—not just a simple unitswithin-groups structure but a more general approach with crossed factors where appropriate. This is the way that researchers in psychology use ANOVA, but <strong>they are often ill-served by the classical framework of mean squares and F-tests</strong>. We hope that our estimation-oriented approach will allow the powerful tools of Bayesian modeling to be used for the applied goals of inference about large numbers of structured parameters. <span class="citation" data-cites="Gelman2005">(<a href="#ref-Gelman2005" role="doc-biblioref">Gelman, 2005, p. 53</a>)</span></p>
</blockquote>
</section>
</section>
<section id="ベイズ分散分析" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="ベイズ分散分析"><span class="header-section-number">2</span> ベイズ分散分析</h2>
<section id="はじめに-1" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="はじめに-1"><span class="header-section-number">2.1</span> はじめに</h3>
<p>ベイズ分散分析 <span class="citation" data-cites="Rouder+2012">(<a href="#ref-Rouder+2012" role="doc-biblioref">Rouder et al., 2012</a>)</span>, <span class="citation" data-cites="Rouder+2016">(<a href="#ref-Rouder+2016" role="doc-biblioref">Rouder et al., 2016</a>)</span> では，(<a href="#eq-ANOVA" class="quarto-xref">1</a>) などの線型モデルに対して，パラメータが零ベクトルであることに対する検定の代わりに，帰無仮説を表現するモデルに対する Bayes 因子を用いたモデル比較を行う．</p>
<p>つまり，ベイズ分散分析と言った場合，「分散分析」の概念は完全に線型回帰モデルのベイズ推論に回収される．より正確には，階層モデルのベイズ推論は「分散分析」の正統な後継である <span class="citation" data-cites="Gelman2005">(<a href="#ref-Gelman2005" role="doc-biblioref">Gelman, 2005</a>)</span>．</p>
<blockquote class="blockquote">
<p>In this sense, ANOVA is indeed a special case of linear regression, but only if hierarchical models are used. <span class="citation" data-cites="Gelman2005">(<a href="#ref-Gelman2005" role="doc-biblioref">Gelman, 2005, p. 2</a>)</span></p>
</blockquote>
<p><span class="citation" data-cites="Rouder+2012">(<a href="#ref-Rouder+2012" role="doc-biblioref">Rouder et al., 2012</a>)</span> はその際の標準的な事前分布の選択について議論している（第 <a href="#sec-lm-ANOVA" class="quarto-xref">2.4</a> 節）．</p>
<p><span class="citation" data-cites="Rouder+2016">(<a href="#ref-Rouder+2016" role="doc-biblioref">Rouder et al., 2016</a>)</span> が指摘するように，分散分析がベイズ化される過程で，検定がモデル比較に置き換わっている．</p>
</section>
<section id="sec-JZS-factor" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="sec-JZS-factor"><span class="header-section-number">2.2</span> JZS 因子</h3>
<p>ベイズ的な仮設検定は <span class="citation" data-cites="Jeffreys1961">(<a href="#ref-Jeffreys1961" role="doc-biblioref">Jeffreys, 1961</a>)</span> に源流を持つ．一般に，位置母数の事前分布に Cauchy 分布を用いることは <span class="citation" data-cites="Jeffreys1961">(5.3節 <a href="#ref-Jeffreys1961" role="doc-biblioref">Jeffreys, 1961</a>)</span> に源流を持つ．このことについては <span class="citation" data-cites="Robert+2009">(<a href="#ref-Robert+2009" role="doc-biblioref">Robert et al., 2009</a>)</span> も参照．</p>
<p>同一の単位を繰り返し測定し， <span class="math display">\[
Y_i\overset{\text{i.i.d.}}{\sim}\mathrm{N}(\mu,\sigma^2),\qquad i\in[n],
\]</span> に従って何らかの処置効果 <span class="math inline">\(Y_i\)</span> 観測するとし，帰無仮説 <span class="math inline">\(\mu=0\)</span> の妥当性を議論したいとする．</p>
<p>この際，まずは効果サイズ (effect size) <span class="citation" data-cites="Cohen1988">(<a href="#ref-Cohen1988" role="doc-biblioref">Cohen, 1988</a>)</span> <span class="math inline">\(\delta:=\mu/\sigma\)</span> という無次元量にパラメータを変換し，これを Cauchy 分布と比較することを考える： <span class="math display">\[
M_0:\delta=0\quad\text{v.s.}\quad M_1:\delta\sim\mathrm{C}(0,1)
\]</span></p>
<p>実際，この Cauchy 分布というのは変換 <span class="math inline">\(J(\nu,\sigma):=\frac{\mu^2}{\sigma^2}\)</span> を通じて <span class="math inline">\(\mathbb{R}\)</span> 上の Jeffreys 事前分布（この場合は Lebesgue 測度に一致）に（ほとんど）等価になる．</p>
<p>この２つのモデル <span class="math inline">\(M_0,M_1\)</span> の残りの仮定は共通の Jeffreys の事前分布 <span class="math inline">\(p(\sigma^2)\,\propto\,\sigma^{-2}\)</span> で共通とし，Bayes 因子を算出する．</p>
<p>この値を検定統計量のように扱うとき，これを Jeffreys の名前に <span class="citation" data-cites="Zellner-Siow1980">(<a href="#ref-Zellner-Siow1980" role="doc-biblioref">Zellner and Siow, 1980</a>)</span> を加えて <strong>JZS 因子</strong> <span class="citation" data-cites="Bayarri-Darcia-Donato2007">(<a href="#ref-Bayarri-Darcia-Donato2007" role="doc-biblioref">Bayarri and García-Donato, 2007</a>)</span> という．あるいは上述の事前分布の選び方を JZS 事前分布という．</p>
<p>JZS 因子は，事前のモデル確率 <span class="math inline">\(p(M_0),p(M_1)\)</span> に依らずに算出できる．</p>
</section>
<section id="p-値との違い" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="p-値との違い"><span class="header-section-number">2.3</span> <span class="math inline">\(p\)</span>-値との違い</h3>
<p>JZS 因子は <span class="math inline">\(p\)</span>-値と比較して，サンプルサイズが大きいほど保守的になる傾向がある．<span class="citation" data-cites="Wetzels+2011">(<a href="#ref-Wetzels+2011" role="doc-biblioref">Wetzels et al., 2011</a>)</span> は 2007 年に特定の実験心理学雑誌に投稿された 855 件の t-検定に対して，JZS 因子と <span class="math inline">\(p\)</span>-値との値を報告してこれを観察している．</p>
<p><span class="citation" data-cites="vandenBergh+2023">(<a href="#ref-vandenBergh+2023" role="doc-biblioref">Bergh et al., 2023</a>)</span> は実例を用いて，特に複雑な心理学実験において，２つの解析手法はときに全く違う結論を導くことを例証している．</p>
<p>また JZS 因子は <span class="math inline">\(N\to\infty\)</span> の極限で，<span class="math inline">\(\delta\ne0\)</span> であった場合は <span class="math inline">\(\infty\)</span> に発散し，<span class="math inline">\(\delta=0\)</span> であった場合は <span class="math inline">\(1\)</span> に収束するという性質を持つ．</p>
</section>
<section id="sec-lm-ANOVA" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="sec-lm-ANOVA"><span class="header-section-number">2.4</span> １元配置 ANOVA の線型モデル解釈</h3>
<p>１元配置 ANOVA のモデルを次のように表す： <span id="eq-Bayesian-ANOVA"><span class="math display">\[
\boldsymbol{Y}=\mu\boldsymbol{1}_n+\sigma\boldsymbol{X}\boldsymbol{\theta}+\boldsymbol{\epsilon},\qquad\boldsymbol{\epsilon}|\sigma^2\sim\mathrm{N}(\boldsymbol{0},\sigma^2I_n).
\tag{2}\]</span></span> 各水準 <span class="math inline">\(i\in[p]\)</span> に属するデータの数を <span class="math inline">\(n_i\)</span> とすると <span class="math display">\[
\boldsymbol{X}=\begin{pmatrix}
\boldsymbol{1}_{n_1} &amp; \boldsymbol{0} &amp; \cdots &amp; \boldsymbol{0}\\
\boldsymbol{0} &amp; \boldsymbol{1}_{n_2} &amp; \cdots &amp; \boldsymbol{0}\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
\boldsymbol{0} &amp; \boldsymbol{0} &amp; \cdots &amp; \boldsymbol{1}_{n_p}
\end{pmatrix},\qquad\boldsymbol{\theta}=\begin{pmatrix}
\mu_1\\
\mu_2\\
\vdots\\
\mu_p
\end{pmatrix}.
\]</span> となる．</p>
<p>このとき，定数項 <span class="math inline">\(\mu\)</span> をすでに括り出しているので，<span class="math inline">\(\boldsymbol{\theta}=0\)</span> の場合のモデルが帰無仮説に対応する．</p>
<p>対立仮説としては，<span class="math inline">\(\boldsymbol{\theta}\)</span> 上に次の <span class="math inline">\(g\)</span>-prior を定める： <span class="math display">\[
\boldsymbol{\theta}\sim\mathrm{N}(\boldsymbol{0},G),\qquad G=\mathrm{diag}(g_1,\cdots,g_p),\qquad g_i\overset{\text{i.i.d.}}{\sim}\chi^{-2}(1).
\]</span> これは各 <span class="math inline">\(\mu_i\)</span> に対して独立な Cauchy 事前分布を仮定している．</p>
<p><span class="citation" data-cites="Zellner-Siow1980">(<a href="#ref-Zellner-Siow1980" role="doc-biblioref">Zellner and Siow, 1980</a>)</span> の事前分布 <span class="math display">\[
\boldsymbol{\theta}|g\sim\mathrm{N}(\boldsymbol{0},g(\boldsymbol{X}^\top\boldsymbol{X}/n)^{-1}I_p)
\]</span> や一般の <span class="math inline">\(g\)</span>-prior との違いとして，スケール因子 <span class="math inline">\((\boldsymbol{X}^\top\boldsymbol{X}/n)^{-1}\)</span> がない形であるのは，ANOVA の説明変数 <span class="math inline">\(\boldsymbol{X}\)</span> が離散変数であるためである．</p>
</section>
<section id="anova-でのベイズ因子" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="anova-でのベイズ因子"><span class="header-section-number">2.5</span> ANOVA でのベイズ因子</h3>
<p>以上のモデルを，帰無仮説に対立させる「デフォルトモデル」として提案したのが <span class="citation" data-cites="Rouder+2012">(<a href="#ref-Rouder+2012" role="doc-biblioref">Rouder et al., 2012</a>)</span> である．</p>
<p>特に <span class="math inline">\(G=gI_p\)</span> の場合は，結果として得られるベイズ因子は１次元の積分のみを含むため，簡単な数値積分アルゴリズムによって計算可能である．</p>
</section>
<section id="多元配置ベイズ-anova" class="level3" data-number="2.6">
<h3 data-number="2.6" class="anchored" data-anchor-id="多元配置ベイズ-anova"><span class="header-section-number">2.6</span> 多元配置ベイズ ANOVA</h3>
<p>多くの場合，被説明変数に関連すると予期される因子は複数存在する．ここでは２元配置の場合を考える．それぞれの因子が <span class="math inline">\(a,b\)</span> 水準を持つとき，フルモデルは <span class="math display">\[
\boldsymbol{Y}=\mu\boldsymbol{1}+\sigma\biggr(\boldsymbol{X}_\alpha\alpha+\boldsymbol{X}_\beta\beta+\boldsymbol{X}_{\gamma}\gamma\biggl)+\boldsymbol{\epsilon},
\]</span> と表せる．</p>
<p>詳しくは <span class="citation" data-cites="Rouder+2012">(Section 8 <a href="#ref-Rouder+2012" role="doc-biblioref">Rouder et al., 2012</a>)</span> を参照．</p>
</section>
<section id="ベイズ因子に関する注意喚起" class="level3" data-number="2.7">
<h3 data-number="2.7" class="anchored" data-anchor-id="ベイズ因子に関する注意喚起"><span class="header-section-number">2.7</span> 「ベイズ因子」に関する注意喚起</h3>
<p>ベイズ因子を含め，周辺尤度 <span class="math inline">\(p(\theta|y)\)</span> （エビデンスともいう）を用いた指標は，モデルの仮定に対して感度が高い <span class="citation" data-cites="Robert2016">(<a href="#ref-Robert2016" role="doc-biblioref">Robert, 2016</a>)</span>, <span class="citation" data-cites="Kamary+2018">(<a href="#ref-Kamary+2018" role="doc-biblioref">Kamary et al., 2018</a>)</span>．</p>
<p>そのため「モデルのデータへの当てはまりの良さを１つの指標にまとめた値」としては少し心許ない．</p>
<p>加えて，帰無仮説に対立させる仮説を構成して，二項対立の構造に持ち込むことは，自然なデータ解析のワークフローに必ずしも入ってこない．</p>
<p>ベイズ推論の仮定で得られる事後分布から，特定の仮説 <span class="math inline">\(H:\theta=\theta_0\)</span> がまともかを評価する方法の方が，探索的データ解析の観点からは含意が多いことも多い．</p>
</section>
</section>
<section id="ベイズ推論に基づく方法" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="ベイズ推論に基づく方法"><span class="header-section-number">3</span> ベイズ推論に基づく方法</h2>
<section id="はじめに-2" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="はじめに-2"><span class="header-section-number">3.1</span> はじめに</h3>
<p>ANOVA とベイズ ANOVA の究極的な目標は，平均が一致する <span class="math display">\[
H_0:\mu_1=\cdots=\mu_p
\]</span> という仮説がデータからどれほど支持されるか／されないかを評価することにある．</p>
<p>最も直接的な方法は，パラメータ空間上に描かれる事後分布を見ることである．信用区間を報告し，帰無仮説がそのどこに位置するかを見ても良いだろう．</p>
</section>
<section id="事後予測によるモデル検証" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="事後予測によるモデル検証"><span class="header-section-number">3.2</span> 事後予測によるモデル検証</h3>
<p>このように，ベイズ事後分布やそのサンプルを通じたモデル検証方法は posterior predictive check <span class="citation" data-cites="Gelman-Shalizi2013">(<a href="#ref-Gelman-Shalizi2013" role="doc-biblioref">Gelman and Shalizi, 2013</a>)</span> と呼ばれ，これを多角的に行うことが一つの理想形とされている <span class="citation" data-cites="Gelman+2020">(<a href="#ref-Gelman+2020" role="doc-biblioref">Gelman et al., 2020</a>)</span>．</p>
<p>同様に <span class="citation" data-cites="Kruschke2015">(<a href="#ref-Kruschke2015" role="doc-biblioref">Kruschke, 2015</a>)</span> では，モデル (<a href="#eq-Bayesian-ANOVA" class="quarto-xref">2</a>) の形を一般化線型モデルの特別な場合と見て推定し，ANOVA をモデル比較の観点から適切に実行する方法を論じている．</p>
<p>このように，ANOVA を適切に扱うには，階層モデルとしての取り扱いが欠かせない．同様の議論は <span class="citation" data-cites="Gelman2005">(<a href="#ref-Gelman2005" role="doc-biblioref">Gelman, 2005</a>)</span> でも展開されている．</p>
<p>ここでは，以下の節で帰無仮説 <span class="math inline">\(H_0\)</span> の妥当性を詳細に評価するための方法を見ていく．</p>
</section>
<section id="ベイズ事後-p-値" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="ベイズ事後-p-値"><span class="header-section-number">3.3</span> ベイズ事後 <span class="math inline">\(p\)</span>-値</h3>
<p>Bayes 因子の他に，検定統計量に対するベイズ事後予測分布を導出し，その裾確率を評価して <span class="math inline">\(p\)</span>-値の代替とする方法もある．</p>
<p>これは <strong>事後予測 <span class="math inline">\(p\)</span>-値</strong> (posterior predictive <span class="math inline">\(p\)</span>-value) <span class="citation" data-cites="BDA">(<a href="#ref-BDA" role="doc-biblioref">Gelman et al., 2014, p. 146</a>)</span> と呼ばれる．</p>
</section>
<section id="rope-region-of-practical-equivalence" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="rope-region-of-practical-equivalence"><span class="header-section-number">3.4</span> ROPE (Region of Practical Equivalence)</h3>
<p>ROPE は帰無仮説 <span class="math inline">\(H_0\)</span> と区別がつかないとする区間である．</p>
<p>帰無仮説が <span class="math inline">\(H_0:\theta=\theta_0\)</span> という形をしていた場合，ほとんどの場合 <span class="math inline">\(\theta=\theta_0+0.1\)</span> でも事実上変化はない．</p>
<p>このように，帰無仮説と同一視してしまう範囲を <strong>ROPE</strong> <span class="citation" data-cites="Kruschke2015">(<a href="#ref-Kruschke2015" role="doc-biblioref">Kruschke, 2015, p. 336</a>)</span> という．</p>
<section id="hdr-の使用" class="level4" data-number="3.4.1">
<h4 data-number="3.4.1" class="anchored" data-anchor-id="hdr-の使用"><span class="header-section-number">3.4.1</span> HDR の使用</h4>
<p>この ROPE が 95% <a href="https://ja.wikipedia.org/wiki/信用区間"><strong>最高密度信用領域</strong></a> (HDR: Highest Density Region) と互いに素になるときに，「棄却」されたとする．</p>
<p>ただし，最高密度信用領域とは 95% 信用区間＝95% の事後確率を持つ領域のうち，面積が最も小さいもののことを言う．</p>
<p>この方法では，逆に HDR が ROPE を完全に含む場合，帰無仮説を「採択」するという積極的な意思決定も可能である．</p>
<p>ROPE と同様の考え方は，ベイズによる実験計画法でも range of equivalence <span class="citation" data-cites="Freedman+1984">(<a href="#ref-Freedman+1984" role="doc-biblioref">Freedman et al., 1984</a>)</span>, <span class="citation" data-cites="Spiegelhalter+1994">(<a href="#ref-Spiegelhalter+1994" role="doc-biblioref">Spiegelhalter et al., 1994</a>)</span> の名前で用いられてきた歴史がある．</p>
</section>
<section id="rope-の確率" class="level4" data-number="3.4.2">
<h4 data-number="3.4.2" class="anchored" data-anchor-id="rope-の確率"><span class="header-section-number">3.4.2</span> ROPE の確率</h4>
<p>または，事後確率分布が ROPE 内にどれほどの確率を与えるかを見ることもできる <span class="citation" data-cites="Kruschke2018">(<a href="#ref-Kruschke2018" role="doc-biblioref">Kruschke, 2018</a>)</span>．</p>
<p>ROPE の応用と実装は <span class="citation" data-cites="Kelter2022">(<a href="#ref-Kelter2022" role="doc-biblioref">Kelter, 2022</a>)</span> も参照．</p>
</section>
</section>
<section id="混合モデリングによる方法" class="level3" data-number="3.5">
<h3 data-number="3.5" class="anchored" data-anchor-id="混合モデリングによる方法"><span class="header-section-number">3.5</span> 混合モデリングによる方法</h3>
<p>ベイズの方法の特徴は，検定・モデル比較と推論とに区別がないことである．</p>
<p>加えて純粋に検定・モデル比較のための手続きを作るより（ベイズ因子など），推定の一種として扱った方がより多くの情報を引き出せるため，ワークフローとしては好ましい <span class="citation" data-cites="Kruschke2011">(<a href="#ref-Kruschke2011" role="doc-biblioref">Kruschke, 2011</a>)</span>．</p>
<p><span class="citation" data-cites="Robert2016">(<a href="#ref-Robert2016" role="doc-biblioref">Robert, 2016</a>)</span>, <span class="citation" data-cites="Kamary+2018">(<a href="#ref-Kamary+2018" role="doc-biblioref">Kamary et al., 2018</a>)</span> では検定の対象となっているモデル <span class="math display">\[
M_1:x\sim f_1(x|\theta_1)\quad\text{v.s.}\quad M_2:x\sim f_2(x|\theta_2)
\]</span> を，混合モデル <span class="math display">\[
M_\alpha:x\sim\alpha f_1(x|\theta_1)+(1-\alpha)f_2(x|\theta_2)
\]</span> の成分の１つとみなし，その荷重 <span class="math inline">\(\alpha\)</span> の事後分布を推定し，これを検定に用いるという方法が提案されている．</p>
</section>
<section id="ハイパーモデル上の推論による解決" class="level3" data-number="3.6">
<h3 data-number="3.6" class="anchored" data-anchor-id="ハイパーモデル上の推論による解決"><span class="header-section-number">3.6</span> ハイパーモデル上の推論による解決</h3>
<p>同様の発想により，ベイズ因子の計算と推論によるモデル比較とを，より大きなハイパーモデルを立てることで同時に実行することもできる．</p>
<p><span class="citation" data-cites="Kruschke2011">(<a href="#ref-Kruschke2011" role="doc-biblioref">Kruschke, 2011, p. 308</a>)</span> や <span class="citation" data-cites="ONeill-Kypraios2016">(<a href="#ref-ONeill-Kypraios2016" role="doc-biblioref">O’Neill and Kypraios, 2016</a>)</span> などで考えられている．</p>
</section>
</section>
<section id="ベイズ統計解析に関する文献案内" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="ベイズ統計解析に関する文献案内"><span class="header-section-number">4</span> ベイズ統計解析に関する文献案内</h2>
<p>応用分野の研究者に対する「なぜベイズを使うのか？」に対する端的な回答として，「統計的有意性」などの「わかりやすい」指標に飛びついた結果，真のデータの声を聞かずに自分の見たいものを見始めてしまうと言うことが少なく，「自己欺瞞に陥りにくい」という美点があることは，<a href="../../../posts/2024/AI/BAI.html">ベイズ機械学習の稿</a> でも触れた．</p>
<p><span class="math inline">\(p\)</span>-値はそのような欺瞞を生む代用例であり，使用を禁止すべきとの声 <span class="citation" data-cites="McShane+2019">(<a href="#ref-McShane+2019" role="doc-biblioref">Blakeley B. McShane and Tackett, 2019</a>)</span> もある．その論拠は大まかに次のとおりである．</p>
<p>そもそも <span class="math inline">\(p\)</span>-値とは，「帰無仮説を採用したモデルはデータへの当てはまりの度合いが悪い」ということを言っているだけであり，<span class="math inline">\(p\)</span>-値が十分に低ければそれ以上の情報は引き出せない．</p>
<p>当然 <span class="math inline">\(p\)</span>-値が <span class="math inline">\(0.01\)</span> であることと <span class="math inline">\(0.00001\)</span> であることは質的に全く変わらない <span class="citation" data-cites="BDA">(<a href="#ref-BDA" role="doc-biblioref">Gelman et al., 2014, p. 150</a>)</span>．</p>
<p>そのことに加え <span class="math inline">\(p\)</span>-値は必ずしも頑健な指標ではなく，帰無仮説を少し摂動させただけで <span class="math inline">\(p\)</span> 値が大きくなってしまうかもしれない．そのような場合は結局ほとんど帰無的であり，「統計的有意性」はほとんど無意味になってしまう．同様の議論が <span class="citation" data-cites="Gelman-Stern2006">(<a href="#ref-Gelman-Stern2006" role="doc-biblioref">Gelman and Stern, 2006</a>)</span> で展開されている．</p>
<p>このような現状への対処として，応用分野の研究者にもベイズ統計学は根本的な解決法として広く推奨される <span class="citation" data-cites="Dienes-Mclatchie2018">(<a href="#ref-Dienes-Mclatchie2018" role="doc-biblioref">Dienes and Mclatchie, 2018</a>)</span>．<span class="citation" data-cites="Wagenmakers+2016">(<a href="#ref-Wagenmakers+2016" role="doc-biblioref">Wagenmakers et al., 2016</a>)</span> はその旨を２つの実例を通じて簡潔に実証しており，同時にベイズ統計学の考え方に対する洗練された導入を行なっている．</p>
<p><span class="citation" data-cites="vandenBergh+2020">(<a href="#ref-vandenBergh+2020" role="doc-biblioref">Bergh et al., 2020</a>)</span> は分散分析をベイズの方法によって実行する手引きを，特に JASP を用いて実演している．</p>
<p>JASP のベイズ ANOVA のエンジンは R パッケージ <code>BayesFactor</code> (<a href="https://cran.r-project.org/web/packages/BayesFactor/index.html">CRAN</a> / <a href="https://github.com/richarddmorey/BayesFactor">GitHub</a>) を用いている．<code>BayesFactor</code> では大規模な <span class="math inline">\(M\)</span>-元配置 ANOVA モデルにおいても Bayes 因子を用いたモデル比較を行うことができる．</p>
<p>ベイズ ANOVA の R パッケージとしては <code>bayesanova</code> (<a href="https://cran.r-project.org/web/packages/bayesanova/index.html">CRAN</a> / <a href="https://github.com/cran/bayesanova">GitHub</a>) <span class="citation" data-cites="Kelter2022">(<a href="#ref-Kelter2022" role="doc-biblioref">Kelter, 2022</a>)</span> もある．これは検定に似た行為を根本的に排除して Gauss 混合モデルとして Gibbs サンプラーによるベイズ推定を実行し，ROPE (Region of Practical Equivalence) <span class="citation" data-cites="Kruschke2015">(<a href="#ref-Kruschke2015" role="doc-biblioref">Kruschke, 2015, p. 336</a>)</span> <span class="citation" data-cites="Kruschke2018">(<a href="#ref-Kruschke2018" role="doc-biblioref">Kruschke, 2018</a>)</span> を用いたモデル比較を行う．</p>
<p>もちろんこのような完全なモデリングを行うことが理想かもしれないが，従来の ANOVA になれきっている研究者にとっては，Bayesian ANOVA に手を伸ばしてみることが次のステップとして大変良いだろう．</p>
<p>また別の角度からの「ベイズを使うべき理由」としての説得的な議論としては，ベイズ階層モデリングは ANOVA の正統進化という理解 <span class="citation" data-cites="Gelman2005">(<a href="#ref-Gelman2005" role="doc-biblioref">Gelman, 2005</a>)</span> ができるという向きもある．</p>
<p>以上の立場は <span class="citation" data-cites="BDA">(<a href="#ref-BDA" role="doc-biblioref">Gelman et al., 2014</a>)</span> や <span class="citation" data-cites="Kruschke2015">(<a href="#ref-Kruschke2015" role="doc-biblioref">Kruschke, 2015</a>)</span> などの標準的なベイズデータ解析の教科書でも一貫している．</p>
</section>



<div id="quarto-appendix" class="default"><section id="その他の文献案内" class="level2 appendix" data-number="5"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">5</span> その他の文献案内</h2><div class="quarto-appendix-contents">

<p>F-検定については <span class="citation" data-cites="吉田朋広2006-数理統計">(<a href="#ref-吉田朋広2006-数理統計" role="doc-biblioref">吉田朋広, 2006</a>)</span> と <span class="citation" data-cites="Solari+2008">(<a href="#ref-Solari+2008" role="doc-biblioref">Solari et al., 2008</a>)</span> を参考にした．</p>
<p>ANOVA の歴史については <span class="citation" data-cites="Tweney2014">(<a href="#ref-Tweney2014" role="doc-biblioref">Tweney, 2014</a>)</span> を参照．(repeated measures) ANOVA は多重線型回帰のうち説明変数が離散変数である場合に相当するという理解は，一般化線型モデルの発展と普及に伴って理解が広がった．</p>




</div></section><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Bayarri-Darcia-Donato2007" class="csl-entry" role="listitem">
Bayarri, M. J., and García-Donato, G. (2007). <a href="https://doi.org/10.1093/biomet/asm014"><span class="nocase">Extending conventional priors for testing general hypotheses in linear models</span></a>. <em>Biometrika</em>, <em>94</em>(1), 135–152.
</div>
<div id="ref-vandenBergh+2020" class="csl-entry" role="listitem">
Bergh, D. van den, Doorn, J. van, Marsman, M., Draws, T., Kesteren, E.-J. van, Derks, K., … Wagenmakers, E.-J. (2020). <a href="https://doi.org/10.3917/anpsy1.201.0073"><span class="nocase">A Tutorial on Conducting and Interpreting a Bayesian ANOVA in JASP</span></a>. <em>L’Année Psychologique</em>, <em>120</em>, 73–96.
</div>
<div id="ref-vandenBergh+2023" class="csl-entry" role="listitem">
Bergh, D. van den, Wagenmakers, E.-J., and Aust, F. (2023). <a href="https://doi.org/10.1177/25152459231168024">Bayesian repeated-measures analysis of variance: An updated methodology implemented in JASP</a>. <em>Advances in Methods and Practices in Psychological Science</em>, <em>6</em>(2), 25152459231168024.
</div>
<div id="ref-Bertolino+1990" class="csl-entry" role="listitem">
Bertolino, F., Piccinato, L., and Racugno, W. (1990). <a href="http://www.jstor.org/stable/2349085">A marginal likelihood approach to analysis of variance</a>. <em>Journal of the Royal Statistical Society. Series D (The Statistician)</em>, <em>39</em>(4), 415–424.
</div>
<div id="ref-McShane+2019" class="csl-entry" role="listitem">
Blakeley B. McShane, A. G., David Gal, and Tackett, J. L. (2019). <a href="https://doi.org/10.1080/00031305.2018.1527253">Abandon statistical significance</a>. <em>The American Statistician</em>, <em>73</em>(sup1), 235–245.
</div>
<div id="ref-Brown-Forsythe1974" class="csl-entry" role="listitem">
Brown, M. B., and Forsythe, A. B. (1974). <a href="https://doi.org/10.1080/01621459.1974.10482955">Robust tests for the equality of variances</a>. <em>Journal of the American Statistical Association</em>, <em>69</em>(346), 364–367.
</div>
<div id="ref-Cohen1988" class="csl-entry" role="listitem">
Cohen, J. (1988). <em><a href="https://doi.org/10.4324/9780203771587">Statistical power analysis for the behavioral sciences</a></em>. Routledge.
</div>
<div id="ref-Dienes-Mclatchie2018" class="csl-entry" role="listitem">
Dienes, Z., and Mclatchie, N. (2018). <a href="https://doi.org/10.3758/s13423-017-1266-z">Four reasons to prefer bayesian analyses over significance testing</a>. <em>Psychonomic Bulletin &amp; Review</em>, <em>25</em>(1), 207–218.
</div>
<div id="ref-Freedman+1984" class="csl-entry" role="listitem">
Freedman, L. S., Lowe, D., and Macaskill, P. (1984). <a href="http://www.jstor.org/stable/2530902">Stopping rules for clinical trials incorporating clinical opinion</a>. <em>Biometrics</em>, <em>40</em>(3), 575–586.
</div>
<div id="ref-Gelman2005" class="csl-entry" role="listitem">
Gelman, A. (2005). <a href="https://doi.org/10.1214/009053604000001048"><span class="nocase">Analysis of variance—why it is more important than ever</span></a>. <em>The Annals of Statistics</em>, <em>33</em>(1), 1–53.
</div>
<div id="ref-BDA" class="csl-entry" role="listitem">
Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari, A., and Rubin, D. B. (2014). <em><a href="http://www.stat.columbia.edu/~gelman/book/">Bayesian data analysis</a></em>. Boca Raton : CRC Press.
</div>
<div id="ref-Gelman-Shalizi2013" class="csl-entry" role="listitem">
Gelman, A., and Shalizi, C. R. (2013). <a href="https://doi.org/10.1111/j.2044-8317.2011.02037.x">Philosophy and the practice of bayesian statistics</a>. <em>British Journal of Mathematical and Statistical Psychology</em>, <em>66</em>(1), 8–38.
</div>
<div id="ref-Gelman-Stern2006" class="csl-entry" role="listitem">
Gelman, A., and Stern, H. (2006). <a href="https://doi.org/10.1198/000313006X152649">The difference between <span>“significant”</span> and <span>“not significant”</span> is not itself statistically significant</a>. <em>The American Statistician</em>, <em>60</em>(4), 328–331.
</div>
<div id="ref-Gelman+2020" class="csl-entry" role="listitem">
Gelman, A., Vehtari, A., Simpson, D., Margossian, C. C., Carpenter, B., Yao, Y., … Modrák, M. (2020). <a href="https://arxiv.org/abs/2011.01808">Bayesian workflow</a>.
</div>
<div id="ref-Jeffreys1961" class="csl-entry" role="listitem">
Jeffreys, H. (1961). <em><a href="https://doi.org/10.1093/oso/9780198503682.001.0001">Theory of probability</a></em>. Oxford University Press.
</div>
<div id="ref-Kamary+2018" class="csl-entry" role="listitem">
Kamary, K., Mengersen, K., Robert, C. P., and Rousseau, J. (2018). <a href="https://arxiv.org/abs/1412.2044">Testing hypotheses via a mixture estimation model</a>.
</div>
<div id="ref-Kelter2022" class="csl-entry" role="listitem">
Kelter, R. (2022). Bayesanova: An r package for bayesian inference in the analysis of variance via markov chain monte carlo in gaussian mixture models. <em>The R Journal</em>, <em>14</em>, 54–78.
</div>
<div id="ref-Kruschke2011" class="csl-entry" role="listitem">
Kruschke, J. K. (2011). <a href="https://doi.org/10.1177/1745691611406925">Bayesian assessment of null values via parameter estimation and model comparison</a>. <em>Perspectives on Psychological Science</em>, <em>6</em>(3), 299–312.
</div>
<div id="ref-Kruschke2015" class="csl-entry" role="listitem">
Kruschke, J. K. (2015). <em><a href="https://www.sciencedirect.com/book/9780124058880/doing-bayesian-data-analysis">Doing bayesian data analysis: A tutorial with r, JAGS, and stan</a></em>. London ; Tokyo : Academic Press.
</div>
<div id="ref-Kruschke2018" class="csl-entry" role="listitem">
Kruschke, J. K. (2018). <a href="https://doi.org/10.1177/2515245918771304">Rejecting or accepting parameter values in bayesian estimation</a>. <em>Advances in Methods and Practices in Psychological Science</em>, <em>1</em>(2), 270–280.
</div>
<div id="ref-Kruskal-Wallis1952" class="csl-entry" role="listitem">
Kruskal, W. H., and Wallis, W. A. (1952). <a href="https://doi.org/10.1080/01621459.1952.10483441">Use of ranks in one-criterion variance analysis</a>. <em>Journal of the American Statistical Association</em>, <em>47</em>(260), 583–621.
</div>
<div id="ref-Mauchly1940" class="csl-entry" role="listitem">
Mauchly, J. W. (1940). <a href="http://www.jstor.org/stable/2235878">Significance test for sphericity of a normal n-variate distribution</a>. <em>The Annals of Mathematical Statistics</em>, <em>11</em>(2), 204–209.
</div>
<div id="ref-ONeill-Kypraios2016" class="csl-entry" role="listitem">
O’Neill, P. D., and Kypraios, T. (2016). <a href="https://arxiv.org/abs/1411.7888">Bayesian model choice via mixture distributions with application to epidemics and population process models</a>.
</div>
<div id="ref-Robert2016" class="csl-entry" role="listitem">
Robert, C. P. (2016). <a href="https://doi.org/10.1016/j.jmp.2015.08.002">The expected demise of the bayes factor</a>. <em>Journal of Mathematical Psychology</em>, <em>72</em>, 33–37.
</div>
<div id="ref-Robert+2009" class="csl-entry" role="listitem">
Robert, C. P., Chopin, N., and Rousseau, J. (2009). <a href="https://doi.org/10.1214/09-STS284"><span class="nocase">Harold Jeffreys’s Theory of Probability Revisited</span></a>. <em>Statistical Science</em>, <em>24</em>(2), 141–172.
</div>
<div id="ref-Rouder+2016" class="csl-entry" role="listitem">
Rouder, J. N., Engelhardt, C. R., McCabe, S., and Morey, R. D. (2016). <a href="https://doi.org/10.3758/s13423-016-1026-5">Model comparison in ANOVA</a>. <em>Psychonomic Bulletin &amp; Review</em>, <em>23</em>(6), 1779–1786.
</div>
<div id="ref-Rouder+2012" class="csl-entry" role="listitem">
Rouder, J. N., Morey, R. D., Speckman, P. L., and Province, J. M. (2012). <a href="https://doi.org/10.1016/j.jmp.2012.08.001">Default bayes factors for ANOVA designs</a>. <em>Journal of Mathematical Psychology</em>, <em>56</em>(5), 356–374.
</div>
<div id="ref-Shapiro-Wilk1965" class="csl-entry" role="listitem">
Shapiro, S. S., and Wilk, M. B. (1965). <a href="https://doi.org/10.1093/biomet/52.3-4.591"><span class="nocase">An analysis of variance test for normality (complete samples)†</span></a>. <em>Biometrika</em>, <em>52</em>(3-4), 591–611.
</div>
<div id="ref-Solari+2008" class="csl-entry" role="listitem">
Solari, F., Liseo, B., and Sun, D. (2008). <a href="https://doi.org/10.1007/s10463-007-0117-5">Some remarks on bayesian inference for one-way ANOVA models</a>. <em>Annals of the Institute of Statistical Mathematics</em>, <em>60</em>(3), 483–498.
</div>
<div id="ref-Spiegelhalter+1994" class="csl-entry" role="listitem">
Spiegelhalter, D. J., Freedman, L. S., and Parmar, M. K. B. (1994). <a href="https://doi.org/10.2307/2983527">Bayesian approaches to randomized trials</a>. <em>Journal of the Royal Statistical Society: Series A (Statistics in Society)</em>, <em>157</em>(3), 357–387.
</div>
<div id="ref-Tijmstra2018" class="csl-entry" role="listitem">
Tijmstra, J. (2018). <a href="https://doi.org/10.3758/s13423-018-1447-4">Why checking model assumptions using null hypothesis significance tests does not suffice: A plea for plausibility</a>. <em>Psychonomic Bulletin &amp; Review</em>, <em>25</em>(2), 548–559.
</div>
<div id="ref-Tweney2014" class="csl-entry" role="listitem">
Tweney, R. D. (2014). <a href="https://doi.org/10.1002/9781118445112.stat06304">History of analysis of variance</a>. In <em>Wiley StatsRef: Statistics reference online</em>. John Wiley &amp; Sons, Ltd.
</div>
<div id="ref-Wagenmakers+2016" class="csl-entry" role="listitem">
Wagenmakers, E.-J., Morey, R. D., and Lee, M. D. (2016). <a href="https://doi.org/10.1177/0963721416643289">Bayesian benefits for the pragmatic researcher</a>. <em>Current Directions in Psychological Science</em>, <em>25</em>(3), 169–176.
</div>
<div id="ref-Wetzels+2011" class="csl-entry" role="listitem">
Wetzels, R., Matzke, D., Lee, M. D., Rouder, J. N., Iverson, G. J., and Wagenmakers, E.-J. (2011). <a href="https://doi.org/10.1177/1745691611406923">Statistical evidence in experimental psychology: An empirical comparison using 855 t tests</a>. <em>Perspectives on Psychological Science</em>, <em>6</em>(3), 291–298.
</div>
<div id="ref-Zellner-Siow1980" class="csl-entry" role="listitem">
Zellner, A., and Siow, A. (1980). <a href="https://doi.org/10.1007/BF02888369">Posterior odds ratios for selected regression hypotheses</a>. <em>Trabajos de Estadistica Y de Investigacion Operativa</em>, <em>31</em>(1), 585–603.
</div>
<div id="ref-吉田朋広2006-数理統計" class="csl-entry" role="listitem">
吉田朋広. (2006). <em>数理統計学</em>,Vol. 21. 朝倉書店.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>もちろん，Stan などの確率的プログラミング言語を用いた完全なベイズモデリングはいつでも実行可能である．<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>そして因子分析を通じて，記述統計学の正統進化であるということもできる！？ ANOVA の歴史については <span class="citation" data-cites="Tweney2014">(<a href="#ref-Tweney2014" role="doc-biblioref">Tweney, 2014</a>)</span> も参照．<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/162348\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="162348/162348.github.io" data-repo-id="R_kgDOKlfKYQ" data-category="Announcements" data-category-id="DIC_kwDOKlfKYc4CgDmb" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" data-loading="lazy" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://162348.github.io/">
<p>Hirofumi Shiba</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/162348/162348.github.io/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ano2math5">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:shiba.hirofumi@ism.ac.jp">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../../blog.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>