<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="司馬博文">

<title>Roberts and Tweedie (1996) Exponential Convergence of Langevin Distributions and Their Discrete Approximations – Hirofumi Shiba</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../assets/profile.jpg" rel="icon" type="image/jpeg">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-cf7929f4d66a2bdccc4ecf0c4d40c672.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-6440ae36dcaea21c2c7d45a955744ce0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "?",
    "H"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-36GX2G6GLL"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-36GX2G6GLL', { 'anonymize_ip': true});
</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Zen+Kurenaido&amp;display=swap" rel="stylesheet">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=BIZ+UDPGothic&amp;display=swap" rel="stylesheet">

<style>
  .navbar-title, .menu-text {
      font-family: "Zen Kurenaido", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
  h1, .title, .description, .subtitle {
    font-family: "Zen Kurenaido", sans-serif !important;
  }
</style>

<!-- <style>
  .menu-text {
      font-family: "Gill Sans", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
  .navbar-title {
      font-family: "Gill Sans", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
</style> -->

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../assets/styles.css">
<meta property="og:title" content="Roberts and Tweedie (1996) Exponential Convergence of Langevin Distributions and Their Discrete Approximations – Hirofumi Shiba">
<meta property="og:description" content="Roberts and Tweedie [Bernoulli 2(1996) 341-363] は MALA (Metropolis-Adjusted Langevin Algorithm) の指数エルゴード性を議論したもの．">
<meta property="og:image" content="https://162348.github.io/posts/2024/Review/Roberts-Tweedie1996.svg">
<meta property="og:site_name" content="Hirofumi Shiba">
<meta name="twitter:title" content="Roberts and Tweedie (1996) Exponential Convergence of Langevin Distributions and Their Discrete Approximations – Hirofumi Shiba">
<meta name="twitter:description" content="Roberts and Tweedie [Bernoulli 2(1996) 341-363] は MALA (Metropolis-Adjusted Langevin Algorithm) の指数エルゴード性を議論したもの．">
<meta name="twitter:image" content="https://162348.github.io/posts/2024/Review/Roberts-Tweedie1996.svg">
<meta name="twitter:creator" content="@ano2math5">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Hirofumi Shiba</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../static/English.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Sessions.html"> 
<span class="menu-text">Sessions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../blog.html"> 
<span class="menu-text">ノート</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Japanese.html"> 
<span class="menu-text">自己紹介</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/162348/162348.github.io/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Roberts and Tweedie (1996) Exponential Convergence of Langevin Distributions and Their Discrete Approximations</h1>
            <p class="subtitle lead">論文メモ</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Review</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>司馬博文 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">4/23/2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">6/08/2024</p>
      </div>
    </div>
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="block-title">概要</div>
      <p>Roberts and Tweedie [Bernoulli 2(1996) 341-363] は MALA (Metropolis-Adjusted Langevin Algorithm) の指数エルゴード性を議論したもの．</p>
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目次</h2>
   
  <ul>
  <li><a href="#概要" id="toc-概要" class="nav-link active" data-scroll-target="#概要">概要</a>
  <ul class="collapse">
  <li><a href="#研究の立ち位置" id="toc-研究の立ち位置" class="nav-link" data-scroll-target="#研究の立ち位置">研究の立ち位置</a></li>
  <li><a href="#mala-とは" id="toc-mala-とは" class="nav-link" data-scroll-target="#mala-とは">MALA とは</a></li>
  <li><a href="#mala-のエルゴード性について" id="toc-mala-のエルゴード性について" class="nav-link" data-scroll-target="#mala-のエルゴード性について">MALA のエルゴード性について</a></li>
  </ul></li>
  <li><a href="#導入" id="toc-導入" class="nav-link" data-scroll-target="#導入"><span class="header-section-number">1</span> 導入</a>
  <ul class="collapse">
  <li><a href="#mcmc-手法の指数エルゴード性について" id="toc-mcmc-手法の指数エルゴード性について" class="nav-link" data-scroll-target="#mcmc-手法の指数エルゴード性について"><span class="header-section-number">1.1</span> MCMC 手法の指数エルゴード性について</a></li>
  <li><a href="#langevin-拡散について" id="toc-langevin-拡散について" class="nav-link" data-scroll-target="#langevin-拡散について"><span class="header-section-number">1.2</span> Langevin 拡散について</a></li>
  <li><a href="#指数収束する例" id="toc-指数収束する例" class="nav-link" data-scroll-target="#指数収束する例"><span class="header-section-number">1.3</span> 指数収束する例</a></li>
  <li><a href="#langevin-拡散-l_t-の離散近似" id="toc-langevin-拡散-l_t-の離散近似" class="nav-link" data-scroll-target="#langevin-拡散-l_t-の離散近似"><span class="header-section-number">1.4</span> Langevin 拡散 <span class="math inline">\(L_t\)</span> の離散近似</a></li>
  </ul></li>
  <li><a href="#langevin-拡散アルゴリズムの指数収束" id="toc-langevin-拡散アルゴリズムの指数収束" class="nav-link" data-scroll-target="#langevin-拡散アルゴリズムの指数収束"><span class="header-section-number">2</span> Langevin 拡散アルゴリズムの指数収束</a>
  <ul class="collapse">
  <li><a href="#一般の収束結果" id="toc-一般の収束結果" class="nav-link" data-scroll-target="#一般の収束結果"><span class="header-section-number">2.1</span> 一般の収束結果</a></li>
  <li><a href="#l_t-の指数エルゴード性" id="toc-l_t-の指数エルゴード性" class="nav-link" data-scroll-target="#l_t-の指数エルゴード性"><span class="header-section-number">2.2</span> <span class="math inline">\(L_t\)</span> の指数エルゴード性</a></li>
  <li><a href="#指数収束する例-1" id="toc-指数収束する例-1" class="nav-link" data-scroll-target="#指数収束する例-1"><span class="header-section-number">2.3</span> 指数収束する例</a></li>
  </ul></li>
  <li><a href="#ula-アルゴリズム" id="toc-ula-アルゴリズム" class="nav-link" data-scroll-target="#ula-アルゴリズム"><span class="header-section-number">3</span> ULA アルゴリズム</a></li>
  <li><a href="#mala-アルゴリズム" id="toc-mala-アルゴリズム" class="nav-link" data-scroll-target="#mala-アルゴリズム"><span class="header-section-number">4</span> MALA アルゴリズム</a></li>
  <li><a href="#結論" id="toc-結論" class="nav-link" data-scroll-target="#結論"><span class="header-section-number">5</span> 結論</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">6</span> References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
<p>$$</p>
<p>$$</p>
</div>
<section id="概要" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="概要">概要</h2>
<section id="研究の立ち位置" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="研究の立ち位置">研究の立ち位置</h3>
<p>MALA は <span class="citation" data-cites="Besag1994">(<a href="#ref-Besag1994" role="doc-biblioref">Besag, 1994</a>)</span> で提案され，<span class="citation" data-cites="Roberts-Tweedie1996">(<a href="#ref-Roberts-Tweedie1996" role="doc-biblioref">Gareth O. Roberts and Tweedie, 1996</a>)</span> で指数エルゴード性の必要十分条件が示されている．後の研究 <span class="citation" data-cites="Roberts-Rosenthal1998">(<a href="#ref-Roberts-Rosenthal1998" role="doc-biblioref">Gareth O. Roberts and Rosenthal, 1998</a>)</span> で最適スケーリングが論じられる．</p>
<div class="article-card-container">
  <div class="article-card">
    <a href="https://162348.github.io/posts/2024/Review/Roberts-Rosenthal1998.html" target="_blank">
      <img src="https://162348.github.io/posts/2024/Review/Roberts-Rosenthal1998.svg" alt="Article Image" class="article-image">
      <div class="article-content">
        <h3 class="article-title anchored">Roberts and Rosenthal (1998) Optimal Scaling of Discrete Approximations to Langevin Diffusions</h3>
        <p class="article-description">Roberts and Rosenthal [Journal of the Royal Statistical Society. Series B 60(1998) 255-268] は MALA (Metropolis-Adjusted Langevin Algorithm) の最適スケーリングを論じたもの．</p>
      </div>
    </a>
  </div>
</div>
<p><span class="citation" data-cites="Roberts-Tweedie1996">(<a href="#ref-Roberts-Tweedie1996" role="doc-biblioref">Gareth O. Roberts and Tweedie, 1996</a>)</span> は <span class="citation" data-cites="Roberts-Tweedie1996MH">(<a href="#ref-Roberts-Tweedie1996MH" role="doc-biblioref">G. O. Roberts and Tweedie, 1996</a>)</span> とセットである．後者はランダムウォーク MH に対象を限定して，指数エルゴード性がどのような含意を持つかを検証している（積率も指数収束するための条件，中心極限定理など）．</p>
</section>
<section id="mala-とは" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="mala-とは">MALA とは</h3>
<p>MALA は，提案核を対象分布 <span class="math inline">\(\pi\)</span> から Langevin 拡散の形で構成する，problem-specific な Metropolis-Hastings 法であり，ランダムウォーク MH よりも速く収束することが期待される．<span class="citation" data-cites="Corenflos-Finke2024">(<a href="#ref-Corenflos-Finke2024" role="doc-biblioref">Corenflos and Finke, 2024</a>)</span> でも state-of-the-art と呼ばれているサンプリング法である．</p>
<p><span class="citation" data-cites="Fearnhead+2018-PDMC">(<a href="#ref-Fearnhead+2018-PDMC" role="doc-biblioref">Fearnhead et al., 2018</a>)</span> において，MALA は BPS と比較されている．モデルは AR(1) を用いており，低次元ではほとんど変わらないが，高次元では BPS の方が自己相関時間が５倍良いという結論が得られている．</p>
<p>MALA の他に，<span class="citation" data-cites="Neal1994">(<a href="#ref-Neal1994" role="doc-biblioref">Neal, 1994</a>)</span> などの hybrid-Monte Carlo アルゴリズムも MALA と「提案核をよく考えている」という点で関係が深いが，本論文では扱わない．</p>
</section>
<section id="mala-のエルゴード性について" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="mala-のエルゴード性について">MALA のエルゴード性について</h3>
<p>Langevin 拡散 <span class="math display">\[
dL_t=dB_t+\frac{1}{2}\nabla\log\pi(L_t)dt
\]</span> は，例えば１次元では，尾部確率が指数減衰するならば，指数エルゴード性を持つ．つまり，<span class="math inline">\(\pi(x)\,\propto\,e^{-\gamma\lvert x\rvert^\beta}\;(\beta\ge1)\)</span> など．</p>
<p>このように，確率分布の裾の重さに影響されるという現象が普遍的である．</p>
<p>続いて，Langevin 拡散の離散化が，元の Langevin 拡散に収束するかどうかも別問題である．</p>
<p>最後に，Langevin 拡散の離散化を Metropolis 法によって修正したアルゴリズムである MALA が指数収束する条件を示す．</p>
</section>
</section>
<section id="導入" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="導入"><span class="header-section-number">1</span> 導入</h2>
<section id="mcmc-手法の指数エルゴード性について" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="mcmc-手法の指数エルゴード性について"><span class="header-section-number">1.1</span> MCMC 手法の指数エルゴード性について</h3>
<p><span class="citation" data-cites="Gelfand-Smith1990">(<a href="#ref-Gelfand-Smith1990" role="doc-biblioref">Gelfand and Smith, 1990</a>)</span> 以来，MH 法の利用が爆発している</p>
<blockquote class="blockquote">
<p>There has recently been a real explosion in the use of the Hastings and Metropolis algorithms</p>
</blockquote>
<p>乱歩 MH などは対象分布に依らずに実装できる汎用アルゴリズムであるが，対象分布の情報を取り入れて収束を高速にすることが考えられる．その例が MALA である．</p>
<p>Langevin 動力学は極めて優秀なモデリング手法であるが，シミュレーションのための離散化が入ることで，収束は遅くなるどころかそもそも収束性が失われることさえある．</p>
<p><span class="citation" data-cites="Neal1994">(<a href="#ref-Neal1994" role="doc-biblioref">Neal, 1994</a>)</span> を引用しながら，hybrid Monte Carlo が Langevin アルゴリズムに似ていると触れながら，話が対称性と非対称性の話に変わる．</p>
<blockquote class="blockquote">
<p>However, it is worth remarking that often methods induced by non-reversible methods can be shown to converge more quickly than their reversible counterparts (see, for example, <span class="citation" data-cites="Sheu1991">(<a href="#ref-Sheu1991" role="doc-biblioref">Sheu, 1991</a>)</span>).</p>
</blockquote>
<p>しかし <span class="citation" data-cites="Sheu1991">(<a href="#ref-Sheu1991" role="doc-biblioref">Sheu, 1991</a>)</span> は <span class="math inline">\(P_t\)</span> の評価を上下からしているのみで，非対称性どころか収束の議論は全くしていない．議論に飛躍があるか，引用が間違っているかが考えられる．</p>
</section>
<section id="langevin-拡散について" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="langevin-拡散について"><span class="header-section-number">1.2</span> Langevin 拡散について</h3>
<p>本論文が研究する MH 法は，提案を Langevin 拡散により取り入れたものである．</p>
<p>密度 <span class="math inline">\(\pi\)</span> が可微分であるとき，<span class="math inline">\(\nabla\log\pi\)</span> が考えられる．これに対して，Langevin 拡散 <span class="math inline">\(\{L_t\}\subset\mathbb{R}^k\)</span> とは <span class="math display">\[
dL_t=dW_t+\frac{1}{2}\nabla\log\pi(L_t)dt
\]</span> と定義される．</p>
<p><span class="math inline">\(\pi\)</span> が十分滑らかであるとき，これはエルゴード性を持つ： <span class="math display">\[
\|P^t_L(x,-)-\pi\|_\mathrm{TV}\to0.
\]</span></p>
<p>本論文では，この収束が指数レートで起こる場合，そして同様の積率収束も起こる場合に興味がある．</p>
</section>
<section id="指数収束する例" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="指数収束する例"><span class="header-section-number">1.3</span> 指数収束する例</h3>
<section id="次元クラス-mathcalebetagamma" class="level4" data-number="1.3.1">
<h4 data-number="1.3.1" class="anchored" data-anchor-id="次元クラス-mathcalebetagamma"><span class="header-section-number">1.3.1</span> １次元クラス <span class="math inline">\(\mathcal{E}(\beta,\gamma)\)</span></h4>
<p><span class="math inline">\(k=1\)</span> とする．<span class="math inline">\(\pi\in\mathcal{E}(\beta,\gamma)\subset C^\infty(\mathbb{R})\)</span> であるとは，可微分であり，加えてある <span class="math inline">\(x_0\in\mathbb{R}\)</span> と <span class="math inline">\(\gamma,\beta&gt;0\)</span> が存在して， <span class="math display">\[
\pi(x)\,\propto\,e^{-\gamma\lvert x\rvert^\beta},\quad\lvert x\rvert\ge x_0,
\]</span> が成り立つことをいう．このとき， <span class="math display">\[
\nabla\log\pi(x)=-\gamma\beta\operatorname{sgn}(x)\lvert x\rvert^{\beta-1},\quad\lvert x\rvert&gt;x_0.
\]</span></p>
<p>2.3 節にて，指数収束するための必要十分条件は <span class="math inline">\(\beta\ge1\)</span> であることを見る．この結論は乱歩 MH アルゴリズムと全く同様である <span class="citation" data-cites="Mengersen-Robert1996">(<a href="#ref-Mengersen-Robert1996" role="doc-biblioref">Mengersen and Robert, 1996, p. 定理3.5</a>)</span>．</p>
</section>
<section id="多次元指数分布族-mathcalp_m" class="level4" data-number="1.3.2">
<h4 data-number="1.3.2" class="anchored" data-anchor-id="多次元指数分布族-mathcalp_m"><span class="header-section-number">1.3.2</span> 多次元指数分布族 <span class="math inline">\(\mathcal{P}_m\)</span></h4>
<p><span class="citation" data-cites="Roberts-Tweedie1996MH">(<a href="#ref-Roberts-Tweedie1996MH" role="doc-biblioref">G. O. Roberts and Tweedie, 1996</a>)</span> で乱歩 MH 法について考えたように，多次元の統計モデルとしては指数分布族を考えることとする．特に，次の場合を考える： <span class="math display">\[
\pi(x)\,\propto\,e^{-p(x)}\quad \lvert x\rvert\ge x_0,
\]</span> ただし <span class="math inline">\(p\)</span> は <span class="math inline">\(m\)</span> 次の多項式で，次の表示を持つ： <span class="math display">\[
p=p_m+q_{m-1}.
\]</span> <span class="math inline">\(\pi\in\mathcal{P}_m\subset C^\infty(\mathbb{R}^k)\)</span> とは，<span class="math inline">\(p_m\xrightarrow{\lvert x\rvert\to\infty}\infty\)</span> を満たすことをいう．特に，<span class="math inline">\(m\ge2\)</span> であることに注意．</p>
</section>
</section>
<section id="langevin-拡散-l_t-の離散近似" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="langevin-拡散-l_t-の離散近似"><span class="header-section-number">1.4</span> Langevin 拡散 <span class="math inline">\(L_t\)</span> の離散近似</h3>
<p>実際の実装で <span class="math inline">\(L_t\)</span> をそのまま用いることは出来ず，これを離散化することが必要である．</p>
<section id="ula-unadjusted-langevin-algorithm" class="level4" data-number="1.4.1">
<h4 data-number="1.4.1" class="anchored" data-anchor-id="ula-unadjusted-langevin-algorithm"><span class="header-section-number">1.4.1</span> ULA (unadjusted Langevin algorithm)</h4>
<blockquote class="blockquote">
<p>The unadjusted Langevin algorithm (ULA) is a discrete-time Markov chain <span class="math inline">\(U_n\)</span> which is the natural discretization of ordinary Langevin diffusion <span class="math inline">\(L_t\)</span>.</p>
</blockquote>
<p><span class="citation" data-cites="Parisi1980">(<a href="#ref-Parisi1980" role="doc-biblioref">Parisi, 1980</a>)</span>, <span class="citation" data-cites="Grenander-Miller1994">(<a href="#ref-Grenander-Miller1994" role="doc-biblioref">Grenander and Miller, 1994</a>)</span> で考えられたものである．</p>
<p><span class="math display">\[
U_n\sim\mathrm{N}_k\left(U_{n-1}+\frac{h}{2}\nabla\log\pi(U_{n-1}),hI_k\right)
\]</span> によって構成できる． <span class="citation" data-cites="Besag1994">(<a href="#ref-Besag1994" role="doc-biblioref">Besag, 1994</a>)</span> が指摘したように，元の <span class="math inline">\(L_t\)</span> と似た（しかしステップサイズ <span class="math inline">\(h\)</span> に依存する変換を受けた）不変分布を持つ．</p>
<div class="callout callout-style-default callout-caution callout-titled" title="例">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
例
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math inline">\(\pi=\mathrm{N}_1(0,1)\)</span> であり，ステップサイズを <span class="math inline">\(h=2\)</span> とすると，<span class="math inline">\(\nabla\log\pi(x)\)</span>=-x$ であるから， <span class="math display">\[
U_{n-1}+\frac{h}{2}\nabla\log\pi(U_{n-1})=U_{n-1}-\frac{2}{2}\frac{U_{n-1}}{1}=0
\]</span> より，<span class="math inline">\(U_n\sim\mathrm{N}_1(0,2)\)</span> となる．</p>
</div>
</div>
</div>
</section>
<section id="mala-metropolis-adjusted-langevin-algorithm" class="level4" data-number="1.4.2">
<h4 data-number="1.4.2" class="anchored" data-anchor-id="mala-metropolis-adjusted-langevin-algorithm"><span class="header-section-number">1.4.2</span> MALA (Metropolis-Adjusted Langevin Algorithm)</h4>
<p><span class="citation" data-cites="Besag1994">(<a href="#ref-Besag1994" role="doc-biblioref">Besag, 1994</a>)</span> に従い，修正を加える．<span class="math inline">\(U_n\)</span> を提案として，Metropolis-Hastings 法を実行するのである．</p>
<p><span class="math display">\[
q(M_{n-1},-):=\mathrm{N}_k\left(M_{n-1}+\frac{1}{2}h\nabla\log\pi(M_{n-1}),hI_k\right)
\]</span> を提案核とし， <span class="math display">\[
\alpha(M_{n-1},U_n):=1\land\frac{\pi(U_n)q(U_n,M_{n-1})}{\pi(M_{n-1})q(M_{n-1},U_n)}
\]</span> を採択確率とする．</p>
<p>この場合，必ずエルゴード性が成り立つ．<span class="citation" data-cites="Roberts-Tweedie1996MH">(<a href="#ref-Roberts-Tweedie1996MH" role="doc-biblioref">G. O. Roberts and Tweedie, 1996</a>)</span> の結論と同様，<span class="math inline">\(\ell_k\)</span>-既約かつ周期的だからである．<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> 特に，殆ど至る所の <span class="math inline">\(x\in\mathbb{R}^k\)</span> について， <span class="math display">\[
\|P^n_M(x,-)-\pi\|_\mathrm{TV}\to0.
\]</span> また，本論文が提示する指数収束の条件の下では，任意の <span class="math inline">\(x\in\mathbb{R}^k\)</span> で起こる．</p>
<p>ULA が推移的であるとき，MALA も指数エルゴード性を持たないことが判る．だが，これは尾部確率が指数よりも重い場合にしか起こらない．</p>
</section>
<section id="malta-metropolis-adjusted-langevin-truncated-algorithm" class="level4" data-number="1.4.3">
<h4 data-number="1.4.3" class="anchored" data-anchor-id="malta-metropolis-adjusted-langevin-truncated-algorithm"><span class="header-section-number">1.4.3</span> MALTA (Metropolis-Adjusted Langevin Truncated Algorithm)</h4>
<p><span class="math display">\[
T_n\sim\mathrm{N}_k\biggr(M_{n-1}+R(M_{n-1}),hI_k\biggl)
\]</span> <span class="math display">\[
R(x):=\frac{D\nabla\log\pi(x)}{2(D\lor\lvert\nabla\log\pi(x)\rvert)}.
\]</span> を提案とし，MH 法を適用する．</p>
<p>MALTA は大変ロバストで，指数収束が起こりやすい．</p>
</section>
</section>
</section>
<section id="langevin-拡散アルゴリズムの指数収束" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="langevin-拡散アルゴリズムの指数収束"><span class="header-section-number">2</span> Langevin 拡散アルゴリズムの指数収束</h2>
<section id="一般の収束結果" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="一般の収束結果"><span class="header-section-number">2.1</span> 一般の収束結果</h3>
<p><span class="math display">\[
dL_t=dW_t+\frac{1}{2}\nabla\log\pi(L_t)dt
\]</span></p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定理2.1（Langevin 拡散のエルゴード性）">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定理2.1（Langevin 拡散のエルゴード性）
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(\nabla\log\pi\)</span> は <span class="math inline">\(C^1(\mathbb{R}^k)\)</span>-級で，<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> ある <span class="math inline">\(N,a,b&gt;0\)</span> が存在して <span class="math display">\[
\nabla\log\pi(x)\cdot x\le a\lvert x\rvert^2+b,\qquad\lvert x\rvert&gt;N,
\]</span> を満たすとする．このとき，Langevin 拡散 <span class="math inline">\(\{L_t\}\)</span> について次が成り立つ：</p>
<ol type="1">
<li><span class="math inline">\(L\)</span> は爆発的でなく，<span class="math inline">\(\ell_k\)</span>-既約で，周期的で，強 Feller であり，任意のコンパクト集合は小集合である．</li>
<li><span class="math inline">\(L\)</span> は <span class="math inline">\(\pi\)</span>-不変であり，任意の <span class="math inline">\(x\in\mathbb{R}^k\)</span> について <span class="math display">\[
\|P^t_L(x,-)-\pi\|_\mathrm{TV}\to0.
\]</span></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><span class="math inline">\(\lvert L_t\rvert\)</span> と OU 過程を比較することで，<span class="math inline">\(\lvert L_t\rvert\)</span> が爆発しないことが判る．</p>
<p>続いて，ドリフト係数が局所有界であるため，<span class="citation" data-cites="Bhattacharya1978">(<a href="#ref-Bhattacharya1978" role="doc-biblioref">Bhattacharya, 1978</a>)</span> と同様の議論により強 Feller である．加えて，<span class="math inline">\(\ell_k\)</span>-既約であることも判る．<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<blockquote class="blockquote">
<p>Theorem 2.1. <em>If, in addition to the hypothesis (A), <span class="math inline">\(a_{ij}(-)\)</span> and <span class="math inline">\(b_i(-)\)</span> are bounded on <span class="math inline">\(\mathbb{R}^k\)</span>, then for each <span class="math inline">\(x\)</span> in <span class="math inline">\(\mathbb{R}^k\)</span> there exists a unique probability measure <span class="math inline">\(P_x\)</span> on <span class="math inline">\((\Omega',\mathcal{M}')\)</span> such that (i) <span class="math inline">\(P_x(X_0=x)=1\)</span>, (ii) for every bounded real <span class="math inline">\(f\)</span> on <span class="math inline">\(\mathbb{R}^k\)</span> having bounded continuous first and second order derivatives, the process <span class="math inline">\(f(X_t)-\int^t_0Lf(X_s)ds\)</span> is a martingale under <span class="math inline">\(P_x\)</span>. Further, (a) <span class="math inline">\(X\)</span> is strong Markov and strong Feller, and (b) support of <span class="math inline">\(P_x\)</span> is <span class="math inline">\(\Omega_x':=\left\{\omega\in\Omega\mid\omega(0)=x\right\}\)</span>. <span class="citation" data-cites="Bhattacharya1978">(<a href="#ref-Bhattacharya1978" role="doc-biblioref">Bhattacharya, 1978</a>)</span></em></p>
</blockquote>
<p>任意の <span class="math inline">\(\ell_k\)</span>-正集合 <span class="math inline">\(A\subset\mathbb{R}^k\)</span> に対して， <span class="math display">\[
   \widetilde{A}:=\left\{\omega\in\Omega_x'\mid \omega(t)\in A\right\}
   \]</span> は <span class="math inline">\(P_x\)</span>-正集合である．実際，<span class="math inline">\(A\)</span> が <span class="math inline">\(\mathbb{R}^k\)</span> 上の開集合を含むために <span class="math inline">\(\widetilde{A}\)</span> は <span class="math inline">\(\Omega_x'\)</span> 上の開集合を含むので，<span class="math inline">\(P_x\)</span>-零であったら <span class="math inline">\(P_x\)</span> の台が <span class="math inline">\(\Omega_x'\)</span> 全体であることに矛盾する．これより，<span class="math inline">\(L_t\)</span> は <span class="math inline">\(A\)</span> に到達可能である．よって <span class="math inline">\(L_t\)</span> は <span class="math inline">\(\ell_k\)</span>-既約．</p>
<p>（強）Feller かつ <span class="math inline">\(\ell_k\)</span>-既約ならば，任意のコンパクト集合は小集合である <span class="citation" data-cites="Tweedie1994">(<a href="#ref-Tweedie1994" role="doc-biblioref">Tweedie, 1994, p. 定理5.1</a>)</span>．<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<p>非周期性は，任意のスケルトンも <span class="math inline">\(\ell_k\)</span>-既約であることから従う．<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p></li>
<li><p><span class="citation" data-cites="Ikeda-Watanabe1981">(<a href="#ref-Ikeda-Watanabe1981" role="doc-biblioref">Ikeda and Watanabe, 1981, p. 5.4節</a>)</span> により，<span class="math inline">\(\pi\)</span> は <span class="math inline">\(L\)</span> の不変分布であることが，生成作用素 <span class="math display">\[
   A_Lf(x)=\left(\frac{1}{2}\nabla\log\pi(x)\right)\cdot\nabla f(x)+\frac{1}{2}\mathop{}\!\mathbin\bigtriangleup f(x)
   \]</span> <span class="math display">\[
   f\in C^2(\mathbb{R}^k)
   \]</span> に関して，<span class="math inline">\((\pi|A_Lf)=0\;(f\in C^2(\mathbb{R}^k))\)</span> を満たすために従う．<span class="math inline">\(C^2(\mathbb{R}^k)\)</span> は，爆発しない拡散過程の生成作用素の核をなす．<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<p><span class="math inline">\(\ell_k\)</span>-既約な Makrov 過程であって不変確率分布を持つから，再帰的ではある．<span class="citation" data-cites="Meyn-Tweedie2009">(<a href="#ref-Meyn-Tweedie2009" role="doc-biblioref">S. Meyn and Tweedie, 2009, p. 172</a>)</span>定理8.0.1．これは，<span class="math inline">\(\psi\)</span>-既約な Markov 連鎖は再帰的であるか推移的であるかの２択だからである<span class="citation" data-cites="Tweedie1994">(<a href="#ref-Tweedie1994" role="doc-biblioref">Tweedie, 1994, p. 定理2.3</a>)</span>．</p>
<p><strong>また連続な過程であるから，これは Harris 再帰性を意味する．</strong></p>
<p>不変確率分布を持つ非周期的な Harris 再帰的な Markov 連鎖であるから，全変動収束が従う <span class="citation" data-cites="Meyn-Tweedie1993">(<a href="#ref-Meyn-Tweedie1993" role="doc-biblioref">S. P. Meyn and Tweedie, 1993, p. 定理6.1</a>)</span>．</p>
<blockquote class="blockquote">
<p><em>Proposition 6.1</em>. Suppose that <span class="math inline">\(\Phi\)</span> is positive Harris recurrent, and that some skeleton chain is irreducible. If <span class="math inline">\(C\)</span> is petite, then there exists a constant <span class="math inline">\(T&gt;0\)</span> and a non-trivial measure <span class="math inline">\(\mu\)</span> such that <span class="math inline">\(P^s(x,-)\ge\mu(-)\;(s\ge T,x\in C)\)</span>. <span class="citation" data-cites="Meyn-Tweedie1993">(<a href="#ref-Meyn-Tweedie1993" role="doc-biblioref">S. P. Meyn and Tweedie, 1993</a>)</span>_</p>
</blockquote></li>
</ol>
</div>
</div>
</div>
</section>
<section id="l_t-の指数エルゴード性" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="l_t-の指数エルゴード性"><span class="header-section-number">2.2</span> <span class="math inline">\(L_t\)</span> の指数エルゴード性</h3>
<section id="指数エルゴード性の必要条件" class="level4" data-number="2.2.1">
<h4 data-number="2.2.1" class="anchored" data-anchor-id="指数エルゴード性の必要条件"><span class="header-section-number">2.2.1</span> 指数エルゴード性の必要条件</h4>
<p><span class="math inline">\(V:\mathbb{R}^k\to[1,\infty)\)</span> に対して，<strong><span class="math inline">\(V\)</span>-一様エルゴード的</strong> であるとは，任意の <span class="math inline">\(x\in\mathbb{R}^k\)</span> に対して，ある <span class="math inline">\(R&gt;0,\rho\in(0,1)\)</span> が存在して <span class="math display">\[
\|P^t_L(x,-)-\pi\|_V\le V(x)R\rho^t,\qquad t\ge0,
\]</span> が成り立つことをいう．ただし， <span class="math display">\[
\|A\|_V:=\sup_{\lvert f\rvert\le V}\int_{\mathbb{R}^k}f(x)A(dx).
\]</span></p>
<p><span class="citation" data-cites="Meyn-Tweedie2009">(<a href="#ref-Meyn-Tweedie2009" role="doc-biblioref">S. Meyn and Tweedie, 2009, pp. 336–337</a>)</span> 第 14 章にいう <span class="math inline">\(f\)</span>-エルゴード性に当たる概念であることに注意．<span class="math inline">\(V\)</span>-一様エルゴード性は第 16 章で別の意味に使われている．</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定理2.2（Langevin 拡散の指数エルゴード性）">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定理2.2（Langevin 拡散の指数エルゴード性）
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(\nabla\log\pi\)</span> は <span class="math inline">\(C^1(\mathbb{R}^k)\)</span>-級で，ある <span class="math inline">\(N,a,b&gt;0\)</span> が存在して <span class="math display">\[
\nabla\log\pi(x)\cdot x\le a\lvert x\rvert^2+b,\qquad\lvert x\rvert&gt;N,
\]</span> を満たすとする．このとき，Langevin 拡散 <span class="math inline">\(\{L_t\}\)</span> について次が成り立つ：</p>
<ol type="1">
<li>任意の <span class="math inline">\(V\in C^2(\mathbb{R}^k)\)</span> であって，<span class="math inline">\(V\ge1\)</span> かつ，ある <span class="math inline">\(b,c&gt;0\)</span> と非空コンパクト集合 <span class="math inline">\(C\overset{\textrm{cpt}}{\subset}\mathbb{R}^k\)</span> とについて <span class="math display">\[
A_LV\le-cV+b1_C
\]</span> を満たすものについて，<span class="math inline">\(V\)</span>-一様エルゴード的である．</li>
<li><span class="math inline">\(L\)</span> が指数エルゴード的ならば，ある非空コンパクト集合 <span class="math inline">\(C\overset{\textrm{cpt}}{\subset}\mathbb{R}^k\)</span> について，ある <span class="math inline">\(\kappa&gt;1,\delta&gt;0\)</span> が存在して，任意のスタート地点 <span class="math inline">\(x\in \mathbb{R}^k\)</span> について， <span class="math display">\[
\sup_{x\in C}\operatorname{E}[\kappa^{\tau_C^\delta}]&lt;\infty,
\]</span> <span class="math display">\[
\tau^\delta_C:=\inf\left\{t\ge\delta\mid L_t\in C\right\}.
\]</span></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>非空コンパクト集合 <span class="math inline">\(C\overset{\textrm{cpt}}{\subset}\mathbb{R}^k\)</span> は小集合であるから，これは成り立つ．<span class="citation" data-cites="Meyn-Tweedie2009">(<a href="#ref-Meyn-Tweedie2009" role="doc-biblioref">S. Meyn and Tweedie, 2009, pp. 336–337</a>)</span> 定理 14.0.1 が Markov 連鎖に関して与えている消息である．</p></li>
<li><p>任意の <span class="math inline">\(\delta&gt;0\)</span> について，<span class="math inline">\(\delta\)</span>-スケルトンも幾何エルゴード的である．この <span class="math inline">\(\delta\)</span>-スケルトンに関する <span class="math inline">\(C\)</span> への到着時刻は <span class="math inline">\(\tau^\delta_C\)</span> よりも必ず大きくなる．</p>
<p><span class="math inline">\(L_t\)</span> は強 Feller であるから，<span class="math inline">\(C\)</span> は <span class="math inline">\(\delta\)</span>-スケルトンに関しても小集合である．あとは，Markov 連鎖に関する幾何エルゴード定理より従う．<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p></li>
</ol>
</div>
</div>
</div>
</section>
<section id="指数エルゴード性の十分条件" class="level4" data-number="2.2.2">
<h4 data-number="2.2.2" class="anchored" data-anchor-id="指数エルゴード性の十分条件"><span class="header-section-number">2.2.2</span> 指数エルゴード性の十分条件</h4>
<p><span class="math inline">\(-\nabla\log\pi=O(\lvert x\rvert^{2k-1})\;(\lvert x\rvert\to\infty)\)</span> としたとき，後述の定理 2.4 の条件である <span class="math inline">\(k&lt;1/2\)</span> を満たさない限り，<span class="math inline">\(k\ge1/2\)</span> まで指数エルゴード性は成り立ち続ける．<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定理2.3（Langevin 拡散の指数エルゴード性）">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定理2.3（Langevin 拡散の指数エルゴード性）
</div>
</div>
<div class="callout-body-container callout-body">
<p>ある <span class="math inline">\(S&gt;0\)</span> が存在して， <span class="math inline">\(\lvert x\rvert\ge S\)</span> 上で <span class="math inline">\(\pi\)</span> は有界であるとする．加えて，ある <span class="math inline">\(d\in(0,1)\)</span> が存在して <span class="math display">\[
\liminf_{\lvert x\rvert\to\infty}(1-d)\lvert\nabla\log\pi(x)\rvert^2+\nabla^2\log\pi(x)&gt;0
\]</span> を満たすならば，<span class="math inline">\(\{L_t\}\)</span> は指数エルゴード的である．</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>上の定理の 1. のドリフト条件を示せば良い．<span class="math inline">\(V=\pi^{-d}\;(0&lt;d&lt;1)\)</span> と取れば良い．このとき， <span class="math display">\[
2A_LV=V\biggr(\lvert\nabla\log\pi\rvert^2(d^2-d)-d\nabla^2\log\pi\biggl).
\]</span></p>
</div>
</div>
</div>
</section>
<section id="指数エルゴード性が成り立たないとき" class="level4" data-number="2.2.3">
<h4 data-number="2.2.3" class="anchored" data-anchor-id="指数エルゴード性が成り立たないとき"><span class="header-section-number">2.2.3</span> 指数エルゴード性が成り立たないとき</h4>
<p>指数エルゴード性が成り立たない場合は，返ってこない時，棄却率が高すぎる時，急に動く場合の３つが考えられる．</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定理2.4（Langevin 拡散が指数エルゴード性を失うとき）">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定理2.4（Langevin 拡散が指数エルゴード性を失うとき）
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(\lvert\nabla\log\pi(x)\rvert\to0\)</span> ならば，<span class="math inline">\(\{L_t\}\)</span> は指数エルゴード的でない．</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>上の定理の 2. と矛盾させれば良い．幾何エルゴード的だと仮定し，コンパクトな Kendall 集合 <span class="math inline">\(C\overset{\textrm{cpt}}{\subset}\mathbb{R}^k\)</span> が存在するとする： <span class="math display">\[
\sup_{x\in C}\operatorname{E}[\kappa^{\tau^\delta_C}]&lt;\infty.
\]</span> ある <span class="math inline">\(R&gt;0\)</span> が存在して， <span class="math display">\[
\lvert\nabla\log\pi(x)\rvert\le2(\log\kappa)^{1/2}\quad(\lvert x\rvert\ge R).
\]</span> このとき，<span class="math inline">\(S\ge\sup_{x\in C}\lvert x\rvert\lor R\)</span> を取り，<span class="math inline">\(\lvert y\rvert\ge2S\)</span> を満たす地点 <span class="math inline">\(y\in\mathbb{R}^k\)</span> からスタートしたとすると，<span class="math inline">\(Z_t:=\lvert L_t\rvert\)</span> は，<span class="math inline">\(a(x)&gt;-(\log\kappa)^{1/2}\;(\lvert x\rvert&gt;S)\)</span> を満たす係数について <span class="math display">\[
dZ_t=dW_t+a(L_t)dt
\]</span> を満たす．<span class="math inline">\(B_t:=W_t-(\log\kappa)^{1/2}t\)</span> とし，それぞれの過程の <span class="math inline">\(S\)</span> への到着時刻 <span class="math inline">\(\sigma(Z),\sigma(B)\)</span> を考えると，<span class="math inline">\(\sigma(Z)\ge\sigma(B)\;\;\text{a.s.}\)</span> が成り立つ．このとき， <span class="math display">\[\begin{align*}
  \operatorname{P}_y[\tau_C&gt;t]&amp;\ge\operatorname{P}_y[\sigma(Z)&gt;t]\\
  &amp;\ge\operatorname{P}_y[\sigma(B)&gt;t]\\
  &amp;\ge\Phi\left(\frac{-S+t(\log\kappa)^{1/2}}{\sqrt{t}}\right)-e^{2S(\log\kappa)^{1/2}}\Phi\left(\frac{-S-t(\log\kappa)^{1/2}}{\sqrt{t}}\right).
\end{align*}\]</span> 最後の式は Bachelier-Lévy の公式による．<span class="math inline">\(\sigma(B)\)</span> の密度を <span class="math inline">\(f\)</span> とすると， <span class="math display">\[
\frac{\log f(t)}{t}\to-\frac{\log\kappa}{2}.
\]</span> これは矛盾を起こすらしい．</p>
</div>
</div>
</div>
</section>
</section>
<section id="指数収束する例-1" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="指数収束する例-1"><span class="header-section-number">2.3</span> 指数収束する例</h3>
<section id="次元クラス-mathcalebetagamma-1" class="level4" data-number="2.3.1">
<h4 data-number="2.3.1" class="anchored" data-anchor-id="次元クラス-mathcalebetagamma-1"><span class="header-section-number">2.3.1</span> １次元クラス <span class="math inline">\(\mathcal{E}(\beta,\gamma)\)</span></h4>
</section>
<section id="多次元指数分布族-mathcalp_m-1" class="level4" data-number="2.3.2">
<h4 data-number="2.3.2" class="anchored" data-anchor-id="多次元指数分布族-mathcalp_m-1"><span class="header-section-number">2.3.2</span> 多次元指数分布族 <span class="math inline">\(\mathcal{P}_m\)</span></h4>
</section>
</section>
</section>
<section id="ula-アルゴリズム" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="ula-アルゴリズム"><span class="header-section-number">3</span> ULA アルゴリズム</h2>
</section>
<section id="mala-アルゴリズム" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="mala-アルゴリズム"><span class="header-section-number">4</span> MALA アルゴリズム</h2>
</section>
<section id="結論" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="結論"><span class="header-section-number">5</span> 結論</h2>
</section>
<section id="references" class="level2" data-number="6">




</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">6 References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Besag1994" class="csl-entry" role="listitem">
Besag, J. E. (1994). <a href="https://www.jstor.org/stable/2346184"><span class="nocase">Comments on <span>“Representations of Knowledge in Complex Systems”</span> by U. Grenander and M. I. Miller</span></a>. <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, <em>56</em>(4), 591–592.
</div>
<div id="ref-Bhattacharya1978" class="csl-entry" role="listitem">
Bhattacharya, R. N. (1978). <a href="https://doi.org/10.1214/aop/1176995476"><span class="nocase">Criteria for Recurrence and Existence of Invariant Measures for Multidimensional Diffusions</span></a>. <em>The Annals of Probability</em>, <em>6</em>(4), 541–553.
</div>
<div id="ref-Corenflos-Finke2024" class="csl-entry" role="listitem">
Corenflos, A., and Finke, A. (2024). <a href="https://arxiv.org/abs/2401.14868">Particle-MALA and particle-mGRAD: Gradient-based MCMC methods for high-dimensional state-space models</a>.
</div>
<div id="ref-Fearnhead+2018-PDMC" class="csl-entry" role="listitem">
Fearnhead, P., Bierkens, J., Pollock, M., and Roberts, G. O. (2018). <a href="https://www.jstor.org/stable/26771007">Piecewise deterministic markov processes for continuous-time monte carlo</a>. <em>Statistical Science</em>, <em>33</em>(3), 386–412.
</div>
<div id="ref-Gelfand-Smith1990" class="csl-entry" role="listitem">
Gelfand, A. E., and Smith, A. F. M. (1990). <a href="https://doi.org/10.2307/2289776">Sampling-based approaches to calculating marginal densities</a>. <em>Journal of the American Statistical Association</em>, <em>85</em>(410), 398–409.
</div>
<div id="ref-Grenander-Miller1994" class="csl-entry" role="listitem">
Grenander, U., and Miller, M. I. (1994). <a href="http://www.jstor.org/stable/2346184">Representations of knowledge in complex systems</a>. <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, <em>56</em>(4), 549–603.
</div>
<div id="ref-Hairer2021-Convergence" class="csl-entry" role="listitem">
Hairer, M. (2021). <em><a href="https://www.hairer.org/notes/Convergence.pdf">Convergence of markov processes</a></em>.
</div>
<div id="ref-Ikeda-Watanabe1981" class="csl-entry" role="listitem">
Ikeda, N., and Watanabe, S. (1981). <em><a href="https://doi.org/10.1016/S0924-6509(08)70217-4">Stochastic differential equations and diffusion processes</a></em>,Vol. 24. Elsevier.
</div>
<div id="ref-Mengersen-Robert1996" class="csl-entry" role="listitem">
Mengersen, K. L., and Robert, C. P. (1996). <a href="https://academic.oup.com/book/54042/chapter-abstract/422209682">Testing for mixtures: A bayesian entropic approach</a>. In <em>Bayesian statistics 5: Proceedings of the fifth valencia international meetings</em>, pages 255–276.
</div>
<div id="ref-Meyn-Tweedie1993" class="csl-entry" role="listitem">
Meyn, S. P., and Tweedie, R. L. (1993). <a href="http://www.jstor.org/stable/1427521">Stability of markovian processes II: Continuous-time processes and sampled chains</a>. <em>Advances in Applied Probability</em>, <em>25</em>(3), 487–517.
</div>
<div id="ref-Meyn-Tweedie2009" class="csl-entry" role="listitem">
Meyn, S., and Tweedie, R. L. (2009). <em><a href="https://doi.org/10.1017/CBO9780511626630">Markov chains and stochastic stability</a></em>. Cambridge University Press.
</div>
<div id="ref-Neal1994" class="csl-entry" role="listitem">
Neal, R. M. (1994). <a href="https://doi.org/10.1006/jcph.1994.1054">An improved acceptance procedure for the hybrid monte carlo algorithm</a>. <em>Journal of Computational Physics</em>, <em>111</em>(1), 194–203.
</div>
<div id="ref-Parisi1980" class="csl-entry" role="listitem">
Parisi, G. (1980). <a href="https://doi.org/10.1088/0305-4470/13/4/009">A sequence of approximated solutions to the s-k model for spin glasses</a>. <em>Journal of Physics A: Mathematical and General</em>, <em>13</em>(4), L115.
</div>
<div id="ref-Roberts-Rosenthal1998" class="csl-entry" role="listitem">
Roberts, Gareth O., and Rosenthal, J. S. (1998). <a href="http://www.jstor.org/stable/2985986">Optimal scaling of discrete approximations to langevin diffusions</a>. <em>Journal of the Royal Statistical Society. Series B (Statistical Methodology)</em>, <em>60</em>(1), 255–268.
</div>
<div id="ref-Roberts-Tweedie1996" class="csl-entry" role="listitem">
Roberts, Gareth O., and Tweedie, R. L. (1996). <a href="https://www.jstor.org/stable/3318418">Exponential convergence of langevin distributions and their discrete approximations</a>. <em>Bernoulli</em>, <em>2</em>(4), 341–363.
</div>
<div id="ref-Roberts-Tweedie1996MH" class="csl-entry" role="listitem">
Roberts, G. O., and Tweedie, R. L. (1996). <a href="http://www.jstor.org/stable/2337435">Geometric convergence and central limit theorems for multidimensional hastings and metropolis algorithms</a>. <em>Biometrika</em>, <em>83</em>(1), 95–110.
</div>
<div id="ref-Sheu1991" class="csl-entry" role="listitem">
Sheu, S.-J. (1991). <a href="http://www.jstor.org/stable/2244362">Some estimates of the transition density of a nondegenerate diffusion markov process</a>. <em>The Annals of Probability</em>, <em>19</em>(2), 538–561.
</div>
<div id="ref-Tweedie1994" class="csl-entry" role="listitem">
Tweedie, R. L. (1994). <a href="https://doi.org/10.1007/BF00994264">Topological conditions enabling use of harris methods in discrete and continuous time</a>. <em>Acta Applicandae Mathematica</em>, <em>34</em>(1), 175–188.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Doob の定理から，で良くないか？<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><span class="math inline">\(\log\pi\)</span> が <span class="math inline">\(C^1\)</span>-級，の間違いでは？<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>これは，Langevin 拡散の分布は <span class="math inline">\(\left\{\omega\in C(\mathbb{R}_+;\mathbb{R}^k)\mid\omega(0)=x\right\}\)</span> 全体を台に持つから，<span class="math inline">\(\ell_k\)</span> と同値な分布を持つことになることが<span class="citation" data-cites="Bhattacharya1978">(<a href="#ref-Bhattacharya1978" role="doc-biblioref">Bhattacharya, 1978</a>)</span> 定理2.1で触れられている．すると，<span class="math inline">\(\ell_k\)</span>-非零集合は必ず到達可能である．<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p><span class="citation" data-cites="Meyn-Tweedie2009">(<a href="#ref-Meyn-Tweedie2009" role="doc-biblioref">S. Meyn and Tweedie, 2009, p. 124</a>)</span> 第６章がこのテーマを扱っている．定理6.0.1の(iii)は <span class="math inline">\(\psi\)</span>-既約な Feller Markov 過程が <span class="math inline">\((\mathrm{supp}\;\psi)^\circ\ne\emptyset\)</span> であるとき，<span class="math inline">\(T\)</span>-連鎖であること，(ii)は <span class="math inline">\(\psi\)</span>-既約な <span class="math inline">\(T\)</span>-連鎖は任意のコンパクト集合を petite にすることを述べている．<span class="citation" data-cites="Tweedie1994">(<a href="#ref-Tweedie1994" role="doc-biblioref">Tweedie, 1994, p. 定理5.1</a>)</span> は連続過程について述べているが結局「<span class="citation" data-cites="Meyn-Tweedie2009">(<a href="#ref-Meyn-Tweedie2009" role="doc-biblioref">S. Meyn and Tweedie, 2009</a>)</span>と同様に示せる」としか言っていない．最後に，既約かつ非周期的ならば，任意の petite 集合は小さい．<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p><span class="math inline">\(\ell_k\)</span> と <span class="math inline">\(L_t\)</span> の分布が同値であるから，任意の <span class="math inline">\(\ell_k\)</span>-正集合には，任意のスケルトンが到達可能であるはずである．このことは周期性を破る．<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>分布を定める (distribution-determining class)という言い方をしている．<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>例えば <span class="citation" data-cites="Meyn-Tweedie2009">(<a href="#ref-Meyn-Tweedie2009" role="doc-biblioref">S. Meyn and Tweedie, 2009, p. 定理15.0.1</a>)</span>．<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p><span class="citation" data-cites="Hairer2021-Convergence">(<a href="#ref-Hairer2021-Convergence" role="doc-biblioref">Hairer, 2021, p. 34</a>)</span> など．<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/162348\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="162348/162348.github.io" data-repo-id="R_kgDOKlfKYQ" data-category="Announcements" data-category-id="DIC_kwDOKlfKYc4CgDmb" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" data-loading="lazy" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://162348.github.io/">
<p>Hirofumi Shiba</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/162348/162348.github.io/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ano2math5">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:shiba.hirofumi@ism.ac.jp">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../../blog.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>