<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="司馬博文">

<title>Hirofumi Shiba - Zig-Zag サンプラーのサブサンプリングによるスケーラビリティ</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../assets/profile.jpg" rel="icon" type="image/jpeg">
<script src="../../../site_libs/quarto-listing/list.min.js"></script>
<script src="../../../site_libs/quarto-listing/quarto-listing.js"></script>
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "?",
    "H"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>

  window.document.addEventListener("DOMContentLoaded", function (_event) {
    const listingTargetEl = window.document.querySelector('#listing-lst-listing .list');
    if (!listingTargetEl) {
      // No listing discovered, do not attach.
      return; 
    }

    const options = {
      valueNames: ['listing-title','listing-image','listing-date','listing-subtitle',{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
      
      searchColumns: ["listing-title","listing-author","listing-date","listing-image","listing-description"],
    };

    window['quarto-listings'] = window['quarto-listings'] || {};
    window['quarto-listings']['listing-lst-listing'] = new List('listing-lst-listing', options);

    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  });

  window.addEventListener('hashchange',() => {
    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  })
  </script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-36GX2G6GLL"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-36GX2G6GLL', { 'anonymize_ip': true});
</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Zen+Kurenaido&amp;display=swap" rel="stylesheet">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=BIZ+UDPGothic&amp;display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../assets/styles.css">
<meta property="og:title" content="Hirofumi Shiba - Zig-Zag サンプラーのサブサンプリングによるスケーラビリティ">
<meta property="og:description" content="Zig-Zag サンプラーは，その非対称なダイナミクスにより，収束が速くなることが期待されている MCMC 手法である．それだけでなく，対数尤度の勾配に対する不偏推定量をサブサンプリングにより構成することで，ベイズ推論においてサンプルサイズに依らない一定のコストで効率的な事後分布からのサンプリングが可能である．">
<meta property="og:image" content="https://162348.github.io/posts/2024/Stat/MeanOfGaussian.svg">
<meta property="og:site_name" content="Hirofumi Shiba">
<meta name="twitter:title" content="Hirofumi Shiba - Zig-Zag サンプラーのサブサンプリングによるスケーラビリティ">
<meta name="twitter:description" content="Zig-Zag サンプラーは，その非対称なダイナミクスにより，収束が速くなることが期待されている MCMC 手法である．それだけでなく，対数尤度の勾配に対する不偏推定量をサブサンプリングにより構成することで，ベイズ推論においてサンプルサイズに依らない一定のコストで効率的な事後分布からのサンプリングが可能である．">
<meta name="twitter:image" content="https://162348.github.io/posts/2024/Stat/MeanOfGaussian.svg">
<meta name="twitter:creator" content="@ano2math5">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Hirofumi Shiba</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Sessions.html"> 
<span class="menu-text">Sessions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Japanese.html"> 
<span class="menu-text">自己紹介</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
    <a href="https://github.com/162348/162348.github.io/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Zig-Zag サンプラーのサブサンプリングによるスケーラビリティ</h1>
            <p class="subtitle lead">大規模モデル・大規模データに対する MCMC を目指して</p>
                                <div class="quarto-categories">
                <div class="quarto-category">MCMC</div>
                <div class="quarto-category">Computation</div>
                <div class="quarto-category">Julia</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>司馬博文 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">7/18/2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">7/23/2024</p>
      </div>
    </div>
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="block-title">概要</div>
      Zig-Zag サンプラーは，その非対称なダイナミクスにより，収束が速くなることが期待されている MCMC 手法である．それだけでなく，対数尤度の勾配に対する不偏推定量をサブサンプリングにより構成することで，ベイズ推論においてサンプルサイズに依らない一定のコストで効率的な事後分布からのサンプリングが可能である．
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目次</h2>
   
  <ul>
  <li><a href="#対数尤度の勾配を不変推定する" id="toc-対数尤度の勾配を不変推定する" class="nav-link active" data-scroll-target="#対数尤度の勾配を不変推定する"><span class="header-section-number">1</span> 対数尤度の勾配を不変推定する</a></li>
  <li><a href="#サブサンプリングを取り入れた-zig-zag-サンプラー" id="toc-サブサンプリングを取り入れた-zig-zag-サンプラー" class="nav-link" data-scroll-target="#サブサンプリングを取り入れた-zig-zag-サンプラー"><span class="header-section-number">2</span> サブサンプリングを取り入れた Zig-Zag サンプラー</a></li>
  <li><a href="#sec-ZZ-CV" id="toc-sec-ZZ-CV" class="nav-link" data-scroll-target="#sec-ZZ-CV"><span class="header-section-number">3</span> 制御変数による分散低減</a></li>
  <li><a href="#zz-cv-のスケーリング" id="toc-zz-cv-のスケーリング" class="nav-link" data-scroll-target="#zz-cv-のスケーリング"><span class="header-section-number">4</span> ZZ-CV のスケーリング</a></li>
  <li><a href="#数値実験mse-の比較" id="toc-数値実験mse-の比較" class="nav-link" data-scroll-target="#数値実験mse-の比較"><span class="header-section-number">5</span> 数値実験：MSE の比較</a></li>
  <li><a href="#mala-との比較" id="toc-mala-との比較" class="nav-link" data-scroll-target="#mala-との比較"><span class="header-section-number">6</span> MALA との比較</a></li>
  <li><a href="#非一様な部分サンプリング" id="toc-非一様な部分サンプリング" class="nav-link" data-scroll-target="#非一様な部分サンプリング"><span class="header-section-number">7</span> 非一様な部分サンプリング</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
<p>$$</p>
<p>$$</p>
</div>
<div id="listing-lst-listing" class="listing quarto-float quarto-listing quarto-listing-container-grid">
<div class="list grid quarto-listing-cols-3">
<div class="g-col-1" data-index="0" data-categories="Process,Sampling,Julia,MCMC" data-listing-date-sort="1719932400000" data-listing-file-modified-sort="1723447877091" data-listing-date-modified-sort="1721228400000" data-listing-reading-time-sort="14" data-listing-word-count-sort="2767">
<a href="../../../posts/2024/Process/ZigZag.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top"><img src="../Process/ZigZag2D_Gaussian.svg" style="height: 150px;"  class="thumbnail-image card-img"/></p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
Zig-Zag 過程によるサンプリング
</h5>
<div class="card-subtitle listing-subtitle">
ジャンプと確定的な動きによる新たな MCMC 手法
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-07-03
</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="1" data-categories="Bayesian,Computation,Python,MCMC,Statistics" data-listing-date-sort="1720710000000" data-listing-file-modified-sort="1724916755806" data-listing-date-modified-sort="1721228400000" data-listing-reading-time-sort="10" data-listing-word-count-sort="1912">
<a href="../../../posts/2024/Stat/Logistic.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img src="../../../posts/2024/Stat/Logistic_WhiteBackground.svg" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
大規模な不均衡データに対するロジスティック回帰（前編）
</h5>
<div class="card-subtitle listing-subtitle">
離散時間 MCMC から連続時間 MCMC へ
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-07-12
</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="2" data-categories="Bayesian,Computation,Python,MCMC" data-listing-date-sort="1721228400000" data-listing-file-modified-sort="1724911982349" data-listing-date-modified-sort="1721660400000" data-listing-reading-time-sort="22" data-listing-word-count-sort="4282">
<a href="../../../posts/2024/Stat/Logistic2.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img src="../../../posts/2024/Stat/Logistic2.svg" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
大規模な不均衡データに対するロジスティック回帰（後編）
</h5>
<div class="card-subtitle listing-subtitle">
離散時間 MCMC から連続時間 MCMC へ
</div>
<div class="card-attribution card-text-small end">
<div class="listing-date">
2024-07-18
</div>
</div>
</div>
</div>
</a>
</div>
</div>
<div class="listing-no-matching d-none">
No matching items
</div>
</div>
<!-- ## Subsampling Technology -->
<p>MCMC の計算複雑性のボトルネックは，尤度の評価にある．各ステップで全てのデータを用いて尤度を計算する必要がある点が，MCMC を深層学習などの大規模データの設定への応用を難しくしている <span class="citation" data-cites="Murphy2023">(<a href="#ref-Murphy2023" role="doc-biblioref">Murphy, 2023, p. 647</a>)</span>．</p>
<p>サブサンプリングが可能であることと，複数の効率的なサブサンプリング法の提案により，Zig-Zag 過程は次世代のサンプラーとして圧倒的なスケーラビリティ（Super Efficient Bayesian Inference <span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens et al., 2019</a>)</span>）を示すのではないかと期待されている．<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<section id="対数尤度の勾配を不変推定する" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="対数尤度の勾配を不変推定する"><span class="header-section-number">1</span> 対数尤度の勾配を不変推定する</h2>
<p><span class="math inline">\(p(x)\)</span> を事前分布，<span class="math inline">\(p(y|x)\)</span> を観測のモデル（または尤度）とし，データ <span class="math inline">\(y_1,\cdots,y_n\)</span> は互いに独立であるとする．</p>
<p>このとき，事後分布 <span class="math inline">\(\pi(x):=p(x|y)\)</span> と Hamiltonian <span class="math inline">\(U\)</span> は次のように表せる： <span class="math display">\[
\pi(x)\,\propto\,\left(\prod_{k=1}^n p(y_k|x)\right)p(x)
\]</span> <span class="math display">\[\begin{align*}
   U(x)&amp;=-\sum_{k=1}^n\log p(y_k|x)-\log p(x)\\
   &amp;=\frac{1}{n}\sum_{k=1}^n\biggr(-n\log p(y_k|x)-\log p(x)\biggl)=:\frac{1}{n}\sum_{k=1}^nU^k(x).
\end{align*}\]</span></p>
<p>このとき，<span class="math inline">\(U\)</span> の導関数 <span class="math inline">\(\partial_i U(x)\)</span> は，独立な観測 <span class="math inline">\(y_1,\cdots,y_n\)</span> について項別微分をして平均をとったものに等しい： <span id="eq-decomposition-of-DU"><span class="math display">\[
\partial_iU(x)=\frac{1}{n}\sum_{k=1}^nE^k_i(x),
\tag{1}\]</span></span> <span class="math display">\[
E^k_i(x):=\partial_iU^k(x)=\frac{\partial }{\partial x_i}\biggr(-n\log p(y_k|x)-\log p(x)\biggl).
\]</span></p>
<p>よって，精度は劣るかもしれないが，一様に選んだ <span class="math inline">\(K\sim\mathrm{U}([n])\)</span> から定まる <span class="math inline">\(E^K_i\)</span> の値は <span class="math inline">\(\partial_i U(x)\)</span> の不偏推定量となっている．この発想により，ZZ-SS という新たなアルゴリズムを構成できる．</p>
</section>
<section id="サブサンプリングを取り入れた-zig-zag-サンプラー" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="サブサンプリングを取り入れた-zig-zag-サンプラー"><span class="header-section-number">2</span> サブサンプリングを取り入れた Zig-Zag サンプラー</h2>
<p>この各 <span class="math inline">\(E^K_i\)</span> が定める強度関数 <span class="math display">\[
m^K_i(t):=\biggr(\theta E^K_i(x+\theta t)\biggl)_+=\biggr(\theta\partial_iU^K(x+\theta t)\biggl)_+
\]</span> を用いた Zig-Zag サンプラーを <span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens et al., 2019</a>)</span> では <strong>ZZ-SS</strong> (Zig-Zag with Sub-Sampling) と呼んでいる．</p>
<p><span class="math display">\[
\max_{k\in[n]}m^k_i\le M_i
\]</span> を満たす連続関数 <span class="math inline">\(M_i\)</span> を用いて次のようにシミュレーションすることができる：</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[@Bierkens+2019 p.1303 アルゴリズム３]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens et al., 2019, p. 1303</a> アルゴリズム３)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>代理強度関数 <span class="math inline">\(M_1,\cdots,M_d\)</span> を持つ互いに独立な <span class="math inline">\(\mathbb{R}_+\)</span> 上の非一様 Poisson 点過程の到着時刻 <span class="math inline">\(T_1,\cdots,T_d\)</span> をシミュレーションする．</li>
<li>最初に到着した座標番号 <span class="math inline">\(j:=\operatorname*{argmin}_{i\in[d]}T_i\)</span> について，確率 <span class="math display">\[
\frac{m^K_j(T_j)}{M_j(T_j)},\qquad K\sim\mathrm{U}([n]),
\]</span> で時刻 <span class="math inline">\(T_j\)</span> に速度成分 <span class="math inline">\(\theta_j\)</span> の符号を反転させる．</li>
<li>１に <span class="math inline">\(t=T_j\)</span> として戻って，繰り返す．</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="部分サンプリングにより不変分布が変わらないことの証明^[[@Vasdekis2021 p.25] や [@Bierkens+2019 p.1302 定理4.1] も参照．]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
部分サンプリングにより不変分布が変わらないことの証明<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>ZZ-SS によってシミュレートされる過程は，レート関数 <span class="math display">\[
\lambda_i(x,\theta)=\operatorname{E}[(\theta E^K_i(x))_+]=\frac{1}{n}\sum_{k=1}^n(\theta E^k_i(x))_+
\]</span> を持った Zig-Zag 過程に等しい</p>
<p>これは，元々のレート関数に対して， <span class="math display">\[
\gamma_i(x,\theta):=\frac{1}{n}\sum_{k=1}^n(\theta_iE^k_i(x))_+-\left(\theta_i\frac{1}{n}\sum_{k=1}^nE^k_i(x)\right)_+
\]</span> という項を加えて得る Zig-Zag サンプラーともみなすことができる．非負性は関数 <span class="math inline">\((x)_+:=x\lor0\)</span> の凸性から従う．最後に <span class="math inline">\(\gamma_i(x,\theta)=\gamma_i(x,F_i(\theta))\)</span> を確認すれば良い．</p>
<p>これは <span class="math display">\[\begin{align*}
  &amp;\qquad\frac{1}{n}\sum_{k=1}^n\biggr(\theta_iE_i^k(x)\biggl)_+-\frac{1}{n}\sum_{k=1}^n\biggr(-\theta_iE_i^k(x)\biggl)_+\\
  &amp;=\frac{1}{n}\sum_{k=1}^n\left((\theta_iE_i^k(x))_+-(-\theta_iE_i^k(x))_+\right)=\frac{1}{n}\sum_{k=1}^n\theta_iE_i^k(x)
\end{align*}\]</span> であることから従う．</p>
<p>こうして，サブサンプリングの実行による精度の劣化が，<span class="citation" data-cites="Andrieu-Livingstone2021">(<a href="#ref-Andrieu-Livingstone2021" role="doc-biblioref">Andrieu and Livingstone, 2021</a>)</span> の枠組みで捉えられる，ということでもある（レート関数が増加したので，スイッチングイベントが増え，diffusive な動きが増加する）．</p>
</div>
</div>
</div>
<p>例えば <span class="math inline">\(p(y_k|x)\)</span> が Cauchy 密度であるなど <span class="math inline">\(\partial_iU\)</span> が有界であるとき，<span class="math inline">\(M_i:=\max_{x\in\mathbb{R}^d}\partial_iU(x)\)</span> などと選ぶことができる．<span class="math inline">\(M_i\)</span> をより <span class="math inline">\(\partial_iU\)</span> に近く選ぶほど剪定の効率は上がるが，<span class="math inline">\(M_i\)</span> を複雑にしすぎると今度は <span class="math inline">\(M_i\)</span> を強度とする Poisson 点過程のシミュレーションが困難になる．</p>
<p>そのため，ZZ-SS では代理レート関数 <span class="math inline">\(M_i\)</span> は大きく取る必要があり，尤度関数の評価の回数が増える．そのため，アルゴリズムの計算複雑性は上がっていることに注意 <span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens et al., 2019, p. 1302</a> 第４節)</span>．</p>
</section>
<section id="sec-ZZ-CV" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="sec-ZZ-CV"><span class="header-section-number">3</span> 制御変数による分散低減</h2>
<p><span class="math inline">\(\partial_iU(x)\)</span> が Lipschitz 連続であるとき，<span class="math inline">\(E_i^k\)</span> をある参照点 <span class="math inline">\(\partial_iU(x_*)\)</span> とそこからの乖離と取ることで <span class="math inline">\(n\to\infty\)</span> の極限で分散が抑えられる．</p>
<p>こうすることで，<span class="math inline">\(M_i\)</span> を１次関数としたまま，より小さく <span class="math inline">\(E_i^k\)</span> にフィットするように取ることができる．</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題
</div>
</div>
<div class="callout-body-container callout-body">
<p>任意の <span class="math inline">\(i\in[d]\)</span> について，ある <span class="math inline">\(C_i&gt;0\)</span> が存在して， <span class="math display">\[
\lvert\partial_iU(x)-\partial_iU(y)\rvert\le C_i\lvert x-y\rvert,\quad(x,y)\in\mathbb{R}^{2d},
\]</span> が成り立つとする．このとき， <span class="math display">\[
M_i(t):=a_i+b_it
\]</span> <span class="math display">\[
a_i:=(\theta_i\partial_iU(x_*))_++C_i\|x-x_*\|_p,\quad b_i:=C_id^{1/p}
\]</span> と定めれば， <span class="math display">\[
m_i^k\le M_i
\]</span> が成り立つ．ただし， <span class="math display">\[
\partial_iU(x)=\frac{1}{n}\sum_{k=1}^nE^k_i(x),\tag{1}
\]</span> <span class="math display">\[
E^k_i(x):=\partial_iU(x_*)+\partial_iU^k(x)-\partial_iU^k(x_*),
\]</span> <span class="math display">\[
m^k_i(t):=\biggr(\theta E_i^k(x+\theta t)\biggl)_+,
\]</span> とした．</p>
</div>
</div>
<p>この仮定は例えば <span class="math inline">\(\partial_iU\)</span> が有界な導関数を持つならば成り立つ．<span class="math inline">\(p(y_k|x)\)</span> が Gauss 密度であるやさらに裾が重いときは成り立つ．</p>
<p>次のようにして参照点 <span class="math inline">\(x_*\)</span> を選ぶ事前処理を行うことで，<strong>データのサイズに依存しない計算複雑性で事後分布からの正確なサンプリングが可能</strong>になる．</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="preprocessing for ZZ-CV">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
preprocessing for ZZ-CV
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><span class="math inline">\(x_*:=\operatorname*{argmin}_{x\in\mathbb{R}^d}U(x)\)</span> を探索する．</li>
<li><span class="math inline">\(\partial_iU(x_*),\partial_iU^k(x_*)\)</span> を計算する．</li>
</ol>
<p>この２つはいずれも <span class="math inline">\(O(n)\)</span> の複雑性で実行できる．</p>
</div>
</div>
</section>
<section id="zz-cv-のスケーリング" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="zz-cv-のスケーリング"><span class="header-section-number">4</span> ZZ-CV のスケーリング</h2>
<p>このとき，<span class="math inline">\(x_*\)</span> を定める事前処理が，<span class="math inline">\(\widehat{x}\)</span> を最尤推定量として， <span class="math display">\[
\|x_*-\widehat{x}\|_p=O(n^{-1/2})\quad(n\to\infty)
\]</span> 程度の正確性があれば，事後分布の最尤推定量周りの漸近展開 <span class="citation" data-cites="Johnson1970">(<a href="#ref-Johnson1970" role="doc-biblioref">Johnson, 1970</a>)</span> を通じて， <span class="math display">\[
\|x-x_*\|_p=O_p(n^{-1/2})\quad(n\to\infty)
\]</span> <span class="math display">\[
\partial_iU(x_*)=O_p(n^{1/2})\quad(n\to\infty)
\]</span> が成り立つ．</p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="Zig-Zag 過程のスケーリング^[[@Bierkens+2019 pp.1306-] 第5.1節参照．]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zig-Zag 過程のスケーリング<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>事後分布に対する Zig-Zag 過程は，<span class="math inline">\(\sqrt{n}\)</span> だけ時間を加速したものが <span class="math inline">\(\mathrm{N}_d(0,i(x_0))\)</span> を標的にする Zig-Zag 過程に収束するから，<span class="math inline">\(O(n^{-1/2})\)</span> のタイムステップで区切ってサンプルとすることができる．</p>
<p>しかし <span class="math display">\[
\max_{k\in[n]}\biggr(\theta_i\partial_iU^k(x+\theta t)\biggl)_+\le M_i
\]</span> を満たす <span class="math inline">\(M_i\)</span> は <span class="math inline">\(O(n^{\alpha})\;(\alpha\ge1/2)\)</span> のスケールで増大していく．</p>
<p>各スイッチングイベントにおいて，全データにアクセスする <span class="math inline">\(O(n)\)</span> の計算複雑性が必要であるから，総じて <span class="math inline">\(O(n^{\alpha+1/2})\)</span> の計算複雑性となる．</p>
</div>
</div>
</div>
<p>ZZ-CV が平衡に至っている場合は <span class="math inline">\(x\)</span> はほとんど <span class="math inline">\(x_*\)</span> に集積するため， <span class="math display">\[
\lvert E^k_i(x)\rvert=\biggl|\partial_iU(x_*)+\partial_iU^k(x)-\partial_iU^k(x_*)\biggr|=O(n^{1/2})
\]</span> が成り立つ．よってこれを抑える <span class="math inline">\(M_i\)</span> も <span class="math inline">\(O(n^{1/2})\)</span> で済み，必要以上に大きい代理レート関数を用意して剪定する必要がない．</p>
<p>全データにアクセスする <span class="math inline">\(O(n)\)</span> のステップもないために，事前処理 <a href="#sec-ZZ-CV" class="quarto-xref">3</a> と十分平衡に至っているとみなせるまでの burn-in を除いて，<span class="math inline">\(O(1)\)</span> の計算複雑性でサンプリングが可能である．このことを <span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens et al., 2019</a>)</span> は super-efficiency と呼ぶ．</p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="更なるスケーラブル手法の可能性（事後分布が集中する場合のみ？）">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
更なるスケーラブル手法の可能性（事後分布が集中する場合のみ？）
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>他に，事後分布の集中領域でうまくスイッチング回数が抑えられる <span class="math inline">\(\lambda_i\)</span> が構成できたならば，低い計算複雑性を達成できるだろう．</p>
<p>ZZ-CV では，これに事後分布の Gauss 近似を用いたことになる．</p>
<p>また，<span class="math inline">\(U\)</span> の２階微分が有界でない場合，この枠組みが使えない．実際，<span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens et al., 2019, pp. 1315 第6.5節</a>)</span> ではこの場合での数値実験の結果が示されており，事後分布が集積しないために super-efficiency は得られていない．</p>
<p>参照点 <span class="math inline">\(x_*\)</span> を複数取る拡張なども <span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens et al., 2019, p. 第7節</a>)</span> で考えられている．</p>
</div>
</div>
</div>
</section>
<section id="数値実験mse-の比較" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="数値実験mse-の比較"><span class="header-section-number">5</span> 数値実験：MSE の比較</h2>
<p>ある Gauss 分布に従うデータを生成する： <span class="math display">\[
Y^j\overset{\text{iid}}{\sim}\mathrm{N}(x_0,\sigma^2),\qquad j\in[n],
\]</span> 分散 <span class="math inline">\(\sigma^2\)</span> は既知として，位置母数 <span class="math inline">\(x\in\mathbb{R}\)</span> を推定する問題を考える．</p>
<p>事前分布を <span class="math inline">\(\mathrm{N}(0,\rho^2)\)</span> とすると，定数の違いを除いて <span class="math display">\[\begin{align*}
    U(x)&amp;=\frac{x^2}{2\rho^2}+\frac{1}{2\sigma^2}\sum_{j=1}^n(x-y^j)^2\\
    &amp;=\frac{1}{n}\sum_{j=1}^n\left(\frac{x^2}{2\rho^2}+\frac{n}{2\sigma^2}(x-y^j)^2\right)=:\frac{1}{n}\sum_{j=1}^nU^j(x)
\end{align*}\]</span> であるから， <span class="math display">\[\begin{align*}
    U'(x)&amp;=\frac{x}{\rho^2}+\frac{1}{\sigma^2}\sum_{j=1}^n(x-y^j)\\
    &amp;=\frac{x}{\rho^2}+\frac{n}{\sigma^2}(x-\overline{y}),
\end{align*}\]</span> <span class="math display">\[
U''(x)=\frac{1}{\rho^2}+\frac{n}{\sigma^2}.
\]</span></p>
<p>従って，Zig-Zag 過程のイベントの強度関数は <span class="math display">\[\begin{align*}
    m(t)&amp;=\biggr(\theta U'(x+\theta t)\biggl)_+\\
    &amp;=\left(\frac{\theta(x+\theta t)}{\rho^2}+\frac{\theta}{\sigma^2}\sum_{j=1}^n(x+\theta t-y^j)\right)_+\\
    &amp;=\left(\frac{\theta x}{\rho^2}+\frac{\theta}{\sigma^2}\sum_{j=1}^n(x-y^j)+t\left(\frac{1}{\rho^2}+\frac{n}{\sigma^2}\right)\right)_+
\end{align*}\]</span> と表せ，これは１次関数 <span class="math inline">\((a+bt)_+\)</span> の形であるから直接のシミュレーションが可能である．<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<div id="2e803eff" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>サブサンプリングなしの Zig-Zag 過程のシミュレーションをする関数 ZZ() を定義</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ZigZagBoomerang</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">λ</span>(∇U, x, θ, F<span class="op">::</span><span class="dt">ZigZag1d</span>) <span class="op">=</span> <span class="fu">pos</span>(<span class="fu">θ*∇U</span>(x)) <span class="co"># rate function on E</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">λ_bar</span>(τ, a, b) <span class="op">=</span> <span class="fu">pos</span>(a <span class="op">+</span> b<span class="op">*</span>τ)  <span class="co"># affine proxy</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="st">`x`: current location, `θ`: current velocity, `t`: current time,</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">move_forward</span>(τ, t, x, θ, <span class="op">::</span><span class="dt">ZigZag1d</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    τ <span class="op">+</span> t, x <span class="op">+</span> θ<span class="op">*</span>τ , θ</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="st">    `∇U`: gradient of the negative log-density</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="st">    `(x,θ)`: initial state</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="st">    `T`: Time Horizon    </span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="st">    `a+bt`: computational bound for intensity m(t)</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="st">    `num`: ポアソン時刻に到着した回数</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="st">    `acc`: 受容回数．`acc/num` は acceptance rate</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">ZZ</span>(∇U, x<span class="op">::</span><span class="dt">Float64</span>, θ<span class="op">::</span><span class="dt">Float64</span>, T<span class="op">::</span><span class="dt">Float64</span>, y, Flow<span class="op">::</span><span class="dt">ZigZagBoomerang.ContinuousDynamics</span>; rng<span class="op">=</span><span class="bu">Random</span>.GLOBAL_RNG, ab<span class="op">=</span>ab_ZZ)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> <span class="fu">zero</span>(T)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    Ξ <span class="op">=</span> [(t, x, θ)]</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    num <span class="op">=</span> acc <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    epoch_list <span class="op">=</span> [num]</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    a, b <span class="op">=</span> <span class="fu">ab</span>(x, θ, Flow)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    t′ <span class="op">=</span>  t <span class="op">+</span> <span class="fu">poisson_time</span>(a, b, <span class="fu">rand</span>())  <span class="co"># イベントは a,b が定める affine proxy に従って生成する</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> t <span class="op">&lt;</span> T</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        τ <span class="op">=</span> t′ <span class="op">-</span> t</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>        t, x, θ <span class="op">=</span> <span class="fu">move_forward</span>(τ, t, x, θ, Flow)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>        l, lb <span class="op">=</span> <span class="fu">λ</span>(∇U, x, θ, Flow), <span class="fu">λ_bar</span>(τ, a, b)  <span class="co"># λ が真のレート, λ_bar が affine proxy</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        num <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="fu">rand</span>()<span class="op">*</span>lb <span class="op">&lt;</span> l</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>            acc <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> l <span class="op">&gt;</span> lb <span class="op">+</span> <span class="fl">0.01</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>                <span class="fu">println</span>(l<span class="op">-</span>lb)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>            θ <span class="op">=</span> <span class="op">-</span>θ</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(Ξ, (t, x, θ))</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(epoch_list, num)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>        a, b <span class="op">=</span> <span class="fu">ab</span>(x, θ, Flow)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>        t′ <span class="op">=</span> t <span class="op">+</span> <span class="fu">poisson_time</span>(a, b, <span class="fu">rand</span>())</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Ξ, epoch_list, acc<span class="op">/</span>num</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="f66360e5" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>今回の設定に応じたレート関数 (a+bt)+ を用意</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pos</span>(x) <span class="op">=</span> <span class="fu">max</span>(<span class="fu">zero</span>(x), x)  <span class="co"># positive part</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">a</span>(x, θ, ρ, σ, y) <span class="op">=</span> θ <span class="op">*</span> x <span class="op">/</span> ρ<span class="op">^</span><span class="fl">2</span> <span class="op">+</span> (θ<span class="op">/</span>σ<span class="op">^</span><span class="fl">2</span>) <span class="op">*</span> <span class="fu">sum</span>(x <span class="op">.-</span> y)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">b</span>(x, θ, ρ, σ, y) <span class="op">=</span> ρ<span class="op">^</span>(<span class="op">-</span><span class="fl">2</span>) <span class="op">+</span> <span class="fu">length</span>(y)<span class="op">/</span>σ<span class="op">^</span><span class="fl">2</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>ρ, σ, x0, θ<span class="fl">0</span> <span class="op">=</span> <span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>n1, n2 <span class="op">=</span> <span class="fl">100</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">4</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>TrueDistribution <span class="op">=</span> <span class="fu">Normal</span>(x0, σ)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> <span class="fu">rand</span>(TrueDistribution, n1)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> <span class="fu">rand</span>(TrueDistribution, n2)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># computational bounds for intensity m(t)</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ab_ZZ_n1</span>(x, θ, <span class="op">::</span><span class="dt">ZigZag1d</span>) <span class="op">=</span> (<span class="fu">a</span>(x, θ, ρ, σ, y1), <span class="fu">b</span>(x, θ, ρ, σ, y1))</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ab_ZZ_n2</span>(x, θ, <span class="op">::</span><span class="dt">ZigZag1d</span>) <span class="op">=</span> (<span class="fu">a</span>(x, θ, ρ, σ, y2), <span class="fu">b</span>(x, θ, ρ, σ, y2))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">∇U1</span>(x) <span class="op">=</span> x<span class="op">/</span>ρ<span class="op">^</span><span class="fl">2</span> <span class="op">+</span> (<span class="fu">length</span>(y1)<span class="op">/</span>σ<span class="op">^</span><span class="fl">2</span>) <span class="op">*</span> (x <span class="op">-</span> <span class="fu">mean</span>(y1)) </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="fu">∇U2</span>(x) <span class="op">=</span> x<span class="op">/</span>ρ<span class="op">^</span><span class="fl">2</span> <span class="op">+</span> (<span class="fu">length</span>(y2)<span class="op">/</span>σ<span class="op">^</span><span class="fl">2</span>) <span class="op">*</span> (x <span class="op">-</span> <span class="fu">mean</span>(y2)) </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># T = 2500.0</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># trace_ZZ1, epochs_ZZ1, acc_ZZ1 = ZZ(∇U1, x0, θ0, T, ZigZag1d(); ab=ab_ZZ_n1)</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># trace_ZZ2, num_ZZ2, acc_ZZ2 = ZZ(∇U2, x0, θ0, T, ZigZag1d(); ab=ab_ZZ_n2)</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co"># dt = 0.01</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># traj_ZZ1 = discretize(trace_ZZ1, ZigZag1d(), dt)</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co"># traj_ZZ2 = discretize(trace_ZZ2, ZigZag1d(), dt)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="29d9a63a" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>N 回 ZZ() を実行して，その事後平均の MSE を計算する関数 experiment() を定義</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">SquaredError</span>(sample<span class="op">::</span><span class="dt">Vector{Float64}</span>, y)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    True_Posterior_Mean <span class="op">=</span> <span class="fu">sum</span>(y) <span class="op">/</span> (<span class="fu">length</span>(y) <span class="op">+</span> <span class="fl">1</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="fu">mean</span>(sample) <span class="op">-</span> True_Posterior_Mean)<span class="op">^</span><span class="fl">2</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="st">    epoch_list: 注目するエポック数のリスト</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="st">    N: 実験回数</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">experiment</span>(epoch_list, T, dt, N, ∇U, x0, θ<span class="fl">0</span>, y, Sampler; ab<span class="op">=</span>ab_ZZ_n1)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    SE_sum <span class="op">=</span> <span class="fu">zero</span>(epoch_list)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    acc_list <span class="op">=</span> []</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>N</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        trace_ZZ1, epochs_ZZ1, acc_ZZ1 <span class="op">=</span> <span class="fu">Sampler</span>(∇U, x0, θ<span class="fl">0</span>, T, y, <span class="fu">ZigZag1d</span>(); ab<span class="op">=</span>ab)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">push!</span>(acc_list, acc_ZZ1)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        traj_ZZ1 <span class="op">=</span> <span class="fu">discretize</span>(trace_ZZ1, <span class="fu">ZigZag1d</span>(), dt)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        SE_list <span class="op">=</span> []</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> T <span class="kw">in</span> epoch_list</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>            epoch <span class="op">=</span> <span class="fu">findfirst</span>(x <span class="op">-&gt;</span> x <span class="op">&gt;</span> T, epochs_ZZ1) <span class="op">-</span> <span class="fl">1</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>            t <span class="op">=</span> <span class="fu">findfirst</span>(x <span class="op">-&gt;</span> x <span class="op">&gt;</span> trace_ZZ1[epoch][<span class="fl">1</span>], traj_ZZ1.t) <span class="op">-</span> <span class="fl">1</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>            SE <span class="op">=</span> <span class="fu">SquaredError</span>(traj_ZZ1.x[<span class="fl">1</span><span class="op">:</span>t], y)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(SE_list, SE)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>        SE_sum <span class="op">+=</span> SE_list</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> SE_sum <span class="op">./</span> N, <span class="fu">mean</span>(acc_list)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="d9dcbbb8" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>実験の実行</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="fl">3000.0</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>epoch_list <span class="op">=</span> [<span class="fl">10.0</span>, <span class="fl">100.0</span>, <span class="fl">1000.0</span>, <span class="fl">10000.0</span>]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">11</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>MSE_ZZ1, acc <span class="op">=</span> <span class="fu">experiment</span>(epoch_list, T, dt, N, ∇U1, x0, θ<span class="fl">0</span>, y1, ZZ; ab<span class="op">=</span>ab_ZZ_n1)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fu">plot</span>(<span class="co">#epoch_list, MSE_ZZ1,</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    xscale<span class="op">=:</span>log10,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    yscale<span class="op">=:</span>log10,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"epochs"</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="st">"MSE"</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    ,background_color <span class="op">=</span> <span class="st">"#F0F1EB"</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter!</span>(p, epoch_list, MSE_ZZ1,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    marker<span class="op">=:</span>circle,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    markersize<span class="op">=</span><span class="fl">5</span>,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    markeralpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#78C2AD"</span>,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="cn">nothing</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">GLM</span>, <span class="bu">DataFrames</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="fu">DataFrame</span>(X <span class="op">=</span> <span class="fu">log10</span>.(epoch_list), Y <span class="op">=</span> <span class="fu">log10</span>.(MSE_ZZ1))</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">lm</span>(<span class="pp">@formula</span>(Y <span class="op">~</span> X), df)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>X_pred <span class="op">=</span> <span class="fu">range</span>(<span class="fu">minimum</span>(df.X), <span class="fu">maximum</span>(df.X), length<span class="op">=</span><span class="fl">100</span>)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>Y_pred <span class="op">=</span> <span class="fu">predict</span>(model, <span class="fu">DataFrame</span>(X <span class="op">=</span> X_pred))</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(p, <span class="fl">10</span> <span class="op">.^</span> X_pred, <span class="fl">10</span> <span class="op">.^</span> Y_pred,</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=:</span>solid,</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    linewidth<span class="op">=</span><span class="fl">2</span>,</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#78C2AD"</span>,</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">"ZZ"</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="co"># display(p)</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Average acceptance rate: </span><span class="sc">$</span>acc<span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Average acceptance rate: 1.0</code></pre>
</div>
</div>
<p>より，たしかに剪定なしの正確なシミュレーションができている．</p>
<p>一方で， <span class="math display">\[
U^j(x):=\frac{x^2}{2\rho^2}+\frac{n}{2\sigma^2}(x-y^j)^2,
\]</span> <span class="math display">\[
\lambda^j(x,\theta):=\biggr(\theta(U^j)'(x)\biggl)_+
\]</span> としてサブサンプリングを取り入れることを考えるが，これを同じ <span class="math inline">\((a+bt)_+\)</span> ではバウンド出来ない：</p>
<div id="e8560f93" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>ZZ-SS (ZigZag with Subsampling) の定義</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">λj</span>(j,x,θ,y) <span class="op">=</span> <span class="fu">pos</span>(θ <span class="op">*</span> (x<span class="op">/</span>ρ<span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fu">length</span>(y)<span class="op">/</span>σ<span class="op">^</span><span class="fl">2</span> <span class="op">*</span> (x <span class="op">-</span> y[j])))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">ZZ_SS</span>(∇U, x<span class="op">::</span><span class="dt">Float64</span>, θ<span class="op">::</span><span class="dt">Float64</span>, T<span class="op">::</span><span class="dt">Float64</span>, y, Flow<span class="op">::</span><span class="dt">ZigZagBoomerang.ContinuousDynamics</span>; rng<span class="op">=</span><span class="bu">Random</span>.GLOBAL_RNG, ab<span class="op">=</span>ab_ZZ)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> <span class="fu">zero</span>(T)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    Ξ <span class="op">=</span> [(t, x, θ)]</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    num <span class="op">=</span> acc <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    epoch_list <span class="op">=</span> [num]</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    a, b <span class="op">=</span> <span class="fu">ab</span>(x, θ, Flow)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    t′ <span class="op">=</span>  t <span class="op">+</span> <span class="fu">poisson_time</span>(a, b, <span class="fu">rand</span>())  <span class="co"># イベントは a,b が定める affine proxy に従って生成する</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> t <span class="op">&lt;</span> T</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        τ <span class="op">=</span> t′ <span class="op">-</span> t</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        t, x, θ <span class="op">=</span> <span class="fu">move_forward</span>(τ, t, x, θ, Flow)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>        j <span class="op">=</span> <span class="fu">rand</span>(<span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(y))</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        l, lb <span class="op">=</span> <span class="fu">λj</span>(j, x, θ, y), <span class="fu">λ_bar</span>(τ, a, b)  <span class="co"># λ が真のレート, λ_bar が affine proxy</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        num <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="fu">rand</span>()<span class="op">*</span>lb <span class="op">&lt;</span> l</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> l <span class="op">&gt;</span> lb <span class="op">+</span> <span class="fl">0.01</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>                <span class="co"># println(l-lb)</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>                acc <span class="op">+=</span> <span class="fl">1</span>  <span class="co">#  overflow を数えるように変更済み！注意！</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>            θ <span class="op">=</span> <span class="op">-</span>θ</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(Ξ, (t, x, θ))</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(epoch_list, num)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>        a, b <span class="op">=</span> <span class="fu">ab</span>(x, θ, Flow)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>        t′ <span class="op">=</span> t <span class="op">+</span> <span class="fu">poisson_time</span>(a, b, <span class="fu">rand</span>())</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Ξ, epoch_list, acc<span class="op">/</span>num</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="98500789" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>実験の実行</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LaTeXStrings</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>MSE_ZZ_SS, acc <span class="op">=</span> <span class="fu">experiment</span>(epoch_list, T, dt, N, ∇U1, x0, θ<span class="fl">0</span>, y1, ZZ_SS; ab<span class="op">=</span>ab_ZZ_n1)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(L<span class="st">"上界 </span><span class="sc">$</span>(a<span class="op">+</span>bt)<span class="st">_+$ を超えてしまう平均的割合: "</span>, <span class="st">"</span><span class="sc">$</span>acc<span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>上界 $(a+bt)_+$ を超えてしまう平均的割合: 0.5004529049425432</code></pre>
</div>
</div>
<p>しかし，ZZ-CV アルゴリズムではこのようなことは起こらない．実際，次の等式が成り立つ： <span class="math display">\[
U'(x_*)+(U^j)'(x)-(U^j)'(x_*)=U'(x),\qquad x,x_*\in\mathbb{R}.
\]</span></p>
<p>このモデルにおける MAP 推定量は <span class="math display">\[
\widehat{x}:=\frac{\overline{y}}{1+\frac{\sigma^2}{n\rho^2}}
\]</span> である．</p>
<div id="7bfbdc3a" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>ZZ-CV (ZigZag with Control Variates) の定義</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x_star <span class="op">=</span> <span class="fu">mean</span>(y1) <span class="op">/</span> (<span class="fl">1</span> <span class="op">+</span> σ<span class="op">^</span><span class="fl">2</span><span class="op">/</span>(<span class="fu">length</span>(y1) <span class="op">*</span> ρ<span class="op">^</span><span class="fl">2</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">C</span>(ρ, σ, y) <span class="op">=</span> ρ<span class="op">^</span>(<span class="op">-</span><span class="fl">2</span>) <span class="op">+</span> <span class="fu">length</span>(y)<span class="op">/</span>σ<span class="op">^</span><span class="fl">2</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">a</span>(x, θ, ρ, σ, y) <span class="op">=</span> <span class="fu">pos</span>(<span class="fu">θ*∇U1</span>(x_star)) <span class="op">+</span> <span class="fu">C</span>(ρ, σ, y) <span class="op">*</span> <span class="fu">abs</span>(x <span class="op">-</span> x_star)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">b</span>(x, θ, ρ, σ, y) <span class="op">=</span> <span class="fu">C</span>(ρ, σ, y)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># New Computational Bounds for ZZ-CV</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ab_ZZ_CV</span>(x, θ, <span class="op">::</span><span class="dt">ZigZag1d</span>) <span class="op">=</span> (<span class="fu">a</span>(x, θ, ρ, σ, y1), <span class="fu">b</span>(x, θ, ρ, σ, y1))</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">ZZ_CV</span>(∇U, x<span class="op">::</span><span class="dt">Float64</span>, θ<span class="op">::</span><span class="dt">Float64</span>, T<span class="op">::</span><span class="dt">Float64</span>, y, Flow<span class="op">::</span><span class="dt">ZigZagBoomerang.ContinuousDynamics</span>; rng<span class="op">=</span><span class="bu">Random</span>.GLOBAL_RNG, ab<span class="op">=</span>ab_ZZ_CV)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> <span class="fu">zero</span>(T)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    Ξ <span class="op">=</span> [(t, x, θ)]</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    num <span class="op">=</span> acc <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    epoch_list <span class="op">=</span> [num]</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    a, b <span class="op">=</span> <span class="fu">ab</span>(x, θ, Flow)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    t′ <span class="op">=</span>  t <span class="op">+</span> <span class="fu">poisson_time</span>(a, b, <span class="fu">rand</span>())  <span class="co"># イベントは a,b が定める affine proxy に従って生成する</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> t <span class="op">&lt;</span> T</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>        τ <span class="op">=</span> t′ <span class="op">-</span> t</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>        t, x, θ <span class="op">=</span> <span class="fu">move_forward</span>(τ, t, x, θ, Flow)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># j = rand(1:length(y))  # 今回はたまたま要らない</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>        l, lb <span class="op">=</span><span class="fu">λ</span>(∇U, x, θ, Flow), <span class="fu">λ_bar</span>(τ, a, b)  <span class="co"># λ が真のレート, λ_bar が affine proxy</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>        num <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="fu">rand</span>()<span class="op">*</span>lb <span class="op">&lt;</span> l</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>            acc <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> l <span class="op">&gt;</span> lb <span class="op">+</span> <span class="fl">0.01</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>                <span class="fu">println</span>(l<span class="op">-</span>lb)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>            θ <span class="op">=</span> <span class="op">-</span>θ</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(Ξ, (t, x, θ))</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(epoch_list, num)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>        a, b <span class="op">=</span> <span class="fu">ab</span>(x, θ, Flow)</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>        t′ <span class="op">=</span> t <span class="op">+</span> <span class="fu">poisson_time</span>(a, b, <span class="fu">rand</span>())</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Ξ, epoch_list, acc<span class="op">/</span>num</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="6e066767" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>実験の実行</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>MSE_ZZ_CV, acc <span class="op">=</span> <span class="fu">experiment</span>(epoch_list, T, dt, N, ∇U1, x0, θ<span class="fl">0</span>, y1, ZZ_CV; ab<span class="op">=</span>ab_ZZ_CV)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> <span class="fu">scatter</span>(p, epoch_list, MSE_ZZ_CV,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    marker<span class="op">=:</span>circle,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    markersize<span class="op">=</span><span class="fl">5</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    markeralpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#E95420"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="cn">nothing</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="fu">DataFrame</span>(X <span class="op">=</span> <span class="fu">log10</span>.(epoch_list), Y <span class="op">=</span> <span class="fu">log10</span>.(MSE_ZZ_CV))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">lm</span>(<span class="pp">@formula</span>(Y <span class="op">~</span> X), df)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>X_pred <span class="op">=</span> <span class="fu">range</span>(<span class="fu">minimum</span>(df.X), <span class="fu">maximum</span>(df.X), length<span class="op">=</span><span class="fl">100</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>Y_pred <span class="op">=</span> <span class="fu">predict</span>(model, <span class="fu">DataFrame</span>(X <span class="op">=</span> X_pred))</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(q, <span class="fl">10</span> <span class="op">.^</span> X_pred, <span class="fl">10</span> <span class="op">.^</span> Y_pred,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=:</span>dash,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    linewidth<span class="op">=</span><span class="fl">2</span>,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#E95420"</span>,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">"ZZ-CV (without amendment)"</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="576" height="384" viewbox="0 0 2304 1536">
<defs>
  <clippath id="clip770">
    <rect x="0" y="0" width="2304" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip770)" d="M0 1536 L2304 1536 L2304 8.52651e-14 L0 8.52651e-14  Z" fill="#f0f1eb" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip771">
    <rect x="460" y="0" width="1614" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip770)" d="M251.804 1347.54 L2256.76 1347.54 L2256.76 47.2441 L251.804 47.2441  Z" fill="#f0f1eb" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip772">
    <rect x="251" y="47" width="2006" height="1301"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip772)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="939.036,1347.54 939.036,47.2441 "></polyline>
<polyline clip-path="url(#clip772)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2200.01,1347.54 2200.01,47.2441 "></polyline>
<polyline clip-path="url(#clip770)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,1347.54 2256.76,1347.54 "></polyline>
<polyline clip-path="url(#clip770)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="939.036,1347.54 939.036,1328.64 "></polyline>
<polyline clip-path="url(#clip770)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2200.01,1347.54 2200.01,1328.64 "></polyline>
<path clip-path="url(#clip770)" d="M904.809 1420.89 L912.448 1420.89 L912.448 1394.53 L904.137 1396.19 L904.137 1391.94 L912.401 1390.27 L917.077 1390.27 L917.077 1420.89 L924.716 1420.89 L924.716 1424.83 L904.809 1424.83 L904.809 1420.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M944.16 1393.35 Q940.549 1393.35 938.721 1396.91 Q936.915 1400.45 936.915 1407.58 Q936.915 1414.69 938.721 1418.25 Q940.549 1421.8 944.16 1421.8 Q947.795 1421.8 949.6 1418.25 Q951.429 1414.69 951.429 1407.58 Q951.429 1400.45 949.6 1396.91 Q947.795 1393.35 944.16 1393.35 M944.16 1389.64 Q949.97 1389.64 953.026 1394.25 Q956.105 1398.83 956.105 1407.58 Q956.105 1416.31 953.026 1420.92 Q949.97 1425.5 944.16 1425.5 Q938.35 1425.5 935.271 1420.92 Q932.216 1416.31 932.216 1407.58 Q932.216 1398.83 935.271 1394.25 Q938.35 1389.64 944.16 1389.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M960.675 1394.22 L973.934 1394.22 L973.934 1397.42 L956.105 1397.42 L956.105 1394.22 Q958.268 1391.98 961.992 1388.22 Q965.734 1384.44 966.693 1383.35 Q968.518 1381.3 969.233 1379.89 Q969.966 1378.46 969.966 1377.09 Q969.966 1374.85 968.386 1373.44 Q966.825 1372.03 964.305 1372.03 Q962.518 1372.03 960.525 1372.65 Q958.55 1373.27 956.293 1374.53 L956.293 1370.69 Q958.587 1369.77 960.581 1369.3 Q962.575 1368.83 964.23 1368.83 Q968.593 1368.83 971.189 1371.01 Q973.784 1373.19 973.784 1376.84 Q973.784 1378.57 973.126 1380.13 Q972.486 1381.68 970.775 1383.78 Q970.305 1384.33 967.784 1386.94 Q965.264 1389.54 960.675 1394.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M2164.47 1420.89 L2172.11 1420.89 L2172.11 1394.53 L2163.8 1396.19 L2163.8 1391.94 L2172.06 1390.27 L2176.74 1390.27 L2176.74 1420.89 L2184.38 1420.89 L2184.38 1424.83 L2164.47 1424.83 L2164.47 1420.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M2203.82 1393.35 Q2200.21 1393.35 2198.38 1396.91 Q2196.57 1400.45 2196.57 1407.58 Q2196.57 1414.69 2198.38 1418.25 Q2200.21 1421.8 2203.82 1421.8 Q2207.45 1421.8 2209.26 1418.25 Q2211.09 1414.69 2211.09 1407.58 Q2211.09 1400.45 2209.26 1396.91 Q2207.45 1393.35 2203.82 1393.35 M2203.82 1389.64 Q2209.63 1389.64 2212.69 1394.25 Q2215.76 1398.83 2215.76 1407.58 Q2215.76 1416.31 2212.69 1420.92 Q2209.63 1425.5 2203.82 1425.5 Q2198.01 1425.5 2194.93 1420.92 Q2191.88 1416.31 2191.88 1407.58 Q2191.88 1398.83 2194.93 1394.25 Q2198.01 1389.64 2203.82 1389.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M2228.44 1372.65 L2218.85 1387.64 L2228.44 1387.64 L2228.44 1372.65 M2227.44 1369.34 L2232.22 1369.34 L2232.22 1387.64 L2236.23 1387.64 L2236.23 1390.8 L2232.22 1390.8 L2232.22 1397.42 L2228.44 1397.42 L2228.44 1390.8 L2215.76 1390.8 L2215.76 1387.13 L2227.44 1369.34 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1174.47 1490.1 L1174.47 1492.96 L1147.54 1492.96 Q1147.92 1499.01 1151.17 1502.19 Q1154.45 1505.34 1160.27 1505.34 Q1163.65 1505.34 1166.8 1504.52 Q1169.98 1503.69 1173.1 1502.03 L1173.1 1507.57 Q1169.95 1508.91 1166.64 1509.61 Q1163.33 1510.31 1159.92 1510.31 Q1151.39 1510.31 1146.4 1505.34 Q1141.43 1500.38 1141.43 1491.91 Q1141.43 1483.16 1146.14 1478.03 Q1150.88 1472.88 1158.91 1472.88 Q1166.1 1472.88 1170.27 1477.53 Q1174.47 1482.14 1174.47 1490.1 M1168.61 1488.38 Q1168.55 1483.57 1165.91 1480.71 Q1163.3 1477.84 1158.97 1477.84 Q1154.07 1477.84 1151.11 1480.61 Q1148.18 1483.38 1147.73 1488.41 L1168.61 1488.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1189.75 1504.04 L1189.75 1522.94 L1183.86 1522.94 L1183.86 1473.74 L1189.75 1473.74 L1189.75 1479.15 Q1191.59 1475.97 1194.39 1474.44 Q1197.23 1472.88 1201.14 1472.88 Q1207.64 1472.88 1211.68 1478.03 Q1215.75 1483.19 1215.75 1491.59 Q1215.75 1500 1211.68 1505.15 Q1207.64 1510.31 1201.14 1510.31 Q1197.23 1510.31 1194.39 1508.78 Q1191.59 1507.22 1189.75 1504.04 M1209.67 1491.59 Q1209.67 1485.13 1207 1481.47 Q1204.36 1477.78 1199.71 1477.78 Q1195.06 1477.78 1192.39 1481.47 Q1189.75 1485.13 1189.75 1491.59 Q1189.75 1498.05 1192.39 1501.75 Q1195.06 1505.41 1199.71 1505.41 Q1204.36 1505.41 1207 1501.75 Q1209.67 1498.05 1209.67 1491.59 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1239.27 1477.84 Q1234.56 1477.84 1231.82 1481.54 Q1229.09 1485.2 1229.09 1491.59 Q1229.09 1497.99 1231.79 1501.68 Q1234.53 1505.34 1239.27 1505.34 Q1243.95 1505.34 1246.69 1501.65 Q1249.43 1497.96 1249.43 1491.59 Q1249.43 1485.26 1246.69 1481.57 Q1243.95 1477.84 1239.27 1477.84 M1239.27 1472.88 Q1246.91 1472.88 1251.27 1477.84 Q1255.63 1482.81 1255.63 1491.59 Q1255.63 1500.35 1251.27 1505.34 Q1246.91 1510.31 1239.27 1510.31 Q1231.6 1510.31 1227.24 1505.34 Q1222.91 1500.35 1222.91 1491.59 Q1222.91 1482.81 1227.24 1477.84 Q1231.6 1472.88 1239.27 1472.88 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1290.99 1475.11 L1290.99 1480.58 Q1288.51 1479.21 1286 1478.54 Q1283.51 1477.84 1280.97 1477.84 Q1275.27 1477.84 1272.12 1481.47 Q1268.97 1485.07 1268.97 1491.59 Q1268.97 1498.12 1272.12 1501.75 Q1275.27 1505.34 1280.97 1505.34 Q1283.51 1505.34 1286 1504.67 Q1288.51 1503.97 1290.99 1502.61 L1290.99 1508.02 Q1288.54 1509.16 1285.9 1509.74 Q1283.29 1510.31 1280.33 1510.31 Q1272.28 1510.31 1267.54 1505.25 Q1262.79 1500.19 1262.79 1491.59 Q1262.79 1482.87 1267.57 1477.88 Q1272.37 1472.88 1280.71 1472.88 Q1283.42 1472.88 1286 1473.45 Q1288.58 1473.99 1290.99 1475.11 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1330.81 1487.87 L1330.81 1509.39 L1324.96 1509.39 L1324.96 1488.06 Q1324.96 1483 1322.98 1480.49 Q1321.01 1477.97 1317.06 1477.97 Q1312.32 1477.97 1309.58 1480.99 Q1306.84 1484.02 1306.84 1489.24 L1306.84 1509.39 L1300.96 1509.39 L1300.96 1459.86 L1306.84 1459.86 L1306.84 1479.28 Q1308.95 1476.06 1311.78 1474.47 Q1314.64 1472.88 1318.37 1472.88 Q1324.51 1472.88 1327.66 1476.7 Q1330.81 1480.49 1330.81 1487.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1365.22 1474.79 L1365.22 1480.33 Q1362.74 1479.05 1360.06 1478.42 Q1357.39 1477.78 1354.52 1477.78 Q1350.16 1477.78 1347.97 1479.12 Q1345.8 1480.45 1345.8 1483.13 Q1345.8 1485.16 1347.36 1486.34 Q1348.92 1487.49 1353.63 1488.54 L1355.64 1488.98 Q1361.88 1490.32 1364.49 1492.77 Q1367.13 1495.19 1367.13 1499.55 Q1367.13 1504.52 1363.18 1507.41 Q1359.27 1510.31 1352.39 1510.31 Q1349.53 1510.31 1346.41 1509.74 Q1343.32 1509.19 1339.88 1508.08 L1339.88 1502.03 Q1343.13 1503.72 1346.28 1504.58 Q1349.43 1505.41 1352.52 1505.41 Q1356.66 1505.41 1358.88 1504.01 Q1361.11 1502.57 1361.11 1500 Q1361.11 1497.61 1359.49 1496.34 Q1357.9 1495.06 1352.46 1493.88 L1350.42 1493.41 Q1344.98 1492.26 1342.56 1489.91 Q1340.14 1487.52 1340.14 1483.38 Q1340.14 1478.35 1343.7 1475.62 Q1347.27 1472.88 1353.82 1472.88 Q1357.07 1472.88 1359.93 1473.36 Q1362.8 1473.83 1365.22 1474.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip772)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="251.804,1206.6 2256.76,1206.6 "></polyline>
<polyline clip-path="url(#clip772)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="251.804,861.878 2256.76,861.878 "></polyline>
<polyline clip-path="url(#clip772)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="251.804,517.157 2256.76,517.157 "></polyline>
<polyline clip-path="url(#clip772)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="251.804,172.435 2256.76,172.435 "></polyline>
<polyline clip-path="url(#clip770)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,1347.54 251.804,47.2441 "></polyline>
<polyline clip-path="url(#clip770)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,1206.6 270.702,1206.6 "></polyline>
<polyline clip-path="url(#clip770)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,861.878 270.702,861.878 "></polyline>
<polyline clip-path="url(#clip770)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,517.157 270.702,517.157 "></polyline>
<polyline clip-path="url(#clip770)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,172.435 270.702,172.435 "></polyline>
<path clip-path="url(#clip770)" d="M115.675 1226.39 L123.314 1226.39 L123.314 1200.03 L115.003 1201.69 L115.003 1197.43 L123.267 1195.77 L127.943 1195.77 L127.943 1226.39 L135.582 1226.39 L135.582 1230.33 L115.675 1230.33 L115.675 1226.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M155.026 1198.85 Q151.415 1198.85 149.587 1202.41 Q147.781 1205.95 147.781 1213.08 Q147.781 1220.19 149.587 1223.75 Q151.415 1227.29 155.026 1227.29 Q158.661 1227.29 160.466 1223.75 Q162.295 1220.19 162.295 1213.08 Q162.295 1205.95 160.466 1202.41 Q158.661 1198.85 155.026 1198.85 M155.026 1195.14 Q160.837 1195.14 163.892 1199.75 Q166.971 1204.33 166.971 1213.08 Q166.971 1221.81 163.892 1226.42 Q160.837 1231 155.026 1231 Q149.216 1231 146.138 1226.42 Q143.082 1221.81 143.082 1213.08 Q143.082 1204.33 146.138 1199.75 Q149.216 1195.14 155.026 1195.14 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M166.971 1189.24 L191.082 1189.24 L191.082 1192.44 L166.971 1192.44 L166.971 1189.24 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M207.878 1187.36 Q205.32 1187.36 203.815 1189.11 Q202.329 1190.86 202.329 1193.91 Q202.329 1196.94 203.815 1198.7 Q205.32 1200.45 207.878 1200.45 Q210.436 1200.45 211.921 1198.7 Q213.426 1196.94 213.426 1193.91 Q213.426 1190.86 211.921 1189.11 Q210.436 1187.36 207.878 1187.36 M215.42 1175.46 L215.42 1178.92 Q213.99 1178.24 212.523 1177.88 Q211.075 1177.53 209.646 1177.53 Q205.884 1177.53 203.89 1180.07 Q201.916 1182.6 201.633 1187.74 Q202.743 1186.1 204.417 1185.24 Q206.091 1184.35 208.103 1184.35 Q212.335 1184.35 214.78 1186.93 Q217.244 1189.49 217.244 1193.91 Q217.244 1198.23 214.686 1200.85 Q212.128 1203.46 207.878 1203.46 Q203.006 1203.46 200.43 1199.74 Q197.853 1196 197.853 1188.9 Q197.853 1182.25 201.013 1178.3 Q204.173 1174.33 209.495 1174.33 Q210.925 1174.33 212.373 1174.61 Q213.84 1174.89 215.42 1175.46 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M116.615 881.671 L124.254 881.671 L124.254 855.305 L115.944 856.972 L115.944 852.712 L124.208 851.046 L128.884 851.046 L128.884 881.671 L136.522 881.671 L136.522 885.606 L116.615 885.606 L116.615 881.671 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M155.967 854.124 Q152.356 854.124 150.527 857.689 Q148.721 861.231 148.721 868.36 Q148.721 875.467 150.527 879.032 Q152.356 882.573 155.967 882.573 Q159.601 882.573 161.407 879.032 Q163.235 875.467 163.235 868.36 Q163.235 861.231 161.407 857.689 Q159.601 854.124 155.967 854.124 M155.967 850.421 Q161.777 850.421 164.832 855.027 Q167.911 859.61 167.911 868.36 Q167.911 877.087 164.832 881.694 Q161.777 886.277 155.967 886.277 Q150.157 886.277 147.078 881.694 Q144.022 877.087 144.022 868.36 Q144.022 859.61 147.078 855.027 Q150.157 850.421 155.967 850.421 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M167.911 844.522 L192.023 844.522 L192.023 847.719 L167.911 847.719 L167.911 844.522 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M200.261 830.115 L215.175 830.115 L215.175 833.313 L203.74 833.313 L203.74 840.196 Q204.568 839.914 205.395 839.783 Q206.223 839.632 207.05 839.632 Q211.752 839.632 214.498 842.209 Q217.244 844.785 217.244 849.186 Q217.244 853.719 214.423 856.239 Q211.602 858.741 206.467 858.741 Q204.699 858.741 202.856 858.44 Q201.032 858.139 199.076 857.537 L199.076 853.719 Q200.768 854.641 202.574 855.092 Q204.379 855.543 206.392 855.543 Q209.646 855.543 211.545 853.832 Q213.445 852.12 213.445 849.186 Q213.445 846.252 211.545 844.541 Q209.646 842.829 206.392 842.829 Q204.868 842.829 203.345 843.168 Q201.84 843.506 200.261 844.221 L200.261 830.115 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M115.411 536.949 L123.05 536.949 L123.05 510.584 L114.74 512.25 L114.74 507.991 L123.004 506.324 L127.68 506.324 L127.68 536.949 L135.319 536.949 L135.319 540.884 L115.411 540.884 L115.411 536.949 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M154.763 509.403 Q151.152 509.403 149.323 512.968 Q147.518 516.509 147.518 523.639 Q147.518 530.745 149.323 534.31 Q151.152 537.852 154.763 537.852 Q158.397 537.852 160.203 534.31 Q162.032 530.745 162.032 523.639 Q162.032 516.509 160.203 512.968 Q158.397 509.403 154.763 509.403 M154.763 505.699 Q160.573 505.699 163.629 510.306 Q166.707 514.889 166.707 523.639 Q166.707 532.366 163.629 536.972 Q160.573 541.556 154.763 541.556 Q148.953 541.556 145.874 536.972 Q142.819 532.366 142.819 523.639 Q142.819 514.889 145.874 510.306 Q148.953 505.699 154.763 505.699 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M166.707 499.801 L190.819 499.801 L190.819 502.998 L166.707 502.998 L166.707 499.801 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M209.458 488.704 L199.866 503.694 L209.458 503.694 L209.458 488.704 M208.461 485.394 L213.238 485.394 L213.238 503.694 L217.244 503.694 L217.244 506.854 L213.238 506.854 L213.238 513.474 L209.458 513.474 L209.458 506.854 L196.781 506.854 L196.781 503.186 L208.461 485.394 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M116.333 192.228 L123.972 192.228 L123.972 165.862 L115.662 167.529 L115.662 163.27 L123.926 161.603 L128.601 161.603 L128.601 192.228 L136.24 192.228 L136.24 196.163 L116.333 196.163 L116.333 192.228 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M155.685 164.682 Q152.074 164.682 150.245 168.246 Q148.439 171.788 148.439 178.918 Q148.439 186.024 150.245 189.589 Q152.074 193.13 155.685 193.13 Q159.319 193.13 161.124 189.589 Q162.953 186.024 162.953 178.918 Q162.953 171.788 161.124 168.246 Q159.319 164.682 155.685 164.682 M155.685 160.978 Q161.495 160.978 164.55 165.584 Q167.629 170.168 167.629 178.918 Q167.629 187.644 164.55 192.251 Q161.495 196.834 155.685 196.834 Q149.875 196.834 146.796 192.251 Q143.74 187.644 143.74 178.918 Q143.74 170.168 146.796 165.584 Q149.875 160.978 155.685 160.978 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M167.629 155.079 L191.741 155.079 L191.741 158.277 L167.629 158.277 L167.629 155.079 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M211.451 153.612 Q214.178 154.195 215.702 156.038 Q217.244 157.882 217.244 160.59 Q217.244 164.746 214.385 167.022 Q211.526 169.298 206.26 169.298 Q204.492 169.298 202.612 168.941 Q200.75 168.602 198.756 167.906 L198.756 164.239 Q200.336 165.16 202.217 165.63 Q204.097 166.101 206.147 166.101 Q209.721 166.101 211.583 164.69 Q213.464 163.279 213.464 160.59 Q213.464 158.107 211.714 156.716 Q209.984 155.305 206.881 155.305 L203.608 155.305 L203.608 152.183 L207.031 152.183 Q209.834 152.183 211.32 151.073 Q212.805 149.945 212.805 147.838 Q212.805 145.675 211.263 144.528 Q209.74 143.362 206.881 143.362 Q205.32 143.362 203.533 143.701 Q201.746 144.039 199.602 144.754 L199.602 141.368 Q201.765 140.767 203.646 140.466 Q205.546 140.165 207.219 140.165 Q211.545 140.165 214.065 142.139 Q216.586 144.095 216.586 147.443 Q216.586 149.775 215.25 151.393 Q213.915 152.992 211.451 153.612 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M18.4042 761.509 L18.4042 751.929 L50.7419 739.802 L18.4042 727.612 L18.4042 718.031 L65.9242 718.031 L65.9242 724.301 L24.197 724.301 L56.7894 736.555 L56.7894 743.017 L24.197 755.271 L65.9242 755.271 L65.9242 761.509 L18.4042 761.509 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M19.9638 676.781 L26.234 676.781 Q24.4834 680.442 23.624 683.688 Q22.7647 686.935 22.7647 689.958 Q22.7647 695.21 24.8017 698.075 Q26.8387 700.907 30.5945 700.907 Q33.7455 700.907 35.3688 699.03 Q36.9602 697.12 37.9469 691.836 L38.7426 687.953 Q40.1112 680.76 43.5805 677.354 Q47.018 673.917 52.8108 673.917 Q59.7176 673.917 63.2824 678.564 Q66.8472 683.179 66.8472 692.123 Q66.8472 695.497 66.0833 699.316 Q65.3194 703.104 63.8235 707.178 L57.2031 707.178 Q59.3993 703.263 60.5133 699.507 Q61.6273 695.751 61.6273 692.123 Q61.6273 686.616 59.463 683.625 Q57.2986 680.633 53.2882 680.633 Q49.7871 680.633 47.8137 682.797 Q45.8404 684.929 44.8537 689.831 L44.0898 693.746 Q42.6575 700.939 39.602 704.154 Q36.5464 707.369 31.1037 707.369 Q24.8017 707.369 21.1732 702.944 Q17.5448 698.488 17.5448 690.69 Q17.5448 687.348 18.1495 683.879 Q18.7543 680.41 19.9638 676.781 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M18.4042 663.891 L18.4042 633.845 L23.815 633.845 L23.815 657.461 L37.8832 657.461 L37.8832 634.831 L43.2941 634.831 L43.2941 657.461 L60.5133 657.461 L60.5133 633.272 L65.9242 633.272 L65.9242 663.891 L18.4042 663.891 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><circle clip-path="url(#clip772)" cx="308.548" cy="454.691" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip772)" cx="939.036" cy="699.917" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip772)" cx="1569.52" cy="1045.69" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip772)" cx="2200.01" cy="1304.87" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<polyline clip-path="url(#clip772)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="308.548,441.846 327.654,450.622 346.759,459.399 365.865,468.176 384.971,476.952 404.076,485.729 423.182,494.506 442.288,503.282 461.393,512.059 480.499,520.836 499.605,529.612 518.711,538.389 537.816,547.166 556.922,555.943 576.028,564.719 595.133,573.496 614.239,582.273 633.345,591.049 652.45,599.826 671.556,608.603 690.662,617.379 709.768,626.156 728.873,634.933 747.979,643.709 767.085,652.486 786.19,661.263 805.296,670.039 824.402,678.816 843.507,687.593 862.613,696.369 881.719,705.146 900.825,713.923 919.93,722.699 939.036,731.476 958.142,740.253 977.247,749.029 996.353,757.806 1015.46,766.583 1034.56,775.359 1053.67,784.136 1072.78,792.913 1091.88,801.689 1110.99,810.466 1130.09,819.243 1149.2,828.019 1168.3,836.796 1187.41,845.573 1206.52,854.349 1225.62,863.126 1244.73,871.903 1263.83,880.679 1282.94,889.456 1302.04,898.233 1321.15,907.009 1340.26,915.786 1359.36,924.563 1378.47,933.339 1397.57,942.116 1416.68,950.893 1435.78,959.669 1454.89,968.446 1474,977.223 1493.1,985.999 1512.21,994.776 1531.31,1003.55 1550.42,1012.33 1569.52,1021.11 1588.63,1029.88 1607.74,1038.66 1626.84,1047.44 1645.95,1056.21 1665.05,1064.99 1684.16,1073.77 1703.26,1082.54 1722.37,1091.32 1741.48,1100.1 1760.58,1108.87 1779.69,1117.65 1798.79,1126.43 1817.9,1135.2 1837,1143.98 1856.11,1152.76 1875.22,1161.53 1894.32,1170.31 1913.43,1179.09 1932.53,1187.86 1951.64,1196.64 1970.74,1205.42 1989.85,1214.19 2008.96,1222.97 2028.06,1231.75 2047.17,1240.52 2066.27,1249.3 2085.38,1258.08 2104.48,1266.85 2123.59,1275.63 2142.69,1284.41 2161.8,1293.18 2180.91,1301.96 2200.01,1310.74 "></polyline>
<circle clip-path="url(#clip772)" cx="308.548" cy="122.998" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip772)" cx="939.036" cy="344.372" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip772)" cx="1569.52" cy="618.467" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip772)" cx="2200.01" cy="1008.25" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<polyline clip-path="url(#clip772)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" stroke-dasharray="32, 20" points="308.548,84.0448 327.654,92.9231 346.759,101.801 365.865,110.68 384.971,119.558 404.076,128.436 423.182,137.315 442.288,146.193 461.393,155.071 480.499,163.949 499.605,172.828 518.711,181.706 537.816,190.584 556.922,199.463 576.028,208.341 595.133,217.219 614.239,226.098 633.345,234.976 652.45,243.854 671.556,252.732 690.662,261.611 709.768,270.489 728.873,279.367 747.979,288.246 767.085,297.124 786.19,306.002 805.296,314.881 824.402,323.759 843.507,332.637 862.613,341.515 881.719,350.394 900.825,359.272 919.93,368.15 939.036,377.029 958.142,385.907 977.247,394.785 996.353,403.664 1015.46,412.542 1034.56,421.42 1053.67,430.298 1072.78,439.177 1091.88,448.055 1110.99,456.933 1130.09,465.812 1149.2,474.69 1168.3,483.568 1187.41,492.446 1206.52,501.325 1225.62,510.203 1244.73,519.081 1263.83,527.96 1282.94,536.838 1302.04,545.716 1321.15,554.595 1340.26,563.473 1359.36,572.351 1378.47,581.229 1397.57,590.108 1416.68,598.986 1435.78,607.864 1454.89,616.743 1474,625.621 1493.1,634.499 1512.21,643.378 1531.31,652.256 1550.42,661.134 1569.52,670.012 1588.63,678.891 1607.74,687.769 1626.84,696.647 1645.95,705.526 1665.05,714.404 1684.16,723.282 1703.26,732.16 1722.37,741.039 1741.48,749.917 1760.58,758.795 1779.69,767.674 1798.79,776.552 1817.9,785.43 1837,794.309 1856.11,803.187 1875.22,812.065 1894.32,820.943 1913.43,829.822 1932.53,838.7 1951.64,847.578 1970.74,856.457 1989.85,865.335 2008.96,874.213 2028.06,883.092 2047.17,891.97 2066.27,900.848 2085.38,909.726 2104.48,918.605 2123.59,927.483 2142.69,936.361 2161.8,945.24 2180.91,954.118 2200.01,962.996 "></polyline>
<path clip-path="url(#clip770)" d="M1315.01 246.107 L2189.92 246.107 L2189.92 90.5872 L1315.01 90.5872  Z" fill="#f0f1eb" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip770)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1315.01,246.107 2189.92,246.107 2189.92,90.5872 1315.01,90.5872 1315.01,246.107 "></polyline>
<polyline clip-path="url(#clip770)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1337.29,142.427 1470.95,142.427 "></polyline>
<path clip-path="url(#clip770)" d="M1493.76 125.147 L1520.91 125.147 L1520.91 128.712 L1499.06 155.772 L1521.45 155.772 L1521.45 159.707 L1493.23 159.707 L1493.23 156.142 L1515.08 129.082 L1493.76 129.082 L1493.76 125.147 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1526.24 125.147 L1553.39 125.147 L1553.39 128.712 L1531.54 155.772 L1553.92 155.772 L1553.92 159.707 L1525.71 159.707 L1525.71 156.142 L1547.56 129.082 L1526.24 129.082 L1526.24 125.147 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip770)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" stroke-dasharray="32, 20" points="1337.29,194.267 1470.95,194.267 "></polyline>
<path clip-path="url(#clip770)" d="M1493.76 176.987 L1520.91 176.987 L1520.91 180.552 L1499.06 207.612 L1521.45 207.612 L1521.45 211.547 L1493.23 211.547 L1493.23 207.982 L1515.08 180.922 L1493.76 180.922 L1493.76 176.987 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1526.24 176.987 L1553.39 176.987 L1553.39 180.552 L1531.54 207.612 L1553.92 207.612 L1553.92 211.547 L1525.71 211.547 L1525.71 207.982 L1547.56 180.922 L1526.24 180.922 L1526.24 176.987 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1557.53 196.663 L1570.01 196.663 L1570.01 200.459 L1557.53 200.459 L1557.53 196.663 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1602.86 179.649 L1602.86 184.58 Q1600.5 182.381 1597.81 181.293 Q1595.15 180.205 1592.14 180.205 Q1586.21 180.205 1583.07 183.839 Q1579.92 187.45 1579.92 194.302 Q1579.92 201.131 1583.07 204.765 Q1586.21 208.376 1592.14 208.376 Q1595.15 208.376 1597.81 207.288 Q1600.5 206.2 1602.86 204.001 L1602.86 208.885 Q1600.4 210.552 1597.65 211.385 Q1594.92 212.218 1591.86 212.218 Q1584.02 212.218 1579.5 207.427 Q1574.99 202.612 1574.99 194.302 Q1574.99 185.969 1579.5 181.177 Q1584.02 176.362 1591.86 176.362 Q1594.96 176.362 1597.7 177.196 Q1600.45 178.006 1602.86 179.649 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1618.99 211.547 L1605.8 176.987 L1610.68 176.987 L1621.63 206.084 L1632.6 176.987 L1637.46 176.987 L1624.29 211.547 L1618.99 211.547 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1667.63 175.575 Q1664.52 180.899 1663.02 186.108 Q1661.52 191.316 1661.52 196.663 Q1661.52 202.01 1663.02 207.265 Q1664.55 212.496 1667.63 217.797 L1663.92 217.797 Q1660.45 212.357 1658.71 207.103 Q1657 201.848 1657 196.663 Q1657 191.501 1658.71 186.27 Q1660.43 181.038 1663.92 175.575 L1667.63 175.575 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1673.41 185.621 L1677.67 185.621 L1683 205.853 L1688.3 185.621 L1693.32 185.621 L1698.64 205.853 L1703.95 185.621 L1708.2 185.621 L1701.42 211.547 L1696.4 211.547 L1690.82 190.297 L1685.22 211.547 L1680.2 211.547 L1673.41 185.621 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1714.66 185.621 L1718.92 185.621 L1718.92 211.547 L1714.66 211.547 L1714.66 185.621 M1714.66 175.529 L1718.92 175.529 L1718.92 180.922 L1714.66 180.922 L1714.66 175.529 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1732.05 178.26 L1732.05 185.621 L1740.82 185.621 L1740.82 188.932 L1732.05 188.932 L1732.05 203.006 Q1732.05 206.177 1732.9 207.08 Q1733.78 207.982 1736.45 207.982 L1740.82 207.982 L1740.82 211.547 L1736.45 211.547 Q1731.52 211.547 1729.64 209.718 Q1727.77 207.867 1727.77 203.006 L1727.77 188.932 L1724.64 188.932 L1724.64 185.621 L1727.77 185.621 L1727.77 178.26 L1732.05 178.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1767.97 195.899 L1767.97 211.547 L1763.71 211.547 L1763.71 196.038 Q1763.71 192.357 1762.28 190.529 Q1760.84 188.7 1757.97 188.7 Q1754.52 188.7 1752.53 190.899 Q1750.54 193.098 1750.54 196.894 L1750.54 211.547 L1746.26 211.547 L1746.26 175.529 L1750.54 175.529 L1750.54 189.649 Q1752.07 187.311 1754.13 186.154 Q1756.21 184.996 1758.92 184.996 Q1763.39 184.996 1765.68 187.774 Q1767.97 190.529 1767.97 195.899 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1786.51 188.607 Q1783.09 188.607 1781.1 191.293 Q1779.11 193.955 1779.11 198.607 Q1779.11 203.26 1781.07 205.945 Q1783.07 208.607 1786.51 208.607 Q1789.92 208.607 1791.91 205.922 Q1793.9 203.237 1793.9 198.607 Q1793.9 194.001 1791.91 191.316 Q1789.92 188.607 1786.51 188.607 M1786.51 184.996 Q1792.07 184.996 1795.24 188.607 Q1798.41 192.219 1798.41 198.607 Q1798.41 204.973 1795.24 208.607 Q1792.07 212.218 1786.51 212.218 Q1780.94 212.218 1777.76 208.607 Q1774.62 204.973 1774.62 198.607 Q1774.62 192.219 1777.76 188.607 Q1780.94 184.996 1786.51 184.996 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1805.03 201.316 L1805.03 185.621 L1809.29 185.621 L1809.29 201.154 Q1809.29 204.834 1810.73 206.686 Q1812.16 208.515 1815.03 208.515 Q1818.48 208.515 1820.47 206.316 Q1822.49 204.117 1822.49 200.32 L1822.49 185.621 L1826.75 185.621 L1826.75 211.547 L1822.49 211.547 L1822.49 207.566 Q1820.94 209.927 1818.88 211.084 Q1816.84 212.218 1814.13 212.218 Q1809.66 212.218 1807.35 209.441 Q1805.03 206.663 1805.03 201.316 M1815.75 184.996 L1815.75 184.996 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1839.73 178.26 L1839.73 185.621 L1848.51 185.621 L1848.51 188.932 L1839.73 188.932 L1839.73 203.006 Q1839.73 206.177 1840.59 207.08 Q1841.47 207.982 1844.13 207.982 L1848.51 207.982 L1848.51 211.547 L1844.13 211.547 Q1839.2 211.547 1837.32 209.718 Q1835.45 207.867 1835.45 203.006 L1835.45 188.932 L1832.32 188.932 L1832.32 185.621 L1835.45 185.621 L1835.45 178.26 L1839.73 178.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1880.96 198.515 Q1875.8 198.515 1873.81 199.695 Q1871.82 200.876 1871.82 203.723 Q1871.82 205.992 1873.3 207.334 Q1874.8 208.654 1877.37 208.654 Q1880.91 208.654 1883.04 206.154 Q1885.19 203.631 1885.19 199.464 L1885.19 198.515 L1880.96 198.515 M1889.45 196.756 L1889.45 211.547 L1885.19 211.547 L1885.19 207.612 Q1883.74 209.973 1881.56 211.107 Q1879.38 212.218 1876.24 212.218 Q1872.25 212.218 1869.89 209.996 Q1867.56 207.751 1867.56 204.001 Q1867.56 199.626 1870.47 197.404 Q1873.41 195.182 1879.22 195.182 L1885.19 195.182 L1885.19 194.765 Q1885.19 191.825 1883.25 190.228 Q1881.33 188.607 1877.83 188.607 Q1875.61 188.607 1873.5 189.14 Q1871.4 189.672 1869.45 190.737 L1869.45 186.802 Q1871.79 185.899 1873.99 185.459 Q1876.19 184.996 1878.27 184.996 Q1883.9 184.996 1886.68 187.913 Q1889.45 190.83 1889.45 196.756 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1918.41 190.598 Q1920.01 187.728 1922.23 186.362 Q1924.45 184.996 1927.46 184.996 Q1931.51 184.996 1933.71 187.844 Q1935.91 190.668 1935.91 195.899 L1935.91 211.547 L1931.63 211.547 L1931.63 196.038 Q1931.63 192.311 1930.31 190.506 Q1928.99 188.7 1926.28 188.7 Q1922.97 188.7 1921.05 190.899 Q1919.13 193.098 1919.13 196.894 L1919.13 211.547 L1914.85 211.547 L1914.85 196.038 Q1914.85 192.288 1913.53 190.506 Q1912.21 188.7 1909.45 188.7 Q1906.19 188.7 1904.27 190.922 Q1902.35 193.121 1902.35 196.894 L1902.35 211.547 L1898.07 211.547 L1898.07 185.621 L1902.35 185.621 L1902.35 189.649 Q1903.81 187.265 1905.84 186.131 Q1907.88 184.996 1910.68 184.996 Q1913.5 184.996 1915.47 186.432 Q1917.46 187.867 1918.41 190.598 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1966.58 197.519 L1966.58 199.603 L1947 199.603 Q1947.28 204.001 1949.64 206.316 Q1952.02 208.607 1956.26 208.607 Q1958.71 208.607 1961 208.006 Q1963.32 207.404 1965.59 206.2 L1965.59 210.228 Q1963.3 211.2 1960.89 211.709 Q1958.48 212.218 1956 212.218 Q1949.8 212.218 1946.17 208.607 Q1942.56 204.996 1942.56 198.839 Q1942.56 192.473 1945.98 188.746 Q1949.43 184.996 1955.26 184.996 Q1960.5 184.996 1963.53 188.376 Q1966.58 191.732 1966.58 197.519 M1962.32 196.269 Q1962.28 192.774 1960.36 190.691 Q1958.46 188.607 1955.31 188.607 Q1951.75 188.607 1949.59 190.621 Q1947.46 192.635 1947.14 196.293 L1962.32 196.269 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M1995.12 195.899 L1995.12 211.547 L1990.87 211.547 L1990.87 196.038 Q1990.87 192.357 1989.43 190.529 Q1988 188.7 1985.12 188.7 Q1981.68 188.7 1979.68 190.899 Q1977.69 193.098 1977.69 196.894 L1977.69 211.547 L1973.41 211.547 L1973.41 185.621 L1977.69 185.621 L1977.69 189.649 Q1979.22 187.311 1981.28 186.154 Q1983.37 184.996 1986.07 184.996 Q1990.54 184.996 1992.83 187.774 Q1995.12 190.529 1995.12 195.899 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M2020.68 189.557 L2020.68 175.529 L2024.94 175.529 L2024.94 211.547 L2020.68 211.547 L2020.68 207.658 Q2019.34 209.973 2017.28 211.107 Q2015.24 212.218 2012.37 212.218 Q2007.67 212.218 2004.71 208.468 Q2001.77 204.719 2001.77 198.607 Q2001.77 192.496 2004.71 188.746 Q2007.67 184.996 2012.37 184.996 Q2015.24 184.996 2017.28 186.131 Q2019.34 187.242 2020.68 189.557 M2006.17 198.607 Q2006.17 203.306 2008.09 205.992 Q2010.03 208.654 2013.41 208.654 Q2016.79 208.654 2018.74 205.992 Q2020.68 203.306 2020.68 198.607 Q2020.68 193.908 2018.74 191.246 Q2016.79 188.561 2013.41 188.561 Q2010.03 188.561 2008.09 191.246 Q2006.17 193.908 2006.17 198.607 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M2053.9 190.598 Q2055.49 187.728 2057.72 186.362 Q2059.94 184.996 2062.95 184.996 Q2067 184.996 2069.2 187.844 Q2071.4 190.668 2071.4 195.899 L2071.4 211.547 L2067.12 211.547 L2067.12 196.038 Q2067.12 192.311 2065.8 190.506 Q2064.48 188.7 2061.77 188.7 Q2058.46 188.7 2056.54 190.899 Q2054.62 193.098 2054.62 196.894 L2054.62 211.547 L2050.33 211.547 L2050.33 196.038 Q2050.33 192.288 2049.01 190.506 Q2047.69 188.7 2044.94 188.7 Q2041.68 188.7 2039.75 190.922 Q2037.83 193.121 2037.83 196.894 L2037.83 211.547 L2033.55 211.547 L2033.55 185.621 L2037.83 185.621 L2037.83 189.649 Q2039.29 187.265 2041.33 186.131 Q2043.37 184.996 2046.17 184.996 Q2048.99 184.996 2050.96 186.432 Q2052.95 187.867 2053.9 190.598 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M2102.07 197.519 L2102.07 199.603 L2082.49 199.603 Q2082.76 204.001 2085.12 206.316 Q2087.51 208.607 2091.74 208.607 Q2094.2 208.607 2096.49 208.006 Q2098.8 207.404 2101.07 206.2 L2101.07 210.228 Q2098.78 211.2 2096.37 211.709 Q2093.97 212.218 2091.49 212.218 Q2085.29 212.218 2081.65 208.607 Q2078.04 204.996 2078.04 198.839 Q2078.04 192.473 2081.47 188.746 Q2084.92 184.996 2090.75 184.996 Q2095.98 184.996 2099.01 188.376 Q2102.07 191.732 2102.07 197.519 M2097.81 196.269 Q2097.76 192.774 2095.84 190.691 Q2093.94 188.607 2090.8 188.607 Q2087.23 188.607 2085.08 190.621 Q2082.95 192.635 2082.62 196.293 L2097.81 196.269 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M2130.61 195.899 L2130.61 211.547 L2126.35 211.547 L2126.35 196.038 Q2126.35 192.357 2124.92 190.529 Q2123.48 188.7 2120.61 188.7 Q2117.16 188.7 2115.17 190.899 Q2113.18 193.098 2113.18 196.894 L2113.18 211.547 L2108.9 211.547 L2108.9 185.621 L2113.18 185.621 L2113.18 189.649 Q2114.71 187.311 2116.77 186.154 Q2118.85 184.996 2121.56 184.996 Q2126.03 184.996 2128.32 187.774 Q2130.61 190.529 2130.61 195.899 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M2143.32 178.26 L2143.32 185.621 L2152.09 185.621 L2152.09 188.932 L2143.32 188.932 L2143.32 203.006 Q2143.32 206.177 2144.17 207.08 Q2145.05 207.982 2147.72 207.982 L2152.09 207.982 L2152.09 211.547 L2147.72 211.547 Q2142.79 211.547 2140.91 209.718 Q2139.04 207.867 2139.04 203.006 L2139.04 188.932 L2135.91 188.932 L2135.91 185.621 L2139.04 185.621 L2139.04 178.26 L2143.32 178.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip770)" d="M2157.02 175.575 L2160.73 175.575 Q2164.2 181.038 2165.91 186.27 Q2167.65 191.501 2167.65 196.663 Q2167.65 201.848 2165.91 207.103 Q2164.2 212.357 2160.73 217.797 L2157.02 217.797 Q2160.1 212.496 2161.61 207.265 Q2163.13 202.01 2163.13 196.663 Q2163.13 191.316 2161.61 186.108 Q2160.1 180.899 2157.02 175.575 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
<p>一見すると ZZ-CV が負けているように見える．しかし，点線で描いているのは，横軸が epoch であることを正しく考慮していない間違ったプロットであるためである．</p>
<p><span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens et al., 2019, p. 1310</a>)</span> において epoch とは，計算量の１単位分としており，ZZ における１回の到着時刻のシミュレーションは，ZZ-CV の <span class="math inline">\(n\)</span> 回分に当たる．これを考慮に入れてプロットし直すと次の通りになる：</p>
<div id="2d51e024" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>実験の実行</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>T_SuperEfficient <span class="op">=</span> <span class="fl">300000.0</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>epoch_list_SuperEfficient <span class="op">=</span> [<span class="fl">1000.0</span>, <span class="fl">10000.0</span>, <span class="fl">100000.0</span>, <span class="fl">1000000.0</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="pp">@time</span> MSE_ZZ_CV, acc <span class="op">=</span> <span class="fu">experiment</span>(epoch_list_SuperEfficient, T_SuperEfficient, dt, N, ∇U1, x0, θ<span class="fl">0</span>, y1, ZZ_CV; ab<span class="op">=</span>ab_ZZ_CV)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter!</span>(p, epoch_list, MSE_ZZ_CV,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    marker<span class="op">=:</span>circle,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    markersize<span class="op">=</span><span class="fl">5</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    markeralpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#E95420"</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="cn">nothing</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="fu">DataFrame</span>(X <span class="op">=</span> <span class="fu">log10</span>.(epoch_list), Y <span class="op">=</span> <span class="fu">log10</span>.(MSE_ZZ_CV))</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">lm</span>(<span class="pp">@formula</span>(Y <span class="op">~</span> X), df)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>X_pred <span class="op">=</span> <span class="fu">range</span>(<span class="fu">minimum</span>(df.X), <span class="fu">maximum</span>(df.X), length<span class="op">=</span><span class="fl">100</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>Y_pred <span class="op">=</span> <span class="fu">predict</span>(model, <span class="fu">DataFrame</span>(X <span class="op">=</span> X_pred))</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(p, <span class="fl">10</span> <span class="op">.^</span> X_pred, <span class="fl">10</span> <span class="op">.^</span> Y_pred,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=:</span>solid,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    linewidth<span class="op">=</span><span class="fl">2</span>,</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#E95420"</span>,</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">"ZZ-CV"</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> 48.801393 seconds (2.48 G allocations: 46.290 GiB, 7.29% gc time)</code></pre>
</div>
<div class="cell-output cell-output-display">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="576" height="384" viewbox="0 0 2304 1536">
<defs>
  <clippath id="clip900">
    <rect x="0" y="0" width="2304" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip900)" d="M0 1536 L2304 1536 L2304 8.52651e-14 L0 8.52651e-14  Z" fill="#f0f1eb" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip901">
    <rect x="460" y="0" width="1614" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip900)" d="M251.804 1347.54 L2256.76 1347.54 L2256.76 47.2441 L251.804 47.2441  Z" fill="#f0f1eb" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip902">
    <rect x="251" y="47" width="2006" height="1301"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="939.036,1347.54 939.036,47.2441 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2200.01,1347.54 2200.01,47.2441 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,1347.54 2256.76,1347.54 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="939.036,1347.54 939.036,1328.64 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2200.01,1347.54 2200.01,1328.64 "></polyline>
<path clip-path="url(#clip900)" d="M904.809 1420.89 L912.448 1420.89 L912.448 1394.53 L904.137 1396.19 L904.137 1391.94 L912.401 1390.27 L917.077 1390.27 L917.077 1420.89 L924.716 1420.89 L924.716 1424.83 L904.809 1424.83 L904.809 1420.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M944.16 1393.35 Q940.549 1393.35 938.721 1396.91 Q936.915 1400.45 936.915 1407.58 Q936.915 1414.69 938.721 1418.25 Q940.549 1421.8 944.16 1421.8 Q947.795 1421.8 949.6 1418.25 Q951.429 1414.69 951.429 1407.58 Q951.429 1400.45 949.6 1396.91 Q947.795 1393.35 944.16 1393.35 M944.16 1389.64 Q949.97 1389.64 953.026 1394.25 Q956.105 1398.83 956.105 1407.58 Q956.105 1416.31 953.026 1420.92 Q949.97 1425.5 944.16 1425.5 Q938.35 1425.5 935.271 1420.92 Q932.216 1416.31 932.216 1407.58 Q932.216 1398.83 935.271 1394.25 Q938.35 1389.64 944.16 1389.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M960.675 1394.22 L973.934 1394.22 L973.934 1397.42 L956.105 1397.42 L956.105 1394.22 Q958.268 1391.98 961.992 1388.22 Q965.734 1384.44 966.693 1383.35 Q968.518 1381.3 969.233 1379.89 Q969.966 1378.46 969.966 1377.09 Q969.966 1374.85 968.386 1373.44 Q966.825 1372.03 964.305 1372.03 Q962.518 1372.03 960.525 1372.65 Q958.55 1373.27 956.293 1374.53 L956.293 1370.69 Q958.587 1369.77 960.581 1369.3 Q962.575 1368.83 964.23 1368.83 Q968.593 1368.83 971.189 1371.01 Q973.784 1373.19 973.784 1376.84 Q973.784 1378.57 973.126 1380.13 Q972.486 1381.68 970.775 1383.78 Q970.305 1384.33 967.784 1386.94 Q965.264 1389.54 960.675 1394.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M2164.47 1420.89 L2172.11 1420.89 L2172.11 1394.53 L2163.8 1396.19 L2163.8 1391.94 L2172.06 1390.27 L2176.74 1390.27 L2176.74 1420.89 L2184.38 1420.89 L2184.38 1424.83 L2164.47 1424.83 L2164.47 1420.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M2203.82 1393.35 Q2200.21 1393.35 2198.38 1396.91 Q2196.57 1400.45 2196.57 1407.58 Q2196.57 1414.69 2198.38 1418.25 Q2200.21 1421.8 2203.82 1421.8 Q2207.45 1421.8 2209.26 1418.25 Q2211.09 1414.69 2211.09 1407.58 Q2211.09 1400.45 2209.26 1396.91 Q2207.45 1393.35 2203.82 1393.35 M2203.82 1389.64 Q2209.63 1389.64 2212.69 1394.25 Q2215.76 1398.83 2215.76 1407.58 Q2215.76 1416.31 2212.69 1420.92 Q2209.63 1425.5 2203.82 1425.5 Q2198.01 1425.5 2194.93 1420.92 Q2191.88 1416.31 2191.88 1407.58 Q2191.88 1398.83 2194.93 1394.25 Q2198.01 1389.64 2203.82 1389.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M2228.44 1372.65 L2218.85 1387.64 L2228.44 1387.64 L2228.44 1372.65 M2227.44 1369.34 L2232.22 1369.34 L2232.22 1387.64 L2236.23 1387.64 L2236.23 1390.8 L2232.22 1390.8 L2232.22 1397.42 L2228.44 1397.42 L2228.44 1390.8 L2215.76 1390.8 L2215.76 1387.13 L2227.44 1369.34 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1174.47 1490.1 L1174.47 1492.96 L1147.54 1492.96 Q1147.92 1499.01 1151.17 1502.19 Q1154.45 1505.34 1160.27 1505.34 Q1163.65 1505.34 1166.8 1504.52 Q1169.98 1503.69 1173.1 1502.03 L1173.1 1507.57 Q1169.95 1508.91 1166.64 1509.61 Q1163.33 1510.31 1159.92 1510.31 Q1151.39 1510.31 1146.4 1505.34 Q1141.43 1500.38 1141.43 1491.91 Q1141.43 1483.16 1146.14 1478.03 Q1150.88 1472.88 1158.91 1472.88 Q1166.1 1472.88 1170.27 1477.53 Q1174.47 1482.14 1174.47 1490.1 M1168.61 1488.38 Q1168.55 1483.57 1165.91 1480.71 Q1163.3 1477.84 1158.97 1477.84 Q1154.07 1477.84 1151.11 1480.61 Q1148.18 1483.38 1147.73 1488.41 L1168.61 1488.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1189.75 1504.04 L1189.75 1522.94 L1183.86 1522.94 L1183.86 1473.74 L1189.75 1473.74 L1189.75 1479.15 Q1191.59 1475.97 1194.39 1474.44 Q1197.23 1472.88 1201.14 1472.88 Q1207.64 1472.88 1211.68 1478.03 Q1215.75 1483.19 1215.75 1491.59 Q1215.75 1500 1211.68 1505.15 Q1207.64 1510.31 1201.14 1510.31 Q1197.23 1510.31 1194.39 1508.78 Q1191.59 1507.22 1189.75 1504.04 M1209.67 1491.59 Q1209.67 1485.13 1207 1481.47 Q1204.36 1477.78 1199.71 1477.78 Q1195.06 1477.78 1192.39 1481.47 Q1189.75 1485.13 1189.75 1491.59 Q1189.75 1498.05 1192.39 1501.75 Q1195.06 1505.41 1199.71 1505.41 Q1204.36 1505.41 1207 1501.75 Q1209.67 1498.05 1209.67 1491.59 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1239.27 1477.84 Q1234.56 1477.84 1231.82 1481.54 Q1229.09 1485.2 1229.09 1491.59 Q1229.09 1497.99 1231.79 1501.68 Q1234.53 1505.34 1239.27 1505.34 Q1243.95 1505.34 1246.69 1501.65 Q1249.43 1497.96 1249.43 1491.59 Q1249.43 1485.26 1246.69 1481.57 Q1243.95 1477.84 1239.27 1477.84 M1239.27 1472.88 Q1246.91 1472.88 1251.27 1477.84 Q1255.63 1482.81 1255.63 1491.59 Q1255.63 1500.35 1251.27 1505.34 Q1246.91 1510.31 1239.27 1510.31 Q1231.6 1510.31 1227.24 1505.34 Q1222.91 1500.35 1222.91 1491.59 Q1222.91 1482.81 1227.24 1477.84 Q1231.6 1472.88 1239.27 1472.88 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1290.99 1475.11 L1290.99 1480.58 Q1288.51 1479.21 1286 1478.54 Q1283.51 1477.84 1280.97 1477.84 Q1275.27 1477.84 1272.12 1481.47 Q1268.97 1485.07 1268.97 1491.59 Q1268.97 1498.12 1272.12 1501.75 Q1275.27 1505.34 1280.97 1505.34 Q1283.51 1505.34 1286 1504.67 Q1288.51 1503.97 1290.99 1502.61 L1290.99 1508.02 Q1288.54 1509.16 1285.9 1509.74 Q1283.29 1510.31 1280.33 1510.31 Q1272.28 1510.31 1267.54 1505.25 Q1262.79 1500.19 1262.79 1491.59 Q1262.79 1482.87 1267.57 1477.88 Q1272.37 1472.88 1280.71 1472.88 Q1283.42 1472.88 1286 1473.45 Q1288.58 1473.99 1290.99 1475.11 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1330.81 1487.87 L1330.81 1509.39 L1324.96 1509.39 L1324.96 1488.06 Q1324.96 1483 1322.98 1480.49 Q1321.01 1477.97 1317.06 1477.97 Q1312.32 1477.97 1309.58 1480.99 Q1306.84 1484.02 1306.84 1489.24 L1306.84 1509.39 L1300.96 1509.39 L1300.96 1459.86 L1306.84 1459.86 L1306.84 1479.28 Q1308.95 1476.06 1311.78 1474.47 Q1314.64 1472.88 1318.37 1472.88 Q1324.51 1472.88 1327.66 1476.7 Q1330.81 1480.49 1330.81 1487.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1365.22 1474.79 L1365.22 1480.33 Q1362.74 1479.05 1360.06 1478.42 Q1357.39 1477.78 1354.52 1477.78 Q1350.16 1477.78 1347.97 1479.12 Q1345.8 1480.45 1345.8 1483.13 Q1345.8 1485.16 1347.36 1486.34 Q1348.92 1487.49 1353.63 1488.54 L1355.64 1488.98 Q1361.88 1490.32 1364.49 1492.77 Q1367.13 1495.19 1367.13 1499.55 Q1367.13 1504.52 1363.18 1507.41 Q1359.27 1510.31 1352.39 1510.31 Q1349.53 1510.31 1346.41 1509.74 Q1343.32 1509.19 1339.88 1508.08 L1339.88 1502.03 Q1343.13 1503.72 1346.28 1504.58 Q1349.43 1505.41 1352.52 1505.41 Q1356.66 1505.41 1358.88 1504.01 Q1361.11 1502.57 1361.11 1500 Q1361.11 1497.61 1359.49 1496.34 Q1357.9 1495.06 1352.46 1493.88 L1350.42 1493.41 Q1344.98 1492.26 1342.56 1489.91 Q1340.14 1487.52 1340.14 1483.38 Q1340.14 1478.35 1343.7 1475.62 Q1347.27 1472.88 1353.82 1472.88 Q1357.07 1472.88 1359.93 1473.36 Q1362.8 1473.83 1365.22 1474.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="251.804,1330.18 2256.76,1330.18 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="251.804,1034.78 2256.76,1034.78 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="251.804,739.379 2256.76,739.379 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="251.804,443.98 2256.76,443.98 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="251.804,148.58 2256.76,148.58 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,1347.54 251.804,47.2441 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,1330.18 270.702,1330.18 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,1034.78 270.702,1034.78 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,739.379 270.702,739.379 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,443.98 270.702,443.98 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.804,148.58 270.702,148.58 "></polyline>
<path clip-path="url(#clip900)" d="M115.882 1349.97 L123.52 1349.97 L123.52 1323.6 L115.21 1325.27 L115.21 1321.01 L123.474 1319.35 L128.15 1319.35 L128.15 1349.97 L135.789 1349.97 L135.789 1353.91 L115.882 1353.91 L115.882 1349.97 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M155.233 1322.42 Q151.622 1322.42 149.793 1325.99 Q147.988 1329.53 147.988 1336.66 Q147.988 1343.77 149.793 1347.33 Q151.622 1350.87 155.233 1350.87 Q158.868 1350.87 160.673 1347.33 Q162.502 1343.77 162.502 1336.66 Q162.502 1329.53 160.673 1325.99 Q158.868 1322.42 155.233 1322.42 M155.233 1318.72 Q161.043 1318.72 164.099 1323.33 Q167.178 1327.91 167.178 1336.66 Q167.178 1345.39 164.099 1349.99 Q161.043 1354.58 155.233 1354.58 Q149.423 1354.58 146.344 1349.99 Q143.289 1345.39 143.289 1336.66 Q143.289 1327.91 146.344 1323.33 Q149.423 1318.72 155.233 1318.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M167.178 1312.82 L191.289 1312.82 L191.289 1316.02 L167.178 1316.02 L167.178 1312.82 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M207.614 1313.16 Q204.906 1313.16 203.345 1314.61 Q201.803 1316.06 201.803 1318.6 Q201.803 1321.13 203.345 1322.58 Q204.906 1324.03 207.614 1324.03 Q210.323 1324.03 211.884 1322.58 Q213.445 1321.12 213.445 1318.6 Q213.445 1316.06 211.884 1314.61 Q210.341 1313.16 207.614 1313.16 M203.815 1311.54 Q201.37 1310.94 199.997 1309.27 Q198.643 1307.59 198.643 1305.19 Q198.643 1301.82 201.032 1299.86 Q203.439 1297.91 207.614 1297.91 Q211.809 1297.91 214.197 1299.86 Q216.586 1301.82 216.586 1305.19 Q216.586 1307.59 215.213 1309.27 Q213.859 1310.94 211.432 1311.54 Q214.178 1312.18 215.702 1314.04 Q217.244 1315.91 217.244 1318.6 Q217.244 1322.68 214.743 1324.86 Q212.26 1327.04 207.614 1327.04 Q202.969 1327.04 200.467 1324.86 Q197.985 1322.68 197.985 1318.6 Q197.985 1315.91 199.527 1314.04 Q201.069 1312.18 203.815 1311.54 M202.423 1305.54 Q202.423 1307.73 203.778 1308.95 Q205.151 1310.17 207.614 1310.17 Q210.059 1310.17 211.432 1308.95 Q212.824 1307.73 212.824 1305.54 Q212.824 1303.36 211.432 1302.14 Q210.059 1300.92 207.614 1300.92 Q205.151 1300.92 203.778 1302.14 Q202.423 1303.36 202.423 1305.54 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M116.54 1054.57 L124.179 1054.57 L124.179 1028.21 L115.869 1029.87 L115.869 1025.61 L124.132 1023.95 L128.808 1023.95 L128.808 1054.57 L136.447 1054.57 L136.447 1058.51 L116.54 1058.51 L116.54 1054.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M155.892 1027.02 Q152.28 1027.02 150.452 1030.59 Q148.646 1034.13 148.646 1041.26 Q148.646 1048.37 150.452 1051.93 Q152.28 1055.47 155.892 1055.47 Q159.526 1055.47 161.331 1051.93 Q163.16 1048.37 163.16 1041.26 Q163.16 1034.13 161.331 1030.59 Q159.526 1027.02 155.892 1027.02 M155.892 1023.32 Q161.702 1023.32 164.757 1027.93 Q167.836 1032.51 167.836 1041.26 Q167.836 1049.99 164.757 1054.59 Q161.702 1059.18 155.892 1059.18 Q150.081 1059.18 147.003 1054.59 Q143.947 1049.99 143.947 1041.26 Q143.947 1032.51 147.003 1027.93 Q150.081 1023.32 155.892 1023.32 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M167.836 1017.42 L191.947 1017.42 L191.947 1020.62 L167.836 1020.62 L167.836 1017.42 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M199.188 1003.02 L217.244 1003.02 L217.244 1004.63 L207.05 1031.1 L203.082 1031.1 L212.674 1006.21 L199.188 1006.21 L199.188 1003.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M115.675 759.172 L123.314 759.172 L123.314 732.806 L115.003 734.473 L115.003 730.213 L123.267 728.547 L127.943 728.547 L127.943 759.172 L135.582 759.172 L135.582 763.107 L115.675 763.107 L115.675 759.172 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M155.026 731.625 Q151.415 731.625 149.587 735.19 Q147.781 738.732 147.781 745.862 Q147.781 752.968 149.587 756.533 Q151.415 760.074 155.026 760.074 Q158.661 760.074 160.466 756.533 Q162.295 752.968 162.295 745.862 Q162.295 738.732 160.466 735.19 Q158.661 731.625 155.026 731.625 M155.026 727.922 Q160.837 727.922 163.892 732.528 Q166.971 737.112 166.971 745.862 Q166.971 754.588 163.892 759.195 Q160.837 763.778 155.026 763.778 Q149.216 763.778 146.138 759.195 Q143.082 754.588 143.082 745.862 Q143.082 737.112 146.138 732.528 Q149.216 727.922 155.026 727.922 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M166.971 722.023 L191.082 722.023 L191.082 725.22 L166.971 725.22 L166.971 722.023 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M207.878 720.142 Q205.32 720.142 203.815 721.891 Q202.329 723.641 202.329 726.687 Q202.329 729.716 203.815 731.483 Q205.32 733.233 207.878 733.233 Q210.436 733.233 211.921 731.483 Q213.426 729.716 213.426 726.687 Q213.426 723.641 211.921 721.891 Q210.436 720.142 207.878 720.142 M215.42 708.237 L215.42 711.698 Q213.99 711.021 212.523 710.663 Q211.075 710.306 209.646 710.306 Q205.884 710.306 203.89 712.845 Q201.916 715.384 201.633 720.519 Q202.743 718.882 204.417 718.017 Q206.091 717.133 208.103 717.133 Q212.335 717.133 214.78 719.71 Q217.244 722.268 217.244 726.687 Q217.244 731.013 214.686 733.628 Q212.128 736.242 207.878 736.242 Q203.006 736.242 200.43 732.518 Q197.853 728.775 197.853 721.685 Q197.853 715.027 201.013 711.077 Q204.173 707.109 209.495 707.109 Q210.925 707.109 212.373 707.391 Q213.84 707.673 215.42 708.237 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M116.615 463.772 L124.254 463.772 L124.254 437.407 L115.944 439.073 L115.944 434.814 L124.208 433.147 L128.884 433.147 L128.884 463.772 L136.522 463.772 L136.522 467.707 L116.615 467.707 L116.615 463.772 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M155.967 436.226 Q152.356 436.226 150.527 439.791 Q148.721 443.333 148.721 450.462 Q148.721 457.569 150.527 461.133 Q152.356 464.675 155.967 464.675 Q159.601 464.675 161.407 461.133 Q163.235 457.569 163.235 450.462 Q163.235 443.333 161.407 439.791 Q159.601 436.226 155.967 436.226 M155.967 432.522 Q161.777 432.522 164.832 437.129 Q167.911 441.712 167.911 450.462 Q167.911 459.189 164.832 463.795 Q161.777 468.379 155.967 468.379 Q150.157 468.379 147.078 463.795 Q144.022 459.189 144.022 450.462 Q144.022 441.712 147.078 437.129 Q150.157 432.522 155.967 432.522 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M167.911 426.624 L192.023 426.624 L192.023 429.821 L167.911 429.821 L167.911 426.624 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M200.261 412.217 L215.175 412.217 L215.175 415.414 L203.74 415.414 L203.74 422.298 Q204.568 422.016 205.395 421.884 Q206.223 421.734 207.05 421.734 Q211.752 421.734 214.498 424.31 Q217.244 426.887 217.244 431.288 Q217.244 435.821 214.423 438.341 Q211.602 440.842 206.467 440.842 Q204.699 440.842 202.856 440.541 Q201.032 440.241 199.076 439.639 L199.076 435.821 Q200.768 436.742 202.574 437.194 Q204.379 437.645 206.392 437.645 Q209.646 437.645 211.545 435.934 Q213.445 434.222 213.445 431.288 Q213.445 428.354 211.545 426.643 Q209.646 424.931 206.392 424.931 Q204.868 424.931 203.345 425.27 Q201.84 425.608 200.261 426.323 L200.261 412.217 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M115.411 168.373 L123.05 168.373 L123.05 142.007 L114.74 143.674 L114.74 139.415 L123.004 137.748 L127.68 137.748 L127.68 168.373 L135.319 168.373 L135.319 172.308 L115.411 172.308 L115.411 168.373 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M154.763 140.827 Q151.152 140.827 149.323 144.391 Q147.518 147.933 147.518 155.063 Q147.518 162.169 149.323 165.734 Q151.152 169.276 154.763 169.276 Q158.397 169.276 160.203 165.734 Q162.032 162.169 162.032 155.063 Q162.032 147.933 160.203 144.391 Q158.397 140.827 154.763 140.827 M154.763 137.123 Q160.573 137.123 163.629 141.729 Q166.707 146.313 166.707 155.063 Q166.707 163.79 163.629 168.396 Q160.573 172.979 154.763 172.979 Q148.953 172.979 145.874 168.396 Q142.819 163.79 142.819 155.063 Q142.819 146.313 145.874 141.729 Q148.953 137.123 154.763 137.123 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M166.707 131.224 L190.819 131.224 L190.819 134.422 L166.707 134.422 L166.707 131.224 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M209.458 120.128 L199.866 135.118 L209.458 135.118 L209.458 120.128 M208.461 116.818 L213.238 116.818 L213.238 135.118 L217.244 135.118 L217.244 138.277 L213.238 138.277 L213.238 144.898 L209.458 144.898 L209.458 138.277 L196.781 138.277 L196.781 134.61 L208.461 116.818 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M18.4042 761.509 L18.4042 751.929 L50.7419 739.802 L18.4042 727.612 L18.4042 718.031 L65.9242 718.031 L65.9242 724.301 L24.197 724.301 L56.7894 736.555 L56.7894 743.017 L24.197 755.271 L65.9242 755.271 L65.9242 761.509 L18.4042 761.509 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M19.9638 676.781 L26.234 676.781 Q24.4834 680.442 23.624 683.688 Q22.7647 686.935 22.7647 689.958 Q22.7647 695.21 24.8017 698.075 Q26.8387 700.907 30.5945 700.907 Q33.7455 700.907 35.3688 699.03 Q36.9602 697.12 37.9469 691.836 L38.7426 687.953 Q40.1112 680.76 43.5805 677.354 Q47.018 673.917 52.8108 673.917 Q59.7176 673.917 63.2824 678.564 Q66.8472 683.179 66.8472 692.123 Q66.8472 695.497 66.0833 699.316 Q65.3194 703.104 63.8235 707.178 L57.2031 707.178 Q59.3993 703.263 60.5133 699.507 Q61.6273 695.751 61.6273 692.123 Q61.6273 686.616 59.463 683.625 Q57.2986 680.633 53.2882 680.633 Q49.7871 680.633 47.8137 682.797 Q45.8404 684.929 44.8537 689.831 L44.0898 693.746 Q42.6575 700.939 39.602 704.154 Q36.5464 707.369 31.1037 707.369 Q24.8017 707.369 21.1732 702.944 Q17.5448 698.488 17.5448 690.69 Q17.5448 687.348 18.1495 683.879 Q18.7543 680.41 19.9638 676.781 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M18.4042 663.891 L18.4042 633.845 L23.815 633.845 L23.815 657.461 L37.8832 657.461 L37.8832 634.831 L43.2941 634.831 L43.2941 657.461 L60.5133 657.461 L60.5133 633.272 L65.9242 633.272 L65.9242 663.891 L18.4042 663.891 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><circle clip-path="url(#clip902)" cx="308.548" cy="95.0524" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip902)" cx="939.036" cy="305.192" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip902)" cx="1569.52" cy="601.49" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip902)" cx="2200.01" cy="823.588" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<polyline clip-path="url(#clip902)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="308.548,84.0448 327.654,91.5657 346.759,99.0867 365.865,106.608 384.971,114.129 404.076,121.649 423.182,129.17 442.288,136.691 461.393,144.212 480.499,151.733 499.605,159.254 518.711,166.775 537.816,174.296 556.922,181.817 576.028,189.338 595.133,196.859 614.239,204.38 633.345,211.9 652.45,219.421 671.556,226.942 690.662,234.463 709.768,241.984 728.873,249.505 747.979,257.026 767.085,264.547 786.19,272.068 805.296,279.589 824.402,287.11 843.507,294.631 862.613,302.152 881.719,309.672 900.825,317.193 919.93,324.714 939.036,332.235 958.142,339.756 977.247,347.277 996.353,354.798 1015.46,362.319 1034.56,369.84 1053.67,377.361 1072.78,384.882 1091.88,392.403 1110.99,399.923 1130.09,407.444 1149.2,414.965 1168.3,422.486 1187.41,430.007 1206.52,437.528 1225.62,445.049 1244.73,452.57 1263.83,460.091 1282.94,467.612 1302.04,475.133 1321.15,482.654 1340.26,490.175 1359.36,497.695 1378.47,505.216 1397.57,512.737 1416.68,520.258 1435.78,527.779 1454.89,535.3 1474,542.821 1493.1,550.342 1512.21,557.863 1531.31,565.384 1550.42,572.905 1569.52,580.426 1588.63,587.946 1607.74,595.467 1626.84,602.988 1645.95,610.509 1665.05,618.03 1684.16,625.551 1703.26,633.072 1722.37,640.593 1741.48,648.114 1760.58,655.635 1779.69,663.156 1798.79,670.677 1817.9,678.198 1837,685.718 1856.11,693.239 1875.22,700.76 1894.32,708.281 1913.43,715.802 1932.53,723.323 1951.64,730.844 1970.74,738.365 1989.85,745.886 2008.96,753.407 2028.06,760.928 2047.17,768.449 2066.27,775.969 2085.38,783.49 2104.48,791.011 2123.59,798.532 2142.69,806.053 2161.8,813.574 2180.91,821.095 2200.01,828.616 "></polyline>
<circle clip-path="url(#clip902)" cx="308.548" cy="405.721" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip902)" cx="939.036" cy="637.967" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip902)" cx="1569.52" cy="853.628" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip902)" cx="2200.01" cy="1310.74" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<polyline clip-path="url(#clip902)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="308.548,362.407 327.654,371.288 346.759,380.169 365.865,389.05 384.971,397.931 404.076,406.812 423.182,415.693 442.288,424.574 461.393,433.454 480.499,442.335 499.605,451.216 518.711,460.097 537.816,468.978 556.922,477.859 576.028,486.74 595.133,495.621 614.239,504.502 633.345,513.383 652.45,522.264 671.556,531.145 690.662,540.026 709.768,548.906 728.873,557.787 747.979,566.668 767.085,575.549 786.19,584.43 805.296,593.311 824.402,602.192 843.507,611.073 862.613,619.954 881.719,628.835 900.825,637.716 919.93,646.597 939.036,655.478 958.142,664.359 977.247,673.239 996.353,682.12 1015.46,691.001 1034.56,699.882 1053.67,708.763 1072.78,717.644 1091.88,726.525 1110.99,735.406 1130.09,744.287 1149.2,753.168 1168.3,762.049 1187.41,770.93 1206.52,779.811 1225.62,788.692 1244.73,797.572 1263.83,806.453 1282.94,815.334 1302.04,824.215 1321.15,833.096 1340.26,841.977 1359.36,850.858 1378.47,859.739 1397.57,868.62 1416.68,877.501 1435.78,886.382 1454.89,895.263 1474,904.144 1493.1,913.024 1512.21,921.905 1531.31,930.786 1550.42,939.667 1569.52,948.548 1588.63,957.429 1607.74,966.31 1626.84,975.191 1645.95,984.072 1665.05,992.953 1684.16,1001.83 1703.26,1010.71 1722.37,1019.6 1741.48,1028.48 1760.58,1037.36 1779.69,1046.24 1798.79,1055.12 1817.9,1064 1837,1072.88 1856.11,1081.76 1875.22,1090.64 1894.32,1099.52 1913.43,1108.4 1932.53,1117.29 1951.64,1126.17 1970.74,1135.05 1989.85,1143.93 2008.96,1152.81 2028.06,1161.69 2047.17,1170.57 2066.27,1179.45 2085.38,1188.33 2104.48,1197.21 2123.59,1206.1 2142.69,1214.98 2161.8,1223.86 2180.91,1232.74 2200.01,1241.62 "></polyline>
<path clip-path="url(#clip900)" d="M1845.19 246.107 L2189.92 246.107 L2189.92 90.5872 L1845.19 90.5872  Z" fill="#f0f1eb" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1845.19,246.107 2189.92,246.107 2189.92,90.5872 1845.19,90.5872 1845.19,246.107 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1867.47,142.427 2001.13,142.427 "></polyline>
<path clip-path="url(#clip900)" d="M2023.94 125.147 L2051.1 125.147 L2051.1 128.712 L2029.24 155.772 L2051.63 155.772 L2051.63 159.707 L2023.41 159.707 L2023.41 156.142 L2045.26 129.082 L2023.94 129.082 L2023.94 125.147 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M2056.42 125.147 L2083.57 125.147 L2083.57 128.712 L2061.72 155.772 L2084.11 155.772 L2084.11 159.707 L2055.89 159.707 L2055.89 156.142 L2077.74 129.082 L2056.42 129.082 L2056.42 125.147 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip900)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1867.47,194.267 2001.13,194.267 "></polyline>
<path clip-path="url(#clip900)" d="M2023.94 176.987 L2051.1 176.987 L2051.1 180.552 L2029.24 207.612 L2051.63 207.612 L2051.63 211.547 L2023.41 211.547 L2023.41 207.982 L2045.26 180.922 L2023.94 180.922 L2023.94 176.987 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M2056.42 176.987 L2083.57 176.987 L2083.57 180.552 L2061.72 207.612 L2084.11 207.612 L2084.11 211.547 L2055.89 211.547 L2055.89 207.982 L2077.74 180.922 L2056.42 180.922 L2056.42 176.987 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M2087.72 196.663 L2100.19 196.663 L2100.19 200.459 L2087.72 200.459 L2087.72 196.663 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M2133.04 179.649 L2133.04 184.58 Q2130.68 182.381 2127.99 181.293 Q2125.33 180.205 2122.32 180.205 Q2116.4 180.205 2113.25 183.839 Q2110.1 187.45 2110.1 194.302 Q2110.1 201.131 2113.25 204.765 Q2116.4 208.376 2122.32 208.376 Q2125.33 208.376 2127.99 207.288 Q2130.68 206.2 2133.04 204.001 L2133.04 208.885 Q2130.59 210.552 2127.83 211.385 Q2125.1 212.218 2122.05 212.218 Q2114.2 212.218 2109.68 207.427 Q2105.17 202.612 2105.17 194.302 Q2105.17 185.969 2109.68 181.177 Q2114.2 176.362 2122.05 176.362 Q2125.15 176.362 2127.88 177.196 Q2130.63 178.006 2133.04 179.649 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M2149.17 211.547 L2135.98 176.987 L2140.86 176.987 L2151.81 206.084 L2162.79 176.987 L2167.65 176.987 L2154.48 211.547 L2149.17 211.547 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
<p>これは換言すれば横軸が「ズルい」ということでもあるが，同時に <span class="math inline">\(n\to\infty\)</span> の極限では，圧倒的に ZZ-CV が効率的になるということでもある．<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
</section>
<section id="mala-との比較" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="mala-との比較"><span class="header-section-number">6</span> MALA との比較</h2>
<div id="3cb403f7" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>MALA のセットアップ</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AdvancedHMC</span>, <span class="bu">AdvancedMH</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StructArrays</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LinearAlgebra</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> LogTargetDensity</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    y<span class="op">::</span><span class="dt">Vector{Float64}</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">U</span>(i, x, y)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    x[<span class="fl">1</span>] <span class="op">*</span> x[<span class="fl">1</span>] <span class="op">/</span> (<span class="fl">2</span> <span class="op">*</span> ρ <span class="op">*</span> ρ) <span class="op">+</span> <span class="fu">length</span>(y) <span class="op">*</span> (x[<span class="fl">1</span>] <span class="op">-</span> y[i]) <span class="op">*</span> (x[<span class="fl">1</span>] <span class="op">-</span> y[i]) <span class="op">/</span> (<span class="fl">2</span> <span class="op">*</span> σ <span class="op">*</span> σ)  <span class="co"># 自動微分のために x は長さ1のベクトルと扱う必要がある</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">U</span>(x, y)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    vec <span class="op">=</span> [<span class="fu">U</span>(i, x, y) for i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(y)]</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">mean</span>(vec)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(p<span class="op">::</span><span class="dt">LogTargetDensity</span>, x) <span class="op">=</span> <span class="fu">U</span>(x, p.y)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(p<span class="op">::</span><span class="dt">LogTargetDensity</span>) <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(<span class="op">::</span><span class="dt">Type{LogTargetDensity}</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>model_with_ad <span class="op">=</span> LogDensityProblemsAD.<span class="fu">ADgradient</span>(<span class="fu">Val</span>(<span class="op">:</span>ForwardDiff), <span class="fu">LogTargetDensity</span>(y1))</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co"># σ² = 0.1 # ほぼ横ばい</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co"># σ² = 0.5 # １回小さいエポック10で効率勝った＋全く横ばいになった</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>σ² <span class="op">=</span> <span class="fl">0.2</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>spl <span class="op">=</span> <span class="fu">MALA</span>(x <span class="op">-&gt;</span> <span class="fu">MvNormal</span>((σ² <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> x, σ² <span class="op">*</span> I))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="a4b31e5e" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>実験の実行</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">experiment_MALA</span>(epoch_list, N, y)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    SE_sum <span class="op">=</span> <span class="fu">zero</span>(epoch_list)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>N</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        chain <span class="op">=</span> <span class="fu">sample</span>(model_with_ad, spl, <span class="fu">Int64</span>(epoch_list[<span class="kw">end</span>]); initial_params<span class="op">=</span>[x0], chain_type<span class="op">=</span>StructArray, param_names<span class="op">=</span>[<span class="st">"x"</span>], stats<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        traj_MALA <span class="op">=</span> <span class="fu">Vector</span><span class="dt">{Float64}</span>(chain.x)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        SE_list <span class="op">=</span> []</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> T <span class="kw">in</span> epoch_list</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>            SE <span class="op">=</span> <span class="fu">SquaredError</span>(traj_MALA[<span class="fl">1</span><span class="op">:</span>T], y)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(SE_list, SE)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>        SE_sum <span class="op">+=</span> SE_list</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> SE_sum <span class="op">./</span> N</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>MSE_MALA <span class="op">=</span> <span class="fu">experiment_MALA</span>(<span class="fu">Vector</span><span class="dt">{Int64}</span>(epoch_list), N, y1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="43830e06" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>結果のプロット</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter!</span>(p, epoch_list, MSE_MALA,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    marker<span class="op">=:</span>circle,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    markersize<span class="op">=</span><span class="fl">5</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    markeralpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"blue"</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="cn">nothing</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="fu">DataFrame</span>(X <span class="op">=</span> <span class="fu">log10</span>.(epoch_list), Y <span class="op">=</span> <span class="fu">log10</span>.(MSE_MALA))</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">lm</span>(<span class="pp">@formula</span>(Y <span class="op">~</span> X), df)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>X_pred <span class="op">=</span> <span class="fu">range</span>(<span class="fu">minimum</span>(df.X), <span class="fu">maximum</span>(df.X), length<span class="op">=</span><span class="fl">100</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>Y_pred <span class="op">=</span> <span class="fu">predict</span>(model, <span class="fu">DataFrame</span>(X <span class="op">=</span> X_pred))</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(p, <span class="fl">10</span> <span class="op">.^</span> X_pred, <span class="fl">10</span> <span class="op">.^</span> Y_pred,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=:</span>solid,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    linewidth<span class="op">=</span><span class="fl">2</span>,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"blue"</span>,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">"MALA"</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="576" height="384" viewbox="0 0 2304 1536">
<defs>
  <clippath id="clip030">
    <rect x="0" y="0" width="2304" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip030)" d="M0 1536 L2304 1536 L2304 8.52651e-14 L0 8.52651e-14  Z" fill="#f0f1eb" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip031">
    <rect x="460" y="0" width="1614" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip030)" d="M251.541 1347.54 L2256.76 1347.54 L2256.76 47.2441 L251.541 47.2441  Z" fill="#f0f1eb" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip032">
    <rect x="251" y="47" width="2006" height="1301"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip032)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="938.863,1347.54 938.863,47.2441 "></polyline>
<polyline clip-path="url(#clip032)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2200,1347.54 2200,47.2441 "></polyline>
<polyline clip-path="url(#clip030)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.541,1347.54 2256.76,1347.54 "></polyline>
<polyline clip-path="url(#clip030)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="938.863,1347.54 938.863,1328.64 "></polyline>
<polyline clip-path="url(#clip030)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2200,1347.54 2200,1328.64 "></polyline>
<path clip-path="url(#clip030)" d="M904.636 1420.89 L912.274 1420.89 L912.274 1394.53 L903.964 1396.19 L903.964 1391.94 L912.228 1390.27 L916.904 1390.27 L916.904 1420.89 L924.543 1420.89 L924.543 1424.83 L904.636 1424.83 L904.636 1420.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M943.987 1393.35 Q940.376 1393.35 938.547 1396.91 Q936.742 1400.45 936.742 1407.58 Q936.742 1414.69 938.547 1418.25 Q940.376 1421.8 943.987 1421.8 Q947.621 1421.8 949.427 1418.25 Q951.256 1414.69 951.256 1407.58 Q951.256 1400.45 949.427 1396.91 Q947.621 1393.35 943.987 1393.35 M943.987 1389.64 Q949.797 1389.64 952.853 1394.25 Q955.932 1398.83 955.932 1407.58 Q955.932 1416.31 952.853 1420.92 Q949.797 1425.5 943.987 1425.5 Q938.177 1425.5 935.098 1420.92 Q932.043 1416.31 932.043 1407.58 Q932.043 1398.83 935.098 1394.25 Q938.177 1389.64 943.987 1389.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M960.502 1394.22 L973.761 1394.22 L973.761 1397.42 L955.932 1397.42 L955.932 1394.22 Q958.095 1391.98 961.818 1388.22 Q965.561 1384.44 966.52 1383.35 Q968.345 1381.3 969.059 1379.89 Q969.793 1378.46 969.793 1377.09 Q969.793 1374.85 968.213 1373.44 Q966.652 1372.03 964.132 1372.03 Q962.345 1372.03 960.351 1372.65 Q958.377 1373.27 956.12 1374.53 L956.12 1370.69 Q958.414 1369.77 960.408 1369.3 Q962.402 1368.83 964.057 1368.83 Q968.42 1368.83 971.015 1371.01 Q973.611 1373.19 973.611 1376.84 Q973.611 1378.57 972.953 1380.13 Q972.313 1381.68 970.602 1383.78 Q970.131 1384.33 967.611 1386.94 Q965.091 1389.54 960.502 1394.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M2164.46 1420.89 L2172.1 1420.89 L2172.1 1394.53 L2163.79 1396.19 L2163.79 1391.94 L2172.05 1390.27 L2176.73 1390.27 L2176.73 1420.89 L2184.37 1420.89 L2184.37 1424.83 L2164.46 1424.83 L2164.46 1420.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M2203.81 1393.35 Q2200.2 1393.35 2198.37 1396.91 Q2196.57 1400.45 2196.57 1407.58 Q2196.57 1414.69 2198.37 1418.25 Q2200.2 1421.8 2203.81 1421.8 Q2207.45 1421.8 2209.25 1418.25 Q2211.08 1414.69 2211.08 1407.58 Q2211.08 1400.45 2209.25 1396.91 Q2207.45 1393.35 2203.81 1393.35 M2203.81 1389.64 Q2209.62 1389.64 2212.68 1394.25 Q2215.76 1398.83 2215.76 1407.58 Q2215.76 1416.31 2212.68 1420.92 Q2209.62 1425.5 2203.81 1425.5 Q2198 1425.5 2194.92 1420.92 Q2191.87 1416.31 2191.87 1407.58 Q2191.87 1398.83 2194.92 1394.25 Q2198 1389.64 2203.81 1389.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M2228.43 1372.65 L2218.84 1387.64 L2228.43 1387.64 L2228.43 1372.65 M2227.44 1369.34 L2232.21 1369.34 L2232.21 1387.64 L2236.22 1387.64 L2236.22 1390.8 L2232.21 1390.8 L2232.21 1397.42 L2228.43 1397.42 L2228.43 1390.8 L2215.76 1390.8 L2215.76 1387.13 L2227.44 1369.34 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M1174.34 1490.1 L1174.34 1492.96 L1147.41 1492.96 Q1147.79 1499.01 1151.04 1502.19 Q1154.32 1505.34 1160.14 1505.34 Q1163.52 1505.34 1166.67 1504.52 Q1169.85 1503.69 1172.97 1502.03 L1172.97 1507.57 Q1169.82 1508.91 1166.51 1509.61 Q1163.2 1510.31 1159.79 1510.31 Q1151.26 1510.31 1146.27 1505.34 Q1141.3 1500.38 1141.3 1491.91 Q1141.3 1483.16 1146.01 1478.03 Q1150.75 1472.88 1158.77 1472.88 Q1165.97 1472.88 1170.14 1477.53 Q1174.34 1482.14 1174.34 1490.1 M1168.48 1488.38 Q1168.42 1483.57 1165.78 1480.71 Q1163.17 1477.84 1158.84 1477.84 Q1153.94 1477.84 1150.98 1480.61 Q1148.05 1483.38 1147.6 1488.41 L1168.48 1488.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M1189.62 1504.04 L1189.62 1522.94 L1183.73 1522.94 L1183.73 1473.74 L1189.62 1473.74 L1189.62 1479.15 Q1191.46 1475.97 1194.26 1474.44 Q1197.1 1472.88 1201.01 1472.88 Q1207.5 1472.88 1211.55 1478.03 Q1215.62 1483.19 1215.62 1491.59 Q1215.62 1500 1211.55 1505.15 Q1207.5 1510.31 1201.01 1510.31 Q1197.1 1510.31 1194.26 1508.78 Q1191.46 1507.22 1189.62 1504.04 M1209.54 1491.59 Q1209.54 1485.13 1206.87 1481.47 Q1204.23 1477.78 1199.58 1477.78 Q1194.93 1477.78 1192.26 1481.47 Q1189.62 1485.13 1189.62 1491.59 Q1189.62 1498.05 1192.26 1501.75 Q1194.93 1505.41 1199.58 1505.41 Q1204.23 1505.41 1206.87 1501.75 Q1209.54 1498.05 1209.54 1491.59 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M1239.14 1477.84 Q1234.43 1477.84 1231.69 1481.54 Q1228.96 1485.2 1228.96 1491.59 Q1228.96 1497.99 1231.66 1501.68 Q1234.4 1505.34 1239.14 1505.34 Q1243.82 1505.34 1246.56 1501.65 Q1249.29 1497.96 1249.29 1491.59 Q1249.29 1485.26 1246.56 1481.57 Q1243.82 1477.84 1239.14 1477.84 M1239.14 1472.88 Q1246.78 1472.88 1251.14 1477.84 Q1255.5 1482.81 1255.5 1491.59 Q1255.5 1500.35 1251.14 1505.34 Q1246.78 1510.31 1239.14 1510.31 Q1231.47 1510.31 1227.11 1505.34 Q1222.78 1500.35 1222.78 1491.59 Q1222.78 1482.81 1227.11 1477.84 Q1231.47 1472.88 1239.14 1472.88 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M1290.86 1475.11 L1290.86 1480.58 Q1288.38 1479.21 1285.87 1478.54 Q1283.38 1477.84 1280.84 1477.84 Q1275.14 1477.84 1271.99 1481.47 Q1268.84 1485.07 1268.84 1491.59 Q1268.84 1498.12 1271.99 1501.75 Q1275.14 1505.34 1280.84 1505.34 Q1283.38 1505.34 1285.87 1504.67 Q1288.38 1503.97 1290.86 1502.61 L1290.86 1508.02 Q1288.41 1509.16 1285.77 1509.74 Q1283.16 1510.31 1280.2 1510.31 Q1272.15 1510.31 1267.4 1505.25 Q1262.66 1500.19 1262.66 1491.59 Q1262.66 1482.87 1267.44 1477.88 Q1272.24 1472.88 1280.58 1472.88 Q1283.29 1472.88 1285.87 1473.45 Q1288.44 1473.99 1290.86 1475.11 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M1330.68 1487.87 L1330.68 1509.39 L1324.82 1509.39 L1324.82 1488.06 Q1324.82 1483 1322.85 1480.49 Q1320.88 1477.97 1316.93 1477.97 Q1312.19 1477.97 1309.45 1480.99 Q1306.71 1484.02 1306.71 1489.24 L1306.71 1509.39 L1300.82 1509.39 L1300.82 1459.86 L1306.71 1459.86 L1306.71 1479.28 Q1308.81 1476.06 1311.65 1474.47 Q1314.51 1472.88 1318.24 1472.88 Q1324.38 1472.88 1327.53 1476.7 Q1330.68 1480.49 1330.68 1487.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M1365.09 1474.79 L1365.09 1480.33 Q1362.6 1479.05 1359.93 1478.42 Q1357.26 1477.78 1354.39 1477.78 Q1350.03 1477.78 1347.84 1479.12 Q1345.67 1480.45 1345.67 1483.13 Q1345.67 1485.16 1347.23 1486.34 Q1348.79 1487.49 1353.5 1488.54 L1355.51 1488.98 Q1361.74 1490.32 1364.35 1492.77 Q1367 1495.19 1367 1499.55 Q1367 1504.52 1363.05 1507.41 Q1359.13 1510.31 1352.26 1510.31 Q1349.4 1510.31 1346.28 1509.74 Q1343.19 1509.19 1339.75 1508.08 L1339.75 1502.03 Q1343 1503.72 1346.15 1504.58 Q1349.3 1505.41 1352.39 1505.41 Q1356.52 1505.41 1358.75 1504.01 Q1360.98 1502.57 1360.98 1500 Q1360.98 1497.61 1359.36 1496.34 Q1357.77 1495.06 1352.32 1493.88 L1350.29 1493.41 Q1344.84 1492.26 1342.42 1489.91 Q1340.01 1487.52 1340.01 1483.38 Q1340.01 1478.35 1343.57 1475.62 Q1347.14 1472.88 1353.69 1472.88 Q1356.94 1472.88 1359.8 1473.36 Q1362.67 1473.83 1365.09 1474.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip032)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="251.541,910.215 2256.76,910.215 "></polyline>
<polyline clip-path="url(#clip032)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="251.541,288.989 2256.76,288.989 "></polyline>
<polyline clip-path="url(#clip030)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.541,1347.54 251.541,47.2441 "></polyline>
<polyline clip-path="url(#clip030)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.541,910.215 270.438,910.215 "></polyline>
<polyline clip-path="url(#clip030)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="251.541,288.989 270.438,288.989 "></polyline>
<path clip-path="url(#clip030)" d="M115.411 930.007 L123.05 930.007 L123.05 903.641 L114.74 905.308 L114.74 901.049 L123.004 899.382 L127.68 899.382 L127.68 930.007 L135.319 930.007 L135.319 933.942 L115.411 933.942 L115.411 930.007 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M154.763 902.461 Q151.152 902.461 149.323 906.026 Q147.518 909.567 147.518 916.697 Q147.518 923.803 149.323 927.368 Q151.152 930.91 154.763 930.91 Q158.397 930.91 160.203 927.368 Q162.032 923.803 162.032 916.697 Q162.032 909.567 160.203 906.026 Q158.397 902.461 154.763 902.461 M154.763 898.757 Q160.573 898.757 163.629 903.364 Q166.707 907.947 166.707 916.697 Q166.707 925.424 163.629 930.03 Q160.573 934.614 154.763 934.614 Q148.953 934.614 145.874 930.03 Q142.819 925.424 142.819 916.697 Q142.819 907.947 145.874 903.364 Q148.953 898.757 154.763 898.757 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M166.707 892.859 L190.819 892.859 L190.819 896.056 L166.707 896.056 L166.707 892.859 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M207.614 890.978 Q205.057 890.978 203.552 892.727 Q202.066 894.476 202.066 897.523 Q202.066 900.551 203.552 902.319 Q205.057 904.068 207.614 904.068 Q210.172 904.068 211.658 902.319 Q213.163 900.551 213.163 897.523 Q213.163 894.476 211.658 892.727 Q210.172 890.978 207.614 890.978 M215.156 879.072 L215.156 882.533 Q213.727 881.856 212.26 881.499 Q210.812 881.141 209.382 881.141 Q205.621 881.141 203.627 883.68 Q201.652 886.219 201.37 891.354 Q202.48 889.718 204.154 888.853 Q205.828 887.969 207.84 887.969 Q212.072 887.969 214.517 890.545 Q216.981 893.103 216.981 897.523 Q216.981 901.849 214.423 904.463 Q211.865 907.077 207.614 907.077 Q202.743 907.077 200.166 903.353 Q197.59 899.611 197.59 892.52 Q197.59 885.862 200.75 881.912 Q203.909 877.944 209.232 877.944 Q210.661 877.944 212.109 878.226 Q213.576 878.508 215.156 879.072 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M116.07 308.782 L123.709 308.782 L123.709 282.416 L115.398 284.083 L115.398 279.824 L123.662 278.157 L128.338 278.157 L128.338 308.782 L135.977 308.782 L135.977 312.717 L116.07 312.717 L116.07 308.782 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M155.421 281.236 Q151.81 281.236 149.982 284.8 Q148.176 288.342 148.176 295.472 Q148.176 302.578 149.982 306.143 Q151.81 309.685 155.421 309.685 Q159.056 309.685 160.861 306.143 Q162.69 302.578 162.69 295.472 Q162.69 288.342 160.861 284.8 Q159.056 281.236 155.421 281.236 M155.421 277.532 Q161.232 277.532 164.287 282.138 Q167.366 286.722 167.366 295.472 Q167.366 304.198 164.287 308.805 Q161.232 313.388 155.421 313.388 Q149.611 313.388 146.533 308.805 Q143.477 304.198 143.477 295.472 Q143.477 286.722 146.533 282.138 Q149.611 277.532 155.421 277.532 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M167.366 271.633 L191.477 271.633 L191.477 274.831 L167.366 274.831 L167.366 271.633 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M211.188 270.166 Q213.915 270.749 215.438 272.593 Q216.981 274.436 216.981 277.144 Q216.981 281.301 214.122 283.576 Q211.263 285.852 205.997 285.852 Q204.229 285.852 202.348 285.495 Q200.486 285.156 198.493 284.46 L198.493 280.793 Q200.072 281.714 201.953 282.184 Q203.834 282.655 205.884 282.655 Q209.458 282.655 211.32 281.244 Q213.2 279.833 213.2 277.144 Q213.2 274.661 211.451 273.27 Q209.721 271.859 206.618 271.859 L203.345 271.859 L203.345 268.737 L206.768 268.737 Q209.57 268.737 211.056 267.627 Q212.542 266.499 212.542 264.392 Q212.542 262.229 211 261.082 Q209.476 259.916 206.618 259.916 Q205.057 259.916 203.27 260.255 Q201.483 260.593 199.339 261.308 L199.339 257.922 Q201.502 257.321 203.383 257.02 Q205.282 256.719 206.956 256.719 Q211.282 256.719 213.802 258.694 Q216.322 260.65 216.322 263.997 Q216.322 266.33 214.987 267.947 Q213.652 269.546 211.188 270.166 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M18.4042 761.509 L18.4042 751.929 L50.7419 739.802 L18.4042 727.612 L18.4042 718.031 L65.9242 718.031 L65.9242 724.301 L24.197 724.301 L56.7894 736.555 L56.7894 743.017 L24.197 755.271 L65.9242 755.271 L65.9242 761.509 L18.4042 761.509 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M19.9638 676.781 L26.234 676.781 Q24.4834 680.442 23.624 683.688 Q22.7647 686.935 22.7647 689.958 Q22.7647 695.21 24.8017 698.075 Q26.8387 700.907 30.5945 700.907 Q33.7455 700.907 35.3688 699.03 Q36.9602 697.12 37.9469 691.836 L38.7426 687.953 Q40.1112 680.76 43.5805 677.354 Q47.018 673.917 52.8108 673.917 Q59.7176 673.917 63.2824 678.564 Q66.8472 683.179 66.8472 692.123 Q66.8472 695.497 66.0833 699.316 Q65.3194 703.104 63.8235 707.178 L57.2031 707.178 Q59.3993 703.263 60.5133 699.507 Q61.6273 695.751 61.6273 692.123 Q61.6273 686.616 59.463 683.625 Q57.2986 680.633 53.2882 680.633 Q49.7871 680.633 47.8137 682.797 Q45.8404 684.929 44.8537 689.831 L44.0898 693.746 Q42.6575 700.939 39.602 704.154 Q36.5464 707.369 31.1037 707.369 Q24.8017 707.369 21.1732 702.944 Q17.5448 698.488 17.5448 690.69 Q17.5448 687.348 18.1495 683.879 Q18.7543 680.41 19.9638 676.781 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M18.4042 663.891 L18.4042 633.845 L23.815 633.845 L23.815 657.461 L37.8832 657.461 L37.8832 634.831 L43.2941 634.831 L43.2941 657.461 L60.5133 657.461 L60.5133 633.272 L65.9242 633.272 L65.9242 663.891 L18.4042 663.891 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><circle clip-path="url(#clip032)" cx="308.292" cy="458.541" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip032)" cx="938.863" cy="605.849" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip032)" cx="1569.43" cy="813.554" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip032)" cx="2200" cy="969.245" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<polyline clip-path="url(#clip032)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="308.292,450.825 327.4,456.097 346.508,461.369 365.617,466.642 384.725,471.914 403.833,477.186 422.941,482.458 442.049,487.73 461.158,493.002 480.266,498.275 499.374,503.547 518.482,508.819 537.591,514.091 556.699,519.363 575.807,524.635 594.915,529.908 614.023,535.18 633.132,540.452 652.24,545.724 671.348,550.996 690.456,556.268 709.564,561.541 728.673,566.813 747.781,572.085 766.889,577.357 785.997,582.629 805.105,587.901 824.214,593.174 843.322,598.446 862.43,603.718 881.538,608.99 900.646,614.262 919.755,619.534 938.863,624.807 957.971,630.079 977.079,635.351 996.187,640.623 1015.3,645.895 1034.4,651.167 1053.51,656.44 1072.62,661.712 1091.73,666.984 1110.84,672.256 1129.94,677.528 1149.05,682.8 1168.16,688.073 1187.27,693.345 1206.38,698.617 1225.49,703.889 1244.59,709.161 1263.7,714.433 1282.81,719.706 1301.92,724.978 1321.03,730.25 1340.14,735.522 1359.24,740.794 1378.35,746.066 1397.46,751.339 1416.57,756.611 1435.68,761.883 1454.78,767.155 1473.89,772.427 1493,777.699 1512.11,782.972 1531.22,788.244 1550.33,793.516 1569.43,798.788 1588.54,804.06 1607.65,809.332 1626.76,814.605 1645.87,819.877 1664.97,825.149 1684.08,830.421 1703.19,835.693 1722.3,840.965 1741.41,846.238 1760.52,851.51 1779.62,856.782 1798.73,862.054 1817.84,867.326 1836.95,872.598 1856.06,877.871 1875.17,883.143 1894.27,888.415 1913.38,893.687 1932.49,898.959 1951.6,904.231 1970.71,909.504 1989.81,914.776 2008.92,920.048 2028.03,925.32 2047.14,930.592 2066.25,935.864 2085.36,941.137 2104.46,946.409 2123.57,951.681 2142.68,956.953 2161.79,962.225 2180.9,967.497 2200,972.77 "></polyline>
<circle clip-path="url(#clip032)" cx="308.292" cy="676.32" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip032)" cx="938.863" cy="839.125" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip032)" cx="1569.43" cy="990.303" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip032)" cx="2200" cy="1310.74" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<polyline clip-path="url(#clip032)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="308.292,645.957 327.4,652.183 346.508,658.408 365.617,664.634 384.725,670.859 403.833,677.085 422.941,683.31 442.049,689.536 461.158,695.761 480.266,701.987 499.374,708.212 518.482,714.438 537.591,720.663 556.699,726.889 575.807,733.114 594.915,739.34 614.023,745.566 633.132,751.791 652.24,758.017 671.348,764.242 690.456,770.468 709.564,776.693 728.673,782.919 747.781,789.144 766.889,795.37 785.997,801.595 805.105,807.821 824.214,814.046 843.322,820.272 862.43,826.497 881.538,832.723 900.646,838.949 919.755,845.174 938.863,851.4 957.971,857.625 977.079,863.851 996.187,870.076 1015.3,876.302 1034.4,882.527 1053.51,888.753 1072.62,894.978 1091.73,901.204 1110.84,907.429 1129.94,913.655 1149.05,919.88 1168.16,926.106 1187.27,932.332 1206.38,938.557 1225.49,944.783 1244.59,951.008 1263.7,957.234 1282.81,963.459 1301.92,969.685 1321.03,975.91 1340.14,982.136 1359.24,988.361 1378.35,994.587 1397.46,1000.81 1416.57,1007.04 1435.68,1013.26 1454.78,1019.49 1473.89,1025.71 1493,1031.94 1512.11,1038.17 1531.22,1044.39 1550.33,1050.62 1569.43,1056.84 1588.54,1063.07 1607.65,1069.29 1626.76,1075.52 1645.87,1081.74 1664.97,1087.97 1684.08,1094.2 1703.19,1100.42 1722.3,1106.65 1741.41,1112.87 1760.52,1119.1 1779.62,1125.32 1798.73,1131.55 1817.84,1137.77 1836.95,1144 1856.06,1150.23 1875.17,1156.45 1894.27,1162.68 1913.38,1168.9 1932.49,1175.13 1951.6,1181.35 1970.71,1187.58 1989.81,1193.8 2008.92,1200.03 2028.03,1206.25 2047.14,1212.48 2066.25,1218.71 2085.36,1224.93 2104.46,1231.16 2123.57,1237.38 2142.68,1243.61 2161.79,1249.83 2180.9,1256.06 2200,1262.28 "></polyline>
<circle clip-path="url(#clip032)" cx="308.292" cy="90.245" r="18" fill="#0000ff" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip032)" cx="938.863" cy="100.412" r="18" fill="#0000ff" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip032)" cx="1569.43" cy="221.556" r="18" fill="#0000ff" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<circle clip-path="url(#clip032)" cx="2200" cy="207.236" r="18" fill="#0000ff" fill-rule="evenodd" fill-opacity="0.6" stroke="#000000" stroke-opacity="0.6" stroke-width="3.072"></circle>
<polyline clip-path="url(#clip032)" style="stroke:#0000ff; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="308.292,84.0448 327.4,85.4755 346.508,86.9061 365.617,88.3368 384.725,89.7675 403.833,91.1981 422.941,92.6288 442.049,94.0594 461.158,95.4901 480.266,96.9207 499.374,98.3514 518.482,99.782 537.591,101.213 556.699,102.643 575.807,104.074 594.915,105.505 614.023,106.935 633.132,108.366 652.24,109.797 671.348,111.227 690.456,112.658 709.564,114.089 728.673,115.519 747.781,116.95 766.889,118.381 785.997,119.811 805.105,121.242 824.214,122.673 843.322,124.103 862.43,125.534 881.538,126.965 900.646,128.395 919.755,129.826 938.863,131.256 957.971,132.687 977.079,134.118 996.187,135.548 1015.3,136.979 1034.4,138.41 1053.51,139.84 1072.62,141.271 1091.73,142.702 1110.84,144.132 1129.94,145.563 1149.05,146.994 1168.16,148.424 1187.27,149.855 1206.38,151.286 1225.49,152.716 1244.59,154.147 1263.7,155.578 1282.81,157.008 1301.92,158.439 1321.03,159.87 1340.14,161.3 1359.24,162.731 1378.35,164.162 1397.46,165.592 1416.57,167.023 1435.68,168.454 1454.78,169.884 1473.89,171.315 1493,172.745 1512.11,174.176 1531.22,175.607 1550.33,177.037 1569.43,178.468 1588.54,179.899 1607.65,181.329 1626.76,182.76 1645.87,184.191 1664.97,185.621 1684.08,187.052 1703.19,188.483 1722.3,189.913 1741.41,191.344 1760.52,192.775 1779.62,194.205 1798.73,195.636 1817.84,197.067 1836.95,198.497 1856.06,199.928 1875.17,201.359 1894.27,202.789 1913.38,204.22 1932.49,205.651 1951.6,207.081 1970.71,208.512 1989.81,209.943 2008.92,211.373 2028.03,212.804 2047.14,214.235 2066.25,215.665 2085.36,217.096 2104.46,218.526 2123.57,219.957 2142.68,221.388 2161.79,222.818 2180.9,224.249 2200,225.68 "></polyline>
<path clip-path="url(#clip030)" d="M1845.16 297.947 L2189.92 297.947 L2189.92 90.5872 L1845.16 90.5872  Z" fill="#f0f1eb" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip030)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1845.16,297.947 2189.92,297.947 2189.92,90.5872 1845.16,90.5872 1845.16,297.947 "></polyline>
<polyline clip-path="url(#clip030)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1867.44,142.427 2001.12,142.427 "></polyline>
<path clip-path="url(#clip030)" d="M2023.93 125.147 L2051.08 125.147 L2051.08 128.712 L2029.23 155.772 L2051.62 155.772 L2051.62 159.707 L2023.4 159.707 L2023.4 156.142 L2045.25 129.082 L2023.93 129.082 L2023.93 125.147 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M2056.41 125.147 L2083.56 125.147 L2083.56 128.712 L2061.71 155.772 L2084.09 155.772 L2084.09 159.707 L2055.88 159.707 L2055.88 156.142 L2077.73 129.082 L2056.41 129.082 L2056.41 125.147 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip030)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1867.44,194.267 2001.12,194.267 "></polyline>
<path clip-path="url(#clip030)" d="M2023.93 176.987 L2051.08 176.987 L2051.08 180.552 L2029.23 207.612 L2051.62 207.612 L2051.62 211.547 L2023.4 211.547 L2023.4 207.982 L2045.25 180.922 L2023.93 180.922 L2023.93 176.987 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M2056.41 176.987 L2083.56 176.987 L2083.56 180.552 L2061.71 207.612 L2084.09 207.612 L2084.09 211.547 L2055.88 211.547 L2055.88 207.982 L2077.73 180.922 L2056.41 180.922 L2056.41 176.987 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M2087.71 196.663 L2100.18 196.663 L2100.18 200.459 L2087.71 200.459 L2087.71 196.663 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M2133.03 179.649 L2133.03 184.58 Q2130.67 182.381 2127.98 181.293 Q2125.32 180.205 2122.31 180.205 Q2116.39 180.205 2113.24 183.839 Q2110.09 187.45 2110.09 194.302 Q2110.09 201.131 2113.24 204.765 Q2116.39 208.376 2122.31 208.376 Q2125.32 208.376 2127.98 207.288 Q2130.67 206.2 2133.03 204.001 L2133.03 208.885 Q2130.58 210.552 2127.82 211.385 Q2125.09 212.218 2122.03 212.218 Q2114.19 212.218 2109.67 207.427 Q2105.16 202.612 2105.16 194.302 Q2105.16 185.969 2109.67 181.177 Q2114.19 176.362 2122.03 176.362 Q2125.14 176.362 2127.87 177.196 Q2130.62 178.006 2133.03 179.649 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M2149.16 211.547 L2135.97 176.987 L2140.85 176.987 L2151.8 206.084 L2162.77 176.987 L2167.64 176.987 L2154.46 211.547 L2149.16 211.547 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip030)" style="stroke:#0000ff; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1867.44,246.107 2001.12,246.107 "></polyline>
<path clip-path="url(#clip030)" d="M2023.4 228.827 L2030.37 228.827 L2039.19 252.346 L2048.05 228.827 L2055.02 228.827 L2055.02 263.387 L2050.46 263.387 L2050.46 233.04 L2041.55 256.744 L2036.85 256.744 L2027.94 233.04 L2027.94 263.387 L2023.4 263.387 L2023.4 228.827 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M2075.85 233.434 L2069.51 250.633 L2082.22 250.633 L2075.85 233.434 M2073.21 228.827 L2078.52 228.827 L2091.69 263.387 L2086.83 263.387 L2083.68 254.521 L2068.1 254.521 L2064.95 263.387 L2060.02 263.387 L2073.21 228.827 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M2096.73 228.827 L2101.41 228.827 L2101.41 259.452 L2118.24 259.452 L2118.24 263.387 L2096.73 263.387 L2096.73 228.827 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M2135.78 233.434 L2129.44 250.633 L2142.15 250.633 L2135.78 233.434 M2133.14 228.827 L2138.45 228.827 L2151.62 263.387 L2146.76 263.387 L2143.61 254.521 L2128.03 254.521 L2124.88 263.387 L2119.95 263.387 L2133.14 228.827 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
</section>
<section id="非一様な部分サンプリング" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="非一様な部分サンプリング"><span class="header-section-number">7</span> 非一様な部分サンプリング</h2>
<p>当然，必ずしも一様な分解 <span class="math display">\[
U(x)=\frac{1}{n}\sum_{j=1}^nU^j(x)
\]</span> に基づいた一様なサブサンプリング <span class="math inline">\(K\sim\mathrm{U}([n])\)</span> を行う必要はない．</p>
<p>剪定の手続きを棄却法とみると，重点サンプリングのアイデアを導入することで制御変数に依らない分散低減が狙える <span class="citation" data-cites="Sen+2020">(<a href="#ref-Sen+2020" role="doc-biblioref">Sen et al., 2020</a> importance subsampling strategy)</span>．</p>
<p>特に，比例的高次元極限や，不均衡データに対する<a href="../../../posts/2024/Stat/Logistic.html">ロジスティック回帰</a>では，事後分布が十分な集中性を持たないために制御変数の方法 <a href="#sec-ZZ-CV" class="quarto-xref">3</a> が十分な効率改善を示さないが，この重点サブサンプリングによれば効率の改善が見込める．</p>
<p>詳しくは，次稿参照：</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Stat/Logistic2.html" target="_blank">
            <img src="https://162348.github.io/posts/2024/Stat/Logistic2.svg" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">大規模な不均衡データに対するロジスティック回帰（後編）</h3>
                <p class="article-description">離散時間 MCMC から連続時間 MCMC へ</p>
            </div>
        </a>
    </div>
</div>




</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Andrieu-Livingstone2021" class="csl-entry" role="listitem">
Andrieu, C., and Livingstone, S. (2021). <a href="https://doi.org/10.1214/20-AOS2008"><span class="nocase">Peskun–Tierney ordering for Markovian Monte Carlo: Beyond the reversible scenario</span></a>. <em>The Annals of Statistics</em>, <em>49</em>(4), 1958–1981.
</div>
<div id="ref-Bierkens+2019" class="csl-entry" role="listitem">
Bierkens, J., Fearnhead, P., and Roberts, G. (2019). <a href="https://doi.org/10.1214/18-AOS1715"><span class="nocase">The Zig-Zag Process and Super-Efficient Sampling for Bayesian Analysis of Big Data</span></a>. <em>The Annals of Statistics</em>, <em>47</em>(3), 1288–1320.
</div>
<div id="ref-Fearnhead+2018-PDMC" class="csl-entry" role="listitem">
Fearnhead, P., Bierkens, J., Pollock, M., and Roberts, G. O. (2018). <a href="https://www.jstor.org/stable/26771007">Piecewise deterministic markov processes for continuous-time monte carlo</a>. <em>Statistical Science</em>, <em>33</em>(3), 386–412.
</div>
<div id="ref-Johnson1970" class="csl-entry" role="listitem">
Johnson, R. A. (1970). <a href="http://www.jstor.org/stable/2239239">Asymptotic expansions associated with posterior distributions</a>. <em>The Annals of Mathematical Statistics</em>, <em>41</em>(3), 851–864.
</div>
<div id="ref-Murphy2023" class="csl-entry" role="listitem">
Murphy, K. P. (2023). <em><a href="http://probml.github.io/book2">Probabilistic machine learning: Advanced topics</a></em>. MIT Press.
</div>
<div id="ref-Sen+2020" class="csl-entry" role="listitem">
Sen, D., Sachs, M., Lu, J., and Dunson, D. B. (2020). <a href="https://doi.org/10.1093/biomet/asaa035"><span class="nocase">Efficient posterior sampling for high-dimensional imbalanced logistic regression</span></a>. <em>Biometrika</em>, <em>107</em>(4), 1005–1012.
</div>
<div id="ref-Vasdekis2021" class="csl-entry" role="listitem">
Vasdekis, G. (2021). <em>On zig-zag extensions and related ergodicity properties</em> (PhD thesis). University of Warwick. Retrieved from <a href="http://webcat.warwick.ac.uk/record=b3714913">http://webcat.warwick.ac.uk/record=b3714913</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>この２点が両方肝心である．効率的なサブサンプリング推定量の開発が <span class="citation" data-cites="Fearnhead+2018-PDMC">(<a href="#ref-Fearnhead+2018-PDMC" role="doc-biblioref">Fearnhead et al., 2018</a>)</span> 以来議論の焦点になっている．<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><span class="citation" data-cites="Vasdekis2021">(<a href="#ref-Vasdekis2021" role="doc-biblioref">Vasdekis, 2021, p. 25</a>)</span> や <span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens et al., 2019, pp. 1302 定理4.1</a>)</span> も参照．<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens et al., 2019, pp. 1306–</a>)</span> 第5.1節参照．<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>実装は <code>ZigZagBoomerang</code> パッケージの <a href="https://github.com/mschauer/ZigZagBoomerang.jl/blob/master/src/zigzagboom1d.jl"><code>zigzagboom1d.jl</code></a> を参考にした．<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>ただし，例えば今回も計算時間で言えば長くなっていることに注意．<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/162348\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="162348/162348.github.io" data-repo-id="R_kgDOKlfKYQ" data-category="Announcements" data-category-id="DIC_kwDOKlfKYc4CgDmb" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" data-loading="lazy" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://162348.github.io/">
<p>Hirofumi Shiba</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/162348/162348.github.io/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ano2math5">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:shiba.hirofumi@ism.ac.jp">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../../blog.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>