<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="司馬 博文">

<title>Hirofumi Shiba - ベイズ統計学と統計物理学</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../profile.jpg" rel="icon" type="image/jpeg">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "?",
    "H"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-36GX2G6GLL"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-36GX2G6GLL', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="Hirofumi Shiba - ベイズ統計学と統計物理学">
<meta property="og:description" content="ノイズ付きで観測された情報を復元するデノイジング問題を，ベイズ統計学と統計力学の２つの観点から考える．ベイズ統計モデルはスピングラスモデルと同一視することができる．このことからも，一般に事後分布からのサンプリングが困難になりえることがよくわかる．">
<meta property="og:image" content="https://162348.github.io/posts/2024/Stat/profile.jpg">
<meta property="og:site_name" content="Hirofumi Shiba">
<meta name="twitter:title" content="Hirofumi Shiba - ベイズ統計学と統計物理学">
<meta name="twitter:description" content="ノイズ付きで観測された情報を復元するデノイジング問題を，ベイズ統計学と統計力学の２つの観点から考える．ベイズ統計モデルはスピングラスモデルと同一視することができる．このことからも，一般に事後分布からのサンプリングが困難になりえることがよくわかる．">
<meta name="twitter:image" content="https://162348.github.io/posts/2024/Stat/profile.jpg">
<meta name="twitter:creator" content="@ano2math5">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Hirofumi Shiba</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Sessions.html"> 
<span class="menu-text">Sessions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Japanese.html"> 
<span class="menu-text">自己紹介</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
    <a href="https://github.com/162348/162348.github.io/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">ベイズ統計学と統計物理学</h1>
            <p class="subtitle lead">スパース符号の復元を題材として</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Bayesian</div>
                <div class="quarto-category">Nature</div>
                <div class="quarto-category">Information</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>司馬 博文 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">6/20/2024</p>
      </div>
    </div>
    
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="block-title">概要</div>
      ノイズ付きで観測された情報を復元するデノイジング問題を，ベイズ統計学と統計力学の２つの観点から考える．ベイズ統計モデルはスピングラスモデルと同一視することができる．このことからも，一般に事後分布からのサンプリングが困難になりえることがよくわかる．
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#bayes-推定" id="toc-bayes-推定" class="nav-link active" data-scroll-target="#bayes-推定"><span class="header-section-number">1</span> Bayes 推定</a>
  <ul class="collapse">
  <li><a href="#設定" id="toc-設定" class="nav-link" data-scroll-target="#設定"><span class="header-section-number">1.1</span> 設定</a></li>
  <li><a href="#sec-example" id="toc-sec-example" class="nav-link" data-scroll-target="#sec-example"><span class="header-section-number">1.2</span> 例</a></li>
  <li><a href="#map-推定量" id="toc-map-推定量" class="nav-link" data-scroll-target="#map-推定量"><span class="header-section-number">1.3</span> MAP 推定量</a></li>
  <li><a href="#ベイズ最適推定量" id="toc-ベイズ最適推定量" class="nav-link" data-scroll-target="#ベイズ最適推定量"><span class="header-section-number">1.4</span> ベイズ最適推定量</a></li>
  </ul></li>
  <li><a href="#統計物理からの視点" id="toc-統計物理からの視点" class="nav-link" data-scroll-target="#統計物理からの視点"><span class="header-section-number">2</span> 統計物理からの視点</a>
  <ul class="collapse">
  <li><a href="#事後分布をある物理系の平衡分布と見る" id="toc-事後分布をある物理系の平衡分布と見る" class="nav-link" data-scroll-target="#事後分布をある物理系の平衡分布と見る"><span class="header-section-number">2.1</span> 事後分布をある物理系の平衡分布と見る</a></li>
  <li><a href="#sec-identification" id="toc-sec-identification" class="nav-link" data-scroll-target="#sec-identification"><span class="header-section-number">2.2</span> もう一つの見方</a></li>
  <li><a href="#西森対称性" id="toc-西森対称性" class="nav-link" data-scroll-target="#西森対称性"><span class="header-section-number">2.3</span> 西森対称性</a></li>
  <li><a href="#sec-MMSE-via-Nishimori" id="toc-sec-MMSE-via-Nishimori" class="nav-link" data-scroll-target="#sec-MMSE-via-Nishimori"><span class="header-section-number">2.4</span> 最小自乗誤差推定量</a></li>
  <li><a href="#kl-乖離度の微分としての分散" id="toc-kl-乖離度の微分としての分散" class="nav-link" data-scroll-target="#kl-乖離度の微分としての分散"><span class="header-section-number">2.5</span> KL 乖離度の微分としての分散</a></li>
  <li><a href="#stein-の補題" id="toc-stein-の補題" class="nav-link" data-scroll-target="#stein-の補題"><span class="header-section-number">2.6</span> Stein の補題</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<section id="bayes-推定" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="bayes-推定"><span class="header-section-number">1</span> Bayes 推定</h2>
<p>誤り訂正符号の文脈で Bayes （点）推定を考える．</p>
<p>誤り訂正符号は，Bayes 推定が自然に選好される格好の題材である．</p>
<section id="設定" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="設定"><span class="header-section-number">1.1</span> 設定</h3>
<p>情報源は無記憶で，確率分布 <span class="math inline">\(p(x)dx\)</span> に従うとし，通信路は，確率核 <span class="math inline">\(p(y|x)dy\)</span> に従うとする．</p>
<p>送信符号は１つの値 <span class="math inline">\(x^*\sim p(x)dx\)</span> であったとし，この単一の入力 <span class="math inline">\(x^*\)</span> を <span class="math inline">\(n\)</span> 回独立に観測する： <span class="math display">\[
y_1,\cdots,y_n\overset{\text{iid}}{\sim}p(y|x^*)dy.
\]</span></p>
<p>この観測を経たあと，送信符号 <span class="math inline">\(x^*\)</span> はいったい何だったのかを推定することを考えると，極めて自然に Bayes 推定が選択される．</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="純粋な解釈を持つ Bayes 推定">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
純粋な解釈を持つ Bayes 推定
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>まず，何の観測もない場合，<span class="math inline">\(x^*\)</span> の確率分布は <span class="math inline">\(p(x)dx\)</span> である（設定上）．</p>
<p>しかし，すでに観測 <span class="math inline">\(y_1,\cdots,y_n\)</span> を経ている．よってこの事象の上での <span class="math inline">\(x^*\)</span> の条件付き分布を計算すれば良いことになる： <span class="math display">\[
p(x|y_1,\cdots,y_n) = \frac{p(\boldsymbol{y}|x)p(x)}{p(\boldsymbol{y})}
\]</span> <span id="eq-bayes"><span class="math display">\[
= \frac{\displaystyle p(y_1|x)\cdots p(y_n|x)p(x)}{\displaystyle\int_\mathbb{R}p(y_1|x)\cdots p(y_n|x)p(x)\,dx}
\tag{1}\]</span></span></p>
<p>こうして，誤り訂正符号の文脈では，Bayes 事前確率・事後確率が純粋に確率としての解釈を持つ．</p>
</div>
</div>
</div>
</section>
<section id="sec-example" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="sec-example"><span class="header-section-number">1.2</span> 例</h3>
<p>入力は <span class="math inline">\(1/2\)</span> の確率で <span class="math inline">\(x=0\)</span> だが，もう <span class="math inline">\(1/2\)</span> の確率で標準正規分布 <span class="math inline">\(\mathrm{N}(0,1)\)</span> に従うとする： <span class="math display">\[
p(x)dx=\frac{1}{2}\delta_0(dx)+\frac{1}{2}\mathrm{N}(0,1)(dx).
\]</span> 通信路は加法的 Gauss 型であるとする： <span class="math display">\[
p(x,y)=\frac{1}{\sqrt{2\pi}}\exp\left(-\frac{(x-y)^2}{2}\right).
\]</span> では真値を <span class="math inline">\(x^*=1\)</span> として，<span class="math inline">\(n=10\)</span> 回の観測データを生成してみる：</p>
<div id="2e903943" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> <span class="fl">1</span> <span class="op">.+</span> <span class="fu">randn</span>(<span class="fl">10</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[-0.3237585693297267, 0.09808385753776627, 1.0037554617657636, 1.3941748105259246, -0.0674661062593429, 0.8487681906664064, 1.6009936768322608, 1.0540773964079377, 0.0931206824394527, 0.6756912723019906]</code></pre>
</div>
</div>
<p>愚直な計算から，<span class="math inline">\(p(\boldsymbol{y})\)</span> は次の積分で計算される：</p>
<div class="footnote-size">
<p><span class="math display">\[\begin{align*}
    p(\boldsymbol{y})&amp;=\int_\mathbb{R}p(\boldsymbol{y}|x)p(x)dx\\
    &amp;=\int_\mathbb{R}\prod_{i=1}^n p(y_i|x)p(x)dx\\
    &amp;=\frac{1}{2}\frac{1}{(2\pi)^{n+1}}\int_\mathbb{R}\exp\left(-\frac{1}{2}\sum_{i=1}^n(y_i-x)^2+x^2\right)dx\\
    &amp;\qquad+\frac{1}{2}\frac{1}{(2\pi)^n}\exp\left(-\frac{1}{2}\sum_{i=1}^n(y_i-x)^2\right)dx.
\end{align*}\]</span></p>
</div>
<p>これを実際に計算した結果は <span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala &amp; Zdeborová, 2024, p. 117</a>)</span> で与えられている．</p>
<p>ここでは，邪教のような計算を啓示するのではなく，Julia と Turing を通じて計算する方法を紹介する <span class="citation" data-cites="Storopoli2021">(<a href="#ref-Storopoli2021" role="doc-biblioref">Storopoli, 2021</a>)</span>．</p>
<div id="5545c35f" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span>, <span class="bu">Distributions</span>, <span class="bu">Random</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [<span class="fl">0.99978688</span>, <span class="fl">1.7956116</span>, <span class="op">−</span><span class="fl">0.43158072</span>, <span class="fl">3.07234211</span>, <span class="fl">1.11920946</span>, <span class="fl">0.53248943</span>, <span class="fl">0.80011329</span>, <span class="op">−</span><span class="fl">0.52783428</span>, <span class="fl">0.40378413</span>, <span class="op">−</span><span class="fl">0.00223177</span>]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="bu">Random</span>.<span class="fu">seed!</span>(<span class="fl">124</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>prior <span class="op">=</span> <span class="fu">MixtureModel</span>([<span class="fu">Normal</span>(<span class="fl">0.0</span>, <span class="fl">1.0</span>), <span class="fu">Normal</span>(<span class="fl">0.0</span>, <span class="fl">0.005</span>)], [<span class="fl">0.5</span>, <span class="fl">0.5</span>])</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">mixed_normal_model</span>(data)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    μ <span class="op">~</span> prior</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(data)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        data[i] <span class="op">~</span> <span class="fu">Normal</span>(μ, <span class="fl">1</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">mixed_normal_model</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ebde5c12" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(model, <span class="fu">NUTS</span>(), <span class="fl">100000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6511d9d5" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MCMCChains</span>, <span class="bu">Plots</span>, <span class="bu">StatsPlots</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(chain[<span class="op">:</span>μ], seriestype <span class="op">=</span> <span class="op">:</span>density, xlabel <span class="op">=</span> <span class="st">"x*"</span>, ylabel <span class="op">=</span> <span class="st">"Density"</span>, title <span class="op">=</span> <span class="st">"Posterior Distribution"</span>, color <span class="op">=</span> <span class="st">"#80c4ac"</span>, fmt<span class="op">=:</span>svg)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vline!</span>([<span class="fl">1</span>], color <span class="op">=</span> <span class="op">:</span>pink, linewidth <span class="op">=</span> <span class="fl">2</span>, label <span class="op">=</span> <span class="st">"x^* = 1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip080">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip080)" d="M0 1920 L2688 1920 L2688 -4.26326e-14 L0 -4.26326e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip081">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip080)" d="M226.141 1734.12 L2640.76 1734.12 L2640.76 127.792 L226.141 127.792  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip082">
    <rect x="226" y="127" width="2416" height="1607"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="526.751,1734.12 526.751,127.792 "></polyline>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="918.628,1734.12 918.628,127.792 "></polyline>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1310.5,1734.12 1310.5,127.792 "></polyline>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1702.38,1734.12 1702.38,127.792 "></polyline>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2094.26,1734.12 2094.26,127.792 "></polyline>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2486.13,1734.12 2486.13,127.792 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="226.141,1734.12 2640.76,1734.12 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="526.751,1734.12 526.751,1715.22 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="918.628,1734.12 918.628,1715.22 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1310.5,1734.12 1310.5,1715.22 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1702.38,1734.12 1702.38,1715.22 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2094.26,1734.12 2094.26,1715.22 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2486.13,1734.12 2486.13,1715.22 "></polyline>
<path clip-path="url(#clip080)" d="M473.777 1781.99 L503.453 1781.99 L503.453 1785.93 L473.777 1785.93 L473.777 1781.99 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M523.545 1767.34 Q519.934 1767.34 518.106 1770.9 Q516.3 1774.45 516.3 1781.58 Q516.3 1788.68 518.106 1792.25 Q519.934 1795.79 523.545 1795.79 Q527.18 1795.79 528.985 1792.25 Q530.814 1788.68 530.814 1781.58 Q530.814 1774.45 528.985 1770.9 Q527.18 1767.34 523.545 1767.34 M523.545 1763.64 Q529.356 1763.64 532.411 1768.24 Q535.49 1772.83 535.49 1781.58 Q535.49 1790.3 532.411 1794.91 Q529.356 1799.49 523.545 1799.49 Q517.735 1799.49 514.657 1794.91 Q511.601 1790.3 511.601 1781.58 Q511.601 1772.83 514.657 1768.24 Q517.735 1763.64 523.545 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M543.707 1792.94 L548.592 1792.94 L548.592 1798.82 L543.707 1798.82 L543.707 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M558.823 1764.26 L577.179 1764.26 L577.179 1768.2 L563.105 1768.2 L563.105 1776.67 Q564.124 1776.32 565.142 1776.16 Q566.161 1775.97 567.179 1775.97 Q572.966 1775.97 576.346 1779.15 Q579.726 1782.32 579.726 1787.73 Q579.726 1793.31 576.253 1796.41 Q572.781 1799.49 566.462 1799.49 Q564.286 1799.49 562.017 1799.12 Q559.772 1798.75 557.365 1798.01 L557.365 1793.31 Q559.448 1794.45 561.67 1795 Q563.892 1795.56 566.369 1795.56 Q570.374 1795.56 572.712 1793.45 Q575.05 1791.34 575.05 1787.73 Q575.05 1784.12 572.712 1782.02 Q570.374 1779.91 566.369 1779.91 Q564.494 1779.91 562.619 1780.33 Q560.767 1780.74 558.823 1781.62 L558.823 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M896.012 1767.34 Q892.401 1767.34 890.572 1770.9 Q888.767 1774.45 888.767 1781.58 Q888.767 1788.68 890.572 1792.25 Q892.401 1795.79 896.012 1795.79 Q899.646 1795.79 901.452 1792.25 Q903.28 1788.68 903.28 1781.58 Q903.28 1774.45 901.452 1770.9 Q899.646 1767.34 896.012 1767.34 M896.012 1763.64 Q901.822 1763.64 904.878 1768.24 Q907.956 1772.83 907.956 1781.58 Q907.956 1790.3 904.878 1794.91 Q901.822 1799.49 896.012 1799.49 Q890.202 1799.49 887.123 1794.91 Q884.068 1790.3 884.068 1781.58 Q884.068 1772.83 887.123 1768.24 Q890.202 1763.64 896.012 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M916.174 1792.94 L921.058 1792.94 L921.058 1798.82 L916.174 1798.82 L916.174 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M941.243 1767.34 Q937.632 1767.34 935.803 1770.9 Q933.998 1774.45 933.998 1781.58 Q933.998 1788.68 935.803 1792.25 Q937.632 1795.79 941.243 1795.79 Q944.877 1795.79 946.683 1792.25 Q948.512 1788.68 948.512 1781.58 Q948.512 1774.45 946.683 1770.9 Q944.877 1767.34 941.243 1767.34 M941.243 1763.64 Q947.053 1763.64 950.109 1768.24 Q953.188 1772.83 953.188 1781.58 Q953.188 1790.3 950.109 1794.91 Q947.053 1799.49 941.243 1799.49 Q935.433 1799.49 932.354 1794.91 Q929.299 1790.3 929.299 1781.58 Q929.299 1772.83 932.354 1768.24 Q935.433 1763.64 941.243 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1288.39 1767.34 Q1284.77 1767.34 1282.95 1770.9 Q1281.14 1774.45 1281.14 1781.58 Q1281.14 1788.68 1282.95 1792.25 Q1284.77 1795.79 1288.39 1795.79 Q1292.02 1795.79 1293.83 1792.25 Q1295.65 1788.68 1295.65 1781.58 Q1295.65 1774.45 1293.83 1770.9 Q1292.02 1767.34 1288.39 1767.34 M1288.39 1763.64 Q1294.2 1763.64 1297.25 1768.24 Q1300.33 1772.83 1300.33 1781.58 Q1300.33 1790.3 1297.25 1794.91 Q1294.2 1799.49 1288.39 1799.49 Q1282.58 1799.49 1279.5 1794.91 Q1276.44 1790.3 1276.44 1781.58 Q1276.44 1772.83 1279.5 1768.24 Q1282.58 1763.64 1288.39 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1308.55 1792.94 L1313.43 1792.94 L1313.43 1798.82 L1308.55 1798.82 L1308.55 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1323.66 1764.26 L1342.02 1764.26 L1342.02 1768.2 L1327.95 1768.2 L1327.95 1776.67 Q1328.96 1776.32 1329.98 1776.16 Q1331 1775.97 1332.02 1775.97 Q1337.81 1775.97 1341.19 1779.15 Q1344.57 1782.32 1344.57 1787.73 Q1344.57 1793.31 1341.09 1796.41 Q1337.62 1799.49 1331.3 1799.49 Q1329.13 1799.49 1326.86 1799.12 Q1324.61 1798.75 1322.21 1798.01 L1322.21 1793.31 Q1324.29 1794.45 1326.51 1795 Q1328.73 1795.56 1331.21 1795.56 Q1335.21 1795.56 1337.55 1793.45 Q1339.89 1791.34 1339.89 1787.73 Q1339.89 1784.12 1337.55 1782.02 Q1335.21 1779.91 1331.21 1779.91 Q1329.33 1779.91 1327.46 1780.33 Q1325.61 1780.74 1323.66 1781.62 L1323.66 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1669.53 1794.89 L1677.17 1794.89 L1677.17 1768.52 L1668.86 1770.19 L1668.86 1765.93 L1677.13 1764.26 L1681.8 1764.26 L1681.8 1794.89 L1689.44 1794.89 L1689.44 1798.82 L1669.53 1798.82 L1669.53 1794.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1698.88 1792.94 L1703.77 1792.94 L1703.77 1798.82 L1698.88 1798.82 L1698.88 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1723.95 1767.34 Q1720.34 1767.34 1718.51 1770.9 Q1716.71 1774.45 1716.71 1781.58 Q1716.71 1788.68 1718.51 1792.25 Q1720.34 1795.79 1723.95 1795.79 Q1727.59 1795.79 1729.39 1792.25 Q1731.22 1788.68 1731.22 1781.58 Q1731.22 1774.45 1729.39 1770.9 Q1727.59 1767.34 1723.95 1767.34 M1723.95 1763.64 Q1729.76 1763.64 1732.82 1768.24 Q1735.9 1772.83 1735.9 1781.58 Q1735.9 1790.3 1732.82 1794.91 Q1729.76 1799.49 1723.95 1799.49 Q1718.14 1799.49 1715.07 1794.91 Q1712.01 1790.3 1712.01 1781.58 Q1712.01 1772.83 1715.07 1768.24 Q1718.14 1763.64 1723.95 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M2061.91 1794.89 L2069.55 1794.89 L2069.55 1768.52 L2061.24 1770.19 L2061.24 1765.93 L2069.5 1764.26 L2074.18 1764.26 L2074.18 1794.89 L2081.81 1794.89 L2081.81 1798.82 L2061.91 1798.82 L2061.91 1794.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M2091.26 1792.94 L2096.14 1792.94 L2096.14 1798.82 L2091.26 1798.82 L2091.26 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M2106.37 1764.26 L2124.73 1764.26 L2124.73 1768.2 L2110.66 1768.2 L2110.66 1776.67 Q2111.68 1776.32 2112.69 1776.16 Q2113.71 1775.97 2114.73 1775.97 Q2120.52 1775.97 2123.9 1779.15 Q2127.28 1782.32 2127.28 1787.73 Q2127.28 1793.31 2123.8 1796.41 Q2120.33 1799.49 2114.01 1799.49 Q2111.84 1799.49 2109.57 1799.12 Q2107.32 1798.75 2104.92 1798.01 L2104.92 1793.31 Q2107 1794.45 2109.22 1795 Q2111.44 1795.56 2113.92 1795.56 Q2117.93 1795.56 2120.26 1793.45 Q2122.6 1791.34 2122.6 1787.73 Q2122.6 1784.12 2120.26 1782.02 Q2117.93 1779.91 2113.92 1779.91 Q2112.05 1779.91 2110.17 1780.33 Q2108.32 1780.74 2106.37 1781.62 L2106.37 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M2457.37 1794.89 L2473.69 1794.89 L2473.69 1798.82 L2451.75 1798.82 L2451.75 1794.89 Q2454.41 1792.13 2458.99 1787.5 Q2463.6 1782.85 2464.78 1781.51 Q2467.02 1778.98 2467.9 1777.25 Q2468.81 1775.49 2468.81 1773.8 Q2468.81 1771.04 2466.86 1769.31 Q2464.94 1767.57 2461.84 1767.57 Q2459.64 1767.57 2457.19 1768.34 Q2454.76 1769.1 2451.98 1770.65 L2451.98 1765.93 Q2454.8 1764.79 2457.26 1764.21 Q2459.71 1763.64 2461.75 1763.64 Q2467.12 1763.64 2470.31 1766.32 Q2473.51 1769.01 2473.51 1773.5 Q2473.51 1775.63 2472.7 1777.55 Q2471.91 1779.45 2469.8 1782.04 Q2469.22 1782.71 2466.12 1785.93 Q2463.02 1789.12 2457.37 1794.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M2483.51 1792.94 L2488.39 1792.94 L2488.39 1798.82 L2483.51 1798.82 L2483.51 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M2508.57 1767.34 Q2504.96 1767.34 2503.13 1770.9 Q2501.33 1774.45 2501.33 1781.58 Q2501.33 1788.68 2503.13 1792.25 Q2504.96 1795.79 2508.57 1795.79 Q2512.21 1795.79 2514.01 1792.25 Q2515.84 1788.68 2515.84 1781.58 Q2515.84 1774.45 2514.01 1770.9 Q2512.21 1767.34 2508.57 1767.34 M2508.57 1763.64 Q2514.38 1763.64 2517.44 1768.24 Q2520.52 1772.83 2520.52 1781.58 Q2520.52 1790.3 2517.44 1794.91 Q2514.38 1799.49 2508.57 1799.49 Q2502.76 1799.49 2499.69 1794.91 Q2496.63 1790.3 2496.63 1781.58 Q2496.63 1772.83 2499.69 1768.24 Q2502.76 1763.64 2508.57 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1433.67 1847.65 L1420.78 1865 L1434.34 1883.3 L1427.43 1883.3 L1417.06 1869.3 L1406.68 1883.3 L1399.77 1883.3 L1413.62 1864.65 L1400.95 1847.65 L1407.86 1847.65 L1417.31 1860.35 L1426.76 1847.65 L1433.67 1847.65 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1467.12 1843.61 L1455.7 1849.79 L1467.12 1855.99 L1465.28 1859.11 L1454.58 1852.65 L1454.58 1864.65 L1450.95 1864.65 L1450.95 1852.65 L1440.26 1859.11 L1438.41 1855.99 L1449.84 1849.79 L1438.41 1843.61 L1440.26 1840.46 L1450.95 1846.92 L1450.95 1834.92 L1454.58 1834.92 L1454.58 1846.92 L1465.28 1840.46 L1467.12 1843.61 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="226.141,1688.66 2640.76,1688.66 "></polyline>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="226.141,1455.19 2640.76,1455.19 "></polyline>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="226.141,1221.73 2640.76,1221.73 "></polyline>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="226.141,988.266 2640.76,988.266 "></polyline>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="226.141,754.803 2640.76,754.803 "></polyline>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="226.141,521.339 2640.76,521.339 "></polyline>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="226.141,287.876 2640.76,287.876 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="226.141,1734.12 226.141,127.792 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="226.141,1688.66 245.038,1688.66 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="226.141,1455.19 245.038,1455.19 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="226.141,1221.73 245.038,1221.73 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="226.141,988.266 245.038,988.266 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="226.141,754.803 245.038,754.803 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="226.141,521.339 245.038,521.339 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="226.141,287.876 245.038,287.876 "></polyline>
<path clip-path="url(#clip080)" d="M128.645 1674.45 Q125.034 1674.45 123.205 1678.02 Q121.4 1681.56 121.4 1688.69 Q121.4 1695.8 123.205 1699.36 Q125.034 1702.9 128.645 1702.9 Q132.279 1702.9 134.085 1699.36 Q135.913 1695.8 135.913 1688.69 Q135.913 1681.56 134.085 1678.02 Q132.279 1674.45 128.645 1674.45 M128.645 1670.75 Q134.455 1670.75 137.511 1675.36 Q140.589 1679.94 140.589 1688.69 Q140.589 1697.42 137.511 1702.02 Q134.455 1706.61 128.645 1706.61 Q122.835 1706.61 119.756 1702.02 Q116.701 1697.42 116.701 1688.69 Q116.701 1679.94 119.756 1675.36 Q122.835 1670.75 128.645 1670.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M148.807 1700.06 L153.691 1700.06 L153.691 1705.94 L148.807 1705.94 L148.807 1700.06 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M173.876 1674.45 Q170.265 1674.45 168.436 1678.02 Q166.631 1681.56 166.631 1688.69 Q166.631 1695.8 168.436 1699.36 Q170.265 1702.9 173.876 1702.9 Q177.51 1702.9 179.316 1699.36 Q181.145 1695.8 181.145 1688.69 Q181.145 1681.56 179.316 1678.02 Q177.51 1674.45 173.876 1674.45 M173.876 1670.75 Q179.686 1670.75 182.742 1675.36 Q185.821 1679.94 185.821 1688.69 Q185.821 1697.42 182.742 1702.02 Q179.686 1706.61 173.876 1706.61 Q168.066 1706.61 164.987 1702.02 Q161.932 1697.42 161.932 1688.69 Q161.932 1679.94 164.987 1675.36 Q168.066 1670.75 173.876 1670.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M130.242 1440.99 Q126.631 1440.99 124.802 1444.56 Q122.997 1448.1 122.997 1455.23 Q122.997 1462.33 124.802 1465.9 Q126.631 1469.44 130.242 1469.44 Q133.876 1469.44 135.682 1465.9 Q137.511 1462.33 137.511 1455.23 Q137.511 1448.1 135.682 1444.56 Q133.876 1440.99 130.242 1440.99 M130.242 1437.29 Q136.052 1437.29 139.108 1441.89 Q142.187 1446.48 142.187 1455.23 Q142.187 1463.95 139.108 1468.56 Q136.052 1473.14 130.242 1473.14 Q124.432 1473.14 121.353 1468.56 Q118.298 1463.95 118.298 1455.23 Q118.298 1446.48 121.353 1441.89 Q124.432 1437.29 130.242 1437.29 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M150.404 1466.59 L155.288 1466.59 L155.288 1472.47 L150.404 1472.47 L150.404 1466.59 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M169.501 1468.54 L185.821 1468.54 L185.821 1472.47 L163.876 1472.47 L163.876 1468.54 Q166.538 1465.78 171.122 1461.15 Q175.728 1456.5 176.909 1455.16 Q179.154 1452.63 180.034 1450.9 Q180.936 1449.14 180.936 1447.45 Q180.936 1444.69 178.992 1442.96 Q177.071 1441.22 173.969 1441.22 Q171.77 1441.22 169.316 1441.99 Q166.885 1442.75 164.108 1444.3 L164.108 1439.58 Q166.932 1438.44 169.385 1437.87 Q171.839 1437.29 173.876 1437.29 Q179.247 1437.29 182.441 1439.97 Q185.635 1442.66 185.635 1447.15 Q185.635 1449.28 184.825 1451.2 Q184.038 1453.1 181.932 1455.69 Q181.353 1456.36 178.251 1459.58 Q175.149 1462.77 169.501 1468.54 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M128.159 1207.53 Q124.548 1207.53 122.719 1211.09 Q120.913 1214.63 120.913 1221.76 Q120.913 1228.87 122.719 1232.43 Q124.548 1235.98 128.159 1235.98 Q131.793 1235.98 133.599 1232.43 Q135.427 1228.87 135.427 1221.76 Q135.427 1214.63 133.599 1211.09 Q131.793 1207.53 128.159 1207.53 M128.159 1203.82 Q133.969 1203.82 137.025 1208.43 Q140.103 1213.01 140.103 1221.76 Q140.103 1230.49 137.025 1235.1 Q133.969 1239.68 128.159 1239.68 Q122.349 1239.68 119.27 1235.1 Q116.214 1230.49 116.214 1221.76 Q116.214 1213.01 119.27 1208.43 Q122.349 1203.82 128.159 1203.82 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M148.321 1233.13 L153.205 1233.13 L153.205 1239.01 L148.321 1239.01 L148.321 1233.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M176.237 1208.52 L164.432 1226.97 L176.237 1226.97 L176.237 1208.52 M175.01 1204.45 L180.89 1204.45 L180.89 1226.97 L185.821 1226.97 L185.821 1230.86 L180.89 1230.86 L180.89 1239.01 L176.237 1239.01 L176.237 1230.86 L160.636 1230.86 L160.636 1226.35 L175.01 1204.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M128.483 974.064 Q124.872 974.064 123.043 977.629 Q121.238 981.171 121.238 988.3 Q121.238 995.407 123.043 998.972 Q124.872 1002.51 128.483 1002.51 Q132.117 1002.51 133.923 998.972 Q135.751 995.407 135.751 988.3 Q135.751 981.171 133.923 977.629 Q132.117 974.064 128.483 974.064 M128.483 970.361 Q134.293 970.361 137.349 974.967 Q140.427 979.55 140.427 988.3 Q140.427 997.027 137.349 1001.63 Q134.293 1006.22 128.483 1006.22 Q122.673 1006.22 119.594 1001.63 Q116.539 997.027 116.539 988.3 Q116.539 979.55 119.594 974.967 Q122.673 970.361 128.483 970.361 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M148.645 999.666 L153.529 999.666 L153.529 1005.55 L148.645 1005.55 L148.645 999.666 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M174.293 986.402 Q171.145 986.402 169.293 988.555 Q167.464 990.708 167.464 994.458 Q167.464 998.185 169.293 1000.36 Q171.145 1002.51 174.293 1002.51 Q177.441 1002.51 179.27 1000.36 Q181.122 998.185 181.122 994.458 Q181.122 990.708 179.27 988.555 Q177.441 986.402 174.293 986.402 M183.575 971.75 L183.575 976.009 Q181.816 975.175 180.01 974.736 Q178.228 974.296 176.469 974.296 Q171.839 974.296 169.385 977.421 Q166.955 980.546 166.608 986.865 Q167.973 984.851 170.034 983.787 Q172.094 982.699 174.571 982.699 Q179.779 982.699 182.788 985.87 Q185.821 989.018 185.821 994.458 Q185.821 999.782 182.672 1003 Q179.524 1006.22 174.293 1006.22 Q168.297 1006.22 165.126 1001.63 Q161.955 997.027 161.955 988.3 Q161.955 980.106 165.844 975.245 Q169.733 970.361 176.284 970.361 Q178.043 970.361 179.825 970.708 Q181.631 971.055 183.575 971.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M128.738 740.601 Q125.126 740.601 123.298 744.166 Q121.492 747.708 121.492 754.837 Q121.492 761.944 123.298 765.509 Q125.126 769.05 128.738 769.05 Q132.372 769.05 134.177 765.509 Q136.006 761.944 136.006 754.837 Q136.006 747.708 134.177 744.166 Q132.372 740.601 128.738 740.601 M128.738 736.898 Q134.548 736.898 137.603 741.504 Q140.682 746.087 140.682 754.837 Q140.682 763.564 137.603 768.171 Q134.548 772.754 128.738 772.754 Q122.927 772.754 119.849 768.171 Q116.793 763.564 116.793 754.837 Q116.793 746.087 119.849 741.504 Q122.927 736.898 128.738 736.898 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M148.899 766.203 L153.784 766.203 L153.784 772.083 L148.899 772.083 L148.899 766.203 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M173.969 755.671 Q170.635 755.671 168.714 757.453 Q166.816 759.235 166.816 762.36 Q166.816 765.485 168.714 767.268 Q170.635 769.05 173.969 769.05 Q177.302 769.05 179.223 767.268 Q181.145 765.462 181.145 762.36 Q181.145 759.235 179.223 757.453 Q177.325 755.671 173.969 755.671 M169.293 753.68 Q166.284 752.939 164.594 750.879 Q162.927 748.819 162.927 745.856 Q162.927 741.712 165.867 739.305 Q168.83 736.898 173.969 736.898 Q179.131 736.898 182.071 739.305 Q185.01 741.712 185.01 745.856 Q185.01 748.819 183.321 750.879 Q181.654 752.939 178.668 753.68 Q182.047 754.467 183.922 756.759 Q185.821 759.05 185.821 762.36 Q185.821 767.383 182.742 770.069 Q179.686 772.754 173.969 772.754 Q168.251 772.754 165.173 770.069 Q162.117 767.383 162.117 762.36 Q162.117 759.05 164.015 756.759 Q165.913 754.467 169.293 753.68 M167.58 746.296 Q167.58 748.981 169.247 750.485 Q170.936 751.99 173.969 751.99 Q176.978 751.99 178.668 750.485 Q180.381 748.981 180.381 746.296 Q180.381 743.61 178.668 742.106 Q176.978 740.601 173.969 740.601 Q170.936 740.601 169.247 742.106 Q167.58 743.61 167.58 746.296 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M119.455 534.684 L127.094 534.684 L127.094 508.319 L118.784 509.985 L118.784 505.726 L127.048 504.059 L131.724 504.059 L131.724 534.684 L139.362 534.684 L139.362 538.619 L119.455 538.619 L119.455 534.684 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M148.807 532.74 L153.691 532.74 L153.691 538.619 L148.807 538.619 L148.807 532.74 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M173.876 507.138 Q170.265 507.138 168.436 510.703 Q166.631 514.245 166.631 521.374 Q166.631 528.481 168.436 532.045 Q170.265 535.587 173.876 535.587 Q177.51 535.587 179.316 532.045 Q181.145 528.481 181.145 521.374 Q181.145 514.245 179.316 510.703 Q177.51 507.138 173.876 507.138 M173.876 503.434 Q179.686 503.434 182.742 508.041 Q185.821 512.624 185.821 521.374 Q185.821 530.101 182.742 534.707 Q179.686 539.291 173.876 539.291 Q168.066 539.291 164.987 534.707 Q161.932 530.101 161.932 521.374 Q161.932 512.624 164.987 508.041 Q168.066 503.434 173.876 503.434 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M121.052 301.221 L128.691 301.221 L128.691 274.856 L120.381 276.522 L120.381 272.263 L128.645 270.596 L133.321 270.596 L133.321 301.221 L140.96 301.221 L140.96 305.156 L121.052 305.156 L121.052 301.221 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M150.404 299.277 L155.288 299.277 L155.288 305.156 L150.404 305.156 L150.404 299.277 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M169.501 301.221 L185.821 301.221 L185.821 305.156 L163.876 305.156 L163.876 301.221 Q166.538 298.467 171.122 293.837 Q175.728 289.184 176.909 287.842 Q179.154 285.318 180.034 283.582 Q180.936 281.823 180.936 280.133 Q180.936 277.379 178.992 275.643 Q177.071 273.906 173.969 273.906 Q171.77 273.906 169.316 274.67 Q166.885 275.434 164.108 276.985 L164.108 272.263 Q166.932 271.129 169.385 270.55 Q171.839 269.971 173.876 269.971 Q179.247 269.971 182.441 272.656 Q185.635 275.342 185.635 279.832 Q185.635 281.962 184.825 283.883 Q184.038 285.781 181.932 288.374 Q181.353 289.045 178.251 292.263 Q175.149 295.457 169.501 301.221 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M19.402 1044.26 L56.3549 1044.26 L56.3549 1036.5 Q56.3549 1026.66 51.8989 1022.11 Q47.4429 1017.53 37.8307 1017.53 Q28.2821 1017.53 23.858 1022.11 Q19.402 1026.66 19.402 1036.5 L19.402 1044.26 M14.1184 1050.69 L14.1184 1037.48 Q14.1184 1023.67 19.8794 1017.21 Q25.6085 1010.75 37.8307 1010.75 Q50.1165 1010.75 55.8775 1017.24 Q61.6384 1023.73 61.6384 1037.48 L61.6384 1050.69 L14.1184 1050.69 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M42.3504 970.263 L45.2149 970.263 L45.2149 997.19 Q51.2623 996.808 54.4452 993.561 Q57.5962 990.283 57.5962 984.458 Q57.5962 981.084 56.7687 977.933 Q55.9411 974.751 54.2861 971.631 L59.8242 971.631 Q61.161 974.782 61.8612 978.093 Q62.5615 981.403 62.5615 984.808 Q62.5615 993.338 57.5962 998.336 Q52.631 1003.3 44.1646 1003.3 Q35.4117 1003.3 30.2873 998.59 Q25.1311 993.848 25.1311 985.827 Q25.1311 978.634 29.7781 974.464 Q34.3932 970.263 42.3504 970.263 M40.6316 976.119 Q35.8255 976.183 32.9609 978.825 Q30.0964 981.435 30.0964 985.763 Q30.0964 990.665 32.8654 993.625 Q35.6345 996.553 40.6634 996.999 L40.6316 976.119 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M40.1224 931.018 L61.6384 931.018 L61.6384 936.875 L40.3133 936.875 Q35.2526 936.875 32.7381 938.848 Q30.2237 940.821 30.2237 944.768 Q30.2237 949.511 33.2474 952.248 Q36.2711 954.985 41.491 954.985 L61.6384 954.985 L61.6384 960.873 L25.9905 960.873 L25.9905 954.985 L31.5287 954.985 Q28.314 952.884 26.7225 950.052 Q25.1311 947.187 25.1311 943.463 Q25.1311 937.32 28.9505 934.169 Q32.7381 931.018 40.1224 931.018 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M27.0408 896.612 L32.579 896.612 Q31.3059 899.094 30.6693 901.768 Q30.0327 904.441 30.0327 907.306 Q30.0327 911.666 31.3695 913.863 Q32.7063 916.027 35.3799 916.027 Q37.4169 916.027 38.5946 914.467 Q39.7404 912.908 40.7908 908.197 L41.2364 906.192 Q42.5732 899.954 45.0239 897.344 Q47.4429 894.702 51.8034 894.702 Q56.7687 894.702 59.6651 898.649 Q62.5615 902.564 62.5615 909.438 Q62.5615 912.303 61.9886 915.422 Q61.4475 918.51 60.3335 921.947 L54.2861 921.947 Q55.973 918.701 56.8323 915.55 Q57.6599 912.399 57.6599 909.311 Q57.6599 905.173 56.2594 902.945 Q54.8271 900.717 52.249 900.717 Q49.8619 900.717 48.5887 902.341 Q47.3156 903.932 46.1379 909.375 L45.6605 911.412 Q44.5147 916.855 42.1594 919.273 Q39.7722 921.692 35.6345 921.692 Q30.6056 921.692 27.8684 918.128 Q25.1311 914.563 25.1311 908.006 Q25.1311 904.76 25.6085 901.895 Q26.086 899.031 27.0408 896.612 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M25.9905 885.376 L25.9905 879.52 L61.6384 879.52 L61.6384 885.376 L25.9905 885.376 M12.1132 885.376 L12.1132 879.52 L19.5293 879.52 L19.5293 885.376 L12.1132 885.376 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M15.869 861.473 L25.9905 861.473 L25.9905 849.41 L30.542 849.41 L30.542 861.473 L49.8937 861.473 Q54.2542 861.473 55.4955 860.295 Q56.7368 859.086 56.7368 855.425 L56.7368 849.41 L61.6384 849.41 L61.6384 855.425 Q61.6384 862.205 59.124 864.783 Q56.5777 867.361 49.8937 867.361 L30.542 867.361 L30.542 871.658 L25.9905 871.658 L25.9905 867.361 L15.869 867.361 L15.869 861.473 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M64.9486 826.875 Q71.3143 829.358 73.2559 831.713 Q75.1974 834.069 75.1974 838.015 L75.1974 842.694 L70.2958 842.694 L70.2958 839.257 Q70.2958 836.838 69.15 835.501 Q68.0041 834.164 63.7391 832.541 L61.0655 831.49 L25.9905 845.909 L25.9905 839.702 L53.8723 828.562 L25.9905 817.422 L25.9905 811.216 L64.9486 826.875 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1010.72 18.8205 L1010.72 41.5461 L1021.01 41.5461 Q1026.72 41.5461 1029.84 38.5889 Q1032.96 35.6318 1032.96 30.163 Q1032.96 24.7348 1029.84 21.7777 Q1026.72 18.8205 1021.01 18.8205 L1010.72 18.8205 M1002.53 12.096 L1021.01 12.096 Q1031.17 12.096 1036.36 16.714 Q1041.58 21.2916 1041.58 30.163 Q1041.58 39.1155 1036.36 43.6931 Q1031.17 48.2706 1021.01 48.2706 L1010.72 48.2706 L1010.72 72.576 L1002.53 72.576 L1002.53 12.096 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1066.86 32.4315 Q1060.87 32.4315 1057.38 37.1306 Q1053.9 41.7891 1053.9 49.9314 Q1053.9 58.0738 1057.34 62.7728 Q1060.83 67.4314 1066.86 67.4314 Q1072.82 67.4314 1076.3 62.7323 Q1079.78 58.0333 1079.78 49.9314 Q1079.78 41.8701 1076.3 37.1711 Q1072.82 32.4315 1066.86 32.4315 M1066.86 26.1121 Q1076.58 26.1121 1082.13 32.4315 Q1087.68 38.7509 1087.68 49.9314 Q1087.68 61.0714 1082.13 67.4314 Q1076.58 73.7508 1066.86 73.7508 Q1057.1 73.7508 1051.55 67.4314 Q1046.04 61.0714 1046.04 49.9314 Q1046.04 38.7509 1051.55 32.4315 Q1057.1 26.1121 1066.86 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1128.96 28.5427 L1128.96 35.5912 Q1125.8 33.9709 1122.4 33.1607 Q1119 32.3505 1115.35 32.3505 Q1109.8 32.3505 1107.01 34.0519 Q1104.25 35.7533 1104.25 39.156 Q1104.25 41.7486 1106.24 43.2475 Q1108.22 44.7058 1114.22 46.0426 L1116.77 46.6097 Q1124.71 48.3111 1128.03 51.4303 Q1131.39 54.509 1131.39 60.0587 Q1131.39 66.3781 1126.37 70.0644 Q1121.39 73.7508 1112.64 73.7508 Q1108.99 73.7508 1105.02 73.0216 Q1101.09 72.3329 1096.72 70.9151 L1096.72 63.2184 Q1100.85 65.3654 1104.86 66.4591 Q1108.87 67.5124 1112.8 67.5124 Q1118.07 67.5124 1120.9 65.73 Q1123.74 63.9071 1123.74 60.6258 Q1123.74 57.5877 1121.67 55.9673 Q1119.64 54.3469 1112.72 52.8481 L1110.13 52.2405 Q1103.2 50.7821 1100.12 47.7845 Q1097.04 44.7463 1097.04 39.4801 Q1097.04 33.0797 1101.58 29.5959 Q1106.11 26.1121 1114.46 26.1121 Q1118.59 26.1121 1122.24 26.7198 Q1125.88 27.3274 1128.96 28.5427 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1150.63 14.324 L1150.63 27.2059 L1165.99 27.2059 L1165.99 32.9987 L1150.63 32.9987 L1150.63 57.6282 Q1150.63 63.1779 1152.13 64.7578 Q1153.67 66.3376 1158.33 66.3376 L1165.99 66.3376 L1165.99 72.576 L1158.33 72.576 Q1149.7 72.576 1146.42 69.3758 Q1143.14 66.1351 1143.14 57.6282 L1143.14 32.9987 L1137.67 32.9987 L1137.67 27.2059 L1143.14 27.2059 L1143.14 14.324 L1150.63 14.324 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1214.6 48.0275 L1214.6 51.6733 L1180.33 51.6733 Q1180.81 59.3701 1184.95 63.421 Q1189.12 67.4314 1196.53 67.4314 Q1200.83 67.4314 1204.84 66.3781 Q1208.89 65.3249 1212.86 63.2184 L1212.86 70.267 Q1208.85 71.9684 1204.63 72.8596 Q1200.42 73.7508 1196.09 73.7508 Q1185.23 73.7508 1178.87 67.4314 Q1172.55 61.1119 1172.55 50.3365 Q1172.55 39.1965 1178.55 32.6746 Q1184.58 26.1121 1194.79 26.1121 Q1203.94 26.1121 1209.25 32.0264 Q1214.6 37.9003 1214.6 48.0275 M1207.14 45.84 Q1207.06 39.7232 1203.7 36.0774 Q1200.38 32.4315 1194.87 32.4315 Q1188.63 32.4315 1184.86 35.9558 Q1181.14 39.4801 1180.57 45.8805 L1207.14 45.84 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1253.12 34.1734 Q1251.87 33.4443 1250.37 33.1202 Q1248.91 32.7556 1247.13 32.7556 Q1240.81 32.7556 1237.4 36.8875 Q1234.04 40.9789 1234.04 48.6757 L1234.04 72.576 L1226.55 72.576 L1226.55 27.2059 L1234.04 27.2059 L1234.04 34.2544 Q1236.39 30.1225 1240.16 28.1376 Q1243.93 26.1121 1249.31 26.1121 Q1250.08 26.1121 1251.02 26.2337 Q1251.95 26.3147 1253.08 26.5172 L1253.12 34.1734 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1260.94 27.2059 L1268.39 27.2059 L1268.39 72.576 L1260.94 72.576 L1260.94 27.2059 M1260.94 9.54393 L1268.39 9.54393 L1268.39 18.9825 L1260.94 18.9825 L1260.94 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1301.57 32.4315 Q1295.58 32.4315 1292.09 37.1306 Q1288.61 41.7891 1288.61 49.9314 Q1288.61 58.0738 1292.05 62.7728 Q1295.54 67.4314 1301.57 67.4314 Q1307.53 67.4314 1311.01 62.7323 Q1314.49 58.0333 1314.49 49.9314 Q1314.49 41.8701 1311.01 37.1711 Q1307.53 32.4315 1301.57 32.4315 M1301.57 26.1121 Q1311.29 26.1121 1316.84 32.4315 Q1322.39 38.7509 1322.39 49.9314 Q1322.39 61.0714 1316.84 67.4314 Q1311.29 73.7508 1301.57 73.7508 Q1291.81 73.7508 1286.26 67.4314 Q1280.75 61.0714 1280.75 49.9314 Q1280.75 38.7509 1286.26 32.4315 Q1291.81 26.1121 1301.57 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1361.04 34.1734 Q1359.78 33.4443 1358.28 33.1202 Q1356.83 32.7556 1355.04 32.7556 Q1348.72 32.7556 1345.32 36.8875 Q1341.96 40.9789 1341.96 48.6757 L1341.96 72.576 L1334.46 72.576 L1334.46 27.2059 L1341.96 27.2059 L1341.96 34.2544 Q1344.31 30.1225 1348.08 28.1376 Q1351.84 26.1121 1357.23 26.1121 Q1358 26.1121 1358.93 26.2337 Q1359.86 26.3147 1361 26.5172 L1361.04 34.1734 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1403.73 18.8205 L1403.73 65.8515 L1413.62 65.8515 Q1426.14 65.8515 1431.93 60.1802 Q1437.76 54.509 1437.76 42.2752 Q1437.76 30.1225 1431.93 24.4918 Q1426.14 18.8205 1413.62 18.8205 L1403.73 18.8205 M1395.55 12.096 L1412.36 12.096 Q1429.94 12.096 1438.17 19.4281 Q1446.39 26.7198 1446.39 42.2752 Q1446.39 57.9117 1438.13 65.2439 Q1429.86 72.576 1412.36 72.576 L1395.55 72.576 L1395.55 12.096 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1459.11 27.2059 L1466.56 27.2059 L1466.56 72.576 L1459.11 72.576 L1459.11 27.2059 M1459.11 9.54393 L1466.56 9.54393 L1466.56 18.9825 L1459.11 18.9825 L1459.11 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1511.08 28.5427 L1511.08 35.5912 Q1507.92 33.9709 1504.52 33.1607 Q1501.12 32.3505 1497.47 32.3505 Q1491.92 32.3505 1489.13 34.0519 Q1486.37 35.7533 1486.37 39.156 Q1486.37 41.7486 1488.36 43.2475 Q1490.34 44.7058 1496.34 46.0426 L1498.89 46.6097 Q1506.83 48.3111 1510.15 51.4303 Q1513.51 54.509 1513.51 60.0587 Q1513.51 66.3781 1508.49 70.0644 Q1503.51 73.7508 1494.76 73.7508 Q1491.11 73.7508 1487.14 73.0216 Q1483.21 72.3329 1478.84 70.9151 L1478.84 63.2184 Q1482.97 65.3654 1486.98 66.4591 Q1490.99 67.5124 1494.92 67.5124 Q1500.19 67.5124 1503.02 65.73 Q1505.86 63.9071 1505.86 60.6258 Q1505.86 57.5877 1503.79 55.9673 Q1501.77 54.3469 1494.84 52.8481 L1492.25 52.2405 Q1485.32 50.7821 1482.24 47.7845 Q1479.16 44.7463 1479.16 39.4801 Q1479.16 33.0797 1483.7 29.5959 Q1488.24 26.1121 1496.58 26.1121 Q1500.71 26.1121 1504.36 26.7198 Q1508.01 27.3274 1511.08 28.5427 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1532.76 14.324 L1532.76 27.2059 L1548.11 27.2059 L1548.11 32.9987 L1532.76 32.9987 L1532.76 57.6282 Q1532.76 63.1779 1534.25 64.7578 Q1535.79 66.3376 1540.45 66.3376 L1548.11 66.3376 L1548.11 72.576 L1540.45 72.576 Q1531.82 72.576 1528.54 69.3758 Q1525.26 66.1351 1525.26 57.6282 L1525.26 32.9987 L1519.79 32.9987 L1519.79 27.2059 L1525.26 27.2059 L1525.26 14.324 L1532.76 14.324 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1584.2 34.1734 Q1582.95 33.4443 1581.45 33.1202 Q1579.99 32.7556 1578.21 32.7556 Q1571.89 32.7556 1568.49 36.8875 Q1565.12 40.9789 1565.12 48.6757 L1565.12 72.576 L1557.63 72.576 L1557.63 27.2059 L1565.12 27.2059 L1565.12 34.2544 Q1567.47 30.1225 1571.24 28.1376 Q1575.01 26.1121 1580.39 26.1121 Q1581.16 26.1121 1582.1 26.2337 Q1583.03 26.3147 1584.16 26.5172 L1584.2 34.1734 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1592.02 27.2059 L1599.47 27.2059 L1599.47 72.576 L1592.02 72.576 L1592.02 27.2059 M1592.02 9.54393 L1599.47 9.54393 L1599.47 18.9825 L1592.02 18.9825 L1592.02 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1647.64 49.9314 Q1647.64 41.7081 1644.24 37.0496 Q1640.87 32.3505 1634.96 32.3505 Q1629.05 32.3505 1625.64 37.0496 Q1622.28 41.7081 1622.28 49.9314 Q1622.28 58.1548 1625.64 62.8538 Q1629.05 67.5124 1634.96 67.5124 Q1640.87 67.5124 1644.24 62.8538 Q1647.64 58.1548 1647.64 49.9314 M1622.28 34.0924 Q1624.63 30.0415 1628.2 28.0971 Q1631.8 26.1121 1636.78 26.1121 Q1645.05 26.1121 1650.19 32.6746 Q1655.38 39.2371 1655.38 49.9314 Q1655.38 60.6258 1650.19 67.1883 Q1645.05 73.7508 1636.78 73.7508 Q1631.8 73.7508 1628.2 71.8063 Q1624.63 69.8214 1622.28 65.7705 L1622.28 72.576 L1614.79 72.576 L1614.79 9.54393 L1622.28 9.54393 L1622.28 34.0924 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1666.96 54.671 L1666.96 27.2059 L1674.42 27.2059 L1674.42 54.3874 Q1674.42 60.8284 1676.93 64.0691 Q1679.44 67.2693 1684.46 67.2693 Q1690.5 67.2693 1693.98 63.421 Q1697.51 59.5726 1697.51 52.9291 L1697.51 27.2059 L1704.96 27.2059 L1704.96 72.576 L1697.51 72.576 L1697.51 65.6084 Q1694.79 69.7404 1691.19 71.7658 Q1687.62 73.7508 1682.88 73.7508 Q1675.06 73.7508 1671.01 68.8897 Q1666.96 64.0286 1666.96 54.671 M1685.72 26.1121 L1685.72 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1727.69 14.324 L1727.69 27.2059 L1743.04 27.2059 L1743.04 32.9987 L1727.69 32.9987 L1727.69 57.6282 Q1727.69 63.1779 1729.18 64.7578 Q1730.72 66.3376 1735.38 66.3376 L1743.04 66.3376 L1743.04 72.576 L1735.38 72.576 Q1726.75 72.576 1723.47 69.3758 Q1720.19 66.1351 1720.19 57.6282 L1720.19 32.9987 L1714.72 32.9987 L1714.72 27.2059 L1720.19 27.2059 L1720.19 14.324 L1727.69 14.324 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1752.84 27.2059 L1760.3 27.2059 L1760.3 72.576 L1752.84 72.576 L1752.84 27.2059 M1752.84 9.54393 L1760.3 9.54393 L1760.3 18.9825 L1752.84 18.9825 L1752.84 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1793.47 32.4315 Q1787.48 32.4315 1783.99 37.1306 Q1780.51 41.7891 1780.51 49.9314 Q1780.51 58.0738 1783.95 62.7728 Q1787.44 67.4314 1793.47 67.4314 Q1799.43 67.4314 1802.91 62.7323 Q1806.39 58.0333 1806.39 49.9314 Q1806.39 41.8701 1802.91 37.1711 Q1799.43 32.4315 1793.47 32.4315 M1793.47 26.1121 Q1803.19 26.1121 1808.74 32.4315 Q1814.29 38.7509 1814.29 49.9314 Q1814.29 61.0714 1808.74 67.4314 Q1803.19 73.7508 1793.47 73.7508 Q1783.71 73.7508 1778.16 67.4314 Q1772.65 61.0714 1772.65 49.9314 Q1772.65 38.7509 1778.16 32.4315 Q1783.71 26.1121 1793.47 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1864.36 45.1919 L1864.36 72.576 L1856.91 72.576 L1856.91 45.4349 Q1856.91 38.994 1854.4 35.7938 Q1851.89 32.5936 1846.86 32.5936 Q1840.83 32.5936 1837.34 36.4419 Q1833.86 40.2903 1833.86 46.9338 L1833.86 72.576 L1826.37 72.576 L1826.37 27.2059 L1833.86 27.2059 L1833.86 34.2544 Q1836.53 30.163 1840.14 28.1376 Q1843.78 26.1121 1848.52 26.1121 Q1856.34 26.1121 1860.35 30.9732 Q1864.36 35.7938 1864.36 45.1919 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip082)" style="stroke:#80c4ac; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="294.479,1688.65 305.926,1688.65 317.373,1688.65 328.82,1688.65 340.266,1688.63 351.713,1688.59 363.16,1688.54 374.607,1688.5 386.054,1688.5 397.501,1688.53 408.948,1688.57 420.395,1688.61 431.842,1688.62 443.289,1688.6 454.736,1688.55 466.183,1688.5 477.63,1688.46 489.077,1688.41 500.523,1688.33 511.97,1688.16 523.417,1687.93 534.864,1687.72 546.311,1687.6 557.758,1687.59 569.205,1687.64 580.652,1687.67 592.099,1687.62 603.546,1687.44 614.993,1687.05 626.44,1686.46 637.887,1685.74 649.334,1685.01 660.78,1684.34 672.227,1683.72 683.674,1682.97 695.121,1681.9 706.568,1680.4 718.015,1678.58 729.462,1676.61 740.909,1674.66 752.356,1672.68 763.803,1670.47 775.25,1667.95 786.697,1665.28 798.144,1662.6 809.591,1659.58 821.037,1655.57 832.484,1650.06 843.931,1642.51 855.378,1630.37 866.825,1605.63 878.272,1554.05 889.719,1465.43 901.166,1354.66 912.613,1268.94 924.06,1255.51 935.507,1315.57 946.954,1402.5 958.401,1467.52 969.848,1494.72 981.295,1494.9 992.741,1483.02 1004.19,1466.95 1015.64,1448.5 1027.08,1427.44 1038.53,1403.63 1049.98,1377.32 1061.42,1348.65 1072.87,1317.95 1084.32,1286.27 1095.76,1254.96 1107.21,1224.13 1118.66,1192.08 1130.1,1156.76 1141.55,1117.39 1153,1074.51 1164.45,1029.06 1175.89,982.147 1187.34,935.611 1198.79,891.939 1210.23,852.813 1221.68,817.578 1233.13,783.453 1244.57,747.198 1256.02,706.639 1267.47,661.633 1278.91,614.39 1290.36,568.394 1301.81,526.415 1313.26,489.257 1324.7,455.664 1336.15,422.917 1347.6,388.337 1359.04,351.496 1370.49,315.24 1381.94,283.739 1393.38,259.056 1404.83,239.776 1416.28,222.786 1427.72,206.081 1439.17,190.401 1450.62,178.596 1462.07,173.254 1473.51,175.264 1484.96,184.386 1496.41,199.105 1507.85,215.257 1519.3,227.87 1530.75,236.457 1542.19,246.468 1553.64,263.769 1565.09,289.184 1576.53,319.389 1587.98,351.215 1599.43,383.653 1610.88,416.84 1622.32,450.949 1633.77,486.584 1645.22,525.149 1656.66,567.506 1668.11,612.709 1679.56,659.022 1691,705.469 1702.45,751.824 1713.9,797.975 1725.34,843.705 1736.79,888.361 1748.24,930.641 1759.69,969.579 1771.13,1005.97 1782.58,1042.44 1794.03,1081.87 1805.47,1125.18 1816.92,1170.26 1828.37,1212.93 1839.81,1249.65 1851.26,1279.62 1862.71,1304.98 1874.16,1328.97 1885.6,1354.01 1897.05,1380.87 1908.5,1408.8 1919.94,1436.24 1931.39,1461.75 1942.84,1484.7 1954.28,1505.18 1965.73,1523.57 1977.18,1540.31 1988.62,1555.55 2000.07,1569.16 2011.52,1581.17 2022.97,1592.05 2034.41,1602.28 2045.86,1611.84 2057.31,1620.43 2068.75,1628.12 2080.2,1635.24 2091.65,1641.9 2103.09,1647.82 2114.54,1652.81 2125.99,1657 2137.43,1660.63 2148.88,1663.78 2160.33,1666.4 2171.78,1668.54 2183.22,1670.38 2194.67,1672.12 2206.12,1673.83 2217.56,1675.47 2229.01,1677.01 2240.46,1678.47 2251.9,1679.9 2263.35,1681.32 2274.8,1682.67 2286.24,1683.8 2297.69,1684.62 2309.14,1685.2 2320.59,1685.69 2332.03,1686.16 2343.48,1686.57 2354.93,1686.87 2366.37,1687.12 2377.82,1687.38 2389.27,1687.67 2400.71,1687.95 2412.16,1688.18 2423.61,1688.33 2435.05,1688.42 2446.5,1688.44 2457.95,1688.41 2469.4,1688.36 2480.84,1688.33 2492.29,1688.37 2503.74,1688.46 2515.18,1688.55 2526.63,1688.61 2538.08,1688.64 2549.52,1688.65 2560.97,1688.65 2572.42,1688.65 "></polyline>
<polyline clip-path="url(#clip082)" style="stroke:#ffc0cb; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1702.38,3340.44 1702.38,-1478.53 "></polyline>
<path clip-path="url(#clip080)" d="M2133.04 336.856 L2560.27 336.856 L2560.27 181.336 L2133.04 181.336  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2133.04,336.856 2560.27,336.856 2560.27,181.336 2133.04,181.336 2133.04,336.856 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#80c4ac; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2159.87,233.176 2320.85,233.176 "></polyline>
<path clip-path="url(#clip080)" d="M2361.52 252.864 Q2359.71 257.493 2358 258.905 Q2356.29 260.317 2353.42 260.317 L2350.01 260.317 L2350.01 256.753 L2352.51 256.753 Q2354.27 256.753 2355.25 255.919 Q2356.22 255.086 2357.4 251.984 L2358.16 250.04 L2347.68 224.531 L2352.19 224.531 L2360.29 244.808 L2368.39 224.531 L2372.91 224.531 L2361.52 252.864 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M2380.2 246.521 L2387.84 246.521 L2387.84 220.156 L2379.53 221.822 L2379.53 217.563 L2387.79 215.896 L2392.47 215.896 L2392.47 246.521 L2400.11 246.521 L2400.11 250.456 L2380.2 250.456 L2380.2 246.521 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip080)" style="stroke:#ffc0cb; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="2159.87,285.016 2320.85,285.016 "></polyline>
<path clip-path="url(#clip080)" d="M2372.33 276.371 L2362.95 288.986 L2372.82 302.296 L2367.79 302.296 L2360.25 292.111 L2352.7 302.296 L2347.68 302.296 L2357.75 288.732 L2348.53 276.371 L2353.56 276.371 L2360.43 285.607 L2367.31 276.371 L2372.33 276.371 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M2396.5 267.736 L2409.07 280.63 L2404.41 280.63 L2394.23 271.486 L2384.04 280.63 L2379.39 280.63 L2391.96 267.736 L2396.5 267.736 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M2436.38 273.431 L2428.07 277.921 L2436.38 282.435 L2435.04 284.704 L2427.26 280.005 L2427.26 288.732 L2424.62 288.732 L2424.62 280.005 L2416.84 284.704 L2415.5 282.435 L2423.81 277.921 L2415.5 273.431 L2416.84 271.139 L2424.62 275.838 L2424.62 267.111 L2427.26 267.111 L2427.26 275.838 L2435.04 271.139 L2436.38 273.431 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M2457.88 280.769 L2487.56 280.769 L2487.56 284.657 L2457.88 284.657 L2457.88 280.769 M2457.88 290.213 L2487.56 290.213 L2487.56 294.148 L2457.88 294.148 L2457.88 290.213 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M2513.53 298.361 L2521.17 298.361 L2521.17 271.996 L2512.86 273.662 L2512.86 269.403 L2521.12 267.736 L2525.8 267.736 L2525.8 298.361 L2533.44 298.361 L2533.44 302.296 L2513.53 302.296 L2513.53 298.361 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="注（$x^*=0$ でのアトムについて）">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
注（<span class="math inline">\(x^*=0\)</span> でのアトムについて）
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math inline">\(x^*=0\)</span> に原子が存在する．</p>
<p>ここでは密度関数は滑らかに見えるが，実際には <span class="math inline">\(x^*=0\)</span> で不連続である．</p>
<p>これは，計算の都合上，<span class="math inline">\(\delta_0\)</span> を <span class="math inline">\(\mathrm{N}(0,0.005)\)</span> で代用したためである．</p>
</div>
</div>
</div>
</section>
<section id="map-推定量" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="map-推定量"><span class="header-section-number">1.3</span> MAP 推定量</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定義 (maximum a posterior estimator)">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定義 (maximum a posterior estimator)
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[
\widehat{x}:=\mathop{\mathrm{arg\,max}}_{x\in\mathbb{R}}p(x|y_1,\cdots,y_n)
\]</span> で定まる推定量 <span class="math inline">\(\mathbb{R}^n\to\mathbb{R}\)</span> を <strong>MAP 推定量</strong> という．</p>
</div>
</div>
<p>例 <a href="#sec-example" class="quarto-xref">1.2</a> などをはじめ，ほとんどの場面では良い推定量を与え，多くの場合の最初のチョイスとして適しているかもしれない．</p>
<p>しかし，例 <a href="#sec-example" class="quarto-xref">1.2</a> をさらに変形することで，次のような事後分布が得られる状況は容易に想像がつく：</p>
<div id="cell-fig-1" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">f</span>(x)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">-</span><span class="fl">1.8</span> <span class="op">&lt;</span> x <span class="op">&lt;</span> <span class="op">-</span><span class="fl">1.6</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">2.5</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elseif</span> <span class="fl">0</span> <span class="op">&lt;</span> x <span class="op">&lt;</span> <span class="fl">1.5</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">1</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">0</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, size<span class="op">=</span>(<span class="fl">600</span>, <span class="fl">400</span>), legend<span class="op">=</span><span class="cn">false</span>, color<span class="op">=</span><span class="st">"#80c4ac"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-1" class="cell-output cell-output-display quarto-figure quarto-figure-center quarto-float anchored" data-execution_count="6">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewbox="0 0 2400 1600">
<defs>
  <clippath id="clip170">
    <rect x="0" y="0" width="2400" height="1600"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip170)" d="M0 1600 L2400 1600 L2400 8.88178e-14 L0 8.88178e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip171">
    <rect x="480" y="0" width="1681" height="1600"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip170)" d="M156.112 1486.45 L2352.76 1486.45 L2352.76 47.2441 L156.112 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip172">
    <rect x="156" y="47" width="2198" height="1440"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.281,1486.45 218.281,47.2441 "></polyline>
<polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="736.358,1486.45 736.358,47.2441 "></polyline>
<polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1254.43,1486.45 1254.43,47.2441 "></polyline>
<polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1772.51,1486.45 1772.51,47.2441 "></polyline>
<polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2290.59,1486.45 2290.59,47.2441 "></polyline>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,1486.45 2352.76,1486.45 "></polyline>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.281,1486.45 218.281,1467.55 "></polyline>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="736.358,1486.45 736.358,1467.55 "></polyline>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1254.43,1486.45 1254.43,1467.55 "></polyline>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1772.51,1486.45 1772.51,1467.55 "></polyline>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2290.59,1486.45 2290.59,1467.55 "></polyline>
<path clip-path="url(#clip170)" d="M188.224 1532.02 L217.899 1532.02 L217.899 1535.95 L188.224 1535.95 L188.224 1532.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M232.02 1544.91 L248.339 1544.91 L248.339 1548.85 L226.395 1548.85 L226.395 1544.91 Q229.057 1542.16 233.64 1537.53 Q238.246 1532.88 239.427 1531.53 Q241.672 1529.01 242.552 1527.27 Q243.455 1525.51 243.455 1523.82 Q243.455 1521.07 241.51 1519.33 Q239.589 1517.6 236.487 1517.6 Q234.288 1517.6 231.834 1518.36 Q229.404 1519.13 226.626 1520.68 L226.626 1515.95 Q229.45 1514.82 231.904 1514.24 Q234.358 1513.66 236.395 1513.66 Q241.765 1513.66 244.959 1516.35 Q248.154 1519.03 248.154 1523.52 Q248.154 1525.65 247.344 1527.57 Q246.557 1529.47 244.45 1532.07 Q243.871 1532.74 240.77 1535.95 Q237.668 1539.15 232.02 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M706.115 1532.02 L735.791 1532.02 L735.791 1535.95 L706.115 1535.95 L706.115 1532.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M746.693 1544.91 L754.332 1544.91 L754.332 1518.55 L746.022 1520.21 L746.022 1515.95 L754.286 1514.29 L758.962 1514.29 L758.962 1544.91 L766.601 1544.91 L766.601 1548.85 L746.693 1548.85 L746.693 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M1254.43 1517.37 Q1250.82 1517.37 1248.99 1520.93 Q1247.19 1524.47 1247.19 1531.6 Q1247.19 1538.71 1248.99 1542.27 Q1250.82 1545.82 1254.43 1545.82 Q1258.07 1545.82 1259.87 1542.27 Q1261.7 1538.71 1261.7 1531.6 Q1261.7 1524.47 1259.87 1520.93 Q1258.07 1517.37 1254.43 1517.37 M1254.43 1513.66 Q1260.24 1513.66 1263.3 1518.27 Q1266.38 1522.85 1266.38 1531.6 Q1266.38 1540.33 1263.3 1544.94 Q1260.24 1549.52 1254.43 1549.52 Q1248.62 1549.52 1245.55 1544.94 Q1242.49 1540.33 1242.49 1531.6 Q1242.49 1522.85 1245.55 1518.27 Q1248.62 1513.66 1254.43 1513.66 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M1762.89 1544.91 L1770.53 1544.91 L1770.53 1518.55 L1762.22 1520.21 L1762.22 1515.95 L1770.48 1514.29 L1775.16 1514.29 L1775.16 1544.91 L1782.8 1544.91 L1782.8 1548.85 L1762.89 1548.85 L1762.89 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M2285.24 1544.91 L2301.56 1544.91 L2301.56 1548.85 L2279.61 1548.85 L2279.61 1544.91 Q2282.28 1542.16 2286.86 1537.53 Q2291.47 1532.88 2292.65 1531.53 Q2294.89 1529.01 2295.77 1527.27 Q2296.67 1525.51 2296.67 1523.82 Q2296.67 1521.07 2294.73 1519.33 Q2292.81 1517.6 2289.71 1517.6 Q2287.51 1517.6 2285.05 1518.36 Q2282.62 1519.13 2279.85 1520.68 L2279.85 1515.95 Q2282.67 1514.82 2285.12 1514.24 Q2287.58 1513.66 2289.61 1513.66 Q2294.98 1513.66 2298.18 1516.35 Q2301.37 1519.03 2301.37 1523.52 Q2301.37 1525.65 2300.56 1527.57 Q2299.78 1529.47 2297.67 1532.07 Q2297.09 1532.74 2293.99 1535.95 Q2290.89 1539.15 2285.24 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,1445.72 2352.76,1445.72 "></polyline>
<polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,1174.17 2352.76,1174.17 "></polyline>
<polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,902.62 2352.76,902.62 "></polyline>
<polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,631.072 2352.76,631.072 "></polyline>
<polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,359.524 2352.76,359.524 "></polyline>
<polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,87.9763 2352.76,87.9763 "></polyline>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,1486.45 156.112,47.2441 "></polyline>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,1445.72 175.01,1445.72 "></polyline>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,1174.17 175.01,1174.17 "></polyline>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,902.62 175.01,902.62 "></polyline>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,631.072 175.01,631.072 "></polyline>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,359.524 175.01,359.524 "></polyline>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,87.9763 175.01,87.9763 "></polyline>
<path clip-path="url(#clip170)" d="M62.9365 1431.51 Q59.3254 1431.51 57.4967 1435.08 Q55.6912 1438.62 55.6912 1445.75 Q55.6912 1452.86 57.4967 1456.42 Q59.3254 1459.96 62.9365 1459.96 Q66.5707 1459.96 68.3763 1456.42 Q70.205 1452.86 70.205 1445.75 Q70.205 1438.62 68.3763 1435.08 Q66.5707 1431.51 62.9365 1431.51 M62.9365 1427.81 Q68.7467 1427.81 71.8022 1432.42 Q74.8809 1437 74.8809 1445.75 Q74.8809 1454.48 71.8022 1459.08 Q68.7467 1463.67 62.9365 1463.67 Q57.1264 1463.67 54.0477 1459.08 Q50.9921 1454.48 50.9921 1445.75 Q50.9921 1437 54.0477 1432.42 Q57.1264 1427.81 62.9365 1427.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M83.0984 1457.12 L87.9827 1457.12 L87.9827 1463 L83.0984 1463 L83.0984 1457.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M108.168 1431.51 Q104.557 1431.51 102.728 1435.08 Q100.922 1438.62 100.922 1445.75 Q100.922 1452.86 102.728 1456.42 Q104.557 1459.96 108.168 1459.96 Q111.802 1459.96 113.608 1456.42 Q115.436 1452.86 115.436 1445.75 Q115.436 1438.62 113.608 1435.08 Q111.802 1431.51 108.168 1431.51 M108.168 1427.81 Q113.978 1427.81 117.033 1432.42 Q120.112 1437 120.112 1445.75 Q120.112 1454.48 117.033 1459.08 Q113.978 1463.67 108.168 1463.67 Q102.358 1463.67 99.2789 1459.08 Q96.2234 1454.48 96.2234 1445.75 Q96.2234 1437 99.2789 1432.42 Q102.358 1427.81 108.168 1427.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M63.9319 1159.97 Q60.3208 1159.97 58.4921 1163.53 Q56.6865 1167.07 56.6865 1174.2 Q56.6865 1181.31 58.4921 1184.87 Q60.3208 1188.42 63.9319 1188.42 Q67.5661 1188.42 69.3717 1184.87 Q71.2004 1181.31 71.2004 1174.2 Q71.2004 1167.07 69.3717 1163.53 Q67.5661 1159.97 63.9319 1159.97 M63.9319 1156.26 Q69.742 1156.26 72.7976 1160.87 Q75.8763 1165.45 75.8763 1174.2 Q75.8763 1182.93 72.7976 1187.54 Q69.742 1192.12 63.9319 1192.12 Q58.1217 1192.12 55.043 1187.54 Q51.9875 1182.93 51.9875 1174.2 Q51.9875 1165.45 55.043 1160.87 Q58.1217 1156.26 63.9319 1156.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M84.0938 1185.57 L88.978 1185.57 L88.978 1191.45 L84.0938 1191.45 L84.0938 1185.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M99.2095 1156.89 L117.566 1156.89 L117.566 1160.82 L103.492 1160.82 L103.492 1169.3 Q104.51 1168.95 105.529 1168.79 Q106.547 1168.6 107.566 1168.6 Q113.353 1168.6 116.733 1171.77 Q120.112 1174.94 120.112 1180.36 Q120.112 1185.94 116.64 1189.04 Q113.168 1192.12 106.848 1192.12 Q104.672 1192.12 102.404 1191.75 Q100.159 1191.38 97.7511 1190.64 L97.7511 1185.94 Q99.8345 1187.07 102.057 1187.63 Q104.279 1188.18 106.756 1188.18 Q110.76 1188.18 113.098 1186.08 Q115.436 1183.97 115.436 1180.36 Q115.436 1176.75 113.098 1174.64 Q110.76 1172.54 106.756 1172.54 Q104.881 1172.54 103.006 1172.95 Q101.154 1173.37 99.2095 1174.25 L99.2095 1156.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M53.7467 915.965 L61.3856 915.965 L61.3856 889.599 L53.0754 891.266 L53.0754 887.007 L61.3393 885.34 L66.0152 885.34 L66.0152 915.965 L73.654 915.965 L73.654 919.9 L53.7467 919.9 L53.7467 915.965 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M83.0984 914.02 L87.9827 914.02 L87.9827 919.9 L83.0984 919.9 L83.0984 914.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M108.168 888.419 Q104.557 888.419 102.728 891.983 Q100.922 895.525 100.922 902.655 Q100.922 909.761 102.728 913.326 Q104.557 916.868 108.168 916.868 Q111.802 916.868 113.608 913.326 Q115.436 909.761 115.436 902.655 Q115.436 895.525 113.608 891.983 Q111.802 888.419 108.168 888.419 M108.168 884.715 Q113.978 884.715 117.033 889.321 Q120.112 893.905 120.112 902.655 Q120.112 911.381 117.033 915.988 Q113.978 920.571 108.168 920.571 Q102.358 920.571 99.2789 915.988 Q96.2234 911.381 96.2234 902.655 Q96.2234 893.905 99.2789 889.321 Q102.358 884.715 108.168 884.715 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M54.7421 644.417 L62.381 644.417 L62.381 618.051 L54.0708 619.718 L54.0708 615.459 L62.3347 613.792 L67.0106 613.792 L67.0106 644.417 L74.6494 644.417 L74.6494 648.352 L54.7421 648.352 L54.7421 644.417 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M84.0938 642.472 L88.978 642.472 L88.978 648.352 L84.0938 648.352 L84.0938 642.472 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M99.2095 613.792 L117.566 613.792 L117.566 617.727 L103.492 617.727 L103.492 626.199 Q104.51 625.852 105.529 625.69 Q106.547 625.505 107.566 625.505 Q113.353 625.505 116.733 628.676 Q120.112 631.848 120.112 637.264 Q120.112 642.843 116.64 645.945 Q113.168 649.023 106.848 649.023 Q104.672 649.023 102.404 648.653 Q100.159 648.283 97.7511 647.542 L97.7511 642.843 Q99.8345 643.977 102.057 644.533 Q104.279 645.088 106.756 645.088 Q110.76 645.088 113.098 642.982 Q115.436 640.875 115.436 637.264 Q115.436 633.653 113.098 631.547 Q110.76 629.44 106.756 629.44 Q104.881 629.44 103.006 629.857 Q101.154 630.273 99.2095 631.153 L99.2095 613.792 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M56.9643 372.869 L73.2837 372.869 L73.2837 376.804 L51.3393 376.804 L51.3393 372.869 Q54.0014 370.114 58.5847 365.485 Q63.1911 360.832 64.3717 359.489 Q66.617 356.966 67.4967 355.23 Q68.3994 353.471 68.3994 351.781 Q68.3994 349.027 66.455 347.29 Q64.5337 345.554 61.4319 345.554 Q59.2328 345.554 56.7791 346.318 Q54.3486 347.082 51.5708 348.633 L51.5708 343.911 Q54.3949 342.777 56.8486 342.198 Q59.3023 341.619 61.3393 341.619 Q66.7096 341.619 69.9041 344.304 Q73.0985 346.99 73.0985 351.48 Q73.0985 353.61 72.2883 355.531 Q71.5013 357.429 69.3948 360.022 Q68.8161 360.693 65.7143 363.911 Q62.6124 367.105 56.9643 372.869 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M83.0984 370.925 L87.9827 370.925 L87.9827 376.804 L83.0984 376.804 L83.0984 370.925 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M108.168 345.323 Q104.557 345.323 102.728 348.888 Q100.922 352.429 100.922 359.559 Q100.922 366.665 102.728 370.23 Q104.557 373.772 108.168 373.772 Q111.802 373.772 113.608 370.23 Q115.436 366.665 115.436 359.559 Q115.436 352.429 113.608 348.888 Q111.802 345.323 108.168 345.323 M108.168 341.619 Q113.978 341.619 117.033 346.226 Q120.112 350.809 120.112 359.559 Q120.112 368.286 117.033 372.892 Q113.978 377.475 108.168 377.475 Q102.358 377.475 99.2789 372.892 Q96.2234 368.286 96.2234 359.559 Q96.2234 350.809 99.2789 346.226 Q102.358 341.619 108.168 341.619 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M57.9597 101.321 L74.279 101.321 L74.279 105.256 L52.3347 105.256 L52.3347 101.321 Q54.9967 98.5665 59.58 93.9369 Q64.1865 89.2841 65.367 87.9416 Q67.6124 85.4184 68.492 83.6823 Q69.3948 81.9231 69.3948 80.2333 Q69.3948 77.4786 67.4504 75.7425 Q65.5291 74.0064 62.4272 74.0064 Q60.2282 74.0064 57.7745 74.7703 Q55.344 75.5342 52.5662 77.0851 L52.5662 72.3629 Q55.3903 71.2287 57.8439 70.65 Q60.2976 70.0713 62.3347 70.0713 Q67.705 70.0713 70.8994 72.7565 Q74.0939 75.4416 74.0939 79.9323 Q74.0939 82.062 73.2837 83.9832 Q72.4966 85.8814 70.3902 88.474 Q69.8115 89.1453 66.7096 92.3628 Q63.6078 95.5573 57.9597 101.321 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M84.0938 99.3767 L88.978 99.3767 L88.978 105.256 L84.0938 105.256 L84.0938 99.3767 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip170)" d="M99.2095 70.6963 L117.566 70.6963 L117.566 74.6314 L103.492 74.6314 L103.492 83.1036 Q104.51 82.7564 105.529 82.5944 Q106.547 82.4092 107.566 82.4092 Q113.353 82.4092 116.733 85.5805 Q120.112 88.7517 120.112 94.1684 Q120.112 99.747 116.64 102.849 Q113.168 105.928 106.848 105.928 Q104.672 105.928 102.404 105.557 Q100.159 105.187 97.7511 104.446 L97.7511 99.747 Q99.8345 100.881 102.057 101.437 Q104.279 101.992 106.756 101.992 Q110.76 101.992 113.098 99.8859 Q115.436 97.7795 115.436 94.1684 Q115.436 90.5573 113.098 88.4508 Q110.76 86.3443 106.756 86.3443 Q104.881 86.3443 103.006 86.761 Q101.154 87.1777 99.2095 88.0573 L99.2095 70.6963 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip172)" style="stroke:#80c4ac; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.281,1445.72 221.654,1445.72 225.027,1445.72 228.4,1445.72 231.773,1445.72 247.367,1445.72 262.961,1445.72 278.555,1445.72 294.149,1445.72 301.946,1445.72 309.743,1445.72 313.641,1445.72 317.54,1445.72 318.514,1445.72 319.489,1445.72 320.464,1445.72 321.438,1445.72 322.413,87.9763 323.388,87.9763 324.362,87.9763 325.337,87.9763 327.286,87.9763 329.235,87.9763 331.185,87.9763 333.134,87.9763 337.032,87.9763 340.931,87.9763 348.728,87.9763 356.525,87.9763 375.267,87.9763 394.01,87.9763 403.381,87.9763 412.753,87.9763 415.095,87.9763 417.438,87.9763 419.781,87.9763 422.124,87.9763 422.71,87.9763 423.295,87.9763 423.881,87.9763 424.467,87.9763 425.052,87.9763 425.638,1445.72 426.224,1445.72 426.809,1445.72 427.981,1445.72 429.152,1445.72 430.324,1445.72 431.495,1445.72 435.457,1445.72 439.418,1445.72 443.38,1445.72 447.342,1445.72 455.265,1445.72 463.188,1445.72 479.035,1445.72 494.882,1445.72 563.737,1445.72 627.216,1445.72 695.272,1445.72 774.122,1445.72 844.194,1445.72 905.641,1445.72 972.634,1445.72 1040.03,1445.72 1077.28,1445.72 1114.54,1445.72 1149.98,1445.72 1185.43,1445.72 1203.86,1445.72 1222.29,1445.72 1231.5,1445.72 1240.72,1445.72 1243.02,1445.72 1245.32,1445.72 1247.63,1445.72 1249.93,1445.72 1251.08,1445.72 1252.23,1445.72 1252.81,1445.72 1253.39,1445.72 1253.96,1445.72 1254.54,902.62 1255.11,902.62 1255.69,902.62 1256.27,902.62 1256.84,902.62 1257.99,902.62 1259.14,902.62 1263.02,902.62 1266.9,902.62 1270.78,902.62 1274.66,902.62 1282.41,902.62 1290.17,902.62 1305.68,902.62 1321.2,902.62 1396.95,902.62 1466.35,902.62 1530.45,902.62 1595.38,902.62 1668.14,902.62 1734.08,902.62 1809.57,902.62 1879.47,902.62 1913.92,902.62 1948.38,902.62 1965.11,902.62 1981.83,902.62 1990.2,902.62 1998.56,902.62 2006.93,902.62 2015.29,902.62 2019.58,902.62 2023.86,902.62 2026.01,902.62 2028.15,902.62 2029.22,902.62 2030.29,902.62 2030.83,902.62 2031.36,902.62 2031.9,1445.72 2032.44,1445.72 2032.97,1445.72 2033.51,1445.72 2034.04,1445.72 2034.58,1445.72 2035.65,1445.72 2036.72,1445.72 2038.87,1445.72 2041.01,1445.72 2045.3,1445.72 2049.58,1445.72 2066.73,1445.72 2083.88,1445.72 2121.45,1445.72 2159.03,1445.72 2213.61,1445.72 2268.19,1445.72 2279.39,1445.72 2290.59,1445.72 "></polyline>
</svg>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;1
</figcaption>
</figure>
</div>
</div>
</section>
<section id="ベイズ最適推定量" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="ベイズ最適推定量"><span class="header-section-number">1.4</span> ベイズ最適推定量</h3>
<p><a href="#fig-1" class="quarto-xref">図&nbsp;1</a> の状況でも，たしかに１点のみを選ぶならば MAP 推定量で良いかもしれないが，<span class="math inline">\(x\le0\)</span> である確率は <span class="math inline">\(x\ge0\)</span> である確率よりも低いため，この意味では，<span class="math inline">\(x\in[0,3/2]\)</span> の範囲に推定量が収まっていた方が好ましいかもしれない．</p>
<p>推定量 <span class="math inline">\(\widehat{x}_n:\mathbb{R}^n\to\mathbb{R}\)</span> を評価するには，何らかのアプリオリな <strong>損失</strong> の概念が必要である．これを損失関数 <span class="math inline">\(L:\mathbb{R}^2\to\mathbb{R}\)</span> という形で与える．</p>
<p>すると，損失の期待値が計算可能になり，これを <strong>危険</strong> という： <span class="math display">\[
R(\widehat{x}_n):=\operatorname{E}[L(\widehat{x}_n(\boldsymbol{Y}),X)].
\]</span></p>
<p>このリスクを最小化する推定量を <strong>ベイズ最適推定量</strong>，その際のリスクを <strong>ベイズリスク</strong> という．<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<section id="sec-MMSE" class="level4" data-number="1.4.1">
<h4 data-number="1.4.1" class="anchored" data-anchor-id="sec-MMSE"><span class="header-section-number">1.4.1</span> <span class="math inline">\(l^2\)</span>-ベイズ最適推定量</h4>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(L(x,y):=(x-y)^2\)</span> と定める．このとき，<strong>事後平均</strong> がベイズリスクを達成する： <span class="math display">\[
\widehat{x}(\boldsymbol{y}):=\int_\mathbb{R}xp(x|\boldsymbol{y})\,
dx.
\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
<p><a href="#fig-1" class="quarto-xref">図&nbsp;1</a> の場合では，事後平均は約 <span class="math inline">\(0.1\)</span> で，かろうじて正になる．</p>
</section>
<section id="l1-ベイズ最適推定量" class="level4" data-number="1.4.2">
<h4 data-number="1.4.2" class="anchored" data-anchor-id="l1-ベイズ最適推定量"><span class="header-section-number">1.4.2</span> <span class="math inline">\(l^1\)</span>-ベイズ最適推定量</h4>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(L(x,y):=\lvert x-y\rvert\)</span> と定める．このとき，<strong>事後中央値</strong> がベイズリスクを達成する．</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
<p><a href="#fig-1" class="quarto-xref">図&nbsp;1</a> の場合では，事後中央値は <span class="math inline">\(0.5\)</span> となる．大変頑健な推定だと言えるだろう．</p>
</section>
<section id="最適決定規則" class="level4" data-number="1.4.3">
<h4 data-number="1.4.3" class="anchored" data-anchor-id="最適決定規則"><span class="header-section-number">1.4.3</span> 最適決定規則</h4>
<p>今回の誤り訂正符号の文脈の目標は，<span class="math inline">\(x^*\)</span> の復元であることを思い出せば，今回の損失は <span class="math inline">\(L(x,y)=\delta_0(x-y)\)</span> ととり，復号が成功する確率を最大とする推定量が「最良」と言うべきであろう： <span class="math display">\[
R(\widehat{x}_n)=\operatorname{P}[\widehat{x}_n(\boldsymbol{Y})=X]
\]</span></p>
<p>これは結局 MAP 推定量 <span class="math display">\[
\widehat{x}_n:=\mathop{\mathrm{arg\,max}}_{x\in\mathbb{R}}p(x|\boldsymbol{y})
\]</span> で与えられることになる．</p>
</section>
</section>
</section>
<section id="統計物理からの視点" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="統計物理からの視点"><span class="header-section-number">2</span> 統計物理からの視点</h2>
<p>真のシグナル <span class="math inline">\(x^*\in\mathbb{R}\)</span> を，事後平均によって点推定する問題を考える（次節で一般次元のベクトル <span class="math inline">\(\mathbb{R}^n\)</span> のスパース推定を考える．</p>
<section id="事後分布をある物理系の平衡分布と見る" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="事後分布をある物理系の平衡分布と見る"><span class="header-section-number">2.1</span> 事後分布をある物理系の平衡分布と見る</h3>
<p>ベイズの公式 (<a href="#eq-bayes" class="quarto-xref">1</a>) は <span class="math display">\[
p(x|\boldsymbol{y})=\frac{e^{\log p(\boldsymbol{y}|x)p(x)}}{p(\boldsymbol{y})}
\]</span> <span class="math display">\[
=\frac{e^{-H(x,\boldsymbol{y})}}{Z(\boldsymbol{y})},
\]</span> <span class="math display">\[
H(x,\boldsymbol{y}):=-\log p(\boldsymbol{y}|x)-\log p(x),\quad Z(\boldsymbol{y}):=p(y)
\]</span> と書き換えられる．</p>
<p>すなわち，Bayes 事後分布 <span class="math inline">\(p(x|\boldsymbol{y})\)</span> は，<span class="math inline">\(\mathbb{R}\times\mathbb{R}^n\)</span> を配位空間に持ち，Hamiltonian <span class="math inline">\(H(x,\boldsymbol{y})\)</span> を持つ正準集団の平衡分布と捉えることができる．</p>
</section>
<section id="sec-identification" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="sec-identification"><span class="header-section-number">2.2</span> もう一つの見方</h3>
<p>今回，通信路は加法的に Gauss ノイズを加えるものとした． <span class="math display">\[
p(x,y)dy=\mathrm{N}(x,\sigma)(dy)
\]</span> とした場合，次のように理解することもできる： <span class="math display">\[
p(x|\boldsymbol{y})=\frac{e^{-H(x,\boldsymbol{y})}}{Z(\boldsymbol{y})},
\]</span> <span class="math display">\[
H(x,\boldsymbol{y}):=\frac{1}{2\sigma^2}\sum_{i=1}^n(x^2-2xy_i)-\log p(x),
\]</span> <span class="math display">\[
Z(\boldsymbol{y}):=\frac{1}{(2\pi\sigma^2)^{\frac{n}{2}}}\frac{e^{-\frac{\lvert\boldsymbol{y}\rvert^2}{2\sigma^2}}}{p(\boldsymbol{y})}.
\]</span></p>
<p>この場合，分配関数 <span class="math inline">\(Z(\boldsymbol{y})\)</span> は，情報源 <span class="math inline">\(p(x)\)</span> と Gauss 型通信路 <span class="math inline">\(p(y|x)\)</span> で与えられた周辺モデル <span class="math inline">\(p(y)\)</span> と，<span class="math inline">\(\mathrm{N}(0,\sigma^2)\)</span> との <a href="https://ja.wikipedia.org/wiki/ベイズ因子"><strong>ベイズ因子</strong></a> になっている．</p>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="式変形">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
式変形
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math display">\[\begin{align*}
    p(x|\boldsymbol{y})&amp;=p(\boldsymbol{y}|x)\frac{p(x)}{p(\boldsymbol{y})}\\
    &amp;=\frac{p(x)}{p(\boldsymbol{y})}\frac{1}{(2\pi\sigma^2)^{\frac{n}{2}}}e^{-\frac{1}{2\sigma^2}\sum_{i=1}^n(x-y_i)^2}\\
    &amp;=\frac{p(x)}{p(\boldsymbol{y})}\frac{e^{-\frac{1}{2\sigma^2}\sum_{i=1}^ny_i^2}}{(2\pi\sigma^2)^{\frac{n}{2}}}e^{-\frac{1}{2\sigma^2}\sum_{i=1}^n(x^2-2xy_i)}\\
    &amp;=\frac{p(x)e^{-\frac{1}{2\sigma^2}\sum_{i=1}^n(x^2-2xy_i)}}{Z(\boldsymbol{y})}\\
    &amp;=\frac{1}{Z(\boldsymbol{y})}\exp\left(\log p(x)-\frac{1}{2\sigma^2}\sum_{i=1}^n(x^2-2xy_i)\right)
\end{align*}\]</span></p>
</div>
</div>
</div>
<p>さらに，このモデル <span class="math inline">\(H\)</span> における自由エントロピーは，<span class="math inline">\(p(\boldsymbol{y})\)</span> と <span class="math inline">\(\mathrm{N}(0,\sigma^2)^{\otimes n}\)</span> との間の KL 乖離度となっている： <span class="math display">\[
F_n:=\int_{\mathbb{R}^n}\log\frac{p(\boldsymbol{y})}{q(\boldsymbol{y})}p(\boldsymbol{y})\,d\boldsymbol{y}=\mathop{\mathrm{KL}}(p,q).
\]</span> ただし，<span class="math inline">\(q\)</span> は <span class="math inline">\(\mathrm{N}(0,\sigma^2)^{\otimes n}\)</span> の密度とした．</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（その他の物理量）^[[@Krzakala-Zdeborova2024 p.122]．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（その他の物理量）<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p>この Hamiltonian <span class="math inline">\(H\)</span> を持つ系について，</p>
<ol type="1">
<li><p>エントロピー <span class="math inline">\(H\)</span> は次で与えられる：</p>
<p><span class="math display">\[\begin{align*}
     H(Y)&amp;:=-\int_{\mathbb{R}^n}(\log p(\boldsymbol{y}))p(\boldsymbol{y})\,d\boldsymbol{y}\\
     &amp;=\frac{n}{2}\log(2\pi\sigma^2)+\frac{1}{2\sigma^2}\int_{\mathbb{R}^n}\lvert\boldsymbol{y}\rvert^2p(\boldsymbol{y})\,d\boldsymbol{y}-F_n.
\end{align*}\]</span></p></li>
<li><p>相互情報量 <span class="math inline">\(I\)</span> は次で与えられる：</p>
<p><span class="math display">\[\begin{align*}
     I(X,Y)&amp;:=\mathop{\mathrm{KL}}(p(x,y),p(x)p(y))\\\\
     &amp;=\frac{n}{2\sigma^2}\int_{\mathbb{R}}x^2p(x)\,dx-F_n.
\end{align*}\]</span></p></li>
</ol>
<p>特に，いずれも自由エネルギーの定数倍である</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>の式変形は次のとおり： <span class="math display">\[\begin{align*}
    H(Y)&amp;:=-\int_{\mathbb{R}^n}(\log p(\boldsymbol{y}))p(\boldsymbol{y})\,d\boldsymbol{y}\\
    &amp;=-\int_{\mathbb{R}^n}p(\boldsymbol{y})d\boldsymbol{y}\log q(\boldsymbol{y})-F_n\\
    &amp;=-\int_{\mathbb{R}^n}\biggr(-\frac{n}{2}\log(2\pi\sigma^2)-\frac{\lvert\boldsymbol{y}\rvert^2}{2\sigma^2}\biggl)p(\boldsymbol{y})d\boldsymbol{y}-F_n\\
    &amp;=\frac{n}{2}\log(2\pi\sigma^2)+\frac{n}{2\sigma^2}\int_{\mathbb{R}}y_i^2p(y_i)\,dy_i-F_n.
\end{align*}\]</span></p></li>
<li><p>次の関係式を用いる： <span class="math display">\[
I(X,Y)=H(Y)-H(Y|X)
\]</span> <span class="math inline">\(H(Y)\)</span> は 1. から判明しており，<span class="math inline">\(H(Y|X)\)</span> は次のように計算できる：</p>
<p><span class="math display">\[\begin{align*}
H(Y|X)&amp;=-\int_{\mathbb{R}^{n+1}}\log p(\boldsymbol{y}|x)p(\boldsymbol{y}|x)p(x)\,dxd\boldsymbol{y}\\
&amp;=-\int_{\mathbb{R}^{n+1}}\log\left(\frac{1}{(2\pi\sigma^2)^{\frac{n}{2}}}\exp\left(-\frac{1}{2\sigma^2}\sum_{i=1}^n(y_i-x)^2\right)\right)p(\boldsymbol{y}|x)p(x)\,dxd\boldsymbol{y}\\
&amp;=\int_{\mathbb{R}^{n+1}}\left(\frac{n}{2}\log(2\pi\sigma^2)+\frac{\sum_{i=1}^n(x-y_i)^2}{2\sigma^2}\right)p(\boldsymbol{y}|x)p(x)\,dxd\boldsymbol{y}\\
&amp;=\frac{n}{2}\log(2\pi\sigma^2)+\frac{1}{2\sigma^2}\int_\mathbb{R}\left(\int_{\mathbb{R}^n}\sum_{i=1}^n(x-y_i)^2p(\boldsymbol{y}|x)\,d\boldsymbol{y}\right)\,p(x)dx\\
&amp;=\frac{n}{2}\log(2\pi\sigma^2)+\frac{n\sigma^2}{2\sigma^2}\int_\mathbb{R}p(x)\,dx\\
&amp;=\frac{n}{2}\log(2\pi\sigma^2)+\frac{n}{2}.
\end{align*}\]</span></p></li>
</ol>
<p>これと，<span class="math inline">\(y_i\)</span> には <span class="math inline">\(x_i\)</span> とこれと独立な分散 <span class="math inline">\(\sigma^2\)</span> のノイズが加わって得られる値であることから，次のように計算できる： <span class="math display">\[\begin{align*}
    I(X,Y)&amp;=H(Y)-\frac{n}{2}\log(2\pi\sigma^2)-\frac{n}{2}\\
    &amp;=-F_n-\frac{n}{2}+\frac{n}{2\sigma^2}\int_\mathbb{R}y_i^2p(y_i)\,dy_i\\
    &amp;=-F_n-\frac{n}{2}+\frac{n}{2\sigma^2}\left(\sigma^2+\int_\mathbb{R}x^2p(x)\,dx\right)\\
    &amp;=-F_n+\frac{n}{2\sigma^2}\int_\mathbb{R}x^2p(x)\,dx.
\end{align*}\]</span></p>
</div>
</div>
</div>
</section>
<section id="西森対称性" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="西森対称性"><span class="header-section-number">2.3</span> 西森対称性</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題 [@西森1980]^[[@Krzakala-Zdeborova2024 p.123] 定理13．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題 <span class="citation" data-cites="西森1980">(<a href="#ref-西森1980" role="doc-biblioref">Nishimori, 1980</a>)</span><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(P:\mathbb{R}\to\mathbb{R}^n\)</span> を確率核，<span class="math inline">\(X^*\in\mathcal{L}(\Omega)\)</span> は分布 <span class="math inline">\(\nu\in\mathcal{P}(\mathbb{R})\)</span> を持ち，<span class="math inline">\(Y\in\mathcal{L}(\Omega;\mathbb{R}^n)\)</span> の分布は <span class="math display">\[
\mu(dy)=\int_\mathbb{R}\nu(dx)P(x,dy)
\]</span> で定まるとする．ここで，<span class="math inline">\(Y\)</span> で条件づけた <span class="math inline">\(X^*\)</span> の確率分布を <span class="math inline">\(P^{X|Y}\)</span> とする： <span class="math display">\[
\nu(dx)=\int_{\mathbb{R}^n}\mu(dy)P^{X|Y}(y,dx).
\]</span> <span class="math display">\[
X^{(1)},\cdots,X^{(k)}\overset{\text{iid}}{\sim}P^{X|Y}
\]</span> を独立な確率変数列とすると，次が成り立つ： <span class="math display">\[
\operatorname{E}\biggl[f(Y,X^{(1)},\cdots,X^{(k)})\biggr]=\operatorname{E}\left[f(Y,X^{(1)},\cdots,X^{(k-1)},X^*)\right].
\]</span></p>
</div>
</div>
<p><span class="math inline">\(X^{(1)},\cdots,X^{(k)}\)</span> で表した確率変数の <span class="math inline">\(P^{X|Y}\)</span> に関する積分を Boltzmann 積分と呼び，観測を作り出す過程 <span class="math inline">\((X^*,Y)\)</span> に関する積分を無秩序積分 (disorder expectation) という．</p>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>この設定の下で，<span class="math inline">\((X^*,Y)\)</span> の結合分布が次の２通りで表せていることに注意： <span class="math display">\[
\nu(dx)P(x,dy)=\mu(dy)P^{X|Y}(y,dx).
\]</span> 従って， <span class="math display">\[\begin{align*}
    &amp;\quad\nu(dx)P(x,dy)P^{X|Y}(y,dx^{(1)},\cdots,dx^{(k)})\\
    &amp;=\mu(dy)P^{X|Y}(y,dx)P^{X|Y}(y,dx^{(1)},\cdots,dx^{(k)})
\end{align*}\]</span> に関して <span class="math inline">\(f(Y,X^{(1)},\cdots,X^{(k)})\)</span> の期待値を取ると，次のように計算できる： <span class="math display">\[\begin{align*}
    &amp;\quad\operatorname{E}\biggl[f(Y,X^{(1)},\cdots,X^{(k)})\biggr]\\
    &amp;=\int_{\mathbb{R}^{n+k}}f(y,x^{(1)},\cdots ,x^{(k-1)},x^{(k)})P^{X|Y}(y,dx^{(1)})\cdots P^{X|Y}(y,dx^{(k)})\mu(dy)\\
    &amp;=\int_{\mathbb{R}^{n+k}}f(y,x^{(1)},\cdots,x^{(k-1)},x)P^{X|Y}(y,dx^{(1)})\cdots P^{X|Y}(y,dx^{(k-1)})\nu(dx)P(x,dy)\\
    &amp;=\operatorname{E}\left[f(Y,X^{(1)},\cdots,X^{(k-1)},X^*)\right].
\end{align*}\]</span></p>
<p>確率核 <span class="math inline">\(P\)</span> にまつわる記法は次の記事も参照：</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/static/Notations.html" target="_blank">
            <img src="https://162348.github.io/static/Notations.svg" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">数学記法一覧</h3>
                <p class="article-description">本サイトで用いる記法と規約</p>
            </div>
        </a>
    </div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="物理的な解釈">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
物理的な解釈
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math inline">\(P^{X|Y}\)</span> に関する積分を <span class="math inline">\(\langle-\rangle\)</span> で表すことで，何をどのように物理的に解釈しているかが明確になる： <span class="math display">\[
\langle X\rangle=\operatorname{E}[X|Y].
\]</span></p>
<p>この見方を採用すると，期待値を <span class="math display">\[
\operatorname{E}\biggl[f(Y,X^{(1)},\cdots,X^{(k)})\biggr]=\operatorname{E}^Y\left[\left\langle f(Y,X^{(1)},\cdots,X^{(k)})\right\rangle\right]
\]</span> と二段階で捉えていることになる．右辺の外側の期待値は単に <span class="math inline">\(Y\)</span> のみに関してとっていることになる．</p>
<p>第 <a href="#sec-identification" class="quarto-xref">2.2</a> 節で考えたモデル <span class="math inline">\(H\)</span> における Boltzmann 分布が <span class="math inline">\(P^{X|Y}\)</span> となり，平均 <span class="math inline">\(\langle-\rangle\)</span> はこれに関する平均となる．</p>
<p>一方で，Hamiltonian <span class="math inline">\(H\)</span> にもランダム性が残っているのであり，これに関する平均が <span class="math inline">\((X^*,Y)\)</span> に関する平均に当たる．</p>
<p>こうして，ベイズ統計モデルはスピングラス系（特にランダムエネルギーモデル <span class="citation" data-cites="Derrida1980">(<a href="#ref-Derrida1980" role="doc-biblioref">Derrida, 1980</a>)</span>）と同一視できるようになる．</p>
<p>だが同時に，スピングラスのサンプリングを困難にする多谷構造も，ベイズ統計に輸入されるのである……．</p>
<p>スピングラスについては，次の記事も参照：</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Nature/StatisticalMechanics1.html" target="_blank">
            <img src="https://162348.github.io/posts/2024/Nature/SG.png" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">数学者のための統計力学１</h3>
                <p class="article-description">Ising 模型とスピングラス</p>
            </div>
        </a>
    </div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-MMSE-via-Nishimori" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="sec-MMSE-via-Nishimori"><span class="header-section-number">2.4</span> 最小自乗誤差推定量</h3>
<p>第 <a href="#sec-MMSE" class="quarto-xref">1.4.1</a> 節で扱った最小自乗誤差推定量の自乗誤差は次のように計算できる：</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（最小自乗誤差の表示）">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（最小自乗誤差の表示）
</div>
</div>
<div class="callout-body-container callout-body">
<p>事後平均推定量の自乗誤差は次のように表せる： <span class="math display">\[\begin{align*}
    \DeclareMathOperator{\MMSE}{MMSE}
    \MMSE&amp;:=\operatorname{E}\biggl[\biggr(X-\operatorname{E}[X|Y]\biggl)^2\biggr]\\
    &amp;=\operatorname{E}[X^2]-\operatorname{E}\biggl[\operatorname{E}[X|Y]^2\biggr].
\end{align*}\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math display">\[\begin{align*}
    \operatorname{E}[\mathrm{V}[X|Y]]&amp;=\operatorname{E}\biggl[\biggr(\operatorname{E}[X|Y]-X\biggl)^2\biggr]\\
    &amp;=\operatorname{E}\biggl[\operatorname{E}[X|Y]^2-2X\operatorname{E}[X|Y]+X^2\biggr]\\
    &amp;=\operatorname{E}\biggl[\operatorname{E}[X|Y]^2\biggr]-2\operatorname{E}\biggl[X\operatorname{E}[X|Y]\biggr]+\operatorname{E}[X^2]\\
    &amp;=\operatorname{E}[X^2]-\operatorname{E}\biggl[\operatorname{E}[X|Y]^2\biggr].
\end{align*}\]</span></p>
<p>この変形では，繰り返し期待値の法則 <span class="math display">\[\begin{align*}
    \operatorname{E}\biggl[X\operatorname{E}[X|Y]\biggr]&amp;=\operatorname{E}\biggl[\biggl[X\operatorname{E}[X|Y]\,\bigg|\,Y\biggr]\biggr]\\
    &amp;=\operatorname{E}\biggl[\operatorname{E}[X|Y]^2\biggr]
\end{align*}\]</span> を西森の対称性の代わりに用いたことになる．</p>
<p>換言すれば，西森の対称性を証明したのと同様の方法を本命題にも適用したため，直接命題の適用は回避したことになる．</p>
</div>
</div>
</div>
</section>
<section id="kl-乖離度の微分としての分散" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="kl-乖離度の微分としての分散"><span class="header-section-number">2.5</span> KL 乖離度の微分としての分散</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（自由エネルギーによる特徴付け）^[[@Krzakala-Zdeborova2024 p.124] 定理14．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（自由エネルギーによる特徴付け）<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p>簡単のため，<span class="math inline">\(n=1\)</span> とする．このとき，<span class="math inline">\(\beta:=\sigma^{-1}\)</span> に関して，次の式が成り立つ：</p>
<ol type="1">
<li><p>自由エネルギー <span class="math inline">\(F_1\)</span> について， <span class="math display">\[
\frac{\partial F_1}{\partial \beta}=\frac{\operatorname{E}\biggl[\operatorname{E}[X|Y]^2\biggr]}{2}.
\]</span></p></li>
<li><p>相互情報量 <span class="math inline">\(I(X,Y)\)</span> について，</p>
<p><span class="math display">\[\begin{align*}
    \frac{\partial I(X,Y)}{\partial \beta}&amp;=\frac{\MMSE}{2}\\
    &amp;=\frac{\operatorname{E}[X^2]-\operatorname{E}\biggl[\operatorname{E}[X|Y]^2\biggr]}{2}
\end{align*}\]</span></p></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
</section>
<section id="stein-の補題" class="level3" data-number="2.6">
<h3 data-number="2.6" class="anchored" data-anchor-id="stein-の補題"><span class="header-section-number">2.6</span> Stein の補題</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題 [@Stein1972]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題 <span class="citation" data-cites="Stein1972">(<a href="#ref-Stein1972" role="doc-biblioref">Stein, 1972</a>)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>可積分な確率変数 <span class="math inline">\(X\in\mathcal{L}^1(\Omega)\)</span> について，次は同値：</p>
<ol type="1">
<li><span class="math inline">\(X\)</span> の分布は標準Gaussである：<span class="math inline">\(X\sim\gamma_1\)</span>．</li>
<li>任意の <span class="math inline">\(f\in C^1_b(\mathbb{R})\)</span> について， <span class="math display">\[
\operatorname{E}[f'(X)]=\operatorname{E}[Xf(X)]&lt;\infty.
\]</span></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>(1)<span class="math inline">\(\Rightarrow\)</span>(2)</p>
<p><span class="math inline">\(f,f'\)</span> はいずれも有界としたから， <span class="math display">\[
  \operatorname{E}[f'(X)],\operatorname{E}[f(X)]&lt;\infty
  \]</span> が成り立つ．</p>
<p><span class="math inline">\(\gamma_1\)</span> の密度 <span class="math inline">\(\phi\)</span> は <span class="math inline">\(\phi'(x)=-x\phi(x)\)</span> を満たすことに注意すれば，部分積分により， <span class="math display">\[\begin{align*}
      \operatorname{E}[f'(X)]&amp;=-\int_\mathbb{R}f(x)\phi'(x)dx\\
      &amp;=\int_\mathbb{R}f(x)x\phi(x)dx=\operatorname{E}[f(X)X].
  \end{align*}\]</span></p></li>
<li><p>(2)<span class="math inline">\(\Rightarrow\)</span>(1)</p>
<p><span class="math inline">\(X\)</span> は可積分としたから，特性関数 <span class="math inline">\(\varphi(u):=\operatorname{E}[e^{iuX}]\)</span> は少なくとも <span class="math inline">\(C^1(\mathbb{R})\)</span>-級で，その微分は <span class="math inline">\(\phi(x):=e^{iux}\)</span> に関する仮定 <span class="math inline">\(\operatorname{E}[\phi'(X)]=\operatorname{E}[X\phi(X)]\)</span> を通じて <span class="math display">\[\begin{align*}
      \varphi'(u)&amp;=i\operatorname{E}[Xe^{iuX}]=-u\operatorname{E}[e^{iuX}]\\
      &amp;=-u\varphi(u),\qquad u\in\mathbb{R},
  \end{align*}\]</span> と計算できる．</p>
<p>この微分方程式は規格化条件 <span class="math inline">\(\varphi(0)=1\)</span> の下で一意な解 <span class="math inline">\(\varphi(u)=e^{-\frac{u^2}{2}}\)</span> を持つ．</p></li>
</ul>
</div>
</div>
</div>



</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Derrida1980" class="csl-entry" role="listitem">
Derrida, B. (1980). Random-energy model: Limit of a family of disordered models. <em>Phys. Rev. Lett.</em>, <em>45</em>, 79–82. <a href="https://doi.org/10.1103/PhysRevLett.45.79">https://doi.org/10.1103/PhysRevLett.45.79</a>
</div>
<div id="ref-Krzakala-Zdeborova2024" class="csl-entry" role="listitem">
Krazakala, F., &amp; Zdeborová, L. (2024). <em>Statistical physics methods in optimization and machine learning</em>. <a href="https://sphinxteam.github.io/EPFLDoctoralLecture2021/Notes.pdf">https://sphinxteam.github.io/EPFLDoctoralLecture2021/Notes.pdf</a>
</div>
<div id="ref-西森1980" class="csl-entry" role="listitem">
Nishimori, H. (1980). Exact results and critical properties of the ising model with competing interactions. <em>Journal of Physics C: Solid State Physics</em>, <em>13</em>(21), 4071. <a href="https://doi.org/10.1088/0022-3719/13/21/012">https://doi.org/10.1088/0022-3719/13/21/012</a>
</div>
<div id="ref-Stein1972" class="csl-entry" role="listitem">
Stein, C. (1972). <em><span class="nocase">A Bound for the Error in the Normal Approximation to the Distribution of a Sum of Dependent Random Variables</span></em>. Stanford University. <a href="https://purl.stanford.edu/jc818sv7483">https://purl.stanford.edu/jc818sv7483</a>
</div>
<div id="ref-Storopoli2021" class="csl-entry" role="listitem">
Storopoli, J. (2021). <em>Bayesian statistics with julia and turing</em>. <a href="https://storopoli.io/Bayesian-Julia">https://storopoli.io/Bayesian-Julia</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala &amp; Zdeborová, 2024, p. 119</a>)</span>．<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala &amp; Zdeborová, 2024, p. 122</a>)</span>．<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala &amp; Zdeborová, 2024, p. 123</a>)</span> 定理13．<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala &amp; Zdeborová, 2024, p. 124</a>)</span> 定理14．<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="162348/162348.github.io" data-repo-id="R_kgDOKlfKYQ" data-category="Announcements" data-category-id="DIC_kwDOKlfKYc4CgDmb" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" data-loading="lazy" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://162348.github.io/">
<p>Hirofumi Shiba</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/162348/162348.github.io/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ano2math5">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:shiba.hirofumi@ism.ac.jp">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../../blog.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>