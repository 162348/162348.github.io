<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="司馬 博文">

<title>Hirofumi Shiba - ベイズ統計学と統計物理学</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../profile.jpg" rel="icon" type="image/jpeg">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "?",
    "H"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-36GX2G6GLL"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-36GX2G6GLL', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="Hirofumi Shiba - ベイズ統計学と統計物理学">
<meta property="og:description" content="ノイズ付きで観測された情報を復元するデノイジング問題を，ベイズ統計学と統計力学の２つの観点から考える．ベイズ統計モデルはスピングラスモデルと同一視することができる．このことからも，一般に事後分布からのサンプリングが困難になりえることがよくわかる．">
<meta property="og:image" content="https://162348.github.io/posts/2024/Stat/posterior.svg">
<meta property="og:site_name" content="Hirofumi Shiba">
<meta name="twitter:title" content="Hirofumi Shiba - ベイズ統計学と統計物理学">
<meta name="twitter:description" content="ノイズ付きで観測された情報を復元するデノイジング問題を，ベイズ統計学と統計力学の２つの観点から考える．ベイズ統計モデルはスピングラスモデルと同一視することができる．このことからも，一般に事後分布からのサンプリングが困難になりえることがよくわかる．">
<meta name="twitter:image" content="https://162348.github.io/posts/2024/Stat/posterior.svg">
<meta name="twitter:creator" content="@ano2math5">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Hirofumi Shiba</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Sessions.html"> 
<span class="menu-text">Sessions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Japanese.html"> 
<span class="menu-text">自己紹介</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
    <a href="https://github.com/162348/162348.github.io/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">ベイズ統計学と統計物理学</h1>
            <p class="subtitle lead">スパース符号の復元を題材として</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Bayesian</div>
                <div class="quarto-category">Nature</div>
                <div class="quarto-category">Information</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>司馬 博文 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">6/20/2024</p>
      </div>
    </div>
    
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="block-title">概要</div>
      ノイズ付きで観測された情報を復元するデノイジング問題を，ベイズ統計学と統計力学の２つの観点から考える．ベイズ統計モデルはスピングラスモデルと同一視することができる．このことからも，一般に事後分布からのサンプリングが困難になりえることがよくわかる．
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#bayes-推定" id="toc-bayes-推定" class="nav-link active" data-scroll-target="#bayes-推定"><span class="header-section-number">1</span> Bayes 推定</a>
  <ul class="collapse">
  <li><a href="#設定" id="toc-設定" class="nav-link" data-scroll-target="#設定"><span class="header-section-number">1.1</span> 設定</a></li>
  <li><a href="#sec-example" id="toc-sec-example" class="nav-link" data-scroll-target="#sec-example"><span class="header-section-number">1.2</span> 例</a></li>
  <li><a href="#map-推定量" id="toc-map-推定量" class="nav-link" data-scroll-target="#map-推定量"><span class="header-section-number">1.3</span> MAP 推定量</a></li>
  <li><a href="#ベイズ最適推定量" id="toc-ベイズ最適推定量" class="nav-link" data-scroll-target="#ベイズ最適推定量"><span class="header-section-number">1.4</span> ベイズ最適推定量</a></li>
  </ul></li>
  <li><a href="#統計物理からの視点" id="toc-統計物理からの視点" class="nav-link" data-scroll-target="#統計物理からの視点"><span class="header-section-number">2</span> 統計物理からの視点</a>
  <ul class="collapse">
  <li><a href="#事後分布をある物理系の平衡分布と見る" id="toc-事後分布をある物理系の平衡分布と見る" class="nav-link" data-scroll-target="#事後分布をある物理系の平衡分布と見る"><span class="header-section-number">2.1</span> 事後分布をある物理系の平衡分布と見る</a></li>
  <li><a href="#sec-identification" id="toc-sec-identification" class="nav-link" data-scroll-target="#sec-identification"><span class="header-section-number">2.2</span> もう一つの見方</a></li>
  <li><a href="#西森対称性" id="toc-西森対称性" class="nav-link" data-scroll-target="#西森対称性"><span class="header-section-number">2.3</span> 西森対称性</a></li>
  <li><a href="#sec-MMSE-via-Nishimori" id="toc-sec-MMSE-via-Nishimori" class="nav-link" data-scroll-target="#sec-MMSE-via-Nishimori"><span class="header-section-number">2.4</span> 最小自乗誤差推定量</a></li>
  <li><a href="#kl-乖離度の微分としての分散" id="toc-kl-乖離度の微分としての分散" class="nav-link" data-scroll-target="#kl-乖離度の微分としての分散"><span class="header-section-number">2.5</span> KL 乖離度の微分としての分散</a></li>
  <li><a href="#sec-Steins-lemma" id="toc-sec-Steins-lemma" class="nav-link" data-scroll-target="#sec-Steins-lemma"><span class="header-section-number">2.6</span> Stein の補題</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<section id="bayes-推定" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="bayes-推定"><span class="header-section-number">1</span> Bayes 推定</h2>
<p>誤り訂正符号の文脈で Bayes （点）推定を考える．</p>
<p>誤り訂正符号は，Bayes 推定が自然に選好される格好の題材である．</p>
<section id="設定" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="設定"><span class="header-section-number">1.1</span> 設定</h3>
<p>情報源は無記憶で，確率分布 <span class="math inline">\(p(x)dx\)</span> に従うとし，通信路は，確率核 <span class="math inline">\(p(y|x)dy\)</span> に従うとする．</p>
<p>送信符号は１つの値 <span class="math inline">\(x^*\sim p(x)dx\)</span> であったとし，この単一の入力 <span class="math inline">\(x^*\)</span> を <span class="math inline">\(n\)</span> 回独立に観測する： <span class="math display">\[
y_1,\cdots,y_n\overset{\text{iid}}{\sim}p(y|x^*)dy.
\]</span></p>
<p>この観測を経たあと，送信符号 <span class="math inline">\(x^*\)</span> はいったい何だったのかを推定することを考えると，極めて自然に Bayes 推定が選択される．</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="純粋な解釈を持つ Bayes 推定">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
純粋な解釈を持つ Bayes 推定
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>まず，何の観測もない場合，<span class="math inline">\(x^*\)</span> の確率分布は <span class="math inline">\(p(x)dx\)</span> である（設定上）．</p>
<p>しかし，すでに観測 <span class="math inline">\(y_1,\cdots,y_n\)</span> を経ている．よってこの事象の上での <span class="math inline">\(x^*\)</span> の条件付き分布を計算すれば良いことになる： <span class="math display">\[
p(x|y_1,\cdots,y_n) = \frac{p(\boldsymbol{y}|x)p(x)}{p(\boldsymbol{y})}
\]</span> <span id="eq-bayes"><span class="math display">\[
= \frac{\displaystyle p(y_1|x)\cdots p(y_n|x)p(x)}{\displaystyle\int_\mathbb{R}p(y_1|x)\cdots p(y_n|x)p(x)\,dx}
\tag{1}\]</span></span></p>
<p>こうして，誤り訂正符号の文脈では，Bayes 事前確率・事後確率が純粋に確率としての解釈を持つ．</p>
</div>
</div>
</div>
</section>
<section id="sec-example" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="sec-example"><span class="header-section-number">1.2</span> 例</h3>
<p>入力は <span class="math inline">\(1/2\)</span> の確率で <span class="math inline">\(x=0\)</span> だが，もう <span class="math inline">\(1/2\)</span> の確率で標準正規分布 <span class="math inline">\(\mathrm{N}(0,1)\)</span> に従うとする： <span class="math display">\[
p(x)dx=\frac{1}{2}\delta_0(dx)+\frac{1}{2}\mathrm{N}(0,1)(dx).
\]</span> 通信路は加法的 Gauss 型であるとする： <span class="math display">\[
p(x,y)=\frac{1}{\sqrt{2\pi}}\exp\left(-\frac{(x-y)^2}{2}\right).
\]</span> では真値を <span class="math inline">\(x^*=1\)</span> として，<span class="math inline">\(n=10\)</span> 回の観測データを生成してみる：</p>
<div id="45aa7324" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> <span class="fl">1</span> <span class="op">.+</span> <span class="fu">randn</span>(<span class="fl">10</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1.6004724562180903, 0.13960272600878632, 2.1537899843077613, 0.8518095702268159, 2.114803985479983, -0.31071956686775715, 0.6094538611602249, 1.5054801998671294, 2.9383715667853174, 0.4676093709464989]</code></pre>
</div>
</div>
<p>愚直な計算から，<span class="math inline">\(p(\boldsymbol{y})\)</span> は次の積分で計算される：</p>
<div class="script-size">
<p><span class="math display">\[\begin{align*}
    p(\boldsymbol{y})&amp;=\int_\mathbb{R}p(\boldsymbol{y}|x)p(x)dx\\
    &amp;=\int_\mathbb{R}\prod_{i=1}^n p(y_i|x)p(x)dx\\
    &amp;=\frac{1}{2}\frac{1}{(2\pi)^{n+1}}\int_\mathbb{R}\exp\left(-\frac{1}{2}\sum_{i=1}^n(y_i-x)^2+x^2\right)dx\\
    &amp;\qquad+\frac{1}{2}\frac{1}{(2\pi)^n}\exp\left(-\frac{1}{2}\sum_{i=1}^n(y_i-x)^2\right)dx.
\end{align*}\]</span></p>
</div>
<p>これを実際に計算した結果は <span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala &amp; Zdeborová, 2024, p. 117</a>)</span> で与えられている．</p>
<p>ここでは，邪教のような計算を啓示するのではなく，Julia と Turing を通じて計算する方法を紹介する <span class="citation" data-cites="Storopoli2021">(<a href="#ref-Storopoli2021" role="doc-biblioref">Storopoli, 2021</a>)</span>．</p>
<div id="a0697647" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span>, <span class="bu">Distributions</span>, <span class="bu">Random</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [<span class="fl">0.99978688</span>, <span class="fl">1.7956116</span>, <span class="op">−</span><span class="fl">0.43158072</span>, <span class="fl">3.07234211</span>, <span class="fl">1.11920946</span>, <span class="fl">0.53248943</span>, <span class="fl">0.80011329</span>, <span class="op">−</span><span class="fl">0.52783428</span>, <span class="fl">0.40378413</span>, <span class="op">−</span><span class="fl">0.00223177</span>]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="bu">Random</span>.<span class="fu">seed!</span>(<span class="fl">124</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>prior <span class="op">=</span> <span class="fu">MixtureModel</span>([<span class="fu">Normal</span>(<span class="fl">0.0</span>, <span class="fl">1.0</span>), <span class="fu">Normal</span>(<span class="fl">0.0</span>, <span class="fl">0.005</span>)], [<span class="fl">0.5</span>, <span class="fl">0.5</span>])</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">mixed_normal_model</span>(data)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    μ <span class="op">~</span> prior</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(data)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        data[i] <span class="op">~</span> <span class="fu">Normal</span>(μ, <span class="fl">1</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">mixed_normal_model</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="97625afd" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(model, <span class="fu">NUTS</span>(), <span class="fl">100000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="80e32f5f" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MCMCChains</span>, <span class="bu">Plots</span>, <span class="bu">StatsPlots</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(chain[<span class="op">:</span>μ], seriestype <span class="op">=</span> <span class="op">:</span>density, xlabel <span class="op">=</span> <span class="st">"x*"</span>, ylabel <span class="op">=</span> <span class="st">"Density"</span>, title <span class="op">=</span> <span class="st">"Posterior Distribution"</span>, color <span class="op">=</span> <span class="st">"#80c4ac"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vline!</span>([<span class="fl">1</span>], color <span class="op">=</span> <span class="op">:</span>pink, linewidth <span class="op">=</span> <span class="fl">2</span>, label <span class="op">=</span> <span class="st">"x^* = 1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="576" height="384" viewbox="0 0 2304 1536">
<defs>
  <clippath id="clip140">
    <rect x="0" y="0" width="2304" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip140)" d="M0 1536 L2304 1536 L2304 8.52651e-14 L0 8.52651e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip141">
    <rect x="460" y="0" width="1614" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip140)" d="M218.906 1359.82 L2256.76 1359.82 L2256.76 123.472 L218.906 123.472  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip142">
    <rect x="218" y="123" width="2039" height="1237"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="472.611,1359.82 472.611,123.472 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="803.341,1359.82 803.341,123.472 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1134.07,1359.82 1134.07,123.472 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1464.8,1359.82 1464.8,123.472 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1795.53,1359.82 1795.53,123.472 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2126.26,1359.82 2126.26,123.472 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,1359.82 2256.76,1359.82 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="472.611,1359.82 472.611,1340.92 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="803.341,1359.82 803.341,1340.92 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1134.07,1359.82 1134.07,1340.92 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1464.8,1359.82 1464.8,1340.92 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1795.53,1359.82 1795.53,1340.92 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2126.26,1359.82 2126.26,1340.92 "></polyline>
<path clip-path="url(#clip140)" d="M419.637 1404.62 L449.313 1404.62 L449.313 1408.56 L419.637 1408.56 L419.637 1404.62 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M469.405 1389.97 Q465.794 1389.97 463.965 1393.54 Q462.16 1397.08 462.16 1404.21 Q462.16 1411.31 463.965 1414.88 Q465.794 1418.42 469.405 1418.42 Q473.039 1418.42 474.845 1414.88 Q476.674 1411.31 476.674 1404.21 Q476.674 1397.08 474.845 1393.54 Q473.039 1389.97 469.405 1389.97 M469.405 1386.27 Q475.215 1386.27 478.271 1390.87 Q481.35 1395.46 481.35 1404.21 Q481.35 1412.93 478.271 1417.54 Q475.215 1422.12 469.405 1422.12 Q463.595 1422.12 460.516 1417.54 Q457.461 1412.93 457.461 1404.21 Q457.461 1395.46 460.516 1390.87 Q463.595 1386.27 469.405 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M489.567 1415.57 L494.451 1415.57 L494.451 1421.45 L489.567 1421.45 L489.567 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M504.683 1386.89 L523.039 1386.89 L523.039 1390.83 L508.965 1390.83 L508.965 1399.3 Q509.984 1398.95 511.002 1398.79 Q512.021 1398.6 513.039 1398.6 Q518.826 1398.6 522.206 1401.78 Q525.585 1404.95 525.585 1410.36 Q525.585 1415.94 522.113 1419.04 Q518.641 1422.12 512.322 1422.12 Q510.146 1422.12 507.877 1421.75 Q505.632 1421.38 503.224 1420.64 L503.224 1415.94 Q505.308 1417.08 507.53 1417.63 Q509.752 1418.19 512.229 1418.19 Q516.234 1418.19 518.572 1416.08 Q520.909 1413.98 520.909 1410.36 Q520.909 1406.75 518.572 1404.65 Q516.234 1402.54 512.229 1402.54 Q510.354 1402.54 508.479 1402.96 Q506.627 1403.37 504.683 1404.25 L504.683 1386.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M780.725 1389.97 Q777.114 1389.97 775.285 1393.54 Q773.48 1397.08 773.48 1404.21 Q773.48 1411.31 775.285 1414.88 Q777.114 1418.42 780.725 1418.42 Q784.359 1418.42 786.165 1414.88 Q787.994 1411.31 787.994 1404.21 Q787.994 1397.08 786.165 1393.54 Q784.359 1389.97 780.725 1389.97 M780.725 1386.27 Q786.535 1386.27 789.591 1390.87 Q792.67 1395.46 792.67 1404.21 Q792.67 1412.93 789.591 1417.54 Q786.535 1422.12 780.725 1422.12 Q774.915 1422.12 771.836 1417.54 Q768.781 1412.93 768.781 1404.21 Q768.781 1395.46 771.836 1390.87 Q774.915 1386.27 780.725 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M800.887 1415.57 L805.771 1415.57 L805.771 1421.45 L800.887 1421.45 L800.887 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M825.956 1389.97 Q822.345 1389.97 820.517 1393.54 Q818.711 1397.08 818.711 1404.21 Q818.711 1411.31 820.517 1414.88 Q822.345 1418.42 825.956 1418.42 Q829.591 1418.42 831.396 1414.88 Q833.225 1411.31 833.225 1404.21 Q833.225 1397.08 831.396 1393.54 Q829.591 1389.97 825.956 1389.97 M825.956 1386.27 Q831.767 1386.27 834.822 1390.87 Q837.901 1395.46 837.901 1404.21 Q837.901 1412.93 834.822 1417.54 Q831.767 1422.12 825.956 1422.12 Q820.146 1422.12 817.068 1417.54 Q814.012 1412.93 814.012 1404.21 Q814.012 1395.46 817.068 1390.87 Q820.146 1386.27 825.956 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1111.95 1389.97 Q1108.34 1389.97 1106.51 1393.54 Q1104.71 1397.08 1104.71 1404.21 Q1104.71 1411.31 1106.51 1414.88 Q1108.34 1418.42 1111.95 1418.42 Q1115.59 1418.42 1117.39 1414.88 Q1119.22 1411.31 1119.22 1404.21 Q1119.22 1397.08 1117.39 1393.54 Q1115.59 1389.97 1111.95 1389.97 M1111.95 1386.27 Q1117.76 1386.27 1120.82 1390.87 Q1123.9 1395.46 1123.9 1404.21 Q1123.9 1412.93 1120.82 1417.54 Q1117.76 1422.12 1111.95 1422.12 Q1106.14 1422.12 1103.06 1417.54 Q1100.01 1412.93 1100.01 1404.21 Q1100.01 1395.46 1103.06 1390.87 Q1106.14 1386.27 1111.95 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1132.11 1415.57 L1137 1415.57 L1137 1421.45 L1132.11 1421.45 L1132.11 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1147.23 1386.89 L1165.59 1386.89 L1165.59 1390.83 L1151.51 1390.83 L1151.51 1399.3 Q1152.53 1398.95 1153.55 1398.79 Q1154.57 1398.6 1155.59 1398.6 Q1161.37 1398.6 1164.75 1401.78 Q1168.13 1404.95 1168.13 1410.36 Q1168.13 1415.94 1164.66 1419.04 Q1161.19 1422.12 1154.87 1422.12 Q1152.69 1422.12 1150.42 1421.75 Q1148.18 1421.38 1145.77 1420.64 L1145.77 1415.94 Q1147.86 1417.08 1150.08 1417.63 Q1152.3 1418.19 1154.78 1418.19 Q1158.78 1418.19 1161.12 1416.08 Q1163.46 1413.98 1163.46 1410.36 Q1163.46 1406.75 1161.12 1404.65 Q1158.78 1402.54 1154.78 1402.54 Q1152.9 1402.54 1151.03 1402.96 Q1149.17 1403.37 1147.23 1404.25 L1147.23 1386.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1431.95 1417.52 L1439.59 1417.52 L1439.59 1391.15 L1431.28 1392.82 L1431.28 1388.56 L1439.55 1386.89 L1444.22 1386.89 L1444.22 1417.52 L1451.86 1417.52 L1451.86 1421.45 L1431.95 1421.45 L1431.95 1417.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1461.3 1415.57 L1466.19 1415.57 L1466.19 1421.45 L1461.3 1421.45 L1461.3 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1486.37 1389.97 Q1482.76 1389.97 1480.93 1393.54 Q1479.13 1397.08 1479.13 1404.21 Q1479.13 1411.31 1480.93 1414.88 Q1482.76 1418.42 1486.37 1418.42 Q1490.01 1418.42 1491.81 1414.88 Q1493.64 1411.31 1493.64 1404.21 Q1493.64 1397.08 1491.81 1393.54 Q1490.01 1389.97 1486.37 1389.97 M1486.37 1386.27 Q1492.18 1386.27 1495.24 1390.87 Q1498.32 1395.46 1498.32 1404.21 Q1498.32 1412.93 1495.24 1417.54 Q1492.18 1422.12 1486.37 1422.12 Q1480.56 1422.12 1477.49 1417.54 Q1474.43 1412.93 1474.43 1404.21 Q1474.43 1395.46 1477.49 1390.87 Q1480.56 1386.27 1486.37 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1763.18 1417.52 L1770.82 1417.52 L1770.82 1391.15 L1762.51 1392.82 L1762.51 1388.56 L1770.77 1386.89 L1775.45 1386.89 L1775.45 1417.52 L1783.09 1417.52 L1783.09 1421.45 L1763.18 1421.45 L1763.18 1417.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1792.53 1415.57 L1797.42 1415.57 L1797.42 1421.45 L1792.53 1421.45 L1792.53 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1807.65 1386.89 L1826 1386.89 L1826 1390.83 L1811.93 1390.83 L1811.93 1399.3 Q1812.95 1398.95 1813.97 1398.79 Q1814.99 1398.6 1816 1398.6 Q1821.79 1398.6 1825.17 1401.78 Q1828.55 1404.95 1828.55 1410.36 Q1828.55 1415.94 1825.08 1419.04 Q1821.61 1422.12 1815.29 1422.12 Q1813.11 1422.12 1810.84 1421.75 Q1808.6 1421.38 1806.19 1420.64 L1806.19 1415.94 Q1808.27 1417.08 1810.49 1417.63 Q1812.72 1418.19 1815.19 1418.19 Q1819.2 1418.19 1821.54 1416.08 Q1823.87 1413.98 1823.87 1410.36 Q1823.87 1406.75 1821.54 1404.65 Q1819.2 1402.54 1815.19 1402.54 Q1813.32 1402.54 1811.44 1402.96 Q1809.59 1403.37 1807.65 1404.25 L1807.65 1386.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2097.5 1417.52 L2113.82 1417.52 L2113.82 1421.45 L2091.87 1421.45 L2091.87 1417.52 Q2094.53 1414.76 2099.12 1410.13 Q2103.72 1405.48 2104.91 1404.14 Q2107.15 1401.61 2108.03 1399.88 Q2108.93 1398.12 2108.93 1396.43 Q2108.93 1393.67 2106.99 1391.94 Q2105.07 1390.2 2101.97 1390.2 Q2099.77 1390.2 2097.31 1390.97 Q2094.88 1391.73 2092.1 1393.28 L2092.1 1388.56 Q2094.93 1387.42 2097.38 1386.85 Q2099.84 1386.27 2101.87 1386.27 Q2107.24 1386.27 2110.44 1388.95 Q2113.63 1391.64 2113.63 1396.13 Q2113.63 1398.26 2112.82 1400.18 Q2112.03 1402.08 2109.93 1404.67 Q2109.35 1405.34 2106.25 1408.56 Q2103.15 1411.75 2097.5 1417.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2123.63 1415.57 L2128.52 1415.57 L2128.52 1421.45 L2123.63 1421.45 L2123.63 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2148.7 1389.97 Q2145.09 1389.97 2143.26 1393.54 Q2141.46 1397.08 2141.46 1404.21 Q2141.46 1411.31 2143.26 1414.88 Q2145.09 1418.42 2148.7 1418.42 Q2152.34 1418.42 2154.14 1414.88 Q2155.97 1411.31 2155.97 1404.21 Q2155.97 1397.08 2154.14 1393.54 Q2152.34 1389.97 2148.7 1389.97 M2148.7 1386.27 Q2154.51 1386.27 2157.57 1390.87 Q2160.65 1395.46 2160.65 1404.21 Q2160.65 1412.93 2157.57 1417.54 Q2154.51 1422.12 2148.7 1422.12 Q2142.89 1422.12 2139.81 1417.54 Q2136.76 1412.93 2136.76 1404.21 Q2136.76 1395.46 2139.81 1390.87 Q2142.89 1386.27 2148.7 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1238.05 1467.6 L1225.16 1484.94 L1238.72 1503.24 L1231.82 1503.24 L1221.44 1489.24 L1211.06 1503.24 L1204.16 1503.24 L1218 1484.59 L1205.33 1467.6 L1212.24 1467.6 L1221.69 1480.3 L1231.15 1467.6 L1238.05 1467.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1271.51 1463.55 L1260.08 1469.73 L1271.51 1475.93 L1269.66 1479.05 L1258.97 1472.59 L1258.97 1484.59 L1255.34 1484.59 L1255.34 1472.59 L1244.64 1479.05 L1242.8 1475.93 L1254.22 1469.73 L1242.8 1463.55 L1244.64 1460.4 L1255.34 1466.86 L1255.34 1454.86 L1258.97 1454.86 L1258.97 1466.86 L1269.66 1460.4 L1271.51 1463.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,1324.83 2256.76,1324.83 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,1145.14 2256.76,1145.14 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,965.448 2256.76,965.448 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,785.757 2256.76,785.757 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,606.066 2256.76,606.066 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,426.376 2256.76,426.376 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,246.685 2256.76,246.685 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,1359.82 218.906,123.472 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,1324.83 237.804,1324.83 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,1145.14 237.804,1145.14 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,965.448 237.804,965.448 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,785.757 237.804,785.757 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,606.066 237.804,606.066 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,426.376 237.804,426.376 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,246.685 237.804,246.685 "></polyline>
<path clip-path="url(#clip140)" d="M127.171 1310.63 Q123.56 1310.63 121.731 1314.19 Q119.925 1317.73 119.925 1324.86 Q119.925 1331.97 121.731 1335.53 Q123.56 1339.08 127.171 1339.08 Q130.805 1339.08 132.61 1335.53 Q134.439 1331.97 134.439 1324.86 Q134.439 1317.73 132.61 1314.19 Q130.805 1310.63 127.171 1310.63 M127.171 1306.92 Q132.981 1306.92 136.036 1311.53 Q139.115 1316.11 139.115 1324.86 Q139.115 1333.59 136.036 1338.2 Q132.981 1342.78 127.171 1342.78 Q121.36 1342.78 118.282 1338.2 Q115.226 1333.59 115.226 1324.86 Q115.226 1316.11 118.282 1311.53 Q121.36 1306.92 127.171 1306.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M147.333 1336.23 L152.217 1336.23 L152.217 1342.11 L147.333 1342.11 L147.333 1336.23 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M172.402 1310.63 Q168.791 1310.63 166.962 1314.19 Q165.157 1317.73 165.157 1324.86 Q165.157 1331.97 166.962 1335.53 Q168.791 1339.08 172.402 1339.08 Q176.036 1339.08 177.842 1335.53 Q179.67 1331.97 179.67 1324.86 Q179.67 1317.73 177.842 1314.19 Q176.036 1310.63 172.402 1310.63 M172.402 1306.92 Q178.212 1306.92 181.268 1311.53 Q184.346 1316.11 184.346 1324.86 Q184.346 1333.59 181.268 1338.2 Q178.212 1342.78 172.402 1342.78 Q166.592 1342.78 163.513 1338.2 Q160.458 1333.59 160.458 1324.86 Q160.458 1316.11 163.513 1311.53 Q166.592 1306.92 172.402 1306.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M128.768 1130.94 Q125.157 1130.94 123.328 1134.5 Q121.523 1138.04 121.523 1145.17 Q121.523 1152.28 123.328 1155.84 Q125.157 1159.39 128.768 1159.39 Q132.402 1159.39 134.208 1155.84 Q136.036 1152.28 136.036 1145.17 Q136.036 1138.04 134.208 1134.5 Q132.402 1130.94 128.768 1130.94 M128.768 1127.23 Q134.578 1127.23 137.634 1131.84 Q140.712 1136.42 140.712 1145.17 Q140.712 1153.9 137.634 1158.51 Q134.578 1163.09 128.768 1163.09 Q122.958 1163.09 119.879 1158.51 Q116.823 1153.9 116.823 1145.17 Q116.823 1136.42 119.879 1131.84 Q122.958 1127.23 128.768 1127.23 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M148.93 1156.54 L153.814 1156.54 L153.814 1162.42 L148.93 1162.42 L148.93 1156.54 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M168.027 1158.48 L184.346 1158.48 L184.346 1162.42 L162.402 1162.42 L162.402 1158.48 Q165.064 1155.73 169.647 1151.1 Q174.254 1146.45 175.434 1145.1 Q177.68 1142.58 178.559 1140.84 Q179.462 1139.09 179.462 1137.4 Q179.462 1134.64 177.518 1132.9 Q175.596 1131.17 172.494 1131.17 Q170.295 1131.17 167.842 1131.93 Q165.411 1132.7 162.633 1134.25 L162.633 1129.52 Q165.457 1128.39 167.911 1127.81 Q170.365 1127.23 172.402 1127.23 Q177.772 1127.23 180.967 1129.92 Q184.161 1132.6 184.161 1137.09 Q184.161 1139.22 183.351 1141.15 Q182.564 1143.04 180.457 1145.64 Q179.879 1146.31 176.777 1149.52 Q173.675 1152.72 168.027 1158.48 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M126.685 951.246 Q123.073 951.246 121.245 954.811 Q119.439 958.353 119.439 965.482 Q119.439 972.589 121.245 976.154 Q123.073 979.695 126.685 979.695 Q130.319 979.695 132.124 976.154 Q133.953 972.589 133.953 965.482 Q133.953 958.353 132.124 954.811 Q130.319 951.246 126.685 951.246 M126.685 947.543 Q132.495 947.543 135.55 952.149 Q138.629 956.732 138.629 965.482 Q138.629 974.209 135.55 978.816 Q132.495 983.399 126.685 983.399 Q120.874 983.399 117.796 978.816 Q114.74 974.209 114.74 965.482 Q114.74 956.732 117.796 952.149 Q120.874 947.543 126.685 947.543 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M146.846 976.848 L151.731 976.848 L151.731 982.728 L146.846 982.728 L146.846 976.848 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M174.763 952.242 L162.957 970.691 L174.763 970.691 L174.763 952.242 M173.536 948.168 L179.416 948.168 L179.416 970.691 L184.346 970.691 L184.346 974.579 L179.416 974.579 L179.416 982.728 L174.763 982.728 L174.763 974.579 L159.161 974.579 L159.161 970.066 L173.536 948.168 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M127.009 771.556 Q123.398 771.556 121.569 775.12 Q119.763 778.662 119.763 785.792 Q119.763 792.898 121.569 796.463 Q123.398 800.005 127.009 800.005 Q130.643 800.005 132.448 796.463 Q134.277 792.898 134.277 785.792 Q134.277 778.662 132.448 775.12 Q130.643 771.556 127.009 771.556 M127.009 767.852 Q132.819 767.852 135.874 772.458 Q138.953 777.042 138.953 785.792 Q138.953 794.518 135.874 799.125 Q132.819 803.708 127.009 803.708 Q121.198 803.708 118.12 799.125 Q115.064 794.518 115.064 785.792 Q115.064 777.042 118.12 772.458 Q121.198 767.852 127.009 767.852 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M147.171 797.157 L152.055 797.157 L152.055 803.037 L147.171 803.037 L147.171 797.157 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M172.819 783.893 Q169.67 783.893 167.819 786.046 Q165.99 788.199 165.99 791.949 Q165.99 795.676 167.819 797.852 Q169.67 800.005 172.819 800.005 Q175.967 800.005 177.795 797.852 Q179.647 795.676 179.647 791.949 Q179.647 788.199 177.795 786.046 Q175.967 783.893 172.819 783.893 M182.101 769.241 L182.101 773.5 Q180.342 772.667 178.536 772.227 Q176.754 771.787 174.994 771.787 Q170.365 771.787 167.911 774.912 Q165.481 778.037 165.133 784.356 Q166.499 782.343 168.559 781.278 Q170.619 780.19 173.096 780.19 Q178.305 780.19 181.314 783.361 Q184.346 786.509 184.346 791.949 Q184.346 797.273 181.198 800.491 Q178.05 803.708 172.819 803.708 Q166.823 803.708 163.652 799.125 Q160.481 794.518 160.481 785.792 Q160.481 777.597 164.37 772.736 Q168.258 767.852 174.809 767.852 Q176.569 767.852 178.351 768.199 Q180.156 768.546 182.101 769.241 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M127.263 591.865 Q123.652 591.865 121.823 595.43 Q120.018 598.971 120.018 606.101 Q120.018 613.207 121.823 616.772 Q123.652 620.314 127.263 620.314 Q130.897 620.314 132.703 616.772 Q134.532 613.207 134.532 606.101 Q134.532 598.971 132.703 595.43 Q130.897 591.865 127.263 591.865 M127.263 588.161 Q133.073 588.161 136.129 592.768 Q139.208 597.351 139.208 606.101 Q139.208 614.828 136.129 619.434 Q133.073 624.018 127.263 624.018 Q121.453 624.018 118.374 619.434 Q115.319 614.828 115.319 606.101 Q115.319 597.351 118.374 592.768 Q121.453 588.161 127.263 588.161 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M147.425 617.467 L152.309 617.467 L152.309 623.346 L147.425 623.346 L147.425 617.467 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M172.494 606.934 Q169.161 606.934 167.24 608.717 Q165.342 610.499 165.342 613.624 Q165.342 616.749 167.24 618.531 Q169.161 620.314 172.494 620.314 Q175.828 620.314 177.749 618.531 Q179.67 616.726 179.67 613.624 Q179.67 610.499 177.749 608.717 Q175.851 606.934 172.494 606.934 M167.819 604.944 Q164.809 604.203 163.12 602.143 Q161.453 600.082 161.453 597.12 Q161.453 592.976 164.393 590.569 Q167.356 588.161 172.494 588.161 Q177.656 588.161 180.596 590.569 Q183.536 592.976 183.536 597.12 Q183.536 600.082 181.846 602.143 Q180.18 604.203 177.194 604.944 Q180.573 605.731 182.448 608.022 Q184.346 610.314 184.346 613.624 Q184.346 618.647 181.268 621.332 Q178.212 624.018 172.494 624.018 Q166.777 624.018 163.698 621.332 Q160.643 618.647 160.643 613.624 Q160.643 610.314 162.541 608.022 Q164.439 605.731 167.819 604.944 M166.106 597.559 Q166.106 600.244 167.772 601.749 Q169.462 603.254 172.494 603.254 Q175.504 603.254 177.194 601.749 Q178.906 600.244 178.906 597.559 Q178.906 594.874 177.194 593.37 Q175.504 591.865 172.494 591.865 Q169.462 591.865 167.772 593.37 Q166.106 594.874 166.106 597.559 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M117.981 439.72 L125.62 439.72 L125.62 413.355 L117.31 415.021 L117.31 410.762 L125.573 409.096 L130.249 409.096 L130.249 439.72 L137.888 439.72 L137.888 443.656 L117.981 443.656 L117.981 439.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M147.333 437.776 L152.217 437.776 L152.217 443.656 L147.333 443.656 L147.333 437.776 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M172.402 412.174 Q168.791 412.174 166.962 415.739 Q165.157 419.281 165.157 426.41 Q165.157 433.517 166.962 437.082 Q168.791 440.623 172.402 440.623 Q176.036 440.623 177.842 437.082 Q179.67 433.517 179.67 426.41 Q179.67 419.281 177.842 415.739 Q176.036 412.174 172.402 412.174 M172.402 408.471 Q178.212 408.471 181.268 413.077 Q184.346 417.66 184.346 426.41 Q184.346 435.137 181.268 439.744 Q178.212 444.327 172.402 444.327 Q166.592 444.327 163.513 439.744 Q160.458 435.137 160.458 426.41 Q160.458 417.66 163.513 413.077 Q166.592 408.471 172.402 408.471 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M119.578 260.03 L127.217 260.03 L127.217 233.664 L118.907 235.331 L118.907 231.072 L127.171 229.405 L131.847 229.405 L131.847 260.03 L139.485 260.03 L139.485 263.965 L119.578 263.965 L119.578 260.03 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M148.93 258.085 L153.814 258.085 L153.814 263.965 L148.93 263.965 L148.93 258.085 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M168.027 260.03 L184.346 260.03 L184.346 263.965 L162.402 263.965 L162.402 260.03 Q165.064 257.275 169.647 252.645 Q174.254 247.993 175.434 246.65 Q177.68 244.127 178.559 242.391 Q179.462 240.632 179.462 238.942 Q179.462 236.187 177.518 234.451 Q175.596 232.715 172.494 232.715 Q170.295 232.715 167.842 233.479 Q165.411 234.243 162.633 235.794 L162.633 231.072 Q165.457 229.937 167.911 229.359 Q170.365 228.78 172.402 228.78 Q177.772 228.78 180.967 231.465 Q184.161 234.15 184.161 238.641 Q184.161 240.771 183.351 242.692 Q182.564 244.59 180.457 247.183 Q179.879 247.854 176.777 251.071 Q173.675 254.266 168.027 260.03 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M23.6877 854.956 L60.6406 854.956 L60.6406 847.189 Q60.6406 837.354 56.1846 832.803 Q51.7286 828.22 42.1164 828.22 Q32.5679 828.22 28.1437 832.803 Q23.6877 837.354 23.6877 847.189 L23.6877 854.956 M18.4042 861.385 L18.4042 848.176 Q18.4042 834.363 24.1651 827.901 Q29.8943 821.44 42.1164 821.44 Q54.4022 821.44 60.1632 827.933 Q65.9242 834.426 65.9242 848.176 L65.9242 861.385 L18.4042 861.385 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M46.6361 780.954 L49.5006 780.954 L49.5006 807.881 Q55.5481 807.499 58.7309 804.253 Q61.8819 800.974 61.8819 795.15 Q61.8819 791.776 61.0544 788.625 Q60.2269 785.442 58.5718 782.323 L64.1099 782.323 Q65.4467 785.474 66.147 788.784 Q66.8472 792.094 66.8472 795.5 Q66.8472 804.03 61.8819 809.027 Q56.9167 813.992 48.4503 813.992 Q39.6974 813.992 34.5731 809.282 Q29.4168 804.539 29.4168 796.518 Q29.4168 789.325 34.0638 785.156 Q38.6789 780.954 46.6361 780.954 M44.9173 786.811 Q40.1112 786.874 37.2466 789.516 Q34.3821 792.126 34.3821 796.455 Q34.3821 801.356 37.1512 804.316 Q39.9202 807.245 44.9492 807.69 L44.9173 786.811 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M44.4081 741.71 L65.9242 741.71 L65.9242 747.566 L44.599 747.566 Q39.5383 747.566 37.0238 749.539 Q34.5094 751.513 34.5094 755.46 Q34.5094 760.202 37.5331 762.939 Q40.5568 765.677 45.7767 765.677 L65.9242 765.677 L65.9242 771.565 L30.2762 771.565 L30.2762 765.677 L35.8144 765.677 Q32.5997 763.576 31.0083 760.743 Q29.4168 757.879 29.4168 754.155 Q29.4168 748.012 33.2363 744.861 Q37.0238 741.71 44.4081 741.71 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M31.3265 707.303 L36.8647 707.303 Q35.5916 709.786 34.955 712.459 Q34.3184 715.133 34.3184 717.997 Q34.3184 722.358 35.6552 724.554 Q36.992 726.718 39.6656 726.718 Q41.7026 726.718 42.8803 725.159 Q44.0261 723.599 45.0765 718.889 L45.5221 716.883 Q46.8589 710.645 49.3097 708.035 Q51.7286 705.393 56.0891 705.393 Q61.0544 705.393 63.9508 709.34 Q66.8472 713.255 66.8472 720.13 Q66.8472 722.994 66.2743 726.114 Q65.7332 729.201 64.6192 732.639 L58.5718 732.639 Q60.2587 729.392 61.118 726.241 Q61.9456 723.09 61.9456 720.003 Q61.9456 715.865 60.5451 713.637 Q59.1129 711.409 56.5347 711.409 Q54.1476 711.409 52.8745 713.032 Q51.6013 714.624 50.4237 720.066 L49.9462 722.103 Q48.8004 727.546 46.4451 729.965 Q44.058 732.384 39.9202 732.384 Q34.8913 732.384 32.1541 728.819 Q29.4168 725.254 29.4168 718.698 Q29.4168 715.451 29.8943 712.587 Q30.3717 709.722 31.3265 707.303 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M30.2762 696.068 L30.2762 690.211 L65.9242 690.211 L65.9242 696.068 L30.2762 696.068 M16.399 696.068 L16.399 690.211 L23.815 690.211 L23.815 696.068 L16.399 696.068 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M20.1547 672.164 L30.2762 672.164 L30.2762 660.101 L34.8277 660.101 L34.8277 672.164 L54.1794 672.164 Q58.5399 672.164 59.7813 670.987 Q61.0226 669.777 61.0226 666.117 L61.0226 660.101 L65.9242 660.101 L65.9242 666.117 Q65.9242 672.896 63.4097 675.474 Q60.8634 678.053 54.1794 678.053 L34.8277 678.053 L34.8277 682.349 L30.2762 682.349 L30.2762 678.053 L20.1547 678.053 L20.1547 672.164 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M69.2343 637.567 Q75.6 640.049 77.5416 642.405 Q79.4831 644.76 79.4831 648.707 L79.4831 653.385 L74.5815 653.385 L74.5815 649.948 Q74.5815 647.529 73.4357 646.192 Q72.2899 644.855 68.0248 643.232 L65.3512 642.182 L30.2762 656.6 L30.2762 650.394 L58.158 639.254 L30.2762 628.114 L30.2762 621.907 L69.2343 637.567 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M815.099 18.8205 L815.099 41.5461 L825.388 41.5461 Q831.1 41.5461 834.219 38.5889 Q837.338 35.6318 837.338 30.163 Q837.338 24.7348 834.219 21.7777 Q831.1 18.8205 825.388 18.8205 L815.099 18.8205 M806.916 12.096 L825.388 12.096 Q835.556 12.096 840.741 16.714 Q845.967 21.2916 845.967 30.163 Q845.967 39.1155 840.741 43.6931 Q835.556 48.2706 825.388 48.2706 L815.099 48.2706 L815.099 72.576 L806.916 72.576 L806.916 12.096 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M871.245 32.4315 Q865.249 32.4315 861.765 37.1306 Q858.282 41.7891 858.282 49.9314 Q858.282 58.0738 861.725 62.7728 Q865.209 67.4314 871.245 67.4314 Q877.199 67.4314 880.683 62.7323 Q884.167 58.0333 884.167 49.9314 Q884.167 41.8701 880.683 37.1711 Q877.199 32.4315 871.245 32.4315 M871.245 26.1121 Q880.967 26.1121 886.516 32.4315 Q892.066 38.7509 892.066 49.9314 Q892.066 61.0714 886.516 67.4314 Q880.967 73.7508 871.245 73.7508 Q861.482 73.7508 855.932 67.4314 Q850.423 61.0714 850.423 49.9314 Q850.423 38.7509 855.932 32.4315 Q861.482 26.1121 871.245 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M933.345 28.5427 L933.345 35.5912 Q930.185 33.9709 926.782 33.1607 Q923.38 32.3505 919.734 32.3505 Q914.184 32.3505 911.389 34.0519 Q908.634 35.7533 908.634 39.156 Q908.634 41.7486 910.619 43.2475 Q912.604 44.7058 918.6 46.0426 L921.152 46.6097 Q929.091 48.3111 932.413 51.4303 Q935.775 54.509 935.775 60.0587 Q935.775 66.3781 930.752 70.0644 Q925.77 73.7508 917.02 73.7508 Q913.374 73.7508 909.404 73.0216 Q905.475 72.3329 901.1 70.9151 L901.1 63.2184 Q905.232 65.3654 909.242 66.4591 Q913.252 67.5124 917.182 67.5124 Q922.448 67.5124 925.284 65.73 Q928.119 63.9071 928.119 60.6258 Q928.119 57.5877 926.053 55.9673 Q924.028 54.3469 917.101 52.8481 L914.508 52.2405 Q907.581 50.7821 904.502 47.7845 Q901.424 44.7463 901.424 39.4801 Q901.424 33.0797 905.961 29.5959 Q910.498 26.1121 918.843 26.1121 Q922.975 26.1121 926.62 26.7198 Q930.266 27.3274 933.345 28.5427 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M955.017 14.324 L955.017 27.2059 L970.37 27.2059 L970.37 32.9987 L955.017 32.9987 L955.017 57.6282 Q955.017 63.1779 956.516 64.7578 Q958.055 66.3376 962.714 66.3376 L970.37 66.3376 L970.37 72.576 L962.714 72.576 Q954.085 72.576 950.804 69.3758 Q947.523 66.1351 947.523 57.6282 L947.523 32.9987 L942.054 32.9987 L942.054 27.2059 L947.523 27.2059 L947.523 14.324 L955.017 14.324 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1018.98 48.0275 L1018.98 51.6733 L984.71 51.6733 Q985.196 59.3701 989.328 63.421 Q993.501 67.4314 1000.91 67.4314 Q1005.21 67.4314 1009.22 66.3781 Q1013.27 65.3249 1017.24 63.2184 L1017.24 70.267 Q1013.23 71.9684 1009.02 72.8596 Q1004.8 73.7508 1000.47 73.7508 Q989.612 73.7508 983.252 67.4314 Q976.933 61.1119 976.933 50.3365 Q976.933 39.1965 982.928 32.6746 Q988.964 26.1121 999.172 26.1121 Q1008.33 26.1121 1013.63 32.0264 Q1018.98 37.9003 1018.98 48.0275 M1011.53 45.84 Q1011.45 39.7232 1008.08 36.0774 Q1004.76 32.4315 999.253 32.4315 Q993.015 32.4315 989.247 35.9558 Q985.521 39.4801 984.953 45.8805 L1011.53 45.84 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1057.51 34.1734 Q1056.25 33.4443 1054.75 33.1202 Q1053.29 32.7556 1051.51 32.7556 Q1045.19 32.7556 1041.79 36.8875 Q1038.43 40.9789 1038.43 48.6757 L1038.43 72.576 L1030.93 72.576 L1030.93 27.2059 L1038.43 27.2059 L1038.43 34.2544 Q1040.77 30.1225 1044.54 28.1376 Q1048.31 26.1121 1053.7 26.1121 Q1054.47 26.1121 1055.4 26.2337 Q1056.33 26.3147 1057.46 26.5172 L1057.51 34.1734 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1065.32 27.2059 L1072.78 27.2059 L1072.78 72.576 L1065.32 72.576 L1065.32 27.2059 M1065.32 9.54393 L1072.78 9.54393 L1072.78 18.9825 L1065.32 18.9825 L1065.32 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1105.95 32.4315 Q1099.96 32.4315 1096.47 37.1306 Q1092.99 41.7891 1092.99 49.9314 Q1092.99 58.0738 1096.43 62.7728 Q1099.92 67.4314 1105.95 67.4314 Q1111.91 67.4314 1115.39 62.7323 Q1118.88 58.0333 1118.88 49.9314 Q1118.88 41.8701 1115.39 37.1711 Q1111.91 32.4315 1105.95 32.4315 M1105.95 26.1121 Q1115.68 26.1121 1121.23 32.4315 Q1126.78 38.7509 1126.78 49.9314 Q1126.78 61.0714 1121.23 67.4314 Q1115.68 73.7508 1105.95 73.7508 Q1096.19 73.7508 1090.64 67.4314 Q1085.13 61.0714 1085.13 49.9314 Q1085.13 38.7509 1090.64 32.4315 Q1096.19 26.1121 1105.95 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1165.42 34.1734 Q1164.17 33.4443 1162.67 33.1202 Q1161.21 32.7556 1159.43 32.7556 Q1153.11 32.7556 1149.7 36.8875 Q1146.34 40.9789 1146.34 48.6757 L1146.34 72.576 L1138.85 72.576 L1138.85 27.2059 L1146.34 27.2059 L1146.34 34.2544 Q1148.69 30.1225 1152.46 28.1376 Q1156.23 26.1121 1161.61 26.1121 Q1162.38 26.1121 1163.31 26.2337 Q1164.25 26.3147 1165.38 26.5172 L1165.42 34.1734 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1208.12 18.8205 L1208.12 65.8515 L1218 65.8515 Q1230.52 65.8515 1236.31 60.1802 Q1242.15 54.509 1242.15 42.2752 Q1242.15 30.1225 1236.31 24.4918 Q1230.52 18.8205 1218 18.8205 L1208.12 18.8205 M1199.93 12.096 L1216.75 12.096 Q1234.33 12.096 1242.55 19.4281 Q1250.77 26.7198 1250.77 42.2752 Q1250.77 57.9117 1242.51 65.2439 Q1234.25 72.576 1216.75 72.576 L1199.93 72.576 L1199.93 12.096 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1263.49 27.2059 L1270.95 27.2059 L1270.95 72.576 L1263.49 72.576 L1263.49 27.2059 M1263.49 9.54393 L1270.95 9.54393 L1270.95 18.9825 L1263.49 18.9825 L1263.49 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1315.47 28.5427 L1315.47 35.5912 Q1312.31 33.9709 1308.9 33.1607 Q1305.5 32.3505 1301.86 32.3505 Q1296.31 32.3505 1293.51 34.0519 Q1290.76 35.7533 1290.76 39.156 Q1290.76 41.7486 1292.74 43.2475 Q1294.73 44.7058 1300.72 46.0426 L1303.27 46.6097 Q1311.21 48.3111 1314.53 51.4303 Q1317.9 54.509 1317.9 60.0587 Q1317.9 66.3781 1312.87 70.0644 Q1307.89 73.7508 1299.14 73.7508 Q1295.5 73.7508 1291.53 73.0216 Q1287.6 72.3329 1283.22 70.9151 L1283.22 63.2184 Q1287.35 65.3654 1291.36 66.4591 Q1295.37 67.5124 1299.3 67.5124 Q1304.57 67.5124 1307.41 65.73 Q1310.24 63.9071 1310.24 60.6258 Q1310.24 57.5877 1308.18 55.9673 Q1306.15 54.3469 1299.22 52.8481 L1296.63 52.2405 Q1289.7 50.7821 1286.62 47.7845 Q1283.55 44.7463 1283.55 39.4801 Q1283.55 33.0797 1288.08 29.5959 Q1292.62 26.1121 1300.96 26.1121 Q1305.1 26.1121 1308.74 26.7198 Q1312.39 27.3274 1315.47 28.5427 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1337.14 14.324 L1337.14 27.2059 L1352.49 27.2059 L1352.49 32.9987 L1337.14 32.9987 L1337.14 57.6282 Q1337.14 63.1779 1338.64 64.7578 Q1340.18 66.3376 1344.84 66.3376 L1352.49 66.3376 L1352.49 72.576 L1344.84 72.576 Q1336.21 72.576 1332.93 69.3758 Q1329.64 66.1351 1329.64 57.6282 L1329.64 32.9987 L1324.18 32.9987 L1324.18 27.2059 L1329.64 27.2059 L1329.64 14.324 L1337.14 14.324 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1388.59 34.1734 Q1387.33 33.4443 1385.83 33.1202 Q1384.37 32.7556 1382.59 32.7556 Q1376.27 32.7556 1372.87 36.8875 Q1369.51 40.9789 1369.51 48.6757 L1369.51 72.576 L1362.01 72.576 L1362.01 27.2059 L1369.51 27.2059 L1369.51 34.2544 Q1371.86 30.1225 1375.62 28.1376 Q1379.39 26.1121 1384.78 26.1121 Q1385.55 26.1121 1386.48 26.2337 Q1387.41 26.3147 1388.54 26.5172 L1388.59 34.1734 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1396.4 27.2059 L1403.86 27.2059 L1403.86 72.576 L1396.4 72.576 L1396.4 27.2059 M1396.4 9.54393 L1403.86 9.54393 L1403.86 18.9825 L1396.4 18.9825 L1396.4 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1452.02 49.9314 Q1452.02 41.7081 1448.62 37.0496 Q1445.26 32.3505 1439.34 32.3505 Q1433.43 32.3505 1430.03 37.0496 Q1426.66 41.7081 1426.66 49.9314 Q1426.66 58.1548 1430.03 62.8538 Q1433.43 67.5124 1439.34 67.5124 Q1445.26 67.5124 1448.62 62.8538 Q1452.02 58.1548 1452.02 49.9314 M1426.66 34.0924 Q1429.01 30.0415 1432.58 28.0971 Q1436.18 26.1121 1441.17 26.1121 Q1449.43 26.1121 1454.57 32.6746 Q1459.76 39.2371 1459.76 49.9314 Q1459.76 60.6258 1454.57 67.1883 Q1449.43 73.7508 1441.17 73.7508 Q1436.18 73.7508 1432.58 71.8063 Q1429.01 69.8214 1426.66 65.7705 L1426.66 72.576 L1419.17 72.576 L1419.17 9.54393 L1426.66 9.54393 L1426.66 34.0924 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1471.35 54.671 L1471.35 27.2059 L1478.8 27.2059 L1478.8 54.3874 Q1478.8 60.8284 1481.31 64.0691 Q1483.82 67.2693 1488.85 67.2693 Q1494.88 67.2693 1498.36 63.421 Q1501.89 59.5726 1501.89 52.9291 L1501.89 27.2059 L1509.34 27.2059 L1509.34 72.576 L1501.89 72.576 L1501.89 65.6084 Q1499.18 69.7404 1495.57 71.7658 Q1492.01 73.7508 1487.27 73.7508 Q1479.45 73.7508 1475.4 68.8897 Q1471.35 64.0286 1471.35 54.671 M1490.1 26.1121 L1490.1 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1532.07 14.324 L1532.07 27.2059 L1547.42 27.2059 L1547.42 32.9987 L1532.07 32.9987 L1532.07 57.6282 Q1532.07 63.1779 1533.57 64.7578 Q1535.11 66.3376 1539.77 66.3376 L1547.42 66.3376 L1547.42 72.576 L1539.77 72.576 Q1531.14 72.576 1527.86 69.3758 Q1524.57 66.1351 1524.57 57.6282 L1524.57 32.9987 L1519.11 32.9987 L1519.11 27.2059 L1524.57 27.2059 L1524.57 14.324 L1532.07 14.324 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1557.22 27.2059 L1564.68 27.2059 L1564.68 72.576 L1557.22 72.576 L1557.22 27.2059 M1557.22 9.54393 L1564.68 9.54393 L1564.68 18.9825 L1557.22 18.9825 L1557.22 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1597.86 32.4315 Q1591.86 32.4315 1588.38 37.1306 Q1584.89 41.7891 1584.89 49.9314 Q1584.89 58.0738 1588.34 62.7728 Q1591.82 67.4314 1597.86 67.4314 Q1603.81 67.4314 1607.29 62.7323 Q1610.78 58.0333 1610.78 49.9314 Q1610.78 41.8701 1607.29 37.1711 Q1603.81 32.4315 1597.86 32.4315 M1597.86 26.1121 Q1607.58 26.1121 1613.13 32.4315 Q1618.68 38.7509 1618.68 49.9314 Q1618.68 61.0714 1613.13 67.4314 Q1607.58 73.7508 1597.86 73.7508 Q1588.09 73.7508 1582.54 67.4314 Q1577.03 61.0714 1577.03 49.9314 Q1577.03 38.7509 1582.54 32.4315 Q1588.09 26.1121 1597.86 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1668.75 45.1919 L1668.75 72.576 L1661.29 72.576 L1661.29 45.4349 Q1661.29 38.994 1658.78 35.7938 Q1656.27 32.5936 1651.25 32.5936 Q1645.21 32.5936 1641.73 36.4419 Q1638.24 40.2903 1638.24 46.9338 L1638.24 72.576 L1630.75 72.576 L1630.75 27.2059 L1638.24 27.2059 L1638.24 34.2544 Q1640.92 30.163 1644.52 28.1376 Q1648.17 26.1121 1652.91 26.1121 Q1660.73 26.1121 1664.74 30.9732 Q1668.75 35.7938 1668.75 45.1919 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip142)" style="stroke:#80c4ac; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="276.581,1324.83 286.242,1324.83 295.903,1324.83 305.564,1324.82 315.224,1324.81 324.885,1324.78 334.546,1324.74 344.207,1324.71 353.868,1324.71 363.528,1324.73 373.189,1324.77 382.85,1324.79 392.511,1324.8 402.172,1324.79 411.832,1324.75 421.493,1324.71 431.154,1324.68 440.815,1324.64 450.476,1324.58 460.136,1324.45 469.797,1324.27 479.458,1324.11 489.119,1324.01 498.78,1324.01 508.441,1324.05 518.101,1324.07 527.762,1324.03 537.423,1323.89 547.084,1323.6 556.745,1323.14 566.405,1322.59 576.066,1322.02 585.727,1321.51 595.388,1321.03 605.049,1320.45 614.709,1319.63 624.37,1318.48 634.031,1317.07 643.692,1315.56 653.353,1314.06 663.013,1312.53 672.674,1310.83 682.335,1308.89 691.996,1306.84 701.657,1304.78 711.317,1302.45 720.978,1299.37 730.639,1295.12 740.3,1289.31 749.961,1279.97 759.621,1260.92 769.282,1221.22 778.943,1153.02 788.604,1067.76 798.265,1001.78 807.925,991.448 817.586,1037.67 827.247,1104.58 836.908,1154.62 846.569,1175.56 856.229,1175.7 865.89,1166.56 875.551,1154.18 885.212,1139.99 894.873,1123.78 904.533,1105.45 914.194,1085.2 923.855,1063.14 933.516,1039.51 943.177,1015.12 952.837,991.027 962.498,967.296 972.159,942.629 981.82,915.444 991.481,885.141 1001.14,852.134 1010.8,817.152 1020.46,781.048 1030.12,745.23 1039.78,711.617 1049.45,681.503 1059.11,654.383 1068.77,628.118 1078.43,600.213 1088.09,568.996 1097.75,534.356 1107.41,497.994 1117.07,462.593 1126.73,430.282 1136.39,401.683 1146.05,375.827 1155.71,350.622 1165.38,324.007 1175.04,295.651 1184.7,267.746 1194.36,243.501 1204.02,224.503 1213.68,209.663 1223.34,196.587 1233,183.729 1242.66,171.66 1252.32,162.574 1261.98,158.463 1271.64,160.01 1281.3,167.031 1290.97,178.36 1300.63,190.791 1310.29,200.5 1319.95,207.109 1329.61,214.814 1339.27,228.13 1348.93,247.692 1358.59,270.94 1368.25,295.435 1377.91,320.402 1387.57,345.945 1397.23,372.198 1406.9,399.625 1416.56,429.308 1426.22,461.909 1435.88,496.701 1445.54,532.346 1455.2,568.095 1464.86,603.774 1474.52,639.295 1484.18,674.493 1493.84,708.863 1503.5,741.405 1513.16,771.374 1522.82,799.382 1532.49,827.455 1542.15,857.801 1551.81,891.138 1561.47,925.83 1571.13,958.677 1580.79,986.938 1590.45,1010.01 1600.11,1029.52 1609.77,1047.99 1619.43,1067.26 1629.09,1087.94 1638.75,1109.43 1648.42,1130.55 1658.08,1150.19 1667.74,1167.85 1677.4,1183.61 1687.06,1197.77 1696.72,1210.65 1706.38,1222.38 1716.04,1232.86 1725.7,1242.1 1735.36,1250.47 1745.02,1258.35 1754.68,1265.71 1764.34,1272.32 1774.01,1278.23 1783.67,1283.72 1793.33,1288.84 1802.99,1293.4 1812.65,1297.24 1822.31,1300.46 1831.97,1303.26 1841.63,1305.68 1851.29,1307.7 1860.95,1309.35 1870.61,1310.76 1880.27,1312.1 1889.94,1313.42 1899.6,1314.68 1909.26,1315.87 1918.92,1316.99 1928.58,1318.09 1938.24,1319.18 1947.9,1320.22 1957.56,1321.09 1967.22,1321.73 1976.88,1322.17 1986.54,1322.55 1996.2,1322.91 2005.86,1323.22 2015.53,1323.46 2025.19,1323.65 2034.85,1323.84 2044.51,1324.07 2054.17,1324.29 2063.83,1324.46 2073.49,1324.58 2083.15,1324.64 2092.81,1324.66 2102.47,1324.64 2112.13,1324.6 2121.79,1324.58 2131.46,1324.61 2141.12,1324.68 2150.78,1324.75 2160.44,1324.8 2170.1,1324.82 2179.76,1324.83 2189.42,1324.83 2199.08,1324.83 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#ffc0cb; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1464.8,2596.17 1464.8,-1112.88 "></polyline>
<path clip-path="url(#clip140)" d="M1799.28 320.204 L2188.83 320.204 L2188.83 164.684 L1799.28 164.684  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1799.28,320.204 2188.83,320.204 2188.83,164.684 1799.28,164.684 1799.28,320.204 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#80c4ac; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1821.92,216.524 1957.78,216.524 "></polyline>
<path clip-path="url(#clip140)" d="M1994.26 236.211 Q1992.46 240.841 1990.75 242.253 Q1989.03 243.665 1986.16 243.665 L1982.76 243.665 L1982.76 240.1 L1985.26 240.1 Q1987.02 240.1 1987.99 239.267 Q1988.96 238.433 1990.14 235.331 L1990.91 233.387 L1980.42 207.878 L1984.94 207.878 L1993.04 228.156 L2001.14 207.878 L2005.65 207.878 L1994.26 236.211 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2012.94 229.869 L2020.58 229.869 L2020.58 203.503 L2012.27 205.17 L2012.27 200.91 L2020.54 199.244 L2025.21 199.244 L2025.21 229.869 L2032.85 229.869 L2032.85 233.804 L2012.94 233.804 L2012.94 229.869 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip140)" style="stroke:#ffc0cb; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1821.92,268.364 1957.78,268.364 "></polyline>
<path clip-path="url(#clip140)" d="M2005.07 259.718 L1995.7 272.334 L2005.56 285.644 L2000.54 285.644 L1992.99 275.459 L1985.45 285.644 L1980.42 285.644 L1990.49 272.079 L1981.28 259.718 L1986.3 259.718 L1993.18 268.954 L2000.05 259.718 L2005.07 259.718 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2029.24 251.084 L2041.81 263.977 L2037.16 263.977 L2026.97 254.834 L2016.79 263.977 L2012.13 263.977 L2024.7 251.084 L2029.24 251.084 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2069.13 256.778 L2060.82 261.269 L2069.13 265.783 L2067.78 268.051 L2060 263.352 L2060 272.079 L2057.37 272.079 L2057.37 263.352 L2049.59 268.051 L2048.25 265.783 L2056.56 261.269 L2048.25 256.778 L2049.59 254.486 L2057.37 259.186 L2057.37 250.459 L2060 250.459 L2060 259.186 L2067.78 254.486 L2069.13 256.778 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2090.63 264.116 L2120.31 264.116 L2120.31 268.005 L2090.63 268.005 L2090.63 264.116 M2090.63 273.56 L2120.31 273.56 L2120.31 277.496 L2090.63 277.496 L2090.63 273.56 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2146.28 281.709 L2153.92 281.709 L2153.92 255.343 L2145.61 257.01 L2145.61 252.75 L2153.87 251.084 L2158.55 251.084 L2158.55 281.709 L2166.18 281.709 L2166.18 285.644 L2146.28 285.644 L2146.28 281.709 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="注（$x^*=0$ でのアトムについて）">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
注（<span class="math inline">\(x^*=0\)</span> でのアトムについて）
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math inline">\(x^*=0\)</span> に原子が存在する．</p>
<p>ここでは密度関数は滑らかに見えるが，実際には <span class="math inline">\(x^*=0\)</span> で不連続である．</p>
<p>これは，計算の都合上，<span class="math inline">\(\delta_0\)</span> を <span class="math inline">\(\mathrm{N}(0,0.005)\)</span> で代用したためである．</p>
</div>
</div>
</div>
</section>
<section id="map-推定量" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="map-推定量"><span class="header-section-number">1.3</span> MAP 推定量</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定義 (maximum a posterior estimator)">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定義 (maximum a posterior estimator)
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[
\widehat{x}:=\mathop{\mathrm{arg\,max}}_{x\in\mathbb{R}}p(x|y_1,\cdots,y_n)
\]</span> で定まる推定量 <span class="math inline">\(\mathbb{R}^n\to\mathbb{R}\)</span> を <strong>MAP 推定量</strong> という．</p>
</div>
</div>
<p>例 <a href="#sec-example" class="quarto-xref">1.2</a> などをはじめ，ほとんどの場面では良い推定量を与え，多くの場合の最初のチョイスとして適しているかもしれない．</p>
<p>しかし，例 <a href="#sec-example" class="quarto-xref">1.2</a> をさらに変形することで，次のような事後分布が得られる状況は容易に想像がつく：</p>
<div id="cell-fig-1" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">f</span>(x)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">-</span><span class="fl">1.8</span> <span class="op">&lt;</span> x <span class="op">&lt;</span> <span class="op">-</span><span class="fl">1.6</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">2.5</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elseif</span> <span class="fl">0</span> <span class="op">&lt;</span> x <span class="op">&lt;</span> <span class="fl">1.5</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">1</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">0</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, size<span class="op">=</span>(<span class="fl">600</span>, <span class="fl">400</span>), legend<span class="op">=</span><span class="cn">false</span>, color<span class="op">=</span><span class="st">"#80c4ac"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-1" class="cell-output cell-output-display quarto-figure quarto-figure-center quarto-float anchored" data-execution_count="7">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewbox="0 0 2400 1600">
<defs>
  <clippath id="clip270">
    <rect x="0" y="0" width="2400" height="1600"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip270)" d="M0 1600 L2400 1600 L2400 8.88178e-14 L0 8.88178e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip271">
    <rect x="480" y="0" width="1681" height="1600"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip270)" d="M156.112 1486.45 L2352.76 1486.45 L2352.76 47.2441 L156.112 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip272">
    <rect x="156" y="47" width="2198" height="1440"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.281,1486.45 218.281,47.2441 "></polyline>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="736.358,1486.45 736.358,47.2441 "></polyline>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1254.43,1486.45 1254.43,47.2441 "></polyline>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1772.51,1486.45 1772.51,47.2441 "></polyline>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2290.59,1486.45 2290.59,47.2441 "></polyline>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,1486.45 2352.76,1486.45 "></polyline>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.281,1486.45 218.281,1467.55 "></polyline>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="736.358,1486.45 736.358,1467.55 "></polyline>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1254.43,1486.45 1254.43,1467.55 "></polyline>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1772.51,1486.45 1772.51,1467.55 "></polyline>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2290.59,1486.45 2290.59,1467.55 "></polyline>
<path clip-path="url(#clip270)" d="M188.224 1532.02 L217.899 1532.02 L217.899 1535.95 L188.224 1535.95 L188.224 1532.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M232.02 1544.91 L248.339 1544.91 L248.339 1548.85 L226.395 1548.85 L226.395 1544.91 Q229.057 1542.16 233.64 1537.53 Q238.246 1532.88 239.427 1531.53 Q241.672 1529.01 242.552 1527.27 Q243.455 1525.51 243.455 1523.82 Q243.455 1521.07 241.51 1519.33 Q239.589 1517.6 236.487 1517.6 Q234.288 1517.6 231.834 1518.36 Q229.404 1519.13 226.626 1520.68 L226.626 1515.95 Q229.45 1514.82 231.904 1514.24 Q234.358 1513.66 236.395 1513.66 Q241.765 1513.66 244.959 1516.35 Q248.154 1519.03 248.154 1523.52 Q248.154 1525.65 247.344 1527.57 Q246.557 1529.47 244.45 1532.07 Q243.871 1532.74 240.77 1535.95 Q237.668 1539.15 232.02 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M706.115 1532.02 L735.791 1532.02 L735.791 1535.95 L706.115 1535.95 L706.115 1532.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M746.693 1544.91 L754.332 1544.91 L754.332 1518.55 L746.022 1520.21 L746.022 1515.95 L754.286 1514.29 L758.962 1514.29 L758.962 1544.91 L766.601 1544.91 L766.601 1548.85 L746.693 1548.85 L746.693 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M1254.43 1517.37 Q1250.82 1517.37 1248.99 1520.93 Q1247.19 1524.47 1247.19 1531.6 Q1247.19 1538.71 1248.99 1542.27 Q1250.82 1545.82 1254.43 1545.82 Q1258.07 1545.82 1259.87 1542.27 Q1261.7 1538.71 1261.7 1531.6 Q1261.7 1524.47 1259.87 1520.93 Q1258.07 1517.37 1254.43 1517.37 M1254.43 1513.66 Q1260.24 1513.66 1263.3 1518.27 Q1266.38 1522.85 1266.38 1531.6 Q1266.38 1540.33 1263.3 1544.94 Q1260.24 1549.52 1254.43 1549.52 Q1248.62 1549.52 1245.55 1544.94 Q1242.49 1540.33 1242.49 1531.6 Q1242.49 1522.85 1245.55 1518.27 Q1248.62 1513.66 1254.43 1513.66 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M1762.89 1544.91 L1770.53 1544.91 L1770.53 1518.55 L1762.22 1520.21 L1762.22 1515.95 L1770.48 1514.29 L1775.16 1514.29 L1775.16 1544.91 L1782.8 1544.91 L1782.8 1548.85 L1762.89 1548.85 L1762.89 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M2285.24 1544.91 L2301.56 1544.91 L2301.56 1548.85 L2279.61 1548.85 L2279.61 1544.91 Q2282.28 1542.16 2286.86 1537.53 Q2291.47 1532.88 2292.65 1531.53 Q2294.89 1529.01 2295.77 1527.27 Q2296.67 1525.51 2296.67 1523.82 Q2296.67 1521.07 2294.73 1519.33 Q2292.81 1517.6 2289.71 1517.6 Q2287.51 1517.6 2285.05 1518.36 Q2282.62 1519.13 2279.85 1520.68 L2279.85 1515.95 Q2282.67 1514.82 2285.12 1514.24 Q2287.58 1513.66 2289.61 1513.66 Q2294.98 1513.66 2298.18 1516.35 Q2301.37 1519.03 2301.37 1523.52 Q2301.37 1525.65 2300.56 1527.57 Q2299.78 1529.47 2297.67 1532.07 Q2297.09 1532.74 2293.99 1535.95 Q2290.89 1539.15 2285.24 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,1445.72 2352.76,1445.72 "></polyline>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,1174.17 2352.76,1174.17 "></polyline>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,902.62 2352.76,902.62 "></polyline>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,631.072 2352.76,631.072 "></polyline>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,359.524 2352.76,359.524 "></polyline>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,87.9763 2352.76,87.9763 "></polyline>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,1486.45 156.112,47.2441 "></polyline>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,1445.72 175.01,1445.72 "></polyline>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,1174.17 175.01,1174.17 "></polyline>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,902.62 175.01,902.62 "></polyline>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,631.072 175.01,631.072 "></polyline>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,359.524 175.01,359.524 "></polyline>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,87.9763 175.01,87.9763 "></polyline>
<path clip-path="url(#clip270)" d="M62.9365 1431.51 Q59.3254 1431.51 57.4967 1435.08 Q55.6912 1438.62 55.6912 1445.75 Q55.6912 1452.86 57.4967 1456.42 Q59.3254 1459.96 62.9365 1459.96 Q66.5707 1459.96 68.3763 1456.42 Q70.205 1452.86 70.205 1445.75 Q70.205 1438.62 68.3763 1435.08 Q66.5707 1431.51 62.9365 1431.51 M62.9365 1427.81 Q68.7467 1427.81 71.8022 1432.42 Q74.8809 1437 74.8809 1445.75 Q74.8809 1454.48 71.8022 1459.08 Q68.7467 1463.67 62.9365 1463.67 Q57.1264 1463.67 54.0477 1459.08 Q50.9921 1454.48 50.9921 1445.75 Q50.9921 1437 54.0477 1432.42 Q57.1264 1427.81 62.9365 1427.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M83.0984 1457.12 L87.9827 1457.12 L87.9827 1463 L83.0984 1463 L83.0984 1457.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M108.168 1431.51 Q104.557 1431.51 102.728 1435.08 Q100.922 1438.62 100.922 1445.75 Q100.922 1452.86 102.728 1456.42 Q104.557 1459.96 108.168 1459.96 Q111.802 1459.96 113.608 1456.42 Q115.436 1452.86 115.436 1445.75 Q115.436 1438.62 113.608 1435.08 Q111.802 1431.51 108.168 1431.51 M108.168 1427.81 Q113.978 1427.81 117.033 1432.42 Q120.112 1437 120.112 1445.75 Q120.112 1454.48 117.033 1459.08 Q113.978 1463.67 108.168 1463.67 Q102.358 1463.67 99.2789 1459.08 Q96.2234 1454.48 96.2234 1445.75 Q96.2234 1437 99.2789 1432.42 Q102.358 1427.81 108.168 1427.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M63.9319 1159.97 Q60.3208 1159.97 58.4921 1163.53 Q56.6865 1167.07 56.6865 1174.2 Q56.6865 1181.31 58.4921 1184.87 Q60.3208 1188.42 63.9319 1188.42 Q67.5661 1188.42 69.3717 1184.87 Q71.2004 1181.31 71.2004 1174.2 Q71.2004 1167.07 69.3717 1163.53 Q67.5661 1159.97 63.9319 1159.97 M63.9319 1156.26 Q69.742 1156.26 72.7976 1160.87 Q75.8763 1165.45 75.8763 1174.2 Q75.8763 1182.93 72.7976 1187.54 Q69.742 1192.12 63.9319 1192.12 Q58.1217 1192.12 55.043 1187.54 Q51.9875 1182.93 51.9875 1174.2 Q51.9875 1165.45 55.043 1160.87 Q58.1217 1156.26 63.9319 1156.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M84.0938 1185.57 L88.978 1185.57 L88.978 1191.45 L84.0938 1191.45 L84.0938 1185.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M99.2095 1156.89 L117.566 1156.89 L117.566 1160.82 L103.492 1160.82 L103.492 1169.3 Q104.51 1168.95 105.529 1168.79 Q106.547 1168.6 107.566 1168.6 Q113.353 1168.6 116.733 1171.77 Q120.112 1174.94 120.112 1180.36 Q120.112 1185.94 116.64 1189.04 Q113.168 1192.12 106.848 1192.12 Q104.672 1192.12 102.404 1191.75 Q100.159 1191.38 97.7511 1190.64 L97.7511 1185.94 Q99.8345 1187.07 102.057 1187.63 Q104.279 1188.18 106.756 1188.18 Q110.76 1188.18 113.098 1186.08 Q115.436 1183.97 115.436 1180.36 Q115.436 1176.75 113.098 1174.64 Q110.76 1172.54 106.756 1172.54 Q104.881 1172.54 103.006 1172.95 Q101.154 1173.37 99.2095 1174.25 L99.2095 1156.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M53.7467 915.965 L61.3856 915.965 L61.3856 889.599 L53.0754 891.266 L53.0754 887.007 L61.3393 885.34 L66.0152 885.34 L66.0152 915.965 L73.654 915.965 L73.654 919.9 L53.7467 919.9 L53.7467 915.965 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M83.0984 914.02 L87.9827 914.02 L87.9827 919.9 L83.0984 919.9 L83.0984 914.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M108.168 888.419 Q104.557 888.419 102.728 891.983 Q100.922 895.525 100.922 902.655 Q100.922 909.761 102.728 913.326 Q104.557 916.868 108.168 916.868 Q111.802 916.868 113.608 913.326 Q115.436 909.761 115.436 902.655 Q115.436 895.525 113.608 891.983 Q111.802 888.419 108.168 888.419 M108.168 884.715 Q113.978 884.715 117.033 889.321 Q120.112 893.905 120.112 902.655 Q120.112 911.381 117.033 915.988 Q113.978 920.571 108.168 920.571 Q102.358 920.571 99.2789 915.988 Q96.2234 911.381 96.2234 902.655 Q96.2234 893.905 99.2789 889.321 Q102.358 884.715 108.168 884.715 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M54.7421 644.417 L62.381 644.417 L62.381 618.051 L54.0708 619.718 L54.0708 615.459 L62.3347 613.792 L67.0106 613.792 L67.0106 644.417 L74.6494 644.417 L74.6494 648.352 L54.7421 648.352 L54.7421 644.417 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M84.0938 642.472 L88.978 642.472 L88.978 648.352 L84.0938 648.352 L84.0938 642.472 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M99.2095 613.792 L117.566 613.792 L117.566 617.727 L103.492 617.727 L103.492 626.199 Q104.51 625.852 105.529 625.69 Q106.547 625.505 107.566 625.505 Q113.353 625.505 116.733 628.676 Q120.112 631.848 120.112 637.264 Q120.112 642.843 116.64 645.945 Q113.168 649.023 106.848 649.023 Q104.672 649.023 102.404 648.653 Q100.159 648.283 97.7511 647.542 L97.7511 642.843 Q99.8345 643.977 102.057 644.533 Q104.279 645.088 106.756 645.088 Q110.76 645.088 113.098 642.982 Q115.436 640.875 115.436 637.264 Q115.436 633.653 113.098 631.547 Q110.76 629.44 106.756 629.44 Q104.881 629.44 103.006 629.857 Q101.154 630.273 99.2095 631.153 L99.2095 613.792 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M56.9643 372.869 L73.2837 372.869 L73.2837 376.804 L51.3393 376.804 L51.3393 372.869 Q54.0014 370.114 58.5847 365.485 Q63.1911 360.832 64.3717 359.489 Q66.617 356.966 67.4967 355.23 Q68.3994 353.471 68.3994 351.781 Q68.3994 349.027 66.455 347.29 Q64.5337 345.554 61.4319 345.554 Q59.2328 345.554 56.7791 346.318 Q54.3486 347.082 51.5708 348.633 L51.5708 343.911 Q54.3949 342.777 56.8486 342.198 Q59.3023 341.619 61.3393 341.619 Q66.7096 341.619 69.9041 344.304 Q73.0985 346.99 73.0985 351.48 Q73.0985 353.61 72.2883 355.531 Q71.5013 357.429 69.3948 360.022 Q68.8161 360.693 65.7143 363.911 Q62.6124 367.105 56.9643 372.869 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M83.0984 370.925 L87.9827 370.925 L87.9827 376.804 L83.0984 376.804 L83.0984 370.925 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M108.168 345.323 Q104.557 345.323 102.728 348.888 Q100.922 352.429 100.922 359.559 Q100.922 366.665 102.728 370.23 Q104.557 373.772 108.168 373.772 Q111.802 373.772 113.608 370.23 Q115.436 366.665 115.436 359.559 Q115.436 352.429 113.608 348.888 Q111.802 345.323 108.168 345.323 M108.168 341.619 Q113.978 341.619 117.033 346.226 Q120.112 350.809 120.112 359.559 Q120.112 368.286 117.033 372.892 Q113.978 377.475 108.168 377.475 Q102.358 377.475 99.2789 372.892 Q96.2234 368.286 96.2234 359.559 Q96.2234 350.809 99.2789 346.226 Q102.358 341.619 108.168 341.619 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M57.9597 101.321 L74.279 101.321 L74.279 105.256 L52.3347 105.256 L52.3347 101.321 Q54.9967 98.5665 59.58 93.9369 Q64.1865 89.2841 65.367 87.9416 Q67.6124 85.4184 68.492 83.6823 Q69.3948 81.9231 69.3948 80.2333 Q69.3948 77.4786 67.4504 75.7425 Q65.5291 74.0064 62.4272 74.0064 Q60.2282 74.0064 57.7745 74.7703 Q55.344 75.5342 52.5662 77.0851 L52.5662 72.3629 Q55.3903 71.2287 57.8439 70.65 Q60.2976 70.0713 62.3347 70.0713 Q67.705 70.0713 70.8994 72.7565 Q74.0939 75.4416 74.0939 79.9323 Q74.0939 82.062 73.2837 83.9832 Q72.4966 85.8814 70.3902 88.474 Q69.8115 89.1453 66.7096 92.3628 Q63.6078 95.5573 57.9597 101.321 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M84.0938 99.3767 L88.978 99.3767 L88.978 105.256 L84.0938 105.256 L84.0938 99.3767 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip270)" d="M99.2095 70.6963 L117.566 70.6963 L117.566 74.6314 L103.492 74.6314 L103.492 83.1036 Q104.51 82.7564 105.529 82.5944 Q106.547 82.4092 107.566 82.4092 Q113.353 82.4092 116.733 85.5805 Q120.112 88.7517 120.112 94.1684 Q120.112 99.747 116.64 102.849 Q113.168 105.928 106.848 105.928 Q104.672 105.928 102.404 105.557 Q100.159 105.187 97.7511 104.446 L97.7511 99.747 Q99.8345 100.881 102.057 101.437 Q104.279 101.992 106.756 101.992 Q110.76 101.992 113.098 99.8859 Q115.436 97.7795 115.436 94.1684 Q115.436 90.5573 113.098 88.4508 Q110.76 86.3443 106.756 86.3443 Q104.881 86.3443 103.006 86.761 Q101.154 87.1777 99.2095 88.0573 L99.2095 70.6963 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip272)" style="stroke:#80c4ac; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.281,1445.72 221.654,1445.72 225.027,1445.72 228.4,1445.72 231.773,1445.72 247.367,1445.72 262.961,1445.72 278.555,1445.72 294.149,1445.72 301.946,1445.72 309.743,1445.72 313.641,1445.72 317.54,1445.72 318.514,1445.72 319.489,1445.72 320.464,1445.72 321.438,1445.72 322.413,87.9763 323.388,87.9763 324.362,87.9763 325.337,87.9763 327.286,87.9763 329.235,87.9763 331.185,87.9763 333.134,87.9763 337.032,87.9763 340.931,87.9763 348.728,87.9763 356.525,87.9763 375.267,87.9763 394.01,87.9763 403.381,87.9763 412.753,87.9763 415.095,87.9763 417.438,87.9763 419.781,87.9763 422.124,87.9763 422.71,87.9763 423.295,87.9763 423.881,87.9763 424.467,87.9763 425.052,87.9763 425.638,1445.72 426.224,1445.72 426.809,1445.72 427.981,1445.72 429.152,1445.72 430.324,1445.72 431.495,1445.72 435.457,1445.72 439.418,1445.72 443.38,1445.72 447.342,1445.72 455.265,1445.72 463.188,1445.72 479.035,1445.72 494.882,1445.72 563.737,1445.72 627.216,1445.72 695.272,1445.72 774.122,1445.72 844.194,1445.72 905.641,1445.72 972.634,1445.72 1040.03,1445.72 1077.28,1445.72 1114.54,1445.72 1149.98,1445.72 1185.43,1445.72 1203.86,1445.72 1222.29,1445.72 1231.5,1445.72 1240.72,1445.72 1243.02,1445.72 1245.32,1445.72 1247.63,1445.72 1249.93,1445.72 1251.08,1445.72 1252.23,1445.72 1252.81,1445.72 1253.39,1445.72 1253.96,1445.72 1254.54,902.62 1255.11,902.62 1255.69,902.62 1256.27,902.62 1256.84,902.62 1257.99,902.62 1259.14,902.62 1263.02,902.62 1266.9,902.62 1270.78,902.62 1274.66,902.62 1282.41,902.62 1290.17,902.62 1305.68,902.62 1321.2,902.62 1396.95,902.62 1466.35,902.62 1530.45,902.62 1595.38,902.62 1668.14,902.62 1734.08,902.62 1809.57,902.62 1879.47,902.62 1913.92,902.62 1948.38,902.62 1965.11,902.62 1981.83,902.62 1990.2,902.62 1998.56,902.62 2006.93,902.62 2015.29,902.62 2019.58,902.62 2023.86,902.62 2026.01,902.62 2028.15,902.62 2029.22,902.62 2030.29,902.62 2030.83,902.62 2031.36,902.62 2031.9,1445.72 2032.44,1445.72 2032.97,1445.72 2033.51,1445.72 2034.04,1445.72 2034.58,1445.72 2035.65,1445.72 2036.72,1445.72 2038.87,1445.72 2041.01,1445.72 2045.3,1445.72 2049.58,1445.72 2066.73,1445.72 2083.88,1445.72 2121.45,1445.72 2159.03,1445.72 2213.61,1445.72 2268.19,1445.72 2279.39,1445.72 2290.59,1445.72 "></polyline>
</svg>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;1
</figcaption>
</figure>
</div>
</div>
</section>
<section id="ベイズ最適推定量" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="ベイズ最適推定量"><span class="header-section-number">1.4</span> ベイズ最適推定量</h3>
<p><a href="#fig-1" class="quarto-xref">図&nbsp;1</a> の状況でも，たしかに１点のみを選ぶならば MAP 推定量で良いかもしれないが，<span class="math inline">\(x\le0\)</span> である確率は <span class="math inline">\(x\ge0\)</span> である確率よりも低いため，この意味では，<span class="math inline">\(x\in[0,3/2]\)</span> の範囲に推定量が収まっていた方が好ましいかもしれない．</p>
<p>推定量 <span class="math inline">\(\widehat{x}_n:\mathbb{R}^n\to\mathbb{R}\)</span> を評価するには，何らかのアプリオリな <strong>損失</strong> の概念が必要である．これを損失関数 <span class="math inline">\(L:\mathbb{R}^2\to\mathbb{R}\)</span> という形で与える．</p>
<p>すると，損失の期待値が計算可能になり，これを <strong>危険</strong> という： <span class="math display">\[
R(\widehat{x}_n):=\operatorname{E}[L(\widehat{x}_n(\boldsymbol{Y}),X)].
\]</span></p>
<p>このリスクを最小化する推定量を <strong>ベイズ最適推定量</strong>，その際のリスクを <strong>ベイズリスク</strong> という．<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<section id="sec-MMSE" class="level4" data-number="1.4.1">
<h4 data-number="1.4.1" class="anchored" data-anchor-id="sec-MMSE"><span class="header-section-number">1.4.1</span> <span class="math inline">\(l^2\)</span>-ベイズ最適推定量</h4>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(L(x,y):=(x-y)^2\)</span> と定める．このとき，<strong>事後平均</strong> がベイズリスクを達成する： <span class="math display">\[
\widehat{x}(\boldsymbol{y}):=\int_\mathbb{R}xp(x|\boldsymbol{y})\,
dx.
\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
<p><a href="#fig-1" class="quarto-xref">図&nbsp;1</a> の場合では，事後平均は約 <span class="math inline">\(0.1\)</span> で，かろうじて正になる．</p>
</section>
<section id="l1-ベイズ最適推定量" class="level4" data-number="1.4.2">
<h4 data-number="1.4.2" class="anchored" data-anchor-id="l1-ベイズ最適推定量"><span class="header-section-number">1.4.2</span> <span class="math inline">\(l^1\)</span>-ベイズ最適推定量</h4>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(L(x,y):=\lvert x-y\rvert\)</span> と定める．このとき，<strong>事後中央値</strong> がベイズリスクを達成する．</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
<p><a href="#fig-1" class="quarto-xref">図&nbsp;1</a> の場合では，事後中央値は <span class="math inline">\(0.5\)</span> となる．大変頑健な推定だと言えるだろう．</p>
</section>
<section id="最適決定規則" class="level4" data-number="1.4.3">
<h4 data-number="1.4.3" class="anchored" data-anchor-id="最適決定規則"><span class="header-section-number">1.4.3</span> 最適決定規則</h4>
<p>今回の誤り訂正符号の文脈の目標は，<span class="math inline">\(x^*\)</span> の復元であることを思い出せば，今回の損失は <span class="math inline">\(L(x,y)=\delta_0(x-y)\)</span> ととり，復号が成功する確率を最大とする推定量が「最良」と言うべきであろう： <span class="math display">\[
R(\widehat{x}_n)=\operatorname{P}[\widehat{x}_n(\boldsymbol{Y})=X]
\]</span></p>
<p>これは結局 MAP 推定量 <span class="math display">\[
\widehat{x}_n:=\mathop{\mathrm{arg\,max}}_{x\in\mathbb{R}}p(x|\boldsymbol{y})
\]</span> で与えられることになる．</p>
</section>
</section>
</section>
<section id="統計物理からの視点" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="統計物理からの視点"><span class="header-section-number">2</span> 統計物理からの視点</h2>
<p>真のシグナル <span class="math inline">\(x^*\in\mathbb{R}\)</span> を，事後平均によって点推定する問題を考える（次節で一般次元のベクトル <span class="math inline">\(\mathbb{R}^n\)</span> のスパース推定を考える．</p>
<section id="事後分布をある物理系の平衡分布と見る" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="事後分布をある物理系の平衡分布と見る"><span class="header-section-number">2.1</span> 事後分布をある物理系の平衡分布と見る</h3>
<p>ベイズの公式 (<a href="#eq-bayes" class="quarto-xref">1</a>) は <span class="math display">\[
p(x|\boldsymbol{y})=\frac{e^{\log p(\boldsymbol{y}|x)p(x)}}{p(\boldsymbol{y})}
\]</span> <span class="math display">\[
=\frac{e^{-H(x,\boldsymbol{y})}}{Z(\boldsymbol{y})},
\]</span> <span class="math display">\[
H(x,\boldsymbol{y}):=-\log p(\boldsymbol{y}|x)-\log p(x),
\]</span> <span class="math display">\[
Z(\boldsymbol{y}):=p(y),
\]</span> と書き換えられる．</p>
<p>すなわち，Bayes 事後分布 <span class="math inline">\(p(x|\boldsymbol{y})\)</span> は，<span class="math inline">\(\mathbb{R}\times\mathbb{R}^n\)</span> を配位空間に持ち，Hamiltonian <span class="math inline">\(H(x,\boldsymbol{y})\)</span> を持つ正準集団の平衡分布と捉えることができる．</p>
</section>
<section id="sec-identification" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="sec-identification"><span class="header-section-number">2.2</span> もう一つの見方</h3>
<p>今回，通信路は加法的に Gauss ノイズを加えるものとした． <span class="math display">\[
p(y|x)dy=\mathrm{N}(x,\sigma)^{\otimes n}(dy)
\]</span> とした場合，次のように理解することもできる： <span class="math display">\[
p(x|\boldsymbol{y})=\frac{e^{-H(x,\boldsymbol{y})}}{Z(\boldsymbol{y})},
\]</span> <span class="math display">\[
H(x,\boldsymbol{y}):=\frac{1}{2\sigma^2}\sum_{i=1}^n(x^2-2xy_i)-\log p(x),
\]</span> <span class="math display">\[
Z(\boldsymbol{y}):=\frac{1}{(2\pi\sigma^2)^{\frac{n}{2}}}\frac{e^{-\frac{\lvert\boldsymbol{y}\rvert^2}{2\sigma^2}}}{p(\boldsymbol{y})}.
\]</span></p>
<p>この場合，分配関数 <span class="math inline">\(Z(\boldsymbol{y})\)</span> は，情報源 <span class="math inline">\(p(x)\)</span> と Gauss 型通信路 <span class="math inline">\(p(y|x)\)</span> で与えられた周辺モデル <span class="math inline">\(p(y)\)</span> と，<span class="math inline">\(\mathrm{N}(0,\sigma^2)\)</span> との <a href="https://ja.wikipedia.org/wiki/ベイズ因子"><strong>ベイズ因子</strong></a> になっている．</p>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="式変形">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
式変形
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math display">\[\begin{align*}
    p(x|\boldsymbol{y})&amp;=p(\boldsymbol{y}|x)\frac{p(x)}{p(\boldsymbol{y})}\\
    &amp;=\frac{p(x)}{p(\boldsymbol{y})}\frac{1}{(2\pi\sigma^2)^{\frac{n}{2}}}e^{-\frac{1}{2\sigma^2}\sum_{i=1}^n(x-y_i)^2}\\
    &amp;=\frac{p(x)}{p(\boldsymbol{y})}\frac{e^{-\frac{1}{2\sigma^2}\sum_{i=1}^ny_i^2}}{(2\pi\sigma^2)^{\frac{n}{2}}}e^{-\frac{1}{2\sigma^2}\sum_{i=1}^n(x^2-2xy_i)}\\
    &amp;=\frac{p(x)e^{-\frac{1}{2\sigma^2}\sum_{i=1}^n(x^2-2xy_i)}}{Z(\boldsymbol{y})}\\
    &amp;=\frac{1}{Z(\boldsymbol{y})}\exp\left(\log p(x)-\frac{1}{2\sigma^2}\sum_{i=1}^n(x^2-2xy_i)\right)
\end{align*}\]</span></p>
</div>
</div>
</div>
<p>さらに，このモデル <span class="math inline">\(H\)</span> における自由エントロピーは，<span class="math inline">\(p(\boldsymbol{y})\)</span> と <span class="math inline">\(\mathrm{N}(0,\sigma^2)^{\otimes n}\)</span> との間の KL 乖離度となっている： <span class="math display">\[
F_n:=\int_{\mathbb{R}^n}\log\frac{p(\boldsymbol{y})}{q(\boldsymbol{y})}p(\boldsymbol{y})\,d\boldsymbol{y}=\mathop{\mathrm{KL}}(p,q).
\]</span> ただし，<span class="math inline">\(q\)</span> は <span class="math inline">\(\mathrm{N}(0,\sigma^2)^{\otimes n}\)</span> の密度とした．</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（その他の物理量）^[[@Krzakala-Zdeborova2024 p.122]．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（その他の物理量）<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p>この Hamiltonian <span class="math inline">\(H\)</span> を持つ系について，</p>
<ol type="1">
<li><p>エントロピー <span class="math inline">\(H\)</span> は次で与えられる：</p>
<p><span class="math display">\[\begin{align*}
     H(Y)&amp;:=-\int_{\mathbb{R}^n}(\log p(\boldsymbol{y}))p(\boldsymbol{y})\,d\boldsymbol{y}\\
     &amp;=\frac{n}{2}\log(2\pi\sigma^2)\\
     &amp;\qquad+\frac{1}{2\sigma^2}\int_{\mathbb{R}^n}\lvert\boldsymbol{y}\rvert^2p(\boldsymbol{y})\,d\boldsymbol{y}-F_n.
\end{align*}\]</span></p></li>
<li><p>相互情報量 <span class="math inline">\(I\)</span> は次で与えられる：</p>
<p><span class="math display">\[\begin{align*}
     I(X,Y)&amp;:=\mathop{\mathrm{KL}}(p(x,y),p(x)p(y))\\\\
     &amp;=\frac{n}{2\sigma^2}\int_{\mathbb{R}}x^2p(x)\,dx-F_n.
\end{align*}\]</span></p></li>
</ol>
<p>特に，いずれも自由エネルギーの定数倍である</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>の式変形は次のとおり： <span class="math display">\[\begin{align*}
    H(Y)&amp;:=-\int_{\mathbb{R}^n}(\log p(\boldsymbol{y}))p(\boldsymbol{y})\,d\boldsymbol{y}\\
    &amp;=-\int_{\mathbb{R}^n}p(\boldsymbol{y})d\boldsymbol{y}\log q(\boldsymbol{y})-F_n\\
    &amp;=-\int_{\mathbb{R}^n}\biggr(-\frac{n}{2}\log(2\pi\sigma^2)-\frac{\lvert\boldsymbol{y}\rvert^2}{2\sigma^2}\biggl)p(\boldsymbol{y})d\boldsymbol{y}-F_n\\
    &amp;=\frac{n}{2}\log(2\pi\sigma^2)+\frac{n}{2\sigma^2}\int_{\mathbb{R}}y_i^2p(y_i)\,dy_i-F_n.
\end{align*}\]</span></p></li>
<li><p>次の関係式を用いる： <span class="math display">\[
I(X,Y)=H(Y)-H(Y|X)
\]</span> <span class="math inline">\(H(Y)\)</span> は 1. から判明しており，<span class="math inline">\(H(Y|X)\)</span> は次のように計算できる：</p>
<p><span class="math display">\[\begin{align*}
H(Y|X)&amp;=-\int_{\mathbb{R}^{n+1}}\log p(\boldsymbol{y}|x)p(\boldsymbol{y}|x)p(x)\,dxd\boldsymbol{y}\\
&amp;=-\int_{\mathbb{R}^{n+1}}\log\left(\frac{1}{(2\pi\sigma^2)^{\frac{n}{2}}}\exp\left(-\frac{1}{2\sigma^2}\sum_{i=1}^n(y_i-x)^2\right)\right)p(\boldsymbol{y}|x)p(x)\,dxd\boldsymbol{y}\\
&amp;=\int_{\mathbb{R}^{n+1}}\left(\frac{n}{2}\log(2\pi\sigma^2)+\frac{\sum_{i=1}^n(x-y_i)^2}{2\sigma^2}\right)p(\boldsymbol{y}|x)p(x)\,dxd\boldsymbol{y}\\
&amp;=\frac{n}{2}\log(2\pi\sigma^2)+\frac{1}{2\sigma^2}\int_\mathbb{R}\left(\int_{\mathbb{R}^n}\sum_{i=1}^n(x-y_i)^2p(\boldsymbol{y}|x)\,d\boldsymbol{y}\right)\,p(x)dx\\
&amp;=\frac{n}{2}\log(2\pi\sigma^2)+\frac{n\sigma^2}{2\sigma^2}\int_\mathbb{R}p(x)\,dx\\
&amp;=\frac{n}{2}\log(2\pi\sigma^2)+\frac{n}{2}.
\end{align*}\]</span></p></li>
</ol>
<p>これと，<span class="math inline">\(y_i\)</span> には <span class="math inline">\(x_i\)</span> とこれと独立な分散 <span class="math inline">\(\sigma^2\)</span> のノイズが加わって得られる値であることから，次のように計算できる： <span class="math display">\[\begin{align*}
    I(X,Y)&amp;=H(Y)-\frac{n}{2}\log(2\pi\sigma^2)-\frac{n}{2}\\
    &amp;=-F_n-\frac{n}{2}+\frac{n}{2\sigma^2}\int_\mathbb{R}y_i^2p(y_i)\,dy_i\\
    &amp;=-F_n-\frac{n}{2}+\frac{n}{2\sigma^2}\left(\sigma^2+\int_\mathbb{R}x^2p(x)\,dx\right)\\
    &amp;=-F_n+\frac{n}{2\sigma^2}\int_\mathbb{R}x^2p(x)\,dx.
\end{align*}\]</span></p>
</div>
</div>
</div>
</section>
<section id="西森対称性" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="西森対称性"><span class="header-section-number">2.3</span> 西森対称性</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題 [@西森1980]^[[@Krzakala-Zdeborova2024 p.123] 定理13．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題 <span class="citation" data-cites="西森1980">(<a href="#ref-西森1980" role="doc-biblioref">Nishimori, 1980</a>)</span><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(P:\mathbb{R}\to\mathbb{R}^n\)</span> を確率核，<span class="math inline">\(X^*\in\mathcal{L}(\Omega)\)</span> は分布 <span class="math inline">\(\nu\in\mathcal{P}(\mathbb{R})\)</span> を持ち，<span class="math inline">\(Y\in\mathcal{L}(\Omega;\mathbb{R}^n)\)</span> の分布は <span class="math display">\[
\mu(dy)=\int_\mathbb{R}\nu(dx)P(x,dy)
\]</span> で定まるとする．ここで，<span class="math inline">\(Y\)</span> で条件づけた <span class="math inline">\(X^*\)</span> の確率分布を <span class="math inline">\(P^{X|Y}\)</span> とする： <span class="math display">\[
\nu(dx)=\int_{\mathbb{R}^n}\mu(dy)P^{X|Y}(y,dx).
\]</span> <span class="math display">\[
X^{(1)},\cdots,X^{(k)}\overset{\text{iid}}{\sim}P^{X|Y}
\]</span> を独立な確率変数列とすると，次が成り立つ：</p>
<p><span class="math display">\[\begin{align*}
    &amp;\quad\operatorname{E}\biggl[f(Y,X^{(1)},\cdots,X^{(k)})\biggr]\\
    &amp;=\operatorname{E}\left[f(Y,X^{(1)},\cdots,X^{(k-1)},X^*)\right].
\end{align*}\]</span></p>
</div>
</div>
<p><span class="math inline">\(X^{(1)},\cdots,X^{(k)}\)</span> で表した確率変数の <span class="math inline">\(P^{X|Y}\)</span> に関する積分を Boltzmann 積分と呼び，観測を作り出す過程 <span class="math inline">\((X^*,Y)\)</span> に関する積分を無秩序積分 (disorder expectation) という．</p>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>この設定の下で，<span class="math inline">\((X^*,Y)\)</span> の結合分布が次の２通りで表せていることに注意： <span class="math display">\[
\nu(dx)P(x,dy)=\mu(dy)P^{X|Y}(y,dx).
\]</span> 従って， <span class="math display">\[\begin{align*}
    &amp;\quad\nu(dx)P(x,dy)P^{X|Y}(y,dx^{(1)},\cdots,dx^{(k)})\\
    &amp;=\mu(dy)P^{X|Y}(y,dx)P^{X|Y}(y,dx^{(1)},\cdots,dx^{(k)})
\end{align*}\]</span> に関して <span class="math inline">\(f(Y,X^{(1)},\cdots,X^{(k)})\)</span> の期待値を取ると，次のように計算できる： <span class="math display">\[\begin{align*}
    &amp;\quad\operatorname{E}\biggl[f(Y,X^{(1)},\cdots,X^{(k)})\biggr]\\
    &amp;=\int_{\mathbb{R}^{n+k}}f(y,x^{(1)},\cdots ,x^{(k-1)},x^{(k)})P^{X|Y}(y,dx^{(1)})\cdots P^{X|Y}(y,dx^{(k)})\mu(dy)\\
    &amp;=\int_{\mathbb{R}^{n+k}}f(y,x^{(1)},\cdots,x^{(k-1)},x)P^{X|Y}(y,dx^{(1)})\cdots P^{X|Y}(y,dx^{(k-1)})\nu(dx)P(x,dy)\\
    &amp;=\operatorname{E}\left[f(Y,X^{(1)},\cdots,X^{(k-1)},X^*)\right].
\end{align*}\]</span></p>
<p>確率核 <span class="math inline">\(P\)</span> にまつわる記法は次の記事も参照：</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/static/Notations.html" target="_blank">
            <img src="https://162348.github.io/static/Notations.svg" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">数学記法一覧</h3>
                <p class="article-description">本サイトで用いる記法と規約</p>
            </div>
        </a>
    </div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="物理的な解釈">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
物理的な解釈
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math inline">\(P^{X|Y}\)</span> に関する積分を <span class="math inline">\(\langle-\rangle\)</span> で表すことで，何をどのように物理的に解釈しているかが明確になる： <span class="math display">\[
\langle X\rangle=\operatorname{E}[X|Y].
\]</span></p>
<p>この見方を採用すると，期待値を <span class="math display">\[
\operatorname{E}\biggl[f(Y,X^{(1)},\cdots,X^{(k)})\biggr]=\operatorname{E}^Y\left[\left\langle f(Y,X^{(1)},\cdots,X^{(k)})\right\rangle\right]
\]</span> と二段階で捉えていることになる．右辺の外側の期待値は単に <span class="math inline">\(Y\)</span> のみに関してとっていることになる．</p>
<p>第 <a href="#sec-identification" class="quarto-xref">2.2</a> 節で考えたモデル <span class="math inline">\(H\)</span> における Boltzmann 分布が <span class="math inline">\(P^{X|Y}\)</span> となり，平均 <span class="math inline">\(\langle-\rangle\)</span> はこれに関する平均となる．</p>
<p>一方で，Hamiltonian <span class="math inline">\(H\)</span> にもランダム性が残っているのであり，これに関する平均が <span class="math inline">\((X^*,Y)\)</span> に関する平均に当たる．</p>
<p>こうして，ベイズ統計モデルはスピングラス系（特にランダムエネルギーモデル <span class="citation" data-cites="Derrida1980">(<a href="#ref-Derrida1980" role="doc-biblioref">Derrida, 1980</a>)</span>）と同一視できるようになる．</p>
<p>だが同時に，スピングラスのサンプリングを困難にする多谷構造も，ベイズ統計に輸入されるのである……．</p>
<p>スピングラスについては，次の記事も参照：</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Nature/StatisticalMechanics1.html" target="_blank">
            <img src="https://162348.github.io/posts/2024/Nature/SG.png" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">数学者のための統計力学１</h3>
                <p class="article-description">Ising 模型とスピングラス</p>
            </div>
        </a>
    </div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-MMSE-via-Nishimori" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="sec-MMSE-via-Nishimori"><span class="header-section-number">2.4</span> 最小自乗誤差推定量</h3>
<p>第 <a href="#sec-MMSE" class="quarto-xref">1.4.1</a> 節で扱った最小自乗誤差推定量の自乗誤差は次のように計算できる：</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（最小自乗誤差の表示）">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（最小自乗誤差の表示）
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(\langle X\rangle:=\operatorname{E}[X|Y]\)</span> と表す．事後平均推定量の自乗誤差は次のように表せる： <span class="math display">\[\begin{align*}
    \DeclareMathOperator{\MMSE}{MMSE}
    \MMSE&amp;:=\operatorname{E}\biggl[\biggr(X-\operatorname{E}[X|Y]\biggl)^2\biggr]\\
    &amp;=\operatorname{E}[X^2]-\operatorname{E}\biggl[\langle X\rangle^2\biggr].
\end{align*}\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math display">\[\begin{align*}
    \operatorname{E}[\mathrm{V}[X|Y]]&amp;=\operatorname{E}\biggl[\biggr(\operatorname{E}[X|Y]-X\biggl)^2\biggr]\\
    &amp;=\operatorname{E}\biggl[\operatorname{E}[X|Y]^2-2X\operatorname{E}[X|Y]+X^2\biggr]\\
    &amp;=\operatorname{E}\biggl[\operatorname{E}[X|Y]^2\biggr]-2\operatorname{E}\biggl[X\operatorname{E}[X|Y]\biggr]+\operatorname{E}[X^2]\\
    &amp;=\operatorname{E}[X^2]-\operatorname{E}\biggl[\operatorname{E}[X|Y]^2\biggr].
\end{align*}\]</span></p>
<p>この変形では，繰り返し期待値の法則 <span class="math display">\[\begin{align*}
    \operatorname{E}\biggl[X\operatorname{E}[X|Y]\biggr]&amp;=\operatorname{E}\biggl[\biggl[X\operatorname{E}[X|Y]\,\bigg|\,Y\biggr]\biggr]\\
    &amp;=\operatorname{E}\biggl[\operatorname{E}[X|Y]^2\biggr]
\end{align*}\]</span> を西森の対称性の代わりに用いたことになる．</p>
<p>換言すれば，西森の対称性を証明したのと同様の方法を本命題にも適用したため，直接命題の適用は回避したことになる．</p>
</div>
</div>
</div>
</section>
<section id="kl-乖離度の微分としての分散" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="kl-乖離度の微分としての分散"><span class="header-section-number">2.5</span> KL 乖離度の微分としての分散</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（自由エネルギーによる特徴付け）[@Guo+2005]^[[@Krzakala-Zdeborova2024 p.124] 定理14．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（自由エネルギーによる特徴付け）<span class="citation" data-cites="Guo+2005">(<a href="#ref-Guo+2005" role="doc-biblioref">Guo et al., 2005</a>)</span><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p>簡単のため，<span class="math inline">\(n=1\)</span> とする．このとき，<span class="math inline">\(\beta:=\sigma^{-2}\)</span> に関して，次の式が成り立つ：</p>
<ol type="1">
<li><p>自由エネルギー <span class="math inline">\(F_1\)</span> について， <span class="math display">\[
\frac{\partial F_1}{\partial \beta}=\frac{\operatorname{E}[\langle X\rangle^2]}{2}.
\]</span></p></li>
<li><p>相互情報量 <span class="math inline">\(I(X,Y)\)</span> について，</p>
<p><span class="math display">\[\begin{align*}
    \frac{\partial I(X,Y)}{\partial \beta}&amp;=\frac{\operatorname{E}[X^2]-\operatorname{E}[\langle X\rangle^2]}{2}\\
    &amp;=\frac{\MMSE}{2}
\end{align*}\]</span></p></li>
</ol>
<p>ただし，<span class="math inline">\(\langle X\rangle:=\operatorname{E}[X|Y]\)</span> と定めた．</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math display">\[\begin{align*}
    \log\frac{p(y)}{q(y)}&amp;=\frac{\displaystyle\frac{1}{\sqrt{2\pi\sigma^2}}\int_\mathbb{R}e^{-\frac{(x-y)^2}{2\sigma^2}}p(x)\,dx}{\frac{1}{\sqrt{2\pi\sigma^2}}e^{-\frac{y^2}{2\sigma^2}}}\\
    &amp;=\int_\mathbb{R}e^{-\frac{x^2-2xy}{2\sigma^2}}p(x)\,dx.
\end{align*}\]</span></p>
<p>この <span class="math inline">\(p(y)dy\)</span> に関する積分を <span class="math inline">\(\beta\)</span> で微分すれば良いのであるが，<span class="math inline">\(p(y)\)</span> 自体が <span class="math inline">\(\sigma\)</span> に依存し，そのまま計算したのでは大変煩雑になる．</p>
<p>そこで，<span class="math inline">\(y=\sigma z+x^*\)</span> と変数変換をすることで，標準 Gauss 確率変数 <span class="math inline">\(Z\sim\gamma_1\)</span> と真値 <span class="math inline">\(X^*\)</span> は独立で，<span class="math inline">\(\sigma\)</span> も含まないから，次のように計算ができる： <span class="math display">\[\begin{align*}
    F_1(\beta)&amp;=\int_\mathbb{R}\log\frac{p(y)}{q(y)}p(y)\,dy\\
    &amp;=\operatorname{E}\biggl[\log\left(\int_\mathbb{R}e^{-\frac{x^2-2xY}{2\sigma^2}}p(x)\,dx\right)\biggr]\\
    &amp;=\operatorname{E}\biggl[\log\left(\int_\mathbb{R}\exp\left(-\frac{x^2}{2\sigma^2}+\frac{xZ}{\sigma}+\frac{xX^*}{\sigma^2}\right)p(x)\,dx\right)\biggr]\\
    &amp;=\operatorname{E}\biggl[\log\left(\int_\mathbb{R}\exp\left(-\frac{x^2\beta}{2}+xZ\sqrt{\beta}+xX^*\beta\right)p(x)\,dx\right)\biggr].
\end{align*}\]</span></p>
<p>こうして，最右辺の期待値に関する密度はもう <span class="math inline">\(\beta\)</span> に依存しないから，次のように微分が計算できる．ただし， <span class="math display">\[
\exp\left(-\frac{x^2\beta}{2}+xZ\sqrt{\beta}+xX^*\beta\right)p(x)\,dx
\]</span> は <span class="math inline">\(p(x|y)\)</span> の定数倍，すなわち Gibbs 測度 <span class="math inline">\(\frac{e^{-H(x,y)}}{Z(y)}dx\)</span> の定数倍であることに注意して，これらに関する平均を引き続き <span class="math inline">\(\langle-\rangle:=\operatorname{E}[-|Y]\)</span> で表すこととすると，</p>
<p><span class="math display">\[\begin{align*}
    \frac{\partial F_1(\beta)}{\partial \beta}&amp;=
    \operatorname{E}\left[\frac{\displaystyle\int_\mathbb{R}\biggr(-\frac{x^2}{2}+\frac{xZ}{2\sqrt{\beta}}+xX^*\biggl)e^{-\frac{x^2\beta}{2}+xZ\sqrt{\beta}+xX^*\beta}p(x)dx}{\displaystyle\int_\mathbb{R}\exp\left(-\frac{x^2\beta}{2}+xZ\sqrt{\beta}+xX^*\beta\right)p(x)\,dx}\right]\\
    &amp;=-\frac{\operatorname{E}[\langle X^2\rangle]}{2}+\frac{1}{2\sqrt{\beta}}\operatorname{E}[\langle X\rangle Z]+\operatorname{E}[\langle X\rangle X^*].
\end{align*}\]</span></p>
<p><span class="math inline">\(\langle X\rangle\)</span> が中に入っているのは，<span class="math inline">\(\sigma[X^*,Z]\)</span> に関する条件付き期待値を <span class="math inline">\(\operatorname{E}\)</span> 内で取ったためと捉えられる．</p>
<p>まず，第二項は，Stein の補題 <a href="#sec-Steins-lemma" class="quarto-xref">2.6</a> の系から， <span class="math display">\[\begin{align*}
    \frac{1}{2\sqrt{\beta}}\operatorname{E}[\langle X\rangle Z]&amp;=\frac{1}{2\sqrt{\beta}}\sqrt{\beta}\biggr(\operatorname{E}[\langle X^2\rangle]-\operatorname{E}[\langle X\rangle^2]\biggl)\\
    &amp;=\frac{\operatorname{E}[\langle X^2\rangle]}{2}-\frac{\operatorname{E}[\langle X\rangle^2]}{2}
\end{align*}\]</span></p>
<p>第三項は，西森の対称性から， <span class="math display">\[\begin{align*}
    \operatorname{E}[\langle X\rangle X^*]=\operatorname{E}[\langle X\rangle^2].
\end{align*}\]</span></p>
<p>以上を併せると， <span class="math display">\[
\frac{\partial F_1(\beta)}{\partial \beta}=\frac{\operatorname{E}[\langle X\rangle^2]}{2}.
\]</span></p>
<ol type="1">
<li>の主張も，<span class="math inline">\(n=1\)</span> のときは <span class="math display">\[
I(X,Y)=\frac{\beta}{2}\int_\mathbb{R}x^2p(x)\,dx-F_1
\]</span> であったために従う： <span class="math display">\[\begin{align*}
\frac{\partial I(X,Y)}{\partial \beta}&amp;=\frac{\operatorname{E}[X^2]}{2}-\frac{\operatorname{E}[\langle X\rangle^2]}{2}\\
&amp;=\frac{MMSE}{2}.
\end{align*}\]</span></li>
</ol>
</div>
</div>
</div>
</section>
<section id="sec-Steins-lemma" class="level3" data-number="2.6">
<h3 data-number="2.6" class="anchored" data-anchor-id="sec-Steins-lemma"><span class="header-section-number">2.6</span> Stein の補題</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題 [@Stein1972]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題 <span class="citation" data-cites="Stein1972">(<a href="#ref-Stein1972" role="doc-biblioref">Stein, 1972</a>)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>可積分な確率変数 <span class="math inline">\(X\in\mathcal{L}^1(\Omega)\)</span> について，次は同値：</p>
<ol type="1">
<li><span class="math inline">\(X\)</span> の分布は標準Gaussである：<span class="math inline">\(X\sim\gamma_1\)</span>．</li>
<li>任意の <span class="math inline">\(f\in C^1_b(\mathbb{R})\)</span> について， <span class="math display">\[
\operatorname{E}[f'(X)]=\operatorname{E}[Xf(X)]&lt;\infty.
\]</span></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>(1)<span class="math inline">\(\Rightarrow\)</span>(2)</p>
<p><span class="math inline">\(f,f'\)</span> はいずれも有界としたから， <span class="math display">\[
  \operatorname{E}[f'(X)],\operatorname{E}[f(X)]&lt;\infty
  \]</span> が成り立つ．</p>
<p><span class="math inline">\(\gamma_1\)</span> の密度 <span class="math inline">\(\phi\)</span> は <span class="math inline">\(\phi'(x)=-x\phi(x)\)</span> を満たすことに注意すれば，部分積分により， <span class="math display">\[\begin{align*}
      \operatorname{E}[f'(X)]&amp;=-\int_\mathbb{R}f(x)\phi'(x)dx\\
      &amp;=\int_\mathbb{R}f(x)x\phi(x)dx=\operatorname{E}[f(X)X].
  \end{align*}\]</span></p></li>
<li><p>(2)<span class="math inline">\(\Rightarrow\)</span>(1)</p>
<p><span class="math inline">\(X\)</span> は可積分としたから，特性関数 <span class="math inline">\(\varphi(u):=\operatorname{E}[e^{iuX}]\)</span> は少なくとも <span class="math inline">\(C^1(\mathbb{R})\)</span>-級で，その微分は <span class="math inline">\(\phi(x):=e^{iux}\)</span> に関する仮定 <span class="math inline">\(\operatorname{E}[\phi'(X)]=\operatorname{E}[X\phi(X)]\)</span> を通じて <span class="math display">\[\begin{align*}
      \varphi'(u)&amp;=i\operatorname{E}[Xe^{iuX}]=-u\operatorname{E}[e^{iuX}]\\
      &amp;=-u\varphi(u),\qquad u\in\mathbb{R},
  \end{align*}\]</span> と計算できる．</p>
<p>この微分方程式は規格化条件 <span class="math inline">\(\varphi(0)=1\)</span> の下で一意な解 <span class="math inline">\(\varphi(u)=e^{-\frac{u^2}{2}}\)</span> を持つ．</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="系">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
系
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(\langle X\rangle:=\operatorname{E}[X|Y]\)</span> とこれと独立な <span class="math inline">\(Z\sim\gamma_1\)</span> に関して，次が成り立つ：</p>
<p><span class="math display">\[\begin{align*}
    \operatorname{E}[\langle X\rangle Z]&amp;=\operatorname{E}\left[\frac{\partial \langle X\rangle}{\partial Z}\right]\\
    &amp;=\sqrt{\beta}\biggr(\operatorname{E}[\langle X^2\rangle]-\operatorname{E}[\langle X\rangle^2]\biggl)
\end{align*}\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>最初の等号 <span class="math display">\[
\operatorname{E}[\langle X\rangle Z]=\operatorname{E}\left[\frac{\partial \langle X\rangle}{\partial Z}\right]
\]</span> は Stein の補題による．</p>
<p>続いて， <span class="math display">\[
\langle X\rangle=\int_\mathbb{R}xp(x|Y)\,dx
\]</span> は <span class="math inline">\(Y=\sigma Z+X^*\)</span> を通じてのみ <span class="math inline">\(Z\)</span> に依存するから， <span id="eq-chain-rule"><span class="math display">\[
\frac{\partial \langle X\rangle}{\partial Z}=\frac{\partial \langle X\rangle}{\partial Y}\frac{d Y}{d Z}=\sigma\frac{\partial \langle X\rangle}{\partial Y}
\tag{2}\]</span></span> が成り立つ．あとは <span class="math inline">\(\langle X\rangle=\operatorname{E}[X|Y]\)</span> の <span class="math inline">\(Y\)</span> に関する微分を計算すれば良い．</p>
<p><span class="math display">\[
\frac{\partial p(y|x)}{\partial y}=-\frac{y-x}{\sigma^2}p(y|x).
\]</span> また， <span class="math display">\[
p(y)=\frac{1}{\sqrt{2\pi\sigma^2}}\int_\mathbb{R}e^{-\frac{(x-y)^2}{2\sigma^2}}p(x)\,dx
\]</span> であったから， <span class="math display">\[\begin{align*}
    p'(y)&amp;=\frac{1}{\sqrt{2\pi\sigma^2}}\int_\mathbb{R}-\frac{y-x}{\sigma^2}e^{-\frac{(x-y)^2}{2\sigma^2}}p(x)\,dx\\
    &amp;=-\int_\mathbb{R}\frac{y-x}{\sigma^2}p(y|x)p(x)\,dx\\
    &amp;=-\int_\mathbb{R}\frac{y-x}{\sigma^2}p(x|y)p(y)\,dx\\
    &amp;=-\frac{y-\langle X\rangle}{\sigma^2}p(y).
\end{align*}\]</span> <span class="math display">\[
\therefore\quad\frac{p'(Y)}{p(Y)}=\frac{\langle X\rangle-Y}{\sigma^2}
\]</span></p>
<p>に注意すれば，次のように計算できる：</p>
<p><span class="math display">\[\begin{align*}
    \frac{\partial \langle X\rangle}{\partial Y}&amp;=\frac{\partial }{\partial Y}\int_\mathbb{R}xp(x|Y)\,dx\\
    &amp;=\frac{\partial }{\partial Y}\int_\mathbb{R}x\frac{p(Y|x)p(x)}{p(Y)}\,dx\\
    &amp;=\int_\mathbb{R}x\frac{\partial }{\partial Y}\frac{p(Y|x)p(x)}{p(Y)}\,dx\\
    &amp;=\int_\mathbb{R}x\frac{\partial p(Y|x)}{\partial Y}\frac{p(x)}{p(Y)}\,dx\\
    &amp;\qquad+\int_\mathbb{R}x\left(\frac{\partial }{\partial Y}\frac{1}{p(Y)}\right)p(Y|x)p(x)\,dx\\
    &amp;=-\int_\mathbb{R}x\frac{Y-x}{\sigma^2}p(x|Y)\,dx\\
    &amp;\qquad-\frac{p'(Y)}{p(Y)}\int_\mathbb{R}xp(x|Y)\,dx\\
    &amp;=-\frac{Y}{\sigma^2}\langle X\rangle+\frac{\langle X^2\rangle}{\sigma^2}\\
    &amp;\qquad-\langle X\rangle\frac{\langle X\rangle-Y}{\sigma^2}\\
    &amp;=\frac{1}{\sigma^2}\biggr(\langle X^2\rangle-\langle X\rangle^2\biggl).
\end{align*}\]</span></p>
<p>最後，式 (<span class="math inline">\(\ref{eq-chain-rule}\)</span>) より， <span class="math display">\[\begin{align*}
    \frac{\partial \langle X\rangle}{\partial Z}&amp;=\sigma\frac{\partial \langle X\rangle}{\partial Y}\\
    &amp;=\sqrt{\beta}\biggr(\langle X^2\rangle-\langle X\rangle^2\biggl).
\end{align*}\]</span></p>
<!-- 
\begin{align*}
    \E\Square{\pp{\brac{X}}{Z}}&=\E\Square{\pp{}{Z}\E[X|Y=\sigma Z+x^*]}\\
    &=\E\Square{\pp{}{Z}\int_\R xp(x|\sigma Z+x^*)\,dx}
\end{align*}

$p(x|y)$ は Boltzmann 分布である（第 [-@sec-identification] 節）から，次のように計算を進められる：

\begin{align*}
    &\quad\E\Square{\pp{}{Z}\int_\R xp(x|\sigma Z+x^*)\,dx}\\
    &=\E\Square{\pp{}{Z}\int_\R\frac{xe^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}\,dx}\\
    &=\E\Square{\int_\R x\pp{}{Z}\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}\,dx}
\end{align*}

として計算し，結果が絶対可積分であったならば Fubini-Tonelli の定理により，最後の等号が正当化される．

また，記号の混同を避けるため，分配関数は $\cZ$ で表した．$Z\sim\gamma_1$ であった．

$$
H(x,y)=\frac{1}{2\sigma^2}(x^2-2xy)-\log p(x)
$$
$$
\therefore\quad\pp{H(x,y)}{y}=-\frac{x}{\sigma^2}
$$

より，

\begin{align*}
    &\quad\pp{}{Z}\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}\\
    &=-\pp{H(x,\sigma Z+x^*)}{Z}\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}+\pp{}{Z}\paren{\frac{1}{\cZ(\sigma Z+x^*)}}e^{-H(x,\sigma Z+x^*)}\\
    &=\frac{x}{\sigma^2}\sigma\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}-\frac{\cZ'(\sigma Z+x^*)}{\cZ(\sigma Z+x^*)}\sigma\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}
\end{align*}

さらに，$\cZ(y)=\frac{q(y)}{p(y)}$ であるが，
$$
\cZ'(y)=-\frac{1}{\sigma^2}\frac{yq(y)}{p(y)}-\frac{p'(y)q(y)}{p(y)^2}
$$

\begin{align*}
    \frac{\cZ'(Y)}{\cZ(Y)}=-\frac{Y}{\sigma^2}-\frac{p'(Y)}{p(Y)}
\end{align*}

続いて
$$
p(y)=\frac{1}{\sqrt{2\pi\sigma^2}}\int_\R e^{-\frac{(x-y)^2}{2\sigma^2}}p(x)\,dx
$$
であったから，
\begin{align*}
    p'(y)&=\frac{1}{\sqrt{2\pi\sigma^2}}\int_\R-\frac{y-x}{\sigma^2}e^{-\frac{(x-y)^2}{2\sigma^2}}p(x)\,dx\\
    &=-\int_\R\frac{y-x}{\sigma^2}p(y|x)p(x)\,dx\\
    &=-\int_\R\frac{y-x}{\sigma^2}p(x|y)p(y)\,dx\\
    &=-\frac{y-\brac{X}}{\sigma^2}p(y).
\end{align*}
$$
\therefore\quad\frac{p'(Y)}{p(Y)}=\frac{\brac{X}-Y}{\sigma^2}
$$
\begin{align*}
    \therefore\quad\frac{\cZ'(Y)}{\cZ(Y)}&=-\frac{Y}{\sigma^2}-\frac{p'(Y)}{p(Y)}=-\frac{\brac{X}}{\sigma^2}
\end{align*}

と計算できるから，

\begin{align*}
    &\quad\E\Square{\int_\R x\pp{}{Z}\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}\,dx}\\
    &=\E\Square{\int_\R x\Paren{\frac{x}{\sigma^2}\sigma p(x|Y)-\frac{\cZ'(\sigma Z+x^*)}{\cZ(\sigma Z+x^*)}\sigma p(x|Y)}dx}\\
    &=\E\Square{\int_\R\frac{x^2}{\sigma}p(x|Y)\,dx}+\E\Square{\int_\R x\sigma\frac{\brac{X}}{\sigma^2}p(x|Y)dx}\\
    &=\sqrt{\beta}\E[\brac{X^2}]+\sqrt{\beta}\E[\brac{X}^2]
\end{align*}
-->
</div>
</div>
</div>



</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Derrida1980" class="csl-entry" role="listitem">
Derrida, B. (1980). Random-energy model: Limit of a family of disordered models. <em>Phys. Rev. Lett.</em>, <em>45</em>, 79–82. <a href="https://doi.org/10.1103/PhysRevLett.45.79">https://doi.org/10.1103/PhysRevLett.45.79</a>
</div>
<div id="ref-Guo+2005" class="csl-entry" role="listitem">
Guo, D., Shamai, S., &amp; Verdu, S. (2005). Mutual information and minimum mean-square error in gaussian channels. <em>IEEE Transactions on Information Theory</em>, <em>51</em>(4), 1261–1282. <a href="https://doi.org/10.1109/TIT.2005.844072">https://doi.org/10.1109/TIT.2005.844072</a>
</div>
<div id="ref-Krzakala-Zdeborova2024" class="csl-entry" role="listitem">
Krazakala, F., &amp; Zdeborová, L. (2024). <em>Statistical physics methods in optimization and machine learning</em>. <a href="https://sphinxteam.github.io/EPFLDoctoralLecture2021/Notes.pdf">https://sphinxteam.github.io/EPFLDoctoralLecture2021/Notes.pdf</a>
</div>
<div id="ref-西森1980" class="csl-entry" role="listitem">
Nishimori, H. (1980). Exact results and critical properties of the ising model with competing interactions. <em>Journal of Physics C: Solid State Physics</em>, <em>13</em>(21), 4071. <a href="https://doi.org/10.1088/0022-3719/13/21/012">https://doi.org/10.1088/0022-3719/13/21/012</a>
</div>
<div id="ref-Stein1972" class="csl-entry" role="listitem">
Stein, C. (1972). <em><span class="nocase">A Bound for the Error in the Normal Approximation to the Distribution of a Sum of Dependent Random Variables</span></em>. Stanford University. <a href="https://purl.stanford.edu/jc818sv7483">https://purl.stanford.edu/jc818sv7483</a>
</div>
<div id="ref-Storopoli2021" class="csl-entry" role="listitem">
Storopoli, J. (2021). <em>Bayesian statistics with julia and turing</em>. <a href="https://storopoli.io/Bayesian-Julia">https://storopoli.io/Bayesian-Julia</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala &amp; Zdeborová, 2024, p. 119</a>)</span>．<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala &amp; Zdeborová, 2024, p. 122</a>)</span>．<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala &amp; Zdeborová, 2024, p. 123</a>)</span> 定理13．<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala &amp; Zdeborová, 2024, p. 124</a>)</span> 定理14．<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="162348/162348.github.io" data-repo-id="R_kgDOKlfKYQ" data-category="Announcements" data-category-id="DIC_kwDOKlfKYc4CgDmb" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" data-loading="lazy" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://162348.github.io/">
<p>Hirofumi Shiba</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/162348/162348.github.io/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ano2math5">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:shiba.hirofumi@ism.ac.jp">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../../blog.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>