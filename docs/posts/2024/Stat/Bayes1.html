<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="司馬博文">

<title>Hirofumi Shiba - ベイズ統計学と統計物理学</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../profile.jpg" rel="icon" type="image/jpeg">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "?",
    "H"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-36GX2G6GLL"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-36GX2G6GLL', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="Hirofumi Shiba - ベイズ統計学と統計物理学">
<meta property="og:description" content="ノイズ付きで観測された情報を復元するデノイジング問題は，ベイズ推定問題として扱える．これを統計力学の観点からランダムエネルギーモデルとして解析することで，データ数無限大の極限における振る舞いを理解できる．一般に，ベイズ統計モデルはスピングラスモデルと同一視することができ，その漸近論（特に比例的高次元極限）に閾値現象が出現することはスピングラス系の常磁性相とスピングラス相の相転移と深い対応を持つ．">
<meta property="og:image" content="https://162348.github.io/posts/2024/Stat/posterior.svg">
<meta property="og:site_name" content="Hirofumi Shiba">
<meta name="twitter:title" content="Hirofumi Shiba - ベイズ統計学と統計物理学">
<meta name="twitter:description" content="ノイズ付きで観測された情報を復元するデノイジング問題は，ベイズ推定問題として扱える．これを統計力学の観点からランダムエネルギーモデルとして解析することで，データ数無限大の極限における振る舞いを理解できる．一般に，ベイズ統計モデルはスピングラスモデルと同一視することができ，その漸近論（特に比例的高次元極限）に閾値現象が出現することはスピングラス系の常磁性相とスピングラス相の相転移と深い対応を持つ．">
<meta name="twitter:image" content="https://162348.github.io/posts/2024/Stat/posterior.svg">
<meta name="twitter:creator" content="@ano2math5">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Hirofumi Shiba</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Sessions.html"> 
<span class="menu-text">Sessions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Japanese.html"> 
<span class="menu-text">自己紹介</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
    <a href="https://github.com/162348/162348.github.io/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">ベイズ統計学と統計物理学</h1>
            <p class="subtitle lead">スパース符号の復元を題材として</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Bayesian</div>
                <div class="quarto-category">Nature</div>
                <div class="quarto-category">Information</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>司馬博文 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">6/20/2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">6/23/2024</p>
      </div>
    </div>
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="block-title">概要</div>
      ノイズ付きで観測された情報を復元するデノイジング問題は，ベイズ推定問題として扱える．これを統計力学の観点からランダムエネルギーモデルとして解析することで，データ数無限大の極限における振る舞いを理解できる．一般に，ベイズ統計モデルはスピングラスモデルと同一視することができ，その漸近論（特に比例的高次元極限）に閾値現象が出現することはスピングラス系の常磁性相とスピングラス相の相転移と深い対応を持つ．
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#bayes-推定" id="toc-bayes-推定" class="nav-link active" data-scroll-target="#bayes-推定"><span class="header-section-number">1</span> Bayes 推定</a>
  <ul class="collapse">
  <li><a href="#デノイジング問題としての設定" id="toc-デノイジング問題としての設定" class="nav-link" data-scroll-target="#デノイジング問題としての設定"><span class="header-section-number">1.1</span> デノイジング問題としての設定</a></li>
  <li><a href="#sec-example" id="toc-sec-example" class="nav-link" data-scroll-target="#sec-example"><span class="header-section-number">1.2</span> 例：Delta-Gauss 混合</a></li>
  <li><a href="#map-推定量" id="toc-map-推定量" class="nav-link" data-scroll-target="#map-推定量"><span class="header-section-number">1.3</span> MAP 推定量</a></li>
  <li><a href="#ベイズ最適推定量" id="toc-ベイズ最適推定量" class="nav-link" data-scroll-target="#ベイズ最適推定量"><span class="header-section-number">1.4</span> ベイズ最適推定量</a></li>
  </ul></li>
  <li><a href="#統計物理からの視点" id="toc-統計物理からの視点" class="nav-link" data-scroll-target="#統計物理からの視点"><span class="header-section-number">2</span> 統計物理からの視点</a>
  <ul class="collapse">
  <li><a href="#sec-straightforward-identification" id="toc-sec-straightforward-identification" class="nav-link" data-scroll-target="#sec-straightforward-identification"><span class="header-section-number">2.1</span> 事後分布をある物理系の平衡分布と見る</a></li>
  <li><a href="#sec-identification" id="toc-sec-identification" class="nav-link" data-scroll-target="#sec-identification"><span class="header-section-number">2.2</span> もう一つの見方</a></li>
  <li><a href="#sec-Nishimori-symmetry" id="toc-sec-Nishimori-symmetry" class="nav-link" data-scroll-target="#sec-Nishimori-symmetry"><span class="header-section-number">2.3</span> 西森対称性</a></li>
  <li><a href="#sec-MMSE-via-Nishimori" id="toc-sec-MMSE-via-Nishimori" class="nav-link" data-scroll-target="#sec-MMSE-via-Nishimori"><span class="header-section-number">2.4</span> 最小自乗誤差推定量</a></li>
  <li><a href="#sec-I-MMSE" id="toc-sec-I-MMSE" class="nav-link" data-scroll-target="#sec-I-MMSE"><span class="header-section-number">2.5</span> KL 乖離度の微分としての分散</a></li>
  <li><a href="#sec-Steins-lemma" id="toc-sec-Steins-lemma" class="nav-link" data-scroll-target="#sec-Steins-lemma"><span class="header-section-number">2.6</span> Stein の補題</a></li>
  </ul></li>
  <li><a href="#sec-sparse-vector-denoising" id="toc-sec-sparse-vector-denoising" class="nav-link" data-scroll-target="#sec-sparse-vector-denoising"><span class="header-section-number">3</span> スパースベクトルの復号</a>
  <ul class="collapse">
  <li><a href="#sec-settings" id="toc-sec-settings" class="nav-link" data-scroll-target="#sec-settings"><span class="header-section-number">3.1</span> 設定</a></li>
  <li><a href="#自由エネルギー密度の計算" id="toc-自由エネルギー密度の計算" class="nav-link" data-scroll-target="#自由エネルギー密度の計算"><span class="header-section-number">3.2</span> 自由エネルギー密度の計算</a></li>
  <li><a href="#sec-bounds-on-Phi" id="toc-sec-bounds-on-Phi" class="nav-link" data-scroll-target="#sec-bounds-on-Phi"><span class="header-section-number">3.3</span> 自由エネルギーの上下評価</a></li>
  <li><a href="#解釈" id="toc-解釈" class="nav-link" data-scroll-target="#解釈"><span class="header-section-number">3.4</span> 解釈</a></li>
  <li><a href="#自由エネルギーのさらに鋭い評価" id="toc-自由エネルギーのさらに鋭い評価" class="nav-link" data-scroll-target="#自由エネルギーのさらに鋭い評価"><span class="header-section-number">3.5</span> 自由エネルギーのさらに鋭い評価</a></li>
  <li><a href="#まとめ" id="toc-まとめ" class="nav-link" data-scroll-target="#まとめ"><span class="header-section-number">3.6</span> まとめ</a></li>
  </ul></li>
  
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<p>本稿では全ての結果に数学的に厳密な証明をつけ，それが叶わなかったものは次稿に譲った：</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Stat/Bayes2.html" target="_blank">
            <img src="https://raw.githubusercontent.com/162348/162348.github.io/main/thumbnail.svg" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">ベイズ統計学とスピングラス</h3>
                <p class="article-description">誤り訂正符号を題材にして</p>
            </div>
        </a>
    </div>
</div>
<p>次稿ではレプリカ法や cavity 法を用いて，ベイズ統計と統計物理学の関係を見ていく．本稿でもレプリカ法は用いるが，同時に数学的に厳密な証明も付した．</p>
<section id="bayes-推定" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="bayes-推定"><span class="header-section-number">1</span> Bayes 推定</h2>
<p>符号の誤り訂正，または denoising の文脈で Bayes 推定を考える．</p>
<p>雑音が加わる通信路から受け取った観測から真の信号を推定するというデノイジング問題は，Bayes 推定が自然に選好される格好の設定である．</p>
<section id="デノイジング問題としての設定" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="デノイジング問題としての設定"><span class="header-section-number">1.1</span> デノイジング問題としての設定</h3>
<p>情報源は無記憶で，確率分布 <span class="math inline">\(p(x)dx\)</span> に従うとし，通信路は，確率核 <span class="math inline">\(p(y|x)dy\)</span> に従うとする．</p>
<p>送信符号は１つの実数 <span class="math inline">\(x^*\sim p(x)dx\)</span> であったとし，この単一の入力 <span class="math inline">\(x^*\)</span> を <span class="math inline">\(n\)</span> 回独立に観測する： <span class="math display">\[
y_1,\cdots,y_n\overset{\text{iid}}{\sim}p(y|x^*)dy.
\]</span></p>
<p>この観測を経たあと，送信符号 <span class="math inline">\(x^*\)</span> はいったい何だったのかを推定することを考えると，極めて自然に Bayes 推定が選択される．</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="純粋な解釈を持つ Bayes 推定">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
純粋な解釈を持つ Bayes 推定
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>まず，何の観測もない場合，<span class="math inline">\(x^*\)</span> の確率分布は <span class="math inline">\(p(x)dx\)</span> である（設定上）．</p>
<p>しかし，すでに観測 <span class="math inline">\(y_1,\cdots,y_n\)</span> を経ている．よってこの事象の上での <span class="math inline">\(x^*\)</span> の条件付き分布を計算すれば良いことになる： <span class="math display">\[
p(x|y_1,\cdots,y_n) = \frac{p(\boldsymbol{y}|x)p(x)}{p(\boldsymbol{y})}
\]</span> <span id="eq-bayes"><span class="math display">\[
= \frac{\displaystyle p(y_1|x)\cdots p(y_n|x)p(x)}{\displaystyle\int_\mathbb{R}p(y_1|x)\cdots p(y_n|x)p(x)\,dx}
\tag{1}\]</span></span></p>
<p>こうして，誤り訂正符号の文脈では，Bayes 事前確率・事後確率が純粋に確率（または頻度）としての解釈を持つ．通常の統計的枠組みよりも仮定が多いが，その仮定の形式が Bayes 推定の形式にピッタリなのである．</p>
<p>信号処理と Bayesian formalism の類似性は <span class="citation" data-cites="Iba1999">(<a href="#ref-Iba1999" role="doc-biblioref">Iba, 1999, p. 3876</a>)</span>，<span class="citation" data-cites="Zdeborova-Krzakala2016">(<a href="#ref-Zdeborova-Krzakala2016" role="doc-biblioref">Zdeborová &amp; Krzakala, 2016, p. 456</a>)</span> でも指摘されている．</p>
<p>また，統計力学をベイズ推定の特殊な場合とみなせるという見方は，<span class="citation" data-cites="Jaynes1957">(<a href="#ref-Jaynes1957" role="doc-biblioref">Jaynes, 1957</a>)</span> から始まる．<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
</div>
</div>
</div>
</section>
<section id="sec-example" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="sec-example"><span class="header-section-number">1.2</span> 例：Delta-Gauss 混合</h3>
<p>入力は <span class="math inline">\(1/2\)</span> の確率で <span class="math inline">\(x=0\)</span> だが，もう <span class="math inline">\(1/2\)</span> の確率で標準正規分布 <span class="math inline">\(\mathrm{N}(0,1)\)</span> に従うとする： <span class="math display">\[
p(x)dx=\frac{1}{2}\delta_0(dx)+\frac{1}{2}\mathrm{N}(0,1)(dx).
\]</span> 通信路は加法的 Gauss 型であるとする： <span class="math display">\[
p(x,y)=\frac{1}{\sqrt{2\pi}}\exp\left(-\frac{(x-y)^2}{2}\right).
\]</span> では真値を <span class="math inline">\(x^*=1\)</span> として，<span class="math inline">\(n=10\)</span> 回の観測データを生成してみる：</p>
<div id="7176aee4" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="bu">Random</span>.<span class="fu">seed!</span>(<span class="fl">123</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> <span class="fl">1</span> <span class="op">.+</span> <span class="fu">randn</span>(<span class="fl">10</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1.8082879284649667, -0.12207250811417336, -0.10463610232929588, 0.5830073648350667, 1.2875879806238557, 1.2298186980518677, 0.5782313356003073, -0.355590621101197, -0.08821851393628699, 1.7037583257923017]</code></pre>
</div>
</div>
<p>愚直な計算から，<span class="math inline">\(p(\boldsymbol{y})\)</span> は次の積分から得られる：</p>
<div class="script-size">
<p><span class="math display">\[\begin{align*}
    p(\boldsymbol{y})&amp;=\int_\mathbb{R}p(\boldsymbol{y}|x)p(x)dx\\
    &amp;=\int_\mathbb{R}\prod_{i=1}^n p(y_i|x)p(x)dx\\
    &amp;=\frac{1}{2}\frac{1}{(2\pi)^{n+1}}\int_\mathbb{R}\exp\left(-\frac{1}{2}\sum_{i=1}^n(y_i-x)^2+x^2\right)dx\\
    &amp;\qquad+\frac{1}{2}\frac{1}{(2\pi)^n}\exp\left(-\frac{1}{2}\sum_{i=1}^n(y_i-x)^2\right)dx.
\end{align*}\]</span></p>
</div>
<p>これを実際に計算した結果は <span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala &amp; Zdeborová, 2024, p. 117</a>)</span> で与えられている．</p>
<p>ここでは，邪教のような計算を啓示するのではなく，Julia と Turing を通じて計算する方法を紹介する <span class="citation" data-cites="Storopoli2021">(<a href="#ref-Storopoli2021" role="doc-biblioref">Storopoli, 2021</a>)</span>．</p>
<div id="f782102e" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span>, <span class="bu">Distributions</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>prior <span class="op">=</span> <span class="fu">MixtureModel</span>([<span class="fu">Normal</span>(<span class="fl">0.0</span>, <span class="fl">1.0</span>), <span class="fu">Normal</span>(<span class="fl">0.0</span>, <span class="fl">0.005</span>)], [<span class="fl">0.5</span>, <span class="fl">0.5</span>])</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">mixed_normal_model</span>(data)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    μ <span class="op">~</span> prior</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(data)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        data[i] <span class="op">~</span> <span class="fu">Normal</span>(μ, <span class="fl">1</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">mixed_normal_model</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b35bb5a8" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(model, <span class="fu">NUTS</span>(), <span class="fl">100000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="511f8eaa" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MCMCChains</span>, <span class="bu">Plots</span>, <span class="bu">StatsPlots</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(chain[<span class="op">:</span>μ], seriestype <span class="op">=</span> <span class="op">:</span>density, xlabel <span class="op">=</span> <span class="st">"x*"</span>, ylabel <span class="op">=</span> <span class="st">"Density"</span>, title <span class="op">=</span> <span class="st">"Posterior Distribution"</span>, color <span class="op">=</span> <span class="st">"#80c4ac"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vline!</span>([<span class="fl">1</span>], color <span class="op">=</span> <span class="op">:</span>pink, linewidth <span class="op">=</span> <span class="fl">2</span>, label <span class="op">=</span> <span class="st">"x^* = 1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="576" height="384" viewbox="0 0 2304 1536">
<defs>
  <clippath id="clip430">
    <rect x="0" y="0" width="2304" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip430)" d="M0 1536 L2304 1536 L2304 8.52651e-14 L0 8.52651e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip431">
    <rect x="460" y="0" width="1614" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip430)" d="M218.906 1359.82 L2256.76 1359.82 L2256.76 123.472 L218.906 123.472  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip432">
    <rect x="218" y="123" width="2039" height="1237"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="459.169,1359.82 459.169,123.472 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="810.851,1359.82 810.851,123.472 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1162.53,1359.82 1162.53,123.472 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1514.22,1359.82 1514.22,123.472 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1865.9,1359.82 1865.9,123.472 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2217.58,1359.82 2217.58,123.472 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,1359.82 2256.76,1359.82 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="459.169,1359.82 459.169,1340.92 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="810.851,1359.82 810.851,1340.92 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1162.53,1359.82 1162.53,1340.92 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1514.22,1359.82 1514.22,1340.92 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1865.9,1359.82 1865.9,1340.92 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2217.58,1359.82 2217.58,1340.92 "></polyline>
<path clip-path="url(#clip430)" d="M406.195 1404.62 L435.871 1404.62 L435.871 1408.56 L406.195 1408.56 L406.195 1404.62 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M455.963 1389.97 Q452.352 1389.97 450.523 1393.54 Q448.718 1397.08 448.718 1404.21 Q448.718 1411.31 450.523 1414.88 Q452.352 1418.42 455.963 1418.42 Q459.597 1418.42 461.403 1414.88 Q463.232 1411.31 463.232 1404.21 Q463.232 1397.08 461.403 1393.54 Q459.597 1389.97 455.963 1389.97 M455.963 1386.27 Q461.773 1386.27 464.829 1390.87 Q467.907 1395.46 467.907 1404.21 Q467.907 1412.93 464.829 1417.54 Q461.773 1422.12 455.963 1422.12 Q450.153 1422.12 447.074 1417.54 Q444.019 1412.93 444.019 1404.21 Q444.019 1395.46 447.074 1390.87 Q450.153 1386.27 455.963 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M476.125 1415.57 L481.009 1415.57 L481.009 1421.45 L476.125 1421.45 L476.125 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M491.241 1386.89 L509.597 1386.89 L509.597 1390.83 L495.523 1390.83 L495.523 1399.3 Q496.542 1398.95 497.56 1398.79 Q498.579 1398.6 499.597 1398.6 Q505.384 1398.6 508.764 1401.78 Q512.143 1404.95 512.143 1410.36 Q512.143 1415.94 508.671 1419.04 Q505.199 1422.12 498.88 1422.12 Q496.704 1422.12 494.435 1421.75 Q492.19 1421.38 489.782 1420.64 L489.782 1415.94 Q491.866 1417.08 494.088 1417.63 Q496.31 1418.19 498.787 1418.19 Q502.792 1418.19 505.129 1416.08 Q507.467 1413.98 507.467 1410.36 Q507.467 1406.75 505.129 1404.65 Q502.792 1402.54 498.787 1402.54 Q496.912 1402.54 495.037 1402.96 Q493.185 1403.37 491.241 1404.25 L491.241 1386.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M788.236 1389.97 Q784.625 1389.97 782.796 1393.54 Q780.991 1397.08 780.991 1404.21 Q780.991 1411.31 782.796 1414.88 Q784.625 1418.42 788.236 1418.42 Q791.87 1418.42 793.676 1414.88 Q795.504 1411.31 795.504 1404.21 Q795.504 1397.08 793.676 1393.54 Q791.87 1389.97 788.236 1389.97 M788.236 1386.27 Q794.046 1386.27 797.102 1390.87 Q800.18 1395.46 800.18 1404.21 Q800.18 1412.93 797.102 1417.54 Q794.046 1422.12 788.236 1422.12 Q782.426 1422.12 779.347 1417.54 Q776.291 1412.93 776.291 1404.21 Q776.291 1395.46 779.347 1390.87 Q782.426 1386.27 788.236 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M808.398 1415.57 L813.282 1415.57 L813.282 1421.45 L808.398 1421.45 L808.398 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M833.467 1389.97 Q829.856 1389.97 828.027 1393.54 Q826.222 1397.08 826.222 1404.21 Q826.222 1411.31 828.027 1414.88 Q829.856 1418.42 833.467 1418.42 Q837.101 1418.42 838.907 1414.88 Q840.736 1411.31 840.736 1404.21 Q840.736 1397.08 838.907 1393.54 Q837.101 1389.97 833.467 1389.97 M833.467 1386.27 Q839.277 1386.27 842.333 1390.87 Q845.411 1395.46 845.411 1404.21 Q845.411 1412.93 842.333 1417.54 Q839.277 1422.12 833.467 1422.12 Q827.657 1422.12 824.578 1417.54 Q821.523 1412.93 821.523 1404.21 Q821.523 1395.46 824.578 1390.87 Q827.657 1386.27 833.467 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1140.42 1389.97 Q1136.8 1389.97 1134.98 1393.54 Q1133.17 1397.08 1133.17 1404.21 Q1133.17 1411.31 1134.98 1414.88 Q1136.8 1418.42 1140.42 1418.42 Q1144.05 1418.42 1145.86 1414.88 Q1147.68 1411.31 1147.68 1404.21 Q1147.68 1397.08 1145.86 1393.54 Q1144.05 1389.97 1140.42 1389.97 M1140.42 1386.27 Q1146.23 1386.27 1149.28 1390.87 Q1152.36 1395.46 1152.36 1404.21 Q1152.36 1412.93 1149.28 1417.54 Q1146.23 1422.12 1140.42 1422.12 Q1134.61 1422.12 1131.53 1417.54 Q1128.47 1412.93 1128.47 1404.21 Q1128.47 1395.46 1131.53 1390.87 Q1134.61 1386.27 1140.42 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1160.58 1415.57 L1165.46 1415.57 L1165.46 1421.45 L1160.58 1421.45 L1160.58 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1175.69 1386.89 L1194.05 1386.89 L1194.05 1390.83 L1179.98 1390.83 L1179.98 1399.3 Q1180.99 1398.95 1182.01 1398.79 Q1183.03 1398.6 1184.05 1398.6 Q1189.84 1398.6 1193.22 1401.78 Q1196.6 1404.95 1196.6 1410.36 Q1196.6 1415.94 1193.12 1419.04 Q1189.65 1422.12 1183.33 1422.12 Q1181.16 1422.12 1178.89 1421.75 Q1176.64 1421.38 1174.24 1420.64 L1174.24 1415.94 Q1176.32 1417.08 1178.54 1417.63 Q1180.76 1418.19 1183.24 1418.19 Q1187.24 1418.19 1189.58 1416.08 Q1191.92 1413.98 1191.92 1410.36 Q1191.92 1406.75 1189.58 1404.65 Q1187.24 1402.54 1183.24 1402.54 Q1181.36 1402.54 1179.49 1402.96 Q1177.64 1403.37 1175.69 1404.25 L1175.69 1386.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1481.37 1417.52 L1489.01 1417.52 L1489.01 1391.15 L1480.7 1392.82 L1480.7 1388.56 L1488.96 1386.89 L1493.64 1386.89 L1493.64 1417.52 L1501.28 1417.52 L1501.28 1421.45 L1481.37 1421.45 L1481.37 1417.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1510.72 1415.57 L1515.61 1415.57 L1515.61 1421.45 L1510.72 1421.45 L1510.72 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1535.79 1389.97 Q1532.18 1389.97 1530.35 1393.54 Q1528.54 1397.08 1528.54 1404.21 Q1528.54 1411.31 1530.35 1414.88 Q1532.18 1418.42 1535.79 1418.42 Q1539.42 1418.42 1541.23 1414.88 Q1543.06 1411.31 1543.06 1404.21 Q1543.06 1397.08 1541.23 1393.54 Q1539.42 1389.97 1535.79 1389.97 M1535.79 1386.27 Q1541.6 1386.27 1544.66 1390.87 Q1547.73 1395.46 1547.73 1404.21 Q1547.73 1412.93 1544.66 1417.54 Q1541.6 1422.12 1535.79 1422.12 Q1529.98 1422.12 1526.9 1417.54 Q1523.85 1412.93 1523.85 1404.21 Q1523.85 1395.46 1526.9 1390.87 Q1529.98 1386.27 1535.79 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1833.55 1417.52 L1841.19 1417.52 L1841.19 1391.15 L1832.88 1392.82 L1832.88 1388.56 L1841.14 1386.89 L1845.82 1386.89 L1845.82 1417.52 L1853.46 1417.52 L1853.46 1421.45 L1833.55 1421.45 L1833.55 1417.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1862.9 1415.57 L1867.79 1415.57 L1867.79 1421.45 L1862.9 1421.45 L1862.9 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1878.02 1386.89 L1896.37 1386.89 L1896.37 1390.83 L1882.3 1390.83 L1882.3 1399.3 Q1883.32 1398.95 1884.34 1398.79 Q1885.35 1398.6 1886.37 1398.6 Q1892.16 1398.6 1895.54 1401.78 Q1898.92 1404.95 1898.92 1410.36 Q1898.92 1415.94 1895.45 1419.04 Q1891.97 1422.12 1885.66 1422.12 Q1883.48 1422.12 1881.21 1421.75 Q1878.97 1421.38 1876.56 1420.64 L1876.56 1415.94 Q1878.64 1417.08 1880.86 1417.63 Q1883.09 1418.19 1885.56 1418.19 Q1889.57 1418.19 1891.91 1416.08 Q1894.24 1413.98 1894.24 1410.36 Q1894.24 1406.75 1891.91 1404.65 Q1889.57 1402.54 1885.56 1402.54 Q1883.69 1402.54 1881.81 1402.96 Q1879.96 1403.37 1878.02 1404.25 L1878.02 1386.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M2188.82 1417.52 L2205.14 1417.52 L2205.14 1421.45 L2183.19 1421.45 L2183.19 1417.52 Q2185.86 1414.76 2190.44 1410.13 Q2195.05 1405.48 2196.23 1404.14 Q2198.47 1401.61 2199.35 1399.88 Q2200.25 1398.12 2200.25 1396.43 Q2200.25 1393.67 2198.31 1391.94 Q2196.39 1390.2 2193.29 1390.2 Q2191.09 1390.2 2188.63 1390.97 Q2186.2 1391.73 2183.43 1393.28 L2183.43 1388.56 Q2186.25 1387.42 2188.7 1386.85 Q2191.16 1386.27 2193.19 1386.27 Q2198.57 1386.27 2201.76 1388.95 Q2204.95 1391.64 2204.95 1396.13 Q2204.95 1398.26 2204.14 1400.18 Q2203.36 1402.08 2201.25 1404.67 Q2200.67 1405.34 2197.57 1408.56 Q2194.47 1411.75 2188.82 1417.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M2214.95 1415.57 L2219.84 1415.57 L2219.84 1421.45 L2214.95 1421.45 L2214.95 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M2240.02 1389.97 Q2236.41 1389.97 2234.58 1393.54 Q2232.78 1397.08 2232.78 1404.21 Q2232.78 1411.31 2234.58 1414.88 Q2236.41 1418.42 2240.02 1418.42 Q2243.66 1418.42 2245.46 1414.88 Q2247.29 1411.31 2247.29 1404.21 Q2247.29 1397.08 2245.46 1393.54 Q2243.66 1389.97 2240.02 1389.97 M2240.02 1386.27 Q2245.83 1386.27 2248.89 1390.87 Q2251.97 1395.46 2251.97 1404.21 Q2251.97 1412.93 2248.89 1417.54 Q2245.83 1422.12 2240.02 1422.12 Q2234.21 1422.12 2231.13 1417.54 Q2228.08 1412.93 2228.08 1404.21 Q2228.08 1395.46 2231.13 1390.87 Q2234.21 1386.27 2240.02 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1238.05 1467.6 L1225.16 1484.94 L1238.72 1503.24 L1231.82 1503.24 L1221.44 1489.24 L1211.06 1503.24 L1204.16 1503.24 L1218 1484.59 L1205.33 1467.6 L1212.24 1467.6 L1221.69 1480.3 L1231.15 1467.6 L1238.05 1467.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1271.51 1463.55 L1260.08 1469.73 L1271.51 1475.93 L1269.66 1479.05 L1258.97 1472.59 L1258.97 1484.59 L1255.34 1484.59 L1255.34 1472.59 L1244.64 1479.05 L1242.8 1475.93 L1254.22 1469.73 L1242.8 1463.55 L1244.64 1460.4 L1255.34 1466.86 L1255.34 1454.86 L1258.97 1454.86 L1258.97 1466.86 L1269.66 1460.4 L1271.51 1463.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,1324.83 2256.76,1324.83 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,1143.01 2256.76,1143.01 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,961.193 2256.76,961.193 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,779.374 2256.76,779.374 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,597.556 2256.76,597.556 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,415.738 2256.76,415.738 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,233.92 2256.76,233.92 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,1359.82 218.906,123.472 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,1324.83 237.804,1324.83 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,1143.01 237.804,1143.01 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,961.193 237.804,961.193 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,779.374 237.804,779.374 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,597.556 237.804,597.556 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,415.738 237.804,415.738 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,233.92 237.804,233.92 "></polyline>
<path clip-path="url(#clip430)" d="M127.171 1310.63 Q123.56 1310.63 121.731 1314.19 Q119.925 1317.73 119.925 1324.86 Q119.925 1331.97 121.731 1335.53 Q123.56 1339.08 127.171 1339.08 Q130.805 1339.08 132.61 1335.53 Q134.439 1331.97 134.439 1324.86 Q134.439 1317.73 132.61 1314.19 Q130.805 1310.63 127.171 1310.63 M127.171 1306.92 Q132.981 1306.92 136.036 1311.53 Q139.115 1316.11 139.115 1324.86 Q139.115 1333.59 136.036 1338.2 Q132.981 1342.78 127.171 1342.78 Q121.36 1342.78 118.282 1338.2 Q115.226 1333.59 115.226 1324.86 Q115.226 1316.11 118.282 1311.53 Q121.36 1306.92 127.171 1306.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M147.333 1336.23 L152.217 1336.23 L152.217 1342.11 L147.333 1342.11 L147.333 1336.23 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M172.402 1310.63 Q168.791 1310.63 166.962 1314.19 Q165.157 1317.73 165.157 1324.86 Q165.157 1331.97 166.962 1335.53 Q168.791 1339.08 172.402 1339.08 Q176.036 1339.08 177.842 1335.53 Q179.67 1331.97 179.67 1324.86 Q179.67 1317.73 177.842 1314.19 Q176.036 1310.63 172.402 1310.63 M172.402 1306.92 Q178.212 1306.92 181.268 1311.53 Q184.346 1316.11 184.346 1324.86 Q184.346 1333.59 181.268 1338.2 Q178.212 1342.78 172.402 1342.78 Q166.592 1342.78 163.513 1338.2 Q160.458 1333.59 160.458 1324.86 Q160.458 1316.11 163.513 1311.53 Q166.592 1306.92 172.402 1306.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M128.768 1128.81 Q125.157 1128.81 123.328 1132.37 Q121.523 1135.92 121.523 1143.05 Q121.523 1150.15 123.328 1153.72 Q125.157 1157.26 128.768 1157.26 Q132.402 1157.26 134.208 1153.72 Q136.036 1150.15 136.036 1143.05 Q136.036 1135.92 134.208 1132.37 Q132.402 1128.81 128.768 1128.81 M128.768 1125.11 Q134.578 1125.11 137.634 1129.71 Q140.712 1134.3 140.712 1143.05 Q140.712 1151.77 137.634 1156.38 Q134.578 1160.96 128.768 1160.96 Q122.958 1160.96 119.879 1156.38 Q116.823 1151.77 116.823 1143.05 Q116.823 1134.3 119.879 1129.71 Q122.958 1125.11 128.768 1125.11 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M148.93 1154.41 L153.814 1154.41 L153.814 1160.29 L148.93 1160.29 L148.93 1154.41 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M168.027 1156.36 L184.346 1156.36 L184.346 1160.29 L162.402 1160.29 L162.402 1156.36 Q165.064 1153.6 169.647 1148.97 Q174.254 1144.32 175.434 1142.98 Q177.68 1140.45 178.559 1138.72 Q179.462 1136.96 179.462 1135.27 Q179.462 1132.51 177.518 1130.78 Q175.596 1129.04 172.494 1129.04 Q170.295 1129.04 167.842 1129.8 Q165.411 1130.57 162.633 1132.12 L162.633 1127.4 Q165.457 1126.26 167.911 1125.68 Q170.365 1125.11 172.402 1125.11 Q177.772 1125.11 180.967 1127.79 Q184.161 1130.48 184.161 1134.97 Q184.161 1137.1 183.351 1139.02 Q182.564 1140.92 180.457 1143.51 Q179.879 1144.18 176.777 1147.4 Q173.675 1150.59 168.027 1156.36 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M126.685 946.991 Q123.073 946.991 121.245 950.556 Q119.439 954.098 119.439 961.227 Q119.439 968.334 121.245 971.899 Q123.073 975.44 126.685 975.44 Q130.319 975.44 132.124 971.899 Q133.953 968.334 133.953 961.227 Q133.953 954.098 132.124 950.556 Q130.319 946.991 126.685 946.991 M126.685 943.288 Q132.495 943.288 135.55 947.894 Q138.629 952.477 138.629 961.227 Q138.629 969.954 135.55 974.561 Q132.495 979.144 126.685 979.144 Q120.874 979.144 117.796 974.561 Q114.74 969.954 114.74 961.227 Q114.74 952.477 117.796 947.894 Q120.874 943.288 126.685 943.288 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M146.846 972.593 L151.731 972.593 L151.731 978.473 L146.846 978.473 L146.846 972.593 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M174.763 947.987 L162.957 966.436 L174.763 966.436 L174.763 947.987 M173.536 943.913 L179.416 943.913 L179.416 966.436 L184.346 966.436 L184.346 970.324 L179.416 970.324 L179.416 978.473 L174.763 978.473 L174.763 970.324 L159.161 970.324 L159.161 965.811 L173.536 943.913 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M127.009 765.173 Q123.398 765.173 121.569 768.738 Q119.763 772.28 119.763 779.409 Q119.763 786.516 121.569 790.08 Q123.398 793.622 127.009 793.622 Q130.643 793.622 132.448 790.08 Q134.277 786.516 134.277 779.409 Q134.277 772.28 132.448 768.738 Q130.643 765.173 127.009 765.173 M127.009 761.469 Q132.819 761.469 135.874 766.076 Q138.953 770.659 138.953 779.409 Q138.953 788.136 135.874 792.742 Q132.819 797.326 127.009 797.326 Q121.198 797.326 118.12 792.742 Q115.064 788.136 115.064 779.409 Q115.064 770.659 118.12 766.076 Q121.198 761.469 127.009 761.469 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M147.171 790.775 L152.055 790.775 L152.055 796.654 L147.171 796.654 L147.171 790.775 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M172.819 777.511 Q169.67 777.511 167.819 779.664 Q165.99 781.817 165.99 785.566 Q165.99 789.293 167.819 791.469 Q169.67 793.622 172.819 793.622 Q175.967 793.622 177.795 791.469 Q179.647 789.293 179.647 785.566 Q179.647 781.817 177.795 779.664 Q175.967 777.511 172.819 777.511 M182.101 762.858 L182.101 767.118 Q180.342 766.284 178.536 765.844 Q176.754 765.405 174.994 765.405 Q170.365 765.405 167.911 768.53 Q165.481 771.655 165.133 777.974 Q166.499 775.96 168.559 774.895 Q170.619 773.807 173.096 773.807 Q178.305 773.807 181.314 776.979 Q184.346 780.127 184.346 785.566 Q184.346 790.891 181.198 794.108 Q178.05 797.326 172.819 797.326 Q166.823 797.326 163.652 792.742 Q160.481 788.136 160.481 779.409 Q160.481 771.215 164.37 766.354 Q168.258 761.469 174.809 761.469 Q176.569 761.469 178.351 761.817 Q180.156 762.164 182.101 762.858 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M127.263 583.355 Q123.652 583.355 121.823 586.92 Q120.018 590.461 120.018 597.591 Q120.018 604.697 121.823 608.262 Q123.652 611.804 127.263 611.804 Q130.897 611.804 132.703 608.262 Q134.532 604.697 134.532 597.591 Q134.532 590.461 132.703 586.92 Q130.897 583.355 127.263 583.355 M127.263 579.651 Q133.073 579.651 136.129 584.258 Q139.208 588.841 139.208 597.591 Q139.208 606.318 136.129 610.924 Q133.073 615.508 127.263 615.508 Q121.453 615.508 118.374 610.924 Q115.319 606.318 115.319 597.591 Q115.319 588.841 118.374 584.258 Q121.453 579.651 127.263 579.651 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M147.425 608.957 L152.309 608.957 L152.309 614.836 L147.425 614.836 L147.425 608.957 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M172.494 598.424 Q169.161 598.424 167.24 600.207 Q165.342 601.989 165.342 605.114 Q165.342 608.239 167.24 610.021 Q169.161 611.804 172.494 611.804 Q175.828 611.804 177.749 610.021 Q179.67 608.216 179.67 605.114 Q179.67 601.989 177.749 600.207 Q175.851 598.424 172.494 598.424 M167.819 596.434 Q164.809 595.693 163.12 593.633 Q161.453 591.572 161.453 588.61 Q161.453 584.466 164.393 582.059 Q167.356 579.651 172.494 579.651 Q177.656 579.651 180.596 582.059 Q183.536 584.466 183.536 588.61 Q183.536 591.572 181.846 593.633 Q180.18 595.693 177.194 596.434 Q180.573 597.221 182.448 599.512 Q184.346 601.804 184.346 605.114 Q184.346 610.137 181.268 612.822 Q178.212 615.508 172.494 615.508 Q166.777 615.508 163.698 612.822 Q160.643 610.137 160.643 605.114 Q160.643 601.804 162.541 599.512 Q164.439 597.221 167.819 596.434 M166.106 589.049 Q166.106 591.734 167.772 593.239 Q169.462 594.744 172.494 594.744 Q175.504 594.744 177.194 593.239 Q178.906 591.734 178.906 589.049 Q178.906 586.364 177.194 584.86 Q175.504 583.355 172.494 583.355 Q169.462 583.355 167.772 584.86 Q166.106 586.364 166.106 589.049 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M117.981 429.083 L125.62 429.083 L125.62 402.717 L117.31 404.384 L117.31 400.125 L125.573 398.458 L130.249 398.458 L130.249 429.083 L137.888 429.083 L137.888 433.018 L117.981 433.018 L117.981 429.083 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M147.333 427.138 L152.217 427.138 L152.217 433.018 L147.333 433.018 L147.333 427.138 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M172.402 401.537 Q168.791 401.537 166.962 405.102 Q165.157 408.643 165.157 415.773 Q165.157 422.879 166.962 426.444 Q168.791 429.986 172.402 429.986 Q176.036 429.986 177.842 426.444 Q179.67 422.879 179.67 415.773 Q179.67 408.643 177.842 405.102 Q176.036 401.537 172.402 401.537 M172.402 397.833 Q178.212 397.833 181.268 402.439 Q184.346 407.023 184.346 415.773 Q184.346 424.5 181.268 429.106 Q178.212 433.689 172.402 433.689 Q166.592 433.689 163.513 429.106 Q160.458 424.5 160.458 415.773 Q160.458 407.023 163.513 402.439 Q166.592 397.833 172.402 397.833 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M119.578 247.265 L127.217 247.265 L127.217 220.899 L118.907 222.566 L118.907 218.307 L127.171 216.64 L131.847 216.64 L131.847 247.265 L139.485 247.265 L139.485 251.2 L119.578 251.2 L119.578 247.265 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M148.93 245.32 L153.814 245.32 L153.814 251.2 L148.93 251.2 L148.93 245.32 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M168.027 247.265 L184.346 247.265 L184.346 251.2 L162.402 251.2 L162.402 247.265 Q165.064 244.51 169.647 239.88 Q174.254 235.228 175.434 233.885 Q177.68 231.362 178.559 229.626 Q179.462 227.867 179.462 226.177 Q179.462 223.422 177.518 221.686 Q175.596 219.95 172.494 219.95 Q170.295 219.95 167.842 220.714 Q165.411 221.478 162.633 223.029 L162.633 218.307 Q165.457 217.172 167.911 216.594 Q170.365 216.015 172.402 216.015 Q177.772 216.015 180.967 218.7 Q184.161 221.385 184.161 225.876 Q184.161 228.006 183.351 229.927 Q182.564 231.825 180.457 234.418 Q179.879 235.089 176.777 238.306 Q173.675 241.501 168.027 247.265 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M23.6877 854.956 L60.6406 854.956 L60.6406 847.189 Q60.6406 837.354 56.1846 832.803 Q51.7286 828.22 42.1164 828.22 Q32.5679 828.22 28.1437 832.803 Q23.6877 837.354 23.6877 847.189 L23.6877 854.956 M18.4042 861.385 L18.4042 848.176 Q18.4042 834.363 24.1651 827.901 Q29.8943 821.44 42.1164 821.44 Q54.4022 821.44 60.1632 827.933 Q65.9242 834.426 65.9242 848.176 L65.9242 861.385 L18.4042 861.385 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M46.6361 780.954 L49.5006 780.954 L49.5006 807.881 Q55.5481 807.499 58.7309 804.253 Q61.8819 800.974 61.8819 795.15 Q61.8819 791.776 61.0544 788.625 Q60.2269 785.442 58.5718 782.323 L64.1099 782.323 Q65.4467 785.474 66.147 788.784 Q66.8472 792.094 66.8472 795.5 Q66.8472 804.03 61.8819 809.027 Q56.9167 813.992 48.4503 813.992 Q39.6974 813.992 34.5731 809.282 Q29.4168 804.539 29.4168 796.518 Q29.4168 789.325 34.0638 785.156 Q38.6789 780.954 46.6361 780.954 M44.9173 786.811 Q40.1112 786.874 37.2466 789.516 Q34.3821 792.126 34.3821 796.455 Q34.3821 801.356 37.1512 804.316 Q39.9202 807.245 44.9492 807.69 L44.9173 786.811 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M44.4081 741.71 L65.9242 741.71 L65.9242 747.566 L44.599 747.566 Q39.5383 747.566 37.0238 749.539 Q34.5094 751.513 34.5094 755.46 Q34.5094 760.202 37.5331 762.939 Q40.5568 765.677 45.7767 765.677 L65.9242 765.677 L65.9242 771.565 L30.2762 771.565 L30.2762 765.677 L35.8144 765.677 Q32.5997 763.576 31.0083 760.743 Q29.4168 757.879 29.4168 754.155 Q29.4168 748.012 33.2363 744.861 Q37.0238 741.71 44.4081 741.71 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M31.3265 707.303 L36.8647 707.303 Q35.5916 709.786 34.955 712.459 Q34.3184 715.133 34.3184 717.997 Q34.3184 722.358 35.6552 724.554 Q36.992 726.718 39.6656 726.718 Q41.7026 726.718 42.8803 725.159 Q44.0261 723.599 45.0765 718.889 L45.5221 716.883 Q46.8589 710.645 49.3097 708.035 Q51.7286 705.393 56.0891 705.393 Q61.0544 705.393 63.9508 709.34 Q66.8472 713.255 66.8472 720.13 Q66.8472 722.994 66.2743 726.114 Q65.7332 729.201 64.6192 732.639 L58.5718 732.639 Q60.2587 729.392 61.118 726.241 Q61.9456 723.09 61.9456 720.003 Q61.9456 715.865 60.5451 713.637 Q59.1129 711.409 56.5347 711.409 Q54.1476 711.409 52.8745 713.032 Q51.6013 714.624 50.4237 720.066 L49.9462 722.103 Q48.8004 727.546 46.4451 729.965 Q44.058 732.384 39.9202 732.384 Q34.8913 732.384 32.1541 728.819 Q29.4168 725.254 29.4168 718.698 Q29.4168 715.451 29.8943 712.587 Q30.3717 709.722 31.3265 707.303 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M30.2762 696.068 L30.2762 690.211 L65.9242 690.211 L65.9242 696.068 L30.2762 696.068 M16.399 696.068 L16.399 690.211 L23.815 690.211 L23.815 696.068 L16.399 696.068 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M20.1547 672.164 L30.2762 672.164 L30.2762 660.101 L34.8277 660.101 L34.8277 672.164 L54.1794 672.164 Q58.5399 672.164 59.7813 670.987 Q61.0226 669.777 61.0226 666.117 L61.0226 660.101 L65.9242 660.101 L65.9242 666.117 Q65.9242 672.896 63.4097 675.474 Q60.8634 678.053 54.1794 678.053 L34.8277 678.053 L34.8277 682.349 L30.2762 682.349 L30.2762 678.053 L20.1547 678.053 L20.1547 672.164 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M69.2343 637.567 Q75.6 640.049 77.5416 642.405 Q79.4831 644.76 79.4831 648.707 L79.4831 653.385 L74.5815 653.385 L74.5815 649.948 Q74.5815 647.529 73.4357 646.192 Q72.2899 644.855 68.0248 643.232 L65.3512 642.182 L30.2762 656.6 L30.2762 650.394 L58.158 639.254 L30.2762 628.114 L30.2762 621.907 L69.2343 637.567 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M815.099 18.8205 L815.099 41.5461 L825.388 41.5461 Q831.1 41.5461 834.219 38.5889 Q837.338 35.6318 837.338 30.163 Q837.338 24.7348 834.219 21.7777 Q831.1 18.8205 825.388 18.8205 L815.099 18.8205 M806.916 12.096 L825.388 12.096 Q835.556 12.096 840.741 16.714 Q845.967 21.2916 845.967 30.163 Q845.967 39.1155 840.741 43.6931 Q835.556 48.2706 825.388 48.2706 L815.099 48.2706 L815.099 72.576 L806.916 72.576 L806.916 12.096 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M871.245 32.4315 Q865.249 32.4315 861.765 37.1306 Q858.282 41.7891 858.282 49.9314 Q858.282 58.0738 861.725 62.7728 Q865.209 67.4314 871.245 67.4314 Q877.199 67.4314 880.683 62.7323 Q884.167 58.0333 884.167 49.9314 Q884.167 41.8701 880.683 37.1711 Q877.199 32.4315 871.245 32.4315 M871.245 26.1121 Q880.967 26.1121 886.516 32.4315 Q892.066 38.7509 892.066 49.9314 Q892.066 61.0714 886.516 67.4314 Q880.967 73.7508 871.245 73.7508 Q861.482 73.7508 855.932 67.4314 Q850.423 61.0714 850.423 49.9314 Q850.423 38.7509 855.932 32.4315 Q861.482 26.1121 871.245 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M933.345 28.5427 L933.345 35.5912 Q930.185 33.9709 926.782 33.1607 Q923.38 32.3505 919.734 32.3505 Q914.184 32.3505 911.389 34.0519 Q908.634 35.7533 908.634 39.156 Q908.634 41.7486 910.619 43.2475 Q912.604 44.7058 918.6 46.0426 L921.152 46.6097 Q929.091 48.3111 932.413 51.4303 Q935.775 54.509 935.775 60.0587 Q935.775 66.3781 930.752 70.0644 Q925.77 73.7508 917.02 73.7508 Q913.374 73.7508 909.404 73.0216 Q905.475 72.3329 901.1 70.9151 L901.1 63.2184 Q905.232 65.3654 909.242 66.4591 Q913.252 67.5124 917.182 67.5124 Q922.448 67.5124 925.284 65.73 Q928.119 63.9071 928.119 60.6258 Q928.119 57.5877 926.053 55.9673 Q924.028 54.3469 917.101 52.8481 L914.508 52.2405 Q907.581 50.7821 904.502 47.7845 Q901.424 44.7463 901.424 39.4801 Q901.424 33.0797 905.961 29.5959 Q910.498 26.1121 918.843 26.1121 Q922.975 26.1121 926.62 26.7198 Q930.266 27.3274 933.345 28.5427 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M955.017 14.324 L955.017 27.2059 L970.37 27.2059 L970.37 32.9987 L955.017 32.9987 L955.017 57.6282 Q955.017 63.1779 956.516 64.7578 Q958.055 66.3376 962.714 66.3376 L970.37 66.3376 L970.37 72.576 L962.714 72.576 Q954.085 72.576 950.804 69.3758 Q947.523 66.1351 947.523 57.6282 L947.523 32.9987 L942.054 32.9987 L942.054 27.2059 L947.523 27.2059 L947.523 14.324 L955.017 14.324 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1018.98 48.0275 L1018.98 51.6733 L984.71 51.6733 Q985.196 59.3701 989.328 63.421 Q993.501 67.4314 1000.91 67.4314 Q1005.21 67.4314 1009.22 66.3781 Q1013.27 65.3249 1017.24 63.2184 L1017.24 70.267 Q1013.23 71.9684 1009.02 72.8596 Q1004.8 73.7508 1000.47 73.7508 Q989.612 73.7508 983.252 67.4314 Q976.933 61.1119 976.933 50.3365 Q976.933 39.1965 982.928 32.6746 Q988.964 26.1121 999.172 26.1121 Q1008.33 26.1121 1013.63 32.0264 Q1018.98 37.9003 1018.98 48.0275 M1011.53 45.84 Q1011.45 39.7232 1008.08 36.0774 Q1004.76 32.4315 999.253 32.4315 Q993.015 32.4315 989.247 35.9558 Q985.521 39.4801 984.953 45.8805 L1011.53 45.84 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1057.51 34.1734 Q1056.25 33.4443 1054.75 33.1202 Q1053.29 32.7556 1051.51 32.7556 Q1045.19 32.7556 1041.79 36.8875 Q1038.43 40.9789 1038.43 48.6757 L1038.43 72.576 L1030.93 72.576 L1030.93 27.2059 L1038.43 27.2059 L1038.43 34.2544 Q1040.77 30.1225 1044.54 28.1376 Q1048.31 26.1121 1053.7 26.1121 Q1054.47 26.1121 1055.4 26.2337 Q1056.33 26.3147 1057.46 26.5172 L1057.51 34.1734 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1065.32 27.2059 L1072.78 27.2059 L1072.78 72.576 L1065.32 72.576 L1065.32 27.2059 M1065.32 9.54393 L1072.78 9.54393 L1072.78 18.9825 L1065.32 18.9825 L1065.32 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1105.95 32.4315 Q1099.96 32.4315 1096.47 37.1306 Q1092.99 41.7891 1092.99 49.9314 Q1092.99 58.0738 1096.43 62.7728 Q1099.92 67.4314 1105.95 67.4314 Q1111.91 67.4314 1115.39 62.7323 Q1118.88 58.0333 1118.88 49.9314 Q1118.88 41.8701 1115.39 37.1711 Q1111.91 32.4315 1105.95 32.4315 M1105.95 26.1121 Q1115.68 26.1121 1121.23 32.4315 Q1126.78 38.7509 1126.78 49.9314 Q1126.78 61.0714 1121.23 67.4314 Q1115.68 73.7508 1105.95 73.7508 Q1096.19 73.7508 1090.64 67.4314 Q1085.13 61.0714 1085.13 49.9314 Q1085.13 38.7509 1090.64 32.4315 Q1096.19 26.1121 1105.95 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1165.42 34.1734 Q1164.17 33.4443 1162.67 33.1202 Q1161.21 32.7556 1159.43 32.7556 Q1153.11 32.7556 1149.7 36.8875 Q1146.34 40.9789 1146.34 48.6757 L1146.34 72.576 L1138.85 72.576 L1138.85 27.2059 L1146.34 27.2059 L1146.34 34.2544 Q1148.69 30.1225 1152.46 28.1376 Q1156.23 26.1121 1161.61 26.1121 Q1162.38 26.1121 1163.31 26.2337 Q1164.25 26.3147 1165.38 26.5172 L1165.42 34.1734 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1208.12 18.8205 L1208.12 65.8515 L1218 65.8515 Q1230.52 65.8515 1236.31 60.1802 Q1242.15 54.509 1242.15 42.2752 Q1242.15 30.1225 1236.31 24.4918 Q1230.52 18.8205 1218 18.8205 L1208.12 18.8205 M1199.93 12.096 L1216.75 12.096 Q1234.33 12.096 1242.55 19.4281 Q1250.77 26.7198 1250.77 42.2752 Q1250.77 57.9117 1242.51 65.2439 Q1234.25 72.576 1216.75 72.576 L1199.93 72.576 L1199.93 12.096 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1263.49 27.2059 L1270.95 27.2059 L1270.95 72.576 L1263.49 72.576 L1263.49 27.2059 M1263.49 9.54393 L1270.95 9.54393 L1270.95 18.9825 L1263.49 18.9825 L1263.49 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1315.47 28.5427 L1315.47 35.5912 Q1312.31 33.9709 1308.9 33.1607 Q1305.5 32.3505 1301.86 32.3505 Q1296.31 32.3505 1293.51 34.0519 Q1290.76 35.7533 1290.76 39.156 Q1290.76 41.7486 1292.74 43.2475 Q1294.73 44.7058 1300.72 46.0426 L1303.27 46.6097 Q1311.21 48.3111 1314.53 51.4303 Q1317.9 54.509 1317.9 60.0587 Q1317.9 66.3781 1312.87 70.0644 Q1307.89 73.7508 1299.14 73.7508 Q1295.5 73.7508 1291.53 73.0216 Q1287.6 72.3329 1283.22 70.9151 L1283.22 63.2184 Q1287.35 65.3654 1291.36 66.4591 Q1295.37 67.5124 1299.3 67.5124 Q1304.57 67.5124 1307.41 65.73 Q1310.24 63.9071 1310.24 60.6258 Q1310.24 57.5877 1308.18 55.9673 Q1306.15 54.3469 1299.22 52.8481 L1296.63 52.2405 Q1289.7 50.7821 1286.62 47.7845 Q1283.55 44.7463 1283.55 39.4801 Q1283.55 33.0797 1288.08 29.5959 Q1292.62 26.1121 1300.96 26.1121 Q1305.1 26.1121 1308.74 26.7198 Q1312.39 27.3274 1315.47 28.5427 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1337.14 14.324 L1337.14 27.2059 L1352.49 27.2059 L1352.49 32.9987 L1337.14 32.9987 L1337.14 57.6282 Q1337.14 63.1779 1338.64 64.7578 Q1340.18 66.3376 1344.84 66.3376 L1352.49 66.3376 L1352.49 72.576 L1344.84 72.576 Q1336.21 72.576 1332.93 69.3758 Q1329.64 66.1351 1329.64 57.6282 L1329.64 32.9987 L1324.18 32.9987 L1324.18 27.2059 L1329.64 27.2059 L1329.64 14.324 L1337.14 14.324 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1388.59 34.1734 Q1387.33 33.4443 1385.83 33.1202 Q1384.37 32.7556 1382.59 32.7556 Q1376.27 32.7556 1372.87 36.8875 Q1369.51 40.9789 1369.51 48.6757 L1369.51 72.576 L1362.01 72.576 L1362.01 27.2059 L1369.51 27.2059 L1369.51 34.2544 Q1371.86 30.1225 1375.62 28.1376 Q1379.39 26.1121 1384.78 26.1121 Q1385.55 26.1121 1386.48 26.2337 Q1387.41 26.3147 1388.54 26.5172 L1388.59 34.1734 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1396.4 27.2059 L1403.86 27.2059 L1403.86 72.576 L1396.4 72.576 L1396.4 27.2059 M1396.4 9.54393 L1403.86 9.54393 L1403.86 18.9825 L1396.4 18.9825 L1396.4 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1452.02 49.9314 Q1452.02 41.7081 1448.62 37.0496 Q1445.26 32.3505 1439.34 32.3505 Q1433.43 32.3505 1430.03 37.0496 Q1426.66 41.7081 1426.66 49.9314 Q1426.66 58.1548 1430.03 62.8538 Q1433.43 67.5124 1439.34 67.5124 Q1445.26 67.5124 1448.62 62.8538 Q1452.02 58.1548 1452.02 49.9314 M1426.66 34.0924 Q1429.01 30.0415 1432.58 28.0971 Q1436.18 26.1121 1441.17 26.1121 Q1449.43 26.1121 1454.57 32.6746 Q1459.76 39.2371 1459.76 49.9314 Q1459.76 60.6258 1454.57 67.1883 Q1449.43 73.7508 1441.17 73.7508 Q1436.18 73.7508 1432.58 71.8063 Q1429.01 69.8214 1426.66 65.7705 L1426.66 72.576 L1419.17 72.576 L1419.17 9.54393 L1426.66 9.54393 L1426.66 34.0924 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1471.35 54.671 L1471.35 27.2059 L1478.8 27.2059 L1478.8 54.3874 Q1478.8 60.8284 1481.31 64.0691 Q1483.82 67.2693 1488.85 67.2693 Q1494.88 67.2693 1498.36 63.421 Q1501.89 59.5726 1501.89 52.9291 L1501.89 27.2059 L1509.34 27.2059 L1509.34 72.576 L1501.89 72.576 L1501.89 65.6084 Q1499.18 69.7404 1495.57 71.7658 Q1492.01 73.7508 1487.27 73.7508 Q1479.45 73.7508 1475.4 68.8897 Q1471.35 64.0286 1471.35 54.671 M1490.1 26.1121 L1490.1 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1532.07 14.324 L1532.07 27.2059 L1547.42 27.2059 L1547.42 32.9987 L1532.07 32.9987 L1532.07 57.6282 Q1532.07 63.1779 1533.57 64.7578 Q1535.11 66.3376 1539.77 66.3376 L1547.42 66.3376 L1547.42 72.576 L1539.77 72.576 Q1531.14 72.576 1527.86 69.3758 Q1524.57 66.1351 1524.57 57.6282 L1524.57 32.9987 L1519.11 32.9987 L1519.11 27.2059 L1524.57 27.2059 L1524.57 14.324 L1532.07 14.324 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1557.22 27.2059 L1564.68 27.2059 L1564.68 72.576 L1557.22 72.576 L1557.22 27.2059 M1557.22 9.54393 L1564.68 9.54393 L1564.68 18.9825 L1557.22 18.9825 L1557.22 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1597.86 32.4315 Q1591.86 32.4315 1588.38 37.1306 Q1584.89 41.7891 1584.89 49.9314 Q1584.89 58.0738 1588.34 62.7728 Q1591.82 67.4314 1597.86 67.4314 Q1603.81 67.4314 1607.29 62.7323 Q1610.78 58.0333 1610.78 49.9314 Q1610.78 41.8701 1607.29 37.1711 Q1603.81 32.4315 1597.86 32.4315 M1597.86 26.1121 Q1607.58 26.1121 1613.13 32.4315 Q1618.68 38.7509 1618.68 49.9314 Q1618.68 61.0714 1613.13 67.4314 Q1607.58 73.7508 1597.86 73.7508 Q1588.09 73.7508 1582.54 67.4314 Q1577.03 61.0714 1577.03 49.9314 Q1577.03 38.7509 1582.54 32.4315 Q1588.09 26.1121 1597.86 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1668.75 45.1919 L1668.75 72.576 L1661.29 72.576 L1661.29 45.4349 Q1661.29 38.994 1658.78 35.7938 Q1656.27 32.5936 1651.25 32.5936 Q1645.21 32.5936 1641.73 36.4419 Q1638.24 40.2903 1638.24 46.9338 L1638.24 72.576 L1630.75 72.576 L1630.75 27.2059 L1638.24 27.2059 L1638.24 34.2544 Q1640.92 30.163 1644.52 28.1376 Q1648.17 26.1121 1652.91 26.1121 Q1660.73 26.1121 1664.74 30.9732 Q1668.75 35.7938 1668.75 45.1919 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip432)" style="stroke:#80c4ac; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="276.581,1324.83 286.242,1324.83 295.903,1324.83 305.564,1324.82 315.224,1324.81 324.885,1324.78 334.546,1324.72 344.207,1324.65 353.868,1324.57 363.528,1324.5 373.189,1324.44 382.85,1324.35 392.511,1324.21 402.172,1323.99 411.832,1323.72 421.493,1323.48 431.154,1323.31 440.815,1323.21 450.476,1323.13 460.136,1323.05 469.797,1322.98 479.458,1322.97 489.119,1322.94 498.78,1322.79 508.441,1322.44 518.101,1321.87 527.762,1321.16 537.423,1320.36 547.084,1319.48 556.745,1318.46 566.405,1317.24 576.066,1315.71 585.727,1313.81 595.388,1311.56 605.049,1309.07 614.709,1306.42 624.37,1303.62 634.031,1300.57 643.692,1297.21 653.353,1293.54 663.013,1289.59 672.674,1285.36 682.335,1280.78 691.996,1275.77 701.657,1270.15 711.317,1263.78 720.978,1256.63 730.639,1248.74 740.3,1239.76 749.961,1227.65 759.621,1206.31 769.282,1163.35 778.943,1084.07 788.604,967.125 798.265,842.484 807.925,764.168 817.586,769.788 827.247,845.777 836.908,940.306 846.569,1007.85 856.229,1035.47 865.89,1034.25 875.551,1019.1 885.212,998.565 894.873,975.42 904.533,950.226 914.194,923.429 923.855,895.801 933.516,868.27 943.177,841.542 952.837,815.674 962.498,789.918 972.159,762.996 981.82,733.703 991.481,701.647 1001.14,667.891 1010.8,634.84 1020.46,605.012 1030.12,579.33 1039.78,556.241 1049.45,532.192 1059.11,503.084 1068.77,466.319 1078.43,422.934 1088.09,378.181 1097.75,338.949 1107.41,309.305 1117.07,288.106 1126.73,271.046 1136.39,254.918 1146.05,239.735 1155.71,226.909 1165.38,216.101 1175.04,204.772 1184.7,191.14 1194.36,176.731 1204.02,165.187 1213.68,159.062 1223.34,158.463 1233,161.981 1242.66,167.938 1252.32,175.317 1261.98,184.281 1271.64,195.542 1281.3,209.237 1290.97,224.928 1300.63,242.408 1310.29,261.73 1319.95,282.596 1329.61,304.346 1339.27,326.56 1348.93,349.398 1358.59,373.337 1368.25,398.714 1377.91,425.529 1387.57,453.666 1397.23,483.165 1406.9,514.002 1416.56,545.564 1426.22,576.765 1435.88,606.9 1445.54,636.095 1455.2,664.806 1464.86,693.377 1474.52,722.352 1484.18,752.686 1493.84,785.001 1503.5,818.568 1513.16,851.425 1522.82,881.753 1532.49,909.071 1542.15,934.09 1551.81,957.764 1561.47,980.795 1571.13,1003.76 1580.79,1027.11 1590.45,1050.75 1600.11,1073.91 1609.77,1095.52 1619.43,1114.83 1629.09,1131.81 1638.75,1147.18 1648.42,1161.78 1658.08,1175.83 1667.74,1188.87 1677.4,1200.42 1687.06,1210.44 1696.72,1219.32 1706.38,1227.57 1716.04,1235.68 1725.7,1243.94 1735.36,1252.33 1745.02,1260.47 1754.68,1267.95 1764.34,1274.63 1774.01,1280.63 1783.67,1286.05 1793.33,1290.8 1802.99,1294.82 1812.65,1298.2 1822.31,1301.2 1831.97,1303.99 1841.63,1306.59 1851.29,1309.02 1860.95,1311.34 1870.61,1313.58 1880.27,1315.63 1889.94,1317.32 1899.6,1318.55 1909.26,1319.42 1918.92,1320.09 1928.58,1320.64 1938.24,1321.08 1947.9,1321.41 1957.56,1321.7 1967.22,1322.03 1976.88,1322.44 1986.54,1322.88 1996.2,1323.27 2005.86,1323.55 2015.53,1323.7 2025.19,1323.73 2034.85,1323.71 2044.51,1323.7 2054.17,1323.74 2063.83,1323.85 2073.49,1324 2083.15,1324.14 2092.81,1324.25 2102.47,1324.32 2112.13,1324.4 2121.79,1324.49 2131.46,1324.6 2141.12,1324.7 2150.78,1324.77 2160.44,1324.81 2170.1,1324.82 2179.76,1324.83 2189.42,1324.83 2199.08,1324.83 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#ffc0cb; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1514.22,2596.17 1514.22,-1112.88 "></polyline>
<path clip-path="url(#clip430)" d="M1799.28 320.204 L2188.83 320.204 L2188.83 164.684 L1799.28 164.684  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1799.28,320.204 2188.83,320.204 2188.83,164.684 1799.28,164.684 1799.28,320.204 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#80c4ac; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1821.92,216.524 1957.78,216.524 "></polyline>
<path clip-path="url(#clip430)" d="M1994.26 236.211 Q1992.46 240.841 1990.75 242.253 Q1989.03 243.665 1986.16 243.665 L1982.76 243.665 L1982.76 240.1 L1985.26 240.1 Q1987.02 240.1 1987.99 239.267 Q1988.96 238.433 1990.14 235.331 L1990.91 233.387 L1980.42 207.878 L1984.94 207.878 L1993.04 228.156 L2001.14 207.878 L2005.65 207.878 L1994.26 236.211 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M2012.94 229.869 L2020.58 229.869 L2020.58 203.503 L2012.27 205.17 L2012.27 200.91 L2020.54 199.244 L2025.21 199.244 L2025.21 229.869 L2032.85 229.869 L2032.85 233.804 L2012.94 233.804 L2012.94 229.869 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip430)" style="stroke:#ffc0cb; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1821.92,268.364 1957.78,268.364 "></polyline>
<path clip-path="url(#clip430)" d="M2005.07 259.718 L1995.7 272.334 L2005.56 285.644 L2000.54 285.644 L1992.99 275.459 L1985.45 285.644 L1980.42 285.644 L1990.49 272.079 L1981.28 259.718 L1986.3 259.718 L1993.18 268.954 L2000.05 259.718 L2005.07 259.718 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M2029.24 251.084 L2041.81 263.977 L2037.16 263.977 L2026.97 254.834 L2016.79 263.977 L2012.13 263.977 L2024.7 251.084 L2029.24 251.084 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M2069.13 256.778 L2060.82 261.269 L2069.13 265.783 L2067.78 268.051 L2060 263.352 L2060 272.079 L2057.37 272.079 L2057.37 263.352 L2049.59 268.051 L2048.25 265.783 L2056.56 261.269 L2048.25 256.778 L2049.59 254.486 L2057.37 259.186 L2057.37 250.459 L2060 250.459 L2060 259.186 L2067.78 254.486 L2069.13 256.778 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M2090.63 264.116 L2120.31 264.116 L2120.31 268.005 L2090.63 268.005 L2090.63 264.116 M2090.63 273.56 L2120.31 273.56 L2120.31 277.496 L2090.63 277.496 L2090.63 273.56 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M2146.28 281.709 L2153.92 281.709 L2153.92 255.343 L2145.61 257.01 L2145.61 252.75 L2153.87 251.084 L2158.55 251.084 L2158.55 281.709 L2166.18 281.709 L2166.18 285.644 L2146.28 285.644 L2146.28 281.709 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="注（$x^*=0$ でのアトムについて）">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
注（<span class="math inline">\(x^*=0\)</span> でのアトムについて）
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math inline">\(x^*=0\)</span> に原子が存在する．</p>
<p>ここでは密度関数は滑らかに見えるが，実際には <span class="math inline">\(x^*=0\)</span> で不連続である．</p>
<p>これは，計算の都合上，<span class="math inline">\(\delta_0\)</span> を <span class="math inline">\(\mathrm{N}(0,0.005)\)</span> で代用したためである．</p>
</div>
</div>
</div>
</section>
<section id="map-推定量" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="map-推定量"><span class="header-section-number">1.3</span> MAP 推定量</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定義 (maximum a posterior estimator)">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定義 (maximum a posterior estimator)
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[
\widehat{x}:=\mathop{\mathrm{arg\,max}}_{x\in\mathbb{R}}\;p(x|y_1,\cdots,y_n)
\]</span> で定まる推定量 <span class="math inline">\(\mathbb{R}^n\to\mathbb{R}\)</span> を <strong>MAP 推定量</strong> という．</p>
</div>
</div>
<p>例 <a href="#sec-example" class="quarto-xref">1.2</a> などをはじめ，ほとんどの場面では良い推定量を与え，多くの場合の最初のチョイスとして適しているかもしれない．</p>
<p>しかし，例 <a href="#sec-example" class="quarto-xref">1.2</a> をさらに変形することで，次のような事後分布が得られる状況は容易に想像がつく：</p>
<div id="cell-fig-1" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">f</span>(x)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">-</span><span class="fl">1.8</span> <span class="op">&lt;</span> x <span class="op">&lt;</span> <span class="op">-</span><span class="fl">1.6</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">2.5</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elseif</span> <span class="fl">0</span> <span class="op">&lt;</span> x <span class="op">&lt;</span> <span class="fl">1.5</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">1</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">0</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, size<span class="op">=</span>(<span class="fl">600</span>, <span class="fl">400</span>), legend<span class="op">=</span><span class="cn">false</span>, color<span class="op">=</span><span class="st">"#80c4ac"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-1" class="cell-output cell-output-display quarto-figure quarto-figure-center quarto-float anchored" data-execution_count="7">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewbox="0 0 2400 1600">
<defs>
  <clippath id="clip560">
    <rect x="0" y="0" width="2400" height="1600"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip560)" d="M0 1600 L2400 1600 L2400 8.88178e-14 L0 8.88178e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip561">
    <rect x="480" y="0" width="1681" height="1600"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip560)" d="M156.112 1486.45 L2352.76 1486.45 L2352.76 47.2441 L156.112 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip562">
    <rect x="156" y="47" width="2198" height="1440"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.281,1486.45 218.281,47.2441 "></polyline>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="736.358,1486.45 736.358,47.2441 "></polyline>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1254.43,1486.45 1254.43,47.2441 "></polyline>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1772.51,1486.45 1772.51,47.2441 "></polyline>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2290.59,1486.45 2290.59,47.2441 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,1486.45 2352.76,1486.45 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.281,1486.45 218.281,1467.55 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="736.358,1486.45 736.358,1467.55 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1254.43,1486.45 1254.43,1467.55 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1772.51,1486.45 1772.51,1467.55 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2290.59,1486.45 2290.59,1467.55 "></polyline>
<path clip-path="url(#clip560)" d="M188.224 1532.02 L217.899 1532.02 L217.899 1535.95 L188.224 1535.95 L188.224 1532.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M232.02 1544.91 L248.339 1544.91 L248.339 1548.85 L226.395 1548.85 L226.395 1544.91 Q229.057 1542.16 233.64 1537.53 Q238.246 1532.88 239.427 1531.53 Q241.672 1529.01 242.552 1527.27 Q243.455 1525.51 243.455 1523.82 Q243.455 1521.07 241.51 1519.33 Q239.589 1517.6 236.487 1517.6 Q234.288 1517.6 231.834 1518.36 Q229.404 1519.13 226.626 1520.68 L226.626 1515.95 Q229.45 1514.82 231.904 1514.24 Q234.358 1513.66 236.395 1513.66 Q241.765 1513.66 244.959 1516.35 Q248.154 1519.03 248.154 1523.52 Q248.154 1525.65 247.344 1527.57 Q246.557 1529.47 244.45 1532.07 Q243.871 1532.74 240.77 1535.95 Q237.668 1539.15 232.02 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M706.115 1532.02 L735.791 1532.02 L735.791 1535.95 L706.115 1535.95 L706.115 1532.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M746.693 1544.91 L754.332 1544.91 L754.332 1518.55 L746.022 1520.21 L746.022 1515.95 L754.286 1514.29 L758.962 1514.29 L758.962 1544.91 L766.601 1544.91 L766.601 1548.85 L746.693 1548.85 L746.693 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M1254.43 1517.37 Q1250.82 1517.37 1248.99 1520.93 Q1247.19 1524.47 1247.19 1531.6 Q1247.19 1538.71 1248.99 1542.27 Q1250.82 1545.82 1254.43 1545.82 Q1258.07 1545.82 1259.87 1542.27 Q1261.7 1538.71 1261.7 1531.6 Q1261.7 1524.47 1259.87 1520.93 Q1258.07 1517.37 1254.43 1517.37 M1254.43 1513.66 Q1260.24 1513.66 1263.3 1518.27 Q1266.38 1522.85 1266.38 1531.6 Q1266.38 1540.33 1263.3 1544.94 Q1260.24 1549.52 1254.43 1549.52 Q1248.62 1549.52 1245.55 1544.94 Q1242.49 1540.33 1242.49 1531.6 Q1242.49 1522.85 1245.55 1518.27 Q1248.62 1513.66 1254.43 1513.66 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M1762.89 1544.91 L1770.53 1544.91 L1770.53 1518.55 L1762.22 1520.21 L1762.22 1515.95 L1770.48 1514.29 L1775.16 1514.29 L1775.16 1544.91 L1782.8 1544.91 L1782.8 1548.85 L1762.89 1548.85 L1762.89 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M2285.24 1544.91 L2301.56 1544.91 L2301.56 1548.85 L2279.61 1548.85 L2279.61 1544.91 Q2282.28 1542.16 2286.86 1537.53 Q2291.47 1532.88 2292.65 1531.53 Q2294.89 1529.01 2295.77 1527.27 Q2296.67 1525.51 2296.67 1523.82 Q2296.67 1521.07 2294.73 1519.33 Q2292.81 1517.6 2289.71 1517.6 Q2287.51 1517.6 2285.05 1518.36 Q2282.62 1519.13 2279.85 1520.68 L2279.85 1515.95 Q2282.67 1514.82 2285.12 1514.24 Q2287.58 1513.66 2289.61 1513.66 Q2294.98 1513.66 2298.18 1516.35 Q2301.37 1519.03 2301.37 1523.52 Q2301.37 1525.65 2300.56 1527.57 Q2299.78 1529.47 2297.67 1532.07 Q2297.09 1532.74 2293.99 1535.95 Q2290.89 1539.15 2285.24 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,1445.72 2352.76,1445.72 "></polyline>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,1174.17 2352.76,1174.17 "></polyline>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,902.62 2352.76,902.62 "></polyline>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,631.072 2352.76,631.072 "></polyline>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,359.524 2352.76,359.524 "></polyline>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,87.9763 2352.76,87.9763 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,1486.45 156.112,47.2441 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,1445.72 175.01,1445.72 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,1174.17 175.01,1174.17 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,902.62 175.01,902.62 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,631.072 175.01,631.072 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,359.524 175.01,359.524 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,87.9763 175.01,87.9763 "></polyline>
<path clip-path="url(#clip560)" d="M62.9365 1431.51 Q59.3254 1431.51 57.4967 1435.08 Q55.6912 1438.62 55.6912 1445.75 Q55.6912 1452.86 57.4967 1456.42 Q59.3254 1459.96 62.9365 1459.96 Q66.5707 1459.96 68.3763 1456.42 Q70.205 1452.86 70.205 1445.75 Q70.205 1438.62 68.3763 1435.08 Q66.5707 1431.51 62.9365 1431.51 M62.9365 1427.81 Q68.7467 1427.81 71.8022 1432.42 Q74.8809 1437 74.8809 1445.75 Q74.8809 1454.48 71.8022 1459.08 Q68.7467 1463.67 62.9365 1463.67 Q57.1264 1463.67 54.0477 1459.08 Q50.9921 1454.48 50.9921 1445.75 Q50.9921 1437 54.0477 1432.42 Q57.1264 1427.81 62.9365 1427.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M83.0984 1457.12 L87.9827 1457.12 L87.9827 1463 L83.0984 1463 L83.0984 1457.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M108.168 1431.51 Q104.557 1431.51 102.728 1435.08 Q100.922 1438.62 100.922 1445.75 Q100.922 1452.86 102.728 1456.42 Q104.557 1459.96 108.168 1459.96 Q111.802 1459.96 113.608 1456.42 Q115.436 1452.86 115.436 1445.75 Q115.436 1438.62 113.608 1435.08 Q111.802 1431.51 108.168 1431.51 M108.168 1427.81 Q113.978 1427.81 117.033 1432.42 Q120.112 1437 120.112 1445.75 Q120.112 1454.48 117.033 1459.08 Q113.978 1463.67 108.168 1463.67 Q102.358 1463.67 99.2789 1459.08 Q96.2234 1454.48 96.2234 1445.75 Q96.2234 1437 99.2789 1432.42 Q102.358 1427.81 108.168 1427.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M63.9319 1159.97 Q60.3208 1159.97 58.4921 1163.53 Q56.6865 1167.07 56.6865 1174.2 Q56.6865 1181.31 58.4921 1184.87 Q60.3208 1188.42 63.9319 1188.42 Q67.5661 1188.42 69.3717 1184.87 Q71.2004 1181.31 71.2004 1174.2 Q71.2004 1167.07 69.3717 1163.53 Q67.5661 1159.97 63.9319 1159.97 M63.9319 1156.26 Q69.742 1156.26 72.7976 1160.87 Q75.8763 1165.45 75.8763 1174.2 Q75.8763 1182.93 72.7976 1187.54 Q69.742 1192.12 63.9319 1192.12 Q58.1217 1192.12 55.043 1187.54 Q51.9875 1182.93 51.9875 1174.2 Q51.9875 1165.45 55.043 1160.87 Q58.1217 1156.26 63.9319 1156.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M84.0938 1185.57 L88.978 1185.57 L88.978 1191.45 L84.0938 1191.45 L84.0938 1185.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M99.2095 1156.89 L117.566 1156.89 L117.566 1160.82 L103.492 1160.82 L103.492 1169.3 Q104.51 1168.95 105.529 1168.79 Q106.547 1168.6 107.566 1168.6 Q113.353 1168.6 116.733 1171.77 Q120.112 1174.94 120.112 1180.36 Q120.112 1185.94 116.64 1189.04 Q113.168 1192.12 106.848 1192.12 Q104.672 1192.12 102.404 1191.75 Q100.159 1191.38 97.7511 1190.64 L97.7511 1185.94 Q99.8345 1187.07 102.057 1187.63 Q104.279 1188.18 106.756 1188.18 Q110.76 1188.18 113.098 1186.08 Q115.436 1183.97 115.436 1180.36 Q115.436 1176.75 113.098 1174.64 Q110.76 1172.54 106.756 1172.54 Q104.881 1172.54 103.006 1172.95 Q101.154 1173.37 99.2095 1174.25 L99.2095 1156.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M53.7467 915.965 L61.3856 915.965 L61.3856 889.599 L53.0754 891.266 L53.0754 887.007 L61.3393 885.34 L66.0152 885.34 L66.0152 915.965 L73.654 915.965 L73.654 919.9 L53.7467 919.9 L53.7467 915.965 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M83.0984 914.02 L87.9827 914.02 L87.9827 919.9 L83.0984 919.9 L83.0984 914.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M108.168 888.419 Q104.557 888.419 102.728 891.983 Q100.922 895.525 100.922 902.655 Q100.922 909.761 102.728 913.326 Q104.557 916.868 108.168 916.868 Q111.802 916.868 113.608 913.326 Q115.436 909.761 115.436 902.655 Q115.436 895.525 113.608 891.983 Q111.802 888.419 108.168 888.419 M108.168 884.715 Q113.978 884.715 117.033 889.321 Q120.112 893.905 120.112 902.655 Q120.112 911.381 117.033 915.988 Q113.978 920.571 108.168 920.571 Q102.358 920.571 99.2789 915.988 Q96.2234 911.381 96.2234 902.655 Q96.2234 893.905 99.2789 889.321 Q102.358 884.715 108.168 884.715 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M54.7421 644.417 L62.381 644.417 L62.381 618.051 L54.0708 619.718 L54.0708 615.459 L62.3347 613.792 L67.0106 613.792 L67.0106 644.417 L74.6494 644.417 L74.6494 648.352 L54.7421 648.352 L54.7421 644.417 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M84.0938 642.472 L88.978 642.472 L88.978 648.352 L84.0938 648.352 L84.0938 642.472 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M99.2095 613.792 L117.566 613.792 L117.566 617.727 L103.492 617.727 L103.492 626.199 Q104.51 625.852 105.529 625.69 Q106.547 625.505 107.566 625.505 Q113.353 625.505 116.733 628.676 Q120.112 631.848 120.112 637.264 Q120.112 642.843 116.64 645.945 Q113.168 649.023 106.848 649.023 Q104.672 649.023 102.404 648.653 Q100.159 648.283 97.7511 647.542 L97.7511 642.843 Q99.8345 643.977 102.057 644.533 Q104.279 645.088 106.756 645.088 Q110.76 645.088 113.098 642.982 Q115.436 640.875 115.436 637.264 Q115.436 633.653 113.098 631.547 Q110.76 629.44 106.756 629.44 Q104.881 629.44 103.006 629.857 Q101.154 630.273 99.2095 631.153 L99.2095 613.792 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M56.9643 372.869 L73.2837 372.869 L73.2837 376.804 L51.3393 376.804 L51.3393 372.869 Q54.0014 370.114 58.5847 365.485 Q63.1911 360.832 64.3717 359.489 Q66.617 356.966 67.4967 355.23 Q68.3994 353.471 68.3994 351.781 Q68.3994 349.027 66.455 347.29 Q64.5337 345.554 61.4319 345.554 Q59.2328 345.554 56.7791 346.318 Q54.3486 347.082 51.5708 348.633 L51.5708 343.911 Q54.3949 342.777 56.8486 342.198 Q59.3023 341.619 61.3393 341.619 Q66.7096 341.619 69.9041 344.304 Q73.0985 346.99 73.0985 351.48 Q73.0985 353.61 72.2883 355.531 Q71.5013 357.429 69.3948 360.022 Q68.8161 360.693 65.7143 363.911 Q62.6124 367.105 56.9643 372.869 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M83.0984 370.925 L87.9827 370.925 L87.9827 376.804 L83.0984 376.804 L83.0984 370.925 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M108.168 345.323 Q104.557 345.323 102.728 348.888 Q100.922 352.429 100.922 359.559 Q100.922 366.665 102.728 370.23 Q104.557 373.772 108.168 373.772 Q111.802 373.772 113.608 370.23 Q115.436 366.665 115.436 359.559 Q115.436 352.429 113.608 348.888 Q111.802 345.323 108.168 345.323 M108.168 341.619 Q113.978 341.619 117.033 346.226 Q120.112 350.809 120.112 359.559 Q120.112 368.286 117.033 372.892 Q113.978 377.475 108.168 377.475 Q102.358 377.475 99.2789 372.892 Q96.2234 368.286 96.2234 359.559 Q96.2234 350.809 99.2789 346.226 Q102.358 341.619 108.168 341.619 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M57.9597 101.321 L74.279 101.321 L74.279 105.256 L52.3347 105.256 L52.3347 101.321 Q54.9967 98.5665 59.58 93.9369 Q64.1865 89.2841 65.367 87.9416 Q67.6124 85.4184 68.492 83.6823 Q69.3948 81.9231 69.3948 80.2333 Q69.3948 77.4786 67.4504 75.7425 Q65.5291 74.0064 62.4272 74.0064 Q60.2282 74.0064 57.7745 74.7703 Q55.344 75.5342 52.5662 77.0851 L52.5662 72.3629 Q55.3903 71.2287 57.8439 70.65 Q60.2976 70.0713 62.3347 70.0713 Q67.705 70.0713 70.8994 72.7565 Q74.0939 75.4416 74.0939 79.9323 Q74.0939 82.062 73.2837 83.9832 Q72.4966 85.8814 70.3902 88.474 Q69.8115 89.1453 66.7096 92.3628 Q63.6078 95.5573 57.9597 101.321 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M84.0938 99.3767 L88.978 99.3767 L88.978 105.256 L84.0938 105.256 L84.0938 99.3767 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M99.2095 70.6963 L117.566 70.6963 L117.566 74.6314 L103.492 74.6314 L103.492 83.1036 Q104.51 82.7564 105.529 82.5944 Q106.547 82.4092 107.566 82.4092 Q113.353 82.4092 116.733 85.5805 Q120.112 88.7517 120.112 94.1684 Q120.112 99.747 116.64 102.849 Q113.168 105.928 106.848 105.928 Q104.672 105.928 102.404 105.557 Q100.159 105.187 97.7511 104.446 L97.7511 99.747 Q99.8345 100.881 102.057 101.437 Q104.279 101.992 106.756 101.992 Q110.76 101.992 113.098 99.8859 Q115.436 97.7795 115.436 94.1684 Q115.436 90.5573 113.098 88.4508 Q110.76 86.3443 106.756 86.3443 Q104.881 86.3443 103.006 86.761 Q101.154 87.1777 99.2095 88.0573 L99.2095 70.6963 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip562)" style="stroke:#80c4ac; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.281,1445.72 221.654,1445.72 225.027,1445.72 228.4,1445.72 231.773,1445.72 247.367,1445.72 262.961,1445.72 278.555,1445.72 294.149,1445.72 301.946,1445.72 309.743,1445.72 313.641,1445.72 317.54,1445.72 318.514,1445.72 319.489,1445.72 320.464,1445.72 321.438,1445.72 322.413,87.9763 323.388,87.9763 324.362,87.9763 325.337,87.9763 327.286,87.9763 329.235,87.9763 331.185,87.9763 333.134,87.9763 337.032,87.9763 340.931,87.9763 348.728,87.9763 356.525,87.9763 375.267,87.9763 394.01,87.9763 403.381,87.9763 412.753,87.9763 415.095,87.9763 417.438,87.9763 419.781,87.9763 422.124,87.9763 422.71,87.9763 423.295,87.9763 423.881,87.9763 424.467,87.9763 425.052,87.9763 425.638,1445.72 426.224,1445.72 426.809,1445.72 427.981,1445.72 429.152,1445.72 430.324,1445.72 431.495,1445.72 435.457,1445.72 439.418,1445.72 443.38,1445.72 447.342,1445.72 455.265,1445.72 463.188,1445.72 479.035,1445.72 494.882,1445.72 563.737,1445.72 627.216,1445.72 695.272,1445.72 774.122,1445.72 844.194,1445.72 905.641,1445.72 972.634,1445.72 1040.03,1445.72 1077.28,1445.72 1114.54,1445.72 1149.98,1445.72 1185.43,1445.72 1203.86,1445.72 1222.29,1445.72 1231.5,1445.72 1240.72,1445.72 1243.02,1445.72 1245.32,1445.72 1247.63,1445.72 1249.93,1445.72 1251.08,1445.72 1252.23,1445.72 1252.81,1445.72 1253.39,1445.72 1253.96,1445.72 1254.54,902.62 1255.11,902.62 1255.69,902.62 1256.27,902.62 1256.84,902.62 1257.99,902.62 1259.14,902.62 1263.02,902.62 1266.9,902.62 1270.78,902.62 1274.66,902.62 1282.41,902.62 1290.17,902.62 1305.68,902.62 1321.2,902.62 1396.95,902.62 1466.35,902.62 1530.45,902.62 1595.38,902.62 1668.14,902.62 1734.08,902.62 1809.57,902.62 1879.47,902.62 1913.92,902.62 1948.38,902.62 1965.11,902.62 1981.83,902.62 1990.2,902.62 1998.56,902.62 2006.93,902.62 2015.29,902.62 2019.58,902.62 2023.86,902.62 2026.01,902.62 2028.15,902.62 2029.22,902.62 2030.29,902.62 2030.83,902.62 2031.36,902.62 2031.9,1445.72 2032.44,1445.72 2032.97,1445.72 2033.51,1445.72 2034.04,1445.72 2034.58,1445.72 2035.65,1445.72 2036.72,1445.72 2038.87,1445.72 2041.01,1445.72 2045.3,1445.72 2049.58,1445.72 2066.73,1445.72 2083.88,1445.72 2121.45,1445.72 2159.03,1445.72 2213.61,1445.72 2268.19,1445.72 2279.39,1445.72 2290.59,1445.72 "></polyline>
</svg>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;1
</figcaption>
</figure>
</div>
</div>
</section>
<section id="ベイズ最適推定量" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="ベイズ最適推定量"><span class="header-section-number">1.4</span> ベイズ最適推定量</h3>
<p><a href="#fig-1" class="quarto-xref">図&nbsp;1</a> の状況でも，たしかに１点のみを選ぶならば MAP 推定量で良いかもしれないが，<span class="math inline">\(x\le0\)</span> である確率は <span class="math inline">\(x\ge0\)</span> である確率よりも低いため，この意味では，<span class="math inline">\(x\in[0,3/2]\)</span> の範囲に推定量が収まっていた方が好ましいかもしれない．</p>
<p>推定量 <span class="math inline">\(\widehat{x}_n:\mathbb{R}^n\to\mathbb{R}\)</span> を評価するには，何らかのアプリオリな <strong>損失</strong> の概念が必要である．これを損失関数 <span class="math inline">\(L:\mathbb{R}^2\to\mathbb{R}\)</span> という形で与える．</p>
<p>すると，損失の期待値が計算可能になり，これを <strong>危険</strong> という： <span class="math display">\[
R(\widehat{x}_n):=\operatorname{E}[L(\widehat{x}_n(\boldsymbol{Y}),X)].
\]</span></p>
<p>このリスクを最小化する推定量を <strong>ベイズ最適推定量</strong>，その際のリスクを <strong>ベイズリスク</strong> という．<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<section id="sec-MMSE" class="level4" data-number="1.4.1">
<h4 data-number="1.4.1" class="anchored" data-anchor-id="sec-MMSE"><span class="header-section-number">1.4.1</span> <span class="math inline">\(l^2\)</span>-ベイズ最適推定量</h4>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(L(x,y):=(x-y)^2\)</span> と定める．このとき，<strong>事後平均</strong> がベイズリスクを達成する： <span class="math display">\[
\widehat{x}(\boldsymbol{y}):=\int_\mathbb{R}xp(x|\boldsymbol{y})\,
dx.
\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
<p><a href="#fig-1" class="quarto-xref">図&nbsp;1</a> の場合では，事後平均は約 <span class="math inline">\(0.1\)</span> で，かろうじて正になる．</p>
</section>
<section id="l1-ベイズ最適推定量" class="level4" data-number="1.4.2">
<h4 data-number="1.4.2" class="anchored" data-anchor-id="l1-ベイズ最適推定量"><span class="header-section-number">1.4.2</span> <span class="math inline">\(l^1\)</span>-ベイズ最適推定量</h4>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(L(x,y):=\lvert x-y\rvert\)</span> と定める．このとき，<strong>事後中央値</strong> がベイズリスクを達成する．</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
<p><a href="#fig-1" class="quarto-xref">図&nbsp;1</a> の場合では，事後中央値は <span class="math inline">\(0.5\)</span> となる．大変頑健な推定だと言えるだろう．</p>
</section>
<section id="最適決定規則" class="level4" data-number="1.4.3">
<h4 data-number="1.4.3" class="anchored" data-anchor-id="最適決定規則"><span class="header-section-number">1.4.3</span> 最適決定規則</h4>
<p>今回の誤り訂正符号の文脈の目標は，<span class="math inline">\(x^*\)</span> の復元であることを思い出せば，今回の損失は <span class="math inline">\(L(x,y)=\delta_0(x-y)\)</span> ととり，復号が成功する確率を最大とする推定量が「最良」と言うべきであろう： <span class="math display">\[
R(\widehat{x}_n)=\operatorname{P}[\widehat{x}_n(\boldsymbol{Y})=X]
\]</span></p>
<p>これは結局 MAP 推定量 <span class="math display">\[
\widehat{x}_n:=\mathop{\mathrm{arg\,max}}_{x\in\mathbb{R}}p(x|\boldsymbol{y})
\]</span> で与えられることになる．</p>
</section>
</section>
</section>
<section id="統計物理からの視点" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="統計物理からの視点"><span class="header-section-number">2</span> 統計物理からの視点</h2>
<p>真のシグナル <span class="math inline">\(x^*\in\mathbb{R}\)</span> を，Bayes 事後平均によって点推定する問題を，統計力学の観点から考察する．</p>
<p>次節 <a href="#sec-sparse-vector-denoising" class="quarto-xref">3</a> で，スパースな一般次元のベクトル <span class="math inline">\(x^*\in\mathbb{R}^d\)</span> を復元する問題に拡張する．</p>
<section id="sec-straightforward-identification" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="sec-straightforward-identification"><span class="header-section-number">2.1</span> 事後分布をある物理系の平衡分布と見る</h3>
<p>ベイズの公式 (<a href="#eq-bayes" class="quarto-xref">1</a>) が与える事後分布 <span class="math inline">\(p(x|\boldsymbol{y})\)</span> は，次の Boltzmann-Gibbs 分布として理解できる： <span class="math display">\[
p(x|\boldsymbol{y})=\frac{e^{\log p(\boldsymbol{y}|x)p(x)}}{p(\boldsymbol{y})}
\]</span> <span class="math display">\[
=\frac{e^{-H(x,\boldsymbol{y})}}{Z(\boldsymbol{y})},
\]</span> <span class="math display">\[
H(x,\boldsymbol{y}):=-\log p(\boldsymbol{y}|x)-\log p(x),
\]</span> <span class="math display">\[
Z(\boldsymbol{y}):=p(y).
\]</span></p>
<p>すなわち，Bayes 事後分布 <span class="math inline">\(p(x|\boldsymbol{y})\)</span> は，<span class="math inline">\(\mathbb{R}\times\mathbb{R}^n\)</span> を配位空間に持ち，Hamiltonian <span class="math inline">\(H(x,\boldsymbol{y})\)</span> を持つ正準集団の平衡分布と捉えることができる．</p>
<p>従って，Bayes 事後平均とは，この系に関する熱平均になる．加えて，MAP 推定量とは，この系に関する基底状態となる．</p>
<p>しかし，この系の，物理的な意義どころか，統計的な意義も定かではない．</p>
</section>
<section id="sec-identification" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="sec-identification"><span class="header-section-number">2.2</span> もう一つの見方</h3>
<p>今回，通信路は加法的に Gauss ノイズを加えるものとしたのであった： <span class="math display">\[
p(\boldsymbol{y}|x)d\boldsymbol{y}=\mathrm{N}(x,\sigma^2)^{\otimes n}(d\boldsymbol{y})
\]</span> この場合，前節 <a href="#sec-straightforward-identification" class="quarto-xref">2.1</a> でみた方法の他に，事後分布 <span class="math inline">\(p(x|\boldsymbol{y})\)</span> を次のように理解することもできる： <span class="math display">\[
p(x|\boldsymbol{y})=\frac{e^{-H(x,\boldsymbol{y})}}{Z(\boldsymbol{y})},
\]</span> <span class="math display">\[
H(x,\boldsymbol{y}):=\frac{1}{2\sigma^2}\sum_{i=1}^n(x^2-2xy_i)-\log p(x),
\]</span> <span class="math display">\[
Z(\boldsymbol{y}):=\left(\frac{1}{(2\pi\sigma^2)^{\frac{n}{2}}}\frac{e^{-\frac{\lvert\boldsymbol{y}\rvert^2}{2\sigma^2}}}{p(\boldsymbol{y})}\right)^{-1}.
\]</span></p>
<p>この Hamiltonian <span class="math inline">\(H\)</span> により定まる系の分配関数 <span class="math inline">\(Z(\boldsymbol{y})\)</span> は，情報源 <span class="math inline">\(p(x)\)</span> と Gauss 型通信路 <span class="math inline">\(p(\boldsymbol{y}|x)\)</span> で与えられた観測 <span class="math inline">\(\boldsymbol{y}\)</span> に関する周辺モデル <span class="math inline">\(p(\boldsymbol{y})\)</span> と，完全にランダムなホワイトノイズ <span class="math inline">\(\mathrm{N}(0,\sigma^2)^{\otimes n}\)</span> との尤度比，または <a href="https://ja.wikipedia.org/wiki/ベイズ因子"><strong>ベイズ因子</strong></a> になっている．</p>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="式変形">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
式変形
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math display">\[\begin{align*}
    p(x|\boldsymbol{y})&amp;=p(\boldsymbol{y}|x)\frac{p(x)}{p(\boldsymbol{y})}\\
    &amp;=\frac{p(x)}{p(\boldsymbol{y})}\frac{1}{(2\pi\sigma^2)^{\frac{n}{2}}}e^{-\frac{1}{2\sigma^2}\sum_{i=1}^n(x-y_i)^2}\\
    &amp;=\frac{p(x)}{p(\boldsymbol{y})}\frac{e^{-\frac{1}{2\sigma^2}\sum_{i=1}^ny_i^2}}{(2\pi\sigma^2)^{\frac{n}{2}}}e^{-\frac{1}{2\sigma^2}\sum_{i=1}^n(x^2-2xy_i)}\\
    &amp;=\frac{p(x)e^{-\frac{1}{2\sigma^2}\sum_{i=1}^n(x^2-2xy_i)}}{Z(\boldsymbol{y})}\\
    &amp;=\frac{1}{Z(\boldsymbol{y})}\exp\left(\log p(x)-\frac{1}{2\sigma^2}\sum_{i=1}^n(x^2-2xy_i)\right)
\end{align*}\]</span></p>
</div>
</div>
</div>
<p>さらに，この系 <span class="math inline">\(H\)</span> における自由エントロピーは，<span class="math inline">\(p(\boldsymbol{y})\)</span> と <span class="math inline">\(\mathrm{N}(0,\sigma^2)^{\otimes n}\)</span> との間の KL 乖離度となっている： <span class="math display">\[
F_n:=\int_{\mathbb{R}^n}\log\frac{p(\boldsymbol{y})}{q(\boldsymbol{y})}p(\boldsymbol{y})\,d\boldsymbol{y}=\mathop{\mathrm{KL}}(p,q).
\]</span> ただし，<span class="math inline">\(q\)</span> は <span class="math inline">\(\mathrm{N}(0,\sigma^2)^{\otimes n}\)</span> の密度とした．</p>
<p>この系の他の物理量も，自由エネルギーと定数倍違うのみとなっている：</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（エントロピーと相互情報量）^[[@Krzakala-Zdeborova2024 p.122]．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（エントロピーと相互情報量）<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p>この Hamiltonian <span class="math inline">\(H\)</span> を持つ系について，</p>
<ol type="1">
<li><p>エントロピー <span class="math inline">\(H\)</span> は次で与えられる：</p>
<p><span class="math display">\[\begin{align*}
     H(Y)&amp;:=-\int_{\mathbb{R}^n}(\log p(\boldsymbol{y}))p(\boldsymbol{y})\,d\boldsymbol{y}\\
     &amp;=\frac{n}{2}\log(2\pi\sigma^2)\\
     &amp;\qquad+\frac{1}{2\sigma^2}\int_{\mathbb{R}^n}\lvert\boldsymbol{y}\rvert^2p(\boldsymbol{y})\,d\boldsymbol{y}-F_n.
\end{align*}\]</span></p></li>
<li><p>相互情報量 <span class="math inline">\(I\)</span> は次で与えられる：</p>
<p><span class="math display">\[\begin{align*}
     I(X,Y)&amp;:=\mathop{\mathrm{KL}}(p(x,y),p(x)p(y))\\\\
     &amp;=\frac{n}{2\sigma^2}\int_{\mathbb{R}}x^2p(x)\,dx-F_n.
\end{align*}\]</span></p></li>
</ol>
<p>特に，いずれも自由エネルギーの定数倍である</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>の式変形は次のとおり： <span class="math display">\[\begin{align*}
    H(Y)&amp;:=-\int_{\mathbb{R}^n}(\log p(\boldsymbol{y}))p(\boldsymbol{y})\,d\boldsymbol{y}\\
    &amp;=-\int_{\mathbb{R}^n}p(\boldsymbol{y})d\boldsymbol{y}\log q(\boldsymbol{y})-F_n\\
    &amp;=-\int_{\mathbb{R}^n}\biggr(-\frac{n}{2}\log(2\pi\sigma^2)-\frac{\lvert\boldsymbol{y}\rvert^2}{2\sigma^2}\biggl)p(\boldsymbol{y})d\boldsymbol{y}-F_n\\
    &amp;=\frac{n}{2}\log(2\pi\sigma^2)+\frac{n}{2\sigma^2}\int_{\mathbb{R}}y_i^2p(y_i)\,dy_i-F_n.
\end{align*}\]</span></p></li>
<li><p>次の関係式を用いる： <span class="math display">\[
I(X,Y)=H(Y)-H(Y|X)
\]</span> <span class="math inline">\(H(Y)\)</span> は 1. から判明しており，<span class="math inline">\(H(Y|X)\)</span> は次のように計算できる：</p>
<p><span class="math display">\[\begin{align*}
H(Y|X)&amp;=-\int_{\mathbb{R}^{n+1}}\log p(\boldsymbol{y}|x)p(\boldsymbol{y}|x)p(x)\,dxd\boldsymbol{y}\\
&amp;=-\int_{\mathbb{R}^{n+1}}\log\left(\frac{1}{(2\pi\sigma^2)^{\frac{n}{2}}}\exp\left(-\frac{1}{2\sigma^2}\sum_{i=1}^n(y_i-x)^2\right)\right)p(\boldsymbol{y}|x)p(x)\,dxd\boldsymbol{y}\\
&amp;=\int_{\mathbb{R}^{n+1}}\left(\frac{n}{2}\log(2\pi\sigma^2)+\frac{\sum_{i=1}^n(x-y_i)^2}{2\sigma^2}\right)p(\boldsymbol{y}|x)p(x)\,dxd\boldsymbol{y}\\
&amp;=\frac{n}{2}\log(2\pi\sigma^2)+\frac{1}{2\sigma^2}\int_\mathbb{R}\left(\int_{\mathbb{R}^n}\sum_{i=1}^n(x-y_i)^2p(\boldsymbol{y}|x)\,d\boldsymbol{y}\right)\,p(x)dx\\
&amp;=\frac{n}{2}\log(2\pi\sigma^2)+\frac{n\sigma^2}{2\sigma^2}\int_\mathbb{R}p(x)\,dx\\
&amp;=\frac{n}{2}\log(2\pi\sigma^2)+\frac{n}{2}.
\end{align*}\]</span></p></li>
</ol>
<p>これと，<span class="math inline">\(y_i\)</span> には <span class="math inline">\(x_i\)</span> とこれと独立な分散 <span class="math inline">\(\sigma^2\)</span> のノイズが加わって得られる値であることから，次のように計算できる： <span class="math display">\[\begin{align*}
    I(X,Y)&amp;=H(Y)-\frac{n}{2}\log(2\pi\sigma^2)-\frac{n}{2}\\
    &amp;=-F_n-\frac{n}{2}+\frac{n}{2\sigma^2}\int_\mathbb{R}y_i^2p(y_i)\,dy_i\\
    &amp;=-F_n-\frac{n}{2}+\frac{n}{2\sigma^2}\left(\sigma^2+\int_\mathbb{R}x^2p(x)\,dx\right)\\
    &amp;=-F_n+\frac{n}{2\sigma^2}\int_\mathbb{R}x^2p(x)\,dx.
\end{align*}\]</span></p>
</div>
</div>
</div>
</section>
<section id="sec-Nishimori-symmetry" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="sec-Nishimori-symmetry"><span class="header-section-number">2.3</span> 西森対称性</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題 [@西森1980]^[[@Zdeborova-Krzakala2016 p.464]，[@Krzakala-Zdeborova2024 p.123] 定理13，[@Iba1999 pp.3876-3877] などで扱われている．西森ライン上のみで見られる性質であるため，西森対称性と呼ぶ．西森ラインについては [次項](Bayes2.qmd#sec-Nishimori-line) も参照．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題 <span class="citation" data-cites="西森1980">(<a href="#ref-西森1980" role="doc-biblioref">Nishimori, 1980</a>)</span><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(P:\mathbb{R}\to\mathbb{R}^n\)</span> を確率核，<span class="math inline">\(X^*\in\mathcal{L}(\Omega)\)</span> は分布 <span class="math inline">\(\nu\in\mathcal{P}(\mathbb{R})\)</span> を持ち，<span class="math inline">\(Y\in\mathcal{L}(\Omega;\mathbb{R}^n)\)</span> の分布は <span class="math display">\[
\mu(dy)=\int_\mathbb{R}\nu(dx)P(x,dy)
\]</span> で定まるとする．ここで，<span class="math inline">\(Y\)</span> で条件づけた <span class="math inline">\(X^*\)</span> の確率分布を <span class="math inline">\(P^{X|Y}\)</span> とする： <span class="math display">\[
\nu(dx)=\int_{\mathbb{R}^n}\mu(dy)P^{X|Y}(y,dx).
\]</span> <span class="math display">\[
X^{(1)},\cdots,X^{(k)}\overset{\text{iid}}{\sim}P^{X|Y}
\]</span> を独立な確率変数列とすると，次が成り立つ：</p>
<p><span class="math display">\[\begin{align*}
    &amp;\quad\operatorname{E}\biggl[f(Y,X^{(1)},\cdots,X^{(k)})\biggr]\\
    &amp;=\operatorname{E}\left[f(Y,X^{(1)},\cdots,X^{(k-1)},X^*)\right].
\end{align*}\]</span></p>
</div>
</div>
<p><span class="math inline">\(X^{(1)},\cdots,X^{(k)}\)</span> で表した確率変数の <span class="math inline">\(P^{X|Y}\)</span> に関する積分を Boltzmann 積分または熱平均と呼び，観測を作り出す過程 <span class="math inline">\((X^*,Y)\)</span> に関する積分を無秩序積分 (disorder expectation) または quenched average という．<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>この設定の下で，<span class="math inline">\((X^*,Y)\)</span> の結合分布が次の２通りで表せていることに注意： <span class="math display">\[
\nu(dx)P(x,dy)=\mu(dy)P^{X|Y}(y,dx).
\]</span> 従って， <span class="math display">\[\begin{align*}
    &amp;\quad\nu(dx)P(x,dy)P^{X|Y}(y,dx^{(1)},\cdots,dx^{(k)})\\
    &amp;=\mu(dy)P^{X|Y}(y,dx)P^{X|Y}(y,dx^{(1)},\cdots,dx^{(k)})
\end{align*}\]</span> に関して <span class="math inline">\(f(Y,X^{(1)},\cdots,X^{(k)})\)</span> の期待値を取ると，次のように計算できる： <span class="math display">\[\begin{align*}
    &amp;\quad\operatorname{E}\biggl[f(Y,X^{(1)},\cdots,X^{(k)})\biggr]\\
    &amp;=\int_{\mathbb{R}^{n+k}}f(y,x^{(1)},\cdots ,x^{(k-1)},x^{(k)})P^{X|Y}(y,dx^{(1)})\cdots P^{X|Y}(y,dx^{(k)})\mu(dy)\\
    &amp;=\int_{\mathbb{R}^{n+k}}f(y,x^{(1)},\cdots,x^{(k-1)},x)P^{X|Y}(y,dx^{(1)})\cdots P^{X|Y}(y,dx^{(k-1)})\nu(dx)P(x,dy)\\
    &amp;=\operatorname{E}\left[f(Y,X^{(1)},\cdots,X^{(k-1)},X^*)\right].
\end{align*}\]</span></p>
<p>確率核 <span class="math inline">\(P\)</span> にまつわる記法は次の記事も参照：</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/static/Notations.html" target="_blank">
            <img src="https://162348.github.io/static/Notations.svg" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">数学記法一覧</h3>
                <p class="article-description">本サイトで用いる記法と規約</p>
            </div>
        </a>
    </div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="物理的な解釈">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
物理的な解釈
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math inline">\(P^{X|Y}\)</span> に関する積分を <span class="math inline">\(\langle-\rangle\)</span> で表すことで，何をどのように物理的に解釈しているかが明確になる： <span class="math display">\[
\langle X\rangle=\operatorname{E}[X|Y].
\]</span></p>
<p>この見方を採用すると，期待値を <span class="math display">\[
\operatorname{E}\biggl[f(Y,X^{(1)},\cdots,X^{(k)})\biggr]=\operatorname{E}^Y\left[\left\langle f(Y,X^{(1)},\cdots,X^{(k)})\right\rangle\right]
\]</span> と二段階で捉えていることになる．右辺の外側の期待値は単に <span class="math inline">\(Y\)</span> のみに関してとっていることになる．</p>
<p>第 <a href="#sec-identification" class="quarto-xref">2.2</a> 節で考えたモデル <span class="math inline">\(H\)</span> における Boltzmann 分布が <span class="math inline">\(P^{X|Y}\)</span> となり，平均 <span class="math inline">\(\langle-\rangle\)</span> はこれに関する平均となる．</p>
<p>一方で，Hamiltonian <span class="math inline">\(H\)</span> にもランダム性が残っているのであり，これに関する平均が <span class="math inline">\((X^*,Y)\)</span> に関する平均に当たる．</p>
<p>こうして，ベイズ統計モデルはスピングラス系（特にランダムエネルギーモデル <span class="citation" data-cites="Derrida1980">(<a href="#ref-Derrida1980" role="doc-biblioref">Derrida, 1980</a>)</span>）と同一視できるようになる．</p>
<p>だが同時に，スピングラスのサンプリングを困難にする多谷構造も，ベイズ統計に輸入されるのである……．</p>
<p>スピングラスについては，次の記事も参照：</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Nature/StatisticalMechanics1.html" target="_blank">
            <img src="https://162348.github.io/posts/2024/Nature/SG.png" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">数学者のための統計力学１</h3>
                <p class="article-description">Ising 模型とスピングラス</p>
            </div>
        </a>
    </div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-MMSE-via-Nishimori" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="sec-MMSE-via-Nishimori"><span class="header-section-number">2.4</span> 最小自乗誤差推定量</h3>
<p>第 <a href="#sec-MMSE" class="quarto-xref">1.4.1</a> 節で扱った最小自乗誤差推定量の自乗誤差は次のように計算できる：</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（最小自乗誤差の表示）">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（最小自乗誤差の表示）
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(\langle X\rangle:=\operatorname{E}[X|Y]\)</span> と表す．事後平均推定量の自乗誤差は次のように表せる： <span class="math display">\[\begin{align*}
    \DeclareMathOperator{\MMSE}{MMSE}
    \MMSE&amp;:=\operatorname{E}\biggl[\biggr(X-\operatorname{E}[X|Y]\biggl)^2\biggr]\\
    &amp;=\operatorname{E}[X^2]-\operatorname{E}\biggl[\langle X\rangle^2\biggr].
\end{align*}\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math display">\[\begin{align*}
    \operatorname{E}[\mathrm{V}[X|Y]]&amp;=\operatorname{E}\biggl[\biggr(\operatorname{E}[X|Y]-X\biggl)^2\biggr]\\
    &amp;=\operatorname{E}\biggl[\operatorname{E}[X|Y]^2-2X\operatorname{E}[X|Y]+X^2\biggr]\\
    &amp;=\operatorname{E}\biggl[\operatorname{E}[X|Y]^2\biggr]-2\operatorname{E}\biggl[X\operatorname{E}[X|Y]\biggr]+\operatorname{E}[X^2]\\
    &amp;=\operatorname{E}[X^2]-\operatorname{E}\biggl[\operatorname{E}[X|Y]^2\biggr].
\end{align*}\]</span></p>
<p>この変形では，繰り返し期待値の法則 <span class="math display">\[\begin{align*}
    \operatorname{E}\biggl[X\operatorname{E}[X|Y]\biggr]&amp;=\operatorname{E}\biggl[\biggl[X\operatorname{E}[X|Y]\,\bigg|\,Y\biggr]\biggr]\\
    &amp;=\operatorname{E}\biggl[\operatorname{E}[X|Y]^2\biggr]
\end{align*}\]</span> を西森の対称性の代わりに用いたことになる．</p>
<p>換言すれば，西森の対称性を証明したのと同様の方法を本命題にも適用したため，直接命題の適用は回避したことになる．</p>
</div>
</div>
</div>
</section>
<section id="sec-I-MMSE" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="sec-I-MMSE"><span class="header-section-number">2.5</span> KL 乖離度の微分としての分散</h3>
<p>次の定理は，相互情報量 <span class="math inline">\(I\)</span> と MMSE を結びつける定理であるため，<span class="citation" data-cites="Guo+2005">(<a href="#ref-Guo+2005" role="doc-biblioref">Guo et al., 2005</a>)</span> 以来，<strong>I-MMSE 定理</strong> と呼ばれている．</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（自由エネルギーによる特徴付け）[@Guo+2005]^[[@Krzakala-Zdeborova2024 p.124] 定理14．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（自由エネルギーによる特徴付け）<span class="citation" data-cites="Guo+2005">(<a href="#ref-Guo+2005" role="doc-biblioref">Guo et al., 2005</a>)</span><a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p>簡単のため，<span class="math inline">\(n=1\)</span> とする．このとき，<span class="math inline">\(\beta:=\sigma^{-2}\)</span> に関して，次の式が成り立つ：</p>
<ol type="1">
<li><p>自由エネルギー <span class="math inline">\(F_1\)</span> について， <span class="math display">\[
\frac{\partial F_1}{\partial \beta}=\frac{\operatorname{E}[\langle X\rangle^2]}{2}.
\]</span></p></li>
<li><p>相互情報量 <span class="math inline">\(I(X,Y)\)</span> について，</p>
<p><span class="math display">\[\begin{align*}
    \frac{\partial I(X,Y)}{\partial \beta}&amp;=\frac{\operatorname{E}[X^2]-\operatorname{E}[\langle X\rangle^2]}{2}\\
    &amp;=\frac{\MMSE}{2}
\end{align*}\]</span></p></li>
</ol>
<p>ただし，<span class="math inline">\(\langle X\rangle:=\operatorname{E}[X|Y]\)</span> と定めた．</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math display">\[\begin{align*}
    \log\frac{p(y)}{q(y)}&amp;=\frac{\displaystyle\frac{1}{\sqrt{2\pi\sigma^2}}\int_\mathbb{R}e^{-\frac{(x-y)^2}{2\sigma^2}}p(x)\,dx}{\frac{1}{\sqrt{2\pi\sigma^2}}e^{-\frac{y^2}{2\sigma^2}}}\\
    &amp;=\int_\mathbb{R}e^{-\frac{x^2-2xy}{2\sigma^2}}p(x)\,dx.
\end{align*}\]</span></p>
<p>この <span class="math inline">\(p(y)dy\)</span> に関する積分を <span class="math inline">\(\beta\)</span> で微分すれば良いのであるが，<span class="math inline">\(p(y)\)</span> 自体が <span class="math inline">\(\sigma\)</span> に依存し，そのまま計算したのでは大変煩雑になる．</p>
<p>そこで，<span class="math inline">\(y=\sigma z+x^*\)</span> と変数変換をすることで，標準 Gauss 確率変数 <span class="math inline">\(Z\sim\gamma_1\)</span> と真値 <span class="math inline">\(X^*\)</span> は独立で，<span class="math inline">\(\sigma\)</span> も含まないから，次のように計算ができる： <span class="math display">\[\begin{align*}
    F_1(\beta)&amp;=\int_\mathbb{R}\log\frac{p(y)}{q(y)}p(y)\,dy\\
    &amp;=\operatorname{E}\biggl[\log\left(\int_\mathbb{R}e^{-\frac{x^2-2xY}{2\sigma^2}}p(x)\,dx\right)\biggr]\\
    &amp;=\operatorname{E}\biggl[\log\left(\int_\mathbb{R}\exp\left(-\frac{x^2}{2\sigma^2}+\frac{xZ}{\sigma}+\frac{xX^*}{\sigma^2}\right)p(x)\,dx\right)\biggr]\\
    &amp;=\operatorname{E}\biggl[\log\left(\int_\mathbb{R}\exp\left(-\frac{x^2\beta}{2}+xZ\sqrt{\beta}+xX^*\beta\right)p(x)\,dx\right)\biggr].
\end{align*}\]</span></p>
<p>こうして，最右辺の期待値に関する密度はもう <span class="math inline">\(\beta\)</span> に依存しないから，次のように微分が計算できる．ただし， <span class="math display">\[
\exp\left(-\frac{x^2\beta}{2}+xZ\sqrt{\beta}+xX^*\beta\right)p(x)\,dx
\]</span> は <span class="math inline">\(p(x|y)\)</span> の定数倍，すなわち Gibbs 測度 <span class="math inline">\(\frac{e^{-H(x,y)}}{Z(y)}dx\)</span> の定数倍であることに注意して，これらに関する平均を引き続き <span class="math inline">\(\langle-\rangle:=\operatorname{E}[-|Y]\)</span> で表すこととすると，</p>
<p><span class="math display">\[\begin{align*}
    \frac{\partial F_1(\beta)}{\partial \beta}&amp;=
    \operatorname{E}\left[\frac{\displaystyle\int_\mathbb{R}\biggr(-\frac{x^2}{2}+\frac{xZ}{2\sqrt{\beta}}+xX^*\biggl)e^{-\frac{x^2\beta}{2}+xZ\sqrt{\beta}+xX^*\beta}p(x)dx}{\displaystyle\int_\mathbb{R}\exp\left(-\frac{x^2\beta}{2}+xZ\sqrt{\beta}+xX^*\beta\right)p(x)\,dx}\right]\\
    &amp;=-\frac{\operatorname{E}[\langle X^2\rangle]}{2}+\frac{1}{2\sqrt{\beta}}\operatorname{E}[\langle X\rangle Z]+\operatorname{E}[\langle X\rangle X^*].
\end{align*}\]</span></p>
<p><span class="math inline">\(\langle X\rangle\)</span> が中に入っているのは，<span class="math inline">\(\sigma[X^*,Z]\)</span> に関する条件付き期待値を <span class="math inline">\(\operatorname{E}\)</span> 内で取ったためと捉えられる．</p>
<p>まず，第二項は，Stein の補題 <a href="#sec-Steins-lemma" class="quarto-xref">2.6</a> の系から， <span class="math display">\[\begin{align*}
    \frac{1}{2\sqrt{\beta}}\operatorname{E}[\langle X\rangle Z]&amp;=\frac{1}{2\sqrt{\beta}}\sqrt{\beta}\biggr(\operatorname{E}[\langle X^2\rangle]-\operatorname{E}[\langle X\rangle^2]\biggl)\\
    &amp;=\frac{\operatorname{E}[\langle X^2\rangle]}{2}-\frac{\operatorname{E}[\langle X\rangle^2]}{2}
\end{align*}\]</span></p>
<p>第三項は，西森の対称性から， <span class="math display">\[\begin{align*}
    \operatorname{E}[\langle X\rangle X^*]=\operatorname{E}[\langle X\rangle^2].
\end{align*}\]</span></p>
<p>以上を併せると， <span class="math display">\[
\frac{\partial F_1(\beta)}{\partial \beta}=\frac{\operatorname{E}[\langle X\rangle^2]}{2}.
\]</span></p>
<ol type="1">
<li>の主張も，<span class="math inline">\(n=1\)</span> のときは <span class="math display">\[
I(X,Y)=\frac{\beta}{2}\int_\mathbb{R}x^2p(x)\,dx-F_1
\]</span> であったために従う： <span class="math display">\[\begin{align*}
\frac{\partial I(X,Y)}{\partial \beta}&amp;=\frac{\operatorname{E}[X^2]}{2}-\frac{\operatorname{E}[\langle X\rangle^2]}{2}\\
&amp;=\frac{\MMSE}{2}.
\end{align*}\]</span></li>
</ol>
</div>
</div>
</div>
<p><span class="math inline">\(\operatorname{E}[\langle X\rangle^2]\)</span> は <span class="math inline">\(q\)</span> とも表され，スピングラスの <strong>秩序パラメータ</strong> ともいう．<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<p><span class="math inline">\(I\)</span> の <span class="math inline">\(\beta\)</span> に関する二回微分を計算することより，<span class="math inline">\(\beta\)</span> に関する凸関数であることもわかる．</p>
</section>
<section id="sec-Steins-lemma" class="level3" data-number="2.6">
<h3 data-number="2.6" class="anchored" data-anchor-id="sec-Steins-lemma"><span class="header-section-number">2.6</span> Stein の補題</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題 [@Stein1972]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題 <span class="citation" data-cites="Stein1972">(<a href="#ref-Stein1972" role="doc-biblioref">Stein, 1972</a>)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>可積分な確率変数 <span class="math inline">\(X\in\mathcal{L}^1(\Omega)\)</span> について，次は同値：</p>
<ol type="1">
<li><span class="math inline">\(X\)</span> の分布は標準Gaussである：<span class="math inline">\(X\sim\gamma_1\)</span>．</li>
<li>任意の <span class="math inline">\(f\in C^1_b(\mathbb{R})\)</span> について， <span class="math display">\[
\operatorname{E}[f'(X)]=\operatorname{E}[Xf(X)]&lt;\infty.
\]</span></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>(1)<span class="math inline">\(\Rightarrow\)</span>(2)</p>
<p><span class="math inline">\(f,f'\)</span> はいずれも有界としたから， <span class="math display">\[
  \operatorname{E}[f'(X)],\operatorname{E}[f(X)]&lt;\infty
  \]</span> が成り立つ．</p>
<p><span class="math inline">\(\gamma_1\)</span> の密度 <span class="math inline">\(\phi\)</span> は <span class="math inline">\(\phi'(x)=-x\phi(x)\)</span> を満たすことに注意すれば，部分積分により， <span class="math display">\[\begin{align*}
      \operatorname{E}[f'(X)]&amp;=-\int_\mathbb{R}f(x)\phi'(x)dx\\
      &amp;=\int_\mathbb{R}f(x)x\phi(x)dx=\operatorname{E}[f(X)X].
  \end{align*}\]</span></p></li>
<li><p>(2)<span class="math inline">\(\Rightarrow\)</span>(1)</p>
<p><span class="math inline">\(X\)</span> は可積分としたから，特性関数 <span class="math inline">\(\varphi(u):=\operatorname{E}[e^{iuX}]\)</span> は少なくとも <span class="math inline">\(C^1(\mathbb{R})\)</span>-級で，その微分は <span class="math inline">\(\phi(x):=e^{iux}\)</span> に関する仮定 <span class="math inline">\(\operatorname{E}[\phi'(X)]=\operatorname{E}[X\phi(X)]\)</span> を通じて <span class="math display">\[\begin{align*}
      \varphi'(u)&amp;=i\operatorname{E}[Xe^{iuX}]=-u\operatorname{E}[e^{iuX}]\\
      &amp;=-u\varphi(u),\qquad u\in\mathbb{R},
  \end{align*}\]</span> と計算できる．</p>
<p>この微分方程式は規格化条件 <span class="math inline">\(\varphi(0)=1\)</span> の下で一意な解 <span class="math inline">\(\varphi(u)=e^{-\frac{u^2}{2}}\)</span> を持つ．</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="系">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
系
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(\langle X\rangle:=\operatorname{E}[X|Y]\)</span> とこれと独立な <span class="math inline">\(Z\sim\gamma_1\)</span> に関して，次が成り立つ：</p>
<p><span class="math display">\[\begin{align*}
    \operatorname{E}[\langle X\rangle Z]&amp;=\operatorname{E}\left[\frac{\partial \langle X\rangle}{\partial Z}\right]\\
    &amp;=\sqrt{\beta}\biggr(\operatorname{E}[\langle X^2\rangle]-\operatorname{E}[\langle X\rangle^2]\biggl)
\end{align*}\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>最初の等号 <span class="math display">\[
\operatorname{E}[\langle X\rangle Z]=\operatorname{E}\left[\frac{\partial \langle X\rangle}{\partial Z}\right]
\]</span> は Stein の補題による．</p>
<p>続いて， <span class="math display">\[
\langle X\rangle=\int_\mathbb{R}xp(x|Y)\,dx
\]</span> は <span class="math inline">\(Y=\sigma Z+X^*\)</span> を通じてのみ <span class="math inline">\(Z\)</span> に依存するから， <span id="eq-chain-rule"><span class="math display">\[
\frac{\partial \langle X\rangle}{\partial Z}=\frac{\partial \langle X\rangle}{\partial Y}\frac{d Y}{d Z}=\sigma\frac{\partial \langle X\rangle}{\partial Y}
\tag{2}\]</span></span> が成り立つ．あとは <span class="math inline">\(\langle X\rangle=\operatorname{E}[X|Y]\)</span> の <span class="math inline">\(Y\)</span> に関する微分を計算すれば良い．</p>
<p><span class="math display">\[
\frac{\partial p(y|x)}{\partial y}=-\frac{y-x}{\sigma^2}p(y|x).
\]</span> また， <span class="math display">\[
p(y)=\frac{1}{\sqrt{2\pi\sigma^2}}\int_\mathbb{R}e^{-\frac{(x-y)^2}{2\sigma^2}}p(x)\,dx
\]</span> であったから， <span class="math display">\[\begin{align*}
    p'(y)&amp;=\frac{1}{\sqrt{2\pi\sigma^2}}\int_\mathbb{R}-\frac{y-x}{\sigma^2}e^{-\frac{(x-y)^2}{2\sigma^2}}p(x)\,dx\\
    &amp;=-\int_\mathbb{R}\frac{y-x}{\sigma^2}p(y|x)p(x)\,dx\\
    &amp;=-\int_\mathbb{R}\frac{y-x}{\sigma^2}p(x|y)p(y)\,dx\\
    &amp;=-\frac{y-\langle X\rangle}{\sigma^2}p(y).
\end{align*}\]</span> <span class="math display">\[
\therefore\quad\frac{p'(Y)}{p(Y)}=\frac{\langle X\rangle-Y}{\sigma^2}
\]</span></p>
<p>に注意すれば，次のように計算できる：</p>
<p><span class="math display">\[\begin{align*}
    \frac{\partial \langle X\rangle}{\partial Y}&amp;=\frac{\partial }{\partial Y}\int_\mathbb{R}xp(x|Y)\,dx\\
    &amp;=\frac{\partial }{\partial Y}\int_\mathbb{R}x\frac{p(Y|x)p(x)}{p(Y)}\,dx\\
    &amp;=\int_\mathbb{R}x\frac{\partial }{\partial Y}\frac{p(Y|x)p(x)}{p(Y)}\,dx\\
    &amp;=\int_\mathbb{R}x\frac{\partial p(Y|x)}{\partial Y}\frac{p(x)}{p(Y)}\,dx\\
    &amp;\qquad+\int_\mathbb{R}x\left(\frac{\partial }{\partial Y}\frac{1}{p(Y)}\right)p(Y|x)p(x)\,dx\\
    &amp;=-\int_\mathbb{R}x\frac{Y-x}{\sigma^2}p(x|Y)\,dx\\
    &amp;\qquad-\frac{p'(Y)}{p(Y)}\int_\mathbb{R}xp(x|Y)\,dx\\
    &amp;=-\frac{Y}{\sigma^2}\langle X\rangle+\frac{\langle X^2\rangle}{\sigma^2}\\
    &amp;\qquad-\langle X\rangle\frac{\langle X\rangle-Y}{\sigma^2}\\
    &amp;=\frac{1}{\sigma^2}\biggr(\langle X^2\rangle-\langle X\rangle^2\biggl).
\end{align*}\]</span></p>
<p>最後，式 (<span class="math inline">\(\ref{eq-chain-rule}\)</span>) より， <span class="math display">\[\begin{align*}
    \frac{\partial \langle X\rangle}{\partial Z}&amp;=\sigma\frac{\partial \langle X\rangle}{\partial Y}\\
    &amp;=\sqrt{\beta}\biggr(\langle X^2\rangle-\langle X\rangle^2\biggl).
\end{align*}\]</span></p>
<!-- 
\begin{align*}
    \E\Square{\pp{\brac{X}}{Z}}&=\E\Square{\pp{}{Z}\E[X|Y=\sigma Z+x^*]}\\
    &=\E\Square{\pp{}{Z}\int_\R xp(x|\sigma Z+x^*)\,dx}
\end{align*}

$p(x|y)$ は Boltzmann 分布である（第 [-@sec-identification] 節）から，次のように計算を進められる：

\begin{align*}
    &\quad\E\Square{\pp{}{Z}\int_\R xp(x|\sigma Z+x^*)\,dx}\\
    &=\E\Square{\pp{}{Z}\int_\R\frac{xe^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}\,dx}\\
    &=\E\Square{\int_\R x\pp{}{Z}\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}\,dx}
\end{align*}

として計算し，結果が絶対可積分であったならば Fubini-Tonelli の定理により，最後の等号が正当化される．

また，記号の混同を避けるため，分配関数は $\cZ$ で表した．$Z\sim\gamma_1$ であった．

$$
H(x,y)=\frac{1}{2\sigma^2}(x^2-2xy)-\log p(x)
$$
$$
\therefore\quad\pp{H(x,y)}{y}=-\frac{x}{\sigma^2}
$$

より，

\begin{align*}
    &\quad\pp{}{Z}\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}\\
    &=-\pp{H(x,\sigma Z+x^*)}{Z}\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}+\pp{}{Z}\paren{\frac{1}{\cZ(\sigma Z+x^*)}}e^{-H(x,\sigma Z+x^*)}\\
    &=\frac{x}{\sigma^2}\sigma\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}-\frac{\cZ'(\sigma Z+x^*)}{\cZ(\sigma Z+x^*)}\sigma\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}
\end{align*}

さらに，$\cZ(y)=\frac{q(y)}{p(y)}$ であるが，
$$
\cZ'(y)=-\frac{1}{\sigma^2}\frac{yq(y)}{p(y)}-\frac{p'(y)q(y)}{p(y)^2}
$$

\begin{align*}
    \frac{\cZ'(Y)}{\cZ(Y)}=-\frac{Y}{\sigma^2}-\frac{p'(Y)}{p(Y)}
\end{align*}

続いて
$$
p(y)=\frac{1}{\sqrt{2\pi\sigma^2}}\int_\R e^{-\frac{(x-y)^2}{2\sigma^2}}p(x)\,dx
$$
であったから，
\begin{align*}
    p'(y)&=\frac{1}{\sqrt{2\pi\sigma^2}}\int_\R-\frac{y-x}{\sigma^2}e^{-\frac{(x-y)^2}{2\sigma^2}}p(x)\,dx\\
    &=-\int_\R\frac{y-x}{\sigma^2}p(y|x)p(x)\,dx\\
    &=-\int_\R\frac{y-x}{\sigma^2}p(x|y)p(y)\,dx\\
    &=-\frac{y-\brac{X}}{\sigma^2}p(y).
\end{align*}
$$
\therefore\quad\frac{p'(Y)}{p(Y)}=\frac{\brac{X}-Y}{\sigma^2}
$$
\begin{align*}
    \therefore\quad\frac{\cZ'(Y)}{\cZ(Y)}&=-\frac{Y}{\sigma^2}-\frac{p'(Y)}{p(Y)}=-\frac{\brac{X}}{\sigma^2}
\end{align*}

と計算できるから，

\begin{align*}
    &\quad\E\Square{\int_\R x\pp{}{Z}\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}\,dx}\\
    &=\E\Square{\int_\R x\Paren{\frac{x}{\sigma^2}\sigma p(x|Y)-\frac{\cZ'(\sigma Z+x^*)}{\cZ(\sigma Z+x^*)}\sigma p(x|Y)}dx}\\
    &=\E\Square{\int_\R\frac{x^2}{\sigma}p(x|Y)\,dx}+\E\Square{\int_\R x\sigma\frac{\brac{X}}{\sigma^2}p(x|Y)dx}\\
    &=\sqrt{\beta}\E[\brac{X^2}]+\sqrt{\beta}\E[\brac{X}^2]
\end{align*}
-->
</div>
</div>
</div>
</section>
</section>
<section id="sec-sparse-vector-denoising" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="sec-sparse-vector-denoising"><span class="header-section-number">3</span> スパースベクトルの復号</h2>
<p>スパースベクトルの信号推定問題を考える．</p>
<section id="sec-settings" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="sec-settings"><span class="header-section-number">3.1</span> 設定</h3>
<p>ここまで，<span class="math inline">\(x,x^*\)</span> は <span class="math inline">\(\mathbb{R}\)</span> の点としてきたが，<span class="math inline">\(\mathbb{R}^d,d=2^N\)</span> の one-hot ベクトルであるとする．</p>
<p>これを Gauss ノイズを通じて観測する： <span class="math display">\[
Y\sim\mathrm{N}_d\left(x^*,\frac{\sigma^2}{N}I_d\right).
\]</span></p>
<p>事前分布を <span class="math inline">\(p(x)\)</span>，<span class="math inline">\(Y\)</span> の分布を <span class="math inline">\(p(y)\)</span> とすると，Bayes の定理より， <span class="math display">\[\begin{align*}
    p(x|y)&amp;=\frac{p(x)}{p(y)}\prod_{i=1}^d\frac{e^{-\frac{(y_i-x_i)^2}{2\sigma^2/N}}}{\sqrt{2\pi\sigma^2/N}}\\
    &amp;=\frac{\prod_{i=1}^d\phi(y_i;0,\sigma^2/N)}{p(y)}\\
    &amp;\qquad\times p(x)\prod_{i=1}^d\exp\left(-\frac{x_i^2-2x_iy_i}{2\sigma^2/N}\right).
\end{align*}\]</span></p>
<p>ただし，<span class="math inline">\(\phi(-;\mu,\sigma):=\frac{d \mathrm{N}_1(\mu,\sigma)}{d \ell_1}\)</span> を正規密度とした．</p>
<p>ここで，事前分布 <span class="math inline">\(p(x)dx\)</span> は，one-hot ベクトルのなす有限集合 <span class="math display">\[
\Delta_d:=\left\{x\in\mathbb{Z}^d\mid\|x\|_1=1\right\}
\]</span> 上の一様分布とする．</p>
<p>このとき，事後分布 <span class="math inline">\(p(x|y)dx\)</span> もやはり <span class="math inline">\(\Delta_d\)</span> 上の分布で，その質量関数は <span class="math inline">\(x\in\Delta_d\)</span> で <span class="math inline">\(i^*\in[d]\)</span> のみ <span class="math inline">\(x_{i^*}=1\)</span> であるものに対して， <span class="math display">\[
p(x|y)=\frac{1}{\mathcal{Z}}\frac{1}{2^N}\exp\left(\frac{2y_i-1}{2\sigma^2/N}\right)
\]</span> よって一般には， <span class="math display">\[
p(x|y)=\frac{e^{-H(x^{(i)},y)}}{\mathcal{Z}},
\]</span> <span class="math display">\[
H(x,y)=-\frac{N}{2\sigma^2}\sum_{j=1}^d(2y_j-1)x_j+N\log 2,
\]</span> <span class="math display">\[
\mathcal{Z}:=\frac{1}{2^N}\sum_{i=1}^d\exp\left(\frac{N}{2\sigma^2}(2y_i-1)\right),
\]</span> と表される．</p>
</section>
<section id="自由エネルギー密度の計算" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="自由エネルギー密度の計算"><span class="header-section-number">3.2</span> 自由エネルギー密度の計算</h3>
<p>系が用意されたら，統計力学はまず，代表的な物理量の熱力学極限を計算する．特に自由エネルギー密度は，熱力学極限 <span class="math inline">\(N\to\infty\)</span> において自己平均性（数学的には集中性）を示すことが期待される．</p>
<p>自由エネルギー密度 <span class="math inline">\(\Phi\)</span> は，熱力学極限を通じて <span class="math display">\[
\Phi(\beta):=\lim_{N\to\infty}\frac{\operatorname{E}[\log\mathcal{Z}]}{N}
\]</span> と定まる．</p>
<p>I-MMSE 定理（第 <a href="#sec-I-MMSE" class="quarto-xref">2.5</a> 節）はこの多次元の <span class="math inline">\(X\)</span> に関しても有効であり， <span class="math display">\[
\Phi_N(\beta):=\frac{\operatorname{E}[\log\mathcal{Z}]}{N}
\]</span> に関して， <span class="math display">\[
\frac{\partial \Phi_N(\beta)}{\partial \beta}=\frac{\operatorname{E}\biggl[\lvert\langle X\rangle\rvert^2\biggr]}{2}
\]</span> が成り立つ．</p>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>まず有限の <span class="math inline">\(N\in\mathbb{N}^+\)</span> で計算する．</p>
<p><span class="math display">\[
\frac{\partial \Phi_N(\beta)}{\partial \beta}=\frac{1}{N}\operatorname{E}\left[\frac{1}{\mathcal{Z}}\frac{\partial \mathcal{Z}}{\partial \beta}\right]
\]</span> の右辺を求めれば良い．</p>
<p><span class="math display">\[
Y_i=X_i^*+\frac{\sigma}{\sqrt{N}}Z_i
\]</span> であり，one-hot ベクトル <span class="math inline">\(x\in\Delta_d\)</span> については <span class="math display">\[
x_j=x_j^2,\quad\lvert x\rvert^2=1
\]</span> でもあることに注意すれば，</p>
<p><span class="math display">\[\begin{align*}
    \mathcal{Z}&amp;=\sum_{i=1}^de^{-H(x^{(i)},Y)}\\
    &amp;=\frac{1}{2^N}\sum_{i=1}^d\exp\left(-\frac{N\beta}{2}\lvert x^{(i)}\rvert^2+N\beta(Y|x^{(i)})\right)\\
    &amp;=\frac{1}{2^N}\sum_{i=1}^d\exp\left(-\frac{N\beta}{2}\lvert x^{(i)}\rvert^2+N(X^*|x^{(i)})\beta+(Z|x^{(i)})\sqrt{N\beta}\right)
\end{align*}\]</span> <span class="math display">\[
\frac{\partial \mathcal{Z}}{\partial \beta}=\sum_{i}^d\biggr(-\frac{N}{2}\lvert x^{(i)}\rvert^2+N(X^*|x^{(i)})+\frac{\sqrt{N}}{2\sqrt{\beta}}(Z|x^{(i)})\biggl)e^{-H(x^{(i)},Y)}
\]</span> <span class="math display">\[
\frac{1}{\mathcal{Z}}\frac{\partial \mathcal{Z}}{\partial \beta}=-\frac{N}{2}\left\langle\lvert X\rvert^2\right\rangle+N\biggl\langle(X^*|X)\biggr\rangle+\frac{\sqrt{N}}{2\sqrt{\beta}}\biggl\langle(Z|X)\biggr\rangle
\]</span> <span class="math display">\[
\frac{1}{N}\operatorname{E}\left[\frac{1}{\mathcal{Z}}\frac{\partial \mathcal{Z}}{\partial \beta}\right]=\operatorname{E}\left[\left\langle-\frac{\langle\lvert X\rvert^2\rangle}{2}+\biggl\langle(X^*|X)\biggr\rangle+\frac{\biggl\langle(Z|X)\biggr\rangle}{2\sqrt{N\beta}}\right\rangle\right]
\]</span> これは１次元の場合の計算（第 <a href="#sec-I-MMSE" class="quarto-xref">2.5</a> 節）と同様に， <span class="math display">\[
\frac{\partial \Phi_N(\beta)}{\partial \beta}=\frac{\operatorname{E}[\lvert\langle X\rangle\rvert^2]}{2}
\]</span> と計算できる．</p>
</div>
</div>
</div>
<p>よって，<span class="math inline">\(N\to\infty\)</span> の極限でも右辺が定数に収束し（右辺は <span class="math inline">\(2^N\)</span> 項和を含む），この種の関係式が成り立ち続けるならば，<span class="math inline">\(\Phi\)</span> は <span class="math inline">\(\beta\)</span> の一次関数の形であるはずである．実際，次が示せる：</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題^[[@Krzakala-Zdeborova2024 p.125] 定理15，[@樺島-杉浦2008 p.14] なども参照．証明は [@Krzakala-Zdeborova2024 p.133] 7.B 節 を参考にした．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(\Delta:=\sigma^2\)</span> の関数として，自由エネルギー密度 <span class="math inline">\(\Phi\)</span> は次で定まる関数 <span class="math inline">\(f:\mathbb{R}^+\to\mathbb{R}_+\)</span> に一致する： <span class="math display">\[
f(\Delta):=
\begin{cases}
\frac{1}{2\Delta}-\log 2&amp;\Delta\le\Delta_c,\\
0&amp;\Delta\ge\Delta_c.
\end{cases}
\]</span> <span class="math display">\[
\Delta_c:=\frac{1}{2\log 2}
\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>次節 <a href="#sec-bounds-on-Phi" class="quarto-xref">3.3</a> では <span class="math inline">\(\Phi_N\)</span> を <span class="math inline">\(f\)</span> によって上下から評価することで，数学的に厳密な証明を与える．ここでは，本ベイズモデルをランダムエネルギーモデルとみなし，レプリカ法によって計算する．</p>
</div>
</div>
</div>
</section>
<section id="sec-bounds-on-Phi" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="sec-bounds-on-Phi"><span class="header-section-number">3.3</span> 自由エネルギーの上下評価</h3>
<p>レプリカ法を回避し，数学的に厳密な証明を与えるには，次のように上下から評価することになる．</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="補題（下界）^[[@Krzakala-Zdeborova2024 p.125]補題８．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
補題（下界）<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[
\Phi_N(\Delta)\ge f(\Delta)
\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>一般に下からの評価は，<span class="math inline">\(Z_i\)</span> に関する項をまとめて無視して良いために，簡単である．</p>
<p><span class="math display">\[
Y_i=X_i^*+\frac{\sigma}{\sqrt{N}}Z_i,
\]</span> <span class="math display">\[
Z_i\overset{\text{iid}}{\sim}\mathrm{N}_1(0,1),
\]</span></p>
<p>であることから，<span class="math inline">\(i^*\)</span> を <span class="math inline">\(X^*_{i^*}=1\)</span> を満たす添字 <span class="math inline">\(i^*\in[d]\)</span> とすると，</p>
<p><span class="math display">\[\begin{align*}
    \mathcal{Z}&amp;=\frac{1}{2^N}\sum_{i=1}^d\exp\left(\frac{NY_i}{\sigma^2}-\frac{N}{2\sigma^2}\right)\\
    &amp;=\frac{1}{2^N}\sum_{i=1}^d\exp\left(\frac{NX^*_i}{\sigma^2}+\frac{\sqrt{N}}{\sigma}Z_i-\frac{N}{2\sigma^2}\right)\\
    &amp;\ge\frac{1}{2^N}\exp\left(\frac{N}{\sigma^2}+\frac{\sqrt{N}}{\sigma}Z_{i^*}-\frac{N}{2\sigma^2}\right)\\
    &amp;=\frac{1}{2^N}\exp\left(\frac{N}{2\sigma^2}+\frac{\sqrt{N}}{\sigma}Z_{i^*}\right)
\end{align*}\]</span></p>
<p>と評価できる．</p>
<p><span class="math display">\[
\log\mathcal{Z}\ge\frac{N}{2\sigma^2}+\frac{\sqrt{N}}{\sigma}Z_{i^*}-N\log 2.
\]</span> <span class="math display">\[\begin{align*}
    \Phi_N(\Delta)&amp;=\frac{\operatorname{E}[\log\mathcal{Z}]}{N}\\
    &amp;\ge\frac{1}{N}\left(\frac{N}{2\sigma^2}-N\log 2\right)\\
    &amp;=\frac{1}{2\Delta}-\log2.
\end{align*}\]</span></p>
<p>これより，低温領域に於ては， <span class="math display">\[
\Phi_N\ge f\;\mathrm{on}\;(0,\Delta_c)
\]</span> が確認できた．</p>
<p>続いて， <span class="math display">\[\begin{align*}
    \frac{\partial \Phi_N(\Delta)}{\partial \Delta}&amp;=\frac{\partial \Phi_N(\Delta)}{\partial \beta}\frac{d \beta}{d \Delta}\\
    &amp;=\frac{\operatorname{E}[\lvert\langle X\rangle\rvert^2]}{2}\left(-\frac{1}{\Delta^2}\right)\le0
\end{align*}\]</span> であることと， <span class="math display">\[
\lim_{\Delta\to\infty}\Phi_N(\Delta)=0
\]</span> であることから，<span class="math inline">\([\Delta_c,\infty)\)</span> 上においても非負であることがわかる．</p>
<p>以上より， <span class="math display">\[
\Phi_N\ge f\;\mathrm{on}\;\mathbb{R}_+.
\]</span></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="補題（上界）^[[@Krzakala-Zdeborova2024 p.126]補題９．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
補題（上界）<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[
\Phi_N(\Delta)\le f(\Delta)+o(1)\quad(N\to\infty)
\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math inline">\(\Phi_N\)</span> の上界は，Boltzmann 分布 <span class="math inline">\(p(x|y)\)</span> に関する期待値に対して，Jensen の不等式を用いることで導かれる．このような不等式は annealed bound とも呼ばれる．</p>
<p>真値 <span class="math inline">\(x^*\)</span> とノイズ <span class="math inline">\(z\)</span> が確定している（従って，<span class="math inline">\(x^*_{i^*}=1\)</span> を満たす <span class="math inline">\(i^*\in[d]\)</span> も確定している）とすると， <span class="math display">\[\begin{align*}
    \mathcal{Z}&amp;=\frac{1}{2^N}\sum_{i=1}^d\exp\left(-\frac{N\beta}{2}+Nx_i^*\beta+z_i\sqrt{N\beta}\right)\\
    &amp;=\frac{1}{2^N}\left(\exp\left(\frac{N\beta}{2}+z_{i^*}\sqrt{N\beta}\right)+\sum_{i\ne i^*}\exp\left(-\frac{N\beta}{2}+z_i\sqrt{N\beta}\right)\right)
\end{align*}\]</span> <span class="math display">\[
\log\mathcal{Z}=\log\left(\exp\left(\frac{N\beta}{2}+z_{i^*}\sqrt{N\beta}-N\log 2\right)+\sum_{i\ne i^*}\frac{1}{2^N}\exp\left(-\frac{N\beta}{2}*Z_i\sqrt{N\beta}\right)\right)
\]</span> と計算できる．凹関数 <span class="math inline">\(\log\)</span> に対する Jensen の不等式より， <span class="math display">\[\begin{align*}
    \operatorname{E}[\log\mathcal{Z}]&amp;\le\operatorname{E}\biggl[\log\biggr(\exp\biggr(\frac{N\beta}{2}+Z_{i^*}\sqrt{N\beta}-N\log 2\biggl)\\
    &amp;\qquad\quad\qquad+\sum_{i\ne i^*}\operatorname{E}_{Z_{-i^*}}\biggl[\frac{1}{2^N}\exp\biggr(-\frac{N\beta}{2}+Z_i\sqrt{N\beta}\biggl)\biggr]\biggl)\biggr]\\
    &amp;=\operatorname{E}\left[\log\left(\exp\left(\frac{N\beta}{2}+Z_{i^*}\sqrt{N\beta}-N\log 2\right)+\frac{2^{N-1}}{2^N}\right)\right]\\
    &amp;\le\operatorname{E}\left[\log\left(\exp\left(\frac{N\beta}{2}+Z_{i^*}\sqrt{N\beta}-N\log 2\right)+1\right)\right]\\
    &amp;=\operatorname{E}\left[\log\biggr(e^{N\left(\frac{\beta}{2}-\log 2\right)}e^{Z_{i^*}\sqrt{N\beta}}+1\biggl)\right].
\end{align*}\]</span></p>
<p>最初の等号にて，<span class="math inline">\(\xi\sim\mathrm{N}(\mu,\sigma^2)\)</span> の積率母関数が <span class="math display">\[
\operatorname{E}[e^{t\xi}]=\exp\left(\mu t+\frac{\sigma^2t^2}{2}\right)
\]</span> で表せることを用いた．</p>
<p>この <span class="math inline">\(Z_{i^*}\)</span> という確率変数は複雑に定まっており，これを直接議論することは後回しにする．</p>
<p>本補題の主張は，純粋に関数 <span class="math display">\[
g(z):=\exp\left(N\left(\frac{\beta}{2}-\log 2\right)+z\sqrt{N\beta}\right)+1
\]</span> の性質を考察するだけで従う．この関数 <span class="math inline">\(g\)</span> を用いると， <span class="math display">\[\begin{align*}
    \Phi_N(\beta)&amp;=\frac{\operatorname{E}[\log\mathcal{Z}]}{N}\\
    &amp;\le\frac{1}{N}\operatorname{E}\biggl[\log(g(Z_{i^*}))\biggr]
\end{align*}\]</span> と表せる．<span class="math inline">\(g\)</span> も <span class="math inline">\(\log g\)</span> も凸関数であるから， <span class="math display">\[\begin{align*}
    \log g(\lvert z\rvert)&amp;\le\log g(0)+\lvert z\rvert\frac{d }{d z}\log g(\lvert z\rvert)\\
    &amp;=\log g(0)+\frac{g'(\lvert z\rvert)}{g(\lvert z\rvert)}\\
    &amp;\le\log g(0)+\lvert z\rvert\sqrt{N\beta}\\
    &amp;=\log\biggr(e^{N\left(\frac{\beta}{2}-\log 2\right)}+1\biggl)+\lvert z\rvert\sqrt{N\beta}.
\end{align*}\]</span></p>
<p>これより， <span class="math display">\[\begin{align*}
    \Phi_N(\beta)&amp;\le\frac{1}{N}\operatorname{E}\biggl[\log(g(\lvert Z_{i^*}\rvert))\biggr]\\
    &amp;\le\frac{1}{N}\log\biggr(e^{N\left(\frac{\beta}{2}-\log 2\right)}+1\biggl)+\sqrt{\frac{\beta}{N}}\operatorname{E}[\lvert Z_{i^*}\rvert].
\end{align*}\]</span></p>
<p>よって，<span class="math inline">\(Z_{i^*}\)</span> が可積分であることさえ認めれば，<span class="math inline">\(N\to\infty\)</span> のとき， <span class="math display">\[
\Delta\ge\Delta_c\quad\Leftrightarrow\quad\frac{\beta}{2}\le\log2
\]</span> のとき，<span class="math inline">\(\log\biggr(e^{N\left(\frac{\beta}{2}-\log 2\right)}+1\biggl)\ge0\)</span> であり，そうでない場合は <span class="math display">\[
\log(1+e^x)\le x\quad x\in\mathbb{R}_+
\]</span> より， <span class="math display">\[
\Phi_N(\Delta)\le\frac{\beta}{2}-\log2+o(1)\quad(N\to\infty)
\]</span> を得る．</p>
</div>
</div>
</div>
</section>
<section id="解釈" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="解釈"><span class="header-section-number">3.4</span> 解釈</h3>
<p><span class="math inline">\(N\to\infty\)</span> の極限において，高温領域 <span class="math inline">\(\Delta&gt;\Delta_c\)</span> において，最小自乗誤差（MMSE）は <span class="math inline">\(1\)</span> であり，何をどうしても復号することはできない．Gauss ノイズ <span class="math inline">\(\Delta=\sigma^2\)</span> が大きすぎるのである．</p>
<p>一方で，低温領域 <span class="math inline">\(\Delta&lt;\Delta_c\)</span> において，<span class="math inline">\(\partial_\beta f=\frac{1}{2}\)</span> であり，従って MMSE は <span class="math inline">\(0\)</span> になる．よって完全な誤りのない復号が可能であるはずである．</p>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>設定（第 <a href="#sec-settings" class="quarto-xref">3.1</a> 節）が与えられたならば，立ち所に，<span class="math inline">\(\Delta\)</span> が大きいほど復号が難しいことは予想がつく．しかし，ある閾値 <span class="math inline">\(\Delta_c\)</span> に依存して，少なくとも <span class="math inline">\(N\to\infty\)</span> の極限では，</p>
<ul>
<li>２つの領域で全く異なる振る舞いをすること</li>
<li>２つの振る舞いのみに分類される（ある一定以上の確率で復号が可能である，などの中間状態がない）こと</li>
</ul>
<p>は驚きである．</p>
</div>
</div>
</div>
<p>実は，高温領域 <span class="math inline">\(\Delta&gt;\Delta_c\)</span> では，自由エネルギー <span class="math inline">\(F_N\)</span> が <span class="math inline">\(0\)</span> に指数収束する．<span class="math inline">\(F_N\)</span> とは，完全な Gauss ノイズ <span class="math display">\[
q(y)dy:=\mathrm{N}_d\biggr(0,\frac{\Delta}{N}I_d\biggl)
\]</span> と <span class="math inline">\(p(y)\)</span> との KL 距離距離であったから，メッセージ <span class="math inline">\(x^*\)</span> を完全な雑音と見分けることが加速度的に難しくなっていくのである．</p>
</section>
<section id="自由エネルギーのさらに鋭い評価" class="level3" data-number="3.5">
<h3 data-number="3.5" class="anchored" data-anchor-id="自由エネルギーのさらに鋭い評価"><span class="header-section-number">3.5</span> 自由エネルギーのさらに鋭い評価</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（KL 乖離度は指数収束する）^[[@Krzakala-Zdeborova2024 p.132]補題10．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（KL 乖離度は指数収束する）<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p>高温領域 <span class="math inline">\(\Delta&gt;\Delta_c\)</span> において，ある <span class="math inline">\(C&gt;0\)</span> が存在して，任意の <span class="math inline">\(N\in\mathbb{N}^+\)</span> について次が成り立つ：</p>
<p><span class="math display">\[\begin{align*}
    F_N(\Delta)=\mathop{\mathrm{KL}}\biggr(p(y)\,\bigg|\,q(y)\biggl)\le e^{-CN}
\end{align*}\]</span></p>
<p>ただし，<span class="math inline">\(p\)</span> は観測信号 <span class="math inline">\(Y\sim\mathrm{N}_d\left(X^*,\frac{\Delta}{N}I_d\right)\)</span> の密度，<span class="math inline">\(q\)</span> は <span class="math inline">\(\mathrm{N}_d\left(0,\frac{\Delta}{N}I_d\right)\)</span> の密度とした．</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>第 <a href="#sec-bounds-on-Phi" class="quarto-xref">3.3</a> 節で示した <span class="math inline">\(\Phi_N\)</span> の上界評価では， <span class="math display">\[\begin{align*}
    \Phi_N(\beta)&amp;=\frac{\operatorname{E}[\log\mathcal{Z}]}{N}\\
    &amp;\le\frac{1}{N}\operatorname{E}\left[\log\left(\exp\left(N\left(\frac{\beta}{2}-\log 2\right)+Z_i^*\sqrt{N\beta}\right)+1\right)\right]
\end{align*}\]</span> を得て，<span class="math inline">\(Z_i^*\)</span> の評価を回避したのであった．</p>
<p>これに正面から取り組むことで，高温領域 <span class="math inline">\(\Delta&gt;\Delta_c\)</span> での <span class="math inline">\(\Phi_N\)</span> の指数収束を示すことができる．</p>
<p>高温領域 <span class="math inline">\(\Delta&gt;\Delta_c\)</span> では， <span class="math display">\[
f:=-\frac{\beta}{2}+\log2&gt;0
\]</span> が成り立つ．</p>
<p><span class="math inline">\(Z_{i^*}\)</span> は，まず <span class="math inline">\(X^*\)</span> によって条件付ければ <span class="math inline">\(Z_{i^*}|X^*\sim\mathrm{N}(0,1)\)</span> であるから， <span class="math display">\[\begin{align*}
    N\Phi_N(\beta)&amp;\le\operatorname{E}\left[\log\biggr(e^{-fN+Z_{i^*}\sqrt{N\beta}}+1\biggl)\right]\\
    &amp;=\int_\mathbb{R}\frac{e^{-\frac{z^2}{2}}}{\sqrt{2\pi}}\log\biggr(e^{-fN+z\sqrt{N\beta}}+1\biggl)\,dz\\
    &amp;=\left(\int^{R}_{-\infty}+\int_{R}^\infty\right)\frac{e^{-\frac{z^2}{2}}}{\sqrt{2\pi}}\log\biggr(e^{-fN+z\sqrt{N\beta}}+1\biggl)\,dz
\end{align*}\]</span> と分解すると，まず <span class="math inline">\((-\infty,R)\)</span> 上の積分は <span class="math inline">\(N\to\infty\)</span> に関して指数収束する．</p>
<p>実際，<span class="math inline">\(R&gt;0\)</span> に対して <span class="math inline">\(N\in\mathbb{N}^+\)</span> を十分大きく取ることで，ある <span class="math inline">\(\epsilon&gt;0\)</span> が存在して <span class="math display">\[
-fN+z\sqrt{N\beta}\le-\epsilon fN
\]</span> を満たすようにできるから，</p>
<p><span class="math display">\[\begin{align*}
    &amp;\quad\int^{R}_{-\infty}\frac{e^{-\frac{z^2}{2}}}{\sqrt{2\pi}}\log\biggr(e^{-fN+z\sqrt{N\beta}}+1\biggl)\,dz\\
    &amp;&lt;\int_\mathbb{R}\frac{e^{-\frac{z^2}{2}}}{\sqrt{2\pi}}\log\biggr(e^{-\epsilon fN}+1\biggl)\,dz\\
    &amp;=\log\left(1+e^{-\epsilon fN}\right)\le e^{-\epsilon fN}.
\end{align*}\]</span> 最後の不等式は <span class="math display">\[
\log(1+x)\le x\quad x\in\mathbb{R}
\]</span> による．</p>
<p>従って，あとは <span class="math inline">\((R,\infty)\)</span> 上の積分が指数収束することを示せば良いが，再び <span class="math inline">\(\log(1+x)\le x\)</span> に注意して <span class="math display">\[\begin{align*}
    &amp;\quad\int^\infty_\mathbb{R}\frac{e^{-\frac{z^2}{2}}}{\sqrt{2\pi}}\log\left(e^{-fN+z\sqrt{N\beta}}+1\right)\,dz\\
    &amp;\le\int^\infty_\mathbb{R}\frac{1}{\sqrt{2\pi}}e^{-fN+z\sqrt{N\beta}-\frac{z^2}{2}}\,dz\\
    &amp;=e^{\frac{N\beta}{2}-fN}\int^\infty_\mathbb{R}\frac{1}{\sqrt{2\pi}}e^{-\frac{(z-\sqrt{N\beta})^2}{2}}\,dz\\
    &amp;=e^{\frac{N\beta}{2}-fN}\operatorname{P}\biggl[Z&gt;R-\sqrt{N\beta}\biggr]
\end{align*}\]</span> と評価できるから，あとは <span class="math inline">\(Z\sim\gamma_1\)</span> の尾部確率が指数収束するかどうか（正確には劣 Gauss 性を持つかどうか）の問題に帰着する．</p>
<p>実はこれは yes である．中心化された確率変数の積率母関数が，ある <span class="math inline">\(\sigma&gt;0\)</span> に関して <span class="math display">\[
\operatorname{E}[e^{\lambda\xi}]\le e^{\frac{\lambda^2\sigma^2}{2}}\quad\lambda\in\mathbb{R}
\]</span> を満たすことは，ある <span class="math inline">\(\kappa&gt;0\)</span> が存在して <span class="math display">\[
\operatorname{P}[\lvert\xi\rvert\ge t]\le 2e^{-\frac{t^2}{2\kappa^2}}
\]</span> を満たすことに同値になる．特に，<span class="math inline">\(\Rightarrow\)</span> 方向には <span class="math inline">\(\kappa=\sigma\)</span> ととれる．<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a> <span class="math inline">\(\Phi_N\)</span> の上界評価（第 <a href="#sec-bounds-on-Phi" class="quarto-xref">3.3</a> 節）で触れたように，（中心化された）Gauss 確率変数はこれを満たす．</p>
<p>よって， <span class="math display">\[\begin{align*}
    &amp;\quad e^{\frac{N\beta}{2}-fN}\operatorname{P}\biggl[Z&gt;R-\sqrt{N\beta}\biggr]\\
    &amp;\le e^{\frac{N\beta}{2}-fN}e^{-\frac{(R-\sqrt{N\beta})^2}{2}}\\
    &amp;=e^{\frac{N\beta}{2}-fN}e^{-\frac{R^2}{2}+\sqrt{N\beta}R-\frac{N\beta}{2}}\\
    &amp;=\exp\left(-\frac{R^2}{2}+\sqrt{N\beta}R-Nf\right).
\end{align*}\]</span></p>
<p>この最右辺，ある定数 <span class="math inline">\(C&gt;0\)</span> が存在して，<span class="math inline">\(e^{-CN}\)</span> で抑えられる．</p>
<div class="footnote-size">
<p>あるいは，任意の <span class="math inline">\(N\in\mathbb{N}^+\)</span> に対して <span class="math display">\[
R:=\sqrt{\frac{N}{\beta}}f-\delta\quad\delta&gt;0
\]</span> と取ることで，<span class="math inline">\((-\infty,R),(R,\infty)\)</span> 上の積分のそれぞれについて，同様の評価を得る．</p>
</div>
<p>以上より， <span class="math display">\[\begin{align*}
    F_N(\Delta)&amp;=N\Phi_N\\
    &amp;\le e^{-KN}.
\end{align*}\]</span></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（劣 Gauss 確率変数の特徴付け）^[[@Vershynin18-HighDimensional p.25]命題2.5.2．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（劣 Gauss 確率変数の特徴付け）<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a>
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(X\in L(\Omega)\)</span> を確率変数とする．このとき，次の４条件は同値で，さらに <span class="math inline">\(\{K_1,\cdots,K_5\}\subset\mathbb{R}^+\)</span> はある <span class="math inline">\(C\in\mathbb{R}\)</span> が存在して，<span class="math inline">\(\forall_{i,j\in[5]}\;K_j\le CK_i\)</span> を満たすように取れる．</p>
<ol type="1">
<li>尾部確率の評価：ある <span class="math inline">\(K_1&gt;0\)</span> が存在して，<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a> <span class="math display">\[
\mathrm{P}[\lvert X\rvert\ge t]\le 2e^{-\frac{t^2}{K_1^2}},\qquad t\ge0.
\]</span></li>
<li><span class="math inline">\(L^p\)</span>-ノルムの評価：ある <span class="math inline">\(K_2&gt;0\)</span> が存在して， <span class="math display">\[
\|X\|_{L^p}\le K_2\sqrt{p},\qquad p\ge1.
\]</span></li>
<li><span class="math inline">\(X^2\)</span> の積率母関数の <span class="math inline">\(0\)</span> の近傍での評価：ある <span class="math inline">\(K_3&gt;0\)</span> が存在して， <span class="math display">\[
\lvert\lambda\rvert\le\frac{1}{K_3}\quad\Rightarrow\quad \mathrm{E}[e^{\lambda^2 X^2}]\le e^{K_3^2\lambda^2}.
\]</span></li>
<li><span class="math inline">\(X^2\)</span> の積率母関数のある1点での値：ある <span class="math inline">\(K_4&gt;0\)</span> が存在して， <span class="math display">\[
\operatorname{E}\left[e^{\frac{X^2}{K_4^2}}\right]\le2.
\]</span></li>
<li>さらに，<span class="math inline">\(X\)</span> が中心化されている場合，次とも同値：ある <span class="math inline">\(K_5&gt;0\)</span> が存在して， <span class="math display">\[
\operatorname{E}[e^{\lambda X}]\le e^{K^2_5\lambda^2},\qquad\lambda\in\mathbb{R}.
\]</span></li>
</ol>
<p>以上の同値な条件を満たす確率変数 <span class="math inline">\(X\)</span> を <strong>劣 Gauss</strong> (sub-Gaussian) という．</p>
</div>
</div>
</section>
<section id="まとめ" class="level3" data-number="3.6">
<h3 data-number="3.6" class="anchored" data-anchor-id="まとめ"><span class="header-section-number">3.6</span> まとめ</h3>
<p>大変単純化された設定 toy model であったが，比例的高次元極限 <span class="math inline">\(N\to\infty\)</span> において，厳密に示せる相転移を示す模型である．</p>
<p>すなわち，ただ一つの非零成分 <span class="math inline">\(1\)</span> に対して，ノイズの分散 <span class="math inline">\(\sigma^2\)</span> が <span class="math inline">\((2\log2)^{-1}\)</span> より大きいかどうかで，これが復号可能かどうかが決まる．</p>
<p>この <span class="math inline">\(2\log2\)</span> という値は <span class="citation" data-cites="Donoho-Johnstone1994">(<a href="#ref-Donoho-Johnstone1994" role="doc-biblioref">Donoho &amp; Johnstone, 1994</a>)</span> が universal threshold と呼ぶ値の例であり，ランダムエネルギーモデルのスピングラス相転移境界とも対応する．<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a></p>
<p>一般のモデルでは，この臨界温度の値は不明である上に，<span class="math inline">\(\Delta&gt;\Delta_c\)</span> の高温領域での効率的な推定法が見つかっていない場合も多い．</p>
<p>このような，高次元統計推測の問題においては，統計物理学，特にスピングラス理論の知見が活発に応用されて，漸近極限における相図の解明，統計計算手法の開発が目指されている．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="scheme.jpeg" class="img-fluid figure-img"></p>
<figcaption>Schematic representation of a typical high-dimensional inference problem from <span class="citation" data-cites="Zdeborova-Krzakala2016">(<a href="#ref-Zdeborova-Krzakala2016" role="doc-biblioref">Zdeborová &amp; Krzakala, 2016, p. 466</a>)</span></figcaption>
</figure>
</div>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Stat/Bayes2.html" target="_blank">
            <img src="https://raw.githubusercontent.com/162348/162348.github.io/main/thumbnail.svg" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">ベイズ統計学とスピングラス</h3>
                <p class="article-description">誤り訂正符号を題材にして</p>
            </div>
        </a>
    </div>
</div>
</section>
</section>



<div id="quarto-appendix" class="default"><section id="終わりに" class="level2 appendix" data-number="4"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">4</span> 終わりに</h2><div class="quarto-appendix-contents">

<p>第 <a href="#sec-sparse-vector-denoising" class="quarto-xref">3</a> 節において，統計力学の知見は，レプリカ法などの計算手法を通じて，<span class="math inline">\(N\to\infty\)</span> における漸近極限として，「大規模な確率分布から平均値を計算するための”ツールボックス”」<span class="citation" data-cites="樺島祥介2003">(<a href="#ref-樺島祥介2003" role="doc-biblioref">樺島祥介, 2003</a>)</span> として働いている．</p>
<blockquote class="blockquote">
<p>大自由度系では，次元に関して計算量が指数約に爆発してしまう．平衡統計力学の歴史はこの問題との戦いの歴史である，と言っても過言ではない．<span class="citation" data-cites="樺島-杉浦2008">(<a href="#ref-樺島-杉浦2008" role="doc-biblioref">樺島祥介 &amp; 杉浦正康, 2008, p. 22</a>)</span></p>
</blockquote>



</div></section><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Derrida1980" class="csl-entry" role="listitem">
Derrida, B. (1980). Random-energy model: Limit of a family of disordered models. <em>Phys. Rev. Lett.</em>, <em>45</em>, 79–82. <a href="https://doi.org/10.1103/PhysRevLett.45.79">https://doi.org/10.1103/PhysRevLett.45.79</a>
</div>
<div id="ref-Donoho-Johnstone1994" class="csl-entry" role="listitem">
Donoho, D. L., &amp; Johnstone, I. M. (1994). Ideal spatial adaptation by wavelet shrinkage. <em>Biometrika</em>, <em>81</em>(3), 425–455. <a href="http://www.jstor.org/stable/2337118">http://www.jstor.org/stable/2337118</a>
</div>
<div id="ref-Guo+2005" class="csl-entry" role="listitem">
Guo, D., Shamai, S., &amp; Verdu, S. (2005). Mutual information and minimum mean-square error in gaussian channels. <em>IEEE Transactions on Information Theory</em>, <em>51</em>(4), 1261–1282. <a href="https://doi.org/10.1109/TIT.2005.844072">https://doi.org/10.1109/TIT.2005.844072</a>
</div>
<div id="ref-Iba1999" class="csl-entry" role="listitem">
Iba, Y. (1999). <span class="nocase">The Nishimori line and Bayesian statistics</span>. <em>Journal of Physics A: Mathematical and General</em>, <em>32</em>(21), 3875. <a href="https://doi.org/10.1088/0305-4470/32/21/302">https://doi.org/10.1088/0305-4470/32/21/302</a>
</div>
<div id="ref-Jaynes1957" class="csl-entry" role="listitem">
Jaynes, E. T. (1957). Information theory and statistical mechanics. <em>Phys. Rev.</em>, <em>106</em>, 620–630. <a href="https://doi.org/10.1103/PhysRev.106.620">https://doi.org/10.1103/PhysRev.106.620</a>
</div>
<div id="ref-Krzakala-Zdeborova2024" class="csl-entry" role="listitem">
Krazakala, F., &amp; Zdeborová, L. (2024). <em>Statistical physics methods in optimization and machine learning</em>. <a href="https://sphinxteam.github.io/EPFLDoctoralLecture2021/Notes.pdf">https://sphinxteam.github.io/EPFLDoctoralLecture2021/Notes.pdf</a>
</div>
<div id="ref-Krzakala+2015" class="csl-entry" role="listitem">
Krzakala, F., Zdeborova, L., Angelini, M. C., &amp; Caltagirone, F. (2015). <em>Statistical physics of inference and bayesian estimation</em>. <a href="https://indico.ictp.it/event/a14244/material/10/0.pdf">https://indico.ictp.it/event/a14244/material/10/0.pdf</a>
</div>
<div id="ref-Mezard-Montanari2009" class="csl-entry" role="listitem">
Mézard, M., &amp; Montanari, A. (2009). <em>Information, physics, and computation</em>. Oxford University Press. <a href="https://doi.org/10.1093/acprof:oso/9780198570837.001.0001">https://doi.org/10.1093/acprof:oso/9780198570837.001.0001</a>
</div>
<div id="ref-西森1980" class="csl-entry" role="listitem">
Nishimori, H. (1980). Exact results and critical properties of the ising model with competing interactions. <em>Journal of Physics C: Solid State Physics</em>, <em>13</em>(21), 4071. <a href="https://doi.org/10.1088/0022-3719/13/21/012">https://doi.org/10.1088/0022-3719/13/21/012</a>
</div>
<div id="ref-Shalev-Shwartz-Ben-David2014" class="csl-entry" role="listitem">
Shalev-Shwartz, S., &amp; Ben-David, S. (2014). <em>Understanding machine learning: From theory to algorithms</em>. Cambridge University Press. <a href="https://doi.org/10.1017/CBO9781107298019">https://doi.org/10.1017/CBO9781107298019</a>
</div>
<div id="ref-Stein1972" class="csl-entry" role="listitem">
Stein, C. (1972). <em><span class="nocase">A Bound for the Error in the Normal Approximation to the Distribution of a Sum of Dependent Random Variables</span></em>. Stanford University. <a href="https://purl.stanford.edu/jc818sv7483">https://purl.stanford.edu/jc818sv7483</a>
</div>
<div id="ref-Storopoli2021" class="csl-entry" role="listitem">
Storopoli, J. (2021). <em>Bayesian statistics with julia and turing</em>. <a href="https://storopoli.io/Bayesian-Julia">https://storopoli.io/Bayesian-Julia</a>
</div>
<div id="ref-Vershynin18-HighDimensional" class="csl-entry" role="listitem">
Vershynin, R. (2018). <em>High-dimensional probability</em> (Vol. 47). Cambridge University Press.
</div>
<div id="ref-Zdeborova-Krzakala2016" class="csl-entry" role="listitem">
Zdeborová, L., &amp; Krzakala, F. (2016). Statistical physics of inference: Thresholds and algorithms. <em>Advances in Physics</em>, <em>65</em>(5), 453–552. <a href="https://doi.org/10.1080/00018732.2016.1211393">https://doi.org/10.1080/00018732.2016.1211393</a>
</div>
<div id="ref-樺島祥介2003" class="csl-entry" role="listitem">
樺島祥介. (2003). コトの物理学：誤り訂正符号を例として. <em>日本物理学会誌</em>, <em>58</em>(4), 239–246. <a href="https://doi.org/10.11316/butsuri1946.58.239">https://doi.org/10.11316/butsuri1946.58.239</a>
</div>
<div id="ref-樺島-杉浦2008" class="csl-entry" role="listitem">
樺島祥介, &amp; 杉浦正康. (2008). コトの物理学. <em>物性研究</em>, <em>91</em>(1), 1–33. <a href="http://hdl.handle.net/2433/142666">http://hdl.handle.net/2433/142666</a>
</div>
<div id="ref-西森秀稔2005" class="csl-entry" role="listitem">
西森秀稔. (2005). <em>相転移・臨界現象の統計物理学</em> (Vol. 35). 培風館. <a href="https://www.kyoritsu-pub.co.jp/book/b10003637.html">https://www.kyoritsu-pub.co.jp/book/b10003637.html</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><span class="citation" data-cites="Zdeborova-Krzakala2016">(<a href="#ref-Zdeborova-Krzakala2016" role="doc-biblioref">Zdeborová &amp; Krzakala, 2016, p. 467</a>)</span> も参照．<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><span class="citation" data-cites="Shalev-Shwartz-Ben-David2014">(<a href="#ref-Shalev-Shwartz-Ben-David2014" role="doc-biblioref">Shalev-Shwartz &amp; Ben-David, 2014, p. 25</a>)</span> や <span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala &amp; Zdeborová, 2024, p. 119</a>)</span> に倣った．<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala &amp; Zdeborová, 2024, p. 122</a>)</span>．<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p><span class="citation" data-cites="Zdeborova-Krzakala2016">(<a href="#ref-Zdeborova-Krzakala2016" role="doc-biblioref">Zdeborová &amp; Krzakala, 2016, p. 464</a>)</span>，<span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala &amp; Zdeborová, 2024, p. 123</a>)</span> 定理13，<span class="citation" data-cites="Iba1999">(<a href="#ref-Iba1999" role="doc-biblioref">Iba, 1999, pp. 3876–3877</a>)</span> などで扱われている．西森ライン上のみで見られる性質であるため，西森対称性と呼ぶ．西森ラインについては <a href="../../../posts/2024/Stat/Bayes2.html#sec-Nishimori-line">次項</a> も参照．<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p><span class="citation" data-cites="Mezard-Montanari2009">(<a href="#ref-Mezard-Montanari2009" role="doc-biblioref">Mézard &amp; Montanari, 2009, p. 249</a>)</span> や <span class="citation" data-cites="Iba1999">(<a href="#ref-Iba1999" role="doc-biblioref">Iba, 1999, p. 3876</a>)</span> などでは thermal average と quenched average の用語が採用されている．<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala &amp; Zdeborová, 2024, p. 124</a>)</span> 定理14．<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p><span class="citation" data-cites="西森秀稔2005">(<a href="#ref-西森秀稔2005" role="doc-biblioref">西森秀稔, 2005, p. 123</a>)</span>なども参照．<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala &amp; Zdeborová, 2024, p. 125</a>)</span> 定理15，<span class="citation" data-cites="樺島-杉浦2008">(<a href="#ref-樺島-杉浦2008" role="doc-biblioref">樺島祥介 &amp; 杉浦正康, 2008, p. 14</a>)</span> なども参照．証明は <span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala &amp; Zdeborová, 2024, p. 133</a>)</span> 7.B 節 を参考にした．<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala &amp; Zdeborová, 2024, p. 125</a>)</span>補題８．<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala &amp; Zdeborová, 2024, p. 126</a>)</span>補題９．<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(<a href="#ref-Krzakala-Zdeborova2024" role="doc-biblioref">Krazakala &amp; Zdeborová, 2024, p. 132</a>)</span>補題10．<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p><span class="citation" data-cites="Vershynin18-HighDimensional">(<a href="#ref-Vershynin18-HighDimensional" role="doc-biblioref">Vershynin, 2018, p. 25</a>)</span>命題2.5.2など．<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p><span class="citation" data-cites="Vershynin18-HighDimensional">(<a href="#ref-Vershynin18-HighDimensional" role="doc-biblioref">Vershynin, 2018, p. 25</a>)</span>命題2.5.2．<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>この定数2は，1よりも真に大きい定数ならばなんでも良い．<span class="citation" data-cites="Vershynin18-HighDimensional">(<a href="#ref-Vershynin18-HighDimensional" role="doc-biblioref">Vershynin, 2018, p. 27</a>)</span>注2.5.3 も参照．<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn15"><p><span class="citation" data-cites="Krzakala+2015">(<a href="#ref-Krzakala+2015" role="doc-biblioref">Krzakala et al., 2015, p. 8</a>)</span> も参照すべし．<a href="#fnref15" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="162348/162348.github.io" data-repo-id="R_kgDOKlfKYQ" data-category="Announcements" data-category-id="DIC_kwDOKlfKYc4CgDmb" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" data-loading="lazy" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://162348.github.io/">
<p>Hirofumi Shiba</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/162348/162348.github.io/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ano2math5">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:shiba.hirofumi@ism.ac.jp">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../../blog.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>