<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="司馬 博文">

<title>Hirofumi Shiba - 大規模な不均衡データに対するロジスティック回帰（後編）</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../profile.jpg" rel="icon" type="image/jpeg">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "?",
    "H"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-36GX2G6GLL"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-36GX2G6GLL', { 'anonymize_ip': true});
</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Zen+Kurenaido&amp;display=swap" rel="stylesheet">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=BIZ+UDPGothic&amp;display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="Hirofumi Shiba - 大規模な不均衡データに対するロジスティック回帰（後編）">
<meta property="og:description" content="ロジットモデルやプロビットモデルの事後分布からのサンプリングには，その混合構造を利用したデータ拡張による Gibbs サンプラーが考案されている．しかし，このような Gibbs サンプラーは不明な理由で極めて収束が遅くなることがよく見られ，そのうちの１つのパターンが 大規模な不均衡データ である．前編ではこの現象がなぜ起こるかに関して考察した．ここでは代替手法として Zig-Zag サンプラーがうまくいくことをみる．">
<meta property="og:image" content="https://162348.github.io/posts/2024/Stat/Logistic.svg">
<meta property="og:site_name" content="Hirofumi Shiba">
<meta name="twitter:title" content="Hirofumi Shiba - 大規模な不均衡データに対するロジスティック回帰（後編）">
<meta name="twitter:description" content="ロジットモデルやプロビットモデルの事後分布からのサンプリングには，その混合構造を利用したデータ拡張による Gibbs サンプラーが考案されている．しかし，このような Gibbs サンプラーは不明な理由で極めて収束が遅くなることがよく見られ，そのうちの１つのパターンが 大規模な不均衡データ である．前編ではこの現象がなぜ起こるかに関して考察した．ここでは代替手法として Zig-Zag サンプラーがうまくいくことをみる．">
<meta name="twitter:image" content="https://162348.github.io/posts/2024/Stat/Logistic.svg">
<meta name="twitter:creator" content="@ano2math5">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Hirofumi Shiba</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Sessions.html"> 
<span class="menu-text">Sessions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Japanese.html"> 
<span class="menu-text">自己紹介</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
    <a href="https://github.com/162348/162348.github.io/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">大規模な不均衡データに対するロジスティック回帰（後編）</h1>
            <p class="subtitle lead">離散時間 MCMC から連続時間 MCMC へ</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Bayesian</div>
                <div class="quarto-category">Computation</div>
                <div class="quarto-category">Python</div>
                <div class="quarto-category">MCMC</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>司馬 博文 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">7/18/2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">7/20/2024</p>
      </div>
    </div>
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="block-title">概要</div>
      ロジットモデルやプロビットモデルの事後分布からのサンプリングには，その混合構造を利用したデータ拡張による Gibbs サンプラーが考案されている．しかし，このような Gibbs サンプラーは不明な理由で極めて収束が遅くなることがよく見られ，そのうちの１つのパターンが <strong>大規模な不均衡データ</strong> である．前編ではこの現象がなぜ起こるかに関して考察した．ここでは代替手法として Zig-Zag サンプラーがうまくいくことをみる．
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目次</h2>
   
  <ul>
  <li><a href="#zig-zag-サンプラーによる解決" id="toc-zig-zag-サンプラーによる解決" class="nav-link active" data-scroll-target="#zig-zag-サンプラーによる解決"><span class="header-section-number">1</span> Zig-Zag サンプラーによる解決</a>
  <ul class="collapse">
  <li><a href="#導入" id="toc-導入" class="nav-link" data-scroll-target="#導入"><span class="header-section-number">1.1</span> 導入</a></li>
  <li><a href="#事後分布の特徴" id="toc-事後分布の特徴" class="nav-link" data-scroll-target="#事後分布の特徴"><span class="header-section-number">1.2</span> 事後分布の特徴</a></li>
  <li><a href="#poisson-剪定" id="toc-poisson-剪定" class="nav-link" data-scroll-target="#poisson-剪定"><span class="header-section-number">1.3</span> Poisson 剪定</a></li>
  <li><a href="#サブサンプリング" id="toc-サブサンプリング" class="nav-link" data-scroll-target="#サブサンプリング"><span class="header-section-number">1.4</span> サブサンプリング</a></li>
  <li><a href="#数値実験による性能比較" id="toc-数値実験による性能比較" class="nav-link" data-scroll-target="#数値実験による性能比較"><span class="header-section-number">1.5</span> 数値実験による性能比較</a></li>
  <li><a href="#有効サンプル数の計算" id="toc-有効サンプル数の計算" class="nav-link" data-scroll-target="#有効サンプル数の計算"><span class="header-section-number">1.6</span> 有効サンプル数の計算</a></li>
  </ul></li>
  <li><a href="#高次元へのスケーリング" id="toc-高次元へのスケーリング" class="nav-link" data-scroll-target="#高次元へのスケーリング"><span class="header-section-number">2</span> 高次元へのスケーリング</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
<p>$$</p>
<p>$$</p>
</div>
<p>前稿はこちら：</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Stat/Logistic.html" target="_blank">
            <img src="https://162348.github.io/posts/2024/Stat/Logistic.svg" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">大規模な不均衡データに対するロジスティック回帰（前編）</h3>
                <p class="article-description">離散時間 MCMC から連続時間 MCMC へ</p>
            </div>
        </a>
    </div>
</div>
<section id="zig-zag-サンプラーによる解決" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Zig-Zag サンプラーによる解決</h1>
<section id="導入" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="導入"><span class="header-section-number">1.1</span> 導入</h2>
<p>説明変数 <span class="math inline">\(X\in\mathcal{L}(\Omega;\mathbb{R}^p)\)</span> と係数 <span class="math inline">\(\xi\in\mathcal{L}(\Omega;\mathbb{R}^p)\)</span> に関するロジスティックモデル</p>
<p><span class="math display">\[
\operatorname{P}[Y=1\,|\,X,\xi]=g^{-1}(X^\top\xi)=\frac{\exp(X^\top\xi)}{1+\exp(X^\top\xi)}\tag{1}
\]</span></p>
<p>において，<span class="math inline">\(\{y^i\}\)</span> または <span class="math inline">\(\{x^i_j\}\)</span> が不均衡であった場合は，前節で見たように Gibbs サンプラーによる方法ではスケールしない．</p>
<p>よく調整された Metropolis-Hastings 法を用いることが解決の１つとしてあり得るが，やはり本当に大きな <span class="math inline">\(n,p\)</span> に関してスケールしないことが問題である．</p>
</section>
<section id="事後分布の特徴" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="事後分布の特徴"><span class="header-section-number">1.2</span> 事後分布の特徴</h2>
<p>実は，ロジスティック回帰ではポテンシャル <span class="math inline">\(U\)</span> の勾配が有界になり，簡単なサブサンプリングが可能である．</p>
<p>事後分布の負の対数密度は <span class="math display">\[\begin{align*}
    U(\xi)&amp;:=-\log p_0(\xi)-\sum_{i=1}^n\log\left(\frac{\exp(y^i(x^i)^\top\xi)}{1+\exp((x^i)^\top\xi)}\right)\\
    &amp;=:U_0(\xi)+U_1(\xi)
\end{align*}\]</span> と表せる．</p>
<p><span class="math display">\[
U_1(\xi)=\frac{1}{n}\sum_{j=1}^nU^j_1(\xi)
\]</span> <span class="math display">\[
U_1^j(\xi)=-n\log\left(\frac{\exp\left(y^j(x^j)^\top\xi\right)}{1+\exp\left((x^j)^\top\xi\right)}\right)
\]</span> であるから， <span class="math display">\[
\partial_iU^j_1(\xi)=n\frac{x^j_i\exp\left((x^j)^\top\xi\right)}{1+\exp\left((x^j)^\top\xi\right)}-ny^jx^j_i&lt;nx^j_i(1-y^j)
\]</span> を得る．</p>
</section>
<section id="poisson-剪定" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="poisson-剪定"><span class="header-section-number">1.3</span> Poisson 剪定</h2>
<p>特に各 <span class="math inline">\(\partial_iU_1(\xi)\)</span> のバウンドとして <span class="math display">\[
\lvert\partial_iU^j_1(\xi)\rvert\le n\max_{j\in[n]}\lvert x^j_i\rvert\qquad i\in[d]
\]</span> を得るから， <span class="math display">\[
\lambda_i(\xi,\theta)=\biggr(\theta_i\partial_iU(\xi)\biggl)_+\le\biggr(n\theta_i\max_{j\in[n]}\lvert x^j_i\rvert\biggl)_+
\]</span> を元に剪定を実行できる．</p>
<div id="ac92b800" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>サブサンプリングなしの Zig-Zag 過程のシミュレーションをする関数 ZZ1d() を定義</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ZigZagBoomerang</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LinearAlgebra</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Statistics</span>  <span class="co"># just for sure</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsFuns</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="st">    ∇U(i,j,ξ,x,y)</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="st">        i ∈ [d]: 次元を表すインデックス</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="st">        j ∈ [n]: サンプル番号を表すインデックス</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="st">        ξ: パラメータ空間 R^d 上の位置</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="st">        他，観測 (x,y) を引数にとる．</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="st">    この関数を実装する際，log の中身をそのまま計算しようとすると大変大きくなり，数値的に不安定になる（除算の後は 1 近くになるはずだが，Inf になってしまう）</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">∇U</span>(i<span class="op">::</span><span class="dt">Int64</span>, j<span class="op">::</span><span class="dt">Int64</span>, ξ, x<span class="op">::</span><span class="dt">Matrix{Float64}</span>, y<span class="op">::</span><span class="dt">Vector{Float64}</span>) <span class="op">=</span> <span class="fu">length</span>(y) <span class="op">*</span> x[i,j] <span class="op">*</span> (<span class="fu">logistic</span>(<span class="fu">dot</span>(x[<span class="op">:</span>,j],ξ)) <span class="op">-</span> y[j])</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="st">    ∇U(i,ξ,x,y)：∇U(i,j,ξ,x,y) を全データ j ∈ [n] について足し合わせたもの</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="st">        i ∈ [d]: 次元を表すインデックス</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="st">        ξ: パラメータ空間 R^d 上の位置</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="st">        他，観測 (x,y) を引数にとる．</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">∇U</span>(i<span class="op">::</span><span class="dt">Int64</span>, ξ, x<span class="op">::</span><span class="dt">Matrix{Float64}</span>, y<span class="op">::</span><span class="dt">Vector{Float64}</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="fu">length</span>(y)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    U_list <span class="op">=</span> []</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>n</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">push!</span>(U_list, <span class="fu">∇U</span>(i, j, ξ, x, y))</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">mean</span>(U_list)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span>  <span class="fu">∇U</span>(ξ, x<span class="op">::</span><span class="dt">Matrix{Float64}</span>, y<span class="op">::</span><span class="dt">Vector{Float64}</span>)  <span class="co"># 1次元の場合のショートカット</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">∇U</span>(<span class="fl">1</span>, ξ, x, y)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="fu">pos</span>(x) <span class="op">=</span> <span class="fu">max</span>(<span class="fu">zero</span>(x), x)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="st">    λ(i, ξ, θ, ∇U, x, y)：第 i ∈ [d] 次元のレート関数</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="st">        i ∈ [d]: 次元を表すインデックス</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="st">        (ξ,θ): E 上の座標</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="st">        ∇U</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="st">        (x,y): 観測</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="fu">λ</span>(i<span class="op">::</span><span class="dt">Int64</span>, ξ, θ, ∇U, x, y) <span class="op">=</span> <span class="fu">pos</span>(θ[i] <span class="op">*</span> <span class="fu">∇U</span>(i, ξ, x, y))</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="fu">λ</span>(ξ, θ, ∇U, x, y) <span class="op">=</span> <span class="fu">pos</span>(θ <span class="op">*</span> <span class="fu">∇U</span>(ξ, x, y))  <span class="co"># 1次元の場合のショートカット</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="st">    λ(τ, a, b)：代理レート関数の時刻 τ における値</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="st">        τ: 時間</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="st">        a,b: 1次関数の係数</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="fu">λ_bar</span>(τ, a, b) <span class="op">=</span> <span class="fu">pos</span>(a <span class="op">+</span> b<span class="op">*</span>τ)</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="st">`x`: current location, `θ`: current velocity, `t`: current time,</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">move_forward</span>(τ, t, ξ, θ, <span class="op">::</span><span class="dt">ZigZag1d</span>)</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    τ <span class="op">+</span> t, ξ <span class="op">+</span> θ<span class="op">*</span>τ , θ</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="st">    ZZ1d(∇U, ξ, θ, T, x, y, Flow; rng=Random.GLOBAL_RNG, ab=ab_Global)：ZigZag sampler without subsampling</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="st">        `∇U`: gradient of the negative log-density</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="st">        `(ξ,θ)`: initial state</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="st">        `T`: Time Horizon</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a><span class="st">        `(x,y)`: observation</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="st">        `Flow`: continuous dynamics</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a><span class="st">        `a+bt`: computational bound for intensity m(t)</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a><span class="st">        `num`: ポアソン時刻に到着した回数</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a><span class="st">        `acc`: 受容回数．`acc/num` は acceptance rate</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">ZZ1d</span>(∇U, ξ, θ, T<span class="op">::</span><span class="dt">Float64</span>, x<span class="op">::</span><span class="dt">Matrix{Float64}</span>, y<span class="op">::</span><span class="dt">Vector{Float64}</span>, Flow<span class="op">::</span><span class="dt">ZigZagBoomerang.ContinuousDynamics</span>; rng<span class="op">=</span><span class="bu">Random</span>.GLOBAL_RNG, ab<span class="op">=</span>ab_Global)</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> <span class="fu">zero</span>(T)</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>    Ξ <span class="op">=</span> [(t, ξ, θ)]</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>    num <span class="op">=</span> acc <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    epoch_list <span class="op">=</span> [num]</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>    a, b <span class="op">=</span> <span class="fu">ab</span>(ξ, θ, x, y, Flow)</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    t′ <span class="op">=</span>  t <span class="op">+</span> <span class="fu">poisson_time</span>(a, b, <span class="fu">rand</span>())  <span class="co"># イベントは a,b が定める affine proxy に従って生成する</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> t <span class="op">&lt;</span> T</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>        τ <span class="op">=</span> t′ <span class="op">-</span> t</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>        t, ξ, θ <span class="op">=</span> <span class="fu">move_forward</span>(τ, t, ξ, θ, Flow)</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>        l, lb <span class="op">=</span> <span class="fu">λ</span>(ξ, θ, ∇U, x, y), <span class="fu">λ_bar</span>(τ, a, b)  <span class="co"># λ が真のレート, λ_bar が affine proxy</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>        num <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="fu">rand</span>()<span class="op">*</span>lb <span class="op">&lt;</span> l</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>            acc <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> l <span class="op">&gt;</span> lb <span class="op">+</span> <span class="fl">0.01</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>                <span class="fu">println</span>(l<span class="op">-</span>lb)</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>                <span class="fu">println</span>(l)</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>            θ <span class="op">=</span> <span class="op">-</span>θ</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(Ξ, (t, ξ, θ))</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(epoch_list, num)</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>        a, b <span class="op">=</span> <span class="fu">ab</span>(ξ, θ, x, y, Flow)</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>        t′ <span class="op">=</span> t <span class="op">+</span> <span class="fu">poisson_time</span>(a, b, <span class="fu">rand</span>())</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Ξ, epoch_list, acc<span class="op">/</span>num</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="3eb89fbf" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">a_Global</span>(ξ, θ, x, y) <span class="op">=</span> <span class="fu">length</span>(y) <span class="op">*</span> <span class="fu">maximum</span>(<span class="fu">abs</span>.(<span class="fu">vec</span>(x)))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">b_Global</span>(ξ, θ, x, y) <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ab_Global</span>(ξ, θ, x, y, <span class="op">::</span><span class="dt">ZigZag1d</span>) <span class="op">=</span> (<span class="fu">a_Global</span>(ξ, θ, x, y), <span class="fu">b_Global</span>(ξ, θ, x, y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>そこで，さらにタイトに，次の affine 関数による評価を考えることになる： <span class="math display">\[
\overline{m}_i(t):=a_i+b_it,\qquad i\in[d],
\]</span> <span class="math display">\[
a_i:=(\theta_i\partial_iU(\xi_*))_++C_i\lvert\xi-\xi_*\rvert
\]</span> <span class="math display">\[
b_i:=C_i\sqrt{d},\qquad C_i:=\frac{n}{4}\max_{j\in[n]}\lvert x^j_i\rvert\lvert x^j\rvert.
\]</span></p>
<div id="91de8f63" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>preprocessing for ZZ-CV of complexity O(n)</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="st">    U(ξ, x, y)：ポテンシャル関数</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="st">        ξ: パラメータ空間上の点</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="st">        (x,y): 観測</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">U</span>(ξ, x, y)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="fu">length</span>(y)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    U_list <span class="op">=</span> []</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>n</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">push!</span>(U_list, <span class="fu">U</span>(j, ξ, x, y))</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">mean</span>(U_list)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">U</span>(j, ξ, x, y)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="fu">length</span>(y)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    product <span class="op">=</span> <span class="fu">dot</span>(x[<span class="op">:</span>,j],ξ)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span>n <span class="op">*</span> <span class="fu">log</span>(<span class="fu">exp</span>(y[j] <span class="op">*</span> product) <span class="op">/</span> (<span class="fl">1</span> <span class="op">+</span> <span class="fu">exp</span>(product)))</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsFuns</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>ξ<span class="fl">0</span> <span class="op">=</span> [<span class="fl">1</span>] <span class="co"># True value</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>n_list <span class="op">=</span> [<span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">1000</span>]  <span class="co"># 実験で用いるサンプルサイズの列</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>Σ <span class="op">=</span> [<span class="fl">2</span>]</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="fu">rand</span>(<span class="fu">MvNormal</span>(ξ<span class="fl">0</span>, Σ), n_list[<span class="kw">end</span>])</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="fu">rand</span>.(<span class="fu">Bernoulli</span>.(<span class="fu">logistic</span>.(ξ<span class="fl">0</span><span class="op">*</span>x)))  <span class="co"># BitVector になってしまう</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="fu">Float64</span>.(<span class="fu">vec</span>(y))  <span class="co"># Vector{Float64} に変換</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="37cfacda" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Optim</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> <span class="fu">optimize</span>(ξ <span class="op">-&gt;</span> <span class="fu">U</span>(ξ, x, y), [<span class="fl">0.0</span>], <span class="fu">LBFGS</span>())</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>ξ_star <span class="op">=</span> Optim.<span class="fu">minimizer</span>(result)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">C</span>(ξ, θ, x, y)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="fu">length</span>(y)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    max_value <span class="op">=</span> <span class="fu">maximum</span>(x<span class="op">.^</span><span class="fl">2</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> n <span class="op">*</span> max_value <span class="op">/</span> <span class="fl">4</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">a_Affine</span>(ξ, θ, x, y) <span class="op">=</span> <span class="fu">pos</span>(θ <span class="op">*</span> <span class="fu">∇U</span>(ξ_star,x,y)) <span class="op">+</span> <span class="fu">C</span>(ξ, θ, x, y) <span class="op">*</span> <span class="fu">abs</span>(ξ <span class="op">-</span> ξ_star[<span class="fl">1</span>])</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">b_Affine</span>(ξ, θ, x, y) <span class="op">=</span> <span class="fu">C</span>(ξ, θ, x, y)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># computational bounds for intensity m(t)</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ab_Affine</span>(ξ, θ, x, y, <span class="op">::</span><span class="dt">ZigZag1d</span>) <span class="op">=</span> (<span class="fu">a_Affine</span>(ξ, θ, x, y), <span class="fu">b_Affine</span>(ξ, θ, x, y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="サブサンプリング" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="サブサンプリング"><span class="header-section-number">1.4</span> サブサンプリング</h2>
<p>Poisson 過程の強度関数を確率化し， <span class="math display">\[
m_i^j(t):=\biggr(\theta_i E^j_i(x+\theta t)\biggl)_+
\]</span> <span class="math display">\[
E^j_i(x):=\partial_iU(\xi_*)+\partial_iU^j(\xi)-\partial_iU^j(\xi_*)
\]</span> としても，引き続き同様の上界を持つ．</p>
<p>ここで，<span class="math inline">\(m_i^j\)</span> の評価は <span class="math inline">\(m_i\)</span> より <span class="math inline">\(n\)</span> 倍軽量になっていることに注意．</p>
<div id="928ce0a6" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>サブサンプリングありの Zig-Zag 過程のシミュレーションをする関数 ZZ1d_SS() と ZZ1d_CV() を定義</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ZigZagBoomerang</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LinearAlgebra</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Statistics</span>  <span class="co"># just for sure</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsFuns</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">λj_Global</span>(j<span class="op">::</span><span class="dt">Int64</span>, ξ, θ, ∇U, x, y)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    Eʲ <span class="op">=</span> <span class="fu">∇U</span>(<span class="fl">1</span>, j, ξ, x, y)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">pos</span>(θ <span class="op">*</span> Eʲ)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">ZZ1d_SS</span>(∇U, ξ, θ, T<span class="op">::</span><span class="dt">Float64</span>, x<span class="op">::</span><span class="dt">Matrix{Float64}</span>, y<span class="op">::</span><span class="dt">Vector{Float64}</span>, Flow<span class="op">::</span><span class="dt">ZigZagBoomerang.ContinuousDynamics</span>; rng<span class="op">=</span><span class="bu">Random</span>.GLOBAL_RNG, ab<span class="op">=</span>ab_Global)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> <span class="fu">zero</span>(T)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    Ξ <span class="op">=</span> [(t, ξ, θ)]</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    num <span class="op">=</span> acc <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    epoch_list <span class="op">=</span> [num]</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    a, b <span class="op">=</span> <span class="fu">ab</span>(ξ, θ, x, y, Flow)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    t′ <span class="op">=</span>  t <span class="op">+</span> <span class="fu">poisson_time</span>(a, b, <span class="fu">rand</span>())  <span class="co"># イベントは a,b が定める affine proxy に従って生成する</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> t <span class="op">&lt;</span> T</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>        τ <span class="op">=</span> t′ <span class="op">-</span> t</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        t, ξ, θ <span class="op">=</span> <span class="fu">move_forward</span>(τ, t, ξ, θ, Flow)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>        j <span class="op">=</span> <span class="fu">rand</span>(<span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(y))</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>        l, lb <span class="op">=</span> <span class="fu">λj_Global</span>(j, ξ, θ, ∇U, x, y), <span class="fu">λ_bar</span>(τ, a, b)  <span class="co"># λ が真のレート, λ_bar が affine proxy</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>        num <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="fu">rand</span>()<span class="op">*</span>lb <span class="op">&lt;</span> l</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>            acc <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> l <span class="op">&gt;</span> lb <span class="op">+</span> <span class="fl">0.01</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>                <span class="fu">println</span>(l<span class="op">-</span>lb)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>            θ <span class="op">=</span> <span class="op">-</span>θ</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(Ξ, (t, ξ, θ))</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(epoch_list, num)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>        a, b <span class="op">=</span> <span class="fu">ab</span>(ξ, θ, x, y, Flow)</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>        t′ <span class="op">=</span> t <span class="op">+</span> <span class="fu">poisson_time</span>(a, b, <span class="fu">rand</span>())</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Ξ, epoch_list, acc<span class="op">/</span>num</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">λj</span>(j<span class="op">::</span><span class="dt">Int64</span>, ξ, θ, ∇U, x, y)</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    Eʲ <span class="op">=</span> <span class="fu">∇U</span>(ξ_star, x, y) <span class="op">+</span> <span class="fu">∇U</span>(<span class="fl">1</span>, j, ξ, x, y) <span class="op">-</span> <span class="fu">∇U</span>(<span class="fl">1</span>, j, ξ_star, x, y)</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">pos</span>(θ <span class="op">*</span> Eʲ)</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">ZZ1d_CV</span>(∇U, ξ, θ, T<span class="op">::</span><span class="dt">Float64</span>, x<span class="op">::</span><span class="dt">Matrix{Float64}</span>, y<span class="op">::</span><span class="dt">Vector{Float64}</span>, Flow<span class="op">::</span><span class="dt">ZigZagBoomerang.ContinuousDynamics</span>; rng<span class="op">=</span><span class="bu">Random</span>.GLOBAL_RNG, ab<span class="op">=</span>ab_Affine)</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> <span class="fu">zero</span>(T)</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>    Ξ <span class="op">=</span> [(t, ξ, θ)]</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>    num <span class="op">=</span> acc <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>    epoch_list <span class="op">=</span> [num]</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>    a, b <span class="op">=</span> <span class="fu">ab</span>(ξ, θ, x, y, Flow)</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>    t′ <span class="op">=</span>  t <span class="op">+</span> <span class="fu">poisson_time</span>(a, b, <span class="fu">rand</span>())  <span class="co"># イベントは a,b が定める affine proxy に従って生成する</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> t <span class="op">&lt;</span> T</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>        τ <span class="op">=</span> t′ <span class="op">-</span> t</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>        t, ξ, θ <span class="op">=</span> <span class="fu">move_forward</span>(τ, t, ξ, θ, Flow)</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>        j <span class="op">=</span> <span class="fu">rand</span>(<span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(y))</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>        l, lb <span class="op">=</span> <span class="fu">λj</span>(j, ξ, θ, ∇U, x, y), <span class="fu">λ_bar</span>(τ, a, b)  <span class="co"># λ が真のレート, λ_bar が affine proxy</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>        num <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="fu">rand</span>()<span class="op">*</span>lb <span class="op">&lt;</span> l</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>            acc <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> l <span class="op">&gt;</span> lb <span class="op">+</span> <span class="fl">0.01</span></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>                <span class="fu">println</span>(l<span class="op">-</span>lb)</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>            θ <span class="op">=</span> <span class="op">-</span>θ</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(Ξ, (t, ξ, θ))</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(epoch_list, num)</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>        a, b <span class="op">=</span> <span class="fu">ab</span>(ξ, θ, x, y, Flow)</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>        t′ <span class="op">=</span> t <span class="op">+</span> <span class="fu">poisson_time</span>(a, b, <span class="fu">rand</span>())</span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Ξ, epoch_list, acc<span class="op">/</span>num</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="数値実験による性能比較" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="数値実験による性能比較"><span class="header-section-number">1.5</span> 数値実験による性能比較</h2>
<div id="c8b07a0b" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>サブサンプリングなしの実験を実行する関数 experiment_ZZ() を定義</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Statistics</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">ESS</span>(samples<span class="op">::</span><span class="dt">Vector{Float64}</span>, T, dt)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    B <span class="op">=</span> T <span class="op">/</span> dt</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    V <span class="op">=</span> (dt <span class="op">/</span> T) <span class="op">*</span> <span class="fu">sum</span>(samples<span class="op">.^</span><span class="fl">2</span>) <span class="op">-</span> ((dt <span class="op">/</span> T) <span class="op">*</span> <span class="fu">sum</span>(samples))<span class="op">^</span><span class="fl">2</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> samples <span class="op">.*</span> <span class="fu">sqrt</span>(T <span class="op">/</span> B)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    ESS <span class="op">=</span> T <span class="op">*</span> V <span class="op">/</span> <span class="fu">var</span>(Y)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ESS</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getESSperEpoch</span>(ab, T ,dt, x, y; ξ<span class="fl">0</span><span class="op">=</span><span class="fl">0.0</span>, θ<span class="fl">0</span><span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    trace, epochs, acc <span class="op">=</span> <span class="fu">ZZ1d</span>(∇U, ξ<span class="fl">0</span>, θ<span class="fl">0</span>, T, x, y, <span class="fu">ZigZag1d</span>(); ab<span class="op">=</span>ab)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    traj <span class="op">=</span> <span class="fu">discretize</span>(trace, <span class="fu">ZigZag1d</span>(), dt)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">ESS</span>(traj.x, T, dt) <span class="op">/</span> epochs[<span class="kw">end</span>]</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">10</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="fl">500.0</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">experiment_ZZ</span>(N, T, dt; ξ<span class="fl">0</span><span class="op">=</span><span class="fl">0.0</span>, θ<span class="fl">0</span><span class="op">=</span><span class="fl">1.0</span>, n_list<span class="op">=</span>[<span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">1000</span>])  <span class="co"># サブサンプリングなしの ZZ() に関して N 回実験</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    ESSs_sum_Affine <span class="op">=</span> <span class="fu">zero</span>(n_list)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    ESSs_sum_Global <span class="op">=</span> <span class="fu">zero</span>(n_list)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>N</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>        ESSs_Affine <span class="op">=</span> []</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>        ESSs_Global <span class="op">=</span> []</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> n <span class="kw">in</span> n_list</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(ESSs_Affine, <span class="fu">getESSperEpoch</span>(ab_Affine, T, dt, x[<span class="op">:</span>,<span class="fl">1</span><span class="op">:</span>n], y[<span class="fl">1</span><span class="op">:</span>n]; ξ<span class="fl">0</span><span class="op">=</span>ξ<span class="fl">0</span>, θ<span class="fl">0</span><span class="op">=</span>θ<span class="fl">0</span>))</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(ESSs_Global, <span class="fu">getESSperEpoch</span>(ab_Global, T, dt, x[<span class="op">:</span>,<span class="fl">1</span><span class="op">:</span>n], y[<span class="fl">1</span><span class="op">:</span>n]; ξ<span class="fl">0</span><span class="op">=</span>ξ<span class="fl">0</span>, θ<span class="fl">0</span><span class="op">=</span>θ<span class="fl">0</span>))</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>        ESSs_sum_Affine <span class="op">=</span> [ESSs_sum_Affine ESSs_Affine]</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>        ESSs_sum_Global <span class="op">=</span> [ESSs_sum_Global ESSs_Global]</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">mean</span>(ESSs_sum_Affine, dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">var</span>(ESSs_sum_Affine, dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">mean</span>(ESSs_sum_Global, dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">var</span>(ESSs_sum_Global, dims<span class="op">=</span><span class="fl">2</span>)</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>ESS_Affine, var_ESS_Affine, ESS_Global, var_ESS_Global <span class="op">=</span> <span class="fu">experiment_ZZ</span>(<span class="fl">2</span>, T, dt; ξ<span class="fl">0</span><span class="op">=</span><span class="fl">0.0</span>, θ<span class="fl">0</span><span class="op">=</span><span class="fl">1.0</span>, n_list<span class="op">=</span>n_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="fb58f7b7" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">JLD2</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="pp">@load</span> <span class="st">"Logistic2.jld2"</span> ESS_Affine var_ESS_Affine ESS_Global var_ESS_Global</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="2863e410" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>結果をプロット</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">GLM</span>, <span class="bu">DataFrames</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">startPlot</span>(n_list, ESS, var_ESS; label<span class="op">=</span><span class="st">"ZZ (Global bound)"</span>, background_color<span class="op">=</span><span class="cn">false</span>, color<span class="op">=</span><span class="st">"#78C2AD"</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> background_color</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> <span class="fu">plot</span>(<span class="co">#n_list, ESS,</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>        xscale<span class="op">=:</span>log10,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>        yscale<span class="op">=:</span>log10,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        xlabel<span class="op">=</span><span class="st">"Observations"</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>        ylabel<span class="op">=</span><span class="st">"ESS per Epoch"</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>        background_color <span class="op">=</span> <span class="st">"#F0F1EB"</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> <span class="fu">plot</span>(<span class="co">#n_list, ESS,</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>        xscale<span class="op">=:</span>log10,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>        yscale<span class="op">=:</span>log10,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>        xlabel<span class="op">=</span><span class="st">"Observations"</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>        ylabel<span class="op">=</span><span class="st">"ESS per Epoch"</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scatter!</span>(p, n_list, ESS,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>            yerror<span class="op">=</span>var_ESS,</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>            markerstrokecolor<span class="op">=</span>color,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>            marker<span class="op">=:</span>circle,</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>            markersize<span class="op">=</span><span class="fl">5</span>,</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>            markeralpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span>color,</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="cn">nothing</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> <span class="fu">DataFrame</span>(X <span class="op">=</span> <span class="fu">log10</span>.(n_list), Y <span class="op">=</span> <span class="fu">log10</span>.(<span class="fu">vec</span>(ESS)))</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> <span class="fu">lm</span>(<span class="pp">@formula</span>(Y <span class="op">~</span> X), df)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>    X_pred <span class="op">=</span> <span class="fu">range</span>(<span class="fu">minimum</span>(df.X), <span class="fu">maximum</span>(df.X), length<span class="op">=</span><span class="fl">100</span>)</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    Y_pred <span class="op">=</span> <span class="fu">predict</span>(model, <span class="fu">DataFrame</span>(X <span class="op">=</span> X_pred))</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot!</span>(p, <span class="fl">10</span> <span class="op">.^</span> X_pred, <span class="fl">10</span> <span class="op">.^</span> Y_pred,</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>        line<span class="op">=:</span>solid,</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>        linewidth<span class="op">=</span><span class="fl">2</span>,</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>color,</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span>label</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> p</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">addPlot</span>(p, n_list, ESS, var_ESS; label<span class="op">=</span><span class="st">"ZZ (Affine bound)"</span>, color<span class="op">=</span><span class="st">"#E95420"</span>)</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>    q <span class="op">=</span> <span class="fu">scatter</span>(p, n_list, ESS,</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>            yerror<span class="op">=</span>var_ESS,</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>            markerstrokecolor<span class="op">=</span>color,</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>            marker<span class="op">=:</span>circle,</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>            markersize<span class="op">=</span><span class="fl">5</span>,</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>            markeralpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span>color,</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="cn">nothing</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> <span class="fu">DataFrame</span>(X <span class="op">=</span> <span class="fu">log10</span>.(n_list), Y <span class="op">=</span> <span class="fu">log10</span>.(<span class="fu">vec</span>(ESS)))</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> <span class="fu">lm</span>(<span class="pp">@formula</span>(Y <span class="op">~</span> X), df)</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>    X_pred <span class="op">=</span> <span class="fu">range</span>(<span class="fu">minimum</span>(df.X), <span class="fu">maximum</span>(df.X), length<span class="op">=</span><span class="fl">100</span>)</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>    Y_pred <span class="op">=</span> <span class="fu">predict</span>(model, <span class="fu">DataFrame</span>(X <span class="op">=</span> X_pred))</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot!</span>(q, <span class="fl">10</span> <span class="op">.^</span> X_pred, <span class="fl">10</span> <span class="op">.^</span> Y_pred,</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>        line<span class="op">=:</span>solid,</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>        linewidth<span class="op">=</span><span class="fl">2</span>,</span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>color,</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span>label</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> q</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fu">startPlot</span>(n_list, ESS_Global, var_ESS_Global)</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> <span class="fu">addPlot</span>(p, n_list, ESS_Affine, var_ESS_Affine)</span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="576" height="384" viewbox="0 0 2304 1536">
<defs>
  <clippath id="clip860">
    <rect x="0" y="0" width="2304" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip860)" d="M0 1536 L2304 1536 L2304 8.52651e-14 L0 8.52651e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip861">
    <rect x="460" y="0" width="1614" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip860)" d="M250.111 1347.54 L2256.76 1347.54 L2256.76 47.2441 L250.111 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip862">
    <rect x="250" y="47" width="2008" height="1301"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip862)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="306.903,1347.54 306.903,47.2441 "></polyline>
<polyline clip-path="url(#clip862)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1253.43,1347.54 1253.43,47.2441 "></polyline>
<polyline clip-path="url(#clip862)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2199.96,1347.54 2199.96,47.2441 "></polyline>
<polyline clip-path="url(#clip860)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="250.111,1347.54 2256.76,1347.54 "></polyline>
<polyline clip-path="url(#clip860)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="306.903,1347.54 306.903,1328.64 "></polyline>
<polyline clip-path="url(#clip860)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1253.43,1347.54 1253.43,1328.64 "></polyline>
<polyline clip-path="url(#clip860)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2199.96,1347.54 2199.96,1328.64 "></polyline>
<path clip-path="url(#clip860)" d="M273.231 1420.89 L280.87 1420.89 L280.87 1394.53 L272.559 1396.19 L272.559 1391.94 L280.823 1390.27 L285.499 1390.27 L285.499 1420.89 L293.138 1420.89 L293.138 1424.83 L273.231 1424.83 L273.231 1420.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M312.582 1393.35 Q308.971 1393.35 307.143 1396.91 Q305.337 1400.45 305.337 1407.58 Q305.337 1414.69 307.143 1418.25 Q308.971 1421.8 312.582 1421.8 Q316.217 1421.8 318.022 1418.25 Q319.851 1414.69 319.851 1407.58 Q319.851 1400.45 318.022 1396.91 Q316.217 1393.35 312.582 1393.35 M312.582 1389.64 Q318.392 1389.64 321.448 1394.25 Q324.527 1398.83 324.527 1407.58 Q324.527 1416.31 321.448 1420.92 Q318.392 1425.5 312.582 1425.5 Q306.772 1425.5 303.693 1420.92 Q300.638 1416.31 300.638 1407.58 Q300.638 1398.83 303.693 1394.25 Q306.772 1389.64 312.582 1389.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M325.072 1394.22 L331.279 1394.22 L331.279 1372.8 L324.527 1374.15 L324.527 1370.69 L331.241 1369.34 L335.04 1369.34 L335.04 1394.22 L341.247 1394.22 L341.247 1397.42 L325.072 1397.42 L325.072 1394.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1219.21 1420.89 L1226.85 1420.89 L1226.85 1394.53 L1218.54 1396.19 L1218.54 1391.94 L1226.8 1390.27 L1231.47 1390.27 L1231.47 1420.89 L1239.11 1420.89 L1239.11 1424.83 L1219.21 1424.83 L1219.21 1420.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1258.56 1393.35 Q1254.95 1393.35 1253.12 1396.91 Q1251.31 1400.45 1251.31 1407.58 Q1251.31 1414.69 1253.12 1418.25 Q1254.95 1421.8 1258.56 1421.8 Q1262.19 1421.8 1264 1418.25 Q1265.83 1414.69 1265.83 1407.58 Q1265.83 1400.45 1264 1396.91 Q1262.19 1393.35 1258.56 1393.35 M1258.56 1389.64 Q1264.37 1389.64 1267.42 1394.25 Q1270.5 1398.83 1270.5 1407.58 Q1270.5 1416.31 1267.42 1420.92 Q1264.37 1425.5 1258.56 1425.5 Q1252.75 1425.5 1249.67 1420.92 Q1246.61 1416.31 1246.61 1407.58 Q1246.61 1398.83 1249.67 1394.25 Q1252.75 1389.64 1258.56 1389.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1275.07 1394.22 L1288.33 1394.22 L1288.33 1397.42 L1270.5 1397.42 L1270.5 1394.22 Q1272.67 1391.98 1276.39 1388.22 Q1280.13 1384.44 1281.09 1383.35 Q1282.92 1381.3 1283.63 1379.89 Q1284.36 1378.46 1284.36 1377.09 Q1284.36 1374.85 1282.78 1373.44 Q1281.22 1372.03 1278.7 1372.03 Q1276.92 1372.03 1274.92 1372.65 Q1272.95 1373.27 1270.69 1374.53 L1270.69 1370.69 Q1272.98 1369.77 1274.98 1369.3 Q1276.97 1368.83 1278.63 1368.83 Q1282.99 1368.83 1285.59 1371.01 Q1288.18 1373.19 1288.18 1376.84 Q1288.18 1378.57 1287.52 1380.13 Q1286.88 1381.68 1285.17 1383.78 Q1284.7 1384.33 1282.18 1386.94 Q1279.66 1389.54 1275.07 1394.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M2165.41 1420.89 L2173.05 1420.89 L2173.05 1394.53 L2164.74 1396.19 L2164.74 1391.94 L2173 1390.27 L2177.68 1390.27 L2177.68 1420.89 L2185.31 1420.89 L2185.31 1424.83 L2165.41 1424.83 L2165.41 1420.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M2204.76 1393.35 Q2201.15 1393.35 2199.32 1396.91 Q2197.51 1400.45 2197.51 1407.58 Q2197.51 1414.69 2199.32 1418.25 Q2201.15 1421.8 2204.76 1421.8 Q2208.39 1421.8 2210.2 1418.25 Q2212.03 1414.69 2212.03 1407.58 Q2212.03 1400.45 2210.2 1396.91 Q2208.39 1393.35 2204.76 1393.35 M2204.76 1389.64 Q2210.57 1389.64 2213.63 1394.25 Q2216.7 1398.83 2216.7 1407.58 Q2216.7 1416.31 2213.63 1420.92 Q2210.57 1425.5 2204.76 1425.5 Q2198.95 1425.5 2195.87 1420.92 Q2192.81 1416.31 2192.81 1407.58 Q2192.81 1398.83 2195.87 1394.25 Q2198.95 1389.64 2204.76 1389.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M2229.4 1382.28 Q2232.13 1382.86 2233.65 1384.7 Q2235.19 1386.55 2235.19 1389.26 Q2235.19 1393.41 2232.33 1395.69 Q2229.47 1397.96 2224.21 1397.96 Q2222.44 1397.96 2220.56 1397.61 Q2218.7 1397.27 2216.7 1396.57 L2216.7 1392.9 Q2218.28 1393.83 2220.16 1394.3 Q2222.05 1394.77 2224.1 1394.77 Q2227.67 1394.77 2229.53 1393.36 Q2231.41 1391.95 2231.41 1389.26 Q2231.41 1386.77 2229.66 1385.38 Q2227.93 1383.97 2224.83 1383.97 L2221.56 1383.97 L2221.56 1380.85 L2224.98 1380.85 Q2227.78 1380.85 2229.27 1379.74 Q2230.75 1378.61 2230.75 1376.5 Q2230.75 1374.34 2229.21 1373.19 Q2227.69 1372.03 2224.83 1372.03 Q2223.27 1372.03 2221.48 1372.37 Q2219.69 1372.7 2217.55 1373.42 L2217.55 1370.03 Q2219.71 1369.43 2221.59 1369.13 Q2223.49 1368.83 2225.17 1368.83 Q2229.49 1368.83 2232.01 1370.81 Q2234.53 1372.76 2234.53 1376.11 Q2234.53 1378.44 2233.2 1380.06 Q2231.86 1381.66 2229.4 1382.28 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1063.43 1466.23 Q1056.43 1466.23 1052.29 1471.45 Q1048.19 1476.67 1048.19 1485.67 Q1048.19 1494.65 1052.29 1499.87 Q1056.43 1505.09 1063.43 1505.09 Q1070.44 1505.09 1074.51 1499.87 Q1078.62 1494.65 1078.62 1485.67 Q1078.62 1476.67 1074.51 1471.45 Q1070.44 1466.23 1063.43 1466.23 M1063.43 1461.01 Q1073.43 1461.01 1079.41 1467.72 Q1085.39 1474.41 1085.39 1485.67 Q1085.39 1496.91 1079.41 1503.62 Q1073.43 1510.31 1063.43 1510.31 Q1053.41 1510.31 1047.39 1503.62 Q1041.41 1496.94 1041.41 1485.67 Q1041.41 1474.41 1047.39 1467.72 Q1053.41 1461.01 1063.43 1461.01 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1120.79 1491.59 Q1120.79 1485.13 1118.11 1481.47 Q1115.47 1477.78 1110.83 1477.78 Q1106.18 1477.78 1103.51 1481.47 Q1100.86 1485.13 1100.86 1491.59 Q1100.86 1498.05 1103.51 1501.75 Q1106.18 1505.41 1110.83 1505.41 Q1115.47 1505.41 1118.11 1501.75 Q1120.79 1498.05 1120.79 1491.59 M1100.86 1479.15 Q1102.71 1475.97 1105.51 1474.44 Q1108.34 1472.88 1112.26 1472.88 Q1118.75 1472.88 1122.79 1478.03 Q1126.87 1483.19 1126.87 1491.59 Q1126.87 1500 1122.79 1505.15 Q1118.75 1510.31 1112.26 1510.31 Q1108.34 1510.31 1105.51 1508.78 Q1102.71 1507.22 1100.86 1504.04 L1100.86 1509.39 L1094.98 1509.39 L1094.98 1459.86 L1100.86 1459.86 L1100.86 1479.15 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1159.3 1474.79 L1159.3 1480.33 Q1156.82 1479.05 1154.14 1478.42 Q1151.47 1477.78 1148.61 1477.78 Q1144.25 1477.78 1142.05 1479.12 Q1139.89 1480.45 1139.89 1483.13 Q1139.89 1485.16 1141.44 1486.34 Q1143 1487.49 1147.72 1488.54 L1149.72 1488.98 Q1155.96 1490.32 1158.57 1492.77 Q1161.21 1495.19 1161.21 1499.55 Q1161.21 1504.52 1157.26 1507.41 Q1153.35 1510.31 1146.47 1510.31 Q1143.61 1510.31 1140.49 1509.74 Q1137.4 1509.19 1133.97 1508.08 L1133.97 1502.03 Q1137.21 1503.72 1140.36 1504.58 Q1143.51 1505.41 1146.6 1505.41 Q1150.74 1505.41 1152.97 1504.01 Q1155.19 1502.57 1155.19 1500 Q1155.19 1497.61 1153.57 1496.34 Q1151.98 1495.06 1146.54 1493.88 L1144.5 1493.41 Q1139.06 1492.26 1136.64 1489.91 Q1134.22 1487.52 1134.22 1483.38 Q1134.22 1478.35 1137.78 1475.62 Q1141.35 1472.88 1147.91 1472.88 Q1151.15 1472.88 1154.02 1473.36 Q1156.88 1473.83 1159.3 1474.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1201.03 1490.1 L1201.03 1492.96 L1174.1 1492.96 Q1174.48 1499.01 1177.73 1502.19 Q1181.01 1505.34 1186.83 1505.34 Q1190.21 1505.34 1193.36 1504.52 Q1196.54 1503.69 1199.66 1502.03 L1199.66 1507.57 Q1196.51 1508.91 1193.2 1509.61 Q1189.89 1510.31 1186.48 1510.31 Q1177.95 1510.31 1172.96 1505.34 Q1167.99 1500.38 1167.99 1491.91 Q1167.99 1483.16 1172.7 1478.03 Q1177.44 1472.88 1185.46 1472.88 Q1192.66 1472.88 1196.83 1477.53 Q1201.03 1482.14 1201.03 1490.1 M1195.17 1488.38 Q1195.11 1483.57 1192.47 1480.71 Q1189.86 1477.84 1185.53 1477.84 Q1180.63 1477.84 1177.67 1480.61 Q1174.74 1483.38 1174.29 1488.41 L1195.17 1488.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1231.3 1479.21 Q1230.31 1478.64 1229.13 1478.38 Q1227.99 1478.1 1226.59 1478.1 Q1221.62 1478.1 1218.95 1481.34 Q1216.31 1484.56 1216.31 1490.61 L1216.31 1509.39 L1210.42 1509.39 L1210.42 1473.74 L1216.31 1473.74 L1216.31 1479.28 Q1218.15 1476.03 1221.11 1474.47 Q1224.07 1472.88 1228.3 1472.88 Q1228.91 1472.88 1229.64 1472.97 Q1230.37 1473.04 1231.27 1473.2 L1231.3 1479.21 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1233.24 1473.74 L1239.44 1473.74 L1250.58 1503.66 L1261.72 1473.74 L1267.93 1473.74 L1254.56 1509.39 L1246.61 1509.39 L1233.24 1473.74 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1292.22 1491.47 Q1285.12 1491.47 1282.38 1493.09 Q1279.64 1494.71 1279.64 1498.63 Q1279.64 1501.75 1281.68 1503.59 Q1283.75 1505.41 1287.28 1505.41 Q1292.15 1505.41 1295.08 1501.97 Q1298.04 1498.5 1298.04 1492.77 L1298.04 1491.47 L1292.22 1491.47 M1303.9 1489.05 L1303.9 1509.39 L1298.04 1509.39 L1298.04 1503.97 Q1296.04 1507.22 1293.04 1508.78 Q1290.05 1510.31 1285.72 1510.31 Q1280.25 1510.31 1277 1507.25 Q1273.79 1504.17 1273.79 1499.01 Q1273.79 1492.99 1277.8 1489.94 Q1281.84 1486.88 1289.83 1486.88 L1298.04 1486.88 L1298.04 1486.31 Q1298.04 1482.27 1295.37 1480.07 Q1292.73 1477.84 1287.92 1477.84 Q1284.86 1477.84 1281.97 1478.58 Q1279.07 1479.31 1276.4 1480.77 L1276.4 1475.36 Q1279.61 1474.12 1282.64 1473.51 Q1285.66 1472.88 1288.52 1472.88 Q1296.26 1472.88 1300.08 1476.89 Q1303.9 1480.9 1303.9 1489.05 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1321.75 1463.62 L1321.75 1473.74 L1333.82 1473.74 L1333.82 1478.29 L1321.75 1478.29 L1321.75 1497.64 Q1321.75 1502 1322.93 1503.24 Q1324.14 1504.48 1327.8 1504.48 L1333.82 1504.48 L1333.82 1509.39 L1327.8 1509.39 Q1321.02 1509.39 1318.44 1506.87 Q1315.87 1504.32 1315.87 1497.64 L1315.87 1478.29 L1311.57 1478.29 L1311.57 1473.74 L1315.87 1473.74 L1315.87 1463.62 L1321.75 1463.62 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1341.52 1473.74 L1347.38 1473.74 L1347.38 1509.39 L1341.52 1509.39 L1341.52 1473.74 M1341.52 1459.86 L1347.38 1459.86 L1347.38 1467.28 L1341.52 1467.28 L1341.52 1459.86 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1373.44 1477.84 Q1368.73 1477.84 1366 1481.54 Q1363.26 1485.2 1363.26 1491.59 Q1363.26 1497.99 1365.96 1501.68 Q1368.7 1505.34 1373.44 1505.34 Q1378.12 1505.34 1380.86 1501.65 Q1383.6 1497.96 1383.6 1491.59 Q1383.6 1485.26 1380.86 1481.57 Q1378.12 1477.84 1373.44 1477.84 M1373.44 1472.88 Q1381.08 1472.88 1385.44 1477.84 Q1389.8 1482.81 1389.8 1491.59 Q1389.8 1500.35 1385.44 1505.34 Q1381.08 1510.31 1373.44 1510.31 Q1365.77 1510.31 1361.41 1505.34 Q1357.08 1500.35 1357.08 1491.59 Q1357.08 1482.81 1361.41 1477.84 Q1365.77 1472.88 1373.44 1472.88 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1429.14 1487.87 L1429.14 1509.39 L1423.29 1509.39 L1423.29 1488.06 Q1423.29 1483 1421.31 1480.49 Q1419.34 1477.97 1415.39 1477.97 Q1410.65 1477.97 1407.91 1480.99 Q1405.18 1484.02 1405.18 1489.24 L1405.18 1509.39 L1399.29 1509.39 L1399.29 1473.74 L1405.18 1473.74 L1405.18 1479.28 Q1407.28 1476.06 1410.11 1474.47 Q1412.97 1472.88 1416.7 1472.88 Q1422.84 1472.88 1425.99 1476.7 Q1429.14 1480.49 1429.14 1487.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1463.55 1474.79 L1463.55 1480.33 Q1461.07 1479.05 1458.39 1478.42 Q1455.72 1477.78 1452.86 1477.78 Q1448.49 1477.78 1446.3 1479.12 Q1444.13 1480.45 1444.13 1483.13 Q1444.13 1485.16 1445.69 1486.34 Q1447.25 1487.49 1451.96 1488.54 L1453.97 1488.98 Q1460.21 1490.32 1462.82 1492.77 Q1465.46 1495.19 1465.46 1499.55 Q1465.46 1504.52 1461.51 1507.41 Q1457.6 1510.31 1450.72 1510.31 Q1447.86 1510.31 1444.74 1509.74 Q1441.65 1509.19 1438.21 1508.08 L1438.21 1502.03 Q1441.46 1503.72 1444.61 1504.58 Q1447.76 1505.41 1450.85 1505.41 Q1454.99 1505.41 1457.22 1504.01 Q1459.44 1502.57 1459.44 1500 Q1459.44 1497.61 1457.82 1496.34 Q1456.23 1495.06 1450.79 1493.88 L1448.75 1493.41 Q1443.31 1492.26 1440.89 1489.91 Q1438.47 1487.52 1438.47 1483.38 Q1438.47 1478.35 1442.03 1475.62 Q1445.6 1472.88 1452.16 1472.88 Q1455.4 1472.88 1458.27 1473.36 Q1461.13 1473.83 1463.55 1474.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip862)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="250.111,892.47 2256.76,892.47 "></polyline>
<polyline clip-path="url(#clip862)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="250.111,90.2656 2256.76,90.2656 "></polyline>
<polyline clip-path="url(#clip860)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="250.111,1347.54 250.111,47.2441 "></polyline>
<polyline clip-path="url(#clip860)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="250.111,892.47 269.009,892.47 "></polyline>
<polyline clip-path="url(#clip860)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="250.111,90.2656 269.009,90.2656 "></polyline>
<path clip-path="url(#clip860)" d="M115.411 912.263 L123.05 912.263 L123.05 885.897 L114.74 887.564 L114.74 883.305 L123.004 881.638 L127.68 881.638 L127.68 912.263 L135.319 912.263 L135.319 916.198 L115.411 916.198 L115.411 912.263 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M154.763 884.717 Q151.152 884.717 149.323 888.281 Q147.518 891.823 147.518 898.953 Q147.518 906.059 149.323 909.624 Q151.152 913.166 154.763 913.166 Q158.397 913.166 160.203 909.624 Q162.032 906.059 162.032 898.953 Q162.032 891.823 160.203 888.281 Q158.397 884.717 154.763 884.717 M154.763 881.013 Q160.573 881.013 163.629 885.619 Q166.707 890.203 166.707 898.953 Q166.707 907.679 163.629 912.286 Q160.573 916.869 154.763 916.869 Q148.953 916.869 145.874 912.286 Q142.819 907.679 142.819 898.953 Q142.819 890.203 145.874 885.619 Q148.953 881.013 154.763 881.013 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M166.707 875.114 L190.819 875.114 L190.819 878.312 L166.707 878.312 L166.707 875.114 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M202.292 885.59 L215.551 885.59 L215.551 888.788 L197.721 888.788 L197.721 885.59 Q199.884 883.352 203.608 879.591 Q207.351 875.81 208.31 874.719 Q210.135 872.669 210.849 871.259 Q211.583 869.829 211.583 868.456 Q211.583 866.218 210.003 864.808 Q208.442 863.397 205.922 863.397 Q204.135 863.397 202.141 864.018 Q200.166 864.638 197.91 865.898 L197.91 862.062 Q200.204 861.14 202.198 860.67 Q204.191 860.2 205.846 860.2 Q210.21 860.2 212.805 862.381 Q215.401 864.563 215.401 868.212 Q215.401 869.942 214.743 871.503 Q214.103 873.045 212.392 875.152 Q211.921 875.697 209.401 878.312 Q206.881 880.907 202.292 885.59 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M144.846 110.058 L152.484 110.058 L152.484 83.6925 L144.174 85.3591 L144.174 81.0999 L152.438 79.4332 L157.114 79.4332 L157.114 110.058 L164.753 110.058 L164.753 113.993 L144.846 113.993 L144.846 110.058 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M184.197 82.5119 Q180.586 82.5119 178.757 86.0767 Q176.952 89.6184 176.952 96.7479 Q176.952 103.854 178.757 107.419 Q180.586 110.961 184.197 110.961 Q187.831 110.961 189.637 107.419 Q191.466 103.854 191.466 96.7479 Q191.466 89.6184 189.637 86.0767 Q187.831 82.5119 184.197 82.5119 M184.197 78.8082 Q190.007 78.8082 193.063 83.4147 Q196.142 87.998 196.142 96.7479 Q196.142 105.475 193.063 110.081 Q190.007 114.665 184.197 114.665 Q178.387 114.665 175.308 110.081 Q172.253 105.475 172.253 96.7479 Q172.253 87.998 175.308 83.4147 Q178.387 78.8082 184.197 78.8082 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M205.846 61.0043 Q202.912 61.0043 201.427 63.9007 Q199.96 66.7782 199.96 72.571 Q199.96 78.345 201.427 81.2414 Q202.912 84.119 205.846 84.119 Q208.799 84.119 210.266 81.2414 Q211.752 78.345 211.752 72.571 Q211.752 66.7782 210.266 63.9007 Q208.799 61.0043 205.846 61.0043 M205.846 57.995 Q210.567 57.995 213.05 61.7378 Q215.551 65.4617 215.551 72.571 Q215.551 79.6616 213.05 83.4043 Q210.567 87.1282 205.846 87.1282 Q201.126 87.1282 198.624 83.4043 Q196.142 79.6616 196.142 72.571 Q196.142 65.4617 198.624 61.7378 Q201.126 57.995 205.846 57.995 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M18.4042 928.052 L18.4042 898.006 L23.815 898.006 L23.815 921.622 L37.8832 921.622 L37.8832 898.992 L43.2941 898.992 L43.2941 921.622 L60.5133 921.622 L60.5133 897.433 L65.9242 897.433 L65.9242 928.052 L18.4042 928.052 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M19.9638 858.379 L26.234 858.379 Q24.4834 862.039 23.624 865.286 Q22.7647 868.532 22.7647 871.556 Q22.7647 876.808 24.8017 879.672 Q26.8387 882.505 30.5945 882.505 Q33.7455 882.505 35.3688 880.627 Q36.9602 878.718 37.9469 873.434 L38.7426 869.551 Q40.1112 862.358 43.5805 858.952 Q47.018 855.515 52.8108 855.515 Q59.7176 855.515 63.2824 860.161 Q66.8472 864.777 66.8472 873.72 Q66.8472 877.094 66.0833 880.914 Q65.3194 884.701 63.8235 888.775 L57.2031 888.775 Q59.3993 884.86 60.5133 881.105 Q61.6273 877.349 61.6273 873.72 Q61.6273 868.214 59.463 865.222 Q57.2986 862.23 53.2882 862.23 Q49.7871 862.23 47.8137 864.395 Q45.8404 866.527 44.8537 871.429 L44.0898 875.344 Q42.6575 882.537 39.602 885.752 Q36.5464 888.966 31.1037 888.966 Q24.8017 888.966 21.1732 884.542 Q17.5448 880.086 17.5448 872.288 Q17.5448 868.946 18.1495 865.477 Q18.7543 862.008 19.9638 858.379 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M19.9638 817.002 L26.234 817.002 Q24.4834 820.662 23.624 823.909 Q22.7647 827.155 22.7647 830.179 Q22.7647 835.431 24.8017 838.295 Q26.8387 841.128 30.5945 841.128 Q33.7455 841.128 35.3688 839.25 Q36.9602 837.34 37.9469 832.057 L38.7426 828.174 Q40.1112 820.981 43.5805 817.575 Q47.018 814.137 52.8108 814.137 Q59.7176 814.137 63.2824 818.784 Q66.8472 823.4 66.8472 832.343 Q66.8472 835.717 66.0833 839.537 Q65.3194 843.324 63.8235 847.398 L57.2031 847.398 Q59.3993 843.483 60.5133 839.728 Q61.6273 835.972 61.6273 832.343 Q61.6273 826.837 59.463 823.845 Q57.2986 820.853 53.2882 820.853 Q49.7871 820.853 47.8137 823.018 Q45.8404 825.15 44.8537 830.052 L44.0898 833.967 Q42.6575 841.16 39.602 844.375 Q36.5464 847.589 31.1037 847.589 Q24.8017 847.589 21.1732 843.165 Q17.5448 838.709 17.5448 830.911 Q17.5448 827.569 18.1495 824.1 Q18.7543 820.63 19.9638 817.002 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M60.577 777.98 L79.4831 777.98 L79.4831 783.868 L30.2762 783.868 L30.2762 777.98 L35.6871 777.98 Q32.5042 776.134 30.9764 773.333 Q29.4168 770.501 29.4168 766.586 Q29.4168 760.093 34.5731 756.05 Q39.7293 751.976 48.132 751.976 Q56.5347 751.976 61.691 756.05 Q66.8472 760.093 66.8472 766.586 Q66.8472 770.501 65.3194 773.333 Q63.7598 776.134 60.577 777.98 M48.132 758.056 Q41.6708 758.056 38.0105 760.729 Q34.3184 763.371 34.3184 768.018 Q34.3184 772.665 38.0105 775.338 Q41.6708 777.98 48.132 777.98 Q54.5932 777.98 58.2853 775.338 Q61.9456 772.665 61.9456 768.018 Q61.9456 763.371 58.2853 760.729 Q54.5932 758.056 48.132 758.056 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M46.6361 711.777 L49.5006 711.777 L49.5006 738.704 Q55.5481 738.322 58.7309 735.075 Q61.8819 731.797 61.8819 725.972 Q61.8819 722.599 61.0544 719.448 Q60.2269 716.265 58.5718 713.145 L64.1099 713.145 Q65.4467 716.297 66.147 719.607 Q66.8472 722.917 66.8472 726.323 Q66.8472 734.853 61.8819 739.85 Q56.9167 744.815 48.4503 744.815 Q39.6974 744.815 34.5731 740.104 Q29.4168 735.362 29.4168 727.341 Q29.4168 720.148 34.0638 715.978 Q38.6789 711.777 46.6361 711.777 M44.9173 717.633 Q40.1112 717.697 37.2466 720.339 Q34.3821 722.949 34.3821 727.277 Q34.3821 732.179 37.1512 735.139 Q39.9202 738.067 44.9492 738.513 L44.9173 717.633 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M35.7507 681.508 Q35.1778 682.495 34.9232 683.672 Q34.6367 684.818 34.6367 686.219 Q34.6367 691.184 37.8832 693.857 Q41.0979 696.499 47.1453 696.499 L65.9242 696.499 L65.9242 702.387 L30.2762 702.387 L30.2762 696.499 L35.8144 696.499 Q32.5679 694.653 31.0083 691.693 Q29.4168 688.733 29.4168 684.5 Q29.4168 683.895 29.5123 683.163 Q29.576 682.431 29.7351 681.54 L35.7507 681.508 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M18.4042 654.39 L18.4042 624.344 L23.815 624.344 L23.815 647.961 L37.8832 647.961 L37.8832 625.331 L43.2941 625.331 L43.2941 647.961 L60.5133 647.961 L60.5133 623.771 L65.9242 623.771 L65.9242 654.39 L18.4042 654.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M60.577 607.793 L79.4831 607.793 L79.4831 613.681 L30.2762 613.681 L30.2762 607.793 L35.6871 607.793 Q32.5042 605.947 30.9764 603.146 Q29.4168 600.313 29.4168 596.398 Q29.4168 589.905 34.5731 585.863 Q39.7293 581.789 48.132 581.789 Q56.5347 581.789 61.691 585.863 Q66.8472 589.905 66.8472 596.398 Q66.8472 600.313 65.3194 603.146 Q63.7598 605.947 60.577 607.793 M48.132 587.868 Q41.6708 587.868 38.0105 590.542 Q34.3184 593.184 34.3184 597.831 Q34.3184 602.478 38.0105 605.151 Q41.6708 607.793 48.132 607.793 Q54.5932 607.793 58.2853 605.151 Q61.9456 602.478 61.9456 597.831 Q61.9456 593.184 58.2853 590.542 Q54.5932 587.868 48.132 587.868 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M34.3821 558.268 Q34.3821 562.978 38.0742 565.716 Q41.7345 568.453 48.132 568.453 Q54.5295 568.453 58.2217 565.748 Q61.8819 563.01 61.8819 558.268 Q61.8819 553.589 58.1898 550.852 Q54.4977 548.115 48.132 548.115 Q41.7981 548.115 38.106 550.852 Q34.3821 553.589 34.3821 558.268 M29.4168 558.268 Q29.4168 550.629 34.3821 546.268 Q39.3473 541.908 48.132 541.908 Q56.8849 541.908 61.8819 546.268 Q66.8472 550.629 66.8472 558.268 Q66.8472 565.939 61.8819 570.299 Q56.8849 574.628 48.132 574.628 Q39.3473 574.628 34.3821 570.299 Q29.4168 565.939 29.4168 558.268 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M31.6448 506.546 L37.1193 506.546 Q35.7507 509.029 35.0823 511.544 Q34.3821 514.026 34.3821 516.572 Q34.3821 522.27 38.0105 525.421 Q41.6072 528.572 48.132 528.572 Q54.6569 528.572 58.2853 525.421 Q61.8819 522.27 61.8819 516.572 Q61.8819 514.026 61.2135 511.544 Q60.5133 509.029 59.1447 506.546 L64.5555 506.546 Q65.7014 508.997 66.2743 511.639 Q66.8472 514.249 66.8472 517.209 Q66.8472 525.262 61.7864 530.004 Q56.7257 534.747 48.132 534.747 Q39.411 534.747 34.4139 529.972 Q29.4168 525.166 29.4168 516.827 Q29.4168 514.122 29.9897 511.544 Q30.5308 508.965 31.6448 506.546 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M44.4081 466.729 L65.9242 466.729 L65.9242 472.585 L44.599 472.585 Q39.5383 472.585 37.0238 474.559 Q34.5094 476.532 34.5094 480.479 Q34.5094 485.221 37.5331 487.959 Q40.5568 490.696 45.7767 490.696 L65.9242 490.696 L65.9242 496.584 L16.399 496.584 L16.399 490.696 L35.8144 490.696 Q32.5997 488.595 31.0083 485.762 Q29.4168 482.898 29.4168 479.174 Q29.4168 473.031 33.2363 469.88 Q37.0238 466.729 44.4081 466.729 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip862)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="306.903,358.531 306.903,287.419 "></polyline>
<polyline clip-path="url(#clip862)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1253.43,842.041 1253.43,838.515 "></polyline>
<polyline clip-path="url(#clip862)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2199.96,1300.78 2199.96,1300.52 "></polyline>
<line clip-path="url(#clip862)" x1="326.903" y1="358.531" x2="286.903" y2="358.531" style="stroke:#78c2ad; stroke-width:4; stroke-opacity:0.6"></line>
<line clip-path="url(#clip862)" x1="326.903" y1="287.419" x2="286.903" y2="287.419" style="stroke:#78c2ad; stroke-width:4; stroke-opacity:0.6"></line>
<line clip-path="url(#clip862)" x1="1273.43" y1="842.041" x2="1233.43" y2="842.041" style="stroke:#78c2ad; stroke-width:4; stroke-opacity:0.6"></line>
<line clip-path="url(#clip862)" x1="1273.43" y1="838.515" x2="1233.43" y2="838.515" style="stroke:#78c2ad; stroke-width:4; stroke-opacity:0.6"></line>
<line clip-path="url(#clip862)" x1="2219.96" y1="1300.78" x2="2179.96" y2="1300.78" style="stroke:#78c2ad; stroke-width:4; stroke-opacity:0.6"></line>
<line clip-path="url(#clip862)" x1="2219.96" y1="1300.52" x2="2179.96" y2="1300.52" style="stroke:#78c2ad; stroke-width:4; stroke-opacity:0.6"></line>
<circle clip-path="url(#clip862)" cx="306.903" cy="319.371" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="none"></circle>
<circle clip-path="url(#clip862)" cx="1253.43" cy="840.269" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="none"></circle>
<circle clip-path="url(#clip862)" cx="2199.96" cy="1300.65" r="18" fill="#78c2ad" fill-rule="evenodd" fill-opacity="0.6" stroke="none"></circle>
<polyline clip-path="url(#clip862)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="306.903,329.458 326.025,339.369 345.147,349.281 364.269,359.193 383.39,369.105 402.512,379.017 421.634,388.929 440.756,398.841 459.878,408.753 479,418.665 498.121,428.577 517.243,438.488 536.365,448.4 555.487,458.312 574.609,468.224 593.731,478.136 612.852,488.048 631.974,497.96 651.096,507.872 670.218,517.784 689.34,527.696 708.461,537.607 727.583,547.519 746.705,557.431 765.827,567.343 784.949,577.255 804.071,587.167 823.192,597.079 842.314,606.991 861.436,616.903 880.558,626.815 899.68,636.727 918.802,646.638 937.923,656.55 957.045,666.462 976.167,676.374 995.289,686.286 1014.41,696.198 1033.53,706.11 1052.65,716.022 1071.78,725.934 1090.9,735.846 1110.02,745.757 1129.14,755.669 1148.26,765.581 1167.39,775.493 1186.51,785.405 1205.63,795.317 1224.75,805.229 1243.87,815.141 1262.99,825.053 1282.12,834.965 1301.24,844.876 1320.36,854.788 1339.48,864.7 1358.6,874.612 1377.73,884.524 1396.85,894.436 1415.97,904.348 1435.09,914.26 1454.21,924.172 1473.33,934.084 1492.46,943.996 1511.58,953.907 1530.7,963.819 1549.82,973.731 1568.94,983.643 1588.07,993.555 1607.19,1003.47 1626.31,1013.38 1645.43,1023.29 1664.55,1033.2 1683.67,1043.11 1702.8,1053.03 1721.92,1062.94 1741.04,1072.85 1760.16,1082.76 1779.28,1092.67 1798.41,1102.59 1817.53,1112.5 1836.65,1122.41 1855.77,1132.32 1874.89,1142.23 1894.01,1152.15 1913.14,1162.06 1932.26,1171.97 1951.38,1181.88 1970.5,1191.79 1989.62,1201.7 2008.75,1211.62 2027.87,1221.53 2046.99,1231.44 2066.11,1241.35 2085.23,1251.26 2104.35,1261.18 2123.48,1271.09 2142.6,1281 2161.72,1290.91 2180.84,1300.82 2199.96,1310.74 "></polyline>
<polyline clip-path="url(#clip862)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="306.903,282.009 306.903,84.0448 "></polyline>
<polyline clip-path="url(#clip862)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1253.43,708.925 1253.43,701.259 "></polyline>
<polyline clip-path="url(#clip862)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2199.96,893.234 2199.96,890.605 "></polyline>
<line clip-path="url(#clip862)" x1="326.903" y1="282.009" x2="286.903" y2="282.009" style="stroke:#e95420; stroke-width:4; stroke-opacity:0.6"></line>
<line clip-path="url(#clip862)" x1="326.903" y1="84.0448" x2="286.903" y2="84.0448" style="stroke:#e95420; stroke-width:4; stroke-opacity:0.6"></line>
<line clip-path="url(#clip862)" x1="1273.43" y1="708.925" x2="1233.43" y2="708.925" style="stroke:#e95420; stroke-width:4; stroke-opacity:0.6"></line>
<line clip-path="url(#clip862)" x1="1273.43" y1="701.259" x2="1233.43" y2="701.259" style="stroke:#e95420; stroke-width:4; stroke-opacity:0.6"></line>
<line clip-path="url(#clip862)" x1="2219.96" y1="893.234" x2="2179.96" y2="893.234" style="stroke:#e95420; stroke-width:4; stroke-opacity:0.6"></line>
<line clip-path="url(#clip862)" x1="2219.96" y1="890.605" x2="2179.96" y2="890.605" style="stroke:#e95420; stroke-width:4; stroke-opacity:0.6"></line>
<circle clip-path="url(#clip862)" cx="306.903" cy="156.3" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="none"></circle>
<circle clip-path="url(#clip862)" cx="1253.43" cy="705.05" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="none"></circle>
<circle clip-path="url(#clip862)" cx="2199.96" cy="891.914" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="0.6" stroke="none"></circle>
<polyline clip-path="url(#clip862)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="306.903,216.614 326.025,224.044 345.147,231.475 364.269,238.905 383.39,246.336 402.512,253.766 421.634,261.197 440.756,268.627 459.878,276.057 479,283.488 498.121,290.918 517.243,298.349 536.365,305.779 555.487,313.21 574.609,320.64 593.731,328.071 612.852,335.501 631.974,342.932 651.096,350.362 670.218,357.792 689.34,365.223 708.461,372.653 727.583,380.084 746.705,387.514 765.827,394.945 784.949,402.375 804.071,409.806 823.192,417.236 842.314,424.667 861.436,432.097 880.558,439.527 899.68,446.958 918.802,454.388 937.923,461.819 957.045,469.249 976.167,476.68 995.289,484.11 1014.41,491.541 1033.53,498.971 1052.65,506.402 1071.78,513.832 1090.9,521.262 1110.02,528.693 1129.14,536.123 1148.26,543.554 1167.39,550.984 1186.51,558.415 1205.63,565.845 1224.75,573.276 1243.87,580.706 1262.99,588.137 1282.12,595.567 1301.24,602.997 1320.36,610.428 1339.48,617.858 1358.6,625.289 1377.73,632.719 1396.85,640.15 1415.97,647.58 1435.09,655.011 1454.21,662.441 1473.33,669.872 1492.46,677.302 1511.58,684.732 1530.7,692.163 1549.82,699.593 1568.94,707.024 1588.07,714.454 1607.19,721.885 1626.31,729.315 1645.43,736.746 1664.55,744.176 1683.67,751.606 1702.8,759.037 1721.92,766.467 1741.04,773.898 1760.16,781.328 1779.28,788.759 1798.41,796.189 1817.53,803.62 1836.65,811.05 1855.77,818.481 1874.89,825.911 1894.01,833.341 1913.14,840.772 1932.26,848.202 1951.38,855.633 1970.5,863.063 1989.62,870.494 2008.75,877.924 2027.87,885.355 2046.99,892.785 2066.11,900.216 2085.23,907.646 2104.35,915.076 2123.48,922.507 2142.6,929.937 2161.72,937.368 2180.84,944.798 2199.96,952.229 "></polyline>
<path clip-path="url(#clip860)" d="M1562.82 246.107 L2189.87 246.107 L2189.87 90.5872 L1562.82 90.5872  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip860)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1562.82,246.107 2189.87,246.107 2189.87,90.5872 1562.82,90.5872 1562.82,246.107 "></polyline>
<polyline clip-path="url(#clip860)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1585.11,142.427 1718.89,142.427 "></polyline>
<path clip-path="url(#clip860)" d="M1741.72 125.147 L1768.87 125.147 L1768.87 128.712 L1747.02 155.772 L1769.4 155.772 L1769.4 159.707 L1741.19 159.707 L1741.19 156.142 L1763.04 129.082 L1741.72 129.082 L1741.72 125.147 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1774.19 125.147 L1801.35 125.147 L1801.35 128.712 L1779.5 155.772 L1801.88 155.772 L1801.88 159.707 L1773.66 159.707 L1773.66 156.142 L1795.51 129.082 L1774.19 129.082 L1774.19 125.147 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1833.78 123.735 Q1830.68 129.059 1829.17 134.268 Q1827.67 139.476 1827.67 144.823 Q1827.67 150.17 1829.17 155.425 Q1830.7 160.656 1833.78 165.957 L1830.07 165.957 Q1826.6 160.517 1824.87 155.263 Q1823.15 150.008 1823.15 144.823 Q1823.15 139.661 1824.87 134.43 Q1826.58 129.198 1830.07 123.735 L1833.78 123.735 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1865.79 154.777 L1865.79 145.494 L1858.15 145.494 L1858.15 141.652 L1870.42 141.652 L1870.42 156.49 Q1867.71 158.411 1864.45 159.406 Q1861.18 160.378 1857.48 160.378 Q1849.38 160.378 1844.8 155.656 Q1840.24 150.911 1840.24 142.462 Q1840.24 133.99 1844.8 129.268 Q1849.38 124.522 1857.48 124.522 Q1860.86 124.522 1863.89 125.356 Q1866.95 126.189 1869.52 127.809 L1869.52 132.786 Q1866.93 130.587 1864.01 129.476 Q1861.09 128.365 1857.87 128.365 Q1851.53 128.365 1848.34 131.906 Q1845.17 135.448 1845.17 142.462 Q1845.17 149.453 1848.34 152.994 Q1851.53 156.536 1857.87 156.536 Q1860.35 156.536 1862.3 156.119 Q1864.24 155.679 1865.79 154.777 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1878.78 123.689 L1883.04 123.689 L1883.04 159.707 L1878.78 159.707 L1878.78 123.689 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1901.99 136.767 Q1898.57 136.767 1896.58 139.453 Q1894.59 142.115 1894.59 146.767 Q1894.59 151.42 1896.55 154.105 Q1898.55 156.767 1901.99 156.767 Q1905.4 156.767 1907.39 154.082 Q1909.38 151.397 1909.38 146.767 Q1909.38 142.161 1907.39 139.476 Q1905.4 136.767 1901.99 136.767 M1901.99 133.156 Q1907.55 133.156 1910.72 136.767 Q1913.89 140.379 1913.89 146.767 Q1913.89 153.133 1910.72 156.767 Q1907.55 160.378 1901.99 160.378 Q1896.42 160.378 1893.24 156.767 Q1890.1 153.133 1890.1 146.767 Q1890.1 140.379 1893.24 136.767 Q1896.42 133.156 1901.99 133.156 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1939.56 146.767 Q1939.56 142.068 1937.62 139.406 Q1935.7 136.721 1932.32 136.721 Q1928.94 136.721 1926.99 139.406 Q1925.07 142.068 1925.07 146.767 Q1925.07 151.466 1926.99 154.152 Q1928.94 156.814 1932.32 156.814 Q1935.7 156.814 1937.62 154.152 Q1939.56 151.466 1939.56 146.767 M1925.07 137.717 Q1926.42 135.402 1928.45 134.291 Q1930.51 133.156 1933.36 133.156 Q1938.08 133.156 1941.02 136.906 Q1943.98 140.656 1943.98 146.767 Q1943.98 152.879 1941.02 156.628 Q1938.08 160.378 1933.36 160.378 Q1930.51 160.378 1928.45 159.267 Q1926.42 158.133 1925.07 155.818 L1925.07 159.707 L1920.79 159.707 L1920.79 123.689 L1925.07 123.689 L1925.07 137.717 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1962.83 146.675 Q1957.67 146.675 1955.67 147.855 Q1953.68 149.036 1953.68 151.883 Q1953.68 154.152 1955.17 155.494 Q1956.67 156.814 1959.24 156.814 Q1962.78 156.814 1964.91 154.314 Q1967.06 151.791 1967.06 147.624 L1967.06 146.675 L1962.83 146.675 M1971.32 144.916 L1971.32 159.707 L1967.06 159.707 L1967.06 155.772 Q1965.61 158.133 1963.43 159.267 Q1961.25 160.378 1958.11 160.378 Q1954.12 160.378 1951.76 158.156 Q1949.42 155.911 1949.42 152.161 Q1949.42 147.786 1952.34 145.564 Q1955.28 143.342 1961.09 143.342 L1967.06 143.342 L1967.06 142.925 Q1967.06 139.985 1965.12 138.388 Q1963.2 136.767 1959.7 136.767 Q1957.48 136.767 1955.37 137.3 Q1953.27 137.832 1951.32 138.897 L1951.32 134.962 Q1953.66 134.059 1955.86 133.619 Q1958.06 133.156 1960.14 133.156 Q1965.77 133.156 1968.54 136.073 Q1971.32 138.99 1971.32 144.916 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1980.1 123.689 L1984.36 123.689 L1984.36 159.707 L1980.1 159.707 L1980.1 123.689 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M2026.95 146.767 Q2026.95 142.068 2025 139.406 Q2023.08 136.721 2019.7 136.721 Q2016.32 136.721 2014.38 139.406 Q2012.46 142.068 2012.46 146.767 Q2012.46 151.466 2014.38 154.152 Q2016.32 156.814 2019.7 156.814 Q2023.08 156.814 2025 154.152 Q2026.95 151.466 2026.95 146.767 M2012.46 137.717 Q2013.8 135.402 2015.84 134.291 Q2017.9 133.156 2020.74 133.156 Q2025.47 133.156 2028.41 136.906 Q2031.37 140.656 2031.37 146.767 Q2031.37 152.879 2028.41 156.628 Q2025.47 160.378 2020.74 160.378 Q2017.9 160.378 2015.84 159.267 Q2013.8 158.133 2012.46 155.818 L2012.46 159.707 L2008.17 159.707 L2008.17 123.689 L2012.46 123.689 L2012.46 137.717 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M2048.48 136.767 Q2045.05 136.767 2043.06 139.453 Q2041.07 142.115 2041.07 146.767 Q2041.07 151.42 2043.04 154.105 Q2045.03 156.767 2048.48 156.767 Q2051.88 156.767 2053.87 154.082 Q2055.86 151.397 2055.86 146.767 Q2055.86 142.161 2053.87 139.476 Q2051.88 136.767 2048.48 136.767 M2048.48 133.156 Q2054.03 133.156 2057.2 136.767 Q2060.37 140.379 2060.37 146.767 Q2060.37 153.133 2057.2 156.767 Q2054.03 160.378 2048.48 160.378 Q2042.9 160.378 2039.73 156.767 Q2036.58 153.133 2036.58 146.767 Q2036.58 140.379 2039.73 136.767 Q2042.9 133.156 2048.48 133.156 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M2066.99 149.476 L2066.99 133.781 L2071.25 133.781 L2071.25 149.314 Q2071.25 152.994 2072.69 154.846 Q2074.12 156.675 2076.99 156.675 Q2080.44 156.675 2082.43 154.476 Q2084.45 152.277 2084.45 148.48 L2084.45 133.781 L2088.71 133.781 L2088.71 159.707 L2084.45 159.707 L2084.45 155.726 Q2082.9 158.087 2080.84 159.244 Q2078.8 160.378 2076.09 160.378 Q2071.62 160.378 2069.31 157.601 Q2066.99 154.823 2066.99 149.476 M2077.71 133.156 L2077.71 133.156 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M2119.03 144.059 L2119.03 159.707 L2114.77 159.707 L2114.77 144.198 Q2114.77 140.517 2113.34 138.689 Q2111.9 136.86 2109.03 136.86 Q2105.58 136.86 2103.59 139.059 Q2101.6 141.258 2101.6 145.054 L2101.6 159.707 L2097.32 159.707 L2097.32 133.781 L2101.6 133.781 L2101.6 137.809 Q2103.13 135.471 2105.19 134.314 Q2107.27 133.156 2109.98 133.156 Q2114.45 133.156 2116.74 135.934 Q2119.03 138.689 2119.03 144.059 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M2144.59 137.717 L2144.59 123.689 L2148.84 123.689 L2148.84 159.707 L2144.59 159.707 L2144.59 155.818 Q2143.24 158.133 2141.18 159.267 Q2139.15 160.378 2136.28 160.378 Q2131.58 160.378 2128.61 156.628 Q2125.67 152.879 2125.67 146.767 Q2125.67 140.656 2128.61 136.906 Q2131.58 133.156 2136.28 133.156 Q2139.15 133.156 2141.18 134.291 Q2143.24 135.402 2144.59 137.717 M2130.07 146.767 Q2130.07 151.466 2131.99 154.152 Q2133.94 156.814 2137.32 156.814 Q2140.7 156.814 2142.64 154.152 Q2144.59 151.466 2144.59 146.767 Q2144.59 142.068 2142.64 139.406 Q2140.7 136.721 2137.32 136.721 Q2133.94 136.721 2131.99 139.406 Q2130.07 142.068 2130.07 146.767 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M2156.95 123.735 L2160.65 123.735 Q2164.12 129.198 2165.84 134.43 Q2167.57 139.661 2167.57 144.823 Q2167.57 150.008 2165.84 155.263 Q2164.12 160.517 2160.65 165.957 L2156.95 165.957 Q2160.03 160.656 2161.53 155.425 Q2163.06 150.17 2163.06 144.823 Q2163.06 139.476 2161.53 134.268 Q2160.03 129.059 2156.95 123.735 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip860)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1585.11,194.267 1718.89,194.267 "></polyline>
<path clip-path="url(#clip860)" d="M1741.72 176.987 L1768.87 176.987 L1768.87 180.552 L1747.02 207.612 L1769.4 207.612 L1769.4 211.547 L1741.19 211.547 L1741.19 207.982 L1763.04 180.922 L1741.72 180.922 L1741.72 176.987 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1774.19 176.987 L1801.35 176.987 L1801.35 180.552 L1779.5 207.612 L1801.88 207.612 L1801.88 211.547 L1773.66 211.547 L1773.66 207.982 L1795.51 180.922 L1774.19 180.922 L1774.19 176.987 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1833.78 175.575 Q1830.68 180.899 1829.17 186.108 Q1827.67 191.316 1827.67 196.663 Q1827.67 202.01 1829.17 207.265 Q1830.7 212.496 1833.78 217.797 L1830.07 217.797 Q1826.6 212.357 1824.87 207.103 Q1823.15 201.848 1823.15 196.663 Q1823.15 191.501 1824.87 186.27 Q1826.58 181.038 1830.07 175.575 L1833.78 175.575 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1853.78 181.594 L1847.43 198.793 L1860.14 198.793 L1853.78 181.594 M1851.14 176.987 L1856.44 176.987 L1869.61 211.547 L1864.75 211.547 L1861.6 202.681 L1846.02 202.681 L1842.87 211.547 L1837.94 211.547 L1851.14 176.987 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1885.91 175.529 L1885.91 179.071 L1881.83 179.071 Q1879.54 179.071 1878.64 179.996 Q1877.76 180.922 1877.76 183.33 L1877.76 185.621 L1884.77 185.621 L1884.77 188.932 L1877.76 188.932 L1877.76 211.547 L1873.48 211.547 L1873.48 188.932 L1869.4 188.932 L1869.4 185.621 L1873.48 185.621 L1873.48 183.816 Q1873.48 179.487 1875.49 177.52 Q1877.5 175.529 1881.88 175.529 L1885.91 175.529 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1902.6 175.529 L1902.6 179.071 L1898.52 179.071 Q1896.23 179.071 1895.33 179.996 Q1894.45 180.922 1894.45 183.33 L1894.45 185.621 L1901.46 185.621 L1901.46 188.932 L1894.45 188.932 L1894.45 211.547 L1890.17 211.547 L1890.17 188.932 L1886.09 188.932 L1886.09 185.621 L1890.17 185.621 L1890.17 183.816 Q1890.17 179.487 1892.18 177.52 Q1894.19 175.529 1898.57 175.529 L1902.6 175.529 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1906.16 185.621 L1910.42 185.621 L1910.42 211.547 L1906.16 211.547 L1906.16 185.621 M1906.16 175.529 L1910.42 175.529 L1910.42 180.922 L1906.16 180.922 L1906.16 175.529 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1940.88 195.899 L1940.88 211.547 L1936.62 211.547 L1936.62 196.038 Q1936.62 192.357 1935.19 190.529 Q1933.75 188.7 1930.88 188.7 Q1927.43 188.7 1925.44 190.899 Q1923.45 193.098 1923.45 196.894 L1923.45 211.547 L1919.17 211.547 L1919.17 185.621 L1923.45 185.621 L1923.45 189.649 Q1924.98 187.311 1927.04 186.154 Q1929.12 184.996 1931.83 184.996 Q1936.3 184.996 1938.59 187.774 Q1940.88 190.529 1940.88 195.899 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M1971.55 197.519 L1971.55 199.603 L1951.97 199.603 Q1952.25 204.001 1954.61 206.316 Q1956.99 208.607 1961.23 208.607 Q1963.68 208.607 1965.98 208.006 Q1968.29 207.404 1970.56 206.2 L1970.56 210.228 Q1968.27 211.2 1965.86 211.709 Q1963.45 212.218 1960.98 212.218 Q1954.77 212.218 1951.14 208.607 Q1947.53 204.996 1947.53 198.839 Q1947.53 192.473 1950.95 188.746 Q1954.4 184.996 1960.23 184.996 Q1965.47 184.996 1968.5 188.376 Q1971.55 191.732 1971.55 197.519 M1967.29 196.269 Q1967.25 192.774 1965.33 190.691 Q1963.43 188.607 1960.28 188.607 Q1956.72 188.607 1954.56 190.621 Q1952.43 192.635 1952.11 196.293 L1967.29 196.269 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M2012.23 198.607 Q2012.23 193.908 2010.28 191.246 Q2008.36 188.561 2004.98 188.561 Q2001.6 188.561 1999.66 191.246 Q1997.73 193.908 1997.73 198.607 Q1997.73 203.306 1999.66 205.992 Q2001.6 208.654 2004.98 208.654 Q2008.36 208.654 2010.28 205.992 Q2012.23 203.306 2012.23 198.607 M1997.73 189.557 Q1999.08 187.242 2001.11 186.131 Q2003.17 184.996 2006.02 184.996 Q2010.74 184.996 2013.68 188.746 Q2016.65 192.496 2016.65 198.607 Q2016.65 204.719 2013.68 208.468 Q2010.74 212.218 2006.02 212.218 Q2003.17 212.218 2001.11 211.107 Q1999.08 209.973 1997.73 207.658 L1997.73 211.547 L1993.45 211.547 L1993.45 175.529 L1997.73 175.529 L1997.73 189.557 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M2033.75 188.607 Q2030.33 188.607 2028.34 191.293 Q2026.35 193.955 2026.35 198.607 Q2026.35 203.26 2028.31 205.945 Q2030.3 208.607 2033.75 208.607 Q2037.16 208.607 2039.15 205.922 Q2041.14 203.237 2041.14 198.607 Q2041.14 194.001 2039.15 191.316 Q2037.16 188.607 2033.75 188.607 M2033.75 184.996 Q2039.31 184.996 2042.48 188.607 Q2045.65 192.219 2045.65 198.607 Q2045.65 204.973 2042.48 208.607 Q2039.31 212.218 2033.75 212.218 Q2028.17 212.218 2025 208.607 Q2021.85 204.973 2021.85 198.607 Q2021.85 192.219 2025 188.607 Q2028.17 184.996 2033.75 184.996 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M2052.27 201.316 L2052.27 185.621 L2056.53 185.621 L2056.53 201.154 Q2056.53 204.834 2057.97 206.686 Q2059.4 208.515 2062.27 208.515 Q2065.72 208.515 2067.71 206.316 Q2069.73 204.117 2069.73 200.32 L2069.73 185.621 L2073.98 185.621 L2073.98 211.547 L2069.73 211.547 L2069.73 207.566 Q2068.17 209.927 2066.11 211.084 Q2064.08 212.218 2061.37 212.218 Q2056.9 212.218 2054.59 209.441 Q2052.27 206.663 2052.27 201.316 M2062.99 184.996 L2062.99 184.996 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M2104.31 195.899 L2104.31 211.547 L2100.05 211.547 L2100.05 196.038 Q2100.05 192.357 2098.61 190.529 Q2097.18 188.7 2094.31 188.7 Q2090.86 188.7 2088.87 190.899 Q2086.88 193.098 2086.88 196.894 L2086.88 211.547 L2082.6 211.547 L2082.6 185.621 L2086.88 185.621 L2086.88 189.649 Q2088.41 187.311 2090.47 186.154 Q2092.55 184.996 2095.26 184.996 Q2099.72 184.996 2102.02 187.774 Q2104.31 190.529 2104.31 195.899 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M2129.86 189.557 L2129.86 175.529 L2134.12 175.529 L2134.12 211.547 L2129.86 211.547 L2129.86 207.658 Q2128.52 209.973 2126.46 211.107 Q2124.42 212.218 2121.55 212.218 Q2116.85 212.218 2113.89 208.468 Q2110.95 204.719 2110.95 198.607 Q2110.95 192.496 2113.89 188.746 Q2116.85 184.996 2121.55 184.996 Q2124.42 184.996 2126.46 186.131 Q2128.52 187.242 2129.86 189.557 M2115.35 198.607 Q2115.35 203.306 2117.27 205.992 Q2119.22 208.654 2122.6 208.654 Q2125.97 208.654 2127.92 205.992 Q2129.86 203.306 2129.86 198.607 Q2129.86 193.908 2127.92 191.246 Q2125.97 188.561 2122.6 188.561 Q2119.22 188.561 2117.27 191.246 Q2115.35 193.908 2115.35 198.607 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip860)" d="M2142.22 175.575 L2145.93 175.575 Q2149.4 181.038 2151.11 186.27 Q2152.85 191.501 2152.85 196.663 Q2152.85 201.848 2151.11 207.103 Q2149.4 212.357 2145.93 217.797 L2142.22 217.797 Q2145.3 212.496 2146.81 207.265 Q2148.34 202.01 2148.34 196.663 Q2148.34 191.316 2146.81 186.108 Q2145.3 180.899 2142.22 175.575 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
<div id="51c937f2" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>サブサンプリング付きの実験を実行する関数 experiment_ZZ() を定義</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Statistics</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># function ESS(samples::Vector{Float64}, T, dt)</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     B = T / dt</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     V = (dt / T) * sum(samples.^2) - ((dt / T) * sum(samples))^2</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     Y = samples .* sqrt(T / B)</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     ESS = T * V / var(Y)</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     return ESS</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># end</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getESSperEpoch_SS</span>(ab, ZZ, T ,dt, x, y; ξ<span class="fl">0</span><span class="op">=</span><span class="fl">0.0</span>, θ<span class="fl">0</span><span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    trace, epochs, acc <span class="op">=</span> <span class="fu">ZZ</span>(∇U, ξ<span class="fl">0</span>, θ<span class="fl">0</span>, T, x, y, <span class="fu">ZigZag1d</span>(); ab<span class="op">=</span>ab)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    traj <span class="op">=</span> <span class="fu">discretize</span>(trace, <span class="fu">ZigZag1d</span>(), dt)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">ESS</span>(traj.x, T, dt) <span class="op">*</span> <span class="fu">length</span>(y) <span class="op">/</span> epochs[<span class="kw">end</span>]  <span class="co"># サブサンプリングをしているので length(y) で補正する必要あり</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">10</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="fl">500.0</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">experiment_ZZ_SS</span>(N, T, dt; ξ<span class="fl">0</span><span class="op">=</span><span class="fl">0.0</span>, θ<span class="fl">0</span><span class="op">=</span><span class="fl">1.0</span>, n_list<span class="op">=</span>[<span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">1000</span>])  <span class="co"># サブサンプリングなしの ZZ() に関して N 回実験</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    ESSs_sum_CV <span class="op">=</span> <span class="fu">zero</span>(n_list)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    ESSs_sum_SS <span class="op">=</span> <span class="fu">zero</span>(n_list)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>N</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>        ESSs_CV <span class="op">=</span> []</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>        ESSs_SS <span class="op">=</span> []</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> n <span class="kw">in</span> n_list</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(ESSs_CV, <span class="fu">getESSperEpoch_SS</span>(ab_Affine, ZZ1d_CV, T, dt, x[<span class="op">:</span>,<span class="fl">1</span><span class="op">:</span>n], y[<span class="fl">1</span><span class="op">:</span>n]; ξ<span class="fl">0</span><span class="op">=</span>ξ<span class="fl">0</span>, θ<span class="fl">0</span><span class="op">=</span>θ<span class="fl">0</span>))</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(ESSs_SS, <span class="fu">getESSperEpoch_SS</span>(ab_Global, ZZ1d_SS, T, dt, x[<span class="op">:</span>,<span class="fl">1</span><span class="op">:</span>n], y[<span class="fl">1</span><span class="op">:</span>n]; ξ<span class="fl">0</span><span class="op">=</span>ξ<span class="fl">0</span>, θ<span class="fl">0</span><span class="op">=</span>θ<span class="fl">0</span>))</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>        ESSs_sum_CV <span class="op">=</span> [ESSs_sum_CV ESSs_CV]</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>        ESSs_sum_SS <span class="op">=</span> [ESSs_sum_SS ESSs_SS]</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">mean</span>(ESSs_sum_CV, dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">var</span>(ESSs_sum_CV, dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">mean</span>(ESSs_sum_SS, dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">var</span>(ESSs_sum_SS, dims<span class="op">=</span><span class="fl">2</span>)</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>ESS_CV, var_ESS_CV, ESS_SS, var_ESS_SS <span class="op">=</span> <span class="fu">experiment_ZZ_SS</span>(<span class="fl">2</span>, T, dt; ξ<span class="fl">0</span><span class="op">=</span><span class="fl">0.0</span>, θ<span class="fl">0</span><span class="op">=</span><span class="fl">1.0</span>, n_list<span class="op">=</span>n_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="31676a40" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>結果をプロット</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> <span class="fu">addPlot</span>(q, n_list, ESS_CV, var_ESS_CV; label<span class="op">=</span><span class="st">"ZZ-CV"</span>, color<span class="op">=</span><span class="st">"blue"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> <span class="fu">addPlot</span>(q, n_list, ESS_SS, var_ESS_SS; label<span class="op">=</span><span class="st">"ZZ-SS"</span>, color<span class="op">=</span><span class="st">"darkorange"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> <span class="fu">plot!</span>(q, legend<span class="op">=:</span>bottomleft)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="576" height="384" viewbox="0 0 2304 1536">
<defs>
  <clippath id="clip950">
    <rect x="0" y="0" width="2304" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip950)" d="M0 1536 L2304 1536 L2304 8.52651e-14 L0 8.52651e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip951">
    <rect x="460" y="0" width="1614" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip950)" d="M149.3 1347.54 L2256.76 1347.54 L2256.76 47.2441 L149.3 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip952">
    <rect x="149" y="47" width="2108" height="1301"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip950)" d="Mnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="Mnan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Mnan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="Mnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="Mnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="Mnan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Mnan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="Mnan nan Lnan nan Lnan nan Lnan nan Lnan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Lnan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="Mnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Lnan nan Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="Mnan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Mnan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="Mnan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Lnan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Lnan nan Lnan nan Lnan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Lnan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Qnan nan nan nan Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M1013.03 1466.23 Q1006.03 1466.23 1001.89 1471.45 Q997.782 1476.67 997.782 1485.67 Q997.782 1494.65 1001.89 1499.87 Q1006.03 1505.09 1013.03 1505.09 Q1020.03 1505.09 1024.1 1499.87 Q1028.21 1494.65 1028.21 1485.67 Q1028.21 1476.67 1024.1 1471.45 Q1020.03 1466.23 1013.03 1466.23 M1013.03 1461.01 Q1023.02 1461.01 1029.01 1467.72 Q1034.99 1474.41 1034.99 1485.67 Q1034.99 1496.91 1029.01 1503.62 Q1023.02 1510.31 1013.03 1510.31 Q1003 1510.31 996.986 1503.62 Q991.002 1496.94 991.002 1485.67 Q991.002 1474.41 996.986 1467.72 Q1003 1461.01 1013.03 1461.01 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M1070.38 1491.59 Q1070.38 1485.13 1067.71 1481.47 Q1065.07 1477.78 1060.42 1477.78 Q1055.77 1477.78 1053.1 1481.47 Q1050.46 1485.13 1050.46 1491.59 Q1050.46 1498.05 1053.1 1501.75 Q1055.77 1505.41 1060.42 1505.41 Q1065.07 1505.41 1067.71 1501.75 Q1070.38 1498.05 1070.38 1491.59 M1050.46 1479.15 Q1052.3 1475.97 1055.1 1474.44 Q1057.94 1472.88 1061.85 1472.88 Q1068.35 1472.88 1072.39 1478.03 Q1076.46 1483.19 1076.46 1491.59 Q1076.46 1500 1072.39 1505.15 Q1068.35 1510.31 1061.85 1510.31 Q1057.94 1510.31 1055.1 1508.78 Q1052.3 1507.22 1050.46 1504.04 L1050.46 1509.39 L1044.57 1509.39 L1044.57 1459.86 L1050.46 1459.86 L1050.46 1479.15 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M1108.9 1474.79 L1108.9 1480.33 Q1106.41 1479.05 1103.74 1478.42 Q1101.07 1477.78 1098.2 1477.78 Q1093.84 1477.78 1091.64 1479.12 Q1089.48 1480.45 1089.48 1483.13 Q1089.48 1485.16 1091.04 1486.34 Q1092.6 1487.49 1097.31 1488.54 L1099.31 1488.98 Q1105.55 1490.32 1108.16 1492.77 Q1110.8 1495.19 1110.8 1499.55 Q1110.8 1504.52 1106.86 1507.41 Q1102.94 1510.31 1096.07 1510.31 Q1093.2 1510.31 1090.08 1509.74 Q1087 1509.19 1083.56 1508.08 L1083.56 1502.03 Q1086.81 1503.72 1089.96 1504.58 Q1093.11 1505.41 1096.2 1505.41 Q1100.33 1505.41 1102.56 1504.01 Q1104.79 1502.57 1104.79 1500 Q1104.79 1497.61 1103.17 1496.34 Q1101.57 1495.06 1096.13 1493.88 L1094.09 1493.41 Q1088.65 1492.26 1086.23 1489.91 Q1083.81 1487.52 1083.81 1483.38 Q1083.81 1478.35 1087.38 1475.62 Q1090.94 1472.88 1097.5 1472.88 Q1100.75 1472.88 1103.61 1473.36 Q1106.48 1473.83 1108.9 1474.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M1150.62 1490.1 L1150.62 1492.96 L1123.7 1492.96 Q1124.08 1499.01 1127.32 1502.19 Q1130.6 1505.34 1136.43 1505.34 Q1139.8 1505.34 1142.95 1504.52 Q1146.13 1503.69 1149.25 1502.03 L1149.25 1507.57 Q1146.1 1508.91 1142.79 1509.61 Q1139.48 1510.31 1136.08 1510.31 Q1127.55 1510.31 1122.55 1505.34 Q1117.58 1500.38 1117.58 1491.91 Q1117.58 1483.16 1122.29 1478.03 Q1127.04 1472.88 1135.06 1472.88 Q1142.25 1472.88 1146.42 1477.53 Q1150.62 1482.14 1150.62 1490.1 M1144.77 1488.38 Q1144.7 1483.57 1142.06 1480.71 Q1139.45 1477.84 1135.12 1477.84 Q1130.22 1477.84 1127.26 1480.61 Q1124.33 1483.38 1123.89 1488.41 L1144.77 1488.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M1180.89 1479.21 Q1179.9 1478.64 1178.73 1478.38 Q1177.58 1478.1 1176.18 1478.1 Q1171.22 1478.1 1168.54 1481.34 Q1165.9 1484.56 1165.9 1490.61 L1165.9 1509.39 L1160.01 1509.39 L1160.01 1473.74 L1165.9 1473.74 L1165.9 1479.28 Q1167.75 1476.03 1170.71 1474.47 Q1173.67 1472.88 1177.9 1472.88 Q1178.5 1472.88 1179.24 1472.97 Q1179.97 1473.04 1180.86 1473.2 L1180.89 1479.21 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M1182.83 1473.74 L1189.04 1473.74 L1200.18 1503.66 L1211.32 1473.74 L1217.53 1473.74 L1204.16 1509.39 L1196.2 1509.39 L1182.83 1473.74 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M1241.81 1491.47 Q1234.71 1491.47 1231.98 1493.09 Q1229.24 1494.71 1229.24 1498.63 Q1229.24 1501.75 1231.28 1503.59 Q1233.34 1505.41 1236.88 1505.41 Q1241.75 1505.41 1244.68 1501.97 Q1247.64 1498.5 1247.64 1492.77 L1247.64 1491.47 L1241.81 1491.47 M1253.49 1489.05 L1253.49 1509.39 L1247.64 1509.39 L1247.64 1503.97 Q1245.63 1507.22 1242.64 1508.78 Q1239.65 1510.31 1235.32 1510.31 Q1229.84 1510.31 1226.6 1507.25 Q1223.38 1504.17 1223.38 1499.01 Q1223.38 1492.99 1227.39 1489.94 Q1231.43 1486.88 1239.42 1486.88 L1247.64 1486.88 L1247.64 1486.31 Q1247.64 1482.27 1244.96 1480.07 Q1242.32 1477.84 1237.51 1477.84 Q1234.46 1477.84 1231.56 1478.58 Q1228.67 1479.31 1225.99 1480.77 L1225.99 1475.36 Q1229.21 1474.12 1232.23 1473.51 Q1235.25 1472.88 1238.12 1472.88 Q1245.85 1472.88 1249.67 1476.89 Q1253.49 1480.9 1253.49 1489.05 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M1271.35 1463.62 L1271.35 1473.74 L1283.41 1473.74 L1283.41 1478.29 L1271.35 1478.29 L1271.35 1497.64 Q1271.35 1502 1272.53 1503.24 Q1273.74 1504.48 1277.4 1504.48 L1283.41 1504.48 L1283.41 1509.39 L1277.4 1509.39 Q1270.62 1509.39 1268.04 1506.87 Q1265.46 1504.32 1265.46 1497.64 L1265.46 1478.29 L1261.16 1478.29 L1261.16 1473.74 L1265.46 1473.74 L1265.46 1463.62 L1271.35 1463.62 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M1291.11 1473.74 L1296.97 1473.74 L1296.97 1509.39 L1291.11 1509.39 L1291.11 1473.74 M1291.11 1459.86 L1296.97 1459.86 L1296.97 1467.28 L1291.11 1467.28 L1291.11 1459.86 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M1323.04 1477.84 Q1318.33 1477.84 1315.59 1481.54 Q1312.85 1485.2 1312.85 1491.59 Q1312.85 1497.99 1315.56 1501.68 Q1318.3 1505.34 1323.04 1505.34 Q1327.72 1505.34 1330.45 1501.65 Q1333.19 1497.96 1333.19 1491.59 Q1333.19 1485.26 1330.45 1481.57 Q1327.72 1477.84 1323.04 1477.84 M1323.04 1472.88 Q1330.68 1472.88 1335.04 1477.84 Q1339.4 1482.81 1339.4 1491.59 Q1339.4 1500.35 1335.04 1505.34 Q1330.68 1510.31 1323.04 1510.31 Q1315.37 1510.31 1311.01 1505.34 Q1306.68 1500.35 1306.68 1491.59 Q1306.68 1482.81 1311.01 1477.84 Q1315.37 1472.88 1323.04 1472.88 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M1378.74 1487.87 L1378.74 1509.39 L1372.88 1509.39 L1372.88 1488.06 Q1372.88 1483 1370.91 1480.49 Q1368.93 1477.97 1364.99 1477.97 Q1360.25 1477.97 1357.51 1480.99 Q1354.77 1484.02 1354.77 1489.24 L1354.77 1509.39 L1348.88 1509.39 L1348.88 1473.74 L1354.77 1473.74 L1354.77 1479.28 Q1356.87 1476.06 1359.7 1474.47 Q1362.57 1472.88 1366.29 1472.88 Q1372.44 1472.88 1375.59 1476.7 Q1378.74 1480.49 1378.74 1487.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M1413.14 1474.79 L1413.14 1480.33 Q1410.66 1479.05 1407.99 1478.42 Q1405.31 1477.78 1402.45 1477.78 Q1398.09 1477.78 1395.89 1479.12 Q1393.73 1480.45 1393.73 1483.13 Q1393.73 1485.16 1395.29 1486.34 Q1396.85 1487.49 1401.56 1488.54 L1403.56 1488.98 Q1409.8 1490.32 1412.41 1492.77 Q1415.05 1495.19 1415.05 1499.55 Q1415.05 1504.52 1411.11 1507.41 Q1407.19 1510.31 1400.32 1510.31 Q1397.45 1510.31 1394.33 1509.74 Q1391.25 1509.19 1387.81 1508.08 L1387.81 1502.03 Q1391.06 1503.72 1394.21 1504.58 Q1397.36 1505.41 1400.44 1505.41 Q1404.58 1505.41 1406.81 1504.01 Q1409.04 1502.57 1409.04 1500 Q1409.04 1497.61 1407.41 1496.34 Q1405.82 1495.06 1400.38 1493.88 L1398.34 1493.41 Q1392.9 1492.26 1390.48 1489.91 Q1388.06 1487.52 1388.06 1483.38 Q1388.06 1478.35 1391.63 1475.62 Q1395.19 1472.88 1401.75 1472.88 Q1405 1472.88 1407.86 1473.36 Q1410.73 1473.83 1413.14 1474.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M18.4042 928.052 L18.4042 898.006 L23.815 898.006 L23.815 921.622 L37.8832 921.622 L37.8832 898.992 L43.2941 898.992 L43.2941 921.622 L60.5133 921.622 L60.5133 897.433 L65.9242 897.433 L65.9242 928.052 L18.4042 928.052 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M19.9638 858.379 L26.234 858.379 Q24.4834 862.039 23.624 865.286 Q22.7647 868.532 22.7647 871.556 Q22.7647 876.808 24.8017 879.672 Q26.8387 882.505 30.5945 882.505 Q33.7455 882.505 35.3688 880.627 Q36.9602 878.718 37.9469 873.434 L38.7426 869.551 Q40.1112 862.358 43.5805 858.952 Q47.018 855.515 52.8108 855.515 Q59.7176 855.515 63.2824 860.161 Q66.8472 864.777 66.8472 873.72 Q66.8472 877.094 66.0833 880.914 Q65.3194 884.701 63.8235 888.775 L57.2031 888.775 Q59.3993 884.86 60.5133 881.105 Q61.6273 877.349 61.6273 873.72 Q61.6273 868.214 59.463 865.222 Q57.2986 862.23 53.2882 862.23 Q49.7871 862.23 47.8137 864.395 Q45.8404 866.527 44.8537 871.429 L44.0898 875.344 Q42.6575 882.537 39.602 885.752 Q36.5464 888.966 31.1037 888.966 Q24.8017 888.966 21.1732 884.542 Q17.5448 880.086 17.5448 872.288 Q17.5448 868.946 18.1495 865.477 Q18.7543 862.008 19.9638 858.379 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M19.9638 817.002 L26.234 817.002 Q24.4834 820.662 23.624 823.909 Q22.7647 827.155 22.7647 830.179 Q22.7647 835.431 24.8017 838.295 Q26.8387 841.128 30.5945 841.128 Q33.7455 841.128 35.3688 839.25 Q36.9602 837.34 37.9469 832.057 L38.7426 828.174 Q40.1112 820.981 43.5805 817.575 Q47.018 814.137 52.8108 814.137 Q59.7176 814.137 63.2824 818.784 Q66.8472 823.4 66.8472 832.343 Q66.8472 835.717 66.0833 839.537 Q65.3194 843.324 63.8235 847.398 L57.2031 847.398 Q59.3993 843.483 60.5133 839.728 Q61.6273 835.972 61.6273 832.343 Q61.6273 826.837 59.463 823.845 Q57.2986 820.853 53.2882 820.853 Q49.7871 820.853 47.8137 823.018 Q45.8404 825.15 44.8537 830.052 L44.0898 833.967 Q42.6575 841.16 39.602 844.375 Q36.5464 847.589 31.1037 847.589 Q24.8017 847.589 21.1732 843.165 Q17.5448 838.709 17.5448 830.911 Q17.5448 827.569 18.1495 824.1 Q18.7543 820.63 19.9638 817.002 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M60.577 777.98 L79.4831 777.98 L79.4831 783.868 L30.2762 783.868 L30.2762 777.98 L35.6871 777.98 Q32.5042 776.134 30.9764 773.333 Q29.4168 770.501 29.4168 766.586 Q29.4168 760.093 34.5731 756.05 Q39.7293 751.976 48.132 751.976 Q56.5347 751.976 61.691 756.05 Q66.8472 760.093 66.8472 766.586 Q66.8472 770.501 65.3194 773.333 Q63.7598 776.134 60.577 777.98 M48.132 758.056 Q41.6708 758.056 38.0105 760.729 Q34.3184 763.371 34.3184 768.018 Q34.3184 772.665 38.0105 775.338 Q41.6708 777.98 48.132 777.98 Q54.5932 777.98 58.2853 775.338 Q61.9456 772.665 61.9456 768.018 Q61.9456 763.371 58.2853 760.729 Q54.5932 758.056 48.132 758.056 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M46.6361 711.777 L49.5006 711.777 L49.5006 738.704 Q55.5481 738.322 58.7309 735.075 Q61.8819 731.797 61.8819 725.972 Q61.8819 722.599 61.0544 719.448 Q60.2269 716.265 58.5718 713.145 L64.1099 713.145 Q65.4467 716.297 66.147 719.607 Q66.8472 722.917 66.8472 726.323 Q66.8472 734.853 61.8819 739.85 Q56.9167 744.815 48.4503 744.815 Q39.6974 744.815 34.5731 740.104 Q29.4168 735.362 29.4168 727.341 Q29.4168 720.148 34.0638 715.978 Q38.6789 711.777 46.6361 711.777 M44.9173 717.633 Q40.1112 717.697 37.2466 720.339 Q34.3821 722.949 34.3821 727.277 Q34.3821 732.179 37.1512 735.139 Q39.9202 738.067 44.9492 738.513 L44.9173 717.633 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M35.7507 681.508 Q35.1778 682.495 34.9232 683.672 Q34.6367 684.818 34.6367 686.219 Q34.6367 691.184 37.8832 693.857 Q41.0979 696.499 47.1453 696.499 L65.9242 696.499 L65.9242 702.387 L30.2762 702.387 L30.2762 696.499 L35.8144 696.499 Q32.5679 694.653 31.0083 691.693 Q29.4168 688.733 29.4168 684.5 Q29.4168 683.895 29.5123 683.163 Q29.576 682.431 29.7351 681.54 L35.7507 681.508 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M18.4042 654.39 L18.4042 624.344 L23.815 624.344 L23.815 647.961 L37.8832 647.961 L37.8832 625.331 L43.2941 625.331 L43.2941 647.961 L60.5133 647.961 L60.5133 623.771 L65.9242 623.771 L65.9242 654.39 L18.4042 654.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M60.577 607.793 L79.4831 607.793 L79.4831 613.681 L30.2762 613.681 L30.2762 607.793 L35.6871 607.793 Q32.5042 605.947 30.9764 603.146 Q29.4168 600.313 29.4168 596.398 Q29.4168 589.905 34.5731 585.863 Q39.7293 581.789 48.132 581.789 Q56.5347 581.789 61.691 585.863 Q66.8472 589.905 66.8472 596.398 Q66.8472 600.313 65.3194 603.146 Q63.7598 605.947 60.577 607.793 M48.132 587.868 Q41.6708 587.868 38.0105 590.542 Q34.3184 593.184 34.3184 597.831 Q34.3184 602.478 38.0105 605.151 Q41.6708 607.793 48.132 607.793 Q54.5932 607.793 58.2853 605.151 Q61.9456 602.478 61.9456 597.831 Q61.9456 593.184 58.2853 590.542 Q54.5932 587.868 48.132 587.868 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M34.3821 558.268 Q34.3821 562.978 38.0742 565.716 Q41.7345 568.453 48.132 568.453 Q54.5295 568.453 58.2217 565.748 Q61.8819 563.01 61.8819 558.268 Q61.8819 553.589 58.1898 550.852 Q54.4977 548.115 48.132 548.115 Q41.7981 548.115 38.106 550.852 Q34.3821 553.589 34.3821 558.268 M29.4168 558.268 Q29.4168 550.629 34.3821 546.268 Q39.3473 541.908 48.132 541.908 Q56.8849 541.908 61.8819 546.268 Q66.8472 550.629 66.8472 558.268 Q66.8472 565.939 61.8819 570.299 Q56.8849 574.628 48.132 574.628 Q39.3473 574.628 34.3821 570.299 Q29.4168 565.939 29.4168 558.268 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M31.6448 506.546 L37.1193 506.546 Q35.7507 509.029 35.0823 511.544 Q34.3821 514.026 34.3821 516.572 Q34.3821 522.27 38.0105 525.421 Q41.6072 528.572 48.132 528.572 Q54.6569 528.572 58.2853 525.421 Q61.8819 522.27 61.8819 516.572 Q61.8819 514.026 61.2135 511.544 Q60.5133 509.029 59.1447 506.546 L64.5555 506.546 Q65.7014 508.997 66.2743 511.639 Q66.8472 514.249 66.8472 517.209 Q66.8472 525.262 61.7864 530.004 Q56.7257 534.747 48.132 534.747 Q39.411 534.747 34.4139 529.972 Q29.4168 525.166 29.4168 516.827 Q29.4168 514.122 29.9897 511.544 Q30.5308 508.965 31.6448 506.546 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M44.4081 466.729 L65.9242 466.729 L65.9242 472.585 L44.599 472.585 Q39.5383 472.585 37.0238 474.559 Q34.5094 476.532 34.5094 480.479 Q34.5094 485.221 37.5331 487.959 Q40.5568 490.696 45.7767 490.696 L65.9242 490.696 L65.9242 496.584 L16.399 496.584 L16.399 490.696 L35.8144 490.696 Q32.5997 488.595 31.0083 485.762 Q29.4168 482.898 29.4168 479.174 Q29.4168 473.031 33.2363 469.88 Q37.0238 466.729 44.4081 466.729 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip952)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="21223.9,1068.78 21223.9,928.25 "></polyline>
<polyline clip-path="url(#clip952)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="210895,1330.17 210895,1329.81 "></polyline>
<polyline clip-path="url(#clip952)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2.10761e+06,1346.29 2.10761e+06,1346.29 "></polyline>
<polyline clip-path="url(#clip952)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="21223.9,1018.15 22227.3,1036.37 23278.6,1053.58 24379.9,1069.84 25533.7,1085.2 26742.4,1099.71 28008.6,1113.42 29335.2,1126.37 30724.9,1138.6 32180.8,1150.16 33706,1161.08 35303.8,1171.39 36977.7,1181.13 38731.3,1190.34 40568.4,1199.03 42493,1207.25 44509.2,1215.01 46621.5,1222.34 48834.3,1229.26 51152.4,1235.8 53581,1241.98 56125.2,1247.82 58790.5,1253.34 61582.8,1258.55 64508,1263.47 67572.4,1268.12 70782.8,1272.51 74146.1,1276.66 77669.5,1280.58 81360.7,1284.29 85227.7,1287.78 89278.7,1291.09 93522.7,1294.21 97968.7,1297.16 102626,1299.95 107506,1302.58 112618,1305.07 117973,1307.42 123583,1309.63 129461,1311.73 135618,1313.71 142069,1315.58 148826,1317.35 155905,1319.02 163322,1320.6 171092,1322.09 179231,1323.49 187758,1324.82 196691,1326.08 206050,1327.27 215854,1328.39 226125,1329.45 236885,1330.45 248157,1331.39 259966,1332.29 272338,1333.13 285298,1333.93 298876,1334.68 313100,1335.39 328001,1336.06 343612,1336.7 359966,1337.3 377099,1337.86 395048,1338.4 413851,1338.9 433550,1339.38 454187,1339.83 475806,1340.26 498455,1340.66 522182,1341.04 547039,1341.4 573080,1341.74 600360,1342.06 628940,1342.36 658880,1342.65 690246,1342.92 723106,1343.18 757530,1343.42 793593,1343.64 831373,1343.86 870953,1344.06 912417,1344.26 955855,1344.44 1.00136e+06,1344.61 1.04903e+06,1344.77 1.09898e+06,1344.92 1.1513e+06,1345.07 1.20611e+06,1345.2 1.26354e+06,1345.33 1.32369e+06,1345.46 1.38671e+06,1345.57 1.45274e+06,1345.68 1.5219e+06,1345.78 1.59436e+06,1345.88 1.67027e+06,1345.97 1.7498e+06,1346.06 1.83311e+06,1346.14 1.92038e+06,1346.22 2.01182e+06,1346.29 2.10761e+06,1346.36 "></polyline>
<polyline clip-path="url(#clip952)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="21223.9,915.022 21223.9,-0.030196 "></polyline>
<polyline clip-path="url(#clip952)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="210895,1310.24 210895,1308.56 "></polyline>
<polyline clip-path="url(#clip952)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2.10761e+06,1334.59 2.10761e+06,1334.39 "></polyline>
<polyline clip-path="url(#clip952)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="21223.9,717.974 22227.3,744.264 23278.6,769.456 24379.9,793.596 25533.7,816.728 26742.4,838.893 28008.6,860.134 29335.2,880.487 30724.9,899.99 32180.8,918.679 33706,936.588 35303.8,953.748 36977.7,970.192 38731.3,985.95 40568.4,1001.05 42493,1015.52 44509.2,1029.38 46621.5,1042.67 48834.3,1055.4 51152.4,1067.6 53581,1079.29 56125.2,1090.49 58790.5,1101.22 61582.8,1111.51 64508,1121.37 67572.4,1130.81 70782.8,1139.86 74146.1,1148.53 77669.5,1156.84 81360.7,1164.81 85227.7,1172.44 89278.7,1179.75 93522.7,1186.76 97968.7,1193.47 102626,1199.9 107506,1206.07 112618,1211.98 117973,1217.64 123583,1223.06 129461,1228.26 135618,1233.24 142069,1238.01 148826,1242.59 155905,1246.97 163322,1251.17 171092,1255.19 179231,1259.05 187758,1262.74 196691,1266.28 206050,1269.68 215854,1272.93 226125,1276.04 236885,1279.03 248157,1281.89 259966,1284.63 272338,1287.26 285298,1289.78 298876,1292.19 313100,1294.5 328001,1296.71 343612,1298.84 359966,1300.87 377099,1302.82 395048,1304.69 413851,1306.48 433550,1308.19 454187,1309.83 475806,1311.41 498455,1312.92 522182,1314.36 547039,1315.75 573080,1317.07 600360,1318.35 628940,1319.57 658880,1320.73 690246,1321.85 723106,1322.93 757530,1323.95 793593,1324.94 831373,1325.88 870953,1326.79 912417,1327.65 955855,1328.48 1.00136e+06,1329.28 1.04903e+06,1330.04 1.09898e+06,1330.77 1.1513e+06,1331.47 1.20611e+06,1332.14 1.26354e+06,1332.79 1.32369e+06,1333.4 1.38671e+06,1333.99 1.45274e+06,1334.56 1.5219e+06,1335.1 1.59436e+06,1335.62 1.67027e+06,1336.12 1.7498e+06,1336.59 1.83311e+06,1337.05 1.92038e+06,1337.49 2.01182e+06,1337.91 2.10761e+06,1338.31 "></polyline>
<polyline clip-path="url(#clip952)" style="stroke:#0000ff; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="21223.9,3813.02 21223.9,-7333.95 "></polyline>
<polyline clip-path="url(#clip952)" style="stroke:#0000ff; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="210895,7162.62 210895,-12778.5 "></polyline>
<polyline clip-path="url(#clip952)" style="stroke:#0000ff; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2.10761e+06,91014.3 2.10761e+06,-114987 "></polyline>
<polyline clip-path="url(#clip952)" style="stroke:#0000ff; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="21223.9,-1338.53 22227.3,-1378.33 23278.6,-1418.73 24379.9,-1459.72 25533.7,-1501.32 26742.4,-1543.54 28008.6,-1586.38 29335.2,-1629.86 30724.9,-1673.98 32180.8,-1718.75 33706,-1764.19 35303.8,-1810.31 36977.7,-1857.1 38731.3,-1904.59 40568.4,-1952.78 42493,-2001.69 44509.2,-2051.32 46621.5,-2101.69 48834.3,-2152.81 51152.4,-2204.68 53581,-2257.32 56125.2,-2310.74 58790.5,-2364.95 61582.8,-2419.96 64508,-2475.79 67572.4,-2532.45 70782.8,-2589.95 74146.1,-2648.3 77669.5,-2707.51 81360.7,-2767.61 85227.7,-2828.59 89278.7,-2890.47 93522.7,-2953.28 97968.7,-3017.01 102626,-3081.69 107506,-3147.32 112618,-3213.93 117973,-3281.53 123583,-3350.13 129461,-3419.74 135618,-3490.39 142069,-3562.08 148826,-3634.84 155905,-3708.67 163322,-3783.6 171092,-3859.64 179231,-3936.8 187758,-4015.11 196691,-4094.58 206050,-4175.22 215854,-4257.07 226125,-4340.12 236885,-4424.41 248157,-4509.94 259966,-4596.74 272338,-4684.83 285298,-4774.22 298876,-4864.94 313100,-4957 328001,-5050.43 343612,-5145.24 359966,-5241.46 377099,-5339.1 395048,-5438.19 413851,-5538.75 433550,-5640.79 454187,-5744.35 475806,-5849.45 498455,-5956.1 522182,-6064.33 547039,-6174.17 573080,-6285.63 600360,-6398.75 628940,-6513.54 658880,-6630.03 690246,-6748.25 723106,-6868.22 757530,-6989.97 793593,-7113.53 831373,-7238.91 870953,-7366.15 912417,-7495.28 955855,-7626.32 1.00136e+06,-7759.3 1.04903e+06,-7894.26 1.09898e+06,-8031.21 1.1513e+06,-8170.2 1.20611e+06,-8311.24 1.26354e+06,-8454.37 1.32369e+06,-8599.63 1.38671e+06,-8747.03 1.45274e+06,-8896.62 1.5219e+06,-9048.43 1.59436e+06,-9202.49 1.67027e+06,-9358.83 1.7498e+06,-9517.49 1.83311e+06,-9678.49 1.92038e+06,-9841.89 2.01182e+06,-10007.7 2.10761e+06,-10176 "></polyline>
<polyline clip-path="url(#clip952)" style="stroke:#ff8c00; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="21223.9,1480.38 21223.9,-2500.71 "></polyline>
<polyline clip-path="url(#clip952)" style="stroke:#ff8c00; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="210895,1068.27 210895,-1140.88 "></polyline>
<polyline clip-path="url(#clip952)" style="stroke:#ff8c00; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2.10761e+06,982.854 2.10761e+06,-711.976 "></polyline>
<polyline clip-path="url(#clip952)" style="stroke:#ff8c00; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="21223.9,-460.688 22227.3,-452.906 23278.6,-445.158 24379.9,-437.442 25533.7,-429.76 26742.4,-422.111 28008.6,-414.495 29335.2,-406.912 30724.9,-399.361 32180.8,-391.843 33706,-384.357 35303.8,-376.904 36977.7,-369.482 38731.3,-362.093 40568.4,-354.735 42493,-347.409 44509.2,-340.114 46621.5,-332.851 48834.3,-325.619 51152.4,-318.418 53581,-311.249 56125.2,-304.11 58790.5,-297.002 61582.8,-289.924 64508,-282.877 67572.4,-275.86 70782.8,-268.873 74146.1,-261.917 77669.5,-254.99 81360.7,-248.093 85227.7,-241.226 89278.7,-234.389 93522.7,-227.58 97968.7,-220.802 102626,-214.052 107506,-207.331 112618,-200.64 117973,-193.977 123583,-187.342 129461,-180.737 135618,-174.159 142069,-167.611 148826,-161.09 155905,-154.597 163322,-148.132 171092,-141.695 179231,-135.286 187758,-128.905 196691,-122.55 206050,-116.224 215854,-109.924 226125,-103.651 236885,-97.4059 248157,-91.1873 259966,-84.9954 272338,-78.8302 285298,-72.6916 298876,-66.5793 313100,-60.4934 328001,-54.4336 343612,-48.3999 359966,-42.3922 377099,-36.4104 395048,-30.4543 413851,-24.5238 433550,-18.6188 454187,-12.7393 475806,-6.88504 498455,-1.056 522182,4.74796 547039,10.5269 573080,16.281 600360,22.0104 628940,27.7151 658880,33.3952 690246,39.0509 723106,44.6822 757530,50.2893 793593,55.8723 831373,61.4313 870953,66.9663 912417,72.4775 955855,77.965 1.00136e+06,83.4289 1.04903e+06,88.8692 1.09898e+06,94.2862 1.1513e+06,99.6798 1.20611e+06,105.05 1.26354e+06,110.398 1.32369e+06,115.722 1.38671e+06,121.023 1.45274e+06,126.302 1.5219e+06,131.558 1.59436e+06,136.791 1.67027e+06,142.002 1.7498e+06,147.19 1.83311e+06,152.356 1.92038e+06,157.499 2.01182e+06,162.621 2.10761e+06,167.721 "></polyline>
<path clip-path="url(#clip950)" d="M219.549 1304.19 L856.681 1304.19 L856.681 1044.99 L219.549 1044.99  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip950)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="219.549,1304.19 856.681,1304.19 856.681,1044.99 219.549,1044.99 219.549,1304.19 "></polyline>
<polyline clip-path="url(#clip950)" style="stroke:#78c2ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="242.965,1096.83 383.462,1096.83 "></polyline>
<path clip-path="url(#clip950)" d="M407.41 1079.55 L434.563 1079.55 L434.563 1083.12 L412.711 1110.18 L435.096 1110.18 L435.096 1114.11 L406.878 1114.11 L406.878 1110.55 L428.73 1083.49 L407.41 1083.49 L407.41 1079.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M439.887 1079.55 L467.04 1079.55 L467.04 1083.12 L445.188 1110.18 L467.572 1110.18 L467.572 1114.11 L439.355 1114.11 L439.355 1110.55 L461.206 1083.49 L439.887 1083.49 L439.887 1079.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M499.47 1078.14 Q496.368 1083.47 494.864 1088.67 Q493.359 1093.88 493.359 1099.23 Q493.359 1104.58 494.864 1109.83 Q496.391 1115.06 499.47 1120.36 L495.766 1120.36 Q492.294 1114.92 490.558 1109.67 Q488.845 1104.41 488.845 1099.23 Q488.845 1094.07 490.558 1088.84 Q492.271 1083.6 495.766 1078.14 L499.47 1078.14 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M531.484 1109.18 L531.484 1099.9 L523.845 1099.9 L523.845 1096.06 L536.114 1096.06 L536.114 1110.9 Q533.405 1112.82 530.141 1113.81 Q526.877 1114.78 523.174 1114.78 Q515.072 1114.78 510.489 1110.06 Q505.928 1105.32 505.928 1096.87 Q505.928 1088.4 510.489 1083.67 Q515.072 1078.93 523.174 1078.93 Q526.553 1078.93 529.586 1079.76 Q532.641 1080.6 535.211 1082.22 L535.211 1087.19 Q532.618 1084.99 529.701 1083.88 Q526.785 1082.77 523.567 1082.77 Q517.225 1082.77 514.03 1086.31 Q510.859 1089.85 510.859 1096.87 Q510.859 1103.86 514.03 1107.4 Q517.225 1110.94 523.567 1110.94 Q526.044 1110.94 527.989 1110.53 Q529.933 1110.09 531.484 1109.18 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M544.47 1078.1 L548.729 1078.1 L548.729 1114.11 L544.47 1114.11 L544.47 1078.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M567.687 1091.17 Q564.261 1091.17 562.271 1093.86 Q560.28 1096.52 560.28 1101.17 Q560.28 1105.83 562.248 1108.51 Q564.238 1111.17 567.687 1111.17 Q571.09 1111.17 573.081 1108.49 Q575.072 1105.8 575.072 1101.17 Q575.072 1096.57 573.081 1093.88 Q571.09 1091.17 567.687 1091.17 M567.687 1087.56 Q573.243 1087.56 576.414 1091.17 Q579.585 1094.78 579.585 1101.17 Q579.585 1107.54 576.414 1111.17 Q573.243 1114.78 567.687 1114.78 Q562.109 1114.78 558.937 1111.17 Q555.789 1107.54 555.789 1101.17 Q555.789 1094.78 558.937 1091.17 Q562.109 1087.56 567.687 1087.56 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M605.257 1101.17 Q605.257 1096.47 603.312 1093.81 Q601.391 1091.13 598.011 1091.13 Q594.632 1091.13 592.687 1093.81 Q590.766 1096.47 590.766 1101.17 Q590.766 1105.87 592.687 1108.56 Q594.632 1111.22 598.011 1111.22 Q601.391 1111.22 603.312 1108.56 Q605.257 1105.87 605.257 1101.17 M590.766 1092.12 Q592.109 1089.81 594.146 1088.7 Q596.206 1087.56 599.053 1087.56 Q603.775 1087.56 606.715 1091.31 Q609.678 1095.06 609.678 1101.17 Q609.678 1107.28 606.715 1111.03 Q603.775 1114.78 599.053 1114.78 Q596.206 1114.78 594.146 1113.67 Q592.109 1112.54 590.766 1110.22 L590.766 1114.11 L586.484 1114.11 L586.484 1078.1 L590.766 1078.1 L590.766 1092.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M628.52 1101.08 Q623.358 1101.08 621.368 1102.26 Q619.377 1103.44 619.377 1106.29 Q619.377 1108.56 620.858 1109.9 Q622.363 1111.22 624.932 1111.22 Q628.474 1111.22 630.604 1108.72 Q632.757 1106.2 632.757 1102.03 L632.757 1101.08 L628.52 1101.08 M637.016 1099.32 L637.016 1114.11 L632.757 1114.11 L632.757 1110.18 Q631.298 1112.54 629.122 1113.67 Q626.946 1114.78 623.798 1114.78 Q619.817 1114.78 617.456 1112.56 Q615.118 1110.32 615.118 1106.57 Q615.118 1102.19 618.034 1099.97 Q620.974 1097.75 626.784 1097.75 L632.757 1097.75 L632.757 1097.33 Q632.757 1094.39 630.812 1092.79 Q628.891 1091.17 625.395 1091.17 Q623.173 1091.17 621.067 1091.71 Q618.96 1092.24 617.016 1093.3 L617.016 1089.37 Q619.354 1088.47 621.553 1088.03 Q623.752 1087.56 625.835 1087.56 Q631.46 1087.56 634.238 1090.48 Q637.016 1093.4 637.016 1099.32 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M645.789 1078.1 L650.048 1078.1 L650.048 1114.11 L645.789 1114.11 L645.789 1078.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M692.64 1101.17 Q692.64 1096.47 690.696 1093.81 Q688.775 1091.13 685.395 1091.13 Q682.015 1091.13 680.071 1093.81 Q678.15 1096.47 678.15 1101.17 Q678.15 1105.87 680.071 1108.56 Q682.015 1111.22 685.395 1111.22 Q688.775 1111.22 690.696 1108.56 Q692.64 1105.87 692.64 1101.17 M678.15 1092.12 Q679.492 1089.81 681.529 1088.7 Q683.59 1087.56 686.437 1087.56 Q691.159 1087.56 694.099 1091.31 Q697.062 1095.06 697.062 1101.17 Q697.062 1107.28 694.099 1111.03 Q691.159 1114.78 686.437 1114.78 Q683.59 1114.78 681.529 1113.67 Q679.492 1112.54 678.15 1110.22 L678.15 1114.11 L673.867 1114.11 L673.867 1078.1 L678.15 1078.1 L678.15 1092.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M714.168 1091.17 Q710.742 1091.17 708.751 1093.86 Q706.761 1096.52 706.761 1101.17 Q706.761 1105.83 708.728 1108.51 Q710.719 1111.17 714.168 1111.17 Q717.571 1111.17 719.562 1108.49 Q721.552 1105.8 721.552 1101.17 Q721.552 1096.57 719.562 1093.88 Q717.571 1091.17 714.168 1091.17 M714.168 1087.56 Q719.724 1087.56 722.895 1091.17 Q726.066 1094.78 726.066 1101.17 Q726.066 1107.54 722.895 1111.17 Q719.724 1114.78 714.168 1114.78 Q708.589 1114.78 705.418 1111.17 Q702.27 1107.54 702.27 1101.17 Q702.27 1094.78 705.418 1091.17 Q708.589 1087.56 714.168 1087.56 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M732.687 1103.88 L732.687 1088.19 L736.946 1088.19 L736.946 1103.72 Q736.946 1107.4 738.381 1109.25 Q739.816 1111.08 742.686 1111.08 Q746.136 1111.08 748.126 1108.88 Q750.14 1106.68 750.14 1102.89 L750.14 1088.19 L754.399 1088.19 L754.399 1114.11 L750.14 1114.11 L750.14 1110.13 Q748.589 1112.49 746.529 1113.65 Q744.492 1114.78 741.784 1114.78 Q737.316 1114.78 735.001 1112.01 Q732.687 1109.23 732.687 1103.88 M743.404 1087.56 L743.404 1087.56 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M784.723 1098.47 L784.723 1114.11 L780.464 1114.11 L780.464 1098.6 Q780.464 1094.92 779.029 1093.1 Q777.594 1091.27 774.723 1091.27 Q771.274 1091.27 769.284 1093.47 Q767.293 1095.66 767.293 1099.46 L767.293 1114.11 L763.01 1114.11 L763.01 1088.19 L767.293 1088.19 L767.293 1092.22 Q768.821 1089.88 770.881 1088.72 Q772.964 1087.56 775.672 1087.56 Q780.14 1087.56 782.432 1090.34 Q784.723 1093.1 784.723 1098.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M810.279 1092.12 L810.279 1078.1 L814.538 1078.1 L814.538 1114.11 L810.279 1114.11 L810.279 1110.22 Q808.936 1112.54 806.876 1113.67 Q804.839 1114.78 801.969 1114.78 Q797.27 1114.78 794.307 1111.03 Q791.367 1107.28 791.367 1101.17 Q791.367 1095.06 794.307 1091.31 Q797.27 1087.56 801.969 1087.56 Q804.839 1087.56 806.876 1088.7 Q808.936 1089.81 810.279 1092.12 M795.765 1101.17 Q795.765 1105.87 797.686 1108.56 Q799.631 1111.22 803.01 1111.22 Q806.39 1111.22 808.334 1108.56 Q810.279 1105.87 810.279 1101.17 Q810.279 1096.47 808.334 1093.81 Q806.39 1091.13 803.01 1091.13 Q799.631 1091.13 797.686 1093.81 Q795.765 1096.47 795.765 1101.17 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M822.64 1078.14 L826.343 1078.14 Q829.816 1083.6 831.529 1088.84 Q833.265 1094.07 833.265 1099.23 Q833.265 1104.41 831.529 1109.67 Q829.816 1114.92 826.343 1120.36 L822.64 1120.36 Q825.718 1115.06 827.223 1109.83 Q828.751 1104.58 828.751 1099.23 Q828.751 1093.88 827.223 1088.67 Q825.718 1083.47 822.64 1078.14 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip950)" style="stroke:#e95420; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="242.965,1148.67 383.462,1148.67 "></polyline>
<path clip-path="url(#clip950)" d="M407.41 1131.39 L434.563 1131.39 L434.563 1134.96 L412.711 1162.02 L435.096 1162.02 L435.096 1165.95 L406.878 1165.95 L406.878 1162.39 L428.73 1135.33 L407.41 1135.33 L407.41 1131.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M439.887 1131.39 L467.04 1131.39 L467.04 1134.96 L445.188 1162.02 L467.572 1162.02 L467.572 1165.95 L439.355 1165.95 L439.355 1162.39 L461.206 1135.33 L439.887 1135.33 L439.887 1131.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M499.47 1129.98 Q496.368 1135.31 494.864 1140.51 Q493.359 1145.72 493.359 1151.07 Q493.359 1156.42 494.864 1161.67 Q496.391 1166.9 499.47 1172.2 L495.766 1172.2 Q492.294 1166.76 490.558 1161.51 Q488.845 1156.25 488.845 1151.07 Q488.845 1145.91 490.558 1140.68 Q492.271 1135.44 495.766 1129.98 L499.47 1129.98 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M519.47 1136 L513.128 1153.2 L525.836 1153.2 L519.47 1136 M516.831 1131.39 L522.132 1131.39 L535.303 1165.95 L530.442 1165.95 L527.294 1157.09 L511.715 1157.09 L508.567 1165.95 L503.637 1165.95 L516.831 1131.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M551.6 1129.94 L551.6 1133.48 L547.525 1133.48 Q545.234 1133.48 544.331 1134.4 Q543.451 1135.33 543.451 1137.74 L543.451 1140.03 L550.465 1140.03 L550.465 1143.34 L543.451 1143.34 L543.451 1165.95 L539.169 1165.95 L539.169 1143.34 L535.095 1143.34 L535.095 1140.03 L539.169 1140.03 L539.169 1138.22 Q539.169 1133.89 541.183 1131.93 Q543.197 1129.94 547.572 1129.94 L551.6 1129.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M568.289 1129.94 L568.289 1133.48 L564.215 1133.48 Q561.924 1133.48 561.021 1134.4 Q560.141 1135.33 560.141 1137.74 L560.141 1140.03 L567.155 1140.03 L567.155 1143.34 L560.141 1143.34 L560.141 1165.95 L555.859 1165.95 L555.859 1143.34 L551.785 1143.34 L551.785 1140.03 L555.859 1140.03 L555.859 1138.22 Q555.859 1133.89 557.873 1131.93 Q559.887 1129.94 564.261 1129.94 L568.289 1129.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M571.854 1140.03 L576.113 1140.03 L576.113 1165.95 L571.854 1165.95 L571.854 1140.03 M571.854 1129.94 L576.113 1129.94 L576.113 1135.33 L571.854 1135.33 L571.854 1129.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M606.576 1150.31 L606.576 1165.95 L602.317 1165.95 L602.317 1150.44 Q602.317 1146.76 600.882 1144.94 Q599.446 1143.11 596.576 1143.11 Q593.127 1143.11 591.136 1145.31 Q589.146 1147.5 589.146 1151.3 L589.146 1165.95 L584.863 1165.95 L584.863 1140.03 L589.146 1140.03 L589.146 1144.06 Q590.673 1141.72 592.734 1140.56 Q594.817 1139.4 597.525 1139.4 Q601.993 1139.4 604.284 1142.18 Q606.576 1144.94 606.576 1150.31 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M637.247 1151.93 L637.247 1154.01 L617.664 1154.01 Q617.942 1158.41 620.303 1160.72 Q622.687 1163.01 626.923 1163.01 Q629.377 1163.01 631.669 1162.41 Q633.983 1161.81 636.252 1160.61 L636.252 1164.63 Q633.96 1165.61 631.553 1166.12 Q629.145 1166.62 626.669 1166.62 Q620.465 1166.62 616.831 1163.01 Q613.22 1159.4 613.22 1153.25 Q613.22 1146.88 616.645 1143.15 Q620.095 1139.4 625.928 1139.4 Q631.159 1139.4 634.192 1142.78 Q637.247 1146.14 637.247 1151.93 M632.988 1150.68 Q632.942 1147.18 631.02 1145.1 Q629.122 1143.01 625.974 1143.01 Q622.409 1143.01 620.257 1145.03 Q618.127 1147.04 617.803 1150.7 L632.988 1150.68 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M677.918 1153.01 Q677.918 1148.31 675.974 1145.65 Q674.053 1142.97 670.673 1142.97 Q667.293 1142.97 665.349 1145.65 Q663.428 1148.31 663.428 1153.01 Q663.428 1157.71 665.349 1160.4 Q667.293 1163.06 670.673 1163.06 Q674.053 1163.06 675.974 1160.4 Q677.918 1157.71 677.918 1153.01 M663.428 1143.96 Q664.77 1141.65 666.807 1140.54 Q668.867 1139.4 671.715 1139.4 Q676.437 1139.4 679.377 1143.15 Q682.34 1146.9 682.34 1153.01 Q682.34 1159.12 679.377 1162.87 Q676.437 1166.62 671.715 1166.62 Q668.867 1166.62 666.807 1165.51 Q664.77 1164.38 663.428 1162.06 L663.428 1165.95 L659.145 1165.95 L659.145 1129.94 L663.428 1129.94 L663.428 1143.96 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M699.446 1143.01 Q696.02 1143.01 694.029 1145.7 Q692.039 1148.36 692.039 1153.01 Q692.039 1157.67 694.006 1160.35 Q695.997 1163.01 699.446 1163.01 Q702.849 1163.01 704.839 1160.33 Q706.83 1157.64 706.83 1153.01 Q706.83 1148.41 704.839 1145.72 Q702.849 1143.01 699.446 1143.01 M699.446 1139.4 Q705.001 1139.4 708.173 1143.01 Q711.344 1146.62 711.344 1153.01 Q711.344 1159.38 708.173 1163.01 Q705.001 1166.62 699.446 1166.62 Q693.867 1166.62 690.696 1163.01 Q687.548 1159.38 687.548 1153.01 Q687.548 1146.62 690.696 1143.01 Q693.867 1139.4 699.446 1139.4 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M717.964 1155.72 L717.964 1140.03 L722.224 1140.03 L722.224 1155.56 Q722.224 1159.24 723.659 1161.09 Q725.094 1162.92 727.964 1162.92 Q731.413 1162.92 733.404 1160.72 Q735.418 1158.52 735.418 1154.73 L735.418 1140.03 L739.677 1140.03 L739.677 1165.95 L735.418 1165.95 L735.418 1161.97 Q733.867 1164.33 731.807 1165.49 Q729.77 1166.62 727.062 1166.62 Q722.594 1166.62 720.279 1163.85 Q717.964 1161.07 717.964 1155.72 M728.682 1139.4 L728.682 1139.4 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M770.001 1150.31 L770.001 1165.95 L765.742 1165.95 L765.742 1150.44 Q765.742 1146.76 764.307 1144.94 Q762.872 1143.11 760.001 1143.11 Q756.552 1143.11 754.561 1145.31 Q752.571 1147.5 752.571 1151.3 L752.571 1165.95 L748.288 1165.95 L748.288 1140.03 L752.571 1140.03 L752.571 1144.06 Q754.098 1141.72 756.159 1140.56 Q758.242 1139.4 760.95 1139.4 Q765.418 1139.4 767.709 1142.18 Q770.001 1144.94 770.001 1150.31 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M795.557 1143.96 L795.557 1129.94 L799.816 1129.94 L799.816 1165.95 L795.557 1165.95 L795.557 1162.06 Q794.214 1164.38 792.154 1165.51 Q790.117 1166.62 787.246 1166.62 Q782.547 1166.62 779.584 1162.87 Q776.645 1159.12 776.645 1153.01 Q776.645 1146.9 779.584 1143.15 Q782.547 1139.4 787.246 1139.4 Q790.117 1139.4 792.154 1140.54 Q794.214 1141.65 795.557 1143.96 M781.043 1153.01 Q781.043 1157.71 782.964 1160.4 Q784.908 1163.06 788.288 1163.06 Q791.668 1163.06 793.612 1160.4 Q795.557 1157.71 795.557 1153.01 Q795.557 1148.31 793.612 1145.65 Q791.668 1142.97 788.288 1142.97 Q784.908 1142.97 782.964 1145.65 Q781.043 1148.31 781.043 1153.01 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M807.918 1129.98 L811.621 1129.98 Q815.093 1135.44 816.806 1140.68 Q818.543 1145.91 818.543 1151.07 Q818.543 1156.25 816.806 1161.51 Q815.093 1166.76 811.621 1172.2 L807.918 1172.2 Q810.996 1166.9 812.501 1161.67 Q814.029 1156.42 814.029 1151.07 Q814.029 1145.72 812.501 1140.51 Q810.996 1135.31 807.918 1129.98 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip950)" style="stroke:#0000ff; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="242.965,1200.51 383.462,1200.51 "></polyline>
<path clip-path="url(#clip950)" d="M407.41 1183.23 L434.563 1183.23 L434.563 1186.8 L412.711 1213.86 L435.096 1213.86 L435.096 1217.79 L406.878 1217.79 L406.878 1214.23 L428.73 1187.17 L407.41 1187.17 L407.41 1183.23 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M439.887 1183.23 L467.04 1183.23 L467.04 1186.8 L445.188 1213.86 L467.572 1213.86 L467.572 1217.79 L439.355 1217.79 L439.355 1214.23 L461.206 1187.17 L439.887 1187.17 L439.887 1183.23 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M471.183 1202.91 L483.66 1202.91 L483.66 1206.71 L471.183 1206.71 L471.183 1202.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M516.507 1185.9 L516.507 1190.83 Q514.146 1188.63 511.461 1187.54 Q508.799 1186.45 505.79 1186.45 Q499.864 1186.45 496.716 1190.09 Q493.567 1193.7 493.567 1200.55 Q493.567 1207.38 496.716 1211.01 Q499.864 1214.62 505.79 1214.62 Q508.799 1214.62 511.461 1213.53 Q514.146 1212.45 516.507 1210.25 L516.507 1215.13 Q514.053 1216.8 511.299 1217.63 Q508.567 1218.46 505.512 1218.46 Q497.665 1218.46 493.151 1213.67 Q488.637 1208.86 488.637 1200.55 Q488.637 1192.21 493.151 1187.42 Q497.665 1182.61 505.512 1182.61 Q508.614 1182.61 511.345 1183.44 Q514.1 1184.25 516.507 1185.9 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M532.641 1217.79 L519.447 1183.23 L524.331 1183.23 L535.28 1212.33 L546.252 1183.23 L551.113 1183.23 L537.942 1217.79 L532.641 1217.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip950)" style="stroke:#ff8c00; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="242.965,1252.35 383.462,1252.35 "></polyline>
<path clip-path="url(#clip950)" d="M407.41 1235.07 L434.563 1235.07 L434.563 1238.64 L412.711 1265.7 L435.096 1265.7 L435.096 1269.63 L406.878 1269.63 L406.878 1266.07 L428.73 1239.01 L407.41 1239.01 L407.41 1235.07 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M439.887 1235.07 L467.04 1235.07 L467.04 1238.64 L445.188 1265.7 L467.572 1265.7 L467.572 1269.63 L439.355 1269.63 L439.355 1266.07 L461.206 1239.01 L439.887 1239.01 L439.887 1235.07 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M471.183 1254.75 L483.66 1254.75 L483.66 1258.55 L471.183 1258.55 L471.183 1254.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M511.345 1236.21 L511.345 1240.77 Q508.683 1239.49 506.322 1238.87 Q503.961 1238.24 501.762 1238.24 Q497.942 1238.24 495.859 1239.73 Q493.799 1241.21 493.799 1243.94 Q493.799 1246.23 495.165 1247.41 Q496.554 1248.57 500.396 1249.29 L503.22 1249.87 Q508.452 1250.86 510.928 1253.38 Q513.428 1255.88 513.428 1260.1 Q513.428 1265.12 510.049 1267.71 Q506.692 1270.3 500.188 1270.3 Q497.734 1270.3 494.956 1269.75 Q492.202 1269.19 489.239 1268.11 L489.239 1263.29 Q492.086 1264.89 494.817 1265.7 Q497.549 1266.51 500.188 1266.51 Q504.192 1266.51 506.368 1264.93 Q508.544 1263.36 508.544 1260.44 Q508.544 1257.9 506.97 1256.46 Q505.419 1255.03 501.854 1254.31 L499.007 1253.75 Q493.776 1252.71 491.438 1250.49 Q489.1 1248.27 489.1 1244.31 Q489.1 1239.73 492.317 1237.09 Q495.558 1234.45 501.229 1234.45 Q503.66 1234.45 506.183 1234.89 Q508.706 1235.33 511.345 1236.21 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip950)" d="M541.438 1236.21 L541.438 1240.77 Q538.776 1239.49 536.414 1238.87 Q534.053 1238.24 531.854 1238.24 Q528.035 1238.24 525.952 1239.73 Q523.891 1241.21 523.891 1243.94 Q523.891 1246.23 525.257 1247.41 Q526.646 1248.57 530.489 1249.29 L533.313 1249.87 Q538.544 1250.86 541.021 1253.38 Q543.521 1255.88 543.521 1260.1 Q543.521 1265.12 540.141 1267.71 Q536.785 1270.3 530.28 1270.3 Q527.827 1270.3 525.049 1269.75 Q522.294 1269.19 519.331 1268.11 L519.331 1263.29 Q522.178 1264.89 524.91 1265.7 Q527.641 1266.51 530.28 1266.51 Q534.285 1266.51 536.461 1264.93 Q538.637 1263.36 538.637 1260.44 Q538.637 1257.9 537.063 1256.46 Q535.512 1255.03 531.947 1254.31 L529.1 1253.75 Q523.868 1252.71 521.53 1250.49 Q519.192 1248.27 519.192 1244.31 Q519.192 1239.73 522.41 1237.09 Q525.651 1234.45 531.322 1234.45 Q533.752 1234.45 536.276 1234.89 Q538.799 1235.33 541.438 1236.21 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: No strict ticks found
└ @ PlotUtils ~/.julia/packages/PlotUtils/8mrSm/src/ticks.jl:194
┌ Warning: No strict ticks found
└ @ PlotUtils ~/.julia/packages/PlotUtils/8mrSm/src/ticks.jl:194
┌ Warning: No strict ticks found
└ @ PlotUtils ~/.julia/packages/PlotUtils/8mrSm/src/ticks.jl:194
┌ Warning: No strict ticks found
└ @ PlotUtils ~/.julia/packages/PlotUtils/8mrSm/src/ticks.jl:194
┌ Warning: No strict ticks found
└ @ PlotUtils ~/.julia/packages/PlotUtils/8mrSm/src/ticks.jl:194
┌ Warning: No strict ticks found
└ @ PlotUtils ~/.julia/packages/PlotUtils/8mrSm/src/ticks.jl:194
┌ Warning: No strict ticks found
└ @ PlotUtils ~/.julia/packages/PlotUtils/8mrSm/src/ticks.jl:194</code></pre>
</div>
</div>
</section>
<section id="有効サンプル数の計算" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="有効サンプル数の計算"><span class="header-section-number">1.6</span> 有効サンプル数の計算</h2>
<p>時区間 <span class="math inline">\([0,T]\)</span> における ZigZag 過程の，関数 <span class="math inline">\(h\in\mathcal{L}^2(\mathbb{R}^d)\)</span> に関する <strong>有効サンプル数</strong> (ESS) とは <span class="math display">\[
\widehat{\operatorname{ESS}}:=T\frac{\widehat{\mathrm{V}_\pi[h]}}{\widehat{\sigma^2_h}}
\]</span> <span class="math display">\[
\widehat{\mathrm{V}_\pi[h]}:=\frac{1}{T}\int^T_0h(X_s)^2\,ds-\left(\frac{1}{T}\int^T_0h(X_s)\,ds\right)^2,
\]</span> <span class="math display">\[
\widehat{\sigma^2_h}:=\frac{1}{B-1}\sum_{i=1}^B(Y_i-\overline{Y})^2,\quad Y_i:=\sqrt{\frac{B}{T}}\int^{\frac{iT}{B}}_{\frac{(i-1)T}{B}}h(X_s)\,ds
\]</span> で定まる値である．</p>
<div id="5951dc7c" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="fl">500.0</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>(ξ<span class="fl">0</span>, θ<span class="fl">0</span>) <span class="op">=</span> (<span class="fl">0.0</span>, <span class="fl">1.0</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>trace_ZZ, epochs_ZZ, acc_ZZ <span class="op">=</span> <span class="fu">ZZ1d</span>(∇U, ξ<span class="fl">0</span>, θ<span class="fl">0</span>, T, x, y, <span class="fu">ZigZag1d</span>(); ab<span class="op">=</span>ab_Affine)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>traj_ZZ <span class="op">=</span> <span class="fu">discretize</span>(trace_ZZ, <span class="fu">ZigZag1d</span>(), dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="71e7c8f8" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> traj_ZZ.x</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">ESS</span>(samples<span class="op">::</span><span class="dt">Vector{Float64}</span>, T, dt)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    V <span class="op">=</span> (dt <span class="op">/</span> T) <span class="op">*</span> <span class="fu">sum</span>(samples<span class="op">.^</span><span class="fl">2</span>) <span class="op">-</span> ((dt <span class="op">/</span> T) <span class="op">*</span> <span class="fu">sum</span>(samples))<span class="op">^</span><span class="fl">2</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> samples <span class="op">.*</span> <span class="fu">sqrt</span>(T <span class="op">/</span> B)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    ESS <span class="op">=</span> T <span class="op">*</span> V <span class="op">/</span> <span class="fu">var</span>(Y)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ESS</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="高次元へのスケーリング" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> 高次元へのスケーリング</h1>
<div id="3499fb50" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsFuns</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="st">    U(ξ, x, y)：ポテンシャル関数</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="st">        ξ: パラメータ空間上の点</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="st">        (x,y): 観測</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">U</span>(ξ, x, y)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="fu">length</span>(y)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    U_list <span class="op">=</span> []</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>n</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">push!</span>(U_list, <span class="fu">U</span>(j, ξ, x, y))</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">mean</span>(U_list)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">U</span>(j, ξ, x, y)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="fu">length</span>(y)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    product <span class="op">=</span> <span class="fu">dot</span>(x[<span class="op">:</span>,j],ξ)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span>n <span class="op">*</span> <span class="fu">exp</span>(y[j] <span class="op">*</span> product) <span class="op">/</span> (<span class="fl">1</span> <span class="op">+</span> <span class="fu">exp</span>(product))</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>ξ<span class="fl">0</span> <span class="op">=</span> [<span class="fl">1</span>,<span class="fl">2</span>]  <span class="co"># True value</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>n_list <span class="op">=</span> [<span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">1000</span>, <span class="fl">10000</span>]  <span class="co"># 実験で用いるサンプルサイズの列</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>Σ <span class="op">=</span> [<span class="fl">2</span> <span class="fl">0</span>; <span class="fl">0</span> <span class="fl">2</span>]</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="fu">rand</span>(<span class="fu">MvNormal</span>(ξ<span class="fl">0</span>, Σ), n_list[<span class="kw">end</span>])</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="fu">rand</span>.(<span class="fu">Bernoulli</span>.(<span class="fu">logistic</span>.(ξ<span class="fl">0</span><span class="op">'*</span>x)))  <span class="co"># BitVector になってしまう</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="fu">Float64</span>.(<span class="fu">vec</span>(y))  <span class="co">#  Vector{Float64} に変換</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b1813ea3" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Optim</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> <span class="fu">optimize</span>(ξ <span class="op">-&gt;</span> <span class="fu">U</span>(ξ,x,y), [<span class="fl">0.0</span>,<span class="fl">0.0</span>], <span class="fu">LBFGS</span>())</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>ξ_star <span class="op">=</span> Optim.<span class="fu">minimizer</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="162348/162348.github.io" data-repo-id="R_kgDOKlfKYQ" data-category="Announcements" data-category-id="DIC_kwDOKlfKYc4CgDmb" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" data-loading="lazy" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://162348.github.io/">
<p>Hirofumi Shiba</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/162348/162348.github.io/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ano2math5">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:shiba.hirofumi@ism.ac.jp">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../../blog.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>