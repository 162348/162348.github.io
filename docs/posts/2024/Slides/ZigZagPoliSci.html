<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Hirofumi Shiba | 司馬博文">
<meta name="description" content="Slides are available here.">

<title>Zig-Zag Sampler – Hirofumi Shiba</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../assets/profile.jpg" rel="icon" type="image/jpeg">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-cf7929f4d66a2bdccc4ecf0c4d40c672.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-158736c747ded816de25fbbe06e1ac1b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "?",
    "H"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-36GX2G6GLL"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-36GX2G6GLL', { 'anonymize_ip': true});
</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Zen+Kurenaido&amp;display=swap" rel="stylesheet">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=BIZ+UDPGothic&amp;display=swap" rel="stylesheet">

<style>
  .navbar-title, .menu-text {
      font-family: "Zen Kurenaido", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
  h1, .title, .description, .subtitle {
    font-family: "Zen Kurenaido", sans-serif !important;
  }
</style>

<!-- <style>
  .menu-text {
      font-family: "Gill Sans", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
  .navbar-title {
      font-family: "Gill Sans", sans-serif !important;
      font-weight: 400;
      font-style: normal;
  }
</style> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../assets/styles.css">
<meta property="og:title" content="Zig-Zag Sampler – Hirofumi Shiba">
<meta property="og:description" content="Slides are available here.">
<meta property="og:image" content="https://162348.github.io/posts/2024/Slides/zigzag_fps14_WhiteBackground.gif">
<meta property="og:site_name" content="Hirofumi Shiba">
<meta name="twitter:title" content="Zig-Zag Sampler – Hirofumi Shiba">
<meta name="twitter:description" content="Slides are available here.">
<meta name="twitter:image" content="https://162348.github.io/posts/2024/Slides/zigzag_fps14_WhiteBackground.gif">
<meta name="twitter:creator" content="@ano2math5">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Hirofumi Shiba</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../static/English.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Sessions.html"> 
<span class="menu-text">Sessions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../blog.html"> 
<span class="menu-text">ブログ</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../static/Japanese.html"> 
<span class="menu-text">自己紹介</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/162348/162348.github.io/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Zig-Zag Sampler</h1>
            <p class="subtitle lead">A MCMC Game-Changer</p>
                  <div>
        <div class="description">
          <p>Slides are available <a href="https://162348.github.io/posts/2024/Slides/ZigZagPoliSci_Slides.html" style="text-decoration: underline;">here</a>.</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Slide</div>
                <div class="quarto-category">MCMC</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliations</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Hirofumi Shiba | 司馬博文 <a href="https://orcid.org/0009-0007-8251-1224" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Institute of Statistical Mathematics
            </p>
          <p class="affiliation">
              <a href="https://esrp.rcast.u-tokyo.ac.jp/experts/hirofumi-shiba/?lang=en">
              the University of Tokyo
              </a>
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">9/10/2024</p>
      </div>
    </div>
    
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="block-title">Abstract</div>
      <p>Zig-Zag sampler, known as an instance of ‘Continuous-time MCMC’, is a cutting-edge sampling method that exhibits scalability and state-of-the-art performance on high-dimensional models including logistic models etc. This talk includes a brief introduction to the Zig-Zag sampler and the two important properties, irreversibility of its dynamics and thinning of Poisson point processes, followed by a few numerical experiments on logistic models with large and unbalanced data.</p>
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#sec-Zig-Zag" id="toc-sec-Zig-Zag" class="nav-link active" data-scroll-target="#sec-Zig-Zag"><span class="header-section-number">1</span> The Zig-Zag Sampler: What Is It?</a>
  <ul class="collapse">
  <li><a href="#keywords-pdmp-12" id="toc-keywords-pdmp-12" class="nav-link" data-scroll-target="#keywords-pdmp-12"><span class="header-section-number">1.1</span> Keywords: PDMP (1/2)</a></li>
  <li><a href="#keywords-pdmp-22" id="toc-keywords-pdmp-22" class="nav-link" data-scroll-target="#keywords-pdmp-22"><span class="header-section-number">1.2</span> Keywords: PDMP (2/2)</a></li>
  <li><a href="#menu" id="toc-menu" class="nav-link" data-scroll-target="#menu"><span class="header-section-number">1.3</span> Menu</a></li>
  <li><a href="#review-metropolis-hastings-12" id="toc-review-metropolis-hastings-12" class="nav-link" data-scroll-target="#review-metropolis-hastings-12"><span class="header-section-number">1.4</span> Review: Metropolis-Hastings (1/2)</a></li>
  <li><a href="#review-metropolis-hastings-22" id="toc-review-metropolis-hastings-22" class="nav-link" data-scroll-target="#review-metropolis-hastings-22"><span class="header-section-number">1.5</span> Review: Metropolis-Hastings (2/2)</a></li>
  <li><a href="#problem-reversibility" id="toc-problem-reversibility" class="nav-link" data-scroll-target="#problem-reversibility"><span class="header-section-number">1.6</span> Problem: <span class="color-unite">Reversibility</span></a></li>
  <li><a href="#lifting-13" id="toc-lifting-13" class="nav-link" data-scroll-target="#lifting-13"><span class="header-section-number">1.7</span> Lifting (1/3)</a></li>
  <li><a href="#lifting-23" id="toc-lifting-23" class="nav-link" data-scroll-target="#lifting-23"><span class="header-section-number">1.8</span> Lifting (2/3)</a></li>
  <li><a href="#lifting-33" id="toc-lifting-33" class="nav-link" data-scroll-target="#lifting-33"><span class="header-section-number">1.9</span> Lifting (3/3)</a></li>
  <li><a href="#comparison-mh-vs.-lmh-vs.-zig-zag-12" id="toc-comparison-mh-vs.-lmh-vs.-zig-zag-12" class="nav-link" data-scroll-target="#comparison-mh-vs.-lmh-vs.-zig-zag-12"><span class="header-section-number">1.10</span> Comparison: MH vs.&nbsp;LMH vs.&nbsp;Zig-Zag (1/2)</a></li>
  <li><a href="#comparison-mh-vs.-lmh-vs.-zig-zag-22" id="toc-comparison-mh-vs.-lmh-vs.-zig-zag-22" class="nav-link" data-scroll-target="#comparison-mh-vs.-lmh-vs.-zig-zag-22"><span class="header-section-number">1.11</span> Comparison: MH vs.&nbsp;LMH vs.&nbsp;Zig-Zag (2/2)</a></li>
  <li><a href="#review-mala" id="toc-review-mala" class="nav-link" data-scroll-target="#review-mala"><span class="header-section-number">1.12</span> Review: MALA</a></li>
  <li><a href="#comparison-zig-zag-vs.-mala-13" id="toc-comparison-zig-zag-vs.-mala-13" class="nav-link" data-scroll-target="#comparison-zig-zag-vs.-mala-13"><span class="header-section-number">1.13</span> Comparison: Zig-Zag vs.&nbsp;MALA (1/3)</a></li>
  <li><a href="#comparison-zig-zag-vs.-mala-23" id="toc-comparison-zig-zag-vs.-mala-23" class="nav-link" data-scroll-target="#comparison-zig-zag-vs.-mala-23"><span class="header-section-number">1.14</span> Comparison: Zig-Zag vs.&nbsp;MALA (2/3)</a></li>
  <li><a href="#comparison-zig-zag-vs.-mala-33" id="toc-comparison-zig-zag-vs.-mala-33" class="nav-link" data-scroll-target="#comparison-zig-zag-vs.-mala-33"><span class="header-section-number">1.15</span> Comparison: Zig-Zag vs.&nbsp;MALA (3/3)</a></li>
  <li><a href="#recap-of-sec-zig-zag" id="toc-recap-of-sec-zig-zag" class="nav-link" data-scroll-target="#recap-of-sec-zig-zag"><span class="header-section-number">1.16</span> Recap of Section&nbsp;1</a></li>
  </ul></li>
  <li><a href="#sec-Algorithm" id="toc-sec-Algorithm" class="nav-link" data-scroll-target="#sec-Algorithm"><span class="header-section-number">2</span> The Algorithm: How to Use It?</a>
  <ul class="collapse">
  <li><a href="#review-mh-vs.-lmh-vs.-zig-zag-12" id="toc-review-mh-vs.-lmh-vs.-zig-zag-12" class="nav-link" data-scroll-target="#review-mh-vs.-lmh-vs.-zig-zag-12"><span class="header-section-number">2.1</span> Review: MH vs.&nbsp;LMH vs.&nbsp;Zig-Zag (1/2)</a></li>
  <li><a href="#review-mh-vs.-lmh-vs.-zig-zag-22" id="toc-review-mh-vs.-lmh-vs.-zig-zag-22" class="nav-link" data-scroll-target="#review-mh-vs.-lmh-vs.-zig-zag-22"><span class="header-section-number">2.2</span> Review: MH vs.&nbsp;LMH vs.&nbsp;Zig-Zag (2/2)</a></li>
  <li><a href="#algorithm-12" id="toc-algorithm-12" class="nav-link" data-scroll-target="#algorithm-12"><span class="header-section-number">2.3</span> Algorithm (1/2)</a></li>
  <li><a href="#algorithm-22" id="toc-algorithm-22" class="nav-link" data-scroll-target="#algorithm-22"><span class="header-section-number">2.4</span> Algorithm (2/2)</a></li>
  <li><a href="#core-of-the-algorithm" id="toc-core-of-the-algorithm" class="nav-link" data-scroll-target="#core-of-the-algorithm"><span class="header-section-number">2.5</span> Core of the Algorithm</a></li>
  <li><a href="#simulating-poisson-point-process-12" id="toc-simulating-poisson-point-process-12" class="nav-link" data-scroll-target="#simulating-poisson-point-process-12"><span class="header-section-number">2.6</span> Simulating <span class="color-unite">Poisson Point Process</span> (1/2)</a></li>
  <li><a href="#simulating-poisson-point-process-22" id="toc-simulating-poisson-point-process-22" class="nav-link" data-scroll-target="#simulating-poisson-point-process-22"><span class="header-section-number">2.7</span> Simulating <span class="color-unite">Poisson Point Process</span> (2/2)</a></li>
  <li><a href="#poisson-thinning-12" id="toc-poisson-thinning-12" class="nav-link" data-scroll-target="#poisson-thinning-12"><span class="header-section-number">2.8</span> <span class="color-blue">Poisson Thinning</span> (1/2)</a></li>
  <li><a href="#poisson-thinning-22" id="toc-poisson-thinning-22" class="nav-link" data-scroll-target="#poisson-thinning-22"><span class="header-section-number">2.9</span> <span class="color-blue">Poisson Thinning</span> (2/2)</a></li>
  <li><a href="#recap-of-sec-algorithm" id="toc-recap-of-sec-algorithm" class="nav-link" data-scroll-target="#recap-of-sec-algorithm"><span class="header-section-number">2.10</span> Recap of Section&nbsp;2</a></li>
  </ul></li>
  <li><a href="#sec-ProofOfConcept" id="toc-sec-ProofOfConcept" class="nav-link" data-scroll-target="#sec-ProofOfConcept"><span class="header-section-number">3</span> Proof of Concept: How Good Is It?</a>
  <ul class="collapse">
  <li><a href="#review-the-3-steps-of-zig-zag-sampling" id="toc-review-the-3-steps-of-zig-zag-sampling" class="nav-link" data-scroll-target="#review-the-3-steps-of-zig-zag-sampling"><span class="header-section-number">3.1</span> Review: The 3 Steps of Zig-Zag Sampling</a></li>
  <li><a href="#model-1d-gaussian-mean-reconstruction" id="toc-model-1d-gaussian-mean-reconstruction" class="nav-link" data-scroll-target="#model-1d-gaussian-mean-reconstruction"><span class="header-section-number">3.2</span> Model: 1d Gaussian Mean Reconstruction</a></li>
  <li><a href="#menu-1" id="toc-menu-1" class="nav-link" data-scroll-target="#menu-1"><span class="header-section-number">3.3</span> Menu</a></li>
  <li><a href="#simple-zig-zag-sampler-with-gammaequiv0-12" id="toc-simple-zig-zag-sampler-with-gammaequiv0-12" class="nav-link" data-scroll-target="#simple-zig-zag-sampler-with-gammaequiv0-12"><span class="header-section-number">3.4</span> <span class="color-minty">Simple Zig-Zag Sampler with <span class="math inline">\gamma\equiv0</span></span> (1/2)</a></li>
  <li><a href="#result-1d-gaussian-mean-reconstruction" id="toc-result-1d-gaussian-mean-reconstruction" class="nav-link" data-scroll-target="#result-1d-gaussian-mean-reconstruction"><span class="header-section-number">3.5</span> Result: 1d Gaussian Mean Reconstruction</a></li>
  <li><a href="#mse-per-epoch-the-vertical-axis" id="toc-mse-per-epoch-the-vertical-axis" class="nav-link" data-scroll-target="#mse-per-epoch-the-vertical-axis"><span class="header-section-number">3.6</span> MSE per Epoch: The Vertical Axis</a></li>
  <li><a href="#good-news" id="toc-good-news" class="nav-link" data-scroll-target="#good-news"><span class="header-section-number">3.7</span> Good News!</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Files/ZigZagPoliSci.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li><li><a href="ZigZagPoliSci_Slides.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<section id="sec-Zig-Zag" class="level2 page-columns page-full" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="sec-Zig-Zag"><span class="header-section-number">1</span> The Zig-Zag Sampler: What Is It?</h2>
<p>A continuous-time variant of MCMC algorithms</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="zigzag_fps14.gif" class="img-fluid figure-img"></p>
<figcaption>Trajectory for Zig-Zag Sampler. Please attribute Hirofumi Shiba. <i class="fa-brands fa-creative-commons"></i> <i class="fa-brands fa-creative-commons-by"></i></figcaption>
</figure>
</div>
<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
<p>$$</p>
<p>$$</p>
</div>
<section id="keywords-pdmp-12" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="keywords-pdmp-12"><span class="header-section-number">1.1</span> Keywords: PDMP (1/2)</h3>
<p><u>PDMP</u> (Piecewise Deterministic<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Markov Process<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>) <span class="citation" data-cites="Davis1984">(<a href="#ref-Davis1984" role="doc-biblioref">Davis, 1984</a>)</span></p>
<ol type="1">
<li>Mostly <span class="color-unite">deterministic</span> with the exception of random jumps happens at random times</li>
<li><span class="color-unite">Continuous-time</span>, instead of discrete-time processes</li>
</ol>
<p><i class="fa-solid fa-arrow-right" aria-label="arrow-right"></i> Plays a <span class="color-unite">complementary role</span> to SDEs / Diffusions</p>
<div class="table-responsive-sm">
<table class="table-hover caption-top table">
<colgroup>
<col style="width: 60%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Property</th>
<th style="text-align: center;">PDMP</th>
<th style="text-align: center;">SDE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Exactly simulatable?</td>
<td style="text-align: center;"><span class="color-red"><i class="fa-solid fa-check" aria-label="check"></i></span></td>
<td style="text-align: center;"><span class="color-blue"><i class="fa-solid fa-xmark" aria-label="xmark"></i></span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject to discretization errors?</td>
<td style="text-align: center;"><span class="color-blue"><i class="fa-solid fa-xmark" aria-label="xmark"></i></span></td>
<td style="text-align: center;"><span class="color-red"><i class="fa-solid fa-check" aria-label="check"></i></span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Driving noise</td>
<td style="text-align: center;">Poisson</td>
<td style="text-align: center;">Gauss</td>
</tr>
</tbody>
</table>
</div>
<div class="callout callout-style-simple callout-note callout-titled" title="History of PDMP Applications">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
History of PDMP Applications
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>First applications: control theory, operations research, etc. <span class="citation" data-cites="Davis1993">(<a href="#ref-Davis1993" role="doc-biblioref">Davis, 1993</a>)</span></li>
<li>Second applications: Monte Carlo simulation in material sciences <span class="citation" data-cites="Peters-deWith2012">(<a href="#ref-Peters-deWith2012" role="doc-biblioref">Peters and de&nbsp;With, 2012</a>)</span></li>
<li>Third applications: Bayesian statistics <span class="citation" data-cites="Bouchard-Cote+2018-BPS">(<a href="#ref-Bouchard-Cote+2018-BPS" role="doc-biblioref">Bouchard-Côté et al., 2018</a>)</span></li>
</ol>
</div>
</div>
</section>
<section id="keywords-pdmp-22" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="keywords-pdmp-22"><span class="header-section-number">1.2</span> Keywords: PDMP (2/2)</h3>
<ul>
<li>We will concentrate on Zig-Zag sampler <span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens, Fearnhead, et al., 2019</a>)</span></li>
<li>Other PDMPs: Bouncy sampler <span class="citation" data-cites="Bouchard-Cote+2018-BPS">(<a href="#ref-Bouchard-Cote+2018-BPS" role="doc-biblioref">Bouchard-Côté et al., 2018</a>)</span> , Boomerang sampler <span class="citation" data-cites="Bierkens+2020">(<a href="#ref-Bierkens+2020" role="doc-biblioref">Bierkens et al., 2020</a>)</span></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pdmps.gif" class="img-fluid figure-img"></p>
<figcaption>The most famous three PDMPs. Animated by <span class="citation" data-cites="Grazzi2020">(<a href="#ref-Grazzi2020" role="doc-biblioref">Grazzi, 2020</a>)</span></figcaption>
</figure>
</div>
</section>
<section id="menu" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="menu"><span class="header-section-number">1.3</span> Menu</h3>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="What We've Learned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What We’ve Learned
</div>
</div>
<div class="callout-body-container callout-body">
<p>The new algorithm ‘Zig-Zag Sampler’ is based on comtinuous-time process called <span class="color-unite">PDMP</span>.</p>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="What We'll Learn in the Rest of this @sec-Zig-Zag">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What We’ll Learn in the Rest of this <a href="#sec-Zig-Zag" class="quarto-xref">Section&nbsp;1</a>
</div>
</div>
<div class="callout-body-container callout-body">
<p>We will review 3 instances of the standard (discrete-time) MCMC algorithm: <span class="color-unite">MH</span>, <span class="color-unite">Lifted MH</span>, and <span class="color-unite">MALA</span>.</p>
<ol type="1">
<li>Review: <span class="color-unite">MH</span> (Metropolis-Hastings) algorithm</li>
<li>Review: <span class="color-unite">Lifted MH</span>, A method bridging <span class="color-unite">MH</span> and Zig-Zag</li>
<li>Comparison: <span class="color-unite">MH</span> vs.&nbsp;<span class="color-unite">Lifted MH</span> vs.&nbsp;Zig-Zag</li>
<li>Review: <span class="color-unite">MALA</span> (Metropolis Adjusted Langevin Algorithm)</li>
<li>Comparison: Zig-Zag vs.&nbsp;<span class="color-unite">MALA</span></li>
</ol>
</div>
</div>
</section>
<section id="review-metropolis-hastings-12" class="level3 page-columns page-full" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="review-metropolis-hastings-12"><span class="header-section-number">1.4</span> Review: Metropolis-Hastings (1/2)</h3>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[@Metropolis+1953]-[@Hastings1970]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="citation" data-cites="Metropolis+1953">(<a href="#ref-Metropolis+1953" role="doc-biblioref">Metropolis et al., 1953</a>)</span>-<span class="citation" data-cites="Hastings1970">(<a href="#ref-Hastings1970" role="doc-biblioref">Hastings, 1970</a>)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Input: Target distribution <span class="math inline">p</span>, (symmetric) proposal distribution <span class="math inline">q</span></p>
<ol type="1">
<li>Draw a <span class="math inline">X_t\sim q(-|X_{t-1})</span></li>
<li>Compute <span class="math display">
  \alpha(X_{t-1}, X_t) = \frac{p(X_t)}{p(X_{t-1})}
  </span></li>
<li>Draw a uniform random number <span class="math inline">U\sim\mathrm{U}([0,1])</span>.</li>
<li>If <span class="math inline">\alpha(X_{t-1},X_t)\le U</span>, then <span class="math inline">X_t\gets X_{t-1}</span>. Do nothing otherwise.</li>
<li>Return to Step 1.</li>
</ol>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p>MH algorithm works even without <span class="math inline">p</span>’s normalizing constant. Hence, its ubiquity.</p>
</div></div></section>
<section id="review-metropolis-hastings-22" class="level3" data-number="1.5">
<h3 data-number="1.5" class="anchored" data-anchor-id="review-metropolis-hastings-22"><span class="header-section-number">1.5</span> Review: Metropolis-Hastings (2/2)</h3>
<div class="small-letter">
<p>Alternative View: MH is a generic procedure to turn a <span class="color-unite">simple <span class="math inline">q</span>-Markov chain</span> into a <span class="color-unite">Markov chain converging to <span class="math inline">p</span></span>.</p>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="The Choise of Proposal $q$">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Choise of Proposal <span class="math inline">q</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><u>Random Walk Metropolis</u> <span class="citation" data-cites="Metropolis+1953">(<a href="#ref-Metropolis+1953" role="doc-biblioref">Metropolis et al., 1953</a>)</span>: Uniform / Gaussian <span class="math display">
q(y|x) = q(y-x) \in\left\{ \frac{d \mathrm{U}([0,1])}{d \lambda}(y-x),\frac{d \mathrm{N}(0,\Sigma)}{d \lambda}(y-x)\right\}
</span></li>
<li><u>Hybrid / Hamiltonian Monte Carlo</u> <span class="citation" data-cites="Duane+1987">(<a href="#ref-Duane+1987" role="doc-biblioref">Duane et al., 1987</a>)</span>: Hamiltonian dynamics <span class="math display">
q(y|x) = \delta_{x + \epsilon\rho},\qquad\epsilon&gt;0,\;\rho\;\text{: momentum defined via Hamiltonian}
</span></li>
<li><u>Metropolis-adjusted Langevin algorithm</u> (MALA) <span class="citation" data-cites="Besag1994">(<a href="#ref-Besag1994" role="doc-biblioref">Besag, 1994</a>)</span>: Langevin diffusion <span class="math display">
q(-|X_t):=\text{ the transition probability of } X_t \text{ where } dX_t=\nabla\log p(X_t)\,dt+\sqrt{2\beta^{-1}}dB_t.
</span></li>
</ul>
</div>
</div>
<!-- ![](Files/arrow-right.svg){.absolute right=-250 top=0 width="1000" height="100" style="transform: rotate(90deg);" .color-unite} -->
</section>
<section id="problem-reversibility" class="level3 page-columns page-full" data-number="1.6">
<h3 data-number="1.6" class="anchored" data-anchor-id="problem-reversibility"><span class="header-section-number">1.6</span> Problem: <span class="color-unite">Reversibility</span></h3>
<p><span class="color-unite">Reversibility</span> (a.k.a detailed balance): <span class="math display">
p(x)q(x|y)=p(y)q(y|x).
</span> In words: <span class="math display">
\text{Probability}[\text{Going}\;x\to y]=\text{Probability}[\text{Going}\;y\to x].
</span> <i class="fa-solid fa-arrow-right" aria-label="arrow-right"></i> Harder to explore the entire space</p>
<p><i class="fa-solid fa-arrow-right" aria-label="arrow-right"></i> Slow mixing of <span class="color-unite">MH</span></p>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p>From the beginning of 21th century, many efforts have been made to make <span class="color-unite">MH</span> <span class="color-unite">irreversible</span>.</p>
</div></div></section>
<section id="lifting-13" class="level3" data-number="1.7">
<h3 data-number="1.7" class="anchored" data-anchor-id="lifting-13"><span class="header-section-number">1.7</span> Lifting (1/3)</h3>
<div class="small-letter">
<p><span class="color-unite">Lifting</span>: A method to make MH’s dynamics <span class="color-unite">irreversible</span></p>
<p>How?: By adding an auxiliary variable <span class="math inline">\sigma\in\{\pm1\}</span>, called <span class="color-unite">momentum</span></p>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Lifted MH [@Turitsyn+2011]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Lifted MH <span class="citation" data-cites="Turitsyn+2011">(<a href="#ref-Turitsyn+2011" role="doc-biblioref">Turitsyn et al., 2011</a>)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Input: Target <span class="math inline">p</span>, <span class="color-unite">two</span> proposals <span class="math inline">q^{(+1)},q^{(-1)}</span>, and <span class="color-unite">momentum</span> <span class="math inline">\sigma\in\{\pm1\}</span></p>
<ol type="1">
<li>Draw <span class="math inline">X_t</span> from <span class="math inline">q^{(\sigma)}</span></li>
<li>Do a MH step</li>
<li>If accepted, go back to Step 1.</li>
<li>If rejected, <span class="color-unite">flip the momentum</span> and go back to Step 1.</li>
</ol>
</div>
</div>
</section>
<section id="lifting-23" class="level3" data-number="1.8">
<h3 data-number="1.8" class="anchored" data-anchor-id="lifting-23"><span class="header-section-number">1.8</span> Lifting (2/3)</h3>
<div>

</div>
<div class="quarto-layout-panel" style="margin: 0px; !important" data-layout="[50,50]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Files/lifting_illustration.svg" class="img-fluid"></p>
<p><img src="Files/potential.svg" class="img-fluid"></p>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div style="margin-bottom: 50px; !important">
<p><span class="math inline">q^{(+1)}</span>: Only propose <span class="math inline">\rightarrow</span> moves</p>
<p><span class="math inline">q^{(-1)}</span>: Only propose <span class="math inline">\leftarrow</span> moves</p>
</div>
<p><i class="fa-solid fa-arrow-right" aria-label="arrow-right"></i> Once going uphill, it continues to go uphill.</p>
<p><i class="fa-solid fa-arrow-right" aria-label="arrow-right"></i> This is <span class="color-unite">irreversible</span>, since</p>
<p><span class="math display">\begin{align*}
  &amp;\text{Probability}[x\to y]\\
  &amp;\qquad\ne\text{Probability}[y\to x].
\end{align*}</span></p>
</div>
</div>
</div>
</section>
<section id="lifting-33" class="level3 page-columns page-full" data-number="1.9">
<h3 data-number="1.9" class="anchored" data-anchor-id="lifting-33"><span class="header-section-number">1.9</span> Lifting (3/3)</h3>
<p>Reversible dynamic of MH has ‘<span class="color-unite artificial-align">irreversified</span>’</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Files/MH_traj.svg" class="img-fluid figure-img"></p>
<figcaption>MH</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Files/LMH_traj.svg" class="img-fluid figure-img"></p>
<figcaption><span class="color-unite">Lifted MH</span></figcaption>
</figure>
</div>
</div>
<div id="third-column" class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="callout callout-style-simple callout-caution callout-titled" title="Caution">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Scale is different</strong> in the vertical axis!</p>
</div>
</div>
<div class="small-letter">
<p><span class="color-unite">Lifted MH</span> successfully explores the edges of the target distribution.</p>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p>*Irreversibility actually improves the efficiency of MCMC, as we observe in two slides later.</p>
</div></div></section>
<section id="comparison-mh-vs.-lmh-vs.-zig-zag-12" class="level3" data-number="1.10">
<h3 data-number="1.10" class="anchored" data-anchor-id="comparison-mh-vs.-lmh-vs.-zig-zag-12"><span class="header-section-number">1.10</span> Comparison: MH vs.&nbsp;LMH vs.&nbsp;Zig-Zag (1/2)</h3>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Files/MH_traj.svg" class="img-fluid figure-img"></p>
<figcaption>MH</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Files/LMH_traj.svg" class="img-fluid figure-img"></p>
<figcaption>Lifted MH</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Files/zigzag_traj.svg" class="img-fluid figure-img"></p>
<figcaption>Zig-Zag</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Zig-Zag corresponds to the <span class="color-unite">limiting case of lifted MH</span> as the step size of proposal <span class="math inline">q</span> goes to zero, as we’ll learn later.</p>
<p><i class="fa-solid fa-arrow-right" aria-label="arrow-right"></i> Zig-Zag has a maximum <span class="color-unite">irreversibility</span>.</p>
</section>
<section id="comparison-mh-vs.-lmh-vs.-zig-zag-22" class="level3" data-number="1.11">
<h3 data-number="1.11" class="anchored" data-anchor-id="comparison-mh-vs.-lmh-vs.-zig-zag-22"><span class="header-section-number">1.11</span> Comparison: MH vs.&nbsp;LMH vs.&nbsp;Zig-Zag (2/2)</h3>
<p><span class="color-unite">Irreversibility</span> actually improves the efficiency of MCMC.</p>
<p>Faster decay of <strong>autocorrelation</strong> <span class="math inline">\rho_t\approx\mathrm{Corr}[X_0,X_t]</span> implies</p>
<ol type="1">
<li>faster mixing of MCMC</li>
<li>lower variance of Monte Carlo estimates</li>
</ol>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Files/MH_auto.svg" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Files/LMH_auto.svg" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Files/zigzag_auto.svg" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Files/MH_traj.svg" class="img-fluid figure-img"></p>
<figcaption>MH</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Files/LMH_traj.svg" class="img-fluid figure-img"></p>
<figcaption>Lifted MH</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Files/zigzag_traj.svg" class="img-fluid figure-img"></p>
<figcaption>Zig-Zag</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="review-mala" class="level3" data-number="1.12">
<h3 data-number="1.12" class="anchored" data-anchor-id="review-mala"><span class="header-section-number">1.12</span> Review: MALA</h3>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Langevin diffusion</strong>: A diffusion process defined by the following SDE:</p>
<p><span class="math display">
dX_t=\nabla\log p(X_t)\,dt+\sqrt{2\beta^{-1}}dB_t.
</span></p>
<p><strong>Langevin diffusion</strong> itself converges to the target distribution <span class="math inline">p</span> in the sense that <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> <span class="math display">
\|p_t-p\|_{L^1}\to0,\qquad t\to\infty.
</span></p>
</div>
</div>
</div>
<p>Two MCMC algorithms derived from <strong>Langevin diffusion</strong>:</p>
<div class="small-letter">
<p><u>ULA (Unadjusted Langevin Algorithm)</u><br> <span class="math inline">\quad</span> Use the discretization of <span class="math inline">(X_t)</span>. <span class="color-unite">Discretization errors accumulate</span>.</p>
<p><u>MALA (Metropolis Adjusted Langevin Algorithm)</u><br> <span class="math inline">\quad</span> Use ULA as a proposal in MH, erasing the errors by MH steps.</p>
</div>
</section>
<section id="comparison-zig-zag-vs.-mala-13" class="level3" data-number="1.13">
<h3 data-number="1.13" class="anchored" data-anchor-id="comparison-zig-zag-vs.-mala-13"><span class="header-section-number">1.13</span> Comparison: Zig-Zag vs.&nbsp;MALA (1/3)</h3>
<p>How fast do they go back to high-probability regions? <a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<div>

</div>
<div class="quarto-layout-panel" style="margin: 0px; !important" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../Process/ZigZag_1D.svg" class="img-fluid figure-img"></p>
<figcaption>Zig-Zag</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../Process/MALA_1D.svg" class="img-fluid figure-img"></p>
<figcaption>MALA</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p><span class="color-unite">Irreversibility</span> of Zig-Zag accelerates its convergence.</p>
</section>
<section id="comparison-zig-zag-vs.-mala-23" class="level3" data-number="1.14">
<h3 data-number="1.14" class="anchored" data-anchor-id="comparison-zig-zag-vs.-mala-23"><span class="header-section-number">1.14</span> Comparison: Zig-Zag vs.&nbsp;MALA (2/3)</h3>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[40,60]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 40.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../Process/MALA_1D.svg" class="img-fluid figure-img"></p>
<figcaption>MALA trajectory</figcaption>
</figure>
</div>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 60.0%;justify-content: flex-start;">
<div class="callout callout-style-simple callout-caution callout-titled" title="Caution: Fake Continuity">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution: Fake Continuity
</div>
</div>
<div class="callout-body-container callout-body">
<p>The left plot looks continuous, but <strong>it actually is not</strong>.</p>
</div>
</div>
</div>
</div>
</div>
<p>MH, including MALA, is actually a <u>discrete-time process</u>.</p>
<p>The plot is obtained by <u>connecting the points</u> by line segments.</p>
</section>
<section id="comparison-zig-zag-vs.-mala-33" class="level3" data-number="1.15">
<h3 data-number="1.15" class="anchored" data-anchor-id="comparison-zig-zag-vs.-mala-33"><span class="header-section-number">1.15</span> Comparison: Zig-Zag vs.&nbsp;MALA (3/3)</h3>
<p>Monte Carlo estimation is also done differently:</p>
<div>

</div>
<div class="quarto-layout-panel" style="margin: 0px; !important" data-layout="[30,70]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 30.0%;justify-content: center;">
<p><img src="../Process/MALA_1D.svg" class="img-fluid"></p>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 70.0%;justify-content: flex-start;">
<p><u>MALA</u> outputs <span class="math inline">(X_n)_{n\in[N]}</span> defines</p>
<p><span class="math display">
\frac{1}{N}\sum_{n=1}^Nf(X_n)\xrightarrow{N\to\infty}\int_{\mathbb{R}^d} f(x)p(x)\,dx.
</span></p>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[30,70]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 30.0%;justify-content: center;">
<p><img src="../Process/ZigZag_1D.svg" class="img-fluid"></p>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 70.0%;justify-content: flex-start;">
<p><u>Zig-Zag</u> outputs <span class="math inline">(X_t)_{t\in[0,T]}</span> defines</p>
<p><span class="math display">
\int^T_0f(X_t)\,dt\xrightarrow{T\to\infty}\int_{\mathbb{R}^d} f(x)p(x)\,dx.
</span></p>
</div>
</div>
</div>
</section>
<section id="recap-of-sec-zig-zag" class="level3" data-number="1.16">
<h3 data-number="1.16" class="anchored" data-anchor-id="recap-of-sec-zig-zag"><span class="header-section-number">1.16</span> Recap of <a href="#sec-Zig-Zag" class="quarto-xref">Section&nbsp;1</a></h3>
<ul>
<li>Zig-Zag Sampler’s trajectory is a <u>PDMP</u>.</li>
<li><u>PDMP</u>, by design, has maximum <span class="color-unite">irreversibility</span>.</li>
<li><span class="color-unite">Irreversibility</span> leads to faster convergence of Zig-Zag in comparisons against <span class="color-unite">MH</span>, <span class="color-unite">Lifted MH</span>, and especially <span class="color-unite">MALA</span>.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Files/MH_auto.svg" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Files/LMH_auto.svg" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Files/zigzag_auto.svg" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Files/MH_traj.svg" class="img-fluid figure-img"></p>
<figcaption>MH</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Files/LMH_traj.svg" class="img-fluid figure-img"></p>
<figcaption>Lifted MH</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Files/zigzag_traj.svg" class="img-fluid figure-img"></p>
<figcaption>Zig-Zag</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="sec-Algorithm" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="sec-Algorithm"><span class="header-section-number">2</span> The Algorithm: How to Use It?</h2>
<p>Fast and exact simulation of continuous trajectory.</p>
<section id="review-mh-vs.-lmh-vs.-zig-zag-12" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="review-mh-vs.-lmh-vs.-zig-zag-12"><span class="header-section-number">2.1</span> Review: MH vs.&nbsp;LMH vs.&nbsp;Zig-Zag (1/2)</h3>
<p>As we’ve learned before, Zig-Zag corresponds to the <span class="color-unite">limiting case of lifted MH</span> as the step size of proposal <span class="math inline">q</span> goes to zero.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Files/MH_traj.svg" class="img-fluid figure-img"></p>
<figcaption>MH</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Files/LMH_traj.svg" class="img-fluid figure-img"></p>
<figcaption>Lifted MH</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Files/zigzag_traj.svg" class="img-fluid figure-img"></p>
<figcaption>Zig-Zag</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="review-mh-vs.-lmh-vs.-zig-zag-22" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="review-mh-vs.-lmh-vs.-zig-zag-22"><span class="header-section-number">2.2</span> Review: MH vs.&nbsp;LMH vs.&nbsp;Zig-Zag (2/2)</h3>
<p>‘<span class="color-unite">Limiting case of lifted MH</span>’ means that we only simulate <u><strong>where we should flip the momentum</strong></u> <span class="math inline">\sigma\in\{\pm1\}</span> in Lifted MH.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Files/MH_traj.svg" class="img-fluid figure-img"></p>
<figcaption>MH</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Files/LMH_traj.svg" class="img-fluid figure-img"></p>
<figcaption>Lifted MH</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Files/zigzag_traj.svg" class="img-fluid figure-img"></p>
<figcaption>Zig-Zag</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="algorithm-12" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="algorithm-12"><span class="header-section-number">2.3</span> Algorithm (1/2)</h3>
<p>‘<span class="color-unite">Limiting case of lifted MH</span>’ means that we only simulate <u><strong>where we should flip the momentum</strong></u> <span class="math inline">\sigma\in\{\pm1\}</span> in Lifted MH.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[1d ^[Multidimensional extension is straightforward, but we won't cover it today.] Zig Zag sampler @Bierkens+2019]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="citation" data-cites="Bierkens+2019">(1d <a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> Zig Zag sampler <a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens, Fearnhead, et al., 2019</a>)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Input</strong>: Gradient <span class="math inline">\nabla\log p</span> of log target density <span class="math inline">p</span></p>
<p>For <span class="math inline">n\in\{1,2,\cdots,N\}</span>:</p>
<ol type="1">
<li>Simulate an first arrival time <span class="math inline">T_n</span> of a <span class="color-unite">Poisson point process</span> (described in the next slide)</li>
<li>Linearly interpolate until time <span class="math inline">T_n</span>: <span class="math display">
X_t = X_{T_{n-1}} + \sigma(t-T_{n-1}),\qquad t\in[T_{n-1},T_n].
</span></li>
<li>Go back to Step 1 with the momentum <span class="math inline">\sigma\in\{\pm1\}</span> flipped</li>
</ol>
</div>
</div>
</section>
<section id="algorithm-22" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="algorithm-22"><span class="header-section-number">2.4</span> Algorithm (2/2)</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="[Fundamental Property of Zig-Zag Sampler (1d) @Bierkens+2019]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="citation" data-cites="Bierkens+2019">(Fundamental Property of Zig-Zag Sampler (1d) <a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens, Fearnhead, et al., 2019</a>)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">U(x):=-\log p(x)</span>. Simluating a <span class="color-unite">Poisson point process</span> with a rate function <span class="math display">
\lambda(x,\sigma):=\biggr(\sigma U'(x)\biggl)_++\;\gamma(x)
</span> ensures the Zig-Zag sampler converges to the target <span class="math inline">p</span>, where <span class="math inline">\gamma</span> is an arbitrary non-negative function.</p>
</div>
</div>
<p>Its ergodicity is ensured as long as there exists <span class="math inline">c,C&gt;0</span> such that<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> <span class="math display">
p(x)\le C\lvert x\rvert^{-c}.
</span></p>
</section>
<section id="core-of-the-algorithm" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="core-of-the-algorithm"><span class="header-section-number">2.5</span> Core of the Algorithm</h3>
<p>Given a rate function <span class="math display">
\lambda(x,\sigma):=\biggr(\sigma U'(x)\biggl)_++\;\gamma(x)
</span> how to simulate a corresponding <span class="color-unite">Poisson point process</span>?</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="What We'll Learn in the Rest of this @sec-Algorithm">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What We’ll Learn in the Rest of this <a href="#sec-Algorithm" class="quarto-xref">Section&nbsp;2</a>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>What is <span class="color-unite">Poisson Point Process</span>?</li>
<li>How to Simulate It?</li>
<li>Core Technique: <span class="color-blue">Poisson Thinning</span></li>
</ol>
<p><strong>Take Away: Zig-Zag sampling reduces to <span class="color-blue">Poisson Thinning</span></strong>.</p>
</div>
</div>
</section>
<section id="simulating-poisson-point-process-12" class="level3" data-number="2.6">
<h3 data-number="2.6" class="anchored" data-anchor-id="simulating-poisson-point-process-12"><span class="header-section-number">2.6</span> Simulating <span class="color-unite">Poisson Point Process</span> (1/2)</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="What is a [Poisson Point Process]{.color-unite} with rate $\lambda$?">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What is a <span class="color-unite">Poisson Point Process</span> with rate <span class="math inline">\lambda</span>?
</div>
</div>
<div class="callout-body-container callout-body">
<p>The number of points in <span class="math inline">[0,t]</span> follows a Poisson distribution with mean <span class="math inline">\int^t_0\lambda(x_s,\sigma_s)\,ds</span>: <span class="math display">
N([0,t])\sim\mathrm{Pois}\left(M(t)\right),\qquad M(t):=\int^t_0\lambda(x_s,\sigma_s)\,ds.
</span> We want to know when the first point <span class="math inline">T_1</span> falls on <span class="math inline">[0,\infty)</span>.</p>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" style="margin: 0px; !important" data-layout="[30,70]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 30.0%;justify-content: flex-start;">
<div id="5c978c4e" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="400" height="300" viewbox="0 0 1600 1200">
<defs>
  <clippath id="clip140">
    <rect x="0" y="0" width="1600" height="1200"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip140)" d="M0 1200 L1600 1200 L1600 0 L0 0  Z" fill="#f0f1eb" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip141">
    <rect x="320" y="0" width="1121" height="1121"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip140)" d="M173.385 1016.92 L1552.76 1016.92 L1552.76 131.032 L173.385 131.032  Z" fill="#f0f1eb" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip142">
    <rect x="173" y="131" width="1380" height="887"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="369.414,1016.92 369.414,131.032 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="749.359,1016.92 749.359,131.032 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1129.3,1016.92 1129.3,131.032 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1509.25,1016.92 1509.25,131.032 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="173.385,1016.92 1552.76,1016.92 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="369.414,1016.92 369.414,998.022 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="749.359,1016.92 749.359,998.022 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1129.3,1016.92 1129.3,998.022 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1509.25,1016.92 1509.25,998.022 "></polyline>
<path clip-path="url(#clip140)" d="M364.067 1068.98 L380.386 1068.98 L380.386 1072.92 L358.442 1072.92 L358.442 1068.98 Q361.104 1066.23 365.687 1061.6 Q370.293 1056.95 371.474 1055.61 Q373.719 1053.08 374.599 1051.35 Q375.502 1049.59 375.502 1047.9 Q375.502 1045.14 373.557 1043.41 Q371.636 1041.67 368.534 1041.67 Q366.335 1041.67 363.881 1042.43 Q361.451 1043.2 358.673 1044.75 L358.673 1040.03 Q361.497 1038.89 363.951 1038.31 Q366.405 1037.73 368.442 1037.73 Q373.812 1037.73 377.006 1040.42 Q380.201 1043.11 380.201 1047.6 Q380.201 1049.73 379.391 1051.65 Q378.604 1053.54 376.497 1056.14 Q375.918 1056.81 372.817 1060.03 Q369.715 1063.22 364.067 1068.98 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M752.368 1042.43 L740.563 1060.88 L752.368 1060.88 L752.368 1042.43 M751.141 1038.36 L757.021 1038.36 L757.021 1060.88 L761.952 1060.88 L761.952 1064.77 L757.021 1064.77 L757.021 1072.92 L752.368 1072.92 L752.368 1064.77 L736.767 1064.77 L736.767 1060.26 L751.141 1038.36 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1129.71 1053.78 Q1126.56 1053.78 1124.71 1055.93 Q1122.88 1058.08 1122.88 1061.83 Q1122.88 1065.56 1124.71 1067.73 Q1126.56 1069.89 1129.71 1069.89 Q1132.86 1069.89 1134.69 1067.73 Q1136.54 1065.56 1136.54 1061.83 Q1136.54 1058.08 1134.69 1055.93 Q1132.86 1053.78 1129.71 1053.78 M1138.99 1039.12 L1138.99 1043.38 Q1137.23 1042.55 1135.43 1042.11 Q1133.64 1041.67 1131.89 1041.67 Q1127.26 1041.67 1124.8 1044.79 Q1122.37 1047.92 1122.02 1054.24 Q1123.39 1052.23 1125.45 1051.16 Q1127.51 1050.07 1129.99 1050.07 Q1135.2 1050.07 1138.2 1053.24 Q1141.24 1056.39 1141.24 1061.83 Q1141.24 1067.16 1138.09 1070.37 Q1134.94 1073.59 1129.71 1073.59 Q1123.71 1073.59 1120.54 1069.01 Q1117.37 1064.4 1117.37 1055.67 Q1117.37 1047.48 1121.26 1042.62 Q1125.15 1037.73 1131.7 1037.73 Q1133.46 1037.73 1135.24 1038.08 Q1137.05 1038.43 1138.99 1039.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1509.25 1056.51 Q1505.92 1056.51 1504 1058.29 Q1502.1 1060.07 1502.1 1063.2 Q1502.1 1066.32 1504 1068.11 Q1505.92 1069.89 1509.25 1069.89 Q1512.58 1069.89 1514.5 1068.11 Q1516.43 1066.3 1516.43 1063.2 Q1516.43 1060.07 1514.5 1058.29 Q1512.61 1056.51 1509.25 1056.51 M1504.57 1054.52 Q1501.56 1053.78 1499.87 1051.72 Q1498.21 1049.66 1498.21 1046.69 Q1498.21 1042.55 1501.15 1040.14 Q1504.11 1037.73 1509.25 1037.73 Q1514.41 1037.73 1517.35 1040.14 Q1520.29 1042.55 1520.29 1046.69 Q1520.29 1049.66 1518.6 1051.72 Q1516.93 1053.78 1513.95 1054.52 Q1517.33 1055.3 1519.2 1057.6 Q1521.1 1059.89 1521.1 1063.2 Q1521.1 1068.22 1518.02 1070.91 Q1514.97 1073.59 1509.25 1073.59 Q1503.53 1073.59 1500.45 1070.91 Q1497.4 1068.22 1497.4 1063.2 Q1497.4 1059.89 1499.3 1057.6 Q1501.19 1055.3 1504.57 1054.52 M1502.86 1047.13 Q1502.86 1049.82 1504.53 1051.32 Q1506.22 1052.83 1509.25 1052.83 Q1512.26 1052.83 1513.95 1051.32 Q1515.66 1049.82 1515.66 1047.13 Q1515.66 1044.45 1513.95 1042.94 Q1512.26 1041.44 1509.25 1041.44 Q1506.22 1041.44 1504.53 1042.94 Q1502.86 1044.45 1502.86 1047.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M784.947 1102.26 L825.147 1102.26 L825.147 1107.67 L808.278 1107.67 L808.278 1149.78 L801.817 1149.78 L801.817 1107.67 L784.947 1107.67 L784.947 1102.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M829.094 1114.14 L834.95 1114.14 L834.95 1149.78 L829.094 1149.78 L829.094 1114.14 M829.094 1100.26 L834.95 1100.26 L834.95 1107.67 L829.094 1107.67 L829.094 1100.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M874.959 1120.98 Q877.155 1117.03 880.21 1115.15 Q883.266 1113.28 887.403 1113.28 Q892.973 1113.28 895.997 1117.19 Q899.021 1121.07 899.021 1128.27 L899.021 1149.78 L893.133 1149.78 L893.133 1128.46 Q893.133 1123.33 891.318 1120.85 Q889.504 1118.37 885.78 1118.37 Q881.229 1118.37 878.587 1121.39 Q875.945 1124.42 875.945 1129.64 L875.945 1149.78 L870.057 1149.78 L870.057 1128.46 Q870.057 1123.3 868.243 1120.85 Q866.428 1118.37 862.641 1118.37 Q858.153 1118.37 855.511 1121.42 Q852.87 1124.45 852.87 1129.64 L852.87 1149.78 L846.981 1149.78 L846.981 1114.14 L852.87 1114.14 L852.87 1119.67 Q854.875 1116.4 857.676 1114.84 Q860.477 1113.28 864.328 1113.28 Q868.211 1113.28 870.916 1115.25 Q873.654 1117.22 874.959 1120.98 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M941.194 1130.5 L941.194 1133.36 L914.267 1133.36 Q914.649 1139.41 917.895 1142.59 Q921.174 1145.74 926.998 1145.74 Q930.372 1145.74 933.523 1144.91 Q936.706 1144.09 939.825 1142.43 L939.825 1147.97 Q936.674 1149.31 933.364 1150.01 Q930.054 1150.71 926.648 1150.71 Q918.118 1150.71 913.121 1145.74 Q908.156 1140.78 908.156 1132.31 Q908.156 1123.56 912.866 1118.43 Q917.609 1113.28 925.63 1113.28 Q932.823 1113.28 936.992 1117.92 Q941.194 1122.54 941.194 1130.5 M935.337 1128.78 Q935.274 1123.97 932.632 1121.11 Q930.022 1118.24 925.693 1118.24 Q920.792 1118.24 917.832 1121.01 Q914.903 1123.78 914.458 1128.81 L935.337 1128.78 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="173.385,991.848 1552.76,991.848 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="173.385,753.064 1552.76,753.064 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="173.385,514.28 1552.76,514.28 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="173.385,275.496 1552.76,275.496 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="173.385,1016.92 173.385,131.032 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="173.385,991.848 192.283,991.848 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="173.385,753.064 192.283,753.064 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="173.385,514.28 192.283,514.28 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="173.385,275.496 192.283,275.496 "></polyline>
<path clip-path="url(#clip140)" d="M137.441 977.646 Q133.83 977.646 132.001 981.211 Q130.195 984.753 130.195 991.882 Q130.195 998.989 132.001 1002.55 Q133.83 1006.1 137.441 1006.1 Q141.075 1006.1 142.881 1002.55 Q144.709 998.989 144.709 991.882 Q144.709 984.753 142.881 981.211 Q141.075 977.646 137.441 977.646 M137.441 973.943 Q143.251 973.943 146.307 978.549 Q149.385 983.132 149.385 991.882 Q149.385 1000.61 146.307 1005.22 Q143.251 1009.8 137.441 1009.8 Q131.631 1009.8 128.552 1005.22 Q125.496 1000.61 125.496 991.882 Q125.496 983.132 128.552 978.549 Q131.631 973.943 137.441 973.943 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M133.066 766.409 L149.385 766.409 L149.385 770.344 L127.441 770.344 L127.441 766.409 Q130.103 763.654 134.686 759.024 Q139.293 754.372 140.473 753.029 Q142.719 750.506 143.598 748.77 Q144.501 747.011 144.501 745.321 Q144.501 742.566 142.557 740.83 Q140.635 739.094 137.533 739.094 Q135.334 739.094 132.881 739.858 Q130.45 740.622 127.672 742.173 L127.672 737.45 Q130.496 736.316 132.95 735.738 Q135.404 735.159 137.441 735.159 Q142.811 735.159 146.006 737.844 Q149.2 740.529 149.2 745.02 Q149.2 747.149 148.39 749.071 Q147.603 750.969 145.496 753.561 Q144.918 754.233 141.816 757.45 Q138.714 760.645 133.066 766.409 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M139.802 501.074 L127.996 519.523 L139.802 519.523 L139.802 501.074 M138.575 497 L144.455 497 L144.455 519.523 L149.385 519.523 L149.385 523.412 L144.455 523.412 L144.455 531.56 L139.802 531.56 L139.802 523.412 L124.2 523.412 L124.2 518.898 L138.575 497 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M137.857 273.633 Q134.709 273.633 132.858 275.786 Q131.029 277.938 131.029 281.688 Q131.029 285.415 132.858 287.591 Q134.709 289.744 137.857 289.744 Q141.006 289.744 142.834 287.591 Q144.686 285.415 144.686 281.688 Q144.686 277.938 142.834 275.786 Q141.006 273.633 137.857 273.633 M147.14 258.98 L147.14 263.239 Q145.381 262.406 143.575 261.966 Q141.793 261.526 140.033 261.526 Q135.404 261.526 132.95 264.651 Q130.52 267.776 130.172 274.096 Q131.538 272.082 133.598 271.017 Q135.658 269.929 138.135 269.929 Q143.344 269.929 146.353 273.1 Q149.385 276.249 149.385 281.688 Q149.385 287.012 146.237 290.23 Q143.089 293.448 137.857 293.448 Q131.862 293.448 128.691 288.864 Q125.52 284.258 125.52 275.531 Q125.52 267.337 129.408 262.476 Q133.297 257.591 139.848 257.591 Q141.607 257.591 143.39 257.939 Q145.195 258.286 147.14 258.98 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M52.7883 559.537 Q53.2392 559.537 54.302 559.827 L79.4869 566.139 Q85.0908 567.524 89.0199 572.033 Q92.949 576.51 92.949 581.598 Q92.949 584.658 91.3065 586.622 Q89.6962 588.587 87.2164 588.587 Q85.0264 588.587 83.9636 587.428 Q82.933 586.268 82.933 584.883 Q82.933 584.432 83.0618 583.949 Q83.1906 583.466 83.7381 582.951 Q84.2856 582.436 85.2196 582.436 Q86.7333 582.436 87.9249 583.756 Q88.4724 584.4 88.6012 585.012 Q88.73 585.592 88.73 586.59 Q89.6318 586.204 90.2437 585.495 Q90.8556 584.787 91.0811 583.982 Q91.3387 583.176 91.4031 582.661 Q91.4997 582.114 91.4997 581.598 Q91.4997 577.476 87.3452 574.32 Q86.0891 573.386 84.8331 572.709 Q83.6093 572.001 82.0956 571.486 Q80.6141 570.97 79.809 570.745 Q79.0039 570.487 77.1681 570.036 Q80.1633 573.032 80.1633 576.703 Q80.1633 578.249 79.7446 579.634 Q79.3259 580.986 78.4564 582.178 Q77.5546 583.37 75.9765 584.078 Q74.3984 584.754 72.305 584.754 Q70.0828 584.754 67.0555 583.885 Q64.0281 583.015 58.4565 580.922 Q55.3325 579.795 53.8189 579.795 Q53.0781 579.795 52.6273 579.956 Q52.1442 580.117 51.9831 580.439 Q51.7899 580.761 51.7577 580.954 Q51.7255 581.115 51.7255 581.437 Q51.7255 583.337 53.6578 585.109 Q55.5902 586.88 59.9058 588.104 Q60.7109 588.362 60.9042 588.523 Q61.0974 588.684 61.0974 589.167 Q61.0652 589.972 60.4211 589.972 Q60.1634 589.972 59.165 589.682 Q58.1345 589.392 56.6208 588.716 Q55.0749 588.007 53.69 587.041 Q52.273 586.075 51.2746 584.561 Q50.2762 583.015 50.2762 581.244 Q50.2762 578.829 51.8543 577.347 Q53.4002 575.833 55.6868 575.833 Q56.6208 575.833 57.4581 576.091 Q58.2633 576.317 60.4211 577.154 Q69.1167 580.535 73.3678 580.535 Q74.3984 580.535 75.268 580.374 Q76.1053 580.181 76.9427 579.763 Q77.7478 579.344 78.2309 578.507 Q78.6818 577.637 78.6818 576.445 Q78.6818 574.932 77.9733 573.515 Q77.2325 572.065 76.2342 571.164 Q75.2358 570.23 74.3984 569.682 Q73.5289 569.102 73.078 568.974 L61.2262 566.011 L55.9445 564.69 Q53.0781 564.078 52.3696 563.788 Q51.6933 563.402 51.339 562.726 Q50.9848 562.049 50.9848 561.47 Q50.9848 560.664 51.4678 560.117 Q51.9509 559.537 52.7883 559.537 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M218.262 28.9734 L218.262 51.6989 L228.551 51.6989 Q234.263 51.6989 237.382 48.7418 Q240.501 45.7846 240.501 40.3159 Q240.501 34.8877 237.382 31.9305 Q234.263 28.9734 228.551 28.9734 L218.262 28.9734 M210.079 22.2489 L228.551 22.2489 Q238.719 22.2489 243.904 26.8669 Q249.13 31.4444 249.13 40.3159 Q249.13 49.2684 243.904 53.8459 Q238.719 58.4234 228.551 58.4234 L218.262 58.4234 L218.262 82.7289 L210.079 82.7289 L210.079 22.2489 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M274.407 42.5844 Q268.412 42.5844 264.928 47.2835 Q261.445 51.942 261.445 60.0843 Q261.445 68.2266 264.888 72.9257 Q268.372 77.5842 274.407 77.5842 Q280.362 77.5842 283.846 72.8852 Q287.33 68.1861 287.33 60.0843 Q287.33 52.023 283.846 47.324 Q280.362 42.5844 274.407 42.5844 M274.407 36.265 Q284.13 36.265 289.679 42.5844 Q295.229 48.9038 295.229 60.0843 Q295.229 71.2243 289.679 77.5842 Q284.13 83.9036 274.407 83.9036 Q264.645 83.9036 259.095 77.5842 Q253.586 71.2243 253.586 60.0843 Q253.586 48.9038 259.095 42.5844 Q264.645 36.265 274.407 36.265 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M307.584 37.3587 L315.038 37.3587 L315.038 82.7289 L307.584 82.7289 L307.584 37.3587 M307.584 19.6968 L315.038 19.6968 L315.038 29.1354 L307.584 29.1354 L307.584 19.6968 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M359.557 38.6955 L359.557 45.7441 Q356.398 44.1238 352.995 43.3136 Q349.592 42.5034 345.946 42.5034 Q340.397 42.5034 337.602 44.2048 Q334.847 45.9062 334.847 49.3089 Q334.847 51.9015 336.832 53.4003 Q338.817 54.8587 344.812 56.1955 L347.364 56.7626 Q355.304 58.464 358.626 61.5832 Q361.988 64.6618 361.988 70.2116 Q361.988 76.531 356.965 80.2173 Q351.982 83.9036 343.232 83.9036 Q339.586 83.9036 335.617 83.1745 Q331.687 82.4858 327.312 81.068 L327.312 73.3713 Q331.444 75.5183 335.455 76.612 Q339.465 77.6652 343.394 77.6652 Q348.66 77.6652 351.496 75.8828 Q354.332 74.0599 354.332 70.7787 Q354.332 67.7405 352.266 66.1202 Q350.24 64.4998 343.313 63.001 L340.721 62.3933 Q333.794 60.935 330.715 57.9373 Q327.636 54.8992 327.636 49.633 Q327.636 43.2326 332.173 39.7488 Q336.71 36.265 345.055 36.265 Q349.187 36.265 352.833 36.8726 Q356.479 37.4803 359.557 38.6955 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M402.781 38.6955 L402.781 45.7441 Q399.621 44.1238 396.218 43.3136 Q392.815 42.5034 389.17 42.5034 Q383.62 42.5034 380.825 44.2048 Q378.07 45.9062 378.07 49.3089 Q378.07 51.9015 380.055 53.4003 Q382.04 54.8587 388.035 56.1955 L390.587 56.7626 Q398.527 58.464 401.849 61.5832 Q405.211 64.6618 405.211 70.2116 Q405.211 76.531 400.188 80.2173 Q395.205 83.9036 386.455 83.9036 Q382.81 83.9036 378.84 83.1745 Q374.91 82.4858 370.535 81.068 L370.535 73.3713 Q374.667 75.5183 378.678 76.612 Q382.688 77.6652 386.617 77.6652 Q391.884 77.6652 394.719 75.8828 Q397.555 74.0599 397.555 70.7787 Q397.555 67.7405 395.489 66.1202 Q393.463 64.4998 386.536 63.001 L383.944 62.3933 Q377.017 60.935 373.938 57.9373 Q370.859 54.8992 370.859 49.633 Q370.859 43.2326 375.396 39.7488 Q379.933 36.265 388.278 36.265 Q392.41 36.265 396.056 36.8726 Q399.702 37.4803 402.781 38.6955 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M434.661 42.5844 Q428.666 42.5844 425.182 47.2835 Q421.698 51.942 421.698 60.0843 Q421.698 68.2266 425.142 72.9257 Q428.625 77.5842 434.661 77.5842 Q440.616 77.5842 444.1 72.8852 Q447.584 68.1861 447.584 60.0843 Q447.584 52.023 444.1 47.324 Q440.616 42.5844 434.661 42.5844 M434.661 36.265 Q444.383 36.265 449.933 42.5844 Q455.483 48.9038 455.483 60.0843 Q455.483 71.2243 449.933 77.5842 Q444.383 83.9036 434.661 83.9036 Q424.899 83.9036 419.349 77.5842 Q413.84 71.2243 413.84 60.0843 Q413.84 48.9038 419.349 42.5844 Q424.899 36.265 434.661 36.265 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M505.552 55.3448 L505.552 82.7289 L498.098 82.7289 L498.098 55.5878 Q498.098 49.1469 495.587 45.9467 Q493.075 42.7465 488.052 42.7465 Q482.016 42.7465 478.532 46.5948 Q475.049 50.4432 475.049 57.0867 L475.049 82.7289 L467.555 82.7289 L467.555 37.3587 L475.049 37.3587 L475.049 44.4073 Q477.722 40.3159 481.328 38.2905 Q484.973 36.265 489.713 36.265 Q497.531 36.265 501.542 41.1261 Q505.552 45.9467 505.552 55.3448 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M555.297 28.9734 L555.297 51.6989 L565.586 51.6989 Q571.298 51.6989 574.417 48.7418 Q577.537 45.7846 577.537 40.3159 Q577.537 34.8877 574.417 31.9305 Q571.298 28.9734 565.586 28.9734 L555.297 28.9734 M547.114 22.2489 L565.586 22.2489 Q575.754 22.2489 580.939 26.8669 Q586.165 31.4444 586.165 40.3159 Q586.165 49.2684 580.939 53.8459 Q575.754 58.4234 565.586 58.4234 L555.297 58.4234 L555.297 82.7289 L547.114 82.7289 L547.114 22.2489 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M611.443 42.5844 Q605.447 42.5844 601.964 47.2835 Q598.48 51.942 598.48 60.0843 Q598.48 68.2266 601.923 72.9257 Q605.407 77.5842 611.443 77.5842 Q617.397 77.5842 620.881 72.8852 Q624.365 68.1861 624.365 60.0843 Q624.365 52.023 620.881 47.324 Q617.397 42.5844 611.443 42.5844 M611.443 36.265 Q621.165 36.265 626.715 42.5844 Q632.264 48.9038 632.264 60.0843 Q632.264 71.2243 626.715 77.5842 Q621.165 83.9036 611.443 83.9036 Q601.68 83.9036 596.13 77.5842 Q590.621 71.2243 590.621 60.0843 Q590.621 48.9038 596.13 42.5844 Q601.68 36.265 611.443 36.265 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M644.62 37.3587 L652.073 37.3587 L652.073 82.7289 L644.62 82.7289 L644.62 37.3587 M644.62 19.6968 L652.073 19.6968 L652.073 29.1354 L644.62 29.1354 L644.62 19.6968 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M705.383 55.3448 L705.383 82.7289 L697.929 82.7289 L697.929 55.5878 Q697.929 49.1469 695.418 45.9467 Q692.906 42.7465 687.883 42.7465 Q681.847 42.7465 678.364 46.5948 Q674.88 50.4432 674.88 57.0867 L674.88 82.7289 L667.386 82.7289 L667.386 37.3587 L674.88 37.3587 L674.88 44.4073 Q677.553 40.3159 681.159 38.2905 Q684.805 36.265 689.544 36.265 Q697.362 36.265 701.373 41.1261 Q705.383 45.9467 705.383 55.3448 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M727.623 24.4769 L727.623 37.3587 L742.976 37.3587 L742.976 43.1515 L727.623 43.1515 L727.623 67.781 Q727.623 73.3308 729.121 74.9106 Q730.661 76.4905 735.319 76.4905 L742.976 76.4905 L742.976 82.7289 L735.319 82.7289 Q726.691 82.7289 723.41 79.5287 Q720.128 76.2879 720.128 67.781 L720.128 43.1515 L714.66 43.1515 L714.66 37.3587 L720.128 37.3587 L720.128 24.4769 L727.623 24.4769 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M787.657 28.9734 L787.657 51.6989 L797.946 51.6989 Q803.658 51.6989 806.777 48.7418 Q809.896 45.7846 809.896 40.3159 Q809.896 34.8877 806.777 31.9305 Q803.658 28.9734 797.946 28.9734 L787.657 28.9734 M779.474 22.2489 L797.946 22.2489 Q808.114 22.2489 813.299 26.8669 Q818.525 31.4444 818.525 40.3159 Q818.525 49.2684 813.299 53.8459 Q808.114 58.4234 797.946 58.4234 L787.657 58.4234 L787.657 82.7289 L779.474 82.7289 L779.474 22.2489 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M854.011 44.3263 Q852.755 43.5971 851.256 43.2731 Q849.798 42.9085 848.015 42.9085 Q841.696 42.9085 838.293 47.0404 Q834.931 51.1318 834.931 58.8285 L834.931 82.7289 L827.437 82.7289 L827.437 37.3587 L834.931 37.3587 L834.931 44.4073 Q837.281 40.2754 841.048 38.2905 Q844.815 36.265 850.203 36.265 Q850.973 36.265 851.904 36.3865 Q852.836 36.4675 853.97 36.6701 L854.011 44.3263 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M877.587 42.5844 Q871.592 42.5844 868.108 47.2835 Q864.624 51.942 864.624 60.0843 Q864.624 68.2266 868.067 72.9257 Q871.551 77.5842 877.587 77.5842 Q883.542 77.5842 887.026 72.8852 Q890.509 68.1861 890.509 60.0843 Q890.509 52.023 887.026 47.324 Q883.542 42.5844 877.587 42.5844 M877.587 36.265 Q887.309 36.265 892.859 42.5844 Q898.409 48.9038 898.409 60.0843 Q898.409 71.2243 892.859 77.5842 Q887.309 83.9036 877.587 83.9036 Q867.824 83.9036 862.275 77.5842 Q856.765 71.2243 856.765 60.0843 Q856.765 48.9038 862.275 42.5844 Q867.824 36.265 877.587 36.265 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M943.414 39.1006 L943.414 46.0682 Q940.255 44.3263 937.054 43.4756 Q933.895 42.5844 930.654 42.5844 Q923.403 42.5844 919.392 47.2024 Q915.382 51.78 915.382 60.0843 Q915.382 68.3887 919.392 73.0067 Q923.403 77.5842 930.654 77.5842 Q933.895 77.5842 937.054 76.7335 Q940.255 75.8423 943.414 74.1004 L943.414 80.987 Q940.295 82.4453 936.933 83.1745 Q933.611 83.9036 929.844 83.9036 Q919.595 83.9036 913.559 77.4627 Q907.523 71.0218 907.523 60.0843 Q907.523 48.9848 913.6 42.6249 Q919.716 36.265 930.33 36.265 Q933.773 36.265 937.054 36.9942 Q940.336 37.6828 943.414 39.1006 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M995.185 58.1804 L995.185 61.8262 L960.914 61.8262 Q961.4 69.5229 965.532 73.5738 Q969.705 77.5842 977.118 77.5842 Q981.412 77.5842 985.422 76.531 Q989.473 75.4778 993.443 73.3713 L993.443 80.4199 Q989.433 82.1212 985.22 83.0124 Q981.007 83.9036 976.672 83.9036 Q965.816 83.9036 959.456 77.5842 Q953.136 71.2648 953.136 60.4894 Q953.136 49.3494 959.132 42.8275 Q965.168 36.265 975.376 36.265 Q984.531 36.265 989.838 42.1793 Q995.185 48.0531 995.185 58.1804 M987.731 55.9929 Q987.65 49.876 984.288 46.2302 Q980.966 42.5844 975.457 42.5844 Q969.219 42.5844 965.451 46.1087 Q961.724 49.633 961.157 56.0334 L987.731 55.9929 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1036.34 38.6955 L1036.34 45.7441 Q1033.18 44.1238 1029.78 43.3136 Q1026.38 42.5034 1022.73 42.5034 Q1017.18 42.5034 1014.39 44.2048 Q1011.63 45.9062 1011.63 49.3089 Q1011.63 51.9015 1013.62 53.4003 Q1015.6 54.8587 1021.6 56.1955 L1024.15 56.7626 Q1032.09 58.464 1035.41 61.5832 Q1038.77 64.6618 1038.77 70.2116 Q1038.77 76.531 1033.75 80.2173 Q1028.77 83.9036 1020.02 83.9036 Q1016.37 83.9036 1012.4 83.1745 Q1008.47 82.4858 1004.1 81.068 L1004.1 73.3713 Q1008.23 75.5183 1012.24 76.612 Q1016.25 77.6652 1020.18 77.6652 Q1025.45 77.6652 1028.28 75.8828 Q1031.12 74.0599 1031.12 70.7787 Q1031.12 67.7405 1029.05 66.1202 Q1027.02 64.4998 1020.1 63.001 L1017.51 62.3933 Q1010.58 60.935 1007.5 57.9373 Q1004.42 54.8992 1004.42 49.633 Q1004.42 43.2326 1008.96 39.7488 Q1013.49 36.265 1021.84 36.265 Q1025.97 36.265 1029.62 36.8726 Q1033.26 37.4803 1036.34 38.6955 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1079.57 38.6955 L1079.57 45.7441 Q1076.41 44.1238 1073 43.3136 Q1069.6 42.5034 1065.95 42.5034 Q1060.4 42.5034 1057.61 44.2048 Q1054.85 45.9062 1054.85 49.3089 Q1054.85 51.9015 1056.84 53.4003 Q1058.82 54.8587 1064.82 56.1955 L1067.37 56.7626 Q1075.31 58.464 1078.63 61.5832 Q1082 64.6618 1082 70.2116 Q1082 76.531 1076.97 80.2173 Q1071.99 83.9036 1063.24 83.9036 Q1059.59 83.9036 1055.62 83.1745 Q1051.69 82.4858 1047.32 81.068 L1047.32 73.3713 Q1051.45 75.5183 1055.46 76.612 Q1059.47 77.6652 1063.4 77.6652 Q1068.67 77.6652 1071.5 75.8828 Q1074.34 74.0599 1074.34 70.7787 Q1074.34 67.7405 1072.27 66.1202 Q1070.25 64.4998 1063.32 63.001 L1060.73 62.3933 Q1053.8 60.935 1050.72 57.9373 Q1047.64 54.8992 1047.64 49.633 Q1047.64 43.2326 1052.18 39.7488 Q1056.72 36.265 1065.06 36.265 Q1069.19 36.265 1072.84 36.8726 Q1076.49 37.4803 1079.57 38.6955 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1115.9 37.3587 L1123.36 37.3587 L1132.67 72.7637 L1141.95 37.3587 L1150.74 37.3587 L1160.06 72.7637 L1169.33 37.3587 L1176.79 37.3587 L1164.92 82.7289 L1156.13 82.7289 L1146.36 45.5416 L1136.56 82.7289 L1127.77 82.7289 L1115.9 37.3587 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1188.09 37.3587 L1195.54 37.3587 L1195.54 82.7289 L1188.09 82.7289 L1188.09 37.3587 M1188.09 19.6968 L1195.54 19.6968 L1195.54 29.1354 L1188.09 29.1354 L1188.09 19.6968 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1218.51 24.4769 L1218.51 37.3587 L1233.86 37.3587 L1233.86 43.1515 L1218.51 43.1515 L1218.51 67.781 Q1218.51 73.3308 1220.01 74.9106 Q1221.55 76.4905 1226.21 76.4905 L1233.86 76.4905 L1233.86 82.7289 L1226.21 82.7289 Q1217.58 82.7289 1214.3 79.5287 Q1211.02 76.2879 1211.02 67.781 L1211.02 43.1515 L1205.55 43.1515 L1205.55 37.3587 L1211.02 37.3587 L1211.02 24.4769 L1218.51 24.4769 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1281.38 55.3448 L1281.38 82.7289 L1273.93 82.7289 L1273.93 55.5878 Q1273.93 49.1469 1271.42 45.9467 Q1268.9 42.7465 1263.88 42.7465 Q1257.85 42.7465 1254.36 46.5948 Q1250.88 50.4432 1250.88 57.0867 L1250.88 82.7289 L1243.38 82.7289 L1243.38 19.6968 L1250.88 19.6968 L1250.88 44.4073 Q1253.55 40.3159 1257.16 38.2905 Q1260.8 36.265 1265.54 36.265 Q1273.36 36.265 1277.37 41.1261 Q1281.38 45.9467 1281.38 55.3448 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1356.32 82.8109 Q1356.32 83.5896 1355.42 83.6716 L1353.58 83.6716 Q1351.69 83.6716 1350.87 83.3847 Q1350.05 83.0978 1349.11 81.7861 Q1348.54 80.9663 1347.1 77.1543 Q1345.71 73.3013 1343.66 67.4809 Q1341.65 61.6604 1340.3 58.2173 L1320.09 82.073 Q1318.7 83.8356 1317.3 83.8356 Q1316.28 83.8356 1315.54 83.1388 Q1314.8 82.442 1314.8 81.3762 Q1314.8 80.5974 1315.09 80.1466 Q1315.42 79.6957 1316.28 78.7939 L1339.48 55.7989 L1331.32 32.9679 Q1329.76 28.746 1328.86 27.6803 Q1328 26.6146 1325.87 26.2456 Q1325.09 26.0407 1325.09 25.3849 Q1325.09 24.4831 1326.61 24.4831 Q1334.72 24.4831 1336.85 30.4266 L1353.99 78.1791 Q1354.93 80.9253 1355.91 82.073 Q1356.32 82.6059 1356.32 82.8109 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1441.94 44.2809 Q1442.43 44.7728 1442.43 45.4696 Q1442.43 46.1664 1441.94 46.6583 Q1441.45 47.1502 1440.75 47.1502 L1388.21 47.1502 Q1387.51 47.1502 1387.02 46.6583 Q1386.53 46.1664 1386.53 45.4696 Q1386.53 44.7728 1387.02 44.2809 Q1387.51 43.7891 1388.21 43.7891 L1440.75 43.7891 Q1441.45 43.7891 1441.94 44.2809 M1441.94 60.5537 Q1442.43 61.0455 1442.43 61.7424 Q1442.43 62.4392 1441.94 62.9311 Q1441.45 63.4229 1440.75 63.4229 L1388.21 63.4229 Q1387.51 63.4229 1387.02 62.9311 Q1386.53 62.4392 1386.53 61.7424 Q1386.53 61.0455 1387.02 60.5537 Q1387.51 60.0618 1388.21 60.0618 L1440.75 60.0618 Q1441.45 60.0618 1441.94 60.5537 M1441.94 76.8264 Q1442.43 77.3183 1442.43 78.0151 Q1442.43 78.7119 1441.94 79.2038 Q1441.45 79.6957 1440.75 79.6957 L1388.21 79.6957 Q1387.51 79.6957 1387.02 79.2038 Q1386.53 78.7119 1386.53 78.0151 Q1386.53 77.3183 1387.02 76.8264 Q1387.51 76.3345 1388.21 76.3345 L1440.75 76.3345 Q1441.45 76.3345 1441.94 76.8264 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1474.49 34.8124 L1474.49 32.1891 Q1484.57 32.1891 1489.78 26.8195 Q1491.21 26.8195 1491.46 27.1474 Q1491.7 27.4753 1491.7 28.9919 L1491.7 76.0886 Q1491.7 78.589 1492.93 79.3678 Q1494.16 80.1466 1499.53 80.1466 L1502.2 80.1466 L1502.2 82.7289 Q1499.25 82.4829 1488.59 82.4829 Q1477.93 82.4829 1475.02 82.7289 L1475.02 80.1466 L1477.69 80.1466 Q1482.97 80.1466 1484.24 79.4087 Q1485.52 78.6299 1485.52 76.0886 L1485.52 32.599 Q1481.13 34.8124 1474.49 34.8124 Z" fill="#e95420" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip142)" style="stroke:#0096ff; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="212.424,872.456 228.757,872.456 228.757,753.064 349.212,753.064 349.212,633.672 975.507,633.672 975.507,514.28 1083.77,514.28 1083.77,394.888 1268.32,394.888 1268.32,275.496 1513.72,275.496 1513.72,156.104 "></polyline>
<circle clip-path="url(#clip142)" cx="212.424" cy="991.848" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.4"></circle>
<circle clip-path="url(#clip142)" cx="228.757" cy="991.848" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.4"></circle>
<circle clip-path="url(#clip142)" cx="349.212" cy="991.848" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.4"></circle>
<circle clip-path="url(#clip142)" cx="975.507" cy="991.848" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.4"></circle>
<circle clip-path="url(#clip142)" cx="1083.77" cy="991.848" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.4"></circle>
<circle clip-path="url(#clip142)" cx="1268.32" cy="991.848" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.4"></circle>
<circle clip-path="url(#clip142)" cx="1513.72" cy="991.848" r="18" fill="#e95420" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.4"></circle>
</svg>
</div>
</div>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 70.0%;justify-content: flex-start;">
<p>When <span class="math inline">\displaystyle\lambda(x,\sigma)\equiv c\;(\text{constant})</span>,</p>
<ul>
<li><p><span class="color-blue">blue line</span>: <span class="color-blue">Poisson Process</span></p></li>
<li><p><span class="color-unite">red dots</span>: <span class="color-unite">Poisson Point Process</span></p></li>
</ul>
<p>satisfying <span class="math inline">\displaystyle\textcolor{#0096FF}{N_t}=\textcolor{#E95420}{N([0,t])}\sim\mathrm{Pois}(ct)</span>.</p>
</div>
</div>
</div>
<!--
### Simulating [Poisson Point Process]{.color-unite} (2/3)

::: {.callout-tip title="Proposition (Simulation of Poisson Point Process)" icon="false"}

The first arrival time $T_1$ of a [Poisson Point Process]{.color-unite} with rate $\lambda$ can be simulated by
$$
T_1\deq M^{-1}(E),\qquad E\sim\Exp(1),M(t):=\int^t_0\lambda(x_s,\sigma_s)\,ds,
$$
where $\Exp(1)$ denotes the exponential distribution with parameter $1$.

:::

Reminder: Poisson Process with $\lambda\equiv c\in\R$ can be simulated as
$$
T_1\sim\Exp(c).
$$
In addition, $T_{n}-T_{n-1}\sim\Exp(c)$ for all $n\in\{2,3,\cdots\}$.
-->
</section>
<section id="simulating-poisson-point-process-22" class="level3" data-number="2.7">
<h3 data-number="2.7" class="anchored" data-anchor-id="simulating-poisson-point-process-22"><span class="header-section-number">2.7</span> Simulating <span class="color-unite">Poisson Point Process</span> (2/2)</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="Proposition (Simulation of Poisson Point Process)">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proposition (Simulation of Poisson Point Process)
</div>
</div>
<div class="callout-body-container callout-body">
<p>The first arrival time <span class="math inline">T_1</span> of a <span class="color-unite">Poisson Point Process</span> with rate <span class="math inline">\lambda</span> can be simulated by <span class="math display">
T_1\overset{\text{d}}{=}M^{-1}(E),\qquad E\sim\operatorname{Exp}(1),M(t):=\int^t_0\lambda(x_s,\sigma_s)\,ds,
</span> where <span class="math inline">\operatorname{Exp}(1)</span> denotes the exponential distribution with parameter <span class="math inline">1</span>.</p>
</div>
</div>
<p>Since <span class="math inline">\displaystyle\lambda(x,\sigma):=\biggr(\sigma U'(x)\biggl)_++\;\gamma(x)</span>, <span class="math inline">M</span> can be quite complicated.</p>
<p><i class="fa-solid fa-arrow-right" aria-label="arrow-right"></i> Inverting <span class="math inline">M</span> can be impossible.</p>
<p><i class="fa-solid fa-arrow-right" aria-label="arrow-right"></i> We need more general techniques: <span class="color-blue">Poisson Thinning</span>.</p>
<!-- 
1d: $x\in\R,\sigma\in\{\pm1\}$
$$
\lambda(x,\sigma):=\Paren{\sigma U'(x)}_++\;\gamma(x)
$$

Multidimensional: $x\in\R^d,\sigma\in\{\pm1\}^d$
$$
\lambda_i(x,\sigma):=\Paren{\sigma\cdot \nabla U_i(x)}_++\;\gamma_i(x,\sigma_{-i})
$$
-->
</section>
<section id="poisson-thinning-12" class="level3" data-number="2.8">
<h3 data-number="2.8" class="anchored" data-anchor-id="poisson-thinning-12"><span class="header-section-number">2.8</span> <span class="color-blue">Poisson Thinning</span> (1/2)</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="[@Lewis-Shedler1979]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="citation" data-cites="Lewis-Shedler1979">(<a href="#ref-Lewis-Shedler1979" role="doc-biblioref">Lewis and Shedler, 1979</a>)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>To obtain the first arrival time <span class="math inline">T_1</span> of a <span class="color-unite">Poisson Point Process</span> with rate <span class="math inline">\lambda</span>,</p>
<ol type="1">
<li>Find a bound <span class="math inline">M</span> that satisfies <span class="math display">
m(t):=\int^t_0\lambda(x_s,\sigma_s)\,ds\le M(t).
</span></li>
<li>Simulate a point <span class="math inline">T</span> from the <span class="color-unite">Poisson Point Process</span> with intensity <span class="math inline">M</span>.</li>
<li>Accept <span class="math inline">T</span> with probability <span class="math inline">\frac{m(T)}{M(T)}</span>.</li>
</ol>
</div>
</div>
<div class="small-letter">
<ul>
<li><p><span class="math inline">m(t)</span>: Defined via <span class="math inline">\displaystyle\lambda(x,\sigma):=\biggr(\sigma U'(x)\biggl)_++\;\gamma(x)</span>.</p></li>
<li><p><span class="math inline">M(t)</span>: Simple upper bound <span class="math inline">m\le M</span>, such that <span class="math inline">M^{-1}</span> is analytically tractable.</p></li>
</ul>
</div>
</section>
<section id="poisson-thinning-22" class="level3" data-number="2.9">
<h3 data-number="2.9" class="anchored" data-anchor-id="poisson-thinning-22"><span class="header-section-number">2.9</span> <span class="color-blue">Poisson Thinning</span> (2/2)</h3>
<p>In order to simulate a <span class="color-unite">Poisson Point Process</span> with rate <span class="math display">
\lambda(x,\sigma):=\biggr(\sigma U'(x)\biggl)_++\;\gamma(x),
</span> we find a <span class="color-blue">invertible upper bound <span class="math inline">M</span></span> that satisfies <span class="math display">
\int^t_0\lambda(x_s,\sigma_s)\,ds=m(t)\le\textcolor{#0096FF}{M}(t).
</span> for all possible Zig-Zag trajectories <span class="math inline">\{(x_s,\sigma_s)\}_{s\in[0,T]}</span>.</p>
</section>
<section id="recap-of-sec-algorithm" class="level3" data-number="2.10">
<h3 data-number="2.10" class="anchored" data-anchor-id="recap-of-sec-algorithm"><span class="header-section-number">2.10</span> Recap of <a href="#sec-Algorithm" class="quarto-xref">Section&nbsp;2</a></h3>
<ol type="1">
<li>Continuous-time MCMC, based on <u>PDMP</u>, has an entirely different algorithm and strategy.</li>
<li>To simulate <u>PDMP</u> is to simulate <span class="color-unite">Poisson Point Process</span>.</li>
<li>The core technology to simulate <span class="color-unite">Poisson Point Process</span> is <span class="color-blue">Poisson Thinning</span>.</li>
<li><span class="color-blue">Poisson Thinning</span> is about finding an <span class="color-blue">upper bound <span class="math inline">M</span></span>, with tractable inverse <span class="math inline">M^{-1}</span>; Typically a polynomial function.</li>
<li>The <span class="color-blue">upper bound <span class="math inline">M</span></span> has to be given on a case-by-case basis.</li>
</ol>
</section>
</section>
<section id="sec-ProofOfConcept" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="sec-ProofOfConcept"><span class="header-section-number">3</span> Proof of Concept: How Good Is It?</h2>
<p>Quick demonstration of the state-of-the-art performance on a toy example.</p>
<section id="review-the-3-steps-of-zig-zag-sampling" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="review-the-3-steps-of-zig-zag-sampling"><span class="header-section-number">3.1</span> Review: The 3 Steps of Zig-Zag Sampling</h3>
<p>Given a target <span class="math inline">p</span>,</p>
<ol type="1">
<li>Calculate the negative log-likelihood <span class="math inline">U(x):=-\log p(x)</span></li>
<li>Fix a refresh rate <span class="math inline">\gamma(x)</span> and compute the rate function <span class="math display">
  \lambda(x,\sigma):=\biggr(\sigma U'(x)\biggl)_++\;\gamma(x).
  </span></li>
<li>Find an <span class="color-blue">invertible upper bound <span class="math inline">M</span></span> that satisfies <span class="math display">
  \int^t_0\lambda(x_s,\sigma_s)\,ds=:m(t)\le\textcolor{#0096FF}{M}(t).
  </span></li>
</ol>
</section>
<section id="model-1d-gaussian-mean-reconstruction" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="model-1d-gaussian-mean-reconstruction"><span class="header-section-number">3.2</span> Model: 1d Gaussian Mean Reconstruction</h3>
<div>

</div>
<div class="quarto-layout-panel" style="margin: 0px; !important" data-layout="[53,50]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 51.5%;justify-content: flex-start;">
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Setting">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Setting
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p><u>Data</u>: <span class="math inline">y_1,\cdots,y_n\in\mathbb{R}</span> aquired by <span class="math display">
y_i\overset{\text{iid}}{\sim}\mathrm{N}(x_0,\sigma^2),\qquad i\in[n],
</span> with <span class="math inline">\sigma&gt;0</span> known, <span class="math inline">x_0\in\mathbb{R}</span> unknown.</p></li>
<li><p><u>Prior</u>: <span class="math inline">\mathrm{N}(0,\rho^2)</span> with known <span class="math inline">\rho&gt;0</span>.</p></li>
<li><p><u>Goal</u>: Sampling from the posterior <span class="math display">
p(x)\,\propto\,\left(\prod_{i=1}^n\phi(x|y_i,\sigma^2)\right)\phi(x|0,\rho^2),
</span> where <span class="math inline">\phi(x|y,\sigma^2)</span> is the <span class="math inline">\mathrm{N}(y,\sigma^2)</span> density.</p></li>
</ul>
</div>
</div>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 48.5%;justify-content: flex-start;">
<p>The negative log-likelihood: <span class="math display">\begin{align*}
  U(x)&amp;=-\log p(x)\\
  &amp;=\frac{x^2}{2\rho^2}+\frac{1}{2\sigma^2}\sum_{i=1}^n(x-y_i)^2+\mathrm{const.},\\
  U'(x)&amp;=\frac{x}{\rho^2}+\frac{1}{\sigma^2}\sum_{i=1}^n(x-y_i),\\
  U''(x)&amp;=\frac{1}{\rho^2}+\frac{n}{\sigma^2}.
\end{align*}</span></p>
</div>
</div>
</div>
</section>
<section id="menu-1" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="menu-1"><span class="header-section-number">3.3</span> Menu</h3>
<p>In the rest of this <a href="#sec-ProofOfConcept" class="quarto-xref">Section&nbsp;3</a>, we’ll learn:</p>
<ol type="1">
<li>Even a <span class="color-minty">simple Zig-Zag Sampler with <span class="math inline">\gamma\equiv0</span></span> surpasses <span class="color-julia-blue">MALA</span>.</li>
<li>Incorporating sub-sampling, <span class="color-unite">Zig-Zag with Control Variates</span> further improves the efficiency.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Files/MeanOfGaussian_addedMALA.svg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section>
<section id="simple-zig-zag-sampler-with-gammaequiv0-12" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="simple-zig-zag-sampler-with-gammaequiv0-12"><span class="header-section-number">3.4</span> <span class="color-minty">Simple Zig-Zag Sampler with <span class="math inline">\gamma\equiv0</span></span> (1/2)</h3>
<p>Fixing <span class="math inline">\gamma\equiv0</span>, we obtain <span class="color-blue">the upper bound <span class="math inline">M</span></span> <span class="math display">\begin{align*}
  m(t)&amp;=\int^t_0\lambda(x_s,\sigma_s)\,ds=\int^t_0\biggr(\sigma U'(x_s)\biggl)_+\,ds\\
  &amp;\le\left(\frac{\sigma x}{\rho^2}+\frac{\sigma}{\sigma^2}\sum_{i=1}^n(x-y_i)+t\left(\frac{1}{\rho^2}+\frac{n}{\sigma^2}\right)\right)_+\\
  &amp;=:(a+bt)_+=\textcolor{#0096FF}{M}(t),
\end{align*}</span></p>
<p>where <span class="math display">
a=\frac{\sigma x}{\rho^2}+\frac{\sigma}{\sigma^2}\sum_{i=1}^n(x-y_i),\quad b=\frac{1}{\rho^2}+\frac{n}{\sigma^2}.
</span></p>
</section>
<section id="result-1d-gaussian-mean-reconstruction" class="level3" data-number="3.5">
<h3 data-number="3.5" class="anchored" data-anchor-id="result-1d-gaussian-mean-reconstruction"><span class="header-section-number">3.5</span> Result: 1d Gaussian Mean Reconstruction</h3>
<p>We generated 100 samples from <span class="math inline">\mathrm{N}(x_0,\sigma^2)</span> with <span class="math inline">x_0=1</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Files/MeanOfGaussian_addedMALA.svg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section>
<section id="mse-per-epoch-the-vertical-axis" class="level3" data-number="3.6">
<h3 data-number="3.6" class="anchored" data-anchor-id="mse-per-epoch-the-vertical-axis"><span class="header-section-number">3.6</span> MSE per Epoch: The Vertical Axis</h3>
<p>MSE (Mean Squared Error) of <span class="math inline">\{X_i\}_{i=1}^n</span> is defined as <span class="math display">
\frac{1}{n}\sum_{i=1}^n(X_i-x_0)^2.
</span> Epoch: Unit computational cost.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="The following is considered as one epoch:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The following is considered as one epoch:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>One evaluation of a likelihood ratio <span class="math display">
\frac{p(X_{n+1})}{p(X_n)}.
</span></li>
<li>One evaluation of a <span class="color-unite">Poisson Point Process</span>.</li>
</ul>
</div>
</div>
</section>
<section id="good-news" class="level3" data-number="3.7">
<h3 data-number="3.7" class="anchored" data-anchor-id="good-news"><span class="header-section-number">3.7</span> Good News!</h3>
<p>Case-by-case construction of an <span class="color-blue">upper bound <span class="math inline">M</span></span> is too complicated / demanding.</p>
<p>Therefore, we are trying to <span class="color-unite">automate</span> the whole procedure.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Automatic Zig-Zag">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Automatic Zig-Zag
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Automatic Zig-Zag <span class="citation" data-cites="Corbella+2022">(<a href="#ref-Corbella+2022" role="doc-biblioref">Corbella et al., 2022</a>)</span></li>
<li>Concave-Convex PDMP <span class="citation" data-cites="Sutton-Fearnhead2023">(<a href="#ref-Sutton-Fearnhead2023" role="doc-biblioref">Sutton and Fearnhead, 2023</a>)</span></li>
<li>NuZZ (numerical Zig-Zag) <span class="citation" data-cites="Pagani+2023">(<a href="#ref-Pagani+2023" role="doc-biblioref">Pagani et al., 2024</a>)</span></li>
</ol>
</div>
</div>
</section>
</section>
<section id="references" class="level2 unnumbered unlisted">
<h2 class="unnumbered unlisted anchored" data-anchor-id="references">References</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[40,60]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 40.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Files/QR_ZigZagPoliSci.svg" class="img-fluid figure-img"></p>
<figcaption>Slides and codes are available here</figcaption>
</figure>
</div>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 60.0%;justify-content: flex-start;">
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Besag1994" class="csl-entry" role="listitem">
Besag, J. E. (1994). <a href="https://www.jstor.org/stable/2346184"><span class="nocase">Comments on <span>“Representations of Knowledge in Complex Systems”</span> by U. Grenander and M. I. Miller</span></a>. <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, <em>56</em>(4), 591–592.
</div>
<div id="ref-Bierkens+2019" class="csl-entry" role="listitem">
Bierkens, J., Fearnhead, P., and Roberts, G. (2019). <a href="https://doi.org/10.1214/18-AOS1715"><span class="nocase">The Zig-Zag Process and Super-Efficient Sampling for Bayesian Analysis of Big Data</span></a>. <em>The Annals of Statistics</em>, <em>47</em>(3), 1288–1320.
</div>
<div id="ref-Bierkens+2020" class="csl-entry" role="listitem">
Bierkens, J., Grazzi, S., Kamatani, K., and Roberts, G. O. (2020). <a href="https://proceedings.mlr.press/v119/bierkens20a.html">The boomerang sampler</a>. <em>Proceedings of the 37th International Conference on Machine Learning</em>, <em>119</em>, 908–918.
</div>
<div id="ref-Bierkens-Roberts-Zigg2019" class="csl-entry" role="listitem">
Bierkens, J., Roberts, G. O., and Zitt, P.-A. (2019). <a href="https://doi.org/10.1214/18-AAP1453"><span class="nocase">Ergodicity of the zigzag process</span></a>. <em>The Annals of Applied Probability</em>, <em>29</em>(4), 2266–2301.
</div>
<div id="ref-Bouchard-Cote+2018-BPS" class="csl-entry" role="listitem">
Bouchard-Côté, A., Vollmer, S. J., and Doucet, A. (2018). <a href="https://www.tandfonline.com/doi/full/10.1080/01621459.2017.1294075">The bouncy particle sampler: A nonreversible rejection-free markov chain monte carlo method</a>. <em>Journal of the American Statistical Association</em>, <em>113</em>(522), 855–867.
</div>
<div id="ref-Corbella+2022" class="csl-entry" role="listitem">
Corbella, A., Spencer, S. E. F., and Roberts, G. O. (2022). <a href="https://doi.org/10.1007/s11222-022-10142-x"><span class="nocase">Automatic Zig-Zag Sampling in Practice</span></a>. <em>Statistics and Computing</em>, <em>32</em>(6), 107.
</div>
<div id="ref-Dai+2019" class="csl-entry" role="listitem">
Dai, H., Pollock, M., and Roberts, G. (2019). <a href="http://www.jstor.org/stable/45277571"><span>Monte Carlo Fusion</span></a>. <em>Journal of Applied Probability</em>, <em>56</em>(1), 174–191.
</div>
<div id="ref-Davis1984" class="csl-entry" role="listitem">
Davis, M. H. A. (1984). <a href="https://www.jstor.org/stable/2345677">Piecewise-deterministic markov processes: A general class of non-diffusion stochastic models</a>. <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, <em>46</em>(3), 353–388.
</div>
<div id="ref-Davis1993" class="csl-entry" role="listitem">
Davis, M. H. A. (1993). <em><a href="https://doi.org/10.1201/9780203748039">Markov models and optimization</a></em>,Vol. 49. Chapman &amp; Hall.
</div>
<div id="ref-Duane+1987" class="csl-entry" role="listitem">
Duane, S., Kennedy, A. D., Pendleton, B. J., and Roweth, D. (1987). <a href="https://doi.org/10.1016/0370-2693(87)91197-X">Hybrid monte carlo</a>. <em>Physics Letters B</em>, <em>195</em>(2), 216–222.
</div>
<div id="ref-Fearnhead+2024" class="csl-entry" role="listitem">
Fearnhead, P., Grazzi, S., Nemeth, C., and Roberts, G. O. (2024). <a href="https://arxiv.org/abs/2406.19051">Stochastic gradient piecewise deterministic monte carlo samplers</a>.
</div>
<div id="ref-Grazzi2020" class="csl-entry" role="listitem">
Grazzi, S. (2020). <em><a href="https://diamhomes.ewi.tudelft.nl/~jorisbierkens/pdmps.html">Piecewise deterministic monte carlo</a></em>.
</div>
<div id="ref-Hastings1970" class="csl-entry" role="listitem">
Hastings, W. K. (1970). <a href="https://www.jstor.org/stable/2334940">Monte carlo sampling methods using markov chains and their applications</a>. <em>Biometrika</em>, <em>57</em>(1), 97–109.
</div>
<div id="ref-Lewis-Shedler1979" class="csl-entry" role="listitem">
Lewis, P. A. W., and Shedler, G. S. (1979). <a href="https://doi.org/10.1002/nav.3800260304">Simulation of nonhomogeneous poisson processes by thinning</a>. <em>Naval Research Logistics Quarterly</em>, <em>26</em>(3), 403–413.
</div>
<div id="ref-Metropolis+1953" class="csl-entry" role="listitem">
Metropolis, N., Rosenbluth, A. W., Rosenbluth, M. N., Teller, A. H., and Teller, E. (1953). <a href="https://doi.org/10.1063/1.1699114">Equation of state calculations by fast computing machines</a>. <em>The Journal of Chemical Physics</em>, <em>21</em>(6), 1087–1092.
</div>
<div id="ref-Pagani+2023" class="csl-entry" role="listitem">
Pagani, F., Chevallier, A., Power, S., House, T., and Cotter, S. (2024). <a href="https://doi.org/10.1007/s11222-023-10363-8">NuZZ: Numerical zig-zag for general models</a>. <em>Statistics and Computing</em>, <em>34</em>(1), 61.
</div>
<div id="ref-Peters-deWith2012" class="csl-entry" role="listitem">
Peters, E. A. J. F., and de&nbsp;With, G. (2012). <a href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.85.026703">Rejection-free monte carlo sampling for general potentials</a>. <em>Physical Review E</em>, <em>85</em>(2).
</div>
<div id="ref-Scott+2016" class="csl-entry" role="listitem">
Scott, S. L., Blocker, A. W., Bonassi, F. V., Chipman, H. A., George, E. I., and McCulloch, R. E. (2016). <a href="http://www.tandfonline.com/doi/full/10.1080/17509653.2016.1142191">Bayes and big data: The consensus monte carlo algorithm</a>. <em>International Journal of Management Science and Engineering Management</em>, <em>11</em>, 78–88.
</div>
<div id="ref-Srivastava+2015" class="csl-entry" role="listitem">
Srivastava, S., Cevher, V., Dinh, Q., and Dunson, D. (2015). <a href="https://proceedings.mlr.press/v38/srivastava15.html"><span class="nocase">WASP: Scalable Bayes via barycenters of subset posteriors</span></a>. In G. Lebanon and S. V. N. Vishwanathan, editors, <em>Proceedings of the eighteenth international conference on artificial intelligence and statistics</em>,Vol. 38, pages 912–920. San Diego, California, USA: PMLR.
</div>
<div id="ref-Sutton-Fearnhead2023" class="csl-entry" role="listitem">
Sutton, M., and Fearnhead, P. (2023). <a href="https://doi.org/10.1080/10618600.2023.2203735"><span class="nocase">Concave-Convex PDMP-based Sampling</span></a>. <em>Journal of Computational and Graphical Statistics</em>, <em>32</em>(4), 1425–1435.
</div>
<div id="ref-Turitsyn+2011" class="csl-entry" role="listitem">
Turitsyn, K. S., Chertkov, M., and Vucelja, M. (2011). <a href="https://doi.org/10.1016/j.physd.2010.10.003"><span class="nocase">Irreversible Monte Carlo algorithms for Efficient Sampling</span></a>. <em>Physica D-Nonlinear Phenomena</em>, <em>240</em>(5-Apr), 410–414.
</div>
<div id="ref-Welling-Teh2011" class="csl-entry" role="listitem">
Welling, M., and Teh, Y. W. (2011). <a href="https://dl.acm.org/doi/10.5555/3104482.3104568">Bayesian learning via stochastic gradient langevin dynamics</a>. In <em>Proceedings of the 28th international conference on international conference on machine learning</em>, pages 681–688. Madison, WI, USA: Omnipress.
</div>
</div>
</div>
</div>
</div>
</section>
<section id="appendix-scalability-by-subsampling" class="level2 unnumbered unlisted" data-visibility="uncounted">
<h2 class="unnumbered unlisted anchored" data-visibility="uncounted" data-anchor-id="appendix-scalability-by-subsampling">Appendix: Scalability by Subsampling</h2>
<p>Construction of <span class="color-unite">ZZ-CV</span> (<span class="color-unite">Zig-Zag with Control Variates</span>).</p>
<section id="review-1d-gaussian-mean-reconstruction" class="level3" data-number="3.8">
<h3 data-number="3.8" class="anchored" data-anchor-id="review-1d-gaussian-mean-reconstruction"><span class="header-section-number">3.8</span> Review: 1d Gaussian Mean Reconstruction</h3>
<p><span class="math inline">U'</span> has an alternative form:</p>
<p><span class="math display">\begin{align*}
  U'(x)&amp;=\frac{x}{\rho^2}+\frac{1}{\sigma^2}\sum_{i=1}^n(x-y_i)=:\frac{1}{n}\sum_{i=1}^nU'_i(x),
\end{align*}</span> where <span class="math display">
U'_i(x)=\frac{x}{\rho^2}+\frac{n}{\sigma^2}(x-y_i).
</span></p>
<p><i class="fa-solid fa-arrow-right" aria-label="arrow-right"></i> We only need one sample <span class="math inline">y_i</span> to evaluate <span class="math inline">U'_i</span>.</p>
</section>
<section id="randomized-rate-function" class="level3" data-number="3.9">
<h3 data-number="3.9" class="anchored" data-anchor-id="randomized-rate-function"><span class="header-section-number">3.9</span> Randomized Rate Function</h3>
<div class="small-letter">
<p>Instead of <span class="math display">
\lambda_{\textcolor{#78C2AD}{\text{ZZ}}}(x,\sigma)=\biggr(\sigma U'(x)\biggl)_+
</span> we use <span class="math display">
\lambda_{\textcolor{#E95420}{\text{ZZ-CV}}}(x,\sigma)=\biggr(\sigma U'_I(x)\biggl)_+,\qquad I\sim\mathrm{U}([n]).
</span> Then, the latter is an unbiased estimator of the former: <span class="math display">
\operatorname{E}_{I\sim\mathrm{U}([n])}\biggl[\lambda_{\textcolor{#E95420}{\text{ZZ-CV}}}(x,\sigma)\biggr]=\lambda_{\textcolor{#78C2AD}{\text{ZZ}}}(x,\sigma).
</span></p>
</div>
</section>
<section id="last-step-poisson-thinning" class="level3" data-number="3.10">
<h3 data-number="3.10" class="anchored" data-anchor-id="last-step-poisson-thinning"><span class="header-section-number">3.10</span> Last Step: <span class="color-blue">Poisson Thinning</span></h3>
<p>Find an <span class="color-blue">invertible upper bound <span class="math inline">M</span></span> that satisfies <span class="math display">
\int^t_0\lambda_{\textcolor{#E95420}{\text{ZZ-CV}}}(x_s,\sigma_s)\,ds=:m_I(t)\le\textcolor{#0096FF}{M}(t),\qquad I\sim\mathrm{U}([n]).
</span> It is harder to bound <span class="math inline">\lambda_{\textcolor{#E95420}{\text{ZZ-CV}}}</span>, since it is now an estimator (random function).</p>
</section>
<section id="upper-bound-m-with-control-variates" class="level3" data-number="3.11">
<h3 data-number="3.11" class="anchored" data-anchor-id="upper-bound-m-with-control-variates"><span class="header-section-number">3.11</span> <span class="color-blue">Upper Bound <span class="math inline">M</span></span> with <span class="color-unite">Control Variates</span></h3>
<div>

</div>
<div class="quarto-layout-panel" style="margin: 0px; !important" data-layout="[53,50]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 51.5%;justify-content: flex-start;">
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Preprocessing (once and for all)">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Preprocessing (once and for all)
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Find <span class="math display">
  x_*:=\operatorname*{argmin}_{x\in\mathbb{R}}U(x)
  </span></li>
<li>Compute <span class="math display">
  U'(x_*)=\frac{x_*}{\rho^2}+\frac{1}{\sigma^2}\sum_{i=1}^n(x_*-y_i).
  </span></li>
</ol>
</div>
</div>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 48.5%;justify-content: flex-start;">
<p>Then, with a re-parameterization of <span class="math inline">m_i</span>, <span class="math display">
m_i(t)\le M(t):=a+bt,
</span></p>
</div>
</div>
</div>
<p>where <span class="math display">
a=(\sigma U'(x_*))_++\|U'\|_\mathrm{Lip}\|x-x_*\|_p,\qquad b:=\|U'\|_\mathrm{Lip}.
</span> And <span class="math inline">m_i</span> is redefined as <span class="math display">
m_i(t)=U'(x_*)+U'_i(x)-U'_i(x_*).
</span></p>
</section>
<section id="subsampling-with-control-variates" class="level3" data-number="3.12">
<h3 data-number="3.12" class="anchored" data-anchor-id="subsampling-with-control-variates"><span class="header-section-number">3.12</span> Subsampling with Control Variates</h3>
<p>Zig-Zag sampler with the random rate function <span class="math display">
\lambda_{\textcolor{#E95420}{\text{ZZ-CV}}}(x,\sigma)=\biggr(\sigma U'_I(x)\biggl)_+,\qquad I\sim\mathrm{U}([n]).
</span> and the upper bound <span class="math display">
M(t)=a+bt
</span> is called <span class="color-unite">Zig-Zag with Control Variates</span> <span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens, Fearnhead, et al., 2019</a>)</span>.</p>
</section>
<section id="zig-zag-with-control-variates" class="level3" data-number="3.13">
<h3 data-number="3.13" class="anchored" data-anchor-id="zig-zag-with-control-variates"><span class="header-section-number">3.13</span> <span class="color-unite">Zig-Zag with Control Variates</span></h3>
<ol type="1">
<li>has <span class="math inline">O(1)</span> efficiency as the sample size <span class="math inline">n</span> grows.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></li>
<li>is exact (no bias).</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Files/MeanOfGaussian_addedMALA.svg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section>
<section id="scalability-13" class="level3" data-visibility="uncounted" data-number="3.14">
<h3 data-visibility="uncounted" data-number="3.14" class="anchored" data-anchor-id="scalability-13"><span class="header-section-number">3.14</span> Scalability (1/3)</h3>
<p>There are currently two main approaches to scaling up MCMC for large data.</p>
<ol type="1">
<li><p><u>Devide-and-conquer</u></p>
<p>Devide the data into smaller <strong>chunks</strong> and run MCMC on each <strong>chunk</strong>.</p></li>
<li><p><u>Subsampling</u></p>
<p>Use a subsampling estimate of the likelihood, which does not require the entire data.</p></li>
</ol>
</section>
<section id="scalability-23-by-devide-and-conquer" class="level3" data-visibility="uncounted" data-number="3.15">
<h3 data-visibility="uncounted" data-number="3.15" class="anchored" data-anchor-id="scalability-23-by-devide-and-conquer"><span class="header-section-number">3.15</span> Scalability (2/3) by Devide-and-conquer</h3>
<p>Devide the data into smaller chunks and run MCMC on each chunk.</p>
<div class="table-responsive-sm">
<table class="table-hover caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 48%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Unbiased?</th>
<th style="text-align: center;">Method</th>
<th style="text-align: center;">Reference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="color-blue"><i class="fa-solid fa-xmark" aria-label="xmark"></i></span></td>
<td style="text-align: center;">WASP</td>
<td style="text-align: center;"><span class="footnote-letter"><span class="citation" data-cites="Srivastava+2015">(<a href="#ref-Srivastava+2015" role="doc-biblioref">Srivastava et al., 2015</a>)</span></span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="color-blue"><i class="fa-solid fa-xmark" aria-label="xmark"></i></span></td>
<td style="text-align: center;">Consensus Monte Carlo</td>
<td style="text-align: center;"><span class="footnote-letter"><span class="citation" data-cites="Scott+2016">(<a href="#ref-Scott+2016" role="doc-biblioref">Scott et al., 2016</a>)</span></span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="color-red"><i class="fa-solid fa-check" aria-label="check"></i></span></td>
<td style="text-align: center;">Monte Carlo Fusion</td>
<td style="text-align: center;"><span class="footnote-letter"><span class="citation" data-cites="Dai+2019">(<a href="#ref-Dai+2019" role="doc-biblioref">Dai et al., 2019</a>)</span></span></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="scalability-33-by-subsampling" class="level3" data-visibility="uncounted" data-number="3.16">
<h3 data-visibility="uncounted" data-number="3.16" class="anchored" data-anchor-id="scalability-33-by-subsampling"><span class="header-section-number">3.16</span> Scalability (3/3) by Subsampling</h3>
<p>Use a subsampling estimate of the likelihood, which does not require the entire data.</p>
<div class="table-responsive-sm">
<table class="table-hover caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 48%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Unbiased?</th>
<th style="text-align: center;">Method</th>
<th style="text-align: center;">Reference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="color-blue"><i class="fa-solid fa-xmark" aria-label="xmark"></i></span></td>
<td style="text-align: center;">Stochastic Gadient MCMC</td>
<td style="text-align: center;"><span class="footnote-letter"><span class="citation" data-cites="Welling-Teh2011">(<a href="#ref-Welling-Teh2011" role="doc-biblioref">Welling and Teh, 2011</a>)</span></span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="color-red"><i class="fa-solid fa-check" aria-label="check"></i></span></td>
<td style="text-align: center;">Zig-Zag with Subsampling</td>
<td style="text-align: center;"><span class="footnote-letter"><span class="citation" data-cites="Bierkens+2019">(<a href="#ref-Bierkens+2019" role="doc-biblioref">Bierkens, Fearnhead, et al., 2019</a>)</span></span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="color-blue"><i class="fa-solid fa-xmark" aria-label="xmark"></i></span></td>
<td style="text-align: center;">Stochastic Gradient PDMP</td>
<td style="text-align: center;"><span class="footnote-letter"><span class="citation" data-cites="Fearnhead+2024">(<a href="#ref-Fearnhead+2024" role="doc-biblioref">Fearnhead et al., 2024</a>)</span></span></td>
</tr>
</tbody>
</table>
</div>
<!-- ## Appendix: Application to Imbalanced Logistic Regression {.unnumbered .unlisted visibility="uncounted"}

Scalability and state-of-the-art performance on high-dimensional models, with the example of logistic models. -->


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Mostly <span class="color-unite">deterministic</span> with the exception of random jumps happens at random times<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><span class="color-unite">Continuous-time</span>, instead of discrete-time processes<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>under fairly general conditions on <span class="math inline">p</span>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>The target here is the standard Cauchy distribution <span class="math inline">\mathrm{C}(0,1)</span>, equivalent to <span class="math inline">\mathrm{t}(1)</span> distribution. Its heavy tails hinder the convergence of MCMC.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Multidimensional extension is straightforward, but we won’t cover it today.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>With some regularity conditions on <span class="math inline">U</span>. <span class="citation" data-cites="Bierkens-Roberts-Zigg2019">(See <a href="#ref-Bierkens-Roberts-Zigg2019" role="doc-biblioref">Bierkens, Roberts, et al., 2019</a>)</span>.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>As long as the preprocessing step is properly done.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@unpublished{shiba_|_司馬博文2024,
  author = {Shiba \textbar{} 司馬博文, Hirofumi},
  title = {Zig-Zag {Sampler}},
  date = {2024-09-10},
  url = {https://162348.github.io/posts/2024/Slides/ZigZagPoliSci.html},
  langid = {en},
  abstract = {Zig-Zag sampler, known as an instance of “Continuous-time
    MCMC”, is a cutting-edge sampling method that exhibits scalability
    and state-of-the-art performance on high-dimensional models
    including logistic models etc. This talk includes a brief
    introduction to the Zig-Zag sampler and the two important
    properties, irreversibility of its dynamics and thinning of Poisson
    point processes, followed by a few numerical experiments on logistic
    models with large and unbalanced data.}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-shiba_|_司馬博文2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Shiba | 司馬博文, H. (2024, September). <em><a href="https://162348.github.io/posts/2024/Slides/ZigZagPoliSci.html">Zig-Zag
Sampler</a></em>. <em>Seoul National University, Gwanak (관악) campus,
South Korea</em>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/162348\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="162348/162348.github.io" data-repo-id="R_kgDOKlfKYQ" data-category="Announcements" data-category-id="DIC_kwDOKlfKYc4CgDmb" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" data-loading="lazy" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://162348.github.io/">
<p>Hirofumi Shiba</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/162348/162348.github.io/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ano2math5">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:shiba.hirofumi@ism.ac.jp">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../../blog.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>