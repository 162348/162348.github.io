<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Hirofumi Shiba</title>
<link>https://162348.github.io/blog.html</link>
<atom:link href="https://162348.github.io/blog.xml" rel="self" type="application/rss+xml"/>
<description>A Blog by a Bayesian Computation Researcher</description>
<image>
<url>https://162348.github.io/profile.jpg</url>
<title>Hirofumi Shiba</title>
<link>https://162348.github.io/blog.html</link>
</image>
<generator>quarto-1.4.549</generator>
<lastBuildDate>Fri, 28 Jun 2024 15:00:00 GMT</lastBuildDate>
<item>
  <title>分子動力学法</title>
  <dc:creator>司馬博文 </dc:creator>
  <link>https://162348.github.io/posts/2024/Nature/StatisticalMechanics3.html</link>
  <description><![CDATA[ 





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<section id="概観" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="概観"><span class="header-section-number">1</span> 概観</h2>
<section id="導入" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="導入"><span class="header-section-number">1.1</span> 導入</h3>
<p>分子動力学法 (MD: Molecular Dynamics simulation) は，系のミクロなダイナミクスを実験的に調べる代わりに，シミュレーションによって必要条件を絞り込んでいく構成的な・計算機集約的なアプローチである．</p>
<p>特に，多体系の運動方程式を計算機を用いて数値的に解くことを指す <span class="citation" data-cites="Alder-Wainwright1959">(Alder &amp; Wainwright, 1959)</span>．それ故，物理や化学はもちろん，生化学，物質科学，さらには工学分野にまで幅広く用いられるシミュレーション法になる．</p>
<blockquote class="blockquote">
<p>the inescapable conclusion is that MD will — if it hasn’t already — become an indispensable part of the theorist’s toolbox. <span class="citation" data-cites="Rapaport2004">(Rapaport, 2004, p. ix)</span></p>
</blockquote>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="計算科学の今後の展望">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
計算科学の今後の展望
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>従来は実験と理論が相補的な関係にあったが，まるで基盤モデルが強化学習のための効率的な世界モデルになるように，計算機シミュレーションと Monte Carlo 法が新時代の科学の第三の要素になるのかも知れない．</p>
<blockquote class="blockquote">
<p>“What distinguishes computer simulation in general from other forms of computation, if such a distinction can be made, is the manner in which the computer is used: instead of merely performing a calculation, the computer becomes the virtual laboratory in which a system is studied - a numerical experiment.” <span class="citation" data-cites="Rapaport2004">(Rapaport, 2004, p. 3)</span>．</p>
</blockquote>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Computation/AboutSimulation.html" target="_blank">
            <img src="https://162348.github.io/posts/2024/Computation/Files/computation.png" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">計算とは何か</h3>
                <p class="article-description">数値実験と LLM とはいずれもシミュレーションに使えるが，用いる形式が違う（数字と文字）．これにより，物理的な用途と社会的な用途とに別れている．この形式の違いを超克するのが機械学習の悲願であるとするならば，計算とはなんだろうか？ Monte Carlo 法とはシミュレーションと計算を架橋する存在であるならば，今後どのような貢献ができるのであろうか？</p>
            </div>
        </a>
    </div>
</div>
</div>
</div>
</div>
</section>
<section id="歴史" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="歴史"><span class="header-section-number">1.2</span> 歴史</h3>
<p>アイデア自体は当然極めてナイーブであり，Laplace の悪魔や気体分子運動論の時代から大変に意識されたが，その最初の非自明な適用はデジタルコンピュータ完成のあとであった <span class="citation" data-cites="Alder-Wainwright1958">(Alder &amp; Wainwright, 1958)</span>, <span class="citation" data-cites="Alder-Wainwright1959">(Alder &amp; Wainwright, 1959)</span>．</p>
<p>彼らの関心は，ポロニウムなどの剛体球 (hard-sphere) の系とみれる物質の温度に依存した相転移現象にあった <span class="citation" data-cites="Alder-Wainwright1957">(Alder &amp; Wainwright, 1957)</span>．</p>
<p><span class="citation" data-cites="Alder-Wainwright1959">(Alder &amp; Wainwright, 1959)</span> では一般の撃力相互作用 (impulsive interaction) に拡張され，event-driven アプローチ (ED-MD scheme) が取られた．<sup>1</sup></p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="種々の MD 法">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
種々の MD 法
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>その他に，粒子に内部構造がない場合は time-driven な Newton 力学のシミュレーションで良いかもしれないが，剛体で体積を持つ場合は Euler 方程式，内部構造を持つ場合は Langrange 方程式のシミュレーションも伴うかもしれない <span class="citation" data-cites="Rapaport2004">(Rapaport, 2004, p. 4)</span>．</p>
<p>通常の平衡状態の（エネルギー・体積・粒子数一定の）分子系は小正準集団に対応するが，特定の温度条件下での物性を考えたい場合は，運動方程式を修正してシミュレーションする方法もある．この方法の欠点は，物性を再現できても，個々の分子の軌道を正しく模倣しているわけではないという点であるが，そもそもそのカオス的な振る舞いから，正しい軌道を得ることは諦めることが多い．このこともあり，MD 法で用いられる数値積分法は比較的低次元で軽量なものでも十分なのである <span class="citation" data-cites="Rapaport2004">(Rapaport, 2004, p. 4)</span>．<sup>2</sup></p>
<p>セルオートマトンや格子ボルツマン法などの格子ベースの手法の方が計算量は安価であるが，表現力に劣ることになる．</p>
<p>Lanvegin 方程式に基づいた Brownian dynamics などのさらに連続時間ベースの手法もある．</p>
</div>
</div>
</div>
</section>
<section id="タイムステップの問題" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="タイムステップの問題"><span class="header-section-number">1.3</span> タイムステップの問題</h3>
<p>ここで，optimal scaling と並行な，<strong>タイムステップ選択の問題</strong> がやはり中核となることが確認された．</p>
<blockquote class="blockquote">
<p>how to choose a good step size has always been an art in the field. <span class="citation" data-cites="Liu2004">(Liu, 2004, p. 183)</span></p>
</blockquote>
<p>タイムステップが系の特徴的な事象をよく捉えるように注意して取る必要がある．特に，系のハミルトニアンが変化しすぎないように離散化誤差を抑える必要がある <span class="citation" data-cites="Liu2004">(Liu, 2004, p. 184)</span>．</p>
<p>特に，凝縮系において系を放置し過ぎると，すぐにハミルトニアンが保存されなくなってしまうため，MD を用いた Monte Carlo 法では極めてタイムステップを細かくすることが必須であることが一番の問題である．</p>
<blockquote class="blockquote">
<p>a main problem with MD simulation is the stringent requirement of a small time-step size. <span class="citation" data-cites="Liu2004">(Liu, 2004, p. 189)</span><sup>3</sup></p>
</blockquote>
<p>かといって，MD から遊離した MCMC を実行して性能を上げるためには，何かしらの形で遷移核に分布の形状を通知したいところであるが，これは MD 法なしには難しいということになる．<sup>4</sup></p>
<p>明らかに分布が特殊な形状をしているのに，ランダムウォークがその方向を見つけるまで待つのでは効率が悪い．</p>
</section>
<section id="sec-effectiveness-of-potentials" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="sec-effectiveness-of-potentials"><span class="header-section-number">1.4</span> ポテンシャルの役割</h3>
<section id="モデル選択の見方" class="level4" data-number="1.4.1">
<h4 data-number="1.4.1" class="anchored" data-anchor-id="モデル選択の見方"><span class="header-section-number">1.4.1</span> モデル選択の見方</h4>
<p>例え量子系のシミュレーションであろうとも，Born-Oppenheimer などの近似を重ねて，原子に働く有効ポテンシャルにのみ注目することにより，古典系のシミュレーションと同様の方法で実行することができ，多くのマクロ的な性質を再現することが出来ることが，<span class="citation" data-cites="Griebel+2007">(Griebel et al., 2007, p. 17)</span> に詳細に説明されている．</p>
<p>実際の系での粒子間相互作用を決定する際，純粋に Schrödinger 方程式などから理論的に導出するだけでなく，解析的に記述されたポテンシャルをフィッティングしてみてそれが理論や実験に合致するかどうかを見る統計的な方法もとられる <span class="citation" data-cites="Griebel+2007">(Griebel et al., 2007, p. 27)</span>．</p>
<p>このようなモデル選択の立場に立つのが良い <span class="citation" data-cites="戸田+2011">(戸田盛和 et al., 2011, p. 34)</span>．</p>
</section>
<section id="ポテンシャルの推定" class="level4" data-number="1.4.2">
<h4 data-number="1.4.2" class="anchored" data-anchor-id="ポテンシャルの推定"><span class="header-section-number">1.4.2</span> ポテンシャルの推定</h4>
<p>多くの場合ポテンシャルは，粒子間距離や角度，座標などの変数が入っており，これらのパラメータを推定することで探されるが，当然このステップは難しいものである：</p>
<blockquote class="blockquote">
<p>The construction of good potentials is still a form of art and requires much skill, work, and intuition. <span class="citation" data-cites="Griebel+2007">(Griebel et al., 2007, p. 28)</span></p>
</blockquote>
<p>Morse ポテンシャルや Lennard-Jones ポテンシャルがその代表例である．いわば，これらのポテンシャルも模型なのである．半導体のモデリングなどでは，さらに複雑なポテンシャルが必要になる <span class="citation" data-cites="Griebel+2007">(Griebel et al., 2007, p. 30)</span>．</p>
<p>このように，多体問題をポテンシャル関数によって解く手法は 1980 年代からである <span class="citation" data-cites="Griebel+2007">(Griebel et al., 2007, p. 30)</span>．</p>
<blockquote class="blockquote">
<p>ポテンシャル関数の形によって、適した数値計算アルゴリズムが異なる。特に、長距離力の高速計算のためには、ポテンシャルの性質を巧みに利用したアルゴリズムが必要である。</p>
</blockquote>
</section>
<section id="システム同定としての物理学" class="level4" data-number="1.4.3">
<h4 data-number="1.4.3" class="anchored" data-anchor-id="システム同定としての物理学"><span class="header-section-number">1.4.3</span> システム同定としての物理学</h4>
<blockquote class="blockquote">
<p>What do we mean by “understanding” something? We can imagine that this complicated array of moving things which constitutes “the world” is something like a great chess game being played by the gods, and we are observers of the game. <span class="citation" data-cites="Fenyman+1963">(Feynman et al., 1964)</span></p>
</blockquote>
<blockquote class="blockquote">
<p>今まで見てきたように，状態空間モデルは運動学習過程を統一的に説明するモデルであり，最適推定や最適制御の定式化に欠かせない．一方，状態空間モデルに含まれる行列の値は，運動方程式などといった物理的要請から決定できることもあるが，運動適応の学習係数などは未知のパラメータであることが多い．従って，与えられた実験データから状態空間モデルのパラメタを決定する必要がある．このパラメタ推定は制御理論において <strong>システム同定</strong> と呼ばれる．冒頭の引用のように，ファインマンは数学や物理を自然界のシステム同定とみなした．<span class="citation" data-cites="田中宏和2019">(田中宏和, 2019, p. 173)</span></p>
</blockquote>
</section>
</section>
</section>
<section id="分子動力学法" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="分子動力学法"><span class="header-section-number">2</span> 分子動力学法</h2>
<section id="sec-MD-for-hard-disk" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="sec-MD-for-hard-disk"><span class="header-section-number">2.1</span> 剛体円板のシミュレーション</h3>
<p>剛体円板のシミュレーションは，衝突イベントを先に予測し，その間を線型に補間すれば良いから，典型的には <strong>event-driven</strong> で行われる．</p>
<section id="アルゴリズムの概略" class="level4" data-number="2.1.1">
<h4 data-number="2.1.1" class="anchored" data-anchor-id="アルゴリズムの概略"><span class="header-section-number">2.1.1</span> アルゴリズムの概略</h4>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li>初期位置と初期速度 <img src="https://latex.codecogs.com/png.latex?%5C%7Bv_i%5C%7D_%7Bi=1%7D%5EN%5Csubset%5Cmathbb%7BR%7D%5E2"> をランダムに定める．</li>
<li>次のように系を発展させていく： <span id="eq-evolution1"><img src="https://latex.codecogs.com/png.latex?%0Ax_i(t)%5Cgets%20x_i(t_0)+(t-t_0)v_i(t),%0A%5Ctag%7B1%7D"></span> <img src="https://latex.codecogs.com/png.latex?%0Av_i(t)%5Cgets%20v_i(t_0).%0A"></li>
<li>衝突イベントの発生時刻 <img src="https://latex.codecogs.com/png.latex?t%5E*"> は次の方程式によって予測できる： <img src="https://latex.codecogs.com/png.latex?%0A%20%20d(x_i(t%5E*),x_j(t%5E*))=2%5Csigma.%0A%20%20"> 衝突が起こると，衝突の角度に応じて，速度を反転させる： <img src="https://latex.codecogs.com/png.latex?%0A%20%20v_i(t%5E*)%5Cgets%20v_i(t_0)-%5Cleft(%5Cfrac%7Bv_%7Bij%7D(t_0)%5E%5Ctop%20x_%7Bij%7D(t%5E*)%7D%7B4%5Csigma%5E2%7D%5Cright)x_%7Bij%7D(t%5E*).%0A%20%20"></li>
</ul>
</div>
</div>
</div>
</section>
<section id="数値誤差の蓄積" class="level4" data-number="2.1.2">
<h4 data-number="2.1.2" class="anchored" data-anchor-id="数値誤差の蓄積"><span class="header-section-number">2.1.2</span> 数値誤差の蓄積</h4>
<p>式 (1) が正確な時間発展を記述できている以上，誤差は衝突イベントの処理の際の数値誤差にのみ起因する．</p>
<p>しかし，角度計算の小さな誤差は，大きな軌道の違いを生むため，この数値誤差の蓄積が典型的に起こる．<sup>5</sup></p>
</section>
<section id="アルゴリズムのエルゴード性" class="level4" data-number="2.1.3">
<h4 data-number="2.1.3" class="anchored" data-anchor-id="アルゴリズムのエルゴード性"><span class="header-section-number">2.1.3</span> アルゴリズムのエルゴード性</h4>
<p><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BT%7D%5E2"> 上の剛体円板ダイナミクスのエルゴード性（Bernoulli 撹拌性）は <span class="citation" data-cites="Simanyi2003">(Simányi, 2003)</span> によって示された．</p>
<p>特にエルゴード理論の観点からは，ビリヤード問題とも呼ばれる <span class="citation" data-cites="Tabachnikov2005">(Tabachnikov, 2005)</span>．</p>
</section>
</section>
<section id="滑らかなポテンシャルを持つ小正準集団のシミュレーション" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="滑らかなポテンシャルを持つ小正準集団のシミュレーション"><span class="header-section-number">2.2</span> 滑らかなポテンシャルを持つ小正準集団のシミュレーション</h3>
<p>剛体円板のポテンシャルは単関数であった．より現実的な系は，滑らかなポテンシャルによって記述される．</p>
<section id="力学" class="level4" data-number="2.2.1">
<h4 data-number="2.2.1" class="anchored" data-anchor-id="力学"><span class="header-section-number">2.2.1</span> 力学</h4>
<p>ポテンシャル <img src="https://latex.codecogs.com/png.latex?U"> に対して，Newton の運動方程式は <img src="https://latex.codecogs.com/png.latex?%0Am_t%5Cfrac%7Bd%20%5E2x_i%7D%7Bd%20t%5E2%7D=-D_iU(x)%0A"> で表される．</p>
<p>これを一階系 <img src="https://latex.codecogs.com/png.latex?%0A%5Cdot%7Bx%7D_i=v_i%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Cdot%7Bv%7D_i=-%5Cfrac%7BD_iU(x)%7D%7Bm_i%7D%0A"> にすることで，数値的に可解になる．</p>
<p>この系，または Hamiltonian 系の数値計算法については，<span class="citation" data-cites="Bou-Rabee_Sanz-Serna2018">(Bou-Rabee &amp; Sanz-Serna, 2018)</span> などのレビューも参照．</p>
</section>
<section id="速度に関する-verlet1967-法" class="level4" data-number="2.2.2">
<h4 data-number="2.2.2" class="anchored" data-anchor-id="速度に関する-verlet1967-法"><span class="header-section-number">2.2.2</span> 速度に関する <span class="citation" data-cites="Verlet1967">(Verlet, 1967)</span> 法</h4>
<p>Hamiltonian 系の数値解法において，最も一般的なアルゴリズムは次のようなものである：</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>ステップサイズ <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%3E0"> を設定しておく．</p>
<ol type="1">
<li>運動量を半分だけ進める： <img src="https://latex.codecogs.com/png.latex?%0Ap_i%5Cleft(%5Cfrac%7B%5Cepsilon%7D%7B2%7D%5Cright)%5Cgets%20p_i(0)+%5Cfrac%7B%5Cepsilon%7D%7B2%7DF_i(x(0)).%0A"></li>
<li>次のように位置と運動量を更新する： <img src="https://latex.codecogs.com/png.latex?%0Ax_i(n%5Cepsilon)%5Cgets%20x_i((n-1)%5Cepsilon)+%5Cepsilon%20p_i%5Cbiggr(%5Cfrac%7B(n-1/2)%5Cepsilon%7D%7Bm_i%7D%5Cbiggl),%0A"> <img src="https://latex.codecogs.com/png.latex?%0Ap_i%5Cbiggr((n+1/2)%5Cepsilon%5Cbiggl)%5Cgets%20p_i%5Cbiggr((n-1/2)%5Cepsilon%5Cbiggl)+%5Cepsilon%20F_i(x(n%5Cepsilon)).%0A"></li>
<li>残りの運動量を進める．</li>
</ol>
</div>
</div>
</div>
<p>２のダイナミクスは <strong>leapfrog dynamics</strong> とも呼ばれる．</p>
<p>運動量の更新を <strong>kick</strong>，位置の更新を <strong>drift</strong> と呼ぶこともある．</p>
<p>この手法は，イテレーション毎に <img src="https://latex.codecogs.com/png.latex?F"> の評価が１回で済むこと，<img src="https://latex.codecogs.com/png.latex?O(%5Cepsilon%5E2)"> 誤差の性能が知られている．<sup>6</sup></p>
<p>この手法は <span class="citation" data-cites="Stormer1907">(Störmer, 1907)</span> もすでに用いていたもので，Störmer-Verlet integration とも呼ばれる．</p>
</section>
<section id="小正準分布のシミュレーション" class="level4" data-number="2.2.3">
<h4 data-number="2.2.3" class="anchored" data-anchor-id="小正準分布のシミュレーション"><span class="header-section-number">2.2.3</span> 小正準分布のシミュレーション</h4>
<p>上述のダイナミクスは，Hamiltonian の等位集合上のみを探索するという意味で，小正準集団のシミュレーションのみが可能である．</p>
<p>すなわち，Boltzmann-Gibbs 分布のシミュレーションが可能でない．<img src="https://latex.codecogs.com/png.latex?%5Cleft%5C%7BU%5Cle%20H_0%5Cright%5C%7D"> 上しか探索できないためである．</p>
<p>単に剛体円板（第 2.1 節）においては <img src="https://latex.codecogs.com/png.latex?U"> が単関数であったために，任意の <img src="https://latex.codecogs.com/png.latex?H_0"> に対して集合 <img src="https://latex.codecogs.com/png.latex?%5Cleft%5C%7BU%5Cle%20H_0%5Cright%5C%7D"> が変わらなかったため，問題が起こらなかったのである．</p>
</section>
</section>
<section id="滑らかなポテンシャルを持つ正準集団のシミュレーション" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="滑らかなポテンシャルを持つ正準集団のシミュレーション"><span class="header-section-number">2.3</span> 滑らかなポテンシャルを持つ正準集団のシミュレーション</h3>
<section id="langevin-動力学" class="level4" data-number="2.3.1">
<h4 data-number="2.3.1" class="anchored" data-anchor-id="langevin-動力学"><span class="header-section-number">2.3.1</span> Langevin 動力学</h4>
<p>従って，系が外界とエネルギーを交換するような系（正準集団）を考えたい場合は，単に Hamilton 方程式を数値的に解くだけでは不十分である．</p>
<p>そこで，Hamilton 方程式の運動量の項に，<img src="https://latex.codecogs.com/png.latex?%5Cbeta"> に依存した係数を持つランダムな項を加えて得る (underdamped) Langevin 動力学を考えることができる：<sup>7</sup> <img src="https://latex.codecogs.com/png.latex?%0Adx_i=m_i%5E%7B-1%7Dp_idt,%0A"> <img src="https://latex.codecogs.com/png.latex?%0Adp_i=-%5Cnabla%20U(x)dt-%5Cgamma%20m_i%5E%7B-1%7D%20p_idt+%5Csqrt%7B2%5Cgamma%5Cbeta%5E%7B-1%7D%7DdB_i.%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cgamma"> は粘性係数，<img src="https://latex.codecogs.com/png.latex?%5Cbeta"> は逆温度である．</p>
</section>
<section id="シミュレーション法" class="level4" data-number="2.3.2">
<h4 data-number="2.3.2" class="anchored" data-anchor-id="シミュレーション法"><span class="header-section-number">2.3.2</span> シミュレーション法</h4>
<p>次のようにして underdamped Langevin 動力学を数値的に解くことができる：<sup>8</sup></p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><img src="https://latex.codecogs.com/png.latex?%5Cepsilon%3E0"> をタイムステップとする．</p>
<ol type="1">
<li>確率項を消去した Hamilton 系をシミュレーションし，<img src="https://latex.codecogs.com/png.latex?%5Cepsilon%3E0"> だけ進める．</li>
<li>残る Ornstein-Uhlenbeck 過程 <img src="https://latex.codecogs.com/png.latex?%0Adp_i=-%5Cgamma%20m_i%5E%7B-1%7D%20p_idt+%5Csqrt%7B2%5Cgamma%5Cbeta%5E%7B-1%7D%7DdB_i%0A"> を解き，<img src="https://latex.codecogs.com/png.latex?%5Cepsilon%3E0"> だけ進める．</li>
</ol>
<p>以上を繰り返す．</p>
</div>
</div>
</div>
</section>
<section id="エルゴード性" class="level4" data-number="2.3.3">
<h4 data-number="2.3.3" class="anchored" data-anchor-id="エルゴード性"><span class="header-section-number">2.3.3</span> エルゴード性</h4>
<p>カップリングアプローチによるエルゴード性証明は <span class="citation" data-cites="Eberle+2019">(Eberle et al., 2019)</span> により初めて行われた．</p>
</section>
<section id="過減衰-langevin-法" class="level4" data-number="2.3.4">
<h4 data-number="2.3.4" class="anchored" data-anchor-id="過減衰-langevin-法"><span class="header-section-number">2.3.4</span> 過減衰 Langevin 法</h4>
<p>過減衰極限 <img src="https://latex.codecogs.com/png.latex?%5Cgamma%5Cto%5Cinfty"> を取ることで，１本の方程式にまとまる：<sup>9</sup> <img src="https://latex.codecogs.com/png.latex?%0Ady_i=-%5Cnabla%20U(y)dt+%5Csqrt%7B2%5Cbeta%5E%7B-1%7D%7DdB_i,%0A"> <img src="https://latex.codecogs.com/png.latex?%0Ay(t):=x(%5Cgamma%20t).%0A"></p>
<p>これを <strong>過減衰 Langevin 動力学</strong> または対称 Langevin 拡散という．統計力学では <strong>Brownian 動力学</strong> とも呼ばれる <span class="citation" data-cites="Rossky+1978">(Rossky et al., 1978)</span>．</p>
<p>これに対して，元の underdamped Langevin 拡散は，力学的 Langevin 動力学 (kinetic Langevin dynamics), ２階の Langevin 過程などとも呼ばれる．<sup>10</sup></p>
</section>
<section id="langevin-力学によるサンプリング" class="level4" data-number="2.3.5">
<h4 data-number="2.3.5" class="anchored" data-anchor-id="langevin-力学によるサンプリング"><span class="header-section-number">2.3.5</span> Langevin 力学によるサンプリング</h4>
<p>統計学と機械学習では，特に <span class="citation" data-cites="Roberts-Tweedie1996">(Roberts &amp; Tweedie, 1996)</span> 以来，上述の過減衰 Langevin 動力学の方がポピュラーである．</p>
<p>しかし，underdamped Langevin 動力学を用いた方が，サンプリング法の収束が速くなることが知られている <span class="citation" data-cites="Dalalyan-Riou-Durand2020">(Dalalyan &amp; Riou-Durand, 2020)</span>．</p>
</section>
</section>
</section>
<section id="hybrid-monte-carlo" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="hybrid-monte-carlo"><span class="header-section-number">3</span> Hybrid Monte Carlo</h2>
<section id="導入-1" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="導入-1"><span class="header-section-number">3.1</span> 導入</h3>
<p>MD 法はサンプリングに向いているわけではない．また，Monte Carlo 法も，提案核の設計によって効率は大きく変わる．</p>
<p>そこで，MD 法のように Hamiltonian からの知識を提案核に取り入れた Monte Carlo 法が HMC (hybrid Monte Carlo) <span class="citation" data-cites="Duane+1987">(Duane et al., 1987)</span> として提案された．<sup>11</sup></p>
<p>これは混合モンテカルロ法ともいう：</p>
<blockquote class="blockquote">
<p><strong>混合モンテカルロ／分子動力学法</strong>：モンテカルロ法を用いた構造分布の生成において，試行に用いる構造をニュートンの運動方程式など決定論的手法に従って用意する手法．分子凝集系などの複雑な系に対して，効率的に構造空間探索を行えると期待される．<span class="citation" data-cites="用語解説2022">(栗﨑 &amp; 田中, 2022)</span></p>
</blockquote>
</section>
<section id="hamiltonian-monte-carlo" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="hamiltonian-monte-carlo"><span class="header-section-number">3.2</span> Hamiltonian Monte Carlo</h3>
<p>後に，統計力学的な背景を持たないサンプリング問題についても，Hamilton 系から示唆された提案分布を用いる方が MCMC として性能が良いことが発見され，<span class="citation" data-cites="Neal1993">(Neal, 1993)</span> 以降機械学習でも広く用いられるようになった．</p>
<p>今日ではこれらの手法は HMC (Hamiltonian Monte Carlo) 法 <span class="citation" data-cites="Neal2011-HMC">(Neal, 2011)</span> として機械学習・統計学界隈に普及しており，双方の分野からアルゴリズム改善のアイデアが盛んに生まれている．<sup>12</sup></p>
</section>
<section id="md-に提案をもらう-monte-carlo-法" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="md-に提案をもらう-monte-carlo-法"><span class="header-section-number">3.3</span> MD に提案をもらう Monte Carlo 法</h3>
<p>提案は MD によって示唆されたものの方が効率が良くなる場合がある：</p>
<blockquote class="blockquote">
<p>The advantage of the MD proposal is that the resulting MCMC moves follow the dynamics of the target distribution more closely. <span class="citation" data-cites="Liu2004">(Liu, 2004, p. 184)</span></p>
</blockquote>
<p>これは結局，背後の物理学的な本質を捉えているためとも言える：</p>
<blockquote class="blockquote">
<p>A major advantage of molecular dynamics simulation in physical systems is its reliance on basic physics principles (e.g.&nbsp;Newton’s equation), which has been shown by nature to work well. <span class="citation" data-cites="Liu2004">(Liu, 2004, p. 189)</span></p>
</blockquote>



</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-Alder-Wainwright1957" class="csl-entry">
Alder, B. J., &amp; Wainwright, T. E. (1957). <span class="nocase">Phase Transition for a Hard Sphere System</span>. <em>The Journal of Chemical Physics</em>, <em>27</em>(5), 1208–1209. <a href="https://doi.org/10.1063/1.1743957">https://doi.org/10.1063/1.1743957</a>
</div>
<div id="ref-Alder-Wainwright1958" class="csl-entry">
Alder, B. J., &amp; Wainwright, T. E. (1958). <a href="">Molecular dynamics by electronic computers</a>. In I. Prigogine (Ed.), <em>Proceedings of the international symposium on transport processes in statistical mechanics. Held in brussels, august 27-31, 1956</em> (p. 97).
</div>
<div id="ref-Alder-Wainwright1959" class="csl-entry">
Alder, B. J., &amp; Wainwright, T. E. (1959). <span class="nocase">Studies in Molecular Dynamics. I. General Method</span>. <em>The Journal of Chemical Physics</em>, <em>31</em>(2), 459–466. <a href="https://doi.org/10.1063/1.1730376">https://doi.org/10.1063/1.1730376</a>
</div>
<div id="ref-Bou-Rabee_Sanz-Serna2018" class="csl-entry">
Bou-Rabee, N., &amp; Sanz-Serna, J. M. (2018). Geometric integrators and the hamiltonian monte carlo method. <em>Acta Numerica</em>, <em>27</em>, 113–206. <a href="https://doi.org/10.1017/S0962492917000101">https://doi.org/10.1017/S0962492917000101</a>
</div>
<div id="ref-Bressloff-StochasticProcessInCellBiology1" class="csl-entry">
Bressloff, P. C. (2021). <em>Stochastic processes in cell biology</em> (2nd ed., Vol. 41). Springer Cham. https://doi.org/<a href="https://doi.org/10.1007/978-3-030-72519-8">https://doi.org/10.1007/978-3-030-72519-8</a>
</div>
<div id="ref-Dalalyan-Riou-Durand2020" class="csl-entry">
Dalalyan, A. S., &amp; Riou-Durand, L. (2020). <span class="nocase">On sampling from a log-concave density using kinetic Langevin diffusions</span>. <em>Bernoulli</em>, <em>26</em>(3), 1956–1988. <a href="https://doi.org/10.3150/19-BEJ1178">https://doi.org/10.3150/19-BEJ1178</a>
</div>
<div id="ref-Duane+1987" class="csl-entry">
Duane, S., Kennedy, A. D., Pendleton, B. J., &amp; Roweth, D. (1987). Hybrid monte carlo. <em>Physics Letters B</em>, <em>195</em>(2), 216–222. <a href="https://doi.org/10.1016/0370-2693(87)91197-X">https://doi.org/10.1016/0370-2693(87)91197-X</a>
</div>
<div id="ref-Eberle+2019" class="csl-entry">
Eberle, A., Guillin, A., &amp; Zimmer, R. (2019). <span class="nocase">Couplings and quantitative contraction rates for Langevin dynamics</span>. <em>The Annals of Probability</em>, <em>47</em>(4), 1982–2010. <a href="https://doi.org/10.1214/18-AOP1299">https://doi.org/10.1214/18-AOP1299</a>
</div>
<div id="ref-Faulkner-Livingstone2024" class="csl-entry">
Faulkner, M. F., &amp; Livingstone, S. (2024). <span class="nocase">Sampling Algorithms in Statistical Physics: A Guide for Statistics and Machine Learning</span>. <em>Statistical Science</em>, <em>39</em>(1), 137–164. <a href="https://doi.org/10.1214/23-STS893">https://doi.org/10.1214/23-STS893</a>
</div>
<div id="ref-Fenyman+1963" class="csl-entry">
Feynman, R. P., Leighton, R. B., &amp; Sands, M. (1964). <em>The feynman lectures of physics: Vol. I</em>. Addison-Wesley. <a href="https://www.feynmanlectures.caltech.edu/I_01.html">https://www.feynmanlectures.caltech.edu/I_01.html</a>
</div>
<div id="ref-Griebel+2007" class="csl-entry">
Griebel, M., Zumbusch, G., &amp; Knapek, S. (2007). <em>Numerical simulation in molecular dynamics: Numerics, algorithms, parallelization, applications</em> (Vol. 5). Springer Belin, Heidelberg. <a href="https://link.springer.com/book/10.1007/978-3-540-68095-6">https://link.springer.com/book/10.1007/978-3-540-68095-6</a>
</div>
<div id="ref-Leimkuhler-Matthews2015" class="csl-entry">
Leimkuhler, B., &amp; Matthews, C. (2015). <em>Molecular dynamics: With deterministic and stochastic numerical methods</em>. Springer Cham. <a href="https://doi.org/10.1007/978-3-319-16375-8">https://doi.org/10.1007/978-3-319-16375-8</a>
</div>
<div id="ref-Leimkuhler-Reich2005" class="csl-entry">
Leimkuhler, B., &amp; Reich, S. (2005). <em>Simulating hamiltonian dynamics</em>. Cambridge University Press.
</div>
<div id="ref-Liu2004" class="csl-entry">
Liu, J. S. (2004). <em>Monte carlo strategies in scientific computing</em>. Springer New York. <a href="https://doi.org/10.1007/978-0-387-76371-2">https://doi.org/10.1007/978-0-387-76371-2</a>
</div>
<div id="ref-Neal1993" class="csl-entry">
Neal, R. M. (1993). <em><span class="nocase">Probabilistic Inference using Markov Chain Monte Carlo Methods</span></em>. Department of Computer Science, University of Toronto. <a href="https://glizen.com/radfordneal/review.abstract.html">https://glizen.com/radfordneal/review.abstract.html</a>
</div>
<div id="ref-Neal2011-HMC" class="csl-entry">
Neal, R. M. (2011). (S. Brooks, A. Gelman, G. Jones, &amp; X.-L. Meng, Eds.; pp. 113–162). Chapman; Hall/CRC. <a href="https://www.taylorfrancis.com/chapters/edit/10.1201/b10905-6/mcmc-using-hamiltonian-dynamics-radford-neal">https://www.taylorfrancis.com/chapters/edit/10.1201/b10905-6/mcmc-using-hamiltonian-dynamics-radford-neal</a>
</div>
<div id="ref-Pavliotis2014" class="csl-entry">
Pavliotis, G. A. (2014). <em>Stochastic processes and applications: Diffusion processes, the fokker-planck and langevin equations</em> (Vol. 60). Springer New York. <a href="https://link.springer.com/book/10.1007/978-1-4939-1323-7">https://link.springer.com/book/10.1007/978-1-4939-1323-7</a>
</div>
<div id="ref-Peters-deWith2012" class="csl-entry">
Peters, E. A. J. F., &amp; de&nbsp;With, G. (2012). Rejection-free monte carlo sampling for general potentials. <em>Physical Review E</em>, <em>85</em>(2). <a href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.85.026703">https://journals.aps.org/pre/abstract/10.1103/PhysRevE.85.026703</a>
</div>
<div id="ref-Rapaport2004" class="csl-entry">
Rapaport, D. C. (2004). <em>The art of molecular dynamics simulation</em> (2nd ed.). Cambridge University Press. <a href="https://doi.org/10.1017/CBO9780511816581">https://doi.org/10.1017/CBO9780511816581</a>
</div>
<div id="ref-Roberts-Tweedie1996" class="csl-entry">
Roberts, G. O., &amp; Tweedie, R. L. (1996). Exponential convergence of langevin distributions and their discrete approximations. <em>Bernoulli</em>, <em>2</em>(4), 341–363. <a href="https://www.jstor.org/stable/3318418">https://www.jstor.org/stable/3318418</a>
</div>
<div id="ref-Rossky+1978" class="csl-entry">
Rossky, P. J., Doll, J. D., &amp; Friedman, H. L. (1978). <span class="nocase">Brownian dynamics as smart Monte Carlo simulation</span>. <em>The Journal of Chemical Physics</em>, <em>69</em>(10), 4628–4633. <a href="https://doi.org/10.1063/1.436415">https://doi.org/10.1063/1.436415</a>
</div>
<div id="ref-Simanyi2003" class="csl-entry">
Simányi, N. (2003). Proof of the boltzmann-sinai ergodic hypothesis for typical hard disk systems. <em>Inventiones Mathematicae</em>, <em>154</em>(1), 123–178. <a href="https://doi.org/10.1007/s00222-003-0304-9">https://doi.org/10.1007/s00222-003-0304-9</a>
</div>
<div id="ref-Stoltz2021" class="csl-entry">
Stoltz, G. (2021). <em>Computational statistical physics and hypocoercivity</em>. <a href="https://arxiv.org/abs/2112.08221">https://arxiv.org/abs/2112.08221</a>
</div>
<div id="ref-Stormer1907" class="csl-entry">
Störmer, C. (1907). Sur les trajectoires des corpuscules électrisés dans l’espace. Applications à l’aurore boréale et aux perturbations magnétiques. <em>Radium (Paris)</em>, <em>4</em>(1), 2–5. <a href="https://doi.org/10.1051/ra-dium:01907004010201">https://doi.org/10.1051/ra-dium:01907004010201</a>
</div>
<div id="ref-Tabachnikov2005" class="csl-entry">
Tabachnikov, S. (2005). <em>Geometry and billiards</em> (Vol. 30). American Mathematical Society. <a href="https://bookstore.ams.org/view?ProductCode=STML/30">https://bookstore.ams.org/view?ProductCode=STML/30</a>
</div>
<div id="ref-Verlet1967" class="csl-entry">
Verlet, L. (1967). Computer "experiments" on classical fluids. I. Thermodynamical properties of lennard-jones molecules. <em>Phys. Rev.</em>, <em>159</em>, 98–103. <a href="https://doi.org/10.1103/PhysRev.159.98">https://doi.org/10.1103/PhysRev.159.98</a>
</div>
<div id="ref-戸田+2011" class="csl-entry">
戸田盛和, 斎藤信彦, 久保亮五, &amp; 橋爪夏樹. (2011). <em>統計物理学</em> (新装版, Vol. 5). 岩波書店. <a href="https://www.iwanami.co.jp/book/b259545.html">https://www.iwanami.co.jp/book/b259545.html</a>
</div>
<div id="ref-用語解説2022" class="csl-entry">
栗﨑, &amp; 田中. (2022). 用語解説. <em>生物物理</em>, <em>62</em>(4), 250–250. <a href="https://doi.org/10.2142/biophys.62.250">https://doi.org/10.2142/biophys.62.250</a>
</div>
<div id="ref-田中宏和2019" class="csl-entry">
田中宏和. (2019). <em>計算論的神経科学：脳の運動制御・感覚処理機構の理論的理解へ</em>. 森北出版. <a href="https://www.morikita.co.jp/books/mid/085161">https://www.morikita.co.jp/books/mid/085161</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>とは <span class="citation" data-cites="Peters-deWith2012">(Peters &amp; de&nbsp;With, 2012)</span> でも言及されている．当時の計算機では，500個の粒子を扱うことが限界であったことが興味深い．↩︎</p></li>
<li id="fn2"><p>内部構造がある分子をシミュレーションする場合はよりやわらかい相互作用を考える必要があり，その際は積分は高次元になる上に，内部の運動が高速であるためにタイムステップも細かくする必要が出てくる．さらに拘束条件が存在する場合は，積分法よりも高い精度で取り扱う必要があり，特別な注意を要する．↩︎</p></li>
<li id="fn3"><p>“For example, the protein folding process takes about <img src="https://latex.codecogs.com/png.latex?10%5E%7B-3%7D"> seconds in nature. A proper MD simulation of such a process needs a step size of order <img src="https://latex.codecogs.com/png.latex?10%5E%7B-12%7D"> and will take about <img src="https://latex.codecogs.com/png.latex?10%5E6"> days using a current computer.”↩︎</p></li>
<li id="fn4"><p>For example, if the system of interest consists of closely packed particles, a random proposal for moving a particle is most likely rejected because the proposed new position has been partially occupied by others. <span class="citation" data-cites="Liu2004">(Liu, 2004, p. 189)</span>↩︎</p></li>
<li id="fn5"><p><span class="citation" data-cites="Faulkner-Livingstone2024">(Faulkner &amp; Livingstone, 2024, p. 17)</span> 4.3.1 節も参照．↩︎</p></li>
<li id="fn6"><p><span class="citation" data-cites="Faulkner-Livingstone2024">(Faulkner &amp; Livingstone, 2024, p. 18)</span> 4.3.2 節，<span class="citation" data-cites="Bou-Rabee_Sanz-Serna2018">(Bou-Rabee &amp; Sanz-Serna, 2018)</span> も参照．↩︎</p></li>
<li id="fn7"><p>詳しくは <span class="citation" data-cites="Leimkuhler-Matthews2015">(Leimkuhler &amp; Matthews, 2015)</span> 6.3.2 節，<span class="citation" data-cites="Pavliotis2014">(Pavliotis, 2014, p. 181)</span>，<span class="citation" data-cites="Bressloff-StochasticProcessInCellBiology1">(Bressloff, 2021, p. 46)</span> も参照．↩︎</p></li>
<li id="fn8"><p><span class="citation" data-cites="Leimkuhler-Reich2005">(Leimkuhler &amp; Reich, 2005)</span> に詳しい．↩︎</p></li>
<li id="fn9"><p>この過程は，<span class="citation" data-cites="Pavliotis2014">(Pavliotis, 2014)</span> 第 6.5 節，そして <span class="citation" data-cites="Stoltz2021">(Stoltz, 2021)</span> 参照．↩︎</p></li>
<li id="fn10"><p><span class="citation" data-cites="Dalalyan-Riou-Durand2020">(Dalalyan &amp; Riou-Durand, 2020)</span> に倣った．↩︎</p></li>
<li id="fn11"><p>特に格子場の理論において，Fermion 自由度が存在する場合のシミュレーションを問題として扱っていた．↩︎</p></li>
<li id="fn12"><p><span class="citation" data-cites="Faulkner-Livingstone2024">(Faulkner &amp; Livingstone, 2024, p. 19)</span> 4.4 節も参照．↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Nature</category>
  <category>Computation</category>
  <guid>https://162348.github.io/posts/2024/Nature/StatisticalMechanics3.html</guid>
  <pubDate>Fri, 28 Jun 2024 15:00:00 GMT</pubDate>
  <media:content url="https://162348.github.io/posts/2024/Nature/Lennard-Jones.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>Poisson 過程を見てみよう</title>
  <dc:creator>司馬博文 </dc:creator>
  <link>https://162348.github.io/posts/2024/Process/Poisson.html</link>
  <description><![CDATA[ 





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<p>YUIMAについては次の記事も参照：</p>
<div class="article-card-container">
  <div class="article-card">
    <a href="https://162348.github.io/posts/2024/Computation/YUIMA.html" target="_blank">
      <img src="https://162348.github.io/posts/2024/Computation/YUIMA_files/figure-html/unnamed-chunk-5-1.png" alt="Article Image" class="article-image">
      <div class="article-content">
        <h3 class="article-title anchored">YUIMA 入門</h3>
        <p class="article-description">確率微分方程式のシミュレーションと推測のためのパッケージ`yuima`の構造と使い方をまとめます．</p>
      </div>
    </a>
  </div>
</div>
<section id="poisson-過程" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="poisson-過程"><span class="header-section-number">1</span> Poisson 過程</h2>
<section id="導入" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="導入"><span class="header-section-number">1.1</span> 導入</h3>
<p>Poisson 過程と言った場合，Poisson 点過程 <img src="https://latex.codecogs.com/png.latex?%5Ceta"> と Poisson 計数過程 <img src="https://latex.codecogs.com/png.latex?N"> の２つを峻別する必要がある．<sup>1</sup></p>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><img src="https://latex.codecogs.com/png.latex?E=%5B0,T%5D">，<img src="https://latex.codecogs.com/png.latex?%5Clambda%3E0"> をレートとした場合，</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?E"> 上の（一様な） <strong>Poisson 点過程</strong> <img src="https://latex.codecogs.com/png.latex?%5Ceta"> とは，<img src="https://latex.codecogs.com/png.latex?X_k%5Coverset%7B%5Ctext%7Biid%7D%7D%7B%5Csim%7D%5Cmathrm%7BU%7D(%5B0,T%5D)"> を一様確率変数，<img src="https://latex.codecogs.com/png.latex?%5Ckappa%5Csim%5Cmathrm%7BPois%7D(%5Clambda%20T)"> を Poisson 確率変数として， <img src="https://latex.codecogs.com/png.latex?%0A%20%20%5Ceta=%5Csum_%7Bk=1%7D%5E%5Ckappa%5Cdelta_%7BX_k%7D%0A%20%20"> で表せる <strong>確率核</strong> <img src="https://latex.codecogs.com/png.latex?%5COmega%5Cto%20E"> をいう．</li>
<li><img src="https://latex.codecogs.com/png.latex?E"> 上の（一様な） <strong>Poisson 計数過程</strong> <img src="https://latex.codecogs.com/png.latex?N"> とは，点過程 <img src="https://latex.codecogs.com/png.latex?%5Ceta"> の <img src="https://latex.codecogs.com/png.latex?%5B0,t%5D"> 内の点の数 <img src="https://latex.codecogs.com/png.latex?%0A%20%20N_t:=%5C#%5Cleft%5C%7Bn%5Cin%5Cmathbb%7BN%7D%5Cmid%20X_n%5Cle%20t%5Cright%5C%7D=%5Csum_%7Bn=1%7D%5E%5Cinfty1_%7B%5Cleft%5C%7BX_n%5Cle%20t%5Cright%5C%7D%7D%0A%20%20"> で定まる <strong>確率過程</strong> <img src="https://latex.codecogs.com/png.latex?%5C%7BN_t%5C%7D%5Csubset%5Cmathcal%7BL%7D(%5COmega)"> をいう．</li>
</ul>
</div>
</div>
</div>
<p>このとき， <img src="https://latex.codecogs.com/png.latex?%0A%5Ceta(%5B0,t%5D)%5Csim%5Cmathrm%7BPois%7D(%5Clambda%20t),%0A"> <img src="https://latex.codecogs.com/png.latex?%0AN_t%5Csim%5Cmathrm%7BPois%7D(%5Clambda%20t),%0A"> が成り立ち，<img src="https://latex.codecogs.com/png.latex?N"> は Lévy 過程になる．</p>
<p><img src="https://latex.codecogs.com/png.latex?N"> は Lévy 過程の中でも，大きさ１の跳躍のみで増加するものとして特徴付けられる．<sup>2</sup></p>
<p><img src="https://latex.codecogs.com/png.latex?N"> は，ランダム測度 <img src="https://latex.codecogs.com/png.latex?%5Ceta"> が定める <img src="https://latex.codecogs.com/png.latex?%0AN_t(%5Comega)=%5Ceta(%5Comega,%5B0,t%5D)=%5Cint_0%5Et%5Ceta(%5Comega,ds)%0A"> とも理解できる．</p>
</section>
<section id="点過程の定義" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="点過程の定義"><span class="header-section-number">1.2</span> 点過程の定義</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定義 (point process)^[[@Kallenberg2017 p.49]，[@Last_Penrose2017 p.11] 定義2.1 に倣った．全く同じ概念を [@伊藤清1991 p.298] は **偶然配置** と呼ぶ．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定義 (point process)<sup>3</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?(E,%5Cmathcal%7BE%7D)"> を測度空間とする．<img src="https://latex.codecogs.com/png.latex?E"> 上の <strong>点過程</strong> とは，次の条件を満たす確率核 <img src="https://latex.codecogs.com/png.latex?%5Ceta:%5COmega%5Cto%20E"> をいう： <img src="https://latex.codecogs.com/png.latex?%0A%5Ceta(%5Comega,B)%5Cin%5Cmathbb%7BN%7D%5Ccup%5C%7B%5Cinfty%5C%7D,%5Cqquad%5Comega%5Cin%5COmega,B%5Cin%5Cmathcal%7BE%7D.%0A"></p>
</div>
</div>
<p>従って，任意の点過程 <img src="https://latex.codecogs.com/png.latex?%5Ceta"> に対して，積分 <img src="https://latex.codecogs.com/png.latex?%0A(%5Ceta%7Cf)(%5Comega):=%5Cint_E%5Ceta(%5Comega,dx)f(x)%5Cin%5B-%5Cinfty,%5Cinfty%5D%0A"> が定まる．</p>
<p>点過程 <img src="https://latex.codecogs.com/png.latex?%5Ceta"> が <strong>真の点過程</strong> であるとは，ある <img src="https://latex.codecogs.com/png.latex?E">-値確率変数の列 <img src="https://latex.codecogs.com/png.latex?X_1,X_2,%5Ccdots"> と，<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BN%7D%5Ccup%5C%7B%5Cinfty%5C%7D">-値確率変数 <img src="https://latex.codecogs.com/png.latex?%5Ckappa"> が存在して， <img src="https://latex.codecogs.com/png.latex?%0A%5Ceta=%5Csum_%7Bn=1%7D%5E%5Ckappa%20%5Cdelta_%7BX_n%7D%5C;%5C;%5Ctext%7Ba.s.%7D%0A"> と表せることとする．</p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="真の点過程になるための条件">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
真の点過程になるための条件
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="citation" data-cites="Revuz-Yor1999">(Revuz &amp; Yor, 1999, p. 471)</span> 定義XII.1.1 は違う定義を与えている：</p>
<blockquote class="blockquote">
<p><img src="https://latex.codecogs.com/png.latex?E"> 上の点過程とは，<img src="https://latex.codecogs.com/png.latex?E_%5Cdelta:=E%5Ccup%5C%7B%5Cdelta%5C%7D"> 上の確率過程 <img src="https://latex.codecogs.com/png.latex?%5C%7Be_t%5C%7D_%7Bt%5Cin%5Cmathbb%7BR%7D_+%7D%5Csubset%5Cmathcal%7BL%7D(%5COmega;E_%5Cdelta)"> であって，次の２条件を満たすものをいう：</p>
<ol type="1">
<li><img src="https://latex.codecogs.com/png.latex?(t,%5Comega)%5Cmapsto%20e_t(%5Comega)"> は <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BB%7D(%5Cmathbb%7BR%7D%5E+)%5Cotimes%5Cmathcal%7BF%7D">-可測である．</li>
<li><img src="https://latex.codecogs.com/png.latex?D_%5Comega:=%5Cleft%5C%7Bt%5Cin%5Cmathbb%7BR%7D_+%5Cmid%20e_t(%5Comega)%5Cne%5Cdelta%5Cright%5C%7D"> は殆ど確実に可算である．</li>
</ol>
</blockquote>
<p><span class="citation" data-cites="Kingman2006">(Kingman, 2006)</span> の定義は「<img src="https://latex.codecogs.com/png.latex?E"> 内のランダムに決まる可算集合」というもので，これと等価な定義である．この定義は，上で与えた確率核による定義よりも強い（範囲が狭い）ものである．</p>
<p>確率核の意味での点過程が，追加で次の条件を満たすとき，真の点過程になる．<sup>4</sup> 特に，<span class="citation" data-cites="Revuz-Yor1999">(Revuz &amp; Yor, 1999)</span> と <span class="citation" data-cites="Kingman2006">(Kingman, 2006)</span> の意味でも点過程である．</p>
<blockquote class="blockquote">
<p>ある可算な分割 <img src="https://latex.codecogs.com/png.latex?%5Csqcup_%7Bn%5Cin%5Cmathbb%7BN%7D%7DB_n=E"> が存在して， <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BP%7D%5B%5Ceta(B_n)%3C%5Cinfty%5D=1%0A"> である．</p>
</blockquote>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?E"> が Polish 空間で，<img src="https://latex.codecogs.com/png.latex?%5Ceta(%5Comega,-)"> が（殆ど確実に）任意の有界集合上で有限ならば，これを満たす．</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Csigma">-有限な強度測度を持つ Poisson 過程もこれを満たす（第 1.4 節）．</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="例（[@Cox1955] 過程）^[[@Last_Penrose2017 p.129] 定義13.5 に倣った．]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
例（<span class="citation" data-cites="Cox1955">(Cox, 1955)</span> 過程）<sup>5</sup>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Cxi"> を確率核 <img src="https://latex.codecogs.com/png.latex?%5COmega%5Cto%20E"> とする．すなわち，可測写像 <img src="https://latex.codecogs.com/png.latex?%5COmega%5Cto%5Cmathcal%7BP%7D(E)"> であるとする．このような <img src="https://latex.codecogs.com/png.latex?%5Cxi"> をランダム測度ともいう．</p>
<p>ランダム測度 <img src="https://latex.codecogs.com/png.latex?%5Cxi"> によって定まる強度測度を持った Poisson 過程 <img src="https://latex.codecogs.com/png.latex?%5Ceta"> を，<strong>Cox 過程</strong> または二重確率 Poisson 過程という．</p>
<p>式で表すと，強度測度 <img src="https://latex.codecogs.com/png.latex?%5Clambda"> を持つ Poisson 点過程の分布を <img src="https://latex.codecogs.com/png.latex?%5CPi_%5Clambda%5Cin%5Cmathcal%7BP%7D(E)"> とすると， <img src="https://latex.codecogs.com/png.latex?%0A%5Ceta%7C%5Cxi%5Coverset%7B%5Ctext%7Bd%7D%7D%7B=%7D%5CPi_%5Cxi%0A"> を満たす点過程 <img src="https://latex.codecogs.com/png.latex?%5Ceta:%5COmega%5Cto%20E"> をいう．</p>
</div>
</div>
</div>
</section>
<section id="sec-Campbell-formula" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="sec-Campbell-formula"><span class="header-section-number">1.3</span> 強度測度</h3>
<p>点過程には「各集合 <img src="https://latex.codecogs.com/png.latex?B%5Cin%5Cmathcal%7BE%7D"> に平均何個の点が入るか」を表す <strong>強度測度</strong> <img src="https://latex.codecogs.com/png.latex?%5Clambda"> が定まる．<strong>平均測度</strong> とも呼ばれる．</p>
<p>この強度測度 <img src="https://latex.codecogs.com/png.latex?%5Clambda"> は <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BE%7D%5Bd%5Ceta%5D"> のようなものであり，Fubini の定理のような性質 <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BE%7D%5Cleft%5B%5Cint_E%20u%5C,d%5Ceta%5Cright%5D=%5Cint_Eu%5Coperatorname%7BE%7D%5Bd%5Ceta%5D%0A"> が成り立つ．これを <a href="https://en.wikipedia.org/wiki/Campbell%27s_theorem_(probability)">Campbell の公式</a> という．</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定義 (intensity / mean measure)^[[@伊藤清1991 p.298] に倣った．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定義 (intensity / mean measure)<sup>6</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Ceta"> を可測空間 <img src="https://latex.codecogs.com/png.latex?(E,%5Cmathcal%7BE%7D)"> 上の点過程とする．<img src="https://latex.codecogs.com/png.latex?%5Ceta"> の <strong>強度測度</strong> とは，次で定まる測度 <img src="https://latex.codecogs.com/png.latex?%5Clambda:%5Cmathcal%7BE%7D%5Cto%5B0,%5Cinfty%5D"> をいう： <img src="https://latex.codecogs.com/png.latex?%0A%5Clambda(B):=%5Coperatorname%7BE%7D%5B%5Ceta(B)%5D,%5Cqquad%20B%5Cin%5Cmathcal%7BE%7D.%0A"></p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題 [@Campbell1909 の公式]^[[@Last_Penrose2017 p.13] 命題2.7 に倣った．[@Campbell1909] は元々真空管内の [shot noise](https://ja.wikipedia.org/wiki/ショット雑音) の研究をしていた．結果の一部は G. H. Hardy にもよるという．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題 <span class="citation" data-cites="Campbell1909">(Campbell, 1909 の公式)</span><sup>7</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Ceta">　を点過程，<img src="https://latex.codecogs.com/png.latex?%5Clambda"> をその強度測度とする．任意の <img src="https://latex.codecogs.com/png.latex?u%5Cin%5Cmathcal%7BL%7D(E)"> について，<img src="https://latex.codecogs.com/png.latex?(%5Ceta%7Cu)"> は確率変数であり，加えて <img src="https://latex.codecogs.com/png.latex?u%5Cin%5Cmathcal%7BL%7D%5E1(%5Clambda)"> または <img src="https://latex.codecogs.com/png.latex?u%5Cge0"> である場合，次が成り立つ： <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BE%7D%5Cleft%5B%5Cint_Eu(x)%5Ceta(dx)%5Cright%5D=%5Cint_Eu(x)%5Clambda(dx).%0A"></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?u"> がある <img src="https://latex.codecogs.com/png.latex?B%5Cin%5Cmathcal%7BE%7D"> の特性関数 <img src="https://latex.codecogs.com/png.latex?u=1_B"> である場合， <img src="https://latex.codecogs.com/png.latex?%0A%5Cint_Eu(x)%5Ceta(dx)=%5Ceta(B)%0A"> であり，点過程 <img src="https://latex.codecogs.com/png.latex?%5Ceta"> の定義からこれは確率変数である．</p>
<p>期待値の線型性より一般の単関数，単調収束定理より一般の可測関数についても成り立つ．</p>
<p><img src="https://latex.codecogs.com/png.latex?u%5Cin%5Cmathcal%7BL%7D%5E1(%5Clambda)"> であるとき，<img src="https://latex.codecogs.com/png.latex?u"> に収束する単関数列 <img src="https://latex.codecogs.com/png.latex?%0Au_n:=%5Csum_%7Bi=1%7D%5E%7Bm_n%7Da_i%5E%7B(n)%7D1_%7BB_i%5E%7B(n)%7D%7D%5Cnearrow%20u%0A"> を取ると，Lebesgue の優収束定理より次のように結論づけられる： <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Coperatorname%7BE%7D%5Cleft%5B%5Cint_Eu(x)%5Ceta(dx)%5Cright%5D&amp;=%5Clim_%7Bn%5Cto%5Cinfty%7D%5Coperatorname%7BE%7D%5Cleft%5B%5Cint_Eu_n(x)%5Ceta(dx)%5Cright%5D%5C%5C%0A%20%20%20%20&amp;=%5Clim_%7Bn%5Cto%5Cinfty%7D%5Coperatorname%7BE%7D%5Cleft%5B%5Csum_%7Bi=1%7D%5E%7Bm_n%7Da_i%5E%7B(n)%7D%5Ceta(B_i%5E%7B(n)%7D)%5Cright%5D%5C%5C%0A%20%20%20%20&amp;=%5Clim_%7Bn%5Cto%5Cinfty%7D%5Csum_%7Bi=1%7D%5E%7Bm_n%7Da_i%5E%7B(n)%7D%5Clambda(B_i%5E%7B(n)%7D)%5C%5C%0A%20%20%20%20&amp;=%5Cint_Eu(x)%5Clambda(dx)=(%5Clambda%7Cu)%3C%5Cinfty.%0A%5Cend%7Balign*%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?u%5Cge0"> の場合も同様で，Lebesgue の優収束定理が単調収束定理に変わるのみである．</p>
</div>
</div>
</div>
</section>
<section id="sec-def-Poisson-point-process" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="sec-def-Poisson-point-process"><span class="header-section-number">1.4</span> Poisson 点過程の定義</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定義 (Poisson (point) process / random measure)^[[@Nualart2018 p.160] 定義9.2.1，[@Sato2013 p.119] 第4章19節，[@Resnick2002 p.303]，[@Sato2013 p.119] 定義19.1，[@Last_Penrose2017 p.19] 定義3.1 に倣った．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定義 (Poisson (point) process / random measure)<sup>8</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?(E,%5Cmathcal%7BE%7D)"> を可測空間，<img src="https://latex.codecogs.com/png.latex?%5Clambda:%5Cmathcal%7BE%7D%5Cto%5B0,%5Cinfty%5D"> を測度とする．強度（測度） <img src="https://latex.codecogs.com/png.latex?%5Clambda"> を持つ <strong>Poisson 過程</strong> とは，次の２条件を満たす点過程 <img src="https://latex.codecogs.com/png.latex?%5Ceta"> をいう：</p>
<ol type="1">
<li>任意の <img src="https://latex.codecogs.com/png.latex?B%5Cin%5Cmathcal%7BE%7D"> に対して，<img src="https://latex.codecogs.com/png.latex?%5Ceta(B)%5Csim%5Cmathrm%7BPois%7D(%5Clambda(B))">．</li>
<li>任意の <img src="https://latex.codecogs.com/png.latex?m%5Cin%5Cmathbb%7BN%7D"> と互いに素な可測集合 <img src="https://latex.codecogs.com/png.latex?B_1,%5Ccdots,B_m%5Cin%5Cmathcal%7BE%7D"> について，<img src="https://latex.codecogs.com/png.latex?%5Ceta(B_1),%5Ccdots,%5Ceta(B_m)"> は独立である．</li>
</ol>
</div>
</div>
<p>２つの強度測度 <img src="https://latex.codecogs.com/png.latex?%5Clambda,%5Clambda'"> は <img src="https://latex.codecogs.com/png.latex?%5Csigma">-有限であるとする．</p>
<p>このとき，<img src="https://latex.codecogs.com/png.latex?%5Clambda=%5Clambda'"> ならば，これを強度とする Poisson 過程は分布同等である．<sup>9</sup></p>
<p>加えて，<img src="https://latex.codecogs.com/png.latex?%5Csigma">-有限な強度測度を持つ Poisson 過程は，真の点過程（と同分布）である：</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（Poisson 過程が真の点過程となるとき）^[[@Nualart2018 p.160] 定理9.2.2 では，$\lambda$ はアトムを持たないとし，$E$ を Polish 空間として示している．[@Last_Penrose2017 p.22] 系3.7 はここよりも一般的な設定で示している．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（Poisson 過程が真の点過程となるとき）<sup>10</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Clambda"> を <img src="https://latex.codecogs.com/png.latex?%5Csigma">-有限とする．このとき，ある確率変数の列 <img src="https://latex.codecogs.com/png.latex?%5C%7BX_n%5C%7D%5Csubset%5Cmathcal%7BL%7D(%5COmega;E)"> と <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BN%7D%5Ccup%5C%7B%5Cinfty%5C%7D">-値確率変数 <img src="https://latex.codecogs.com/png.latex?%5Ckappa"> が存在して， <img src="https://latex.codecogs.com/png.latex?%0A%5Ceta:=%5Csum_%7Bn=1%7D%5E%5Ckappa%5Cdelta_%7BX_n%7D%0A"> は強度 <img src="https://latex.codecogs.com/png.latex?%5Clambda"> の Poisson 過程となる．</p>
</div>
</div>
<p>実は Poisson 点過程は，Poisson 分布と同様に，可算な範囲で再生性がある：<img src="https://latex.codecogs.com/png.latex?%5Ceta%5E%7B(1)%7D,%5Ceta%5E%7B(2)%7D,%5Ccdots"> を独立な Poisson 点過程とすると， <img src="https://latex.codecogs.com/png.latex?%0A%5Ceta:=%5Csum_%7Bk=1%7D%5E%5Cinfty%5Ceta%5E%7B(k)%7D%0A"> も Poisson 点過程であり，強度測度は <img src="https://latex.codecogs.com/png.latex?%5Cnu:=%5Csum_%7Bk=1%7D%5E%5Cinfty%5Clambda%5E%7B(k)%7D"> となる．<sup>11</sup></p>
<p>従って，実際は <img src="https://latex.codecogs.com/png.latex?%5Csigma">-有限な強度測度を持つ Poisson 過程よりもさらに一般的な設定で上の定理が成り立つ．</p>
</section>
<section id="例" class="level3" data-number="1.5">
<h3 data-number="1.5" class="anchored" data-anchor-id="例"><span class="header-section-number">1.5</span> 例</h3>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li><p>強度測度が有限であるとき，複合二項過程として極めて明瞭な理解ができる．</p></li>
<li><p>区間上の Poisson 過程は，一様分布に関する複合二項過程になる．点の間の間隔は指数分布に従う．<sup>12</sup></p></li>
</ul>
</div>
</div>
</div>
<section id="複合二項過程" class="level4" data-number="1.5.1">
<h4 data-number="1.5.1" class="anchored" data-anchor-id="複合二項過程"><span class="header-section-number">1.5.1</span> 複合二項過程</h4>
<p><img src="https://latex.codecogs.com/png.latex?%5Cmu%5Cin%5Cmathcal%7BP%7D(E),%5Cpi%5Cin%5Cmathcal%7BP%7D(%5Cmathbb%7BN%7D)"> とする．<img src="https://latex.codecogs.com/png.latex?X_k%5Coverset%7B%5Ctext%7Biid%7D%7D%7B%5Csim%7D%5Cmu"> と <img src="https://latex.codecogs.com/png.latex?%5Ckappa%5Csim%5Cpi"> について， <img src="https://latex.codecogs.com/png.latex?%0A%5Ceta:=%5Csum_%7Bk=1%7D%5E%5Ckappa%5Cdelta_%7BX_k%7D%0A"> は点過程を定める．これを サンプリング分布 <img src="https://latex.codecogs.com/png.latex?%5Cmu"> を持った <img src="https://latex.codecogs.com/png.latex?%5Cpi"> による <strong>複合二項過程</strong> という．<sup>13</sup></p>
<p>ある <img src="https://latex.codecogs.com/png.latex?%5Cgamma%3E0"> に関して <img src="https://latex.codecogs.com/png.latex?%5Cpi=%5Cmathrm%7BPois%7D(%5Cgamma)"> と取った場合，<img src="https://latex.codecogs.com/png.latex?%5Ceta"> は強度 <img src="https://latex.codecogs.com/png.latex?%5Cgamma%5Cmu"> を持った Poisson 過程となる．</p>
<p>複合二項過程について，次が成り立つ：</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（有限な強度を持つ Poisson 過程の特徴付け）^[[@Last_Penrose2017 p.23] 命題3.8も参照．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（有限な強度を持つ Poisson 過程の特徴付け）<sup>14</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Clambda:%5Cmathcal%7BE%7D%5Cto(0,%5Cinfty)"> を有限測度とする．このとき，点過程 <img src="https://latex.codecogs.com/png.latex?%5Ceta"> について，次の２条件は同値である：</p>
<ol type="1">
<li><img src="https://latex.codecogs.com/png.latex?%5Ceta"> は <img src="https://latex.codecogs.com/png.latex?%5Clambda"> を強度測度とする Poisson 過程である．</li>
<li>サンプリング分布 <img src="https://latex.codecogs.com/png.latex?%5Cmu:=%5Clambda(E)%5E%7B-1%7D%5Clambda"> を持つ <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BPois%7D(%5Clambda(E))">-複合二項過程である．</li>
</ol>
<p>特に，<img src="https://latex.codecogs.com/png.latex?%5Ceta(E)=m"> で条件づけた分布は，<img src="https://latex.codecogs.com/png.latex?%5Cdelta_%7BX_1%7D+%5Ccdots+%5Cdelta_%7BX_m%7D"> に等しい．</p>
</div>
</div>
</section>
<section id="sec-Poisson-point-process-on-R" class="level4" data-number="1.5.2">
<h4 data-number="1.5.2" class="anchored" data-anchor-id="sec-Poisson-point-process-on-R"><span class="header-section-number">1.5.2</span> <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D_+"> 上の Poisson 過程</h4>
<p><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D_+"> の Poisson 過程で，強度が <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D_+"> 上の Lebesgue 測度の定数倍であるものを <strong>一様 Poisson 過程</strong> といい，<img src="https://latex.codecogs.com/png.latex?%5Clambda%3E0"> を <strong>レート</strong> ともいう．</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（$\mathbb{R}_+$ 上の Poisson 点過程の特徴付け）^[[@Last_Penrose2017 p.59] 定理7.2参照．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D_+"> 上の Poisson 点過程の特徴付け）<sup>15</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Ceta"> を <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D_+"> 上の点過程とする．このとき，<img src="https://latex.codecogs.com/png.latex?%5Clambda%3E0"> に関して次は同値：</p>
<ol type="1">
<li><img src="https://latex.codecogs.com/png.latex?%5Ceta"> はレート <img src="https://latex.codecogs.com/png.latex?%5Clambda"> を持った一様 Poisson 過程である．</li>
<li>到着時刻 <img src="https://latex.codecogs.com/png.latex?%0AT_n(%5Comega):=%5Cinf%5Cleft%5C%7Bt%5Cge%200%5Cmid%20%5Ceta(%5Comega,%5B0,t%5D)%5Cge%20n%5Cright%5C%7D%0A"> の間隔は <img src="https://latex.codecogs.com/png.latex?%5Cmathop%7B%5Cmathrm%7BExp%7D%7D(%5Clambda)"> の独立同分布である．</li>
</ol>
</div>
</div>
</section>
</section>
<section id="sec-marked-process" class="level3" data-number="1.6">
<h3 data-number="1.6" class="anchored" data-anchor-id="sec-marked-process"><span class="header-section-number">1.6</span> 印付き過程</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定義 ($K$-marked process)^[[@Last_Penrose2017 p.40] 定義5.3 に倣った．[@Kingman1992 p.55] 5.2節も参照．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定義 (<img src="https://latex.codecogs.com/png.latex?K">-marked process)<sup>16</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Ceta"> を <img src="https://latex.codecogs.com/png.latex?E"> 上の真の点過程，<img src="https://latex.codecogs.com/png.latex?K:E%5Cto%20F"> を確率核，<img src="https://latex.codecogs.com/png.latex?%5C%7BY_n%5C%7D%5Csubset%5Cmathcal%7BL%7D(%5COmega;F)"> を確率変数列とする．加えて，任意の <img src="https://latex.codecogs.com/png.latex?m%5Cin%5Cmathbb%7BN%7D%5Ccup%5C%7B%5Cinfty%5C%7D"> について，<img src="https://latex.codecogs.com/png.latex?%5Ckappa=m"> と <img src="https://latex.codecogs.com/png.latex?X_1,%5Ccdots,X_m"> の値で条件づけた <img src="https://latex.codecogs.com/png.latex?Y_i"> の分布は，もはや <img src="https://latex.codecogs.com/png.latex?X_i"> の値にしか依らずに独立に定まるとする： <img src="https://latex.codecogs.com/png.latex?%0A(Y_n)_%7Bn%5Cle%20m%7D%5C,%7C%5C,%5Ckappa=m,(X_n)_%7Bn%5Cle%20m%7D%5Coverset%7B%5Ctext%7Bd%7D%7D%7B=%7D%5Cotimes_%7Bn=1%7D%5EmK(X_n,-)%0A"> このとき，<img src="https://latex.codecogs.com/png.latex?E%5Ctimes%20F"> 上の真の点過程 <img src="https://latex.codecogs.com/png.latex?%0A%5Cxi:=%5Csum_%7Bn=1%7D%5E%5Ckappa%5Cdelta_%7B(X_n,Y_n)%7D%0A"> を <img src="https://latex.codecogs.com/png.latex?X"> の <strong><img src="https://latex.codecogs.com/png.latex?K"> で印付けられた過程</strong> または <img src="https://latex.codecogs.com/png.latex?K">-付印過程という．</p>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?%5Ceta"> を <img src="https://latex.codecogs.com/png.latex?%5Csigma">-有限な強度 <img src="https://latex.codecogs.com/png.latex?%5Clambda"> を持つ Poisson 過程とするとき，<img src="https://latex.codecogs.com/png.latex?%5Ceta"> の任意の可測写像 <img src="https://latex.codecogs.com/png.latex?T:E%5Cto%20F"> による像は <img src="https://latex.codecogs.com/png.latex?T_*%5Clambda"> を強度とする Poisson 過程となり，<img src="https://latex.codecogs.com/png.latex?%5Ceta"> の任意の <img src="https://latex.codecogs.com/png.latex?K">-印付き過程もやはり Poisson 過程になる．<sup>17</sup></p>
<p><img src="https://latex.codecogs.com/png.latex?K:E%5Cto%5Cmathcal%7BP%7D(F)"> が定値関数になる場合（すなわち <img src="https://latex.codecogs.com/png.latex?%5C%7BY_n%5C%7D"> が <img src="https://latex.codecogs.com/png.latex?X_n"> の値に依らずに独立同分布に定まる場合），これを <strong>独立 <img src="https://latex.codecogs.com/png.latex?K">-付印</strong> という．</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="例（降水量の時系列）">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
例（降水量の時系列）
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>雨がふるという事象が Poisson 点過程に従い，その際の降水量がランダムに決まるため，降水量の時系列は古くから独立付印 Poisson 過程としてモデル化されている <span class="citation" data-cites="Todorovic-Yevjevich1969">(Todorovic &amp; Yevjevich, 1969)</span>．<sup>18</sup></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（一様 Poisson 過程の独立付印過程の特徴付け）">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（一様 Poisson 過程の独立付印過程の特徴付け）
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cxi=%5Csum_%7Bn=1%7D%5E%5Cinfty1_%7B%5Cleft%5C%7BT_n%3C%5Cinfty%5Cright%5C%7D%7D%5Cdelta_%7B(T_n,Y_n)%7D%0A"> を <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D_+%5Ctimes%20E"> 上の点過程， <img src="https://latex.codecogs.com/png.latex?%0A%5Ceta=%5Csum_%7Bn=1%7D%5E%5Cinfty1_%7B%5Cleft%5C%7BT_n%3C%5Cinfty%5Cright%5C%7D%7D%5Cdelta_%7BT_n%7D%0A"> を <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D_+"> 上の点過程とする．</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cgamma%3E0"> と <img src="https://latex.codecogs.com/png.latex?%5Cmu%5Cin%5Cmathcal%7BP%7D(E)"> について，次は同値：</p>
<ol type="1">
<li><img src="https://latex.codecogs.com/png.latex?%5Cxi"> はレート <img src="https://latex.codecogs.com/png.latex?%5Cgamma"> を持つ一様 Poisson 過程 <img src="https://latex.codecogs.com/png.latex?%5Ceta"> の <img src="https://latex.codecogs.com/png.latex?%5Cmu">-独立付印である．</li>
<li><img src="https://latex.codecogs.com/png.latex?T_1,Y_1,T_2-T_1,Y_2,%5Ccdots"> は独立で，<img src="https://latex.codecogs.com/png.latex?T_n-T_%7Bn-1%7D%5Csim%5Cmathop%7B%5Cmathrm%7BExp%7D%7D(%5Cgamma)"> かつ <img src="https://latex.codecogs.com/png.latex?Y_n%5Coverset%7B%5Ctext%7Biid%7D%7D%7B%5Csim%7D%5Cmu"> である．</li>
</ol>
</div>
</div>
</section>
<section id="剪定" class="level3" data-number="1.7">
<h3 data-number="1.7" class="anchored" data-anchor-id="剪定"><span class="header-section-number">1.7</span> 剪定</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定義 ($p$-thinning)^[[@Last_Penrose2017 p.43] 定義5.7 に従った．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定義 (<img src="https://latex.codecogs.com/png.latex?p">-thinning)<sup>19</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?p:E%5Cto%5B0,1%5D"> を可測関数とし，確率核 <img src="https://latex.codecogs.com/png.latex?K:E%5Cto2"> を次で定める： <img src="https://latex.codecogs.com/png.latex?%0AK_p(x,-):=%5Cbiggr(1-p(x)%5Cbiggl)%5Cdelta_0+p(x)%5Cdelta_1.%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?E"> 上の真の点過程 <img src="https://latex.codecogs.com/png.latex?X"> の，この確率核に関する <img src="https://latex.codecogs.com/png.latex?E%5Ctimes2"> 上の <img src="https://latex.codecogs.com/png.latex?K">-印付き過程 <img src="https://latex.codecogs.com/png.latex?M"> に対して， <img src="https://latex.codecogs.com/png.latex?%0A(%5Comega,B)%5Cmapsto%20M(%5Comega,B%5Ctimes%5C%7B1%5C%7D)%0A"> で定まる <img src="https://latex.codecogs.com/png.latex?E"> 上の真の点過程を <img src="https://latex.codecogs.com/png.latex?X"> の <strong><img src="https://latex.codecogs.com/png.latex?p">-剪定</strong> という．</p>
</div>
</div>
<p>すなわち，点 <img src="https://latex.codecogs.com/png.latex?x%5Cin%20E"> に定まる所定の確率 <img src="https://latex.codecogs.com/png.latex?p(x)"> に関して，確率 <img src="https://latex.codecogs.com/png.latex?p(X_n)"> で点 <img src="https://latex.codecogs.com/png.latex?X_n"> を脱落させて得る点過程を，<img src="https://latex.codecogs.com/png.latex?p">-剪定という．</p>
<p><img src="https://latex.codecogs.com/png.latex?p">-剪定は強度 <img src="https://latex.codecogs.com/png.latex?p(x)%5Clambda(dx)"> を持つ Poisson 過程となる．加えて，<img src="https://latex.codecogs.com/png.latex?1-p">-剪定と違いに独立になる．<sup>20</sup></p>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="例（非一様な Poisson 過程のシミュレーション）">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
例（非一様な Poisson 過程のシミュレーション）
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>この剪定によって，連続なレート関数 <img src="https://latex.codecogs.com/png.latex?%5Clambda"> を持つ非一様な Poisson 過程をシミュレーションする方法が <span class="citation" data-cites="Lewis-Shedler1979">(Lewis &amp; Shedler, 1979)</span> で提案され，<span class="citation" data-cites="Ogata1981">(Ogata, 1981)</span> が一般の点過程に拡張した．</p>
<p>実際，<code>yuima</code>でもこの方法が採用されている（第 1.9.2 節）．</p>
<p>アルゴリズムは次のとおりである：</p>
<blockquote class="blockquote">
<p><img src="https://latex.codecogs.com/png.latex?%5Clambda%5Cle%5Clambda%5E*"> を満たす２つのレート関数を持つ Poisson 過程 <img src="https://latex.codecogs.com/png.latex?%5Ceta,%5Ceta%5E*"> を考える．<img src="https://latex.codecogs.com/png.latex?%5Ceta%5E*(%5B0,x_0%5D)"> 内の点 <img src="https://latex.codecogs.com/png.latex?%0AX_1%5E*,X_2%5E*,%5Ccdots,X_%7B%5Ceta%5E*(%5B0,x_0%5D)%7D%5E*%0A"> を生成し，それぞれの点を確率 <img src="https://latex.codecogs.com/png.latex?1-%5Cfrac%7B%5Clambda(X_i%5E*)%7D%7B%5Clambda%5E*(X_i%5E*)%7D"> で取り除く．すると，残った点は <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Clambda(X_i%5E*)%7D%7B%5Clambda%5E*(X_i%5E*)%7D%5Clambda%5E*(dx)=%5Clambda(dx)%0A"> をレート関数にもつ Poisson 過程の分布，すなわち <img src="https://latex.codecogs.com/png.latex?%5Ceta"> の分布に従う．</p>
</blockquote>
<p>最も簡単な場合としては，<img src="https://latex.codecogs.com/png.latex?%5Clambda%5E*:=%5Cmax_%7Bt%5Cin%5B0,x_0%5D%7D%5Clambda(t)"> などと取れば良い．</p>
<p>すると，定値なレート関数を持つ Poisson 過程 <img src="https://latex.codecogs.com/png.latex?%5Ceta%5E*"> は，指数分布に従う確率変数をシミュレーションすることなどによって得られる（命題 1.5.2）．</p>
</div>
</div>
</div>
</section>
<section id="sec-Poisson-integral" class="level3" data-number="1.8">
<h3 data-number="1.8" class="anchored" data-anchor-id="sec-Poisson-integral"><span class="header-section-number">1.8</span> Poisson 過程に関する積分</h3>
<section id="sec-direct-Poisson-integral" class="level4" data-number="1.8.1">
<h4 data-number="1.8.1" class="anchored" data-anchor-id="sec-direct-Poisson-integral"><span class="header-section-number">1.8.1</span> 直接の積分</h4>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（Poisson 点過程との積分が定まるための条件）^[[@Last_Penrose2017 p.111] 命題12.1 参考．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（Poisson 点過程との積分が定まるための条件）<sup>21</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?(E,%5Cmathcal%7BE%7D,%5Clambda)"> を <img src="https://latex.codecogs.com/png.latex?%5Csigma">-有限な測度空間，<img src="https://latex.codecogs.com/png.latex?%5Ceta"> を <img src="https://latex.codecogs.com/png.latex?E"> 上の強度測度 <img src="https://latex.codecogs.com/png.latex?%5Clambda"> を持つ Poisson 点過程とする．</p>
<p>このとき，<img src="https://latex.codecogs.com/png.latex?f%5Cin%5Cmathcal%7BL%7D(E)_+"> について，次は同値：</p>
<ol type="1">
<li><img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BP%7D%5B(%5Ceta%7Cf)%3C%5Cinfty%5D=1">．</li>
<li>次が成り立つ： <img src="https://latex.codecogs.com/png.latex?%0A%5Cint_E(f%5Cland1)d%5Clambda%3C%5Cinfty.%0A"></li>
</ol>
<p>また，これらの条件が成り立たないとき，<img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BP%7D%5B(%5Ceta%7Cf)=%5Cinfty%5D=1"> が成り立つ．</p>
</div>
</div>
<p>従って，<img src="https://latex.codecogs.com/png.latex?f%5Cin%5Cmathcal%7BL%7D%5E1(%5Clambda)"> に関して，<img src="https://latex.codecogs.com/png.latex?(%5Ceta%7Cf)"> は殆ど確実に有限になる．</p>
</section>
<section id="sec-integral-with-compensator" class="level4" data-number="1.8.2">
<h4 data-number="1.8.2" class="anchored" data-anchor-id="sec-integral-with-compensator"><span class="header-section-number">1.8.2</span> 補過程に関する積分</h4>
<p>加えて，中心化された積分 <img src="https://latex.codecogs.com/png.latex?%0AI(f):=(%5Ceta%7Cf)-(%5Clambda%7Cf)%5Cin%20L%5E2(%5Coperatorname%7BP%7D)%0A"> は <img src="https://latex.codecogs.com/png.latex?L%5E1(%5Clambda)%5Ccap%20L%5E2(%5Clambda)"> 上の等長作用素で，<img src="https://latex.codecogs.com/png.latex?L%5E2(%5Clambda)"> 上に有界延長する．<sup>22</sup></p>
</section>
<section id="poisson-積分の分布" class="level4" data-number="1.8.3">
<h4 data-number="1.8.3" class="anchored" data-anchor-id="poisson-積分の分布"><span class="header-section-number">1.8.3</span> Poisson 積分の分布</h4>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（Poisson 積分の分布）^[[@Sato2013 p.123] 定理19.5 や [@Eberle2012 p.20] 定理1.7 は強度測度 $\lambda$ が有限な場合について述べている，[@Nualart2018 p.164] は補過程に関する積分に関して述べており，そのために追加で$-iu\int_Eh(z)\lambda(dz)$ の項を持つ．．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（Poisson 積分の分布）<sup>23</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?(E,%5Cmathcal%7BE%7D)"> を可測空間，<img src="https://latex.codecogs.com/png.latex?%5Ceta"> を有限な強度測度 <img src="https://latex.codecogs.com/png.latex?%5Clambda"> を持つ Poisson 点過程とする．このとき，<img src="https://latex.codecogs.com/png.latex?%5Ceta"> に関する <img src="https://latex.codecogs.com/png.latex?h%5Cin%5Cmathcal%7BL%7D%5E1(%5Clambda;%5Cmathbb%7BR%7D%5Ed)"> の積分 <img src="https://latex.codecogs.com/png.latex?%0A(%5Ceta%7Ch)(%5Comega)=%5Cint_Eh(z)%5Ceta(%5Comega,dz)%0A"> の第二キュムラント母関数は，次のように表される： <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Cpsi(u)&amp;=%5Cint_E%5Cbiggr(e%5E%7Bi(u%7Ch(z))%7D-1%5Cbiggl)%5Clambda(dz)%5C%5C%0A%20%20%20%20&amp;=%5Cint_%7B%5Cmathbb%7BR%7D%5Ed%7D%5Cbiggr(e%5E%7Bi(u%7Cx)%7D-1%5Cbiggl)(h_*%5Clambda)(dx).%0A%5Cend%7Balign*%7D"> すなわち，<img src="https://latex.codecogs.com/png.latex?(%5Ceta%7Ch)"> は複合 Poisson 分布 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BCP%7D(%5C%7Ch_*%5Clambda%5C%7C_%5Cmathrm%7BTV%7D,%5C%7Ch_*%5Clambda%5C%7C_%5Cmathrm%7BTV%7D%5E%7B-1%7Dh_*%5Clambda)"> に従う，平均 <img src="https://latex.codecogs.com/png.latex?(%5Clambda%7Ch)">，分散 <img src="https://latex.codecogs.com/png.latex?(%5Clambda%7Ch%5E2)"> の確率変数である．</p>
</div>
</div>
</section>
</section>
<section id="poisson-計数過程のシミュレーション" class="level3" data-number="1.9">
<h3 data-number="1.9" class="anchored" data-anchor-id="poisson-計数過程のシミュレーション"><span class="header-section-number">1.9</span> Poisson 計数過程のシミュレーション</h3>
<p><code>yuima</code>パッケージでは，Poisson 計数過程は複合 Poisson 計数過程の特別な場合として扱うため，シミュレーション法は第 2.5 節で扱い，ここでは結果のみを示す．</p>
<section id="一様な-poisson-計数過程" class="level4" data-number="1.9.1">
<h4 data-number="1.9.1" class="anchored" data-anchor-id="一様な-poisson-計数過程"><span class="header-section-number">1.9.1</span> 一様な Poisson 計数過程</h4>
<p>強度 <img src="https://latex.codecogs.com/png.latex?%5Clambda%3E0"> を持つ（一様な） Poisson 計数過程とは，<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D_+"> 上のレート <img src="https://latex.codecogs.com/png.latex?%5Clambda%3E0"> を持つ一様な Poisson 点過程（第 1.5.2 節）<img src="https://latex.codecogs.com/png.latex?%5Ceta"> に対して， <img src="https://latex.codecogs.com/png.latex?%0AN_t(%5Comega):=%5Ceta(%5Comega,%5B0,t%5D)%0A"> で定まる Lévy 過程である．</p>
<p>レート <img src="https://latex.codecogs.com/png.latex?%5Clambda%3E0"> はジャンプの頻度を表している：</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/Process/Poisson_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-nonhomogeneous-Poisson-process" class="level4" data-number="1.9.2">
<h4 data-number="1.9.2" class="anchored" data-anchor-id="sec-nonhomogeneous-Poisson-process"><span class="header-section-number">1.9.2</span> 非一様な Poisson 計数過程</h4>
<p>強度関数 <img src="https://latex.codecogs.com/png.latex?%5Clambda:%5Cmathbb%7BR%7D_+%5Cto%5Cmathbb%7BR%7D%5E+"> を持つ <strong>非一様な Poisson 計数過程</strong> とは，全く同様な定義 <img src="https://latex.codecogs.com/png.latex?%0AN_t(%5Comega):=%5Ceta(%5Comega,%5B0,t%5D)%0A"> をし，ただ <img src="https://latex.codecogs.com/png.latex?%5Ceta"> の強度測度を <img src="https://latex.codecogs.com/png.latex?%5Clambda(t)%5Cell_+(dt)"> に置き換えたものである．</p>
<p>例えば，強度関数 <img src="https://latex.codecogs.com/png.latex?%0A%5Clambda(t)=10e%5E%7B-%5Cfrac%7Bt%7D%7B5%7D%7D%0A"> を持つ非一様な Poisson 過程は次のような見本道を持つ：</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/Process/Poisson_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>時間が経つごとに強度関数 <img src="https://latex.codecogs.com/png.latex?%5Clambda"> の値（赤線）が小さくなり，それに伴ってジャンプの頻度が減少していくことがわかる．</p>
</section>
</section>
</section>
<section id="複合-poisson-過程" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="複合-poisson-過程"><span class="header-section-number">2</span> 複合 Poisson 過程</h2>
<section id="導入-1" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="導入-1"><span class="header-section-number">2.1</span> 導入</h3>
<p>点過程としての複合 Poisson 過程は，印付けられた Poisson 点過程（第 1.6 節）から構成される．</p>
<section id="計数過程として" class="level4" data-number="2.1.1">
<h4 data-number="2.1.1" class="anchored" data-anchor-id="計数過程として"><span class="header-section-number">2.1.1</span> 計数過程として</h4>
<p>Poisson 過程 <img src="https://latex.codecogs.com/png.latex?N"> は，大きさ１の跳躍のみで増加する Lévy 過程として特徴付けられるのであった．</p>
<p>この跳躍の大きさを任意の確率分布 <img src="https://latex.codecogs.com/png.latex?%5Cmu%5Cin%5Cmathcal%7BP%7D(%5Cmathbb%7BR%7D)"> に従ったものに変更したもの <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20M_t&amp;:=%5Csum_%7Bn=1%7D%5E%7BN_t%7DY_n%5C%5C%0A%20%20%20%20&amp;=%5Csum_%7Bk=1%7D%5E%5Ckappa%20Y_k1_%7B%5Cleft%5C%7BX_k%5Cle%20t%5Cright%5C%7D%7D%0A%5Cend%7Balign*%7D"> が <strong>複合 Poisson （計数）過程</strong> <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BCP%7D(%5Clambda,%5Cmu)"> である．<sup>24</sup></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cmu=%5Cdelta_1"> の場合が Poisson 過程に当たる．<sup>25</sup></p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="注（従属操作による見方）^[[@Iacus-Yoshida2018 p.171] 4.8.1 節も参照．]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
注（従属操作による見方）<sup>26</sup>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?Y_n%5Coverset%7B%5Ctext%7Biid%7D%7D%7B%5Csim%7D%5Cmu"> について，これが定めるランダムウォーク <img src="https://latex.codecogs.com/png.latex?%0AS_n:=%5Csum_%7Bk=1%7D%5EnY_k%0A"> を <strong>再起過程</strong> (renewal process) という．<sup>27</sup></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cmu=%5Cmathop%7B%5Cmathrm%7BExp%7D%7D(%5Clambda)"> の場合の再起過程が定める計数過程 <img src="https://latex.codecogs.com/png.latex?%0AN_t:=%5Csum_%7Bn=0%7D%5E%5Cinfty1_%7B%5B0,t%5D%7D(S_n)%0A"> が Poisson 過程なのであった．</p>
<p>これに対して，<img src="https://latex.codecogs.com/png.latex?N_t"> を従属過程とした従属 <img src="https://latex.codecogs.com/png.latex?M_t:=S_%7BN_t%7D"> が複合 Poisson 過程 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BCP%7D(%5Clambda,%5Cmu)"> と理解できる．</p>
</div>
</div>
</div>
</section>
<section id="点過程として" class="level4" data-number="2.1.2">
<h4 data-number="2.1.2" class="anchored" data-anchor-id="点過程として"><span class="header-section-number">2.1.2</span> 点過程として</h4>
<p>この複合 Poisson 過程は，印付けられた Poisson 過程 <img src="https://latex.codecogs.com/png.latex?%0A%5Ceta:=%5Csum_%7Bn=1%7D%5E%5Ckappa%5Cdelta_%7B(X_n,Y_n)%7D%0A"> が <img src="https://latex.codecogs.com/png.latex?E%5Ctimes%5Cmathbb%7BR%7D"> 上の強度測度 <img src="https://latex.codecogs.com/png.latex?%5Cmu%5Cotimes%5Clambda%5Cell"> を持つ Poisson 点過程であり，各 <img src="https://latex.codecogs.com/png.latex?X_n"> に <img src="https://latex.codecogs.com/png.latex?Y_n"> の重みをつけて足し合わせた点過程 <img src="https://latex.codecogs.com/png.latex?%0A%5Cxi(%5Comega,B):=%5Cint_%7BB%5Ctimes%5Cmathbb%7BR%7D%7Dr%5C,%5Ceta(%5Comega,dydr)%0A"> が基になっている．</p>
<p>これが複合 Poisson 点過程であり，<img src="https://latex.codecogs.com/png.latex?%5Cxi"> に関する積分として <img src="https://latex.codecogs.com/png.latex?M"> が理解できる（第 1.8.1 節参照）： <img src="https://latex.codecogs.com/png.latex?%0AM_t(%5Comega)=%5Cxi(%5Comega,%5B0,t%5D)=%5Cint%5Et_0%5Cxi(%5Comega,ds).%0A"></p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="注（Lévy 過程としての複合 Poisson 過程）^[[@Nualart2018 pp.159-160] も参照．]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
注（Lévy 過程としての複合 Poisson 過程）<sup>28</sup>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>一様 Poisson 過程は定数の Lévy 測度 <img src="https://latex.codecogs.com/png.latex?%5Clambda%3E0"> を持つ，特性量 <img src="https://latex.codecogs.com/png.latex?(0,0,%5Clambda%5Cdelta_1)"> が定める Lévy 過程である．</p>
<p>一方で，一様な複合 Poisson 過程 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BCP%7D(%5Clambda,%5Cmu)"> は特性量 <img src="https://latex.codecogs.com/png.latex?(0,0,%5Clambda%5Cmu)"> を持つ Lévy 過程である．</p>
<p>従って，Lévy 測度 <img src="https://latex.codecogs.com/png.latex?%5Cnu"> について，<img src="https://latex.codecogs.com/png.latex?%5C%7C%5Cnu%5C%7C_%5Cmathrm%7BTV%7D"> はジャンプの頻度，<img src="https://latex.codecogs.com/png.latex?%5C%7C%5Cnu%5C%7C_%5Cmathrm%7BTV%7D%5E%7B-1%7D%5Cnu"> がジャンプの分布を表すと言える．</p>
<p>しかし，一般に Lévy 測度は，<img src="https://latex.codecogs.com/png.latex?%5Cleft%5C%7Bz%5Cin%5Cmathbb%7BR%7D%5Ed%5Cmid%5Clvert%20z%5Crvert%3E%5Cepsilon%5Cright%5C%7D"> 上では有限であっても，<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ed%5Csetminus%5C%7B0%5C%7D"> 上で有限とは限らない．<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ed%5Csetminus%5C%7B0%5C%7D"> 上でも有限である場合，跳躍部分は定義 2.4.1 の意味でも複合 Poisson 過程である．</p>
<p>すなわち，有限時区間内では（殆ど確実に）有限回しかジャンプしない純粋跳躍 Lévy 過程は，全て一様な複合 Poisson 計数過程である．<sup>29</sup></p>
<p>一般の Lévy 測度を持つ Lévy 過程は，一様な複合 Poisson 部分を跳躍部分にもつ Lévy 過程の，広義 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BH%7D%5E2">-収束極限として表される．<sup>30</sup></p>
</div>
</div>
</div>
</section>
<section id="複合-poisson-点過程の普遍性" class="level4" data-number="2.1.3">
<h4 data-number="2.1.3" class="anchored" data-anchor-id="複合-poisson-点過程の普遍性"><span class="header-section-number">2.1.3</span> 複合 Poisson 点過程の普遍性</h4>
<p>違いに素な <img src="https://latex.codecogs.com/png.latex?A,B%5Cin%5Cmathcal%7BE%7D"> に対して <img src="https://latex.codecogs.com/png.latex?%5Cxi(A)%5Cperp%5C!%5C!%5C!%5Cperp%5Cxi(B)"> を満たすようなランダム測度 <img src="https://latex.codecogs.com/png.latex?%5Cxi"> は，固定した原子を持たないならば，ある決定論的な測度と複合 Poisson 点過程の和として表せる．<sup>31</sup></p>
</section>
<section id="点過程と計数過程の峻別" class="level4" data-number="2.1.4">
<h4 data-number="2.1.4" class="anchored" data-anchor-id="点過程と計数過程の峻別"><span class="header-section-number">2.1.4</span> 点過程と計数過程の峻別</h4>
<p>ここでも <img src="https://latex.codecogs.com/png.latex?%5Cxi"> と <img src="https://latex.codecogs.com/png.latex?M"> は全く異なる数学的対称であり，区別を要する．</p>
<p>特に，<img src="https://latex.codecogs.com/png.latex?%5Cxi"> は確率核，<img src="https://latex.codecogs.com/png.latex?M"> は Lévy 過程である．</p>
<p>しかし，Lévy 過程に関する確率積分を定義する際，２つの概念は密接に関連する．</p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="Lévy 過程が駆動する確率積分">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Lévy 過程が駆動する確率積分
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>というのも，<img src="https://latex.codecogs.com/png.latex?%5Cxi"> の背後には，拡張された空間 <img src="https://latex.codecogs.com/png.latex?E%5Ctimes%5Cmathbb%7BR%7D%5E+"> 上の Poisson 点過程 <img src="https://latex.codecogs.com/png.latex?%5Ceta"> があり，<img src="https://latex.codecogs.com/png.latex?M"> と <img src="https://latex.codecogs.com/png.latex?%5Ceta"> が密接に関連するのである．</p>
<p><img src="https://latex.codecogs.com/png.latex?M"> に関する確率積分は <img src="https://latex.codecogs.com/png.latex?%0AdM_t=%5Ceta(dzdt)%0A"> と理解でき，<img src="https://latex.codecogs.com/png.latex?%5Ceta"> のランダム測度としての理解が活躍する．</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ceta"> の平均測度は <img src="https://latex.codecogs.com/png.latex?%5Cnu%5Cotimes%5Cell_+"> と表され，この <img src="https://latex.codecogs.com/png.latex?%5Cnu"> を Lévy 測度という．</p>
<p>すなわち，Lévy 過程に関する確率積分とは，Lévy 過程に付随する Poisson 点過程に関する確率積分に他ならない．</p>
</div>
</div>
</div>
</section>
</section>
<section id="複合-poisson-点過程の定義" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="複合-poisson-点過程の定義"><span class="header-section-number">2.2</span> 複合 Poisson 点過程の定義</h3>
<section id="一般的な定義" class="level4" data-number="2.2.1">
<h4 data-number="2.2.1" class="anchored" data-anchor-id="一般的な定義"><span class="header-section-number">2.2.1</span> 一般的な定義</h4>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定義 (compound Poisson process)^[[@Last_Penrose2017 p.153] に倣った．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定義 (compound Poisson process)<sup>32</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?(E,%5Cmathcal%7BE%7D)"> を可測空間とする．<img src="https://latex.codecogs.com/png.latex?E"> 上の <strong>複合 Poisson 分布</strong> とは，<img src="https://latex.codecogs.com/png.latex?E%5Ctimes(%5Cmathbb%7BR%7D%5Csetminus%5C%7B0%5C%7D)"> 上の Poisson 過程 <img src="https://latex.codecogs.com/png.latex?%5Ceta"> を用いて <img src="https://latex.codecogs.com/png.latex?%0A%5Cxi(%5Comega,B)=%5Cint_%7BB%5Ctimes%5Cmathbb%7BR%7D%5Csetminus%5C%7B0%5C%7D%7Dr%5C,%5Ceta(%5Comega,dydr),%0A"> <img src="https://latex.codecogs.com/png.latex?%0AB%5Cin%5Cmathcal%7BE%7D,%0A"> と表せる確率核 <img src="https://latex.codecogs.com/png.latex?%5Cxi:%5COmega%5Cto%20E"> をいう．</p>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?E%5Ctimes%5Cmathbb%7BR%7D%5Csetminus%5C%7B0%5C%7D"> 上の Poisson 点過程 <img src="https://latex.codecogs.com/png.latex?%5Ceta"> の第二成分が，<img src="https://latex.codecogs.com/png.latex?E"> 上のランダム点の「重み」のようなもので，<img src="https://latex.codecogs.com/png.latex?%5Cxi"> は重みをつけて点を積分したものと理解できる．これは一般化された Poisson 複合の手続きに思える．</p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="$\mathbb{R}^d$ 上の複合 Poisson 分布">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ed"> 上の複合 Poisson 分布
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>上述の定義を，<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ed"> 上の分布 <img src="https://latex.codecogs.com/png.latex?%5Cmu%5Cin%5Cmathcal%7BP%7D(%5Cmathbb%7BR%7D%5Ed)"> の Poisson 複合 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BCP%7D(%5Clambda,%5Cmu)%5Cin%5Cmathcal%7BP%7D(%5Cmathbb%7BR%7D%5Ed)"> と比較してみよう．</p>
<p>これは <img src="https://latex.codecogs.com/png.latex?%0AX:=%5Csum_%7Bn=1%7D%5ENZ_n,%5Cqquad%20Z_n%5Coverset%7B%5Ctext%7Biid%7D%7D%7B%5Csim%7D%5Cmu,N%5Csim%5Cmathrm%7BPois%7D(%5Clambda)%0A"> で定まる <img src="https://latex.codecogs.com/png.latex?X"> の分布であり，特性関数は <img src="https://latex.codecogs.com/png.latex?%0A%5Cvarphi_X(u)=%5Cexp%5Cleft(%5Clambda%5Cint_%7B%5Cmathbb%7BR%7D%5Ed%7D%5Cbiggr(e%5E%7Bi(u%7Cy)%7D-1%5Cbiggl)%5Cmu(dy)%5Cright)%0A"> で与えられる．</p>
<p>複合 Poisson 過程はこれを過程に一般化したものであり，Poisson 複合の部分は <img src="https://latex.codecogs.com/png.latex?E%5Ctimes%5Cmathbb%7BR%7D%5E+"> 上の Poisson 点過程の積分として一般化されている．</p>
</div>
</div>
</div>
</section>
<section id="sec-jump-measure-of-Levy-processes" class="level4" data-number="2.2.2">
<h4 data-number="2.2.2" class="anchored" data-anchor-id="sec-jump-measure-of-Levy-processes"><span class="header-section-number">2.2.2</span> ジャンプ時刻とジャンプ幅が独立に決まる場合</h4>
<p>第 1.6 節で扱ったような，（一様とは限らない）Poisson 点過程の独立付印の場合が特に重要なクラスである．</p>
<p>これは，Lévy 過程のジャンプ測度が，このクラスの複合 Poisson 点過程になるためである．<sup>33</sup></p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題 ($\rho_0$-symmetric compound Poisson process with Lévy measure $\nu$)^[[@Last_Penrose2017 p.155] も参照，]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題 (<img src="https://latex.codecogs.com/png.latex?%5Crho_0">-symmetric compound Poisson process with Lévy measure <img src="https://latex.codecogs.com/png.latex?%5Cnu">)<sup>34</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?E%5Ctimes%5Cmathbb%7BR%7D%5E+"> 上の Poisson 点過程 <img src="https://latex.codecogs.com/png.latex?%5Ceta"> の強度測度が <img src="https://latex.codecogs.com/png.latex?%5Clambda=%5Crho_0%5Cotimes%5Cnu"> で表せ，さらに次を満たすとする：</p>
<ol type="1">
<li><img src="https://latex.codecogs.com/png.latex?%5Crho_0%5Cin%5Cmathcal%7BP%7D(E)"> は <img src="https://latex.codecogs.com/png.latex?%5Csigma">-有限．</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Cnu%5Cin%5Cmathcal%7BP%7D(%5Cmathbb%7BR%7D%5E+)"> は <img src="https://latex.codecogs.com/png.latex?%0A%5Cint_0%5E%5Cinfty(r%5Cland1)%5Cnu(dr)%3C%5Cinfty%0A"> を満たす．</li>
</ol>
<p>このとき，次が成り立つ：</p>
<ol type="1">
<li><img src="https://latex.codecogs.com/png.latex?%5Cxi"> は <img src="https://latex.codecogs.com/png.latex?%5Crho_0">-対称である：<img src="https://latex.codecogs.com/png.latex?%5Crho_0(B)=%5Crho_0(B')"> ならば，<img src="https://latex.codecogs.com/png.latex?%5Cxi(B)%5Coverset%7B%5Ctext%7Bd%7D%7D%7B=%7D%5Cxi(B')">．</li>
<li>任意の <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%3E0"> について <img src="https://latex.codecogs.com/png.latex?%5Cnu(%5B%5Cepsilon,%5Cinfty))%3C%5Cinfty">．</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="例（Lévy 過程の跳躍測度）^[[@Nualart2018 p.162] 例9.2.4 を参考．]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
例（Lévy 過程の跳躍測度）<sup>35</sup>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Lévy 測度 <img src="https://latex.codecogs.com/png.latex?%5Cnu"> を持つ Lévy 過程 <img src="https://latex.codecogs.com/png.latex?(L_t)"> を考える．</p>
<p>このとき <img src="https://latex.codecogs.com/png.latex?%5Cnu"> は，<img src="https://latex.codecogs.com/png.latex?%5Cnu(%5C%7B0%5C%7D)=0"> で， <img src="https://latex.codecogs.com/png.latex?%0A%5Cint_%5Cmathbb%7BR%7D(1%5Cland%5Clvert%20z%5Crvert%5E2)%5Cnu(dz)%3C%5Cinfty%0A"> を満たすとされる．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathcal%7BA%7D_%5Cnu:=%5Cleft%5C%7BA%5Cin%5Cmathcal%7BB%7D(%5Cmathbb%7BR%7D%5Csetminus%5C%7B0%5C%7D)%5Cmid%20%5Cnu(A)%3C%5Cinfty%5Cright%5C%7D%0A"> に対して， <img src="https://latex.codecogs.com/png.latex?%0AN(%5Bs,t%5D%5Ctimes%20A):=%5Csum_%7Bs%5Cle%20r%5Cle%20t%7D1_A(%5CDelta%20L_r)%0A"> とすると，時刻 <img src="https://latex.codecogs.com/png.latex?%5Bs,t%5D"> 間の，幅が <img src="https://latex.codecogs.com/png.latex?A%5Cin%5Cmathcal%7BA%7D_%5Cnu"> に入るジャンプの数を表す確率変数となる．</p>
<p>これは <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D_+%5Ctimes%5Cmathbb%7BR%7D%5Csetminus%5C%7B0%5C%7D"> 上の Poisson 点過程に延長し，強度 <img src="https://latex.codecogs.com/png.latex?%5Cell_+%5Cotimes%5Cnu"> を持つ．</p>
<p>すなわち，<img src="https://latex.codecogs.com/png.latex?N"> は Lévy 測度 <img src="https://latex.codecogs.com/png.latex?%5Cnu"> を持つ <img src="https://latex.codecogs.com/png.latex?%5Cell_+">-対称な複合 Poisson 点過程である．この <img src="https://latex.codecogs.com/png.latex?N"> を <strong>跳躍測度</strong> (jump measure) ともいう．<sup>36</sup></p>
<p>Lévy 測度 <img src="https://latex.codecogs.com/png.latex?%5Cnu"> は，単位時間あたり（<img src="https://latex.codecogs.com/png.latex?%5Cell_+"> で測って測度 <img src="https://latex.codecogs.com/png.latex?1"> の集合あたり）の平均ジャンプ数を表す： <img src="https://latex.codecogs.com/png.latex?%0A%5Cnu(A)=%5Coperatorname%7BE%7D%5BN(%5B0,1%5D%5Ctimes%20A)%5D.%0A"></p>
<p>なお，一般の加法過程（非一様 Lévy 過程）に対しても，同様に跳躍測度は <img src="https://latex.codecogs.com/png.latex?(%5Cmathbb%7BR%7D%5Ed%5Csetminus%5C%7B0%5C%7D)%5Ctimes%5Cmathbb%7BR%7D%5E+"> 上の Poisson 点過程になる．<sup>37</sup></p>
</div>
</div>
</div>
</section>
</section>
<section id="複合-poisson-点過程に関する積分" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="複合-poisson-点過程に関する積分"><span class="header-section-number">2.3</span> 複合 Poisson 点過程に関する積分</h3>
<p><img src="https://latex.codecogs.com/png.latex?E"> 上の複合 Poisson 点過程 <img src="https://latex.codecogs.com/png.latex?%5Cxi"> とは，<img src="https://latex.codecogs.com/png.latex?E%5Ctimes%5Cmathbb%7BR%7D%5E+"> 上の Poisson 点過程 <img src="https://latex.codecogs.com/png.latex?%5Ceta"> に他ならないため，Poisson 点過程に関する積分を通じて，<img src="https://latex.codecogs.com/png.latex?f%5Cin%5Cmathcal%7BL%7D(E)"> に関して <img src="https://latex.codecogs.com/png.latex?%0A%5Cint_Ef(z)%5C,%5Cxi(dz)=%5Cint_Erf(y)%5C,%5Ceta(dydr)%0A"> と定義できる．<sup>38</sup></p>
<p>Campbell の定理 1.3 より，<img src="https://latex.codecogs.com/png.latex?(r,z)%5Cmapsto%20rf(z)"> が <img src="https://latex.codecogs.com/png.latex?%5Ceta"> の強度測度 <img src="https://latex.codecogs.com/png.latex?%5Clambda"> に関して可積分ならば，右辺は可積分であるから，<img src="https://latex.codecogs.com/png.latex?(%5Cxi%7Cf)"> も可積分な確率変数を定める．</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="例（Lévy 過程の Lévy-Itô 分解）^[[@Nualart2018 p.164] 例9.3.1，[@Sato2013 p.120] 定理19.2，[@Protter2005 p.31] 定理42 など参照．]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
例（Lévy 過程の Lévy-Itô 分解）<sup>39</sup>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Lévy 過程（一般に加法過程）は，跳躍部分と連続部分との独立和に分解でき，これが Lévy-Itô 分解である．</p>
<p>跳躍部分は，複合 Poisson 点過程 <img src="https://latex.codecogs.com/png.latex?%5Cxi"> （跳躍測度）に関する積分として表せる．</p>
<p>しかし，Lévy 測度は <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ed%5Csetminus%5C%7B0%5C%7D"> 上で有限であるのみで，<img src="https://latex.codecogs.com/png.latex?0"> の近傍で発散する場合がある．これにより，小さなジャンプを繰り返し，純粋なジャンプの和は発散することがある．そのために，<img src="https://latex.codecogs.com/png.latex?0"> の近傍での跳躍部分については，連続部分から項を借りて，中心化された Poisson 積分（第 1.8 節）に関して表示する必要がある．<sup>40</sup></p>
<p>これを実際に見てみよう．<img src="https://latex.codecogs.com/png.latex?L"> を特性量 <img src="https://latex.codecogs.com/png.latex?(%5Cbeta,%5Calpha%5E2,%5Cnu)"> を持つ Lévy 過程，<img src="https://latex.codecogs.com/png.latex?%5Ceta"> を跳躍測度とする．</p>
<ol type="1">
<li><p>強度測度 <img src="https://latex.codecogs.com/png.latex?%5Clambda"> について， <img src="https://latex.codecogs.com/png.latex?%0A%20%20%20%5Cint_%7B%5Cmathbb%7BR%7D%5Ed%7Dz%5C,%5Clambda(dz)%0A%20%20%20"> は <img src="https://latex.codecogs.com/png.latex?0"> の近傍で発散し得るため，単に <img src="https://latex.codecogs.com/png.latex?%0A%20%20%20%5Cint%5Et_0%5Cint_%7B%5Cmathbb%7BR%7D%5Ed%7Dz%5C,%5Ceta(dsdz)%0A%20%20%20"> として跳躍部分を表そうとしても，well-defined とは限らない．</p></li>
<li><p>しかし Lévy 測度は，<img src="https://latex.codecogs.com/png.latex?B%5Ed%5Csubset%5Cmathbb%7BR%7D%5Ed"> を単位閉球として， <img src="https://latex.codecogs.com/png.latex?%0A%20%20%20%20%20%5Cint_%7BB%5Ed%7Dz%5E2%5C,%5Cnu(dz)%3C%5Cinfty%0A%20%20%20%20%20"> は満たすから，中心化された Poisson 積分（第 1.8.2 節） <img src="https://latex.codecogs.com/png.latex?%0A%20%20%20%20%20%5Cint%5Et_0%5Cint_%7BB%5Ed%7Dz%5C,%5Cwidehat%7B%5Ceta%7D(dsdz)%3C%5Cinfty%0A%20%20%20%20%20"> は定義され，<img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BL%7D%5E2(%5Coperatorname%7BP%7D)"> の元である：補過程に関する Poisson 積分の等長性より，<sup>41</sup> <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%20%20%20%20%20%5Coperatorname%7BE%7D%5Cleft%5B%5Cleft(%5Cint%5Et_0%5Cint_%7BB%5Ed%7Dz%5C,%5Cwidehat%7B%5Ceta%7D(dsdz)%5Cright)%5E2%5Cright%5D&amp;=%5Cint%5Et_0%5Cint_%7BB%5Ed%7Dz%5E2%5C,dt%5Clambda(dz)%5C%5C%0A%20%20%20%20%20%20%20%20%20&amp;=t%5Cint_%7BB%5Ed%7Dz%5E2%5C,%5Clambda(dz)%3C%5Cinfty.%0A%20%20%20%20%20%5Cend%7Balign*%7D"></p></li>
<li><p>一方で <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ed%5Csetminus%20B%5Ed"> 上では， <img src="https://latex.codecogs.com/png.latex?%0A%20%20%20%5Cint_%7B%5Cmathbb%7BR%7D%5Ed%5Csetminus%20B%5Ed%7D(z%5Cland1)%5C,%5Cnu(dz)=%5Cnu(%5Cmathbb%7BR%7D%5Ed%5Csetminus%20B%5Ed)%3C%5Cinfty%0A%20%20%20"> であるから，単に <img src="https://latex.codecogs.com/png.latex?%5Ceta"> に関して積分しただけでも，殆ど確実に有限な値を持つ（第 1.8.1 節）．</p></li>
<li><p>以上より，任意の Lévy 過程 <img src="https://latex.codecogs.com/png.latex?L"> は次の分解として常に表示できる： <img src="https://latex.codecogs.com/png.latex?%0A%20%20%20%20%20L_t=%5Cbeta%20t+%5Calpha%20B_t+%5Cint%5Et_0%5Cint_%7BB%5Ed%7Dz%5Cwidehat%7B%5Ceta%7D(dsdz)+%5Cint%5Et_0%5Cint_%7B%5Cleft%5C%7B%5Clvert%20z%5Crvert%3E1%5Cright%5C%7D%7Dz%5Ceta(dsdz).%0A%20%20%20%20%20"> このとき，<img src="https://latex.codecogs.com/png.latex?B%5Cperp%5C!%5C!%5C!%5Cperp%20N"> であり，最後の項は有限和としても表せる： <img src="https://latex.codecogs.com/png.latex?%0A%20%20%20%20%20%5Cint%5Et_0%5Cint_%7B%5Cmathbb%7BR%7D%5Ed%5Csetminus%20B%5Ed%7DzN(dsdz)=%5Csum_%7B0%5Cle%20r%5Cle%20t%7D%5CDelta%20L_r1_%7B%5Cmathbb%7BR%7D%5Ed%5Csetminus%20B%5Ed%7D(%5CDelta%20L_r).%0A%20%20%20%20%20"> この項が有限であることは，Lévy 測度 <img src="https://latex.codecogs.com/png.latex?%5Cnu"> が <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ed%5Csetminus%20B%5Ed"> 上で有限であることによる．</p></li>
<li><p>追加で Lévy 測度 <img src="https://latex.codecogs.com/png.latex?%5Cnu"> が <img src="https://latex.codecogs.com/png.latex?%0A%20%20%20%5Cint_%7BB%5Ed%7D%5Clvert%20z%5Crvert%5C,%5Cnu(dz)%3C%5Cinfty%0A%20%20%20"> も満たすような Lévy 過程（一般には加法過程）<img src="https://latex.codecogs.com/png.latex?L"> については，跳躍部分は <img src="https://latex.codecogs.com/png.latex?%0A%20%20%20L%5E%7B%5Ctext%7Bjump%7D%7D_t:=%5Cint_0%5Et%5Cint_%7B%5Cmathbb%7BR%7D%5Ed%5Csetminus%5C%7B0%5C%7D%7Dz%5C,%5Ceta(dsdz)%0A%20%20%20"> と表せ，<img src="https://latex.codecogs.com/png.latex?L-L%5E%7B%5Ctext%7Bjump%7D%7D"> は連続過程で，<img src="https://latex.codecogs.com/png.latex?L%5E%7B%5Ctext%7Bjump%7D%7D"> と独立である．<sup>42</sup> このような分解ができるとき，<img src="https://latex.codecogs.com/png.latex?L%5E%7B%5Ctext%7Bjump%7D%7D"> を <strong>跳躍部分</strong>，残りを <strong>連続部分</strong> という．</p></li>
</ol>
<p>すなわち，Lévy 過程の中には，無数の小さな跳躍部分が連続部分が相殺しているために収束しているものがあり，そのような場合は明確に跳躍部分と連続部分に分離できないものがある．</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="例（[ショット雑音](https://ja.wikipedia.org/wiki/ショット雑音)）^[[@Last_Penrose2017 p.162] 例15.14 を参考にした．]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
例（<a href="https://ja.wikipedia.org/wiki/ショット雑音">ショット雑音</a>）<sup>43</sup>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>ある <img src="https://latex.codecogs.com/png.latex?%5Cwidetilde%7Bk%7D%5Cin%5Cmathcal%7BL%7D%5E1(%5Cell_d)"> が定める核関数 <img src="https://latex.codecogs.com/png.latex?%0Ak(x,y):=%5Cwidetilde%7Bk%7D(x-y)%0A"> と，ある平均を持つ測度 <img src="https://latex.codecogs.com/png.latex?%5Cnu%5Cin%5Cmathcal%7BM%7D(%5Cmathbb%7BR%7D)"> が定める強度測度 <img src="https://latex.codecogs.com/png.latex?%5Clambda:=%5Cell_d%5Cotimes%5Cnu"> を持つ <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ed%5Ctimes%5Cmathbb%7BR%7D"> 上の Poisson 点過程 <img src="https://latex.codecogs.com/png.latex?%5Ceta"> に関して， <img src="https://latex.codecogs.com/png.latex?%0AY_x:=%5Cint_%7B%5Cmathbb%7BR%7D%5E%7Bd%7D%5Ctimes%5Cmathbb%7BR%7D%7Dr%5Cwidetilde%7Bk%7D(x-y)%5Ceta(dydr)%0A"> で定まる確率場 <img src="https://latex.codecogs.com/png.latex?%5C%7BY_x%5C%7D_%7Bx%5Cin%5Cmathbb%7BR%7D%5Ed%7D"> を，Poisson 過程 <img src="https://latex.codecogs.com/png.latex?%5Ceta"> が駆動する <strong>ショット雑音</strong> という．</p>
</div>
</div>
</div>
</section>
<section id="複合-poisson-計数過程の定義" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="複合-poisson-計数過程の定義"><span class="header-section-number">2.4</span> 複合 Poisson 計数過程の定義</h3>
<p>単に複合 Poisson 過程といった場合，通常，ここでいう一様な複合 Poisson 計数過程を指すことが多い．</p>
<section id="sec-def-uniform-CP" class="level4" data-number="2.4.1">
<h4 data-number="2.4.1" class="anchored" data-anchor-id="sec-def-uniform-CP"><span class="header-section-number">2.4.1</span> 一様な場合</h4>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定義 (compound Poisson processes)^[[@Iacus-Yoshida2018 p.137], p.158，[@Sato2013 p.18] 定理4.3，[@Protter2005 p.33] 例2，[@Baudoin2014-DiffusionProcess p.90] 演習3.44，[@Applebaum2009 p.49] 命題1.3.11 に倣った．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定義 (compound Poisson processes)<sup>44</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Clambda%3E0"> を正数，<img src="https://latex.codecogs.com/png.latex?%5Cmu%5Cin%5Cmathcal%7BP%7D(%5Cmathbb%7BR%7D%5Ed)"> を確率分布とする．一様な <strong>複合 Poisson 過程</strong> <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BCP%7D(%5Clambda,%5Cmu)"> とは，強度 <img src="https://latex.codecogs.com/png.latex?%5Clambda"> を持つ（一様な） Poisson 過程 <img src="https://latex.codecogs.com/png.latex?N"> が定める Lévy 過程 <img src="https://latex.codecogs.com/png.latex?%5C%7BX_t%5C%7D%5Csubset%5Cmathcal%7BL%7D(%5COmega;%5Cmathbb%7BR%7D%5Ed)"> をいう： <img src="https://latex.codecogs.com/png.latex?%0AX_t:=%5Csum_%7Bn=1%7D%5E%7BN_t%7DY_n,%0A"> <img src="https://latex.codecogs.com/png.latex?%0AY_n%5Coverset%7B%5Ctext%7Biid%7D%7D%7B%5Csim%7D%5Cmu.%0A"></p>
</div>
</div>
<p>この <img src="https://latex.codecogs.com/png.latex?X_t"> は Lévy 過程になっており，<img src="https://latex.codecogs.com/png.latex?X_t"> の特性関数は <img src="https://latex.codecogs.com/png.latex?%0A%5Cvarphi(u)=%5Cexp%5Cleft(%5Clambda%20t%5Cint_%7B%5Cmathbb%7BR%7D%5Ed%7D%5Cbiggr(e%5E%7Bi(u%7Cy)%7D-1%5Cbiggl)%5Cmu(dy)%5Cright)%0A"> で表される．<sup>45</sup> すなわち，<img src="https://latex.codecogs.com/png.latex?X_t"> は複合 Poisson 分布 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BCP%7D(%5Clambda%20t,%5Cmu)"> に従う．</p>
</section>
<section id="非一様非有限な場合" class="level4" data-number="2.4.2">
<h4 data-number="2.4.2" class="anchored" data-anchor-id="非一様非有限な場合"><span class="header-section-number">2.4.2</span> 非一様・非有限な場合</h4>
<p>すなわち，複合 Poisson 分布が一様であるとは，背後にある <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ed%5Ctimes%5Cmathbb%7BR%7D_+"> 上の Poisson 点過程が，<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D_+"> 上の一様な Poisson 点過程（第 1.5.2 節）の独立付印過程になっていることをいう（第 1.6 節）．</p>
<p>さらに，Lévy 測度が <img src="https://latex.codecogs.com/png.latex?%5Clambda%5Cmu"> という有限測度になるという重要な仮定も含まれている．</p>
<p>一方で，一般の Lévy 分布の跳躍測度は，<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D_+"> 上の一様な Poisson 点過程に基づくとは限らない（第 2.2.2 節）上に，<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ed%5Csetminus%5C%7B0%5C%7D"> 上有限とも限らない．</p>
<p>このような場合でも，一般の複合 Poisson 点過程 <img src="https://latex.codecogs.com/png.latex?%5Cxi"> を通じて，複合 Poisson 計数過程が <img src="https://latex.codecogs.com/png.latex?%0AM_t(%5Comega):=%5Cxi(%5Comega,%5B0,t%5D)%0A"> と定義できる．</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cxi"> が <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D_+%5Ctimes%5Cmathbb%7BR%7D%5Ed"> 上の Poisson 点過程 <img src="https://latex.codecogs.com/png.latex?%5Ceta"> が定めるものであるとすると， <img src="https://latex.codecogs.com/png.latex?%0AM_t(%5Comega)=%5Cint_0%5Et%5Cint_%7B%5Cmathbb%7BR%7D%5Ed%5Csetminus%5C%7B0%5C%7D%7Dr%5C,%5Ceta(%5Comega,dsdr)%0A"> と表せる．</p>
</section>
</section>
<section id="sec-simulating-CP" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="sec-simulating-CP"><span class="header-section-number">2.5</span> シミュレーション</h3>
<section id="複合-poisson-過程のシミュレーション" class="level4" data-number="2.5.1">
<h4 data-number="2.5.1" class="anchored" data-anchor-id="複合-poisson-過程のシミュレーション"><span class="header-section-number">2.5.1</span> 複合 Poisson 過程のシミュレーション</h4>
<p><code>yuima</code>パッケージには，複合 Poisson 分布専用のコンストラクタ<code>setPoisson</code>が用意されている．このコンストラクタは２つの引数を持つ：</p>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="`setPoisson`の引数^[[@Iacus-Yoshida2018 p.137] 参照．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>setPoisson</code>の引数<sup>46</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>intensity</code>：強度（関数） <img src="https://latex.codecogs.com/png.latex?%5Clambda%3E0"> として用いる変数名を文字列で指定する．</li>
<li><code>df</code>：跳躍測度 <img src="https://latex.codecogs.com/png.latex?%5Cmu%5Cin%5Cmathcal%7BP%7D(%5Cmathbb%7BR%7D%5Ed)"> として用いる分布名を，文字列のリストで指定する．</li>
<li><code>scale=1</code>：<img src="https://latex.codecogs.com/png.latex?%5C%7C%5Cnu%5C%7C_%5Cmathrm%7BTV%7D"> の値のこと．</li>
<li><code>dimension=1</code>：<img src="https://latex.codecogs.com/png.latex?d"> の値．</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="例（一様 Poisson 過程の例）^[[@Iacus-Yoshida2018 pp.137-138] も参照．]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
例（一様 Poisson 過程の例）<sup>47</sup>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Poisson 過程はジャンプの大きさが定数１の複合 Poisson 過程であるから，<code>df</code>としては <img src="https://latex.codecogs.com/png.latex?%5Cdelta_1"> を意味する<code>dconst(z,1)</code>を指定する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(yuima)</span>
<span id="cb1-2"></span>
<span id="cb1-3">mod1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setPoisson</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intensity=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lambda"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">df=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dconst(z,1)"</span>))</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">Terminal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb2-2">samp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setSampling</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Terminal=</span>Terminal, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3000</span>)</span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb2-4">poisson1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">simulate</span>(mod1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">true.par=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lambda=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sampling=</span>samp)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(poisson1)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/Process/Poisson_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="例（正規分布に従う跳躍を持つ複合 Poisson 過程）^[[@Iacus-Yoshida2018 p.139] も参照．]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
例（正規分布に従う跳躍を持つ複合 Poisson 過程）<sup>48</sup>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><code>df</code>として正規分布族<code>dnorm(z,mu,sigma)</code>を指定すれば良い．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">mod2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setPoisson</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intensity=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lambda"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">df=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dnorm(z,mu,sigma)"</span>))</span>
<span id="cb4-2">poisson2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">simulate</span>(mod2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sampling=</span>samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">true.par=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lambda=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mu=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sigma=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span></code></pre></div>
</div>
<p>跳躍分布が <img src="https://latex.codecogs.com/png.latex?%5Cmu=%5Cmathrm%7BN%7D_1(0,2)"> である場合の複合 Poisson 過程をシミュレーションは次のとおり：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(poisson2)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/Process/Poisson_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="複合-poisson-過程が駆動する-lévy-過程のシミュレーション" class="level4" data-number="2.5.2">
<h4 data-number="2.5.2" class="anchored" data-anchor-id="複合-poisson-過程が駆動する-lévy-過程のシミュレーション"><span class="header-section-number">2.5.2</span> 複合 Poisson 過程が駆動する Lévy 過程のシミュレーション</h4>
<p>この場合は<code>setModel</code>内でモデルを定義する．</p>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="`setModel`の引数^[Lévy 過程が駆動する SDE モデルの定義方法は [@Iacus-Yoshida2018 p.191] 4.11.3 節を参照．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>setModel</code>の引数<sup>49</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>jump.coeff</code>：<img src="https://latex.codecogs.com/png.latex?dM_t"> 項の係数を，文字列のベクトルで指定する．</li>
<li><code>measure.type</code>：<code>CP</code>と指定することで，<code>measure</code>引数が複合 Poisson 過程 <img src="https://latex.codecogs.com/png.latex?M"> に付随する Poisson 点過程 <img src="https://latex.codecogs.com/png.latex?%5Ceta"> の強度測度と解釈される．</li>
<li><code>measure</code>：<img src="https://latex.codecogs.com/png.latex?%5Ceta"> の強度測度 <img src="https://latex.codecogs.com/png.latex?%5Clambda%5Cotimes%5Cnu"> を，<code>intensity</code>と<code>df</code>のリストとして指定する．</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="例（複合 Poisson 跳躍を持つ Lévy 過程）^[[@Iacus-Yoshida2018 p.191] 参照．]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-32-contents" aria-controls="callout-32" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
例（複合 Poisson 跳躍を持つ Lévy 過程）<sup>50</sup>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-32" class="callout-32-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>複合 Poisson 過程 <img src="https://latex.codecogs.com/png.latex?M%5Csim%5Cmathrm%7BCP%7D(%5Clambda,%5Cmathrm%7BN%7D(2,0.1))"> が定める SDE <img src="https://latex.codecogs.com/png.latex?%0AdX_t=-%5Ctheta%20X_tdt+%5Csigma%20dB_t+%5Cleft(%5Cgamma+%5Cfrac%7BX_%7Bt-%7D%7D%7B%5Csqrt%7B1+X%5E2_%7Bt-%7D%7D%7D%5Cright)dM_t%0A"> <img src="https://latex.codecogs.com/png.latex?%0AX_0=0%0A"> は次のように定義する：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">modJump <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setModel</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">drift =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-theta*x"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">diffusion =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sigma"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">jump.coeff=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gamma+x/sqrt(1+x^2)"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intensity=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lambda"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">df=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dnorm(z, -3, 1)"</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure.type=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CP"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">solve.variable=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>)</span>
<span id="cb6-2"></span>
<span id="cb6-3">samp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setSampling</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Terminal=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb6-4"></span>
<span id="cb6-5">X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">simulate</span>(modJump, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xinit=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sampling=</span>samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">true.par=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theta=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sigma=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gamma=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lambda=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>))</span>
<span id="cb6-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(X)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/Process/Poisson_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="gamma-過程" class="level3" data-number="2.6">
<h3 data-number="2.6" class="anchored" data-anchor-id="gamma-過程"><span class="header-section-number">2.6</span> Gamma 過程</h3>
<p>Gamma 計数過程は，跳躍のみによって増大する Lévy 過程であるが，その強度測度は <img src="https://latex.codecogs.com/png.latex?%5Cnu((0,%5Cinfty%5D)=%5Cinfty"> を満たし，<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D_+"> の稠密部分集合上でジャンプしており，見本道は殆ど確実に非連続である．</p>
<p>これはもはや，定義 2.4.1 の意味では，一様な複合 Poisson 計数過程ではなく，次節でいう B 型の Lévy 過程に分類される：</p>
<div class="article-card-container">
  <div class="article-card">
    <a href="https://162348.github.io/posts/2024/Process/Levy.html" target="_blank">
      <img src="https://raw.githubusercontent.com/162348/162348.github.io/main/thumbnail.svg" alt="Article Image" class="article-image">
      <div class="article-content">
        <h3 class="article-title anchored">Lévy 過程を見てみよう</h3>
        <p class="article-description">YUIMA パッケージを用いたシミュレーションを通じて</p>
      </div>
    </a>
  </div>
</div>
<section id="gamma-点過程" class="level4" data-number="2.6.1">
<h4 data-number="2.6.1" class="anchored" data-anchor-id="gamma-点過程"><span class="header-section-number">2.6.1</span> Gamma 点過程</h4>
<p><img src="https://latex.codecogs.com/png.latex?%5Csigma">-有限測度 <img src="https://latex.codecogs.com/png.latex?%5Crho_0%5Cin%5Cmathcal%7BP%7D(E)"> と Lévy 測度 <img src="https://latex.codecogs.com/png.latex?%5Cnu:=%5Cmathrm%7BGamma%7D(b,0)">，すなわち <img src="https://latex.codecogs.com/png.latex?%0A%5Cnu(dr):=%5Cfrac%7Be%5E%7B-br%7D%7D%7Br%7Ddr%0A"> について，<img src="https://latex.codecogs.com/png.latex?%5Clambda:=%5Crho_0%5Cotimes%5Cnu"> で定まる強度測度を持つ <img src="https://latex.codecogs.com/png.latex?E%5Ctimes%5Cmathbb%7BR%7D_+"> 上の Poisson 点過程 <img src="https://latex.codecogs.com/png.latex?%5Cxi"> を <strong>Gamma 点過程</strong> という．<sup>51</sup></p>
<p>これは <img src="https://latex.codecogs.com/png.latex?%0A%5Cxi(B)%5Csim%5Cmathrm%7BGamma%7D(b,%5Crho_0(B))%0A"> を満たす複合 Poisson 点過程である．<img src="https://latex.codecogs.com/png.latex?%5Crho_0"> のことを形状測度ともいう．</p>
</section>
<section id="gamma-点過程の-lévy-測度-0-の近傍で発散する" class="level4" data-number="2.6.2">
<h4 data-number="2.6.2" class="anchored" data-anchor-id="gamma-点過程の-lévy-測度-0-の近傍で発散する"><span class="header-section-number">2.6.2</span> Gamma 点過程の Lévy 測度 <img src="https://latex.codecogs.com/png.latex?0"> の近傍で発散する</h4>
<p>しかし，<img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BGamma%7D(b,0)"> などという分布はなく， <img src="https://latex.codecogs.com/png.latex?%0A%5Cint%5E%5Cinfty_0r%5E%7B-1%7De%5E%7B-br%7Ddr=%5Cinfty.%0A"></p>
<p>このとき，任意の <img src="https://latex.codecogs.com/png.latex?%5Crho_0"> で測って正の測度を持つ集合 <img src="https://latex.codecogs.com/png.latex?%5Crho_0(B)%3E0%5C;(B%5Cin%5Cmathcal%7BE%7D)"> に対して，<img src="https://latex.codecogs.com/png.latex?%5Cxi(B)=%5Cinfty%5C;%5C;%5Ctext%7Ba.s.%7D"> が成り立つ．<sup>52</sup></p>
</section>
<section id="gamma-計数過程" class="level4" data-number="2.6.3">
<h4 data-number="2.6.3" class="anchored" data-anchor-id="gamma-計数過程"><span class="header-section-number">2.6.3</span> Gamma 計数過程</h4>
<p>一般に，<img src="https://latex.codecogs.com/png.latex?%5Cxi"> を <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5E+"> 上の Lévy 測度 <img src="https://latex.codecogs.com/png.latex?%5Cnu%5Cin%5Cmathcal%7BP%7D(%5Cmathbb%7BR%7D%5E+)"> を持つ一様な複合 Poisson 点過程，すなわち <img src="https://latex.codecogs.com/png.latex?%5Cell_+%5Cotimes%5Cnu"> を強度測度とする <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D_+%5Ctimes%5Cmathbb%7BR%7D%5E+"> 上の Poisson 点過程とすると， <img src="https://latex.codecogs.com/png.latex?%0AY_t(%5Comega):=%5Cxi(%5Comega,%5B0,t%5D)%0A"> で定まる過程 <img src="https://latex.codecogs.com/png.latex?Y"> は，一般に Lévy 測度 <img src="https://latex.codecogs.com/png.latex?%5Cnu"> を持つ <strong>従属過程</strong> (subordinator) という．<sup>53</sup></p>
<p>Lévy 測度 <img src="https://latex.codecogs.com/png.latex?%5Cnu%5Cin%5Cmathcal%7BP%7D(%5Cmathbb%7BR%7D%5E+)"> を <img src="https://latex.codecogs.com/png.latex?%0A%5Cnu(dr):=%5Cdelta%5Cfrac%7Be%5E%7B-%5Cgamma%20r%7D%7D%7Br%7Ddr%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Cdelta,%5Cgamma%3E0,%0A"> で与えたとき，付随する従属過程 <img src="https://latex.codecogs.com/png.latex?%5C%7BY_t%5C%7D"> を <strong>Gamma 過程</strong> といい，<img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BGamma%7D(%5Cdelta,%5Cgamma)"> で表す．<sup>54</sup></p>
<p>これは <img src="https://latex.codecogs.com/png.latex?Y_t%5Csim%5Cmathrm%7BGamma%7D(%5Cdelta,%5Cgamma%20t)"> を満たす Lévy 過程である．</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/Process/Poisson_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>目視できないジャンプが無数に存在することが窺える．</p>
<!-- ```{R}
#| echo: false
#| warning: false
samp <- setSampling(Terminal=1, n=10000)
Gyuima <- setYuima(model=Gmodel, sampling=samp)
result <- simulate(Gyuima)
plot(result,xlim=c(0,0.1),ylim=c(-0.05,0.05), main="Paths of gamma process")
``` -->
</section>
<section id="分散-gamma-過程" class="level4" data-number="2.6.4">
<h4 data-number="2.6.4" class="anchored" data-anchor-id="分散-gamma-過程"><span class="header-section-number">2.6.4</span> 分散 Gamma 過程</h4>
<p>２つの独立な Gamma 過程 <img src="https://latex.codecogs.com/png.latex?%0AX%5E+%5Csim%5Cmathrm%7BGamma%7D(%5Cdelta,%5Cgamma%5E-),X%5E-%5Csim%5Cmathrm%7BGamma%7D(%5Cdelta,%5Cgamma%5E+)%0A"> に対して， <img src="https://latex.codecogs.com/png.latex?%0AX%5E0_t=X%5E+_t-X%5E-_t%0A"> と表せる Lévy 過程 <img src="https://latex.codecogs.com/png.latex?X%5E0"> を <a href="https://en.wikipedia.org/wiki/Variance_gamma_process"><strong>分散 Gamma 過程</strong></a> という．<sup>55</sup></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/Process/Poisson_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>分散 Gamma 過程は，オプション価格の対数のモデルとして，Brown 運動より柔軟なモデルとしても用いられる <span class="citation" data-cites="Madan+1998">(Madan et al., 1998)</span>．</p>



</section>
</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-Applebaum2009" class="csl-entry">
Applebaum, D. (2009). <em>Lévy processes and stochastic calculus</em> (2nd ed., Vol. 116). Cambridge University Press. <a href="https://www.cambridge.org/core/books/levy-processes-and-stochastic-calculus/4AC698D37D3D8E57D099B73ADF4ACB11">https://www.cambridge.org/core/books/levy-processes-and-stochastic-calculus/4AC698D37D3D8E57D099B73ADF4ACB11</a>
</div>
<div id="ref-Baudoin2014-DiffusionProcess" class="csl-entry">
Baudoin, F. (2014). <em>Diffusion processes and stochastic calculus</em> (Vol. 16). European Mathematical Society.
</div>
<div id="ref-Campbell1909" class="csl-entry">
Campbell, N. (1909). The study of discontinuous phenomena. <em>Proc Cambr. Phil. Soc</em>, <em>vol. 15</em>, pp. 117–136.
</div>
<div id="ref-Chopin-Papaspiliopoulos20-SMC" class="csl-entry">
Chopin, N., &amp; Papaspiliopoulos, O. (2020). <em>An introduction to sequential monte carlo</em>. Springer Cham.
</div>
<div id="ref-Cox1955" class="csl-entry">
Cox, D. R. (1955). Some statistical methods connected with series of events. <em>Journal of the Royal Statistical Society: Series B (Methodological)</em>, <em>17</em>(2), 129–157. https://doi.org/<a href="https://doi.org/10.1111/j.2517-6161.1955.tb00188.x">https://doi.org/10.1111/j.2517-6161.1955.tb00188.x</a>
</div>
<div id="ref-Eberle2012" class="csl-entry">
Eberle, A. (2012). <em>Stochastic analysis</em>. <a href="https://wt.iam.uni-bonn.de/fileadmin/WT/Inhalt/people/Andreas_Eberle/StoAn1112/StochasticAnalysisFinal.pdf">https://wt.iam.uni-bonn.de/fileadmin/WT/Inhalt/people/Andreas_Eberle/StoAn1112/StochasticAnalysisFinal.pdf</a>
</div>
<div id="ref-Iacus-Yoshida2018" class="csl-entry">
Iacus, S. M., &amp; Yoshida, N. (2018). <em>Simulation and inference for stochastic processes with YUIMA: A comprehensive r framework for SDEs and other stochastic processes</em>. Springer Cham. <a href="https://doi.org/10.1007/978-3-319-55569-0">https://doi.org/10.1007/978-3-319-55569-0</a>
</div>
<div id="ref-Kallenberg2017" class="csl-entry">
Kallenberg, O. (2017). <em>Random measures, theory and applications</em> (Vol. 77). Springer Cham.
</div>
<div id="ref-Kingman1992" class="csl-entry">
Kingman, J. F. C. (1992). <em><a href="">Poisson processes</a></em>. Clarendon Press.
</div>
<div id="ref-Kingman2006" class="csl-entry">
Kingman, J. F. C. (2006). <span>Poisson Processes Revisited</span>. <em>Probability and Mathematical Statistics</em>, <em>26</em>(1), 77–95. <a href="http://yadda.icm.edu.pl/baztech/element/bwmeta1.element.baztech-66de0dee-771a-4cf4-bc02-57f689661a36">http://yadda.icm.edu.pl/baztech/element/bwmeta1.element.baztech-66de0dee-771a-4cf4-bc02-57f689661a36</a>
</div>
<div id="ref-Last_Penrose2017" class="csl-entry">
Last, G., &amp; Penrose, M. (2017). <em>Lectures on the poisson process</em>. Cambridge University Press.
</div>
<div id="ref-Lewis-Shedler1979" class="csl-entry">
Lewis, P. A. W., &amp; Shedler, G. S. (1979). Simulation of nonhomogeneous poisson processes by thinning. <em>Naval Research Logistics Quarterly</em>, <em>26</em>(3), 403–413. <a href="https://doi.org/10.1002/nav.3800260304">https://doi.org/10.1002/nav.3800260304</a>
</div>
<div id="ref-Madan+1998" class="csl-entry">
Madan, D. B., Carr, P. P., &amp; Chang, E. C. (1998). <span class="nocase">The Variance Gamma Process and Option Pricing</span>. <em>Review of Finance</em>, <em>2</em>(1), 79–105. <a href="https://doi.org/10.1023/A:1009703431535">https://doi.org/10.1023/A:1009703431535</a>
</div>
<div id="ref-Mitov-Omey2014" class="csl-entry">
Mitov, K. V., &amp; Omey, E. (2014). <em>Renewal processes</em>. Springer Cham. <a href="https://doi.org/10.1007/978-3-319-05855-9">https://doi.org/10.1007/978-3-319-05855-9</a>
</div>
<div id="ref-Nualart2018" class="csl-entry">
Nualart, D., &amp; Nualart, E. (2018). <em>Introduction to malliavin calculus</em> (Vol. 8). Cambridge University Press. <a href="https://doi.org/10.1017/9781139856485">https://doi.org/10.1017/9781139856485</a>
</div>
<div id="ref-Nummelin1984" class="csl-entry">
Nummelin, E. (1984). <em><span class="nocase">General Irreducible Markov Chains and Non-Negative Operators</span></em> (Vol. 83). Cambridge University Press. <a href="https://doi.org/10.1017/CBO9780511526237">https://doi.org/10.1017/CBO9780511526237</a>
</div>
<div id="ref-Ogata1981" class="csl-entry">
Ogata, Y. (1981). On lewis’ simulation method for point processes. <em>IEEE Transactions on Information Theory</em>, <em>27</em>(1), 23–31. <a href="https://doi.org/10.1109/TIT.1981.1056305">https://doi.org/10.1109/TIT.1981.1056305</a>
</div>
<div id="ref-Protter2005" class="csl-entry">
Protter, P. E. (2005). <em>Stochastic integration and differential equations</em> (2nd ed., Vol. 2). Springer Berlin, Heidelberg. <a href="https://link.springer.com/book/10.1007/978-3-662-10061-5">https://link.springer.com/book/10.1007/978-3-662-10061-5</a>
</div>
<div id="ref-Resnick2002" class="csl-entry">
Resnick, S. I. (2002). <em>Adventures in stochastic processes</em>. Birkhäuser Boston. <a href="https://doi.org/10.1007/978-1-4612-0387-2">https://doi.org/10.1007/978-1-4612-0387-2</a>
</div>
<div id="ref-Revuz-Yor1999" class="csl-entry">
Revuz, D., &amp; Yor, M. (1999). <em>Continuous martingales and brownian motion</em> (3rd ed.). Springer Berlin, Heidelberg.
</div>
<div id="ref-Sato2013" class="csl-entry">
Sato, K. (2013). <em><a href="">Lévy processes and infinitely divisible distributions</a></em> (2nd ed.). Cambridge University Press.
</div>
<div id="ref-Todorovic-Yevjevich1969" class="csl-entry">
Todorovic, P., &amp; Yevjevich, V. (1969). Stochastic process of precipitation. In <em>Hydrology Papers</em>. Colorado State University.
</div>
<div id="ref-伊藤清1991" class="csl-entry">
伊藤清. (1991). <em>確率論</em> (2nd ed.). 岩波書店.
</div>
<div id="ref-西村克己-江藤剛治1981" class="csl-entry">
西村克己, &amp; 江藤剛治. (1981). Marked point Processモデルによる降水量時系列の解析. <em>水理講演会論文集</em>, <em>25</em>, 191–196. <a href="https://doi.org/10.2208/prohe1975.25.191">https://doi.org/10.2208/prohe1975.25.191</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><span class="citation" data-cites="Nualart2018">(Nualart &amp; Nualart, 2018, p. 159)</span> 例9.1.3，<span class="citation" data-cites="Revuz-Yor1999">(Revuz &amp; Yor, 1999, p. 471)</span> 定義XII.1.3 などは，Poisson 計数過程の方を Poisson 過程と呼んでおり，<span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017)</span> などは Poisson 点過程の方を Poisson 過程と呼んでいる．<span class="citation" data-cites="Eberle2012">(Eberle, 2012, p. 18)</span> では，ここでは点過程とランダム測度を混用しているが，この２つを使い分けている．↩︎</p></li>
<li id="fn2"><p><span class="citation" data-cites="Revuz-Yor1999">(Revuz &amp; Yor, 1999, p. 472)</span> 命題XII.1.4など．↩︎</p></li>
<li id="fn3"><p><span class="citation" data-cites="Kallenberg2017">(Kallenberg, 2017, p. 49)</span>，<span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 11)</span> 定義2.1 に倣った．全く同じ概念を <span class="citation" data-cites="伊藤清1991">(伊藤清, 1991, p. 298)</span> は <strong>偶然配置</strong> と呼ぶ．↩︎</p></li>
<li id="fn4"><p><span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 48)</span> 系6.5 を参照．↩︎</p></li>
<li id="fn5"><p><span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 129)</span> 定義13.5 に倣った．↩︎</p></li>
<li id="fn6"><p><span class="citation" data-cites="伊藤清1991">(伊藤清, 1991, p. 298)</span> に倣った．↩︎</p></li>
<li id="fn7"><p><span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 13)</span> 命題2.7 に倣った．<span class="citation" data-cites="Campbell1909">(Campbell, 1909)</span> は元々真空管内の <a href="https://ja.wikipedia.org/wiki/ショット雑音">shot noise</a> の研究をしていた．結果の一部は G. H. Hardy にもよるという．↩︎</p></li>
<li id="fn8"><p><span class="citation" data-cites="Nualart2018">(Nualart &amp; Nualart, 2018, p. 160)</span> 定義9.2.1，<span class="citation" data-cites="Sato2013">(Sato, 2013, p. 119)</span> 第4章19節，<span class="citation" data-cites="Resnick2002">(Resnick, 2002, p. 303)</span>，<span class="citation" data-cites="Sato2013">(Sato, 2013, p. 119)</span> 定義19.1，<span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 19)</span> 定義3.1 に倣った．↩︎</p></li>
<li id="fn9"><p><span class="citation" data-cites="Revuz-Yor1999">(Revuz &amp; Yor, 1999, p. 476)</span> 命題 XII.1.12，<span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 20)</span> 命題3.2 はより一般的な状況で示している．↩︎</p></li>
<li id="fn10"><p><span class="citation" data-cites="Nualart2018">(Nualart &amp; Nualart, 2018, p. 160)</span> 定理9.2.2 では，<img src="https://latex.codecogs.com/png.latex?%5Clambda"> はアトムを持たないとし，<img src="https://latex.codecogs.com/png.latex?E"> を Polish 空間として示している．<span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 22)</span> 系3.7 はここよりも一般的な設定で示している．↩︎</p></li>
<li id="fn11"><p><span class="citation" data-cites="Eberle2012">(Eberle, 2012, p. 19)</span> 定理1.6も参照．↩︎</p></li>
<li id="fn12"><p>逆に，指数分布のシミュレーションにより，一様分布の順序統計量が効率的にシミュレーションできる．このことは粒子フィルターにおけるリサンプリングに応用できる．<span class="citation" data-cites="Chopin-Papaspiliopoulos20-SMC">(Chopin &amp; Papaspiliopoulos, 2020, p. 113)</span> 命題9.1も参照．↩︎</p></li>
<li id="fn13"><p><img src="https://latex.codecogs.com/png.latex?%5Cpi=%5Cdelta_m"> であるとき，<img src="https://latex.codecogs.com/png.latex?%5Ceta"> を単に二項（点）過程という．これは <img src="https://latex.codecogs.com/png.latex?%5Ceta(B)%5Csim%5Cmathrm%7BBin%7D(m,%5Cmu(B))"> が成り立つためである．<span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 20)</span> 定義3.4も参照．↩︎</p></li>
<li id="fn14"><p><span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 23)</span> 命題3.8も参照．↩︎</p></li>
<li id="fn15"><p><span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 59)</span> 定理7.2参照．↩︎</p></li>
<li id="fn16"><p><span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 40)</span> 定義5.3 に倣った．<span class="citation" data-cites="Kingman1992">(Kingman, 1992, p. 55)</span> 5.2節も参照．↩︎</p></li>
<li id="fn17"><p>例えば <span class="citation" data-cites="Kingman1992">(Kingman, 1992, p. 55)</span>，<span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 42)</span> 命題5.5 を参照．↩︎</p></li>
<li id="fn18"><p>日本語文献としては，<span class="citation" data-cites="西村克己-江藤剛治1981">(西村克己 &amp; 江藤剛治, 1981)</span> も参照．↩︎</p></li>
<li id="fn19"><p><span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 43)</span> 定義5.7 に従った．↩︎</p></li>
<li id="fn20"><p><span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 44)</span> 系5.9 参照．↩︎</p></li>
<li id="fn21"><p><span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 111)</span> 命題12.1 参考．↩︎</p></li>
<li id="fn22"><p><span class="citation" data-cites="Nualart2018">(Nualart &amp; Nualart, 2018, p. 163)</span> 9.3節，<span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 113)</span> 命題12.4 など．↩︎</p></li>
<li id="fn23"><p><span class="citation" data-cites="Sato2013">(Sato, 2013, p. 123)</span> 定理19.5 や <span class="citation" data-cites="Eberle2012">(Eberle, 2012, p. 20)</span> 定理1.7 は強度測度 <img src="https://latex.codecogs.com/png.latex?%5Clambda"> が有限な場合について述べている，<span class="citation" data-cites="Nualart2018">(Nualart &amp; Nualart, 2018, p. 164)</span> は補過程に関する積分に関して述べており，そのために追加で<img src="https://latex.codecogs.com/png.latex?-iu%5Cint_Eh(z)%5Clambda(dz)"> の項を持つ．．↩︎</p></li>
<li id="fn24"><p><span class="citation" data-cites="Nualart2018">(Nualart &amp; Nualart, 2018, p. 159)</span> 例9.1.4，<span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 155)</span> 例15.5 など．↩︎</p></li>
<li id="fn25"><p><span class="citation" data-cites="Applebaum2009">(Applebaum, 2009, p. 50)</span> も参照．↩︎</p></li>
<li id="fn26"><p><span class="citation" data-cites="Iacus-Yoshida2018">(Iacus &amp; Yoshida, 2018, p. 171)</span> 4.8.1 節も参照．↩︎</p></li>
<li id="fn27"><p><span class="citation" data-cites="Resnick2002">(Resnick, 2002, p. 174)</span>，<span class="citation" data-cites="Mitov-Omey2014">(Mitov &amp; Omey, 2014, p. 1)</span>，<span class="citation" data-cites="Nummelin1984">(Nummelin, 1984, p. 49)</span> 定義4.2 などに倣った．↩︎</p></li>
<li id="fn28"><p><span class="citation" data-cites="Nualart2018">(Nualart &amp; Nualart, 2018, pp. 159–160)</span> も参照．↩︎</p></li>
<li id="fn29"><p><img src="https://latex.codecogs.com/png.latex?%5Cleft%5C%7Bz%5Cin%5Cmathbb%7BR%7D%5Ed%5Cmid%5Clvert%20z%5Crvert%3E%5Cepsilon%5Cright%5C%7D"> 上で有限でないと，これを Lévy 測度にもつ Lévy 過程は存在しない．<span class="citation" data-cites="Eberle2012">(Eberle, 2012, p. 20)</span> 定理1.7も参照．↩︎</p></li>
<li id="fn30"><p><span class="citation" data-cites="Eberle2012">(Eberle, 2012, p. 26)</span> 定理1.10 も参照．↩︎</p></li>
<li id="fn31"><p><span class="citation" data-cites="Kingman1992">(Kingman, 1992, p. 79)</span> 第８章，<span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017)</span> 第 15.3 節参照．↩︎</p></li>
<li id="fn32"><p><span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 153)</span> に倣った．↩︎</p></li>
<li id="fn33"><p>一様じゃない Lévy 過程，すなわち加法過程の場合は，<img src="https://latex.codecogs.com/png.latex?%5Clambda((0,t%5D%5Ctimes%20B)=%5Cnu_t(B)"> という関係にある．これはもはや独立付印ではないが，やはり印付きの Poisson 過程が肝心であることは変わらない．↩︎</p></li>
<li id="fn34"><p><span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 155)</span> も参照，↩︎</p></li>
<li id="fn35"><p><span class="citation" data-cites="Nualart2018">(Nualart &amp; Nualart, 2018, p. 162)</span> 例9.2.4 を参考．↩︎</p></li>
<li id="fn36"><p><span class="citation" data-cites="Nualart2018">(Nualart &amp; Nualart, 2018, p. 162)</span> 例9.2.4 による用語法．<img src="https://latex.codecogs.com/png.latex?N"> をランダム測度として跳躍測度と呼んでいる．↩︎</p></li>
<li id="fn37"><p><span class="citation" data-cites="Sato2013">(Sato, 2013, p. 120)</span> 定理19.2(i) を参照．↩︎</p></li>
<li id="fn38"><p><span class="citation" data-cites="Nualart2018">(Nualart &amp; Nualart, 2018, p. 164)</span> 例9.3.1，<span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 161)</span> 15.4節なども参照．↩︎</p></li>
<li id="fn39"><p><span class="citation" data-cites="Nualart2018">(Nualart &amp; Nualart, 2018, p. 164)</span> 例9.3.1，<span class="citation" data-cites="Sato2013">(Sato, 2013, p. 120)</span> 定理19.2，<span class="citation" data-cites="Protter2005">(Protter, 2005, p. 31)</span> 定理42 など参照．↩︎</p></li>
<li id="fn40"><p><span class="citation" data-cites="Sato2013">(Sato, 2013, p. 119)</span> が指摘するように，まるで Cauchy の主値積分である．↩︎</p></li>
<li id="fn41"><p>ただし，<img src="https://latex.codecogs.com/png.latex?%5Cwidehat%7B%5Ceta%7D(%5B0,t%5D%5Ctimes%20A):=%5Ceta(%5B0,t%5D%5Ctimes%20A)-t%5Cnu(A)"> を中心化した Poisson 過程とした．これを <strong>Poisson 補過程</strong> (compensated Poisson process) ともいう．↩︎</p></li>
<li id="fn42"><p><span class="citation" data-cites="Sato2013">(Sato, 2013, p. 121)</span> 定理19.3 も参照．↩︎</p></li>
<li id="fn43"><p><span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 162)</span> 例15.14 を参考にした．↩︎</p></li>
<li id="fn44"><p><span class="citation" data-cites="Iacus-Yoshida2018">(Iacus &amp; Yoshida, 2018, p. 137)</span>, p.158，<span class="citation" data-cites="Sato2013">(Sato, 2013, p. 18)</span> 定理4.3，<span class="citation" data-cites="Protter2005">(Protter, 2005, p. 33)</span> 例2，<span class="citation" data-cites="Baudoin2014-DiffusionProcess">(Baudoin, 2014, p. 90)</span> 演習3.44，<span class="citation" data-cites="Applebaum2009">(Applebaum, 2009, p. 49)</span> 命題1.3.11 に倣った．↩︎</p></li>
<li id="fn45"><p><span class="citation" data-cites="Sato2013">(Sato, 2013, p. 20)</span> 命題4.5など参照．↩︎</p></li>
<li id="fn46"><p><span class="citation" data-cites="Iacus-Yoshida2018">(Iacus &amp; Yoshida, 2018, p. 137)</span> 参照．↩︎</p></li>
<li id="fn47"><p><span class="citation" data-cites="Iacus-Yoshida2018">(Iacus &amp; Yoshida, 2018, pp. 137–138)</span> も参照．↩︎</p></li>
<li id="fn48"><p><span class="citation" data-cites="Iacus-Yoshida2018">(Iacus &amp; Yoshida, 2018, p. 139)</span> も参照．↩︎</p></li>
<li id="fn49"><p>Lévy 過程が駆動する SDE モデルの定義方法は <span class="citation" data-cites="Iacus-Yoshida2018">(Iacus &amp; Yoshida, 2018, p. 191)</span> 4.11.3 節を参照．↩︎</p></li>
<li id="fn50"><p><span class="citation" data-cites="Iacus-Yoshida2018">(Iacus &amp; Yoshida, 2018, p. 191)</span> 参照．↩︎</p></li>
<li id="fn51"><p>定義は <span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 155)</span> 例15.6 に倣った．↩︎</p></li>
<li id="fn52"><p>強度測度 <img src="https://latex.codecogs.com/png.latex?%5Clambda"> は <img src="https://latex.codecogs.com/png.latex?%5Csigma">-有限でないので，命題 1.8 の拡張を用いる必要がある．<span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 163)</span> 演習15.2も参照．↩︎</p></li>
<li id="fn53"><p><span class="citation" data-cites="Kingman1992">(Kingman, 1992, p. 88)</span> 8.4節，<span class="citation" data-cites="Last_Penrose2017">(Last &amp; Penrose, 2017, p. 156)</span> 例15.7 などの用語法．一般に subordinator とは，単調増加な Lévy 過程をいう <span class="citation" data-cites="Sato2013">(Sato, 2013, p. 137)</span> 定義21.4，<span class="citation" data-cites="Baudoin2014-DiffusionProcess">(Baudoin, 2014, p. 95)</span> 定義3.50，<span class="citation" data-cites="Iacus-Yoshida2018">(Iacus &amp; Yoshida, 2018, p. 171)</span>．これは，時間変数に関する変数変換を subordination と呼び，その際の変数変換に使えるためである．↩︎</p></li>
<li id="fn54"><p>記法は <span class="citation" data-cites="Iacus-Yoshida2018">(Iacus &amp; Yoshida, 2018)</span> による．<span class="citation" data-cites="Protter2005">(Protter, 2005, p. 33)</span> 例４も参照．↩︎</p></li>
<li id="fn55"><p><span class="citation" data-cites="Iacus-Yoshida2018">(Iacus &amp; Yoshida, 2018, p. 160)</span> に倣った．↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Process</category>
  <category>Simulation</category>
  <category>Stan</category>
  <category>YUIMA</category>
  <category>R</category>
  <guid>https://162348.github.io/posts/2024/Process/Poisson.html</guid>
  <pubDate>Fri, 28 Jun 2024 15:00:00 GMT</pubDate>
  <media:content url="https://162348.github.io/posts/2024/Process/Poisson_files/figure-html/unnamed-chunk-2-1.png" medium="image" type="image/png" height="96" width="144"/>
</item>
<item>
  <title>ベイズ統計学とスピングラス</title>
  <dc:creator>司馬博文 </dc:creator>
  <link>https://162348.github.io/posts/2024/Stat/Bayes2.html</link>
  <description><![CDATA[ 





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Stat/Bayes1.html" target="_blank">
            <img src="https://162348.github.io/posts/2024/Stat/posterior.svg" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">ベイズ統計学と統計物理学</h3>
                <p class="article-description">スパース符号の復元を題材として</p>
            </div>
        </a>
    </div>
</div>
<p>上掲稿で扱ったスパース符号の復元の問題をさらに押し進め，より実用的な誤り訂正符号の設定を考える．</p>
<p>モデルにハイパーパラメータが増え，厳密に証明できる事項は大きく減る．（逆）温度パラメータ <img src="https://latex.codecogs.com/png.latex?%5Cbeta%3E0"> が特定の値を取る際，厳密解が計算可能であり，これを <strong>西森温度</strong> と呼ぶ．<sup>1</sup> これは，ハイパーパラメータ <img src="https://latex.codecogs.com/png.latex?%5Cbeta%3E0"> が指定する分布族が，真の事後分布を含む条件と等価になる．</p>
<section id="誤り訂正符号" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="誤り訂正符号"><span class="header-section-number">1</span> 誤り訂正符号</h2>
<section id="sec-linear-code" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="sec-linear-code"><span class="header-section-number">1.1</span> 線型符号</h3>
<p>有限体 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BF%7D_p"> 上の固定符号長 <img src="https://latex.codecogs.com/png.latex?n"> を持つ <strong>線型符号</strong> とは，<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D">-部分加群 <img src="https://latex.codecogs.com/png.latex?C%5Csubset%5Cmathbb%7BF%7D_p%5En"> のことである： <img src="https://latex.codecogs.com/png.latex?%0Aa(x+y)=ax+ay%5Cquad(a%5Cin%5Cmathbb%7BZ%7D,x,y%5Cin%20C).%0A"></p>
<p>このクラスの符号については，Hamming 距離 <img src="https://latex.codecogs.com/png.latex?d"> の最小値 <img src="https://latex.codecogs.com/png.latex?%0A%5Cmin_%7B%5Csubstack%7Bx,y%5Cin%20C%5C%5C%20x%5Cne%20y%7D%7Dd(x,y)%0A"> が線型時間で計算可能であるために，誤り訂正符号の例として重宝される．</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="例（最も単純な線型パリティ検査符号）^[[@横尾英俊2004 pp.101-102]も参照．]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
例（最も単純な線型パリティ検査符号）<sup>2</sup>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%0AC:=%5Cleft%5C%7B%5Cmathtt%7B000%7D,%5Cmathtt%7B011%7D,%5Cmathtt%7B101%7D,%5Cmathtt%7B110%7D%5Cright%5C%7D%0A"> とすると，<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BF%7D_2%5E3"> 上の <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D">-部分加群となっている．</p>
<p>加えて，この線型符号は次の構造を持つ：任意の符号語 <img src="https://latex.codecogs.com/png.latex?x_1x_2x_3%5Cin%20C"> について， <img src="https://latex.codecogs.com/png.latex?%0Ax_1+x_2%5Cequiv%20x_3%5Cmod%202.%0A"> すなわち，真の符号は前半２ビット（<strong>情報ビット</strong>）に含まれており，最後の符号は <strong>パリティ検査ビット</strong> と呼ばれる．</p>
<p>１ビットの誤りまでなら，<img src="https://latex.codecogs.com/png.latex?x_3"> の偶奇が変わるために，誤りを検出できる．このことを，<img src="https://latex.codecogs.com/png.latex?C"> は単一パリティ検査符号であるという．</p>
</div>
</div>
</div>
</section>
<section id="パリティ検査" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="パリティ検査"><span class="header-section-number">1.2</span> パリティ検査</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定義（パリティ検査方程式）">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定義（パリティ検査方程式）
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?n%3Ek%5Cin%5Cmathbb%7BN%7D"> に対して，<strong><img src="https://latex.codecogs.com/png.latex?(n,k)">-線型符号</strong> とは，ある行列 <img src="https://latex.codecogs.com/png.latex?H%5Cin%20M_%7Bn,n-k%7D(%5Cmathbb%7BF%7D_2)"> を用いて <img src="https://latex.codecogs.com/png.latex?%0AC=%5Cmathrm%7BKer%7D%5C;H%0A"> と定義される符号 <img src="https://latex.codecogs.com/png.latex?C%5Csubset%5Cmathbb%7BF%7D_2%5En"> のことをいう．このとき，<img src="https://latex.codecogs.com/png.latex?H"> を <strong>パリティ検査行列</strong>，符号語 <img src="https://latex.codecogs.com/png.latex?x%5Cin%20C"> が満たす性質 <img src="https://latex.codecogs.com/png.latex?%0AHx=0%0A"> を <strong>パリティ検査方程式</strong> という．</p>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="例（組織符号）^[[@横尾英俊2004 p.106] も参照．]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
例（組織符号）<sup>3</sup>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>前掲の例（第 1.1 節）のように，情報ビットと組織ビットが完全に分離している符号を <strong>組織符号</strong> という．</p>
<p>これは，ある行列 <img src="https://latex.codecogs.com/png.latex?G%5Cin%20M_%7Bk,n-k%7D(%5Cmathbb%7BF%7D_2)"> が存在して，白文 <img src="https://latex.codecogs.com/png.latex?u%5Cin%5Cmathbb%7BF%7D_2%5Ek"> に対する符号が <img src="https://latex.codecogs.com/png.latex?%0Ax=(I_k%5C;G)%5E%5Ctop%20u%0A"> と表せる場合に当たる．</p>
<p>このとき，パリティ検査行列 <img src="https://latex.codecogs.com/png.latex?H%5Cin%20M_%7Bn,n-k%7D(%5Cmathbb%7BF%7D_2)"> を <img src="https://latex.codecogs.com/png.latex?%0AH:=(G%5C;I_%7Bn-k%7D)%0A"> で定めると，パリティ検査方程式が成り立つ．</p>
<p>実際， <img src="https://latex.codecogs.com/png.latex?%0AHx=(G%5C;I_%7Bn-k%7D)(I_k%5C;G)%5E%5Ctop%20u=Ou=0.%0A"></p>
<p>こうして定まる <img src="https://latex.codecogs.com/png.latex?H"> はパリティ検査行列の標準形ともいう．</p>
</div>
</div>
</div>
<p>パリティ検査行列における誤り訂正では，次の逆問題を考えることになる．</p>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="シンドローム復号">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
シンドローム復号
</div>
</div>
<div class="callout-body-container callout-body">
<p>対称通信路が加法的ノイズを印加するならば，受信符号 <img src="https://latex.codecogs.com/png.latex?y"> はあるベクトル <img src="https://latex.codecogs.com/png.latex?e%5Cin%5Cmathbb%7BF%7D_2%5En"> に対して <img src="https://latex.codecogs.com/png.latex?%0Ay=x+e%0A"> の形で表される．</p>
<p>すると，パリティ検査方程式より， <img src="https://latex.codecogs.com/png.latex?%0As:=Hy=He%0A"> が必要である．この値 <img src="https://latex.codecogs.com/png.latex?s"> を <strong>シンドローム</strong> という．</p>
<p>シンドロームは誤りベクトル <img src="https://latex.codecogs.com/png.latex?e"> のみの関数であるから，良い設定下では誤り <img src="https://latex.codecogs.com/png.latex?e"> を推定することができる．</p>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="例（低密度パリティ検査）^[[@樺島-杉浦2008 p.28] も参照．]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
例（低密度パリティ検査）<sup>4</sup>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>一般に，パリティ検査方程式 <img src="https://latex.codecogs.com/png.latex?%0As=He%0A"> から <img src="https://latex.codecogs.com/png.latex?e"> を推定する問題は計算量的に困難になる．</p>
<p>しかし，例えばパリティ検査行列が <img src="https://latex.codecogs.com/png.latex?%0AH=(C_1%5C;C_2)%0A"> <img src="https://latex.codecogs.com/png.latex?%0AC_1%5Cin%20M_%7Bn-k,k%7D(%5Cmathbb%7BF%7D_2),%5Cquad%20C_2%5Cin%20M_%7Bn-k,n-k%7D(%5Cmathbb%7BF%7D_2)%0A"> と２つの疎行列の結合として表される場合（Gallager 符号 <span class="citation" data-cites="Gallager1960">(Gallager, 1960)</span> という），Bethe 近似による効率的な復号アルゴリズムが存在する．</p>
</div>
</div>
</div>
<!-- 
### Hamming 符号
-->
</section>
<section id="sec-Sourlas1989" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="sec-Sourlas1989"><span class="header-section-number">1.3</span> スピングラスとの類似性</h3>
<p>スピングラスとの類似性を最初に指摘したのは <span class="citation" data-cites="Sourlas1989">(Sourlas, 1989)</span> であり，すぐに西森ラインとの関連性も知られた <span class="citation" data-cites="Nishimori2001">(Nishimori, 2001)</span>．</p>
<p>現在ではこの対応は誤り訂正符号に限らず，極めて広範な統計的推定問題に渡っていることが認識されている．</p>
<p>実際，スピングラス理論で開発されたレプリカ法，cavity method, 信念伝搬法は盛んに統計的推定問題に応用されている <span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016)</span>．</p>
<blockquote class="blockquote">
<p>Perhaps the most important message we want to pass in this review is that <strong>many calculations that physics uses to understand the world can be translated into algorithms that machine learning uses to understand data</strong>. <span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, p. 457)</span></p>
</blockquote>
</section>
</section>
<section id="スピングラスと西森温度" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="スピングラスと西森温度"><span class="header-section-number">2</span> スピングラスと西森温度</h2>
<p>スピングラス系にベイズ推定を紐づけることができる．</p>
<p>その際，伝統的にスピングラス理論で扱われた quenched ensemble とも annealed ensemble とも違う第三のアンサンブル <strong>planted ensemble</strong> を扱うことになる．</p>
<section id="設定２点相互作用のみを考えた-ising-モデル" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="設定２点相互作用のみを考えた-ising-モデル"><span class="header-section-number">2.1</span> 設定：２点相互作用のみを考えた Ising モデル</h3>
<p>配置空間を <img src="https://latex.codecogs.com/png.latex?x%5Cin%5C%7B%5Cpm1%5C%7D%5EN"> とし，<img src="https://latex.codecogs.com/png.latex?N"> 個の頂点を持ったグラフ <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BG%7D=(%5Cmathcal%7BV%7D,%5Cmathcal%7BE%7D)"> が定める Ising モデル <span id="eq-Hamiltonian-E"><img src="https://latex.codecogs.com/png.latex?%0AE(x,y)=-%5Csum_%7B(i,j)%5Cin%5Cmathcal%7BE%7D%7Dy_%7Bij%7Dx_ix_j%0A%5Ctag%7B1%7D"></span> を考える．</p>
<p><img src="https://latex.codecogs.com/png.latex?y_%7Bij%7D%3E0"> の場合 <img src="https://latex.codecogs.com/png.latex?x_i,x_j"> は揃い，<img src="https://latex.codecogs.com/png.latex?y_%7Bij%7D%3C0"> の場合 <img src="https://latex.codecogs.com/png.latex?x_i,x_j"> は反対方向を向く方がエネルギー <img src="https://latex.codecogs.com/png.latex?E"> が下がる．</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="フラストレーションについて">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
フラストレーションについて
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>この系を絶対零度まで冷却した際，<img src="https://latex.codecogs.com/png.latex?(y_%7Bij%7D)"> に指定された通りのルールを満たす配置 <img src="https://latex.codecogs.com/png.latex?x%5Cin%5C%7B%5Cpm1%5C%7D%5EN"> があるならばその配置が出現するはずである．この場合，系はフラストレーションを持たないという．</p>
<p>そうでない場合でも，ファクターグラフ <img src="https://latex.codecogs.com/png.latex?(%5Cmathcal%7BV%7D,%5Cmathcal%7BE%7D,(y_%7Bij%7D))"> が定めるフラストレーションを最小にした基底状態が見つかるはずである．</p>
<p>なお，あるファクターグラフがフラストレーションを持たないかどうかは，クラス P に属する問題である．すなわち，多項式時間で判定可能である．<sup>5</sup></p>
</div>
</div>
</div>
<p>相互作用項 <img src="https://latex.codecogs.com/png.latex?y_%7Bij%7D"> が確率的に与えられる場合，その系を <strong>スピングラス</strong> という．</p>
<p>スピングラス理論で代表的な <span class="citation" data-cites="Edwards-Anderson1975">(Edwards &amp; Anderson, 1975)</span> モデルでは，<img src="https://latex.codecogs.com/png.latex?%5C%7By_%7Bij%7D%5C%7D"> はある簡単な分布の独立同分布確率変数だとして，系の振る舞いを分析する．<sup>6</sup></p>
<p>一方でここでは，確率変数 <img src="https://latex.codecogs.com/png.latex?y_%7Bij%7D"> は次に説明するように定まると考えることで，スピングラス系とベイズ推定問題との対応が明らかになる．<sup>7</sup></p>
</section>
<section id="sec-teacher-student-senario" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="sec-teacher-student-senario"><span class="header-section-number">2.2</span> スピングラス系のベイズからの解釈</h3>
<p>統計的な手続きは，スピングラス系を特殊な方法で生成し，その基底状態を探る逆問題として理解できる．<sup>8</sup> こうして生成されたスピングラスを <strong>planted ensemble</strong> と呼ぶ．</p>
<p>具体的には，<a href="../../../posts/2024/Stat/Bayes1.html">前稿</a> で扱った信号推定の問題で，情報源の分布 <img src="https://latex.codecogs.com/png.latex?p(x)"> と通信路の分布 <img src="https://latex.codecogs.com/png.latex?p(y%7Cx)"> が，あるパラメータ <img src="https://latex.codecogs.com/png.latex?%5Calpha,%5Cbeta"> の分だけ一般化し，次の過程を考える：</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="planted ensemble^[こうして生成されたスピングラス系を，planted ensemble と呼び，このシナリオを機械学習の訓練過程に準えて teacher-student scenario とも呼ぶのが [@Zdeborova-Krzakala2016 p.462] の用語である．これを [@Iba1999 p.3881] は符号理論に準えて，encoding-decoding scenario と呼ぶべき設定で解説している．[@Mezard-Montanari2009 p.249] にも同様の通信に準えた記述がある．なお，最後の２つの文献では，事前分布 $p(x)$ を一様分布に限っている．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
planted ensemble<sup>9</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>配置 <img src="https://latex.codecogs.com/png.latex?x%5Cin%5C%7B%5Cpm1%5C%7D%5EN"> をある分布 <img src="https://latex.codecogs.com/png.latex?p_%5Calpha(x)"> に従って選ぶ．<sup>10</sup></li>
<li>相互作用項 <img src="https://latex.codecogs.com/png.latex?y"> を，この <img src="https://latex.codecogs.com/png.latex?x"> と式 (1) で定まる Hamiltonian <img src="https://latex.codecogs.com/png.latex?E"> が定める Boltzmann 分布 <img src="https://latex.codecogs.com/png.latex?p_%5Cbeta(y%7Cx)"> からサンプリングする： <img src="https://latex.codecogs.com/png.latex?%0Ap_%5Cbeta(y%7Cx):=%5Cfrac%7Be%5E%7B-%5Cbeta%20E(x,y)%7D%7D%7B%5Cmathcal%7BZ%7D_%5Cbeta%7D%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Cmathcal%7BZ%7D_%5Cbeta:=%5Csum_%7By%5Cin%5Cmathcal%7BE%7D%7De%5E%7B-%5Cbeta%20E(x,y)%7D%0A"></li>
<li>観測者は <img src="https://latex.codecogs.com/png.latex?y"> のみを見て，<img src="https://latex.codecogs.com/png.latex?x"> がなんだったかを考える．<img src="https://latex.codecogs.com/png.latex?y"> を生成するのに用いたパラメータの真値 <img src="https://latex.codecogs.com/png.latex?%5Calpha%5E*,%5Cbeta%5E*"> も未知とする．<sup>11</sup></li>
</ol>
</div>
</div>
<p>最初に設定される Ising スピンの配置 <img src="https://latex.codecogs.com/png.latex?x%5Cin%5C%7B%5Cpm1%5C%7D%5EN"> を信号とみなすと，ノイズが加わった観測とは coupling <img src="https://latex.codecogs.com/png.latex?y_%7Bij%7D"> のみを見ることに対応する．</p>
<p>そして信号推定とは，この <img src="https://latex.codecogs.com/png.latex?y_%7Bij%7D"> が定める Hamiltonian <img src="https://latex.codecogs.com/png.latex?E(x,y)"> の基底状態を探索することに他ならない．信号 <img src="https://latex.codecogs.com/png.latex?x"> が，planted ensemble の基底状態に埋め込まれているわけである．</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="例（planted ensemble と同一視できる系）^[[@Zdeborova-Krzakala2016 p.468] に多くの関連文献がまとめられている．]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
例（planted ensemble と同一視できる系）<sup>12</sup>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>二元対称通信路における誤り訂正符号のスピングラス的解釈（第 1.3 節）はこの例の１つに過ぎない．</p>
<p>さらに，<img src="https://latex.codecogs.com/png.latex?x"> を一般の潜在変数とし，事前分布 <img src="https://latex.codecogs.com/png.latex?p(x)"> と確率核 <img src="https://latex.codecogs.com/png.latex?p(y%7Cx)"> が定める確率的グラフィカルモデルは，すべてこの枠組みに収まる．</p>
<p>以上，Bayes 推定の文脈でスピングラスの planted ensemble を定義したが，同様にしてスピングラス系の中に情報を隠すことは，よく見られるモデリング法である．</p>
<ul>
<li>Hopfield モデル <span class="citation" data-cites="Hopfield1982">(Hopfield, 1982)</span> はランダムな配置を記憶させたスピングラス系であり，脳科学において連想記憶のモデルとしても用いられる．</li>
<li>タンパク質の折りたたみ構造をモデリングするとき，その native configuration を基底状態として埋め込むことがある <span class="citation" data-cites="Bryngelson-Wolynes1987">(Bryngelson &amp; Wolynes, 1987)</span>．</li>
<li>グラフ内の大規模なクリークを見つける問題の難易度を，対応する planted ensemble における MCMC の収束の遅さとして捉えることができる <span class="citation" data-cites="Jerrum1992">(Jerrum, 1992)</span>．</li>
<li>同様に，グラフの２分割問題と擬似アニーリングとにも対応が存在する <span class="citation" data-cites="Jerrum-Sorkin1993">(Jerrum &amp; Sorkin, 1993)</span>．</li>
<li>充足性問題（四色問題など）の計算複雑性も，planted ensemble に対応させて示された <span class="citation" data-cites="Achlioptas-Coja-Oghlan2008">(Achlioptas &amp; Coja-Oghlan, 2008)</span>．</li>
</ul>
<blockquote class="blockquote">
<p>The authors find that making the connection between planting and inference very explicitly brings a lot of insight into a generic inference problem and for this reason we built the present review around this connection. <span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, p. 469)</span></p>
</blockquote>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="比例的高次元漸近論">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
比例的高次元漸近論
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?M:=%5Clvert%5Cmathcal%7BE%7D%5Crvert"> が観測 <img src="https://latex.codecogs.com/png.latex?y"> のサイズとなる．</p>
<p>従来の統計学における漸近理論では，パラメータの次元 <img src="https://latex.codecogs.com/png.latex?N"> は固定とし，<img src="https://latex.codecogs.com/png.latex?M%5Cto%5Cinfty"> の極限での理論が展開された．</p>
<p>現代では，モデルのサイズも大きくする <img src="https://latex.codecogs.com/png.latex?N%5Cto%5Cinfty"> の極限を考える需要が高まっている．</p>
<p>しかしこの場合でも，統計力学のツールボックスはこれを可能にする．</p>
<p>特に，比 <img src="https://latex.codecogs.com/png.latex?%5Calpha:=%5Cfrac%7BM%7D%7BN%7D"> を保ったまま <img src="https://latex.codecogs.com/png.latex?N,M%5Cto%5Cinfty"> の極限を考えるスキームは <strong>比例的高次元</strong> と呼ばれる．</p>
<p>一般に，<img src="https://latex.codecogs.com/png.latex?%5Calpha"> が十分大きい場合は，モデルの複雑性に対して観測も多いので，意味のある情報が引き出せるはずであり，<img src="https://latex.codecogs.com/png.latex?%5Calpha"> が小さいほど困難になっていくはずである．</p>
<p>実際に，比例的高次元極限では，前稿でみた閾値現象が普遍的に生じることが知られている．これが，スピングラスの相転移に対応するのである．</p>
</div>
</div>
</div>
</section>
<section id="sec-Nishimori-line" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="sec-Nishimori-line"><span class="header-section-number">2.3</span> 西森ライン</h3>
<p>前節 2.2 の解釈では，観測 <img src="https://latex.codecogs.com/png.latex?y"> を経たあとの信号 <img src="https://latex.codecogs.com/png.latex?x"> の事後分布は <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20p_%7B%5Calpha,%5Cbeta%7D(x%7Cy)&amp;%5C,%5Cpropto%5C,p_%5Cbeta(y%7Cx)p_%5Calpha(x)%5C%5C%0A%20%20%20%20&amp;=%5Cfrac%7Be%5E%7B-%5Cbeta%20E(x,y)%7Dp_%5Calpha(x)%7D%7B%5Cmathcal%7BZ%7D_%7B%5Calpha,%5Cbeta%7D%7D%0A%5Cend%7Balign*%7D"> <img src="https://latex.codecogs.com/png.latex?%0A%5Cmathcal%7BZ%7D_%7B%5Calpha,%5Cbeta%7D:=%5Csum_%7Bx%5Cin%5Cmathcal%7BE%7D%7De%5E%7B-%5Cbeta%20E(x,y)%7Dp_%5Calpha(x)%0A"> で与えられる．</p>
<p>ただし，ここで，観測者の立てたモデルにおいて，パラメータ <img src="https://latex.codecogs.com/png.latex?%5Calpha,%5Cbeta"> は真の値 <img src="https://latex.codecogs.com/png.latex?%5Calpha%5E*,%5Cbeta%5E*"> とは異なり得るとする．</p>
<p>仮に観測者の用いたパラメータが真のパラメータと一致していた <img src="https://latex.codecogs.com/png.latex?(%5Calpha,%5Cbeta)=(%5Calpha%5E*,%5Cbeta%5E*)"> の場合，種々の魅力的な性質が成り立つ．これを西森条件という．<sup>13</sup></p>
<p>中でも特に，次の性質は <a href="../../../posts/2024/Stat/Bayes1.html#sec-Nishimori-symmetry">西森対称性</a> と呼ばれている：<sup>14</sup> <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BE%7D%5Bf(X_1,X_2)%5D=%5Coperatorname%7BE%7D%5Bf(X%5E*,X_2)%5D%0A"> ただし，<img src="https://latex.codecogs.com/png.latex?X_1,X_2"> は事後分布からのランダムサンプル（平衡状態にあるレプリカ）であり，<img src="https://latex.codecogs.com/png.latex?X%5E*"> は <img src="https://latex.codecogs.com/png.latex?p(x)"> に従う真の信号とした．</p>
<p>この西森対称性を通じて，自由エネルギー（＝ KL 乖離度）をはじめとした厳密解が求まるのである．そのことを簡単なモデルで確認したのが <a href="../../../posts/2024/Stat/Bayes1.html">前稿</a> である．</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="西森対称性の含意">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
西森対称性の含意
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>西森対称性とは，planted ensemble において，元々の配置 <img src="https://latex.codecogs.com/png.latex?x%5E*"> は，Boltzmann 分布の平衡状態からのサンプル <img src="https://latex.codecogs.com/png.latex?X"> と平均的に（マクロ的には）見分けがつかないという性質である．</p>
<p>西森対称性を用いた厳密解は，前稿で多く紹介している：</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Stat/Bayes1.html" target="_blank">
            <img src="https://162348.github.io/posts/2024/Stat/posterior.svg" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">ベイズ統計学と統計物理学</h3>
                <p class="article-description">スパース符号の復元を題材として</p>
            </div>
        </a>
    </div>
</div>
<p>前稿では信号推定の問題を扱ったが，情報源分布 <img src="https://latex.codecogs.com/png.latex?p(x)"> と通信路 <img src="https://latex.codecogs.com/png.latex?p(y%7Cx)"> のモデルがすでにわかっていることは，西森条件に相当する．</p>
<p>すなわち，信号推定の問題は，自然に西森ライン上で議論している場合に当たるのである．</p>
<p>一般に，事後平均推定量 <img src="https://latex.codecogs.com/png.latex?%5Cwidehat%7BX%7D_n"> が平均自乗誤差を最低にするのであった：</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BE%7D%5B(%5Cwidehat%7BX%7D_n-X%5E*)%5E2%5D=%5Cmin_%7B%5Cwidehat%7BX%7D_n%7D%5Coperatorname%7BE%7D%5B(%5Cwidehat%7BX%7D_n-X%5E*)%5E2%5D%0A"></p>
<p>一般にこの値は不可知であるが，西森ライン上では＝モデルの特定が成功している場合，<img src="https://latex.codecogs.com/png.latex?%5Cwidehat%7BX%7D_n"> の分散に平均的に（＝<img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BE%7D"> 内で）一致することになる．</p>
<p>これが <a href="../../../posts/2024/Stat/Bayes1.html#sec-MMSE-via-Nishimori">命題</a> <img src="https://latex.codecogs.com/png.latex?%0A%5CDeclareMathOperator%7B%5CMMSE%7D%7BMMSE%7D%0A%5CMMSE=%5Coperatorname%7BE%7D%5BX%5E2%5D-%5Coperatorname%7BE%7D%5Cbiggl%5B%5Clangle%20X%5Crangle%5E2%5Cbiggr%5D%0A"> の意味であるとも見れる．</p>
</div>
</div>
</div>
<p>換言すれば，Boltzmann 分布のうち，<img src="https://latex.codecogs.com/png.latex?%5Cbeta"> が真値 <img src="https://latex.codecogs.com/png.latex?%5Cbeta%5E*"> に一致する場合のみ，Bayes 推定の観点からは特別な意味を持つことになる．これを <strong>西森温度</strong> というのである．</p>
<!-- ### Planted Ensemble の性質

西森温度であるかに依らず，[-@sec-teacher-student-senario] により定まる planted ensemble は次の性質を持つ

::: {.callout-tip appearance="simple" icon="false"}

* 

::: -->
</section>
<section id="planted-ensemble-の新規性" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="planted-ensemble-の新規性"><span class="header-section-number">2.4</span> Planted Ensemble の新規性</h3>
<p>スピングラスでは，ランダムに定まる相互作用項 <img src="https://latex.codecogs.com/png.latex?Y_%7Bij%7D"> と，これが定める Boltzmann 分布 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Be%5E%7B-%5Cbeta%20H%7D%7D%7B%5Cmathcal%7BZ%7D%7D"> の２つの平均が存在する．</p>
<p>後者に関する平均は <img src="https://latex.codecogs.com/png.latex?%5Clangle%20X%5Crangle:=%5Coperatorname%7BE%7D%5BX%7CY%5D"> で表す一方で，前者に関する平均はよく <img src="https://latex.codecogs.com/png.latex?%5B-%5D"> で表される．<sup>15</sup></p>
<p>従来のスピングラス理論では，disorder <img src="https://latex.codecogs.com/png.latex?Y_%7Bij%7D"> に関する quenched average <img src="https://latex.codecogs.com/png.latex?%5B-%5D"> を先に取ることで，従来の Ising 模型と同様の議論に持ち込む戦略が取られる．</p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="スピングラス理論における２つの平均^[[@Zdeborova-Krzakala2016 pp.480- 2.5節]，[@Mezard-Montanari2009 pp.102 5.4節] が詳しい．]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
スピングラス理論における２つの平均<sup>16</sup>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>系が大きくなるほど，<img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Clog%20Z_N%7D%7BN%7D"> の値はその quenched average に集中していく．<sup>17</sup></p>
<p>従ってこの quenched average を求めることが中心問題とされる： <img src="https://latex.codecogs.com/png.latex?%0Af=%5Clim_%7BN%5Cto%5Cinfty%7D-%5Cfrac%7B1%7D%7B%5Cbeta%20N%7D%5B%5Clog%20Z%5D.%0A"> これは，自由エネルギー密度の <strong>quenched average</strong> と呼ばれる．</p>
<p>しかしこれに解決が難しく，値を計算するヒューリスティックとしてレプリカトリックが用いられる： <img src="https://latex.codecogs.com/png.latex?%0Af%5Capprox-%5Clim_%7BN%5Cto%5Cinfty%7D%5Cfrac%7B1%7D%7B%5Cbeta%20N%7D%5Clim_%7Bn%5Cto%5Cinfty%7D%5Cfrac%7B%5BZ%5En%5D-1%7D%7Bn%7D.%0A"></p>
<p>一方で，次の値は計算が簡単であり，quenched average の下からの評価として用いられることがある： <img src="https://latex.codecogs.com/png.latex?%0Af_%7B%5Ctext%7Bannealed%7D%7D:=-%5Cfrac%7B1%7D%7B%5Cbeta%20N%7D%5Clog%5BZ%5D.%0A"> これは <strong>annealed average</strong> と呼ばれる．</p>
<p>こうして，quenched ensemble, average ensemble の両方が用いられることがあるが，この両方に共通していたのが <u><img src="https://latex.codecogs.com/png.latex?Y_%7Bij%7D"> に関する平均を先に取る</u> という点である．</p>
<p>しかし，planted ensemble ではこのアプローチをとっていない．</p>
<blockquote class="blockquote">
<p>This notion of averaging over disorder is so well engraved into a physicist’s mind that going away from this framework and starting to use the related (replica and cavity) calculations for a single realization of the disorder has lead to a major paradigm shift and to the development of revolutionary algorithms such as the survey propagation <span class="citation" data-cites="Mezard+2002">(Mézard et al., 2002)</span>.</p>
</blockquote>
<p>なお，この要約伝搬法は Bethe 近似に関係がある <span class="citation" data-cites="Kabashima2005">(Kabashima, 2005)</span>．</p>
</div>
</div>
</div>
<p>一方で，planted ensemble では，スピンの配置を決めてから，<img src="https://latex.codecogs.com/png.latex?Y_%7Bij%7D"> を生成している．当然，実際の物理過程とは違うものであり，Monte Carlo 法の真逆をやっているものであるが，ベイズ統計学との関連の結節点になる．</p>
<p>それだけでなく，スピングラス転移などの物理現象に関しても示唆を与える対象だとわかりつつある．<sup>18</sup></p>
</section>
<section id="レプリカ対称性の破れ" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="レプリカ対称性の破れ"><span class="header-section-number">2.5</span> レプリカ対称性の破れ</h3>
<p>レプリカ対称性は大雑把に，平衡状態のダイナミクスの緩和過程によって表現できる．</p>
<p>事後分布 <img src="https://latex.codecogs.com/png.latex?p(x%7Cy)"> について</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="レプリカ法によるレプリカ対称性の破れパターン^[[@Zdeborova-Krzakala2016 p.483] 2.6 節，[@Mezard-Montanari2009 p.253] 12.3.3 節．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
レプリカ法によるレプリカ対称性の破れパターン<sup>19</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>レプリカ対称</strong> であるとは，この平衡分布からスタートする MCMC が，系が大きくなる極限 <img src="https://latex.codecogs.com/png.latex?N%5Cto%5Cinfty"> で，どの平衡状態も一様に線型の複雑性でサンプリング可能であることをいう．<sup>20</sup></li>
<li>d1RSB (dynamical one-step of replica symmetry breaking) とは，系が大きくなる極限 <img src="https://latex.codecogs.com/png.latex?N%5Cto%5Cinfty"> に対して線型の複雑性でサンプリング可能な平衡状態が，指数減少していくことを言う．</li>
<li>1RSB (static one-step RSB) とは，平衡分布からスタートする MCMC がサンプリング可能な平衡状態が，全体の一部に留まることをいう．また，任意の２つの平衡状態の間の距離は，<img src="https://latex.codecogs.com/png.latex?N%5Cto%5Cinfty"> の極限で殆ど確実に，２つの値のいずれかのみを取ることを言う．</li>
<li>FRSB (full-step RSB) とは，任意の２つの平衡状態の間の距離が，ある絶対連続分布に従うことをいう．</li>
</ul>
</div>
</div>
<p>RSB 下では，<img src="https://latex.codecogs.com/png.latex?N%5Cto%5Cinfty"> の極限で，Boltzmann 分布の自己平均化＝測度の集中が起こらない．</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="例（自発磁化密度）^[[@Mezard-Montanari2009 p.250] 12.3.1 節参照．]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
例（自発磁化密度）<sup>21</sup>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>平衡状態から開始する Glauber 動力学を考えると，例えば <img src="https://latex.codecogs.com/png.latex?d%5Cge2"> 次元での外場を持たない強磁性 Ising 模型では，臨界温度以下である限り， <img src="https://latex.codecogs.com/png.latex?%0A%5Clim_%7Bt%5Cto%5Cinfty%7D%5Clim_%7BN%5Cto%5Cinfty%7D%5Clangle%5Csigma_i(t)%5Crangle_G%5Cne%5Clangle%5Csigma_i%5Crangle%0A"> が成り立つ．ただし，<img src="https://latex.codecogs.com/png.latex?%5Clangle-%5Crangle_G"> は特定の初期状態を持つ Glauber 動力学に関する平均とした．</p>
<p>特に，ある自発磁化密度 <img src="https://latex.codecogs.com/png.latex?M(%5Cbeta)%3E0"> が存在して， <img src="https://latex.codecogs.com/png.latex?%0A%5Clim_%7Bt%5Cto%5Cinfty%7D%5Clim_%7BN%5Cto%5Cinfty%7D%5Clangle%5Csigma_i(t)%5Crangle_G%5Cin%5C%7B%5Cpm%20M(%5Cbeta)%5C%7D%0A"> である．</p>
<p>この「準平衡状態」と言える状態にとらわれる現象は普遍的であるが，この「準平衡状態」が，初期位置の関数として，時間にも空間にも不変性が存在しないときが，スピングラスである．</p>
</div>
</div>
</div>
</section>
</section>
<section id="a-planted-spin-glass-model-of-error-correcting-codes" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="a-planted-spin-glass-model-of-error-correcting-codes"><span class="header-section-number">3</span> A Planted Spin Glass Model of Error Correcting Codes</h2>
<p>誤り訂正符号を例に取り，censored block model <span class="citation" data-cites="Abbe+2014">(Abbe et al., 2014)</span> とも呼ばれる具体的な planted ensemble を考える．<sup>22</sup></p>
<section id="sec-censored-block-settings" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="sec-censored-block-settings"><span class="header-section-number">3.1</span> 設定</h3>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="planted spin glass of error correcting code">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
planted spin glass of error correcting code
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><img src="https://latex.codecogs.com/png.latex?p_%5Calpha(x)"> を <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Cpm1%5C%7D%5EN"> 上の 一様分布とする．</li>
<li>辺の集合 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BE%7D"> は，大きさ <img src="https://latex.codecogs.com/png.latex?M"> で，ランダムに生成されるものとする．<sup>23</sup></li>
<li><img src="https://latex.codecogs.com/png.latex?p_%5Crho(y%7Cx)"> は，ある確率 <img src="https://latex.codecogs.com/png.latex?%5Crho%5Cin(0,1)"> に関して， <img src="https://latex.codecogs.com/png.latex?%0A%20%20p(y_%7Bij%7D%7Cx_i%5E*,x_j%5E*)=%5Crho%5Cdelta_%7By_%7Bij%7D,x_i%5E*x_j%5E*%7D+(1-%5Crho)%5Cdelta_%7By_%7Bij%7D,-x_i%5E*x_j%5E*%7D%0A%20%20"> の直積として定まるとする．<sup>24</sup></li>
</ul>
</div>
</div>
<p>この設定下では，事後分布は <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20p(x%7Cy)&amp;=%5Cfrac%7Bp(y%7Cx)p(x)%7D%7Bp(y)%7D%5C%5C%0A%20%20%20%20&amp;=%5Cfrac%7B%5Cprod_%7B(i,j)%5Cin%20E%7De%5E%7B%5Cbeta%5E*y_%7Bij%7Dx_ix_j%7D%7D%7B2%5EN(2%5Ccosh%5Cbeta%5E*)%5EMp(y)%7D%0A%5Cend%7Balign*%7D"> と表せる．ただし， <span id="eq-Nishimori-temperature"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbeta%5E*:=%5Cbeta%5E*(%5Crho):=%5Cfrac%7B1%7D%7B2%7D%5Clog%5Cfrac%7B%5Crho%7D%7B1-%5Crho%7D%0A%5Ctag%7B2%7D"></span> とした．</p>
<p>これは，Hamiltonian <span id="eq-Hamiltonian"><img src="https://latex.codecogs.com/png.latex?%0AH(x,y):=-%5Csum_%7B(i,j)%5Cin%5Cmathcal%7BE%7D%7Dy_%7Bij%7Dx_ix_j%0A%5Ctag%7B3%7D"></span> が定める Boltzmann 分布に他ならない．</p>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明^[[@Zdeborova-Krzakala2016 p.475]，[@Iba1999 p.3879]．]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明<sup>25</sup>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>この設定下では， <img src="https://latex.codecogs.com/png.latex?%0A%5Crho=%5Cfrac%7Be%5E%7B%5Cbeta%5E*%7D%7D%7B2%5Ccosh%5Cbeta%5E*%7D,%5Cqquad%5Cbeta%5E*:=%5Cfrac%7B1%7D%7B2%7D%5Clog%5Cfrac%7B%5Crho%7D%7B1-%5Crho%7D%0A"> が成り立ち， <img src="https://latex.codecogs.com/png.latex?%0Ap(y_%7Bij%7D%7Cx_i%5E*,x_j%5E*)=%5Cfrac%7Be%5E%7B%5Cbeta%5E*y_%7Bij%7Dx%5E*_ix%5E*_j%7D%7D%7B2%5Ccosh%5Cbeta%5E*%7D%0A"> と表せるためである．</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="解釈">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
解釈
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>まず，二元対称通信路における誤り訂正符号としての見方ができる <span class="citation" data-cites="Iba1999">(Iba, 1999, pp. 3879 3節)</span></p>
<p><img src="https://latex.codecogs.com/png.latex?(i,j)%5Cin%5Cmathcal%7BE%7D"> に関して， <img src="https://latex.codecogs.com/png.latex?%0A%20%20y_%7Bij%7D%5E%7B%5Ctext%7Bin%7D%7D:=x_ix_j%0A%20%20"> が送信符号であるとし，確率 <img src="https://latex.codecogs.com/png.latex?1-%5Crho"> で誤りが生じるとする： <img src="https://latex.codecogs.com/png.latex?%0A%20%20y_%7Bij%7D=%5Cbegin%7Bcases%7D%0A%20%20%20%20%20%20y_%7Bij%7D%5E%7B%5Ctext%7Bin%7D%7D%20&amp;%20%5Ctext%7Bwith%20probability%20%7D%5Crho,%5C%5C%0A%20%20%20%20%20%20-y_%7Bij%7D%5E%7B%5Ctext%7Bin%7D%7D%20&amp;%20%5Ctext%7Bwith%20probability%20%7D1-%5Crho.%0A%20%20%5Cend%7Bcases%7D%0A%20%20"></p></li>
<li><p>次に，teacher-student sinario としての見方もできる <span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, pp. 473–2.1節)</span></p>
<p><img src="https://latex.codecogs.com/png.latex?N"> 人が，<img src="https://latex.codecogs.com/png.latex?%5Cpm1"> のいずれかが書かれたカードを持っているとし，教師はこれを知っているとする．</p>
<p>生徒は，人物 <img src="https://latex.codecogs.com/png.latex?x_i,x_j"> が持っているカードが一致しているならば <img src="https://latex.codecogs.com/png.latex?y_%7Bij%7D=1">，そうでないならば <img src="https://latex.codecogs.com/png.latex?y_%7Bij%7D=-"> と知らされるが，正しく知らされる確率は <img src="https://latex.codecogs.com/png.latex?%5Crho"> であるとする．</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="ベイズ推定からの解釈" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="ベイズ推定からの解釈"><span class="header-section-number">3.2</span> ベイズ推定からの解釈</h3>
<p>そこで，前節の計算に基づき，事後分布を分布族 <span id="eq-Boltzmann-distribution"><img src="https://latex.codecogs.com/png.latex?%0Ap(x%7Cy)%5C,%5Cpropto%5C,e%5E%7B-%5Cbeta%20H(x,y)%7D,%5Cqquad%5Cbeta%3E0,%0A%5Ctag%7B4%7D"></span> によりモデリングしたとすると，<img src="https://latex.codecogs.com/png.latex?%5Cbeta=%5Cbeta%5E*(%5Cbeta)"> の場合が真の事後分布に当たる．</p>
<p>ただし，この真のハイパーパラメータの値 <img src="https://latex.codecogs.com/png.latex?%5Cbeta%5E*(%5Crho)"> はわからないとする．</p>
<p>このとき例えば，平均正解個数を最大化した MMO (Maximum Mean Overlap) 復号をしたいならば，<sup>26</sup> <span id="eq-MMO"><img src="https://latex.codecogs.com/png.latex?%0A%5Cwidehat%7Bx%7D_i=%5Cmathrm%7Bsign%7D(%5Clangle%20x_i%5Crangle)%0A%5Ctag%7B5%7D"></span> というように，planted spin glass 系の平衡状態における磁化密度を計算することで達成できる．汎用的には，Monte Carlo 法を通じて解けることになる．<sup>27</sup></p>
<p>こうして，推定の問題が，スピングラスの planted ensemble の平衡状態のシミュレーションや基底状態の探索の問題に翻訳されたことになる．</p>
<p>特に，<img src="https://latex.codecogs.com/png.latex?%5Cbeta=%5Cbeta%5E*(%5Crho)"> に設定した場合のみ，西森条件が成り立ち，これを満たす値 <img src="https://latex.codecogs.com/png.latex?(%5Cbeta,%5Crho)"> の集合を西森ラインという．</p>
</section>
<section id="西森ラインの発見" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="西森ラインの発見"><span class="header-section-number">3.3</span> 西森ラインの発見</h3>
<p>西森ラインは元々，純粋に Hamiltonian <img src="https://latex.codecogs.com/png.latex?H"> と Boltzmann 分布 (4) を持つ Edwards-Anderson モデルの解析の中で発見されたものであり，ベイズ統計学との関連はその約 10 年後になってから見出された．</p>
<section id="ゲージ変換" class="level4" data-number="3.3.1">
<h4 data-number="3.3.1" class="anchored" data-anchor-id="ゲージ変換"><span class="header-section-number">3.3.1</span> ゲージ変換</h4>
<p><span class="citation" data-cites="Nishimori1980">(Nishimori, 1980)</span> では，この Hamiltonian (3) が，任意の点 <img src="https://latex.codecogs.com/png.latex?%5Cwidetilde%7Bx%7D%5Cin%5C%7B%5Cpm1%5C%7D%5EN"> が定める次の変換に対して不変であることが利用された： <img src="https://latex.codecogs.com/png.latex?%0Ax_i%5Cmapsto%20x_i%5Cwidetilde%7Bx%7D_i,%0A"> <img src="https://latex.codecogs.com/png.latex?%0Ay_%7Bij%7D%5Cmapsto%20y_%7Bij%7D%5Cwidetilde%7Bx%7D_i%5Cwidetilde%7Bx%7D_j.%0A"></p>
<p>この変換を真の配置 <img src="https://latex.codecogs.com/png.latex?%5Cwidetilde%7Bx%7D=x%5E*%5Cin%5C%7B%5Cpm1%5C%7D%5EN"> について考える．真の配置 <img src="https://latex.codecogs.com/png.latex?x%5E*"> がこのゲージ変換を受けると，全てのスピンが <img src="https://latex.codecogs.com/png.latex?1"> に揃った状態に写される．</p>
<p>続いて，相互作用項 <img src="https://latex.codecogs.com/png.latex?y_%7Bij%7D"> は，確率 <img src="https://latex.codecogs.com/png.latex?%5Crho"> で <img src="https://latex.codecogs.com/png.latex?y_%7Bij%7D=1">，確率 <img src="https://latex.codecogs.com/png.latex?1-%5Crho"> で <img src="https://latex.codecogs.com/png.latex?y_%7Bij%7D=-1"> を満たす独立同分布列となる．</p>
<p>こうして，今回の設定 3.1 も Edwards-Anderson モデルに帰着され，この設定の中で全てのスピンが揃った強磁性状態を探索する問題に変換される．</p>
<p>この <img src="https://latex.codecogs.com/png.latex?%5C%7By_%7Bij%7D%5C%7D"> に関する Edwards-Anderson モデル <img src="https://latex.codecogs.com/png.latex?H"> において，<img src="https://latex.codecogs.com/png.latex?%5Crho"> と <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> の値の関係が系の振る舞いを決定し，その相図は元々の planted ensemble の性質と同一視できる．<sup>28</sup></p>
</section>
<section id="西森ライン上での西森条件" class="level4" data-number="3.3.2">
<h4 data-number="3.3.2" class="anchored" data-anchor-id="西森ライン上での西森条件"><span class="header-section-number">3.3.2</span> 西森ライン上での西森条件</h4>
<p>このとき，Edwards-Anderson モデルは <img src="https://latex.codecogs.com/png.latex?%5Cbeta=%5Cbeta%5E*"> （式 2）の場合に限り，内部エネルギーや比熱の上限が厳密解を持つ：<sup>29</sup> <span id="eq-Nishimori-condition"><img src="https://latex.codecogs.com/png.latex?%0A%5Clangle%20E%5Crangle=-M%5Ctanh%5Cbeta%5E*.%0A%5Ctag%7B6%7D"></span></p>
<p>この条件 <img src="https://latex.codecogs.com/png.latex?%5Cbeta=%5Cbeta%5E*(%5Crho)"> を満たす組 <img src="https://latex.codecogs.com/png.latex?(%5Cbeta,%5Crho)"> を，<img src="https://latex.codecogs.com/png.latex?T">-<img src="https://latex.codecogs.com/png.latex?p"> 相図上で見たとして，<strong>西森ライン</strong> と呼んだのであった．<sup>30</sup></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/Stat/phase_regular_rev.jpeg" class="img-fluid figure-img"></p>
<figcaption>平均次数 <img src="https://latex.codecogs.com/png.latex?3"> を持つランダムグラフ上の <img src="https://latex.codecogs.com/png.latex?%5Cpm1"> Edwards-Anderson モデルの <img src="https://latex.codecogs.com/png.latex?T">-<img src="https://latex.codecogs.com/png.latex?p"> 相図．<span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, p. 477 Figure. 2)</span> から．</figcaption>
</figure>
</div>
<p>西森ラインは，相転移点 <img src="https://latex.codecogs.com/png.latex?%5Cbeta_c"> を通るにも拘らず，内部エネルギーは常に特異性を示さない．特異部が消えているのである．<sup>31</sup></p>
<p>そして何より，途中でスピングラス相を通過しない．<sup>32</sup></p>
</section>
</section>
<section id="西森ラインの意味" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="西森ラインの意味"><span class="header-section-number">3.4</span> 西森ラインの意味</h3>
<p>一般の模型に対してこのようなゲージ変換が見つかるわけでもなければ，その変換の物理的な意味が定かでない．</p>
<section id="ベイズによる解釈と一般化" class="level4" data-number="3.4.1">
<h4 data-number="3.4.1" class="anchored" data-anchor-id="ベイズによる解釈と一般化"><span class="header-section-number">3.4.1</span> ベイズによる解釈と一般化</h4>
<p>しかし，西森ラインとは，今回の設定 3.1，または一般の planted spin glass model （第 2.2 節）において，モデルが正しく特定されていること <img src="https://latex.codecogs.com/png.latex?%5Cbeta=%5Cbeta%5E*"> の特別な場合と理解できる <span class="citation" data-cites="Iba1999">(Iba, 1999)</span>．</p>
<p>西森ラインの存在は長らく謎であったが，ベイズ推論の文脈では明確な意味を持つのである．特に，ゲージ対称性が存在しないモデルであっても，第 2.2 節の teacher-student scenario に当てはまる統計問題である限り，対応するスピングラス系に西森ラインは考えられる．<sup>33</sup></p>
<p>西森条件とは，モデルが正しく特定されている場合に成り立つ魅力的な性質の数々であると理解できる．</p>
</section>
<section id="西森ライン上でのベイズ推論" class="level4" data-number="3.4.2">
<h4 data-number="3.4.2" class="anchored" data-anchor-id="西森ライン上でのベイズ推論"><span class="header-section-number">3.4.2</span> 西森ライン上でのベイズ推論</h4>
<p>モデルの特定が正しかったとする：<img src="https://latex.codecogs.com/png.latex?%5Cbeta=%5Cbeta%5E*">．</p>
<p>高温領域 <img src="https://latex.codecogs.com/png.latex?%5Cbeta%5E*%3C%5Cbeta_c,%5Crho%3C%5Crho_c"> では，<img src="https://latex.codecogs.com/png.latex?%5Crho"> が <img src="https://latex.codecogs.com/png.latex?1/2"> に近いことに対応する．対応する Edwards-Anderson モデルは常磁性相 P にある．もはやこの系は planted information <img src="https://latex.codecogs.com/png.latex?x%5E*"> を憶えておらず，真値 <img src="https://latex.codecogs.com/png.latex?x%5E*"> の推定が（情報理論的に）不可能である．</p>
<p>一方で，低温領域 <img src="https://latex.codecogs.com/png.latex?%5Cbeta%5E*%3E%5Cbeta_c,%5Crho%3E%5Crho_c"> では，Monte Carlo 法は高速に強磁性状態へ収束する．Monte Carlo 法により熱平均 (5) を計算することで，真値 <img src="https://latex.codecogs.com/png.latex?x%5E*"> を最適に推定できる．</p>
<p>これら２つの領域の中間に「推定可能だが，計算が困難」という状態（スピングラス相）は存在せず，２つの領域の間には二次の相転移が見られる．<sup>34</sup></p>
<p><img src="https://latex.codecogs.com/png.latex?T_c"> の値は，ランダムグラフ <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BG%7D"> の平均次数が大きいほど大きくなる．即ち，観測の数が多いほど，真値 <img src="https://latex.codecogs.com/png.latex?x%5E*"> を推定することが可能な範囲が広がる．</p>
</section>
</section>
<section id="誤特定の場合にはスピングラス相が現れる" class="level3" data-number="3.5">
<h3 data-number="3.5" class="anchored" data-anchor-id="誤特定の場合にはスピングラス相が現れる"><span class="header-section-number">3.5</span> 誤特定の場合にはスピングラス相が現れる</h3>
<p>モデルの真のハイパーパラメータ <img src="https://latex.codecogs.com/png.latex?%5Cbeta%5E*"> を知らなかった場合を考える．</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Crho%3C%5Crho_c"> であるとき，推定は不可能である．系を低温にしていくとスピングラス相が現れ，Monte Carlo 法の収束は圧倒的に遅くなる．加えて，推定は不可能であるはずなのに，<img src="https://latex.codecogs.com/png.latex?%5Cbeta%5Cto%5Cinfty"> の極限でも磁化が残る．これは過適応・過学習の現象と対応する．</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Crho%3E%5Crho_c"> であるとき，推定は可能であるが，系が低温過ぎると強磁性相が存在しない可能性があるどころか，スピングラス相が同居する相が出現する可能性さえある．従って，ハイパーパラメータ <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> を大きくしすぎないことが大事である．</p>
<p>スピングラス相，過学習，いずれの現象も，西森ライン上では見られない．スピングラス系の不可知な性質は，真のモデルが不明な場合の推定問題の困難さと同根なのである．</p>
</section>
<section id="系の温度はハイパーパラメータに対応する" class="level3" data-number="3.6">
<h3 data-number="3.6" class="anchored" data-anchor-id="系の温度はハイパーパラメータに対応する"><span class="header-section-number">3.6</span> 系の温度はハイパーパラメータに対応する</h3>
<p>以上の，Edwards-Anderson 模型の相図は，統計推測において「ハイパーパラメータ <img src="https://latex.codecogs.com/png.latex?%5Cbeta%5E*"> の選択が大事」であることを示唆してくれる．</p>
<p>実際，EM アルゴリズム <span class="citation" data-cites="Dempster+1977">(Dempster et al., 1977)</span> はこれを考慮した MAP 推定と捉えられる．</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Computation/VI2.html" target="_blank">
            <img src="https://162348.github.io/posts/2024/Computation/VI2_files/figure-html/cell-4-output-1.png" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">変分推論２</h3>
                <p class="article-description">EM アルゴリズム</p>
            </div>
        </a>
    </div>
</div>
<p>EM アルゴリズムは，エビデンス <img src="https://latex.codecogs.com/png.latex?p_%5Cbeta(x%7Cy)"> を最大化するように <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> を調整することでハイパーパラメータの真値 <img src="https://latex.codecogs.com/png.latex?%5Cbeta%5E*"> と MAP 推定量 <img src="https://latex.codecogs.com/png.latex?x%5E*"> を同時に探索する．</p>
<p>具体的には，温度 <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> における自由エネルギーを計算し（<img src="https://latex.codecogs.com/png.latex?E">-ステップ），その最大化を図る（<img src="https://latex.codecogs.com/png.latex?M">-ステップ）ことを繰り返す．</p>
<p>スピングラスで西森ラインから外れた状態では物理量の正確な計算が困難であるように，EM アルゴリズムでも一般に <img src="https://latex.codecogs.com/png.latex?E">-ステップは intractable であることが知られている．</p>
<p>また，自由エネルギーの代わりに内部エネルギーを用い，最大値点 <img src="https://latex.codecogs.com/png.latex?%5Cbeta%5E*"> で満たすべき条件である西森条件 (6) を用いて <img src="https://latex.codecogs.com/png.latex?M">-ステップを実行することも考えられる．<sup>35</sup></p>
<p>即ち，西森条件を「成り立ってほしい条件」として，ハイパーパラメータの最大化に用いる方法が EM アルゴリズムであるとも捉えられるのである．</p>
</section>
</section>



<div id="quarto-appendix" class="default"><section id="終わりに" class="level2 appendix" data-number="4"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">4</span> 終わりに</h2><div class="quarto-appendix-contents">

<p>モデルの誤特定 <img src="https://latex.codecogs.com/png.latex?%5Cbeta%5Cne%5Cbeta%5E*"> が起こった場合，統計解析は泥沼に陥る．</p>
<p>この「泥沼」とは，物理的に正確な意味で，スピングラスであったわけだ．</p>
<p>逆に，モデルを正しく特定できているとき．通信の問題において，encoding と channel のモデルが正しく理解されているとき，復号難易度は大きく下がるはずである．これが，西森ライン上で物理量の計算が一気に簡単になる理由である．</p>
<!-- ::: {.callout-tip appearance="simple" icon="false" title="ToDo"}

* [@Krzakala-Zdeborova2024] でレプリカ計算をする．
* [@Mezard-Montanari2009] 12.3 節で，レプリカ計算の言葉による，スピングラスの自発的対称性の破れの議論を理解する．

::: -->



</div></section><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-Abbe+2014" class="csl-entry">
Abbe, E., Bandeira, A. S., Bracher, A., &amp; Singer, A. (2014). Decoding binary node labels from censored edge measurements: Phase transition and efficient recovery. <em>IEEE Transactions on Network Science and Engineering</em>, <em>1</em>(1), 10–22. <a href="https://doi.org/10.1109/TNSE.2014.2368716">https://doi.org/10.1109/TNSE.2014.2368716</a>
</div>
<div id="ref-Achlioptas-Coja-Oghlan2008" class="csl-entry">
Achlioptas, D., &amp; Coja-Oghlan, A. (2008). Algorithmic barriers from phase transitions. <em>2008 49th Annual IEEE Symposium on Foundations of Computer Science</em>, 793–802. <a href="https://doi.org/10.1109/FOCS.2008.11">https://doi.org/10.1109/FOCS.2008.11</a>
</div>
<div id="ref-Bryngelson-Wolynes1987" class="csl-entry">
Bryngelson, J. D., &amp; Wolynes, P. G. (1987). Spin glasses and the statistical mechanics of protein folding. <em>Proceedings of the National Academy of Sciences</em>, <em>84</em>(21), 7524–7528. <a href="https://doi.org/10.1073/pnas.84.21.7524">https://doi.org/10.1073/pnas.84.21.7524</a>
</div>
<div id="ref-Dempster+1977" class="csl-entry">
Dempster, A. P., Laird, N. M., &amp; Rubin, D. B. (1977). Maximum likelihood from incomplete data via the EM algorithm. <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, <em>39</em>(1), 1–22. <a href="https://rss.onlinelibrary.wiley.com/doi/10.1111/j.2517-6161.1977.tb01600.x">https://rss.onlinelibrary.wiley.com/doi/10.1111/j.2517-6161.1977.tb01600.x</a>
</div>
<div id="ref-Edwards-Anderson1975" class="csl-entry">
Edwards, S. F., &amp; Anderson, P. W. (1975). Theory of spin glasses. <em>Journal of Physics F: Metal Physics</em>, <em>5</em>(5), 965. <a href="https://doi.org/10.1088/0305-4608/5/5/017">https://doi.org/10.1088/0305-4608/5/5/017</a>
</div>
<div id="ref-Gallager1960" class="csl-entry">
Gallager, R. G. (1960). <em><span>Low Density Parity Check Codes</span></em> [PhD thesis, MIT]. <a href="http://hdl.handle.net/1721.1/11804">http://hdl.handle.net/1721.1/11804</a>
</div>
<div id="ref-Hopfield1982" class="csl-entry">
Hopfield, J. J. (1982). Neural networks and physical systems with emergent collective computational abilities. <em>Proceedings of the National Academy of Science</em>, <em>79</em>(8), 2554–2558. <a href="https://www.pnas.org/doi/10.1073/pnas.79.8.2554">https://www.pnas.org/doi/10.1073/pnas.79.8.2554</a>
</div>
<div id="ref-Iba1999" class="csl-entry">
Iba, Y. (1999). <span class="nocase">The Nishimori line and Bayesian statistics</span>. <em>Journal of Physics A: Mathematical and General</em>, <em>32</em>(21), 3875. <a href="https://doi.org/10.1088/0305-4470/32/21/302">https://doi.org/10.1088/0305-4470/32/21/302</a>
</div>
<div id="ref-Jerrum1992" class="csl-entry">
Jerrum, M. (1992). Large cliques elude the metropolis process. <em>Random Structures &amp; Algorithms</em>, <em>3</em>(4), 347–359.
</div>
<div id="ref-Jerrum-Sorkin1993" class="csl-entry">
Jerrum, M., &amp; Sorkin, G. B. (1993). Simulated annealing for graph bisection. <em>Proceedings of 1993 IEEE 34th Annual Foundations of Computer Science</em>, 94–103. <a href="https://doi.org/10.1109/SFCS.1993.366878">https://doi.org/10.1109/SFCS.1993.366878</a>
</div>
<div id="ref-Kabashima2005" class="csl-entry">
Kabashima, Y. (2005). Replicated bethe free energy: A variational principle behind survey propagation. <em>Journal of the Physical Society of Japan</em>, <em>74</em>(8), 2133–2136. <a href="https://doi.org/10.1143/JPSJ.74.2133">https://doi.org/10.1143/JPSJ.74.2133</a>
</div>
<div id="ref-Krzakala+2015" class="csl-entry">
Krzakala, F., Zdeborova, L., Angelini, M. C., &amp; Caltagirone, F. (2015). <em>Statistical physics of inference and bayesian estimation</em>. <a href="https://indico.ictp.it/event/a14244/material/10/0.pdf">https://indico.ictp.it/event/a14244/material/10/0.pdf</a>
</div>
<div id="ref-Mattis1976" class="csl-entry">
Mattis, D. C. (1976). Solvable spin systems with random interactions. <em>Physics Letters A</em>, <em>56</em>(5), 421–422. https://doi.org/<a href="https://doi.org/10.1016/0375-9601(76)90396-0">https://doi.org/10.1016/0375-9601(76)90396-0</a>
</div>
<div id="ref-Mezard-Montanari2009" class="csl-entry">
Mézard, M., &amp; Montanari, A. (2009). <em>Information, physics, and computation</em>. Oxford University Press. <a href="https://doi.org/10.1093/acprof:oso/9780198570837.001.0001">https://doi.org/10.1093/acprof:oso/9780198570837.001.0001</a>
</div>
<div id="ref-Mezard+2002" class="csl-entry">
Mézard, M., Parisi, G., &amp; Zecchina, R. (2002). Analytic and algorithmic solution of random satisfiability problems. <em>Science</em>, <em>297</em>(5582), 812–815. <a href="https://doi.org/10.1126/science.1073287">https://doi.org/10.1126/science.1073287</a>
</div>
<div id="ref-Nishimori1980" class="csl-entry">
Nishimori, H. (1980). Exact results and critical properties of the ising model with competing interactions. <em>Journal of Physics C: Solid State Physics</em>, <em>13</em>(21), 4071. <a href="https://doi.org/10.1088/0022-3719/13/21/012">https://doi.org/10.1088/0022-3719/13/21/012</a>
</div>
<div id="ref-Nishimori2001" class="csl-entry">
Nishimori, H. (2001). <em>Statistical physics of spin glasses and information processing: An introduction</em>. Oxford University Press. <a href="https://doi.org/10.1093/acprof:oso/9780198509417.001.0001">https://doi.org/10.1093/acprof:oso/9780198509417.001.0001</a>
</div>
<div id="ref-Sourlas1989" class="csl-entry">
Sourlas, N. (1989). Spin-glass models as error-correcting codes. <em>Nature</em>, <em>339</em>(6227), 693–695. <a href="https://doi.org/10.1038/339693a0">https://doi.org/10.1038/339693a0</a>
</div>
<div id="ref-Talagrand2011" class="csl-entry">
Talagrand, M. (2011). <em><span class="nocase">Mean Field Models for Spin Glasses. Volume I: Basic Examples</span></em>. Springer Berlin, Heidelberg. <a href="https://doi.org/10.1007/978-3-642-15202-3">https://doi.org/10.1007/978-3-642-15202-3</a>
</div>
<div id="ref-Zdeborova-Krzakala2016" class="csl-entry">
Zdeborová, L., &amp; Krzakala, F. (2016). Statistical physics of inference: Thresholds and algorithms. <em>Advances in Physics</em>, <em>65</em>(5), 453–552. <a href="https://doi.org/10.1080/00018732.2016.1211393">https://doi.org/10.1080/00018732.2016.1211393</a>
</div>
<div id="ref-横尾英俊2004" class="csl-entry">
横尾英俊. (2004). <em>情報理論の基礎</em>. 共立出版. <a href="https://www.kyoritsu-pub.co.jp/book/b10010336.html">https://www.kyoritsu-pub.co.jp/book/b10010336.html</a>
</div>
<div id="ref-樺島-杉浦2008" class="csl-entry">
樺島祥介, &amp; 杉浦正康. (2008). コトの物理学. <em>物性研究</em>, <em>91</em>(1), 1–33. <a href="http://hdl.handle.net/2433/142666">http://hdl.handle.net/2433/142666</a>
</div>
<div id="ref-西森秀稔1999" class="csl-entry">
西森秀稔. (1999). <em>スピングラス理論と情報統計力学</em>. 岩波書店. <a href="https://www.iwanami.co.jp/book/b259758.html">https://www.iwanami.co.jp/book/b259758.html</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><strong>西森ライン</strong> ともいう．<span class="citation" data-cites="Iba1999">(Iba, 1999)</span>，<span class="citation" data-cites="西森秀稔1999">(西森秀稔, 1999, p. 55)</span>など参照．↩︎</p></li>
<li id="fn2"><p><span class="citation" data-cites="横尾英俊2004">(横尾英俊, 2004, pp. 101–102)</span>も参照．↩︎</p></li>
<li id="fn3"><p><span class="citation" data-cites="横尾英俊2004">(横尾英俊, 2004, p. 106)</span> も参照．↩︎</p></li>
<li id="fn4"><p><span class="citation" data-cites="樺島-杉浦2008">(樺島祥介 &amp; 杉浦正康, 2008, p. 28)</span> も参照．↩︎</p></li>
<li id="fn5"><p><a href="https://ja.wikipedia.org/wiki/%E5%85%85%E8%B6%B3%E5%8F%AF%E8%83%BD%E6%80%A7%E5%95%8F%E9%A1%8C">充足可能性問題</a>と違い，３項以上の相互作用を考えてもクラス P のままである．<span class="citation" data-cites="Mezard-Montanari2009">(Mézard &amp; Montanari, 2009, p. 246)</span> や <span class="citation" data-cites="樺島-杉浦2008">(樺島祥介 &amp; 杉浦正康, 2008)</span> も参照．↩︎</p></li>
<li id="fn6"><p>例えば <span class="citation" data-cites="Talagrand2011">(Talagrand, 2011)</span> など．↩︎</p></li>
<li id="fn7"><p>従って，planted ensemble における <img src="https://latex.codecogs.com/png.latex?%5C%7By_%7Bij%7D%5C%7D"> は，同一の真値 <img src="https://latex.codecogs.com/png.latex?x%5E*"> で繋がっているため，強い相関を持つ．この相関から <img src="https://latex.codecogs.com/png.latex?x%5E*"> を読み解けるか？が逆に問題となっているのである．↩︎</p></li>
<li id="fn8"><p>特に，信号処理などの情報科学的な設定で，この対応がつけやすい．というのも，一般の統計的な問題では，「スピングラスを生成する」部分に相当するような，データ生成過程に対する事前知識を持っていることが稀であり，モデル選択も重要なトピックに入るためである．一方で，スピングラス系と対応づけるとき，モデル選択は一般に射程には入らない．<span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, p. 456)</span> も参照．一般の統計的問題を，どのようにしてスピングラスの planted ensemble と対応づけられるかについては，<span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, p. 468)</span> 1.3.2 節を参照．↩︎</p></li>
<li id="fn9"><p>こうして生成されたスピングラス系を，planted ensemble と呼び，このシナリオを機械学習の訓練過程に準えて teacher-student scenario とも呼ぶのが <span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, p. 462)</span> の用語である．これを <span class="citation" data-cites="Iba1999">(Iba, 1999, p. 3881)</span> は符号理論に準えて，encoding-decoding scenario と呼ぶべき設定で解説している．<span class="citation" data-cites="Mezard-Montanari2009">(Mézard &amp; Montanari, 2009, p. 249)</span> にも同様の通信に準えた記述がある．なお，最後の２つの文献では，事前分布 <img src="https://latex.codecogs.com/png.latex?p(x)"> を一様分布に限っている．↩︎</p></li>
<li id="fn10"><p><a href="../../../posts/2024/Stat/Bayes1.html">前稿</a> では，この <img src="https://latex.codecogs.com/png.latex?x"> を <img src="https://latex.codecogs.com/png.latex?x%5E*"> と表した．<span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016)</span> のように，これを lanted configuration または ground truth と呼ぶとわかりやすい．↩︎</p></li>
<li id="fn11"><p>この <img src="https://latex.codecogs.com/png.latex?y"> は quenched disorder ともいう．quenched disorder が，ある信号 <img src="https://latex.codecogs.com/png.latex?x"> とその通信 <img src="https://latex.codecogs.com/png.latex?p(y%7Cx)"> によって生成された系を，planted ensemble と考えるのである．そこで，<span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, p. 468)</span> は planted disorder と呼んでいる．大変良い呼び名である．↩︎</p></li>
<li id="fn12"><p><span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, p. 468)</span> に多くの関連文献がまとめられている．↩︎</p></li>
<li id="fn13"><p><span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, p. 476)</span> も参照．↩︎</p></li>
<li id="fn14"><p><span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, p. 475)</span> 2.1 節も参照．<span class="citation" data-cites="Krzakala+2015">(Krzakala et al., 2015, p. 13)</span> の <img src="https://latex.codecogs.com/png.latex?%5BZ%5En%5D_%7B%5Ctext%7Bplanted%7D%7D=%5Cfrac%7B%5BZ%5E%7Bn+1%7D%5D_%7B%5Ctext%7Bquenched%7D%7D%7D%7B%5BZ%5D_%7B%5Ctext%7Bquenched%7D%7D%7D"> も関係するかもしれない．↩︎</p></li>
<li id="fn15"><p><span class="citation" data-cites="Mezard-Montanari2009">(Mézard &amp; Montanari, 2009, p. 249)</span> では <img src="https://latex.codecogs.com/png.latex?%5B-%5D"> ではなく <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D"> で表されている．これを quenched average という．↩︎</p></li>
<li id="fn16"><p><span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, pp. 480–2.5節)</span>，<span class="citation" data-cites="Mezard-Montanari2009">(Mézard &amp; Montanari, 2009, pp. 102 5.4節)</span> が詳しい．↩︎</p></li>
<li id="fn17"><p>数学的な説明としては <span class="citation" data-cites="Talagrand2011">(Talagrand, 2011, p. 7)</span> も参照．↩︎</p></li>
<li id="fn18"><p>このことは物理学にも進展を与えており，従来考えられなかった解析が進むことがあるという． <span class="citation" data-cites="Krzakala+2015">(Krzakala et al., 2015, pp. 10 2.3節)</span> や <span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, p. 483)</span> 2.5.3 節 <em>Quiet Planing</em> を参照ください．↩︎</p></li>
<li id="fn19"><p><span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, p. 483)</span> 2.6 節，<span class="citation" data-cites="Mezard-Montanari2009">(Mézard &amp; Montanari, 2009, p. 253)</span> 12.3.3 節．↩︎</p></li>
<li id="fn20"><p><span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, p. 483)</span> 2.6 節の興味深い説明方法．↩︎</p></li>
<li id="fn21"><p><span class="citation" data-cites="Mezard-Montanari2009">(Mézard &amp; Montanari, 2009, p. 250)</span> 12.3.1 節参照．↩︎</p></li>
<li id="fn22"><p><span class="citation" data-cites="Mattis1976">(Mattis, 1976)</span> のモデルとも深い関連があるという．<span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, p. 474)</span> も参照．ここでは planted SG model と呼ばれている．↩︎</p></li>
<li id="fn23"><p>すなわち，<img src="https://latex.codecogs.com/png.latex?G(N,M)">-<a href="https://en.wikipedia.org/wiki/Erd%C5%91s%E2%80%93R%C3%A9nyi_model">Erdős–Rényi ランダムグラフ</a> とする．↩︎</p></li>
<li id="fn24"><p>従って，各 <img src="https://latex.codecogs.com/png.latex?y_%7Bij%7D"> は <img src="https://latex.codecogs.com/png.latex?x%5E*"> で条件付けると独立である．↩︎</p></li>
<li id="fn25"><p><span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, p. 475)</span>，<span class="citation" data-cites="Iba1999">(Iba, 1999, p. 3879)</span>．↩︎</p></li>
<li id="fn26"><p><span class="citation" data-cites="Krzakala+2015">(Krzakala et al., 2015, p. 6)</span> では MARG (Minimal Error Assignments Estimator) と呼ばれている．↩︎</p></li>
<li id="fn27"><p>また，平均場の設定では cavity method によって解ける．<span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, p. 475)</span> も参照．↩︎</p></li>
<li id="fn28"><p>この同一視は，Nishimori ensemble と planted ensemble との同一視と論じることもできる <span class="citation" data-cites="Krzakala+2015">(Krzakala et al., 2015, p. 12)</span> 2.6 節．↩︎</p></li>
<li id="fn29"><p><span class="citation" data-cites="Nishimori1980">(Nishimori, 1980)</span> の報告である．<span class="citation" data-cites="西森秀稔1999">(西森秀稔, 1999, pp. 53–53)</span>，<span class="citation" data-cites="Iba1999">(Iba, 1999, p. 3879)</span> 式 (25)，<span class="citation" data-cites="Mezard-Montanari2009">(Mézard &amp; Montanari, 2009, p. 248)</span> 式 (12.15) も参照．平均次数 <img src="https://latex.codecogs.com/png.latex?c"> を持つランダムグラフ上の Edwards-Anderson モデルでは，<img src="https://latex.codecogs.com/png.latex?M:=%5Clvert%5Cmathcal%7BE%7D%5Crvert=c/2"> となる．↩︎</p></li>
<li id="fn30"><p><img src="https://latex.codecogs.com/png.latex?%5Cbeta%5E*"> は <img src="https://latex.codecogs.com/png.latex?%5Crho"> の関数であることに注意．式 (2) 参照．↩︎</p></li>
<li id="fn31"><p><span class="citation" data-cites="西森秀稔1999">(西森秀稔, 1999, p. 55)</span> も参照．↩︎</p></li>
<li id="fn32"><p>これは静的な RSB 相が存在しないことを言う．１次の相転移，動的な one-step RSB (d1RSB) 相などは見られることがある <span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, pp. 484 2.7節)</span>．↩︎</p></li>
<li id="fn33"><p><span class="citation" data-cites="Iba1999">(Iba, 1999, p. 3882)</span> の時点で示唆されていた考え方である．↩︎</p></li>
<li id="fn34"><p><span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, pp. 478 2.3節)</span> も参照．↩︎</p></li>
<li id="fn35"><p><span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, p. 479)</span> 2.4節による素晴らしい洞察！↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Bayesian</category>
  <category>Nature</category>
  <category>Information</category>
  <guid>https://162348.github.io/posts/2024/Stat/Bayes2.html</guid>
  <pubDate>Sat, 22 Jun 2024 15:00:00 GMT</pubDate>
  <media:content url="https://162348.github.io/posts/2024/Stat/phase_regular_rev.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>ベイズ統計学と統計物理学</title>
  <dc:creator>司馬博文 </dc:creator>
  <link>https://162348.github.io/posts/2024/Stat/Bayes1.html</link>
  <description><![CDATA[ 





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<p>本稿では全ての結果に数学的に厳密な証明をつけることを優先し，簡単なモデルを取り上げた．</p>
<p>一般のモデルと，スピングラス理論との大局観は，次稿を参照：</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Stat/Bayes2.html" target="_blank">
            <img src="https://raw.githubusercontent.com/162348/162348.github.io/main/thumbnail.svg" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">ベイズ統計学とスピングラス</h3>
                <p class="article-description">誤り訂正符号を題材にして</p>
            </div>
        </a>
    </div>
</div>
<section id="bayes-推定" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="bayes-推定"><span class="header-section-number">1</span> Bayes 推定</h2>
<p>符号の誤り訂正，または denoising の文脈で Bayes 推定を考える．</p>
<p>雑音が加わる通信路から受け取った観測から真の信号を推定するというデノイジング問題は，Bayes 推定が自然に選好される格好の設定である．</p>
<section id="デノイジング問題としての設定" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="デノイジング問題としての設定"><span class="header-section-number">1.1</span> デノイジング問題としての設定</h3>
<p>情報源は無記憶で，確率分布 <img src="https://latex.codecogs.com/png.latex?p(x)dx"> に従うとし，通信路は，確率核 <img src="https://latex.codecogs.com/png.latex?p(y%7Cx)dy"> に従うとする．</p>
<p>送信符号は１つの実数 <img src="https://latex.codecogs.com/png.latex?x%5E*%5Csim%20p(x)dx"> であったとし，この単一の入力 <img src="https://latex.codecogs.com/png.latex?x%5E*"> を <img src="https://latex.codecogs.com/png.latex?n"> 回独立に観測する： <img src="https://latex.codecogs.com/png.latex?%0Ay_1,%5Ccdots,y_n%5Coverset%7B%5Ctext%7Biid%7D%7D%7B%5Csim%7Dp(y%7Cx%5E*)dy.%0A"></p>
<p>この観測を経たあと，送信符号 <img src="https://latex.codecogs.com/png.latex?x%5E*"> はいったい何だったのかを推定することを考えると，極めて自然に Bayes 推定が選択される．</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="純粋な解釈を持つ Bayes 推定">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
純粋な解釈を持つ Bayes 推定
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>まず，何の観測もない場合，<img src="https://latex.codecogs.com/png.latex?x%5E*"> の確率分布は <img src="https://latex.codecogs.com/png.latex?p(x)dx"> である（設定上）．</p>
<p>しかし，すでに観測 <img src="https://latex.codecogs.com/png.latex?y_1,%5Ccdots,y_n"> を経ている．よってこの事象の上での <img src="https://latex.codecogs.com/png.latex?x%5E*"> の条件付き分布を計算すれば良いことになる： <img src="https://latex.codecogs.com/png.latex?%0Ap(x%7Cy_1,%5Ccdots,y_n)%20=%20%5Cfrac%7Bp(%5Cboldsymbol%7By%7D%7Cx)p(x)%7D%7Bp(%5Cboldsymbol%7By%7D)%7D%0A"> <span id="eq-bayes"><img src="https://latex.codecogs.com/png.latex?%0A=%20%5Cfrac%7B%5Cdisplaystyle%20p(y_1%7Cx)%5Ccdots%20p(y_n%7Cx)p(x)%7D%7B%5Cdisplaystyle%5Cint_%5Cmathbb%7BR%7Dp(y_1%7Cx)%5Ccdots%20p(y_n%7Cx)p(x)%5C,dx%7D%0A%5Ctag%7B1%7D"></span></p>
<p>こうして，誤り訂正符号の文脈では，Bayes 事前確率・事後確率が純粋に確率（または頻度）としての解釈を持つ．通常の統計的枠組みよりも仮定が多いが，その仮定の形式が Bayes 推定の形式にピッタリなのである．</p>
<p>信号処理と Bayesian formalism の類似性は <span class="citation" data-cites="Iba1999">(Iba, 1999, p. 3876)</span>，<span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, p. 456)</span> でも指摘されている．</p>
<p>また，統計力学をベイズ推定の特殊な場合とみなせるという見方は，<span class="citation" data-cites="Jaynes1957">(Jaynes, 1957)</span> から始まる．<sup>1</sup></p>
</div>
</div>
</div>
</section>
<section id="sec-example" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="sec-example"><span class="header-section-number">1.2</span> 例：Delta-Gauss 混合</h3>
<p>入力は <img src="https://latex.codecogs.com/png.latex?1/2"> の確率で <img src="https://latex.codecogs.com/png.latex?x=0"> だが，もう <img src="https://latex.codecogs.com/png.latex?1/2"> の確率で標準正規分布 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BN%7D(0,1)"> に従うとする： <img src="https://latex.codecogs.com/png.latex?%0Ap(x)dx=%5Cfrac%7B1%7D%7B2%7D%5Cdelta_0(dx)+%5Cfrac%7B1%7D%7B2%7D%5Cmathrm%7BN%7D(0,1)(dx).%0A"> 通信路は加法的 Gauss 型であるとする： <img src="https://latex.codecogs.com/png.latex?%0Ap(x,y)=%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%7D%7D%5Cexp%5Cleft(-%5Cfrac%7B(x-y)%5E2%7D%7B2%7D%5Cright).%0A"> では真値を <img src="https://latex.codecogs.com/png.latex?x%5E*=1"> として，<img src="https://latex.codecogs.com/png.latex?n=10"> 回の観測データを生成してみる：</p>
<div id="7176aee4" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">using</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Random</span></span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Random</span>.<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seed!</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb1-4">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">randn</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(data)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1.8082879284649667, -0.12207250811417336, -0.10463610232929588, 0.5830073648350667, 1.2875879806238557, 1.2298186980518677, 0.5782313356003073, -0.355590621101197, -0.08821851393628699, 1.7037583257923017]</code></pre>
</div>
</div>
<p>愚直な計算から，<img src="https://latex.codecogs.com/png.latex?p(%5Cboldsymbol%7By%7D)"> は次の積分から得られる：</p>
<div class="script-size">
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20p(%5Cboldsymbol%7By%7D)&amp;=%5Cint_%5Cmathbb%7BR%7Dp(%5Cboldsymbol%7By%7D%7Cx)p(x)dx%5C%5C%0A%20%20%20%20&amp;=%5Cint_%5Cmathbb%7BR%7D%5Cprod_%7Bi=1%7D%5En%20p(y_i%7Cx)p(x)dx%5C%5C%0A%20%20%20%20&amp;=%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B1%7D%7B(2%5Cpi)%5E%7Bn+1%7D%7D%5Cint_%5Cmathbb%7BR%7D%5Cexp%5Cleft(-%5Cfrac%7B1%7D%7B2%7D%5Csum_%7Bi=1%7D%5En(y_i-x)%5E2+x%5E2%5Cright)dx%5C%5C%0A%20%20%20%20&amp;%5Cqquad+%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B1%7D%7B(2%5Cpi)%5En%7D%5Cexp%5Cleft(-%5Cfrac%7B1%7D%7B2%7D%5Csum_%7Bi=1%7D%5En(y_i-x)%5E2%5Cright)dx.%0A%5Cend%7Balign*%7D"></p>
</div>
<p>これを実際に計算した結果は <span class="citation" data-cites="Krzakala-Zdeborova2024">(Krazakala &amp; Zdeborová, 2024, p. 117)</span> で与えられている．</p>
<p>ここでは，邪教のような計算を啓示するのではなく，Julia と Turing を通じて計算する方法を紹介する <span class="citation" data-cites="Storopoli2021">(Storopoli, 2021)</span>．</p>
<div id="f782102e" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">using</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Turing</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Distributions</span></span>
<span id="cb3-2"></span>
<span id="cb3-3">prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">MixtureModel</span>([<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Normal</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Normal</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.005</span>)], [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>])</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">@model</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mixed_normal_model</span>(data)</span>
<span id="cb3-6">    μ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> prior</span>
<span id="cb3-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(data)</span>
<span id="cb3-8">        data[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Normal</span>(μ, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb3-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb3-11"></span>
<span id="cb3-12">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mixed_normal_model</span>(data)</span></code></pre></div>
</div>
<div id="b35bb5a8" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1">chain <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(model, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">NUTS</span>(), <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">100000</span>)</span></code></pre></div>
</div>
<div id="511f8eaa" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">using</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">MCMCChains</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Plots</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">StatsPlots</span></span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(chain[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>μ], seriestype <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>density, xlabel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x*"</span>, ylabel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density"</span>, title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Posterior Distribution"</span>, color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#80c4ac"</span>)</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vline!</span>([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>pink, linewidth <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x^* = 1"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="576" height="384" viewbox="0 0 2304 1536">
<defs>
  <clippath id="clip430">
    <rect x="0" y="0" width="2304" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip430)" d="M0 1536 L2304 1536 L2304 8.52651e-14 L0 8.52651e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip431">
    <rect x="460" y="0" width="1614" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip430)" d="M218.906 1359.82 L2256.76 1359.82 L2256.76 123.472 L218.906 123.472  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip432">
    <rect x="218" y="123" width="2039" height="1237"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="459.169,1359.82 459.169,123.472 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="810.851,1359.82 810.851,123.472 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1162.53,1359.82 1162.53,123.472 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1514.22,1359.82 1514.22,123.472 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1865.9,1359.82 1865.9,123.472 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2217.58,1359.82 2217.58,123.472 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,1359.82 2256.76,1359.82 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="459.169,1359.82 459.169,1340.92 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="810.851,1359.82 810.851,1340.92 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1162.53,1359.82 1162.53,1340.92 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1514.22,1359.82 1514.22,1340.92 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1865.9,1359.82 1865.9,1340.92 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2217.58,1359.82 2217.58,1340.92 "></polyline>
<path clip-path="url(#clip430)" d="M406.195 1404.62 L435.871 1404.62 L435.871 1408.56 L406.195 1408.56 L406.195 1404.62 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M455.963 1389.97 Q452.352 1389.97 450.523 1393.54 Q448.718 1397.08 448.718 1404.21 Q448.718 1411.31 450.523 1414.88 Q452.352 1418.42 455.963 1418.42 Q459.597 1418.42 461.403 1414.88 Q463.232 1411.31 463.232 1404.21 Q463.232 1397.08 461.403 1393.54 Q459.597 1389.97 455.963 1389.97 M455.963 1386.27 Q461.773 1386.27 464.829 1390.87 Q467.907 1395.46 467.907 1404.21 Q467.907 1412.93 464.829 1417.54 Q461.773 1422.12 455.963 1422.12 Q450.153 1422.12 447.074 1417.54 Q444.019 1412.93 444.019 1404.21 Q444.019 1395.46 447.074 1390.87 Q450.153 1386.27 455.963 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M476.125 1415.57 L481.009 1415.57 L481.009 1421.45 L476.125 1421.45 L476.125 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M491.241 1386.89 L509.597 1386.89 L509.597 1390.83 L495.523 1390.83 L495.523 1399.3 Q496.542 1398.95 497.56 1398.79 Q498.579 1398.6 499.597 1398.6 Q505.384 1398.6 508.764 1401.78 Q512.143 1404.95 512.143 1410.36 Q512.143 1415.94 508.671 1419.04 Q505.199 1422.12 498.88 1422.12 Q496.704 1422.12 494.435 1421.75 Q492.19 1421.38 489.782 1420.64 L489.782 1415.94 Q491.866 1417.08 494.088 1417.63 Q496.31 1418.19 498.787 1418.19 Q502.792 1418.19 505.129 1416.08 Q507.467 1413.98 507.467 1410.36 Q507.467 1406.75 505.129 1404.65 Q502.792 1402.54 498.787 1402.54 Q496.912 1402.54 495.037 1402.96 Q493.185 1403.37 491.241 1404.25 L491.241 1386.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M788.236 1389.97 Q784.625 1389.97 782.796 1393.54 Q780.991 1397.08 780.991 1404.21 Q780.991 1411.31 782.796 1414.88 Q784.625 1418.42 788.236 1418.42 Q791.87 1418.42 793.676 1414.88 Q795.504 1411.31 795.504 1404.21 Q795.504 1397.08 793.676 1393.54 Q791.87 1389.97 788.236 1389.97 M788.236 1386.27 Q794.046 1386.27 797.102 1390.87 Q800.18 1395.46 800.18 1404.21 Q800.18 1412.93 797.102 1417.54 Q794.046 1422.12 788.236 1422.12 Q782.426 1422.12 779.347 1417.54 Q776.291 1412.93 776.291 1404.21 Q776.291 1395.46 779.347 1390.87 Q782.426 1386.27 788.236 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M808.398 1415.57 L813.282 1415.57 L813.282 1421.45 L808.398 1421.45 L808.398 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M833.467 1389.97 Q829.856 1389.97 828.027 1393.54 Q826.222 1397.08 826.222 1404.21 Q826.222 1411.31 828.027 1414.88 Q829.856 1418.42 833.467 1418.42 Q837.101 1418.42 838.907 1414.88 Q840.736 1411.31 840.736 1404.21 Q840.736 1397.08 838.907 1393.54 Q837.101 1389.97 833.467 1389.97 M833.467 1386.27 Q839.277 1386.27 842.333 1390.87 Q845.411 1395.46 845.411 1404.21 Q845.411 1412.93 842.333 1417.54 Q839.277 1422.12 833.467 1422.12 Q827.657 1422.12 824.578 1417.54 Q821.523 1412.93 821.523 1404.21 Q821.523 1395.46 824.578 1390.87 Q827.657 1386.27 833.467 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1140.42 1389.97 Q1136.8 1389.97 1134.98 1393.54 Q1133.17 1397.08 1133.17 1404.21 Q1133.17 1411.31 1134.98 1414.88 Q1136.8 1418.42 1140.42 1418.42 Q1144.05 1418.42 1145.86 1414.88 Q1147.68 1411.31 1147.68 1404.21 Q1147.68 1397.08 1145.86 1393.54 Q1144.05 1389.97 1140.42 1389.97 M1140.42 1386.27 Q1146.23 1386.27 1149.28 1390.87 Q1152.36 1395.46 1152.36 1404.21 Q1152.36 1412.93 1149.28 1417.54 Q1146.23 1422.12 1140.42 1422.12 Q1134.61 1422.12 1131.53 1417.54 Q1128.47 1412.93 1128.47 1404.21 Q1128.47 1395.46 1131.53 1390.87 Q1134.61 1386.27 1140.42 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1160.58 1415.57 L1165.46 1415.57 L1165.46 1421.45 L1160.58 1421.45 L1160.58 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1175.69 1386.89 L1194.05 1386.89 L1194.05 1390.83 L1179.98 1390.83 L1179.98 1399.3 Q1180.99 1398.95 1182.01 1398.79 Q1183.03 1398.6 1184.05 1398.6 Q1189.84 1398.6 1193.22 1401.78 Q1196.6 1404.95 1196.6 1410.36 Q1196.6 1415.94 1193.12 1419.04 Q1189.65 1422.12 1183.33 1422.12 Q1181.16 1422.12 1178.89 1421.75 Q1176.64 1421.38 1174.24 1420.64 L1174.24 1415.94 Q1176.32 1417.08 1178.54 1417.63 Q1180.76 1418.19 1183.24 1418.19 Q1187.24 1418.19 1189.58 1416.08 Q1191.92 1413.98 1191.92 1410.36 Q1191.92 1406.75 1189.58 1404.65 Q1187.24 1402.54 1183.24 1402.54 Q1181.36 1402.54 1179.49 1402.96 Q1177.64 1403.37 1175.69 1404.25 L1175.69 1386.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1481.37 1417.52 L1489.01 1417.52 L1489.01 1391.15 L1480.7 1392.82 L1480.7 1388.56 L1488.96 1386.89 L1493.64 1386.89 L1493.64 1417.52 L1501.28 1417.52 L1501.28 1421.45 L1481.37 1421.45 L1481.37 1417.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1510.72 1415.57 L1515.61 1415.57 L1515.61 1421.45 L1510.72 1421.45 L1510.72 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1535.79 1389.97 Q1532.18 1389.97 1530.35 1393.54 Q1528.54 1397.08 1528.54 1404.21 Q1528.54 1411.31 1530.35 1414.88 Q1532.18 1418.42 1535.79 1418.42 Q1539.42 1418.42 1541.23 1414.88 Q1543.06 1411.31 1543.06 1404.21 Q1543.06 1397.08 1541.23 1393.54 Q1539.42 1389.97 1535.79 1389.97 M1535.79 1386.27 Q1541.6 1386.27 1544.66 1390.87 Q1547.73 1395.46 1547.73 1404.21 Q1547.73 1412.93 1544.66 1417.54 Q1541.6 1422.12 1535.79 1422.12 Q1529.98 1422.12 1526.9 1417.54 Q1523.85 1412.93 1523.85 1404.21 Q1523.85 1395.46 1526.9 1390.87 Q1529.98 1386.27 1535.79 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1833.55 1417.52 L1841.19 1417.52 L1841.19 1391.15 L1832.88 1392.82 L1832.88 1388.56 L1841.14 1386.89 L1845.82 1386.89 L1845.82 1417.52 L1853.46 1417.52 L1853.46 1421.45 L1833.55 1421.45 L1833.55 1417.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1862.9 1415.57 L1867.79 1415.57 L1867.79 1421.45 L1862.9 1421.45 L1862.9 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1878.02 1386.89 L1896.37 1386.89 L1896.37 1390.83 L1882.3 1390.83 L1882.3 1399.3 Q1883.32 1398.95 1884.34 1398.79 Q1885.35 1398.6 1886.37 1398.6 Q1892.16 1398.6 1895.54 1401.78 Q1898.92 1404.95 1898.92 1410.36 Q1898.92 1415.94 1895.45 1419.04 Q1891.97 1422.12 1885.66 1422.12 Q1883.48 1422.12 1881.21 1421.75 Q1878.97 1421.38 1876.56 1420.64 L1876.56 1415.94 Q1878.64 1417.08 1880.86 1417.63 Q1883.09 1418.19 1885.56 1418.19 Q1889.57 1418.19 1891.91 1416.08 Q1894.24 1413.98 1894.24 1410.36 Q1894.24 1406.75 1891.91 1404.65 Q1889.57 1402.54 1885.56 1402.54 Q1883.69 1402.54 1881.81 1402.96 Q1879.96 1403.37 1878.02 1404.25 L1878.02 1386.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M2188.82 1417.52 L2205.14 1417.52 L2205.14 1421.45 L2183.19 1421.45 L2183.19 1417.52 Q2185.86 1414.76 2190.44 1410.13 Q2195.05 1405.48 2196.23 1404.14 Q2198.47 1401.61 2199.35 1399.88 Q2200.25 1398.12 2200.25 1396.43 Q2200.25 1393.67 2198.31 1391.94 Q2196.39 1390.2 2193.29 1390.2 Q2191.09 1390.2 2188.63 1390.97 Q2186.2 1391.73 2183.43 1393.28 L2183.43 1388.56 Q2186.25 1387.42 2188.7 1386.85 Q2191.16 1386.27 2193.19 1386.27 Q2198.57 1386.27 2201.76 1388.95 Q2204.95 1391.64 2204.95 1396.13 Q2204.95 1398.26 2204.14 1400.18 Q2203.36 1402.08 2201.25 1404.67 Q2200.67 1405.34 2197.57 1408.56 Q2194.47 1411.75 2188.82 1417.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M2214.95 1415.57 L2219.84 1415.57 L2219.84 1421.45 L2214.95 1421.45 L2214.95 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M2240.02 1389.97 Q2236.41 1389.97 2234.58 1393.54 Q2232.78 1397.08 2232.78 1404.21 Q2232.78 1411.31 2234.58 1414.88 Q2236.41 1418.42 2240.02 1418.42 Q2243.66 1418.42 2245.46 1414.88 Q2247.29 1411.31 2247.29 1404.21 Q2247.29 1397.08 2245.46 1393.54 Q2243.66 1389.97 2240.02 1389.97 M2240.02 1386.27 Q2245.83 1386.27 2248.89 1390.87 Q2251.97 1395.46 2251.97 1404.21 Q2251.97 1412.93 2248.89 1417.54 Q2245.83 1422.12 2240.02 1422.12 Q2234.21 1422.12 2231.13 1417.54 Q2228.08 1412.93 2228.08 1404.21 Q2228.08 1395.46 2231.13 1390.87 Q2234.21 1386.27 2240.02 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1238.05 1467.6 L1225.16 1484.94 L1238.72 1503.24 L1231.82 1503.24 L1221.44 1489.24 L1211.06 1503.24 L1204.16 1503.24 L1218 1484.59 L1205.33 1467.6 L1212.24 1467.6 L1221.69 1480.3 L1231.15 1467.6 L1238.05 1467.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1271.51 1463.55 L1260.08 1469.73 L1271.51 1475.93 L1269.66 1479.05 L1258.97 1472.59 L1258.97 1484.59 L1255.34 1484.59 L1255.34 1472.59 L1244.64 1479.05 L1242.8 1475.93 L1254.22 1469.73 L1242.8 1463.55 L1244.64 1460.4 L1255.34 1466.86 L1255.34 1454.86 L1258.97 1454.86 L1258.97 1466.86 L1269.66 1460.4 L1271.51 1463.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,1324.83 2256.76,1324.83 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,1143.01 2256.76,1143.01 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,961.193 2256.76,961.193 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,779.374 2256.76,779.374 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,597.556 2256.76,597.556 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,415.738 2256.76,415.738 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.906,233.92 2256.76,233.92 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,1359.82 218.906,123.472 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,1324.83 237.804,1324.83 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,1143.01 237.804,1143.01 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,961.193 237.804,961.193 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,779.374 237.804,779.374 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,597.556 237.804,597.556 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,415.738 237.804,415.738 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.906,233.92 237.804,233.92 "></polyline>
<path clip-path="url(#clip430)" d="M127.171 1310.63 Q123.56 1310.63 121.731 1314.19 Q119.925 1317.73 119.925 1324.86 Q119.925 1331.97 121.731 1335.53 Q123.56 1339.08 127.171 1339.08 Q130.805 1339.08 132.61 1335.53 Q134.439 1331.97 134.439 1324.86 Q134.439 1317.73 132.61 1314.19 Q130.805 1310.63 127.171 1310.63 M127.171 1306.92 Q132.981 1306.92 136.036 1311.53 Q139.115 1316.11 139.115 1324.86 Q139.115 1333.59 136.036 1338.2 Q132.981 1342.78 127.171 1342.78 Q121.36 1342.78 118.282 1338.2 Q115.226 1333.59 115.226 1324.86 Q115.226 1316.11 118.282 1311.53 Q121.36 1306.92 127.171 1306.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M147.333 1336.23 L152.217 1336.23 L152.217 1342.11 L147.333 1342.11 L147.333 1336.23 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M172.402 1310.63 Q168.791 1310.63 166.962 1314.19 Q165.157 1317.73 165.157 1324.86 Q165.157 1331.97 166.962 1335.53 Q168.791 1339.08 172.402 1339.08 Q176.036 1339.08 177.842 1335.53 Q179.67 1331.97 179.67 1324.86 Q179.67 1317.73 177.842 1314.19 Q176.036 1310.63 172.402 1310.63 M172.402 1306.92 Q178.212 1306.92 181.268 1311.53 Q184.346 1316.11 184.346 1324.86 Q184.346 1333.59 181.268 1338.2 Q178.212 1342.78 172.402 1342.78 Q166.592 1342.78 163.513 1338.2 Q160.458 1333.59 160.458 1324.86 Q160.458 1316.11 163.513 1311.53 Q166.592 1306.92 172.402 1306.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M128.768 1128.81 Q125.157 1128.81 123.328 1132.37 Q121.523 1135.92 121.523 1143.05 Q121.523 1150.15 123.328 1153.72 Q125.157 1157.26 128.768 1157.26 Q132.402 1157.26 134.208 1153.72 Q136.036 1150.15 136.036 1143.05 Q136.036 1135.92 134.208 1132.37 Q132.402 1128.81 128.768 1128.81 M128.768 1125.11 Q134.578 1125.11 137.634 1129.71 Q140.712 1134.3 140.712 1143.05 Q140.712 1151.77 137.634 1156.38 Q134.578 1160.96 128.768 1160.96 Q122.958 1160.96 119.879 1156.38 Q116.823 1151.77 116.823 1143.05 Q116.823 1134.3 119.879 1129.71 Q122.958 1125.11 128.768 1125.11 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M148.93 1154.41 L153.814 1154.41 L153.814 1160.29 L148.93 1160.29 L148.93 1154.41 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M168.027 1156.36 L184.346 1156.36 L184.346 1160.29 L162.402 1160.29 L162.402 1156.36 Q165.064 1153.6 169.647 1148.97 Q174.254 1144.32 175.434 1142.98 Q177.68 1140.45 178.559 1138.72 Q179.462 1136.96 179.462 1135.27 Q179.462 1132.51 177.518 1130.78 Q175.596 1129.04 172.494 1129.04 Q170.295 1129.04 167.842 1129.8 Q165.411 1130.57 162.633 1132.12 L162.633 1127.4 Q165.457 1126.26 167.911 1125.68 Q170.365 1125.11 172.402 1125.11 Q177.772 1125.11 180.967 1127.79 Q184.161 1130.48 184.161 1134.97 Q184.161 1137.1 183.351 1139.02 Q182.564 1140.92 180.457 1143.51 Q179.879 1144.18 176.777 1147.4 Q173.675 1150.59 168.027 1156.36 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M126.685 946.991 Q123.073 946.991 121.245 950.556 Q119.439 954.098 119.439 961.227 Q119.439 968.334 121.245 971.899 Q123.073 975.44 126.685 975.44 Q130.319 975.44 132.124 971.899 Q133.953 968.334 133.953 961.227 Q133.953 954.098 132.124 950.556 Q130.319 946.991 126.685 946.991 M126.685 943.288 Q132.495 943.288 135.55 947.894 Q138.629 952.477 138.629 961.227 Q138.629 969.954 135.55 974.561 Q132.495 979.144 126.685 979.144 Q120.874 979.144 117.796 974.561 Q114.74 969.954 114.74 961.227 Q114.74 952.477 117.796 947.894 Q120.874 943.288 126.685 943.288 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M146.846 972.593 L151.731 972.593 L151.731 978.473 L146.846 978.473 L146.846 972.593 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M174.763 947.987 L162.957 966.436 L174.763 966.436 L174.763 947.987 M173.536 943.913 L179.416 943.913 L179.416 966.436 L184.346 966.436 L184.346 970.324 L179.416 970.324 L179.416 978.473 L174.763 978.473 L174.763 970.324 L159.161 970.324 L159.161 965.811 L173.536 943.913 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M127.009 765.173 Q123.398 765.173 121.569 768.738 Q119.763 772.28 119.763 779.409 Q119.763 786.516 121.569 790.08 Q123.398 793.622 127.009 793.622 Q130.643 793.622 132.448 790.08 Q134.277 786.516 134.277 779.409 Q134.277 772.28 132.448 768.738 Q130.643 765.173 127.009 765.173 M127.009 761.469 Q132.819 761.469 135.874 766.076 Q138.953 770.659 138.953 779.409 Q138.953 788.136 135.874 792.742 Q132.819 797.326 127.009 797.326 Q121.198 797.326 118.12 792.742 Q115.064 788.136 115.064 779.409 Q115.064 770.659 118.12 766.076 Q121.198 761.469 127.009 761.469 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M147.171 790.775 L152.055 790.775 L152.055 796.654 L147.171 796.654 L147.171 790.775 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M172.819 777.511 Q169.67 777.511 167.819 779.664 Q165.99 781.817 165.99 785.566 Q165.99 789.293 167.819 791.469 Q169.67 793.622 172.819 793.622 Q175.967 793.622 177.795 791.469 Q179.647 789.293 179.647 785.566 Q179.647 781.817 177.795 779.664 Q175.967 777.511 172.819 777.511 M182.101 762.858 L182.101 767.118 Q180.342 766.284 178.536 765.844 Q176.754 765.405 174.994 765.405 Q170.365 765.405 167.911 768.53 Q165.481 771.655 165.133 777.974 Q166.499 775.96 168.559 774.895 Q170.619 773.807 173.096 773.807 Q178.305 773.807 181.314 776.979 Q184.346 780.127 184.346 785.566 Q184.346 790.891 181.198 794.108 Q178.05 797.326 172.819 797.326 Q166.823 797.326 163.652 792.742 Q160.481 788.136 160.481 779.409 Q160.481 771.215 164.37 766.354 Q168.258 761.469 174.809 761.469 Q176.569 761.469 178.351 761.817 Q180.156 762.164 182.101 762.858 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M127.263 583.355 Q123.652 583.355 121.823 586.92 Q120.018 590.461 120.018 597.591 Q120.018 604.697 121.823 608.262 Q123.652 611.804 127.263 611.804 Q130.897 611.804 132.703 608.262 Q134.532 604.697 134.532 597.591 Q134.532 590.461 132.703 586.92 Q130.897 583.355 127.263 583.355 M127.263 579.651 Q133.073 579.651 136.129 584.258 Q139.208 588.841 139.208 597.591 Q139.208 606.318 136.129 610.924 Q133.073 615.508 127.263 615.508 Q121.453 615.508 118.374 610.924 Q115.319 606.318 115.319 597.591 Q115.319 588.841 118.374 584.258 Q121.453 579.651 127.263 579.651 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M147.425 608.957 L152.309 608.957 L152.309 614.836 L147.425 614.836 L147.425 608.957 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M172.494 598.424 Q169.161 598.424 167.24 600.207 Q165.342 601.989 165.342 605.114 Q165.342 608.239 167.24 610.021 Q169.161 611.804 172.494 611.804 Q175.828 611.804 177.749 610.021 Q179.67 608.216 179.67 605.114 Q179.67 601.989 177.749 600.207 Q175.851 598.424 172.494 598.424 M167.819 596.434 Q164.809 595.693 163.12 593.633 Q161.453 591.572 161.453 588.61 Q161.453 584.466 164.393 582.059 Q167.356 579.651 172.494 579.651 Q177.656 579.651 180.596 582.059 Q183.536 584.466 183.536 588.61 Q183.536 591.572 181.846 593.633 Q180.18 595.693 177.194 596.434 Q180.573 597.221 182.448 599.512 Q184.346 601.804 184.346 605.114 Q184.346 610.137 181.268 612.822 Q178.212 615.508 172.494 615.508 Q166.777 615.508 163.698 612.822 Q160.643 610.137 160.643 605.114 Q160.643 601.804 162.541 599.512 Q164.439 597.221 167.819 596.434 M166.106 589.049 Q166.106 591.734 167.772 593.239 Q169.462 594.744 172.494 594.744 Q175.504 594.744 177.194 593.239 Q178.906 591.734 178.906 589.049 Q178.906 586.364 177.194 584.86 Q175.504 583.355 172.494 583.355 Q169.462 583.355 167.772 584.86 Q166.106 586.364 166.106 589.049 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M117.981 429.083 L125.62 429.083 L125.62 402.717 L117.31 404.384 L117.31 400.125 L125.573 398.458 L130.249 398.458 L130.249 429.083 L137.888 429.083 L137.888 433.018 L117.981 433.018 L117.981 429.083 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M147.333 427.138 L152.217 427.138 L152.217 433.018 L147.333 433.018 L147.333 427.138 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M172.402 401.537 Q168.791 401.537 166.962 405.102 Q165.157 408.643 165.157 415.773 Q165.157 422.879 166.962 426.444 Q168.791 429.986 172.402 429.986 Q176.036 429.986 177.842 426.444 Q179.67 422.879 179.67 415.773 Q179.67 408.643 177.842 405.102 Q176.036 401.537 172.402 401.537 M172.402 397.833 Q178.212 397.833 181.268 402.439 Q184.346 407.023 184.346 415.773 Q184.346 424.5 181.268 429.106 Q178.212 433.689 172.402 433.689 Q166.592 433.689 163.513 429.106 Q160.458 424.5 160.458 415.773 Q160.458 407.023 163.513 402.439 Q166.592 397.833 172.402 397.833 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M119.578 247.265 L127.217 247.265 L127.217 220.899 L118.907 222.566 L118.907 218.307 L127.171 216.64 L131.847 216.64 L131.847 247.265 L139.485 247.265 L139.485 251.2 L119.578 251.2 L119.578 247.265 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M148.93 245.32 L153.814 245.32 L153.814 251.2 L148.93 251.2 L148.93 245.32 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M168.027 247.265 L184.346 247.265 L184.346 251.2 L162.402 251.2 L162.402 247.265 Q165.064 244.51 169.647 239.88 Q174.254 235.228 175.434 233.885 Q177.68 231.362 178.559 229.626 Q179.462 227.867 179.462 226.177 Q179.462 223.422 177.518 221.686 Q175.596 219.95 172.494 219.95 Q170.295 219.95 167.842 220.714 Q165.411 221.478 162.633 223.029 L162.633 218.307 Q165.457 217.172 167.911 216.594 Q170.365 216.015 172.402 216.015 Q177.772 216.015 180.967 218.7 Q184.161 221.385 184.161 225.876 Q184.161 228.006 183.351 229.927 Q182.564 231.825 180.457 234.418 Q179.879 235.089 176.777 238.306 Q173.675 241.501 168.027 247.265 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M23.6877 854.956 L60.6406 854.956 L60.6406 847.189 Q60.6406 837.354 56.1846 832.803 Q51.7286 828.22 42.1164 828.22 Q32.5679 828.22 28.1437 832.803 Q23.6877 837.354 23.6877 847.189 L23.6877 854.956 M18.4042 861.385 L18.4042 848.176 Q18.4042 834.363 24.1651 827.901 Q29.8943 821.44 42.1164 821.44 Q54.4022 821.44 60.1632 827.933 Q65.9242 834.426 65.9242 848.176 L65.9242 861.385 L18.4042 861.385 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M46.6361 780.954 L49.5006 780.954 L49.5006 807.881 Q55.5481 807.499 58.7309 804.253 Q61.8819 800.974 61.8819 795.15 Q61.8819 791.776 61.0544 788.625 Q60.2269 785.442 58.5718 782.323 L64.1099 782.323 Q65.4467 785.474 66.147 788.784 Q66.8472 792.094 66.8472 795.5 Q66.8472 804.03 61.8819 809.027 Q56.9167 813.992 48.4503 813.992 Q39.6974 813.992 34.5731 809.282 Q29.4168 804.539 29.4168 796.518 Q29.4168 789.325 34.0638 785.156 Q38.6789 780.954 46.6361 780.954 M44.9173 786.811 Q40.1112 786.874 37.2466 789.516 Q34.3821 792.126 34.3821 796.455 Q34.3821 801.356 37.1512 804.316 Q39.9202 807.245 44.9492 807.69 L44.9173 786.811 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M44.4081 741.71 L65.9242 741.71 L65.9242 747.566 L44.599 747.566 Q39.5383 747.566 37.0238 749.539 Q34.5094 751.513 34.5094 755.46 Q34.5094 760.202 37.5331 762.939 Q40.5568 765.677 45.7767 765.677 L65.9242 765.677 L65.9242 771.565 L30.2762 771.565 L30.2762 765.677 L35.8144 765.677 Q32.5997 763.576 31.0083 760.743 Q29.4168 757.879 29.4168 754.155 Q29.4168 748.012 33.2363 744.861 Q37.0238 741.71 44.4081 741.71 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M31.3265 707.303 L36.8647 707.303 Q35.5916 709.786 34.955 712.459 Q34.3184 715.133 34.3184 717.997 Q34.3184 722.358 35.6552 724.554 Q36.992 726.718 39.6656 726.718 Q41.7026 726.718 42.8803 725.159 Q44.0261 723.599 45.0765 718.889 L45.5221 716.883 Q46.8589 710.645 49.3097 708.035 Q51.7286 705.393 56.0891 705.393 Q61.0544 705.393 63.9508 709.34 Q66.8472 713.255 66.8472 720.13 Q66.8472 722.994 66.2743 726.114 Q65.7332 729.201 64.6192 732.639 L58.5718 732.639 Q60.2587 729.392 61.118 726.241 Q61.9456 723.09 61.9456 720.003 Q61.9456 715.865 60.5451 713.637 Q59.1129 711.409 56.5347 711.409 Q54.1476 711.409 52.8745 713.032 Q51.6013 714.624 50.4237 720.066 L49.9462 722.103 Q48.8004 727.546 46.4451 729.965 Q44.058 732.384 39.9202 732.384 Q34.8913 732.384 32.1541 728.819 Q29.4168 725.254 29.4168 718.698 Q29.4168 715.451 29.8943 712.587 Q30.3717 709.722 31.3265 707.303 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M30.2762 696.068 L30.2762 690.211 L65.9242 690.211 L65.9242 696.068 L30.2762 696.068 M16.399 696.068 L16.399 690.211 L23.815 690.211 L23.815 696.068 L16.399 696.068 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M20.1547 672.164 L30.2762 672.164 L30.2762 660.101 L34.8277 660.101 L34.8277 672.164 L54.1794 672.164 Q58.5399 672.164 59.7813 670.987 Q61.0226 669.777 61.0226 666.117 L61.0226 660.101 L65.9242 660.101 L65.9242 666.117 Q65.9242 672.896 63.4097 675.474 Q60.8634 678.053 54.1794 678.053 L34.8277 678.053 L34.8277 682.349 L30.2762 682.349 L30.2762 678.053 L20.1547 678.053 L20.1547 672.164 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M69.2343 637.567 Q75.6 640.049 77.5416 642.405 Q79.4831 644.76 79.4831 648.707 L79.4831 653.385 L74.5815 653.385 L74.5815 649.948 Q74.5815 647.529 73.4357 646.192 Q72.2899 644.855 68.0248 643.232 L65.3512 642.182 L30.2762 656.6 L30.2762 650.394 L58.158 639.254 L30.2762 628.114 L30.2762 621.907 L69.2343 637.567 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M815.099 18.8205 L815.099 41.5461 L825.388 41.5461 Q831.1 41.5461 834.219 38.5889 Q837.338 35.6318 837.338 30.163 Q837.338 24.7348 834.219 21.7777 Q831.1 18.8205 825.388 18.8205 L815.099 18.8205 M806.916 12.096 L825.388 12.096 Q835.556 12.096 840.741 16.714 Q845.967 21.2916 845.967 30.163 Q845.967 39.1155 840.741 43.6931 Q835.556 48.2706 825.388 48.2706 L815.099 48.2706 L815.099 72.576 L806.916 72.576 L806.916 12.096 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M871.245 32.4315 Q865.249 32.4315 861.765 37.1306 Q858.282 41.7891 858.282 49.9314 Q858.282 58.0738 861.725 62.7728 Q865.209 67.4314 871.245 67.4314 Q877.199 67.4314 880.683 62.7323 Q884.167 58.0333 884.167 49.9314 Q884.167 41.8701 880.683 37.1711 Q877.199 32.4315 871.245 32.4315 M871.245 26.1121 Q880.967 26.1121 886.516 32.4315 Q892.066 38.7509 892.066 49.9314 Q892.066 61.0714 886.516 67.4314 Q880.967 73.7508 871.245 73.7508 Q861.482 73.7508 855.932 67.4314 Q850.423 61.0714 850.423 49.9314 Q850.423 38.7509 855.932 32.4315 Q861.482 26.1121 871.245 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M933.345 28.5427 L933.345 35.5912 Q930.185 33.9709 926.782 33.1607 Q923.38 32.3505 919.734 32.3505 Q914.184 32.3505 911.389 34.0519 Q908.634 35.7533 908.634 39.156 Q908.634 41.7486 910.619 43.2475 Q912.604 44.7058 918.6 46.0426 L921.152 46.6097 Q929.091 48.3111 932.413 51.4303 Q935.775 54.509 935.775 60.0587 Q935.775 66.3781 930.752 70.0644 Q925.77 73.7508 917.02 73.7508 Q913.374 73.7508 909.404 73.0216 Q905.475 72.3329 901.1 70.9151 L901.1 63.2184 Q905.232 65.3654 909.242 66.4591 Q913.252 67.5124 917.182 67.5124 Q922.448 67.5124 925.284 65.73 Q928.119 63.9071 928.119 60.6258 Q928.119 57.5877 926.053 55.9673 Q924.028 54.3469 917.101 52.8481 L914.508 52.2405 Q907.581 50.7821 904.502 47.7845 Q901.424 44.7463 901.424 39.4801 Q901.424 33.0797 905.961 29.5959 Q910.498 26.1121 918.843 26.1121 Q922.975 26.1121 926.62 26.7198 Q930.266 27.3274 933.345 28.5427 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M955.017 14.324 L955.017 27.2059 L970.37 27.2059 L970.37 32.9987 L955.017 32.9987 L955.017 57.6282 Q955.017 63.1779 956.516 64.7578 Q958.055 66.3376 962.714 66.3376 L970.37 66.3376 L970.37 72.576 L962.714 72.576 Q954.085 72.576 950.804 69.3758 Q947.523 66.1351 947.523 57.6282 L947.523 32.9987 L942.054 32.9987 L942.054 27.2059 L947.523 27.2059 L947.523 14.324 L955.017 14.324 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1018.98 48.0275 L1018.98 51.6733 L984.71 51.6733 Q985.196 59.3701 989.328 63.421 Q993.501 67.4314 1000.91 67.4314 Q1005.21 67.4314 1009.22 66.3781 Q1013.27 65.3249 1017.24 63.2184 L1017.24 70.267 Q1013.23 71.9684 1009.02 72.8596 Q1004.8 73.7508 1000.47 73.7508 Q989.612 73.7508 983.252 67.4314 Q976.933 61.1119 976.933 50.3365 Q976.933 39.1965 982.928 32.6746 Q988.964 26.1121 999.172 26.1121 Q1008.33 26.1121 1013.63 32.0264 Q1018.98 37.9003 1018.98 48.0275 M1011.53 45.84 Q1011.45 39.7232 1008.08 36.0774 Q1004.76 32.4315 999.253 32.4315 Q993.015 32.4315 989.247 35.9558 Q985.521 39.4801 984.953 45.8805 L1011.53 45.84 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1057.51 34.1734 Q1056.25 33.4443 1054.75 33.1202 Q1053.29 32.7556 1051.51 32.7556 Q1045.19 32.7556 1041.79 36.8875 Q1038.43 40.9789 1038.43 48.6757 L1038.43 72.576 L1030.93 72.576 L1030.93 27.2059 L1038.43 27.2059 L1038.43 34.2544 Q1040.77 30.1225 1044.54 28.1376 Q1048.31 26.1121 1053.7 26.1121 Q1054.47 26.1121 1055.4 26.2337 Q1056.33 26.3147 1057.46 26.5172 L1057.51 34.1734 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1065.32 27.2059 L1072.78 27.2059 L1072.78 72.576 L1065.32 72.576 L1065.32 27.2059 M1065.32 9.54393 L1072.78 9.54393 L1072.78 18.9825 L1065.32 18.9825 L1065.32 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1105.95 32.4315 Q1099.96 32.4315 1096.47 37.1306 Q1092.99 41.7891 1092.99 49.9314 Q1092.99 58.0738 1096.43 62.7728 Q1099.92 67.4314 1105.95 67.4314 Q1111.91 67.4314 1115.39 62.7323 Q1118.88 58.0333 1118.88 49.9314 Q1118.88 41.8701 1115.39 37.1711 Q1111.91 32.4315 1105.95 32.4315 M1105.95 26.1121 Q1115.68 26.1121 1121.23 32.4315 Q1126.78 38.7509 1126.78 49.9314 Q1126.78 61.0714 1121.23 67.4314 Q1115.68 73.7508 1105.95 73.7508 Q1096.19 73.7508 1090.64 67.4314 Q1085.13 61.0714 1085.13 49.9314 Q1085.13 38.7509 1090.64 32.4315 Q1096.19 26.1121 1105.95 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1165.42 34.1734 Q1164.17 33.4443 1162.67 33.1202 Q1161.21 32.7556 1159.43 32.7556 Q1153.11 32.7556 1149.7 36.8875 Q1146.34 40.9789 1146.34 48.6757 L1146.34 72.576 L1138.85 72.576 L1138.85 27.2059 L1146.34 27.2059 L1146.34 34.2544 Q1148.69 30.1225 1152.46 28.1376 Q1156.23 26.1121 1161.61 26.1121 Q1162.38 26.1121 1163.31 26.2337 Q1164.25 26.3147 1165.38 26.5172 L1165.42 34.1734 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1208.12 18.8205 L1208.12 65.8515 L1218 65.8515 Q1230.52 65.8515 1236.31 60.1802 Q1242.15 54.509 1242.15 42.2752 Q1242.15 30.1225 1236.31 24.4918 Q1230.52 18.8205 1218 18.8205 L1208.12 18.8205 M1199.93 12.096 L1216.75 12.096 Q1234.33 12.096 1242.55 19.4281 Q1250.77 26.7198 1250.77 42.2752 Q1250.77 57.9117 1242.51 65.2439 Q1234.25 72.576 1216.75 72.576 L1199.93 72.576 L1199.93 12.096 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1263.49 27.2059 L1270.95 27.2059 L1270.95 72.576 L1263.49 72.576 L1263.49 27.2059 M1263.49 9.54393 L1270.95 9.54393 L1270.95 18.9825 L1263.49 18.9825 L1263.49 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1315.47 28.5427 L1315.47 35.5912 Q1312.31 33.9709 1308.9 33.1607 Q1305.5 32.3505 1301.86 32.3505 Q1296.31 32.3505 1293.51 34.0519 Q1290.76 35.7533 1290.76 39.156 Q1290.76 41.7486 1292.74 43.2475 Q1294.73 44.7058 1300.72 46.0426 L1303.27 46.6097 Q1311.21 48.3111 1314.53 51.4303 Q1317.9 54.509 1317.9 60.0587 Q1317.9 66.3781 1312.87 70.0644 Q1307.89 73.7508 1299.14 73.7508 Q1295.5 73.7508 1291.53 73.0216 Q1287.6 72.3329 1283.22 70.9151 L1283.22 63.2184 Q1287.35 65.3654 1291.36 66.4591 Q1295.37 67.5124 1299.3 67.5124 Q1304.57 67.5124 1307.41 65.73 Q1310.24 63.9071 1310.24 60.6258 Q1310.24 57.5877 1308.18 55.9673 Q1306.15 54.3469 1299.22 52.8481 L1296.63 52.2405 Q1289.7 50.7821 1286.62 47.7845 Q1283.55 44.7463 1283.55 39.4801 Q1283.55 33.0797 1288.08 29.5959 Q1292.62 26.1121 1300.96 26.1121 Q1305.1 26.1121 1308.74 26.7198 Q1312.39 27.3274 1315.47 28.5427 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1337.14 14.324 L1337.14 27.2059 L1352.49 27.2059 L1352.49 32.9987 L1337.14 32.9987 L1337.14 57.6282 Q1337.14 63.1779 1338.64 64.7578 Q1340.18 66.3376 1344.84 66.3376 L1352.49 66.3376 L1352.49 72.576 L1344.84 72.576 Q1336.21 72.576 1332.93 69.3758 Q1329.64 66.1351 1329.64 57.6282 L1329.64 32.9987 L1324.18 32.9987 L1324.18 27.2059 L1329.64 27.2059 L1329.64 14.324 L1337.14 14.324 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1388.59 34.1734 Q1387.33 33.4443 1385.83 33.1202 Q1384.37 32.7556 1382.59 32.7556 Q1376.27 32.7556 1372.87 36.8875 Q1369.51 40.9789 1369.51 48.6757 L1369.51 72.576 L1362.01 72.576 L1362.01 27.2059 L1369.51 27.2059 L1369.51 34.2544 Q1371.86 30.1225 1375.62 28.1376 Q1379.39 26.1121 1384.78 26.1121 Q1385.55 26.1121 1386.48 26.2337 Q1387.41 26.3147 1388.54 26.5172 L1388.59 34.1734 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1396.4 27.2059 L1403.86 27.2059 L1403.86 72.576 L1396.4 72.576 L1396.4 27.2059 M1396.4 9.54393 L1403.86 9.54393 L1403.86 18.9825 L1396.4 18.9825 L1396.4 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1452.02 49.9314 Q1452.02 41.7081 1448.62 37.0496 Q1445.26 32.3505 1439.34 32.3505 Q1433.43 32.3505 1430.03 37.0496 Q1426.66 41.7081 1426.66 49.9314 Q1426.66 58.1548 1430.03 62.8538 Q1433.43 67.5124 1439.34 67.5124 Q1445.26 67.5124 1448.62 62.8538 Q1452.02 58.1548 1452.02 49.9314 M1426.66 34.0924 Q1429.01 30.0415 1432.58 28.0971 Q1436.18 26.1121 1441.17 26.1121 Q1449.43 26.1121 1454.57 32.6746 Q1459.76 39.2371 1459.76 49.9314 Q1459.76 60.6258 1454.57 67.1883 Q1449.43 73.7508 1441.17 73.7508 Q1436.18 73.7508 1432.58 71.8063 Q1429.01 69.8214 1426.66 65.7705 L1426.66 72.576 L1419.17 72.576 L1419.17 9.54393 L1426.66 9.54393 L1426.66 34.0924 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1471.35 54.671 L1471.35 27.2059 L1478.8 27.2059 L1478.8 54.3874 Q1478.8 60.8284 1481.31 64.0691 Q1483.82 67.2693 1488.85 67.2693 Q1494.88 67.2693 1498.36 63.421 Q1501.89 59.5726 1501.89 52.9291 L1501.89 27.2059 L1509.34 27.2059 L1509.34 72.576 L1501.89 72.576 L1501.89 65.6084 Q1499.18 69.7404 1495.57 71.7658 Q1492.01 73.7508 1487.27 73.7508 Q1479.45 73.7508 1475.4 68.8897 Q1471.35 64.0286 1471.35 54.671 M1490.1 26.1121 L1490.1 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1532.07 14.324 L1532.07 27.2059 L1547.42 27.2059 L1547.42 32.9987 L1532.07 32.9987 L1532.07 57.6282 Q1532.07 63.1779 1533.57 64.7578 Q1535.11 66.3376 1539.77 66.3376 L1547.42 66.3376 L1547.42 72.576 L1539.77 72.576 Q1531.14 72.576 1527.86 69.3758 Q1524.57 66.1351 1524.57 57.6282 L1524.57 32.9987 L1519.11 32.9987 L1519.11 27.2059 L1524.57 27.2059 L1524.57 14.324 L1532.07 14.324 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1557.22 27.2059 L1564.68 27.2059 L1564.68 72.576 L1557.22 72.576 L1557.22 27.2059 M1557.22 9.54393 L1564.68 9.54393 L1564.68 18.9825 L1557.22 18.9825 L1557.22 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1597.86 32.4315 Q1591.86 32.4315 1588.38 37.1306 Q1584.89 41.7891 1584.89 49.9314 Q1584.89 58.0738 1588.34 62.7728 Q1591.82 67.4314 1597.86 67.4314 Q1603.81 67.4314 1607.29 62.7323 Q1610.78 58.0333 1610.78 49.9314 Q1610.78 41.8701 1607.29 37.1711 Q1603.81 32.4315 1597.86 32.4315 M1597.86 26.1121 Q1607.58 26.1121 1613.13 32.4315 Q1618.68 38.7509 1618.68 49.9314 Q1618.68 61.0714 1613.13 67.4314 Q1607.58 73.7508 1597.86 73.7508 Q1588.09 73.7508 1582.54 67.4314 Q1577.03 61.0714 1577.03 49.9314 Q1577.03 38.7509 1582.54 32.4315 Q1588.09 26.1121 1597.86 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1668.75 45.1919 L1668.75 72.576 L1661.29 72.576 L1661.29 45.4349 Q1661.29 38.994 1658.78 35.7938 Q1656.27 32.5936 1651.25 32.5936 Q1645.21 32.5936 1641.73 36.4419 Q1638.24 40.2903 1638.24 46.9338 L1638.24 72.576 L1630.75 72.576 L1630.75 27.2059 L1638.24 27.2059 L1638.24 34.2544 Q1640.92 30.163 1644.52 28.1376 Q1648.17 26.1121 1652.91 26.1121 Q1660.73 26.1121 1664.74 30.9732 Q1668.75 35.7938 1668.75 45.1919 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip432)" style="stroke:#80c4ac; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="276.581,1324.83 286.242,1324.83 295.903,1324.83 305.564,1324.82 315.224,1324.81 324.885,1324.78 334.546,1324.72 344.207,1324.65 353.868,1324.57 363.528,1324.5 373.189,1324.44 382.85,1324.35 392.511,1324.21 402.172,1323.99 411.832,1323.72 421.493,1323.48 431.154,1323.31 440.815,1323.21 450.476,1323.13 460.136,1323.05 469.797,1322.98 479.458,1322.97 489.119,1322.94 498.78,1322.79 508.441,1322.44 518.101,1321.87 527.762,1321.16 537.423,1320.36 547.084,1319.48 556.745,1318.46 566.405,1317.24 576.066,1315.71 585.727,1313.81 595.388,1311.56 605.049,1309.07 614.709,1306.42 624.37,1303.62 634.031,1300.57 643.692,1297.21 653.353,1293.54 663.013,1289.59 672.674,1285.36 682.335,1280.78 691.996,1275.77 701.657,1270.15 711.317,1263.78 720.978,1256.63 730.639,1248.74 740.3,1239.76 749.961,1227.65 759.621,1206.31 769.282,1163.35 778.943,1084.07 788.604,967.125 798.265,842.484 807.925,764.168 817.586,769.788 827.247,845.777 836.908,940.306 846.569,1007.85 856.229,1035.47 865.89,1034.25 875.551,1019.1 885.212,998.565 894.873,975.42 904.533,950.226 914.194,923.429 923.855,895.801 933.516,868.27 943.177,841.542 952.837,815.674 962.498,789.918 972.159,762.996 981.82,733.703 991.481,701.647 1001.14,667.891 1010.8,634.84 1020.46,605.012 1030.12,579.33 1039.78,556.241 1049.45,532.192 1059.11,503.084 1068.77,466.319 1078.43,422.934 1088.09,378.181 1097.75,338.949 1107.41,309.305 1117.07,288.106 1126.73,271.046 1136.39,254.918 1146.05,239.735 1155.71,226.909 1165.38,216.101 1175.04,204.772 1184.7,191.14 1194.36,176.731 1204.02,165.187 1213.68,159.062 1223.34,158.463 1233,161.981 1242.66,167.938 1252.32,175.317 1261.98,184.281 1271.64,195.542 1281.3,209.237 1290.97,224.928 1300.63,242.408 1310.29,261.73 1319.95,282.596 1329.61,304.346 1339.27,326.56 1348.93,349.398 1358.59,373.337 1368.25,398.714 1377.91,425.529 1387.57,453.666 1397.23,483.165 1406.9,514.002 1416.56,545.564 1426.22,576.765 1435.88,606.9 1445.54,636.095 1455.2,664.806 1464.86,693.377 1474.52,722.352 1484.18,752.686 1493.84,785.001 1503.5,818.568 1513.16,851.425 1522.82,881.753 1532.49,909.071 1542.15,934.09 1551.81,957.764 1561.47,980.795 1571.13,1003.76 1580.79,1027.11 1590.45,1050.75 1600.11,1073.91 1609.77,1095.52 1619.43,1114.83 1629.09,1131.81 1638.75,1147.18 1648.42,1161.78 1658.08,1175.83 1667.74,1188.87 1677.4,1200.42 1687.06,1210.44 1696.72,1219.32 1706.38,1227.57 1716.04,1235.68 1725.7,1243.94 1735.36,1252.33 1745.02,1260.47 1754.68,1267.95 1764.34,1274.63 1774.01,1280.63 1783.67,1286.05 1793.33,1290.8 1802.99,1294.82 1812.65,1298.2 1822.31,1301.2 1831.97,1303.99 1841.63,1306.59 1851.29,1309.02 1860.95,1311.34 1870.61,1313.58 1880.27,1315.63 1889.94,1317.32 1899.6,1318.55 1909.26,1319.42 1918.92,1320.09 1928.58,1320.64 1938.24,1321.08 1947.9,1321.41 1957.56,1321.7 1967.22,1322.03 1976.88,1322.44 1986.54,1322.88 1996.2,1323.27 2005.86,1323.55 2015.53,1323.7 2025.19,1323.73 2034.85,1323.71 2044.51,1323.7 2054.17,1323.74 2063.83,1323.85 2073.49,1324 2083.15,1324.14 2092.81,1324.25 2102.47,1324.32 2112.13,1324.4 2121.79,1324.49 2131.46,1324.6 2141.12,1324.7 2150.78,1324.77 2160.44,1324.81 2170.1,1324.82 2179.76,1324.83 2189.42,1324.83 2199.08,1324.83 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#ffc0cb; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1514.22,2596.17 1514.22,-1112.88 "></polyline>
<path clip-path="url(#clip430)" d="M1799.28 320.204 L2188.83 320.204 L2188.83 164.684 L1799.28 164.684  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1799.28,320.204 2188.83,320.204 2188.83,164.684 1799.28,164.684 1799.28,320.204 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#80c4ac; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1821.92,216.524 1957.78,216.524 "></polyline>
<path clip-path="url(#clip430)" d="M1994.26 236.211 Q1992.46 240.841 1990.75 242.253 Q1989.03 243.665 1986.16 243.665 L1982.76 243.665 L1982.76 240.1 L1985.26 240.1 Q1987.02 240.1 1987.99 239.267 Q1988.96 238.433 1990.14 235.331 L1990.91 233.387 L1980.42 207.878 L1984.94 207.878 L1993.04 228.156 L2001.14 207.878 L2005.65 207.878 L1994.26 236.211 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M2012.94 229.869 L2020.58 229.869 L2020.58 203.503 L2012.27 205.17 L2012.27 200.91 L2020.54 199.244 L2025.21 199.244 L2025.21 229.869 L2032.85 229.869 L2032.85 233.804 L2012.94 233.804 L2012.94 229.869 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip430)" style="stroke:#ffc0cb; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1821.92,268.364 1957.78,268.364 "></polyline>
<path clip-path="url(#clip430)" d="M2005.07 259.718 L1995.7 272.334 L2005.56 285.644 L2000.54 285.644 L1992.99 275.459 L1985.45 285.644 L1980.42 285.644 L1990.49 272.079 L1981.28 259.718 L1986.3 259.718 L1993.18 268.954 L2000.05 259.718 L2005.07 259.718 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M2029.24 251.084 L2041.81 263.977 L2037.16 263.977 L2026.97 254.834 L2016.79 263.977 L2012.13 263.977 L2024.7 251.084 L2029.24 251.084 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M2069.13 256.778 L2060.82 261.269 L2069.13 265.783 L2067.78 268.051 L2060 263.352 L2060 272.079 L2057.37 272.079 L2057.37 263.352 L2049.59 268.051 L2048.25 265.783 L2056.56 261.269 L2048.25 256.778 L2049.59 254.486 L2057.37 259.186 L2057.37 250.459 L2060 250.459 L2060 259.186 L2067.78 254.486 L2069.13 256.778 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M2090.63 264.116 L2120.31 264.116 L2120.31 268.005 L2090.63 268.005 L2090.63 264.116 M2090.63 273.56 L2120.31 273.56 L2120.31 277.496 L2090.63 277.496 L2090.63 273.56 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M2146.28 281.709 L2153.92 281.709 L2153.92 255.343 L2145.61 257.01 L2145.61 252.75 L2153.87 251.084 L2158.55 251.084 L2158.55 281.709 L2166.18 281.709 L2166.18 285.644 L2146.28 285.644 L2146.28 281.709 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="注（$x^*=0$ でのアトムについて）">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
注（<img src="https://latex.codecogs.com/png.latex?x%5E*=0"> でのアトムについて）
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?x%5E*=0"> に原子が存在する．</p>
<p>ここでは密度関数は滑らかに見えるが，実際には <img src="https://latex.codecogs.com/png.latex?x%5E*=0"> で不連続である．</p>
<p>これは，計算の都合上，<img src="https://latex.codecogs.com/png.latex?%5Cdelta_0"> を <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BN%7D(0,0.005)"> で代用したためである．</p>
</div>
</div>
</div>
</section>
<section id="map-推定量" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="map-推定量"><span class="header-section-number">1.3</span> MAP 推定量</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定義 (maximum a posterior estimator)">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定義 (maximum a posterior estimator)
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cwidehat%7Bx%7D:=%5Cmathop%7B%5Cmathrm%7Barg%5C,max%7D%7D_%7Bx%5Cin%5Cmathbb%7BR%7D%7D%5C;p(x%7Cy_1,%5Ccdots,y_n)%0A"> で定まる推定量 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5En%5Cto%5Cmathbb%7BR%7D"> を <strong>MAP 推定量</strong> という．</p>
</div>
</div>
<p>例 1.2 などをはじめ，ほとんどの場面では良い推定量を与え，多くの場合の最初のチョイスとして適しているかもしれない．</p>
<p>しかし，例 1.2 をさらに変形することで，次のような事後分布が得られる状況は容易に想像がつく：</p>
<div id="cell-fig-1" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">f</span>(x)</span>
<span id="cb6-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.8</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.6</span></span>
<span id="cb6-3">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span></span>
<span id="cb6-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elseif</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb6-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb6-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> </span>
<span id="cb6-7">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb6-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb6-9"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb6-10"></span>
<span id="cb6-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(f, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">600</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>), legend<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">false</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#80c4ac"</span>)</span></code></pre></div>
</details>
<div id="fig-1" class="cell-output cell-output-display quarto-figure quarto-figure-center quarto-float anchored" data-execution_count="7">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewbox="0 0 2400 1600">
<defs>
  <clippath id="clip560">
    <rect x="0" y="0" width="2400" height="1600"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip560)" d="M0 1600 L2400 1600 L2400 8.88178e-14 L0 8.88178e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip561">
    <rect x="480" y="0" width="1681" height="1600"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip560)" d="M156.112 1486.45 L2352.76 1486.45 L2352.76 47.2441 L156.112 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip562">
    <rect x="156" y="47" width="2198" height="1440"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.281,1486.45 218.281,47.2441 "></polyline>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="736.358,1486.45 736.358,47.2441 "></polyline>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1254.43,1486.45 1254.43,47.2441 "></polyline>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1772.51,1486.45 1772.51,47.2441 "></polyline>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2290.59,1486.45 2290.59,47.2441 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,1486.45 2352.76,1486.45 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.281,1486.45 218.281,1467.55 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="736.358,1486.45 736.358,1467.55 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1254.43,1486.45 1254.43,1467.55 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1772.51,1486.45 1772.51,1467.55 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2290.59,1486.45 2290.59,1467.55 "></polyline>
<path clip-path="url(#clip560)" d="M188.224 1532.02 L217.899 1532.02 L217.899 1535.95 L188.224 1535.95 L188.224 1532.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M232.02 1544.91 L248.339 1544.91 L248.339 1548.85 L226.395 1548.85 L226.395 1544.91 Q229.057 1542.16 233.64 1537.53 Q238.246 1532.88 239.427 1531.53 Q241.672 1529.01 242.552 1527.27 Q243.455 1525.51 243.455 1523.82 Q243.455 1521.07 241.51 1519.33 Q239.589 1517.6 236.487 1517.6 Q234.288 1517.6 231.834 1518.36 Q229.404 1519.13 226.626 1520.68 L226.626 1515.95 Q229.45 1514.82 231.904 1514.24 Q234.358 1513.66 236.395 1513.66 Q241.765 1513.66 244.959 1516.35 Q248.154 1519.03 248.154 1523.52 Q248.154 1525.65 247.344 1527.57 Q246.557 1529.47 244.45 1532.07 Q243.871 1532.74 240.77 1535.95 Q237.668 1539.15 232.02 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M706.115 1532.02 L735.791 1532.02 L735.791 1535.95 L706.115 1535.95 L706.115 1532.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M746.693 1544.91 L754.332 1544.91 L754.332 1518.55 L746.022 1520.21 L746.022 1515.95 L754.286 1514.29 L758.962 1514.29 L758.962 1544.91 L766.601 1544.91 L766.601 1548.85 L746.693 1548.85 L746.693 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M1254.43 1517.37 Q1250.82 1517.37 1248.99 1520.93 Q1247.19 1524.47 1247.19 1531.6 Q1247.19 1538.71 1248.99 1542.27 Q1250.82 1545.82 1254.43 1545.82 Q1258.07 1545.82 1259.87 1542.27 Q1261.7 1538.71 1261.7 1531.6 Q1261.7 1524.47 1259.87 1520.93 Q1258.07 1517.37 1254.43 1517.37 M1254.43 1513.66 Q1260.24 1513.66 1263.3 1518.27 Q1266.38 1522.85 1266.38 1531.6 Q1266.38 1540.33 1263.3 1544.94 Q1260.24 1549.52 1254.43 1549.52 Q1248.62 1549.52 1245.55 1544.94 Q1242.49 1540.33 1242.49 1531.6 Q1242.49 1522.85 1245.55 1518.27 Q1248.62 1513.66 1254.43 1513.66 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M1762.89 1544.91 L1770.53 1544.91 L1770.53 1518.55 L1762.22 1520.21 L1762.22 1515.95 L1770.48 1514.29 L1775.16 1514.29 L1775.16 1544.91 L1782.8 1544.91 L1782.8 1548.85 L1762.89 1548.85 L1762.89 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M2285.24 1544.91 L2301.56 1544.91 L2301.56 1548.85 L2279.61 1548.85 L2279.61 1544.91 Q2282.28 1542.16 2286.86 1537.53 Q2291.47 1532.88 2292.65 1531.53 Q2294.89 1529.01 2295.77 1527.27 Q2296.67 1525.51 2296.67 1523.82 Q2296.67 1521.07 2294.73 1519.33 Q2292.81 1517.6 2289.71 1517.6 Q2287.51 1517.6 2285.05 1518.36 Q2282.62 1519.13 2279.85 1520.68 L2279.85 1515.95 Q2282.67 1514.82 2285.12 1514.24 Q2287.58 1513.66 2289.61 1513.66 Q2294.98 1513.66 2298.18 1516.35 Q2301.37 1519.03 2301.37 1523.52 Q2301.37 1525.65 2300.56 1527.57 Q2299.78 1529.47 2297.67 1532.07 Q2297.09 1532.74 2293.99 1535.95 Q2290.89 1539.15 2285.24 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,1445.72 2352.76,1445.72 "></polyline>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,1174.17 2352.76,1174.17 "></polyline>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,902.62 2352.76,902.62 "></polyline>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,631.072 2352.76,631.072 "></polyline>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,359.524 2352.76,359.524 "></polyline>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="156.112,87.9763 2352.76,87.9763 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,1486.45 156.112,47.2441 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,1445.72 175.01,1445.72 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,1174.17 175.01,1174.17 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,902.62 175.01,902.62 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,631.072 175.01,631.072 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,359.524 175.01,359.524 "></polyline>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="156.112,87.9763 175.01,87.9763 "></polyline>
<path clip-path="url(#clip560)" d="M62.9365 1431.51 Q59.3254 1431.51 57.4967 1435.08 Q55.6912 1438.62 55.6912 1445.75 Q55.6912 1452.86 57.4967 1456.42 Q59.3254 1459.96 62.9365 1459.96 Q66.5707 1459.96 68.3763 1456.42 Q70.205 1452.86 70.205 1445.75 Q70.205 1438.62 68.3763 1435.08 Q66.5707 1431.51 62.9365 1431.51 M62.9365 1427.81 Q68.7467 1427.81 71.8022 1432.42 Q74.8809 1437 74.8809 1445.75 Q74.8809 1454.48 71.8022 1459.08 Q68.7467 1463.67 62.9365 1463.67 Q57.1264 1463.67 54.0477 1459.08 Q50.9921 1454.48 50.9921 1445.75 Q50.9921 1437 54.0477 1432.42 Q57.1264 1427.81 62.9365 1427.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M83.0984 1457.12 L87.9827 1457.12 L87.9827 1463 L83.0984 1463 L83.0984 1457.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M108.168 1431.51 Q104.557 1431.51 102.728 1435.08 Q100.922 1438.62 100.922 1445.75 Q100.922 1452.86 102.728 1456.42 Q104.557 1459.96 108.168 1459.96 Q111.802 1459.96 113.608 1456.42 Q115.436 1452.86 115.436 1445.75 Q115.436 1438.62 113.608 1435.08 Q111.802 1431.51 108.168 1431.51 M108.168 1427.81 Q113.978 1427.81 117.033 1432.42 Q120.112 1437 120.112 1445.75 Q120.112 1454.48 117.033 1459.08 Q113.978 1463.67 108.168 1463.67 Q102.358 1463.67 99.2789 1459.08 Q96.2234 1454.48 96.2234 1445.75 Q96.2234 1437 99.2789 1432.42 Q102.358 1427.81 108.168 1427.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M63.9319 1159.97 Q60.3208 1159.97 58.4921 1163.53 Q56.6865 1167.07 56.6865 1174.2 Q56.6865 1181.31 58.4921 1184.87 Q60.3208 1188.42 63.9319 1188.42 Q67.5661 1188.42 69.3717 1184.87 Q71.2004 1181.31 71.2004 1174.2 Q71.2004 1167.07 69.3717 1163.53 Q67.5661 1159.97 63.9319 1159.97 M63.9319 1156.26 Q69.742 1156.26 72.7976 1160.87 Q75.8763 1165.45 75.8763 1174.2 Q75.8763 1182.93 72.7976 1187.54 Q69.742 1192.12 63.9319 1192.12 Q58.1217 1192.12 55.043 1187.54 Q51.9875 1182.93 51.9875 1174.2 Q51.9875 1165.45 55.043 1160.87 Q58.1217 1156.26 63.9319 1156.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M84.0938 1185.57 L88.978 1185.57 L88.978 1191.45 L84.0938 1191.45 L84.0938 1185.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M99.2095 1156.89 L117.566 1156.89 L117.566 1160.82 L103.492 1160.82 L103.492 1169.3 Q104.51 1168.95 105.529 1168.79 Q106.547 1168.6 107.566 1168.6 Q113.353 1168.6 116.733 1171.77 Q120.112 1174.94 120.112 1180.36 Q120.112 1185.94 116.64 1189.04 Q113.168 1192.12 106.848 1192.12 Q104.672 1192.12 102.404 1191.75 Q100.159 1191.38 97.7511 1190.64 L97.7511 1185.94 Q99.8345 1187.07 102.057 1187.63 Q104.279 1188.18 106.756 1188.18 Q110.76 1188.18 113.098 1186.08 Q115.436 1183.97 115.436 1180.36 Q115.436 1176.75 113.098 1174.64 Q110.76 1172.54 106.756 1172.54 Q104.881 1172.54 103.006 1172.95 Q101.154 1173.37 99.2095 1174.25 L99.2095 1156.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M53.7467 915.965 L61.3856 915.965 L61.3856 889.599 L53.0754 891.266 L53.0754 887.007 L61.3393 885.34 L66.0152 885.34 L66.0152 915.965 L73.654 915.965 L73.654 919.9 L53.7467 919.9 L53.7467 915.965 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M83.0984 914.02 L87.9827 914.02 L87.9827 919.9 L83.0984 919.9 L83.0984 914.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M108.168 888.419 Q104.557 888.419 102.728 891.983 Q100.922 895.525 100.922 902.655 Q100.922 909.761 102.728 913.326 Q104.557 916.868 108.168 916.868 Q111.802 916.868 113.608 913.326 Q115.436 909.761 115.436 902.655 Q115.436 895.525 113.608 891.983 Q111.802 888.419 108.168 888.419 M108.168 884.715 Q113.978 884.715 117.033 889.321 Q120.112 893.905 120.112 902.655 Q120.112 911.381 117.033 915.988 Q113.978 920.571 108.168 920.571 Q102.358 920.571 99.2789 915.988 Q96.2234 911.381 96.2234 902.655 Q96.2234 893.905 99.2789 889.321 Q102.358 884.715 108.168 884.715 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M54.7421 644.417 L62.381 644.417 L62.381 618.051 L54.0708 619.718 L54.0708 615.459 L62.3347 613.792 L67.0106 613.792 L67.0106 644.417 L74.6494 644.417 L74.6494 648.352 L54.7421 648.352 L54.7421 644.417 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M84.0938 642.472 L88.978 642.472 L88.978 648.352 L84.0938 648.352 L84.0938 642.472 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M99.2095 613.792 L117.566 613.792 L117.566 617.727 L103.492 617.727 L103.492 626.199 Q104.51 625.852 105.529 625.69 Q106.547 625.505 107.566 625.505 Q113.353 625.505 116.733 628.676 Q120.112 631.848 120.112 637.264 Q120.112 642.843 116.64 645.945 Q113.168 649.023 106.848 649.023 Q104.672 649.023 102.404 648.653 Q100.159 648.283 97.7511 647.542 L97.7511 642.843 Q99.8345 643.977 102.057 644.533 Q104.279 645.088 106.756 645.088 Q110.76 645.088 113.098 642.982 Q115.436 640.875 115.436 637.264 Q115.436 633.653 113.098 631.547 Q110.76 629.44 106.756 629.44 Q104.881 629.44 103.006 629.857 Q101.154 630.273 99.2095 631.153 L99.2095 613.792 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M56.9643 372.869 L73.2837 372.869 L73.2837 376.804 L51.3393 376.804 L51.3393 372.869 Q54.0014 370.114 58.5847 365.485 Q63.1911 360.832 64.3717 359.489 Q66.617 356.966 67.4967 355.23 Q68.3994 353.471 68.3994 351.781 Q68.3994 349.027 66.455 347.29 Q64.5337 345.554 61.4319 345.554 Q59.2328 345.554 56.7791 346.318 Q54.3486 347.082 51.5708 348.633 L51.5708 343.911 Q54.3949 342.777 56.8486 342.198 Q59.3023 341.619 61.3393 341.619 Q66.7096 341.619 69.9041 344.304 Q73.0985 346.99 73.0985 351.48 Q73.0985 353.61 72.2883 355.531 Q71.5013 357.429 69.3948 360.022 Q68.8161 360.693 65.7143 363.911 Q62.6124 367.105 56.9643 372.869 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M83.0984 370.925 L87.9827 370.925 L87.9827 376.804 L83.0984 376.804 L83.0984 370.925 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M108.168 345.323 Q104.557 345.323 102.728 348.888 Q100.922 352.429 100.922 359.559 Q100.922 366.665 102.728 370.23 Q104.557 373.772 108.168 373.772 Q111.802 373.772 113.608 370.23 Q115.436 366.665 115.436 359.559 Q115.436 352.429 113.608 348.888 Q111.802 345.323 108.168 345.323 M108.168 341.619 Q113.978 341.619 117.033 346.226 Q120.112 350.809 120.112 359.559 Q120.112 368.286 117.033 372.892 Q113.978 377.475 108.168 377.475 Q102.358 377.475 99.2789 372.892 Q96.2234 368.286 96.2234 359.559 Q96.2234 350.809 99.2789 346.226 Q102.358 341.619 108.168 341.619 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M57.9597 101.321 L74.279 101.321 L74.279 105.256 L52.3347 105.256 L52.3347 101.321 Q54.9967 98.5665 59.58 93.9369 Q64.1865 89.2841 65.367 87.9416 Q67.6124 85.4184 68.492 83.6823 Q69.3948 81.9231 69.3948 80.2333 Q69.3948 77.4786 67.4504 75.7425 Q65.5291 74.0064 62.4272 74.0064 Q60.2282 74.0064 57.7745 74.7703 Q55.344 75.5342 52.5662 77.0851 L52.5662 72.3629 Q55.3903 71.2287 57.8439 70.65 Q60.2976 70.0713 62.3347 70.0713 Q67.705 70.0713 70.8994 72.7565 Q74.0939 75.4416 74.0939 79.9323 Q74.0939 82.062 73.2837 83.9832 Q72.4966 85.8814 70.3902 88.474 Q69.8115 89.1453 66.7096 92.3628 Q63.6078 95.5573 57.9597 101.321 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M84.0938 99.3767 L88.978 99.3767 L88.978 105.256 L84.0938 105.256 L84.0938 99.3767 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip560)" d="M99.2095 70.6963 L117.566 70.6963 L117.566 74.6314 L103.492 74.6314 L103.492 83.1036 Q104.51 82.7564 105.529 82.5944 Q106.547 82.4092 107.566 82.4092 Q113.353 82.4092 116.733 85.5805 Q120.112 88.7517 120.112 94.1684 Q120.112 99.747 116.64 102.849 Q113.168 105.928 106.848 105.928 Q104.672 105.928 102.404 105.557 Q100.159 105.187 97.7511 104.446 L97.7511 99.747 Q99.8345 100.881 102.057 101.437 Q104.279 101.992 106.756 101.992 Q110.76 101.992 113.098 99.8859 Q115.436 97.7795 115.436 94.1684 Q115.436 90.5573 113.098 88.4508 Q110.76 86.3443 106.756 86.3443 Q104.881 86.3443 103.006 86.761 Q101.154 87.1777 99.2095 88.0573 L99.2095 70.6963 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip562)" style="stroke:#80c4ac; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.281,1445.72 221.654,1445.72 225.027,1445.72 228.4,1445.72 231.773,1445.72 247.367,1445.72 262.961,1445.72 278.555,1445.72 294.149,1445.72 301.946,1445.72 309.743,1445.72 313.641,1445.72 317.54,1445.72 318.514,1445.72 319.489,1445.72 320.464,1445.72 321.438,1445.72 322.413,87.9763 323.388,87.9763 324.362,87.9763 325.337,87.9763 327.286,87.9763 329.235,87.9763 331.185,87.9763 333.134,87.9763 337.032,87.9763 340.931,87.9763 348.728,87.9763 356.525,87.9763 375.267,87.9763 394.01,87.9763 403.381,87.9763 412.753,87.9763 415.095,87.9763 417.438,87.9763 419.781,87.9763 422.124,87.9763 422.71,87.9763 423.295,87.9763 423.881,87.9763 424.467,87.9763 425.052,87.9763 425.638,1445.72 426.224,1445.72 426.809,1445.72 427.981,1445.72 429.152,1445.72 430.324,1445.72 431.495,1445.72 435.457,1445.72 439.418,1445.72 443.38,1445.72 447.342,1445.72 455.265,1445.72 463.188,1445.72 479.035,1445.72 494.882,1445.72 563.737,1445.72 627.216,1445.72 695.272,1445.72 774.122,1445.72 844.194,1445.72 905.641,1445.72 972.634,1445.72 1040.03,1445.72 1077.28,1445.72 1114.54,1445.72 1149.98,1445.72 1185.43,1445.72 1203.86,1445.72 1222.29,1445.72 1231.5,1445.72 1240.72,1445.72 1243.02,1445.72 1245.32,1445.72 1247.63,1445.72 1249.93,1445.72 1251.08,1445.72 1252.23,1445.72 1252.81,1445.72 1253.39,1445.72 1253.96,1445.72 1254.54,902.62 1255.11,902.62 1255.69,902.62 1256.27,902.62 1256.84,902.62 1257.99,902.62 1259.14,902.62 1263.02,902.62 1266.9,902.62 1270.78,902.62 1274.66,902.62 1282.41,902.62 1290.17,902.62 1305.68,902.62 1321.2,902.62 1396.95,902.62 1466.35,902.62 1530.45,902.62 1595.38,902.62 1668.14,902.62 1734.08,902.62 1809.57,902.62 1879.47,902.62 1913.92,902.62 1948.38,902.62 1965.11,902.62 1981.83,902.62 1990.2,902.62 1998.56,902.62 2006.93,902.62 2015.29,902.62 2019.58,902.62 2023.86,902.62 2026.01,902.62 2028.15,902.62 2029.22,902.62 2030.29,902.62 2030.83,902.62 2031.36,902.62 2031.9,1445.72 2032.44,1445.72 2032.97,1445.72 2033.51,1445.72 2034.04,1445.72 2034.58,1445.72 2035.65,1445.72 2036.72,1445.72 2038.87,1445.72 2041.01,1445.72 2045.3,1445.72 2049.58,1445.72 2066.73,1445.72 2083.88,1445.72 2121.45,1445.72 2159.03,1445.72 2213.61,1445.72 2268.19,1445.72 2279.39,1445.72 2290.59,1445.72 "></polyline>
</svg>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;1
</figcaption>
</figure>
</div>
</div>
</section>
<section id="ベイズ最適推定量" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="ベイズ最適推定量"><span class="header-section-number">1.4</span> ベイズ最適推定量</h3>
<p>図&nbsp;1 の状況でも，たしかに１点のみを選ぶならば MAP 推定量で良いかもしれないが，<img src="https://latex.codecogs.com/png.latex?x%5Cle0"> である確率は <img src="https://latex.codecogs.com/png.latex?x%5Cge0"> である確率よりも低いため，この意味では，<img src="https://latex.codecogs.com/png.latex?x%5Cin%5B0,3/2%5D"> の範囲に推定量が収まっていた方が好ましいかもしれない．</p>
<p>推定量 <img src="https://latex.codecogs.com/png.latex?%5Cwidehat%7Bx%7D_n:%5Cmathbb%7BR%7D%5En%5Cto%5Cmathbb%7BR%7D"> を評価するには，何らかのアプリオリな <strong>損失</strong> の概念が必要である．これを損失関数 <img src="https://latex.codecogs.com/png.latex?L:%5Cmathbb%7BR%7D%5E2%5Cto%5Cmathbb%7BR%7D"> という形で与える．</p>
<p>すると，損失の期待値が計算可能になり，これを <strong>危険</strong> という： <img src="https://latex.codecogs.com/png.latex?%0AR(%5Cwidehat%7Bx%7D_n):=%5Coperatorname%7BE%7D%5BL(%5Cwidehat%7Bx%7D_n(%5Cboldsymbol%7BY%7D),X)%5D.%0A"></p>
<p>このリスクを最小化する推定量を <strong>ベイズ最適推定量</strong>，その際のリスクを <strong>ベイズリスク</strong> という．<sup>2</sup></p>
<section id="sec-MMSE" class="level4" data-number="1.4.1">
<h4 data-number="1.4.1" class="anchored" data-anchor-id="sec-MMSE"><span class="header-section-number">1.4.1</span> <img src="https://latex.codecogs.com/png.latex?l%5E2">-ベイズ最適推定量</h4>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?L(x,y):=(x-y)%5E2"> と定める．このとき，<strong>事後平均</strong> がベイズリスクを達成する： <img src="https://latex.codecogs.com/png.latex?%0A%5Cwidehat%7Bx%7D(%5Cboldsymbol%7By%7D):=%5Cint_%5Cmathbb%7BR%7Dxp(x%7C%5Cboldsymbol%7By%7D)%5C,%0Adx.%0A"></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
<p>図&nbsp;1 の場合では，事後平均は約 <img src="https://latex.codecogs.com/png.latex?0.1"> で，かろうじて正になる．</p>
</section>
<section id="l1-ベイズ最適推定量" class="level4" data-number="1.4.2">
<h4 data-number="1.4.2" class="anchored" data-anchor-id="l1-ベイズ最適推定量"><span class="header-section-number">1.4.2</span> <img src="https://latex.codecogs.com/png.latex?l%5E1">-ベイズ最適推定量</h4>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?L(x,y):=%5Clvert%20x-y%5Crvert"> と定める．このとき，<strong>事後中央値</strong> がベイズリスクを達成する．</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
<p>図&nbsp;1 の場合では，事後中央値は <img src="https://latex.codecogs.com/png.latex?0.5"> となる．大変頑健な推定だと言えるだろう．</p>
</section>
<section id="最適決定規則" class="level4" data-number="1.4.3">
<h4 data-number="1.4.3" class="anchored" data-anchor-id="最適決定規則"><span class="header-section-number">1.4.3</span> 最適決定規則</h4>
<p>今回の誤り訂正符号の文脈の目標は，<img src="https://latex.codecogs.com/png.latex?x%5E*"> の復元であることを思い出せば，今回の損失は <img src="https://latex.codecogs.com/png.latex?L(x,y)=%5Cdelta_0(x-y)"> ととり，復号が成功する確率を最大とする推定量が「最良」と言うべきであろう： <img src="https://latex.codecogs.com/png.latex?%0AR(%5Cwidehat%7Bx%7D_n)=%5Coperatorname%7BP%7D%5B%5Cwidehat%7Bx%7D_n(%5Cboldsymbol%7BY%7D)=X%5D%0A"></p>
<p>これは結局 MAP 推定量 <img src="https://latex.codecogs.com/png.latex?%0A%5Cwidehat%7Bx%7D_n:=%5Cmathop%7B%5Cmathrm%7Barg%5C,max%7D%7D_%7Bx%5Cin%5Cmathbb%7BR%7D%7Dp(x%7C%5Cboldsymbol%7By%7D)%0A"> で与えられることになる．</p>
</section>
</section>
</section>
<section id="統計物理からの視点" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="統計物理からの視点"><span class="header-section-number">2</span> 統計物理からの視点</h2>
<p>真のシグナル <img src="https://latex.codecogs.com/png.latex?x%5E*%5Cin%5Cmathbb%7BR%7D"> を，Bayes 事後平均によって点推定する問題を，統計力学の観点から考察する．</p>
<p>次節 3 で，スパースな一般次元のベクトル <img src="https://latex.codecogs.com/png.latex?x%5E*%5Cin%5Cmathbb%7BR%7D%5Ed"> を復元する問題に拡張する．</p>
<section id="sec-straightforward-identification" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="sec-straightforward-identification"><span class="header-section-number">2.1</span> 事後分布をある物理系の平衡分布と見る</h3>
<p>ベイズの公式 (1) が与える事後分布 <img src="https://latex.codecogs.com/png.latex?p(x%7C%5Cboldsymbol%7By%7D)"> は，次の Boltzmann-Gibbs 分布として理解できる： <img src="https://latex.codecogs.com/png.latex?%0Ap(x%7C%5Cboldsymbol%7By%7D)=%5Cfrac%7Be%5E%7B%5Clog%20p(%5Cboldsymbol%7By%7D%7Cx)p(x)%7D%7D%7Bp(%5Cboldsymbol%7By%7D)%7D%0A"> <img src="https://latex.codecogs.com/png.latex?%0A=%5Cfrac%7Be%5E%7B-H(x,%5Cboldsymbol%7By%7D)%7D%7D%7BZ(%5Cboldsymbol%7By%7D)%7D,%0A"> <img src="https://latex.codecogs.com/png.latex?%0AH(x,%5Cboldsymbol%7By%7D):=-%5Clog%20p(%5Cboldsymbol%7By%7D%7Cx)-%5Clog%20p(x),%0A"> <img src="https://latex.codecogs.com/png.latex?%0AZ(%5Cboldsymbol%7By%7D):=p(y).%0A"></p>
<p>すなわち，Bayes 事後分布 <img src="https://latex.codecogs.com/png.latex?p(x%7C%5Cboldsymbol%7By%7D)"> は，<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ctimes%5Cmathbb%7BR%7D%5En"> を配位空間に持ち，Hamiltonian <img src="https://latex.codecogs.com/png.latex?H(x,%5Cboldsymbol%7By%7D)"> を持つ正準集団の平衡分布と捉えることができる．</p>
<p>従って，Bayes 事後平均とは，この系に関する熱平均になる．加えて，MAP 推定量とは，この系に関する基底状態となる．</p>
<p>しかし，この系の，物理的な意義どころか，統計的な意義も定かではない．</p>
</section>
<section id="sec-identification" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="sec-identification"><span class="header-section-number">2.2</span> もう一つの見方</h3>
<p>今回，通信路は加法的に Gauss ノイズを加えるものとしたのであった： <img src="https://latex.codecogs.com/png.latex?%0Ap(%5Cboldsymbol%7By%7D%7Cx)d%5Cboldsymbol%7By%7D=%5Cmathrm%7BN%7D(x,%5Csigma%5E2)%5E%7B%5Cotimes%20n%7D(d%5Cboldsymbol%7By%7D)%0A"> この場合，前節 2.1 でみた方法の他に，事後分布 <img src="https://latex.codecogs.com/png.latex?p(x%7C%5Cboldsymbol%7By%7D)"> を次のように理解することもできる： <img src="https://latex.codecogs.com/png.latex?%0Ap(x%7C%5Cboldsymbol%7By%7D)=%5Cfrac%7Be%5E%7B-H(x,%5Cboldsymbol%7By%7D)%7D%7D%7BZ(%5Cboldsymbol%7By%7D)%7D,%0A"> <img src="https://latex.codecogs.com/png.latex?%0AH(x,%5Cboldsymbol%7By%7D):=%5Cfrac%7B1%7D%7B2%5Csigma%5E2%7D%5Csum_%7Bi=1%7D%5En(x%5E2-2xy_i)-%5Clog%20p(x),%0A"> <img src="https://latex.codecogs.com/png.latex?%0AZ(%5Cboldsymbol%7By%7D):=%5Cleft(%5Cfrac%7B1%7D%7B(2%5Cpi%5Csigma%5E2)%5E%7B%5Cfrac%7Bn%7D%7B2%7D%7D%7D%5Cfrac%7Be%5E%7B-%5Cfrac%7B%5Clvert%5Cboldsymbol%7By%7D%5Crvert%5E2%7D%7B2%5Csigma%5E2%7D%7D%7D%7Bp(%5Cboldsymbol%7By%7D)%7D%5Cright)%5E%7B-1%7D.%0A"></p>
<p>この Hamiltonian <img src="https://latex.codecogs.com/png.latex?H"> により定まる系の分配関数 <img src="https://latex.codecogs.com/png.latex?Z(%5Cboldsymbol%7By%7D)"> は，情報源 <img src="https://latex.codecogs.com/png.latex?p(x)"> と Gauss 型通信路 <img src="https://latex.codecogs.com/png.latex?p(%5Cboldsymbol%7By%7D%7Cx)"> で与えられた観測 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%7By%7D"> に関する周辺モデル <img src="https://latex.codecogs.com/png.latex?p(%5Cboldsymbol%7By%7D)"> と，完全にランダムなホワイトノイズ <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BN%7D(0,%5Csigma%5E2)%5E%7B%5Cotimes%20n%7D"> との尤度比，または <a href="https://ja.wikipedia.org/wiki/ベイズ因子"><strong>ベイズ因子</strong></a> になっている．</p>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="式変形">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
式変形
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20p(x%7C%5Cboldsymbol%7By%7D)&amp;=p(%5Cboldsymbol%7By%7D%7Cx)%5Cfrac%7Bp(x)%7D%7Bp(%5Cboldsymbol%7By%7D)%7D%5C%5C%0A%20%20%20%20&amp;=%5Cfrac%7Bp(x)%7D%7Bp(%5Cboldsymbol%7By%7D)%7D%5Cfrac%7B1%7D%7B(2%5Cpi%5Csigma%5E2)%5E%7B%5Cfrac%7Bn%7D%7B2%7D%7D%7De%5E%7B-%5Cfrac%7B1%7D%7B2%5Csigma%5E2%7D%5Csum_%7Bi=1%7D%5En(x-y_i)%5E2%7D%5C%5C%0A%20%20%20%20&amp;=%5Cfrac%7Bp(x)%7D%7Bp(%5Cboldsymbol%7By%7D)%7D%5Cfrac%7Be%5E%7B-%5Cfrac%7B1%7D%7B2%5Csigma%5E2%7D%5Csum_%7Bi=1%7D%5Eny_i%5E2%7D%7D%7B(2%5Cpi%5Csigma%5E2)%5E%7B%5Cfrac%7Bn%7D%7B2%7D%7D%7De%5E%7B-%5Cfrac%7B1%7D%7B2%5Csigma%5E2%7D%5Csum_%7Bi=1%7D%5En(x%5E2-2xy_i)%7D%5C%5C%0A%20%20%20%20&amp;=%5Cfrac%7Bp(x)e%5E%7B-%5Cfrac%7B1%7D%7B2%5Csigma%5E2%7D%5Csum_%7Bi=1%7D%5En(x%5E2-2xy_i)%7D%7D%7BZ(%5Cboldsymbol%7By%7D)%7D%5C%5C%0A%20%20%20%20&amp;=%5Cfrac%7B1%7D%7BZ(%5Cboldsymbol%7By%7D)%7D%5Cexp%5Cleft(%5Clog%20p(x)-%5Cfrac%7B1%7D%7B2%5Csigma%5E2%7D%5Csum_%7Bi=1%7D%5En(x%5E2-2xy_i)%5Cright)%0A%5Cend%7Balign*%7D"></p>
</div>
</div>
</div>
<p>さらに，この系 <img src="https://latex.codecogs.com/png.latex?H"> における自由エントロピーは，<img src="https://latex.codecogs.com/png.latex?p(%5Cboldsymbol%7By%7D)"> と <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BN%7D(0,%5Csigma%5E2)%5E%7B%5Cotimes%20n%7D"> との間の KL 乖離度となっている： <img src="https://latex.codecogs.com/png.latex?%0AF_n:=%5Cint_%7B%5Cmathbb%7BR%7D%5En%7D%5Clog%5Cfrac%7Bp(%5Cboldsymbol%7By%7D)%7D%7Bq(%5Cboldsymbol%7By%7D)%7Dp(%5Cboldsymbol%7By%7D)%5C,d%5Cboldsymbol%7By%7D=%5Cmathop%7B%5Cmathrm%7BKL%7D%7D(p,q).%0A"> ただし，<img src="https://latex.codecogs.com/png.latex?q"> は <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BN%7D(0,%5Csigma%5E2)%5E%7B%5Cotimes%20n%7D"> の密度とした．</p>
<p>この系の他の物理量も，自由エネルギーと定数倍違うのみとなっている：</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（エントロピーと相互情報量）^[[@Krzakala-Zdeborova2024 p.122]．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（エントロピーと相互情報量）<sup>3</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p>この Hamiltonian <img src="https://latex.codecogs.com/png.latex?H"> を持つ系について，</p>
<ol type="1">
<li><p>エントロピー <img src="https://latex.codecogs.com/png.latex?H"> は次で与えられる：</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%20H(Y)&amp;:=-%5Cint_%7B%5Cmathbb%7BR%7D%5En%7D(%5Clog%20p(%5Cboldsymbol%7By%7D))p(%5Cboldsymbol%7By%7D)%5C,d%5Cboldsymbol%7By%7D%5C%5C%0A%20%20%20%20%20&amp;=%5Cfrac%7Bn%7D%7B2%7D%5Clog(2%5Cpi%5Csigma%5E2)%5C%5C%0A%20%20%20%20%20&amp;%5Cqquad+%5Cfrac%7B1%7D%7B2%5Csigma%5E2%7D%5Cint_%7B%5Cmathbb%7BR%7D%5En%7D%5Clvert%5Cboldsymbol%7By%7D%5Crvert%5E2p(%5Cboldsymbol%7By%7D)%5C,d%5Cboldsymbol%7By%7D-F_n.%0A%5Cend%7Balign*%7D"></p></li>
<li><p>相互情報量 <img src="https://latex.codecogs.com/png.latex?I"> は次で与えられる：</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%20I(X,Y)&amp;:=%5Cmathop%7B%5Cmathrm%7BKL%7D%7D(p(x,y),p(x)p(y))%5C%5C%5C%5C%0A%20%20%20%20%20&amp;=%5Cfrac%7Bn%7D%7B2%5Csigma%5E2%7D%5Cint_%7B%5Cmathbb%7BR%7D%7Dx%5E2p(x)%5C,dx-F_n.%0A%5Cend%7Balign*%7D"></p></li>
</ol>
<p>特に，いずれも自由エネルギーの定数倍である</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>の式変形は次のとおり： <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20H(Y)&amp;:=-%5Cint_%7B%5Cmathbb%7BR%7D%5En%7D(%5Clog%20p(%5Cboldsymbol%7By%7D))p(%5Cboldsymbol%7By%7D)%5C,d%5Cboldsymbol%7By%7D%5C%5C%0A%20%20%20%20&amp;=-%5Cint_%7B%5Cmathbb%7BR%7D%5En%7Dp(%5Cboldsymbol%7By%7D)d%5Cboldsymbol%7By%7D%5Clog%20q(%5Cboldsymbol%7By%7D)-F_n%5C%5C%0A%20%20%20%20&amp;=-%5Cint_%7B%5Cmathbb%7BR%7D%5En%7D%5Cbiggr(-%5Cfrac%7Bn%7D%7B2%7D%5Clog(2%5Cpi%5Csigma%5E2)-%5Cfrac%7B%5Clvert%5Cboldsymbol%7By%7D%5Crvert%5E2%7D%7B2%5Csigma%5E2%7D%5Cbiggl)p(%5Cboldsymbol%7By%7D)d%5Cboldsymbol%7By%7D-F_n%5C%5C%0A%20%20%20%20&amp;=%5Cfrac%7Bn%7D%7B2%7D%5Clog(2%5Cpi%5Csigma%5E2)+%5Cfrac%7Bn%7D%7B2%5Csigma%5E2%7D%5Cint_%7B%5Cmathbb%7BR%7D%7Dy_i%5E2p(y_i)%5C,dy_i-F_n.%0A%5Cend%7Balign*%7D"></p></li>
<li><p>次の関係式を用いる： <img src="https://latex.codecogs.com/png.latex?%0AI(X,Y)=H(Y)-H(Y%7CX)%0A"> <img src="https://latex.codecogs.com/png.latex?H(Y)"> は 1. から判明しており，<img src="https://latex.codecogs.com/png.latex?H(Y%7CX)"> は次のように計算できる：</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AH(Y%7CX)&amp;=-%5Cint_%7B%5Cmathbb%7BR%7D%5E%7Bn+1%7D%7D%5Clog%20p(%5Cboldsymbol%7By%7D%7Cx)p(%5Cboldsymbol%7By%7D%7Cx)p(x)%5C,dxd%5Cboldsymbol%7By%7D%5C%5C%0A&amp;=-%5Cint_%7B%5Cmathbb%7BR%7D%5E%7Bn+1%7D%7D%5Clog%5Cleft(%5Cfrac%7B1%7D%7B(2%5Cpi%5Csigma%5E2)%5E%7B%5Cfrac%7Bn%7D%7B2%7D%7D%7D%5Cexp%5Cleft(-%5Cfrac%7B1%7D%7B2%5Csigma%5E2%7D%5Csum_%7Bi=1%7D%5En(y_i-x)%5E2%5Cright)%5Cright)p(%5Cboldsymbol%7By%7D%7Cx)p(x)%5C,dxd%5Cboldsymbol%7By%7D%5C%5C%0A&amp;=%5Cint_%7B%5Cmathbb%7BR%7D%5E%7Bn+1%7D%7D%5Cleft(%5Cfrac%7Bn%7D%7B2%7D%5Clog(2%5Cpi%5Csigma%5E2)+%5Cfrac%7B%5Csum_%7Bi=1%7D%5En(x-y_i)%5E2%7D%7B2%5Csigma%5E2%7D%5Cright)p(%5Cboldsymbol%7By%7D%7Cx)p(x)%5C,dxd%5Cboldsymbol%7By%7D%5C%5C%0A&amp;=%5Cfrac%7Bn%7D%7B2%7D%5Clog(2%5Cpi%5Csigma%5E2)+%5Cfrac%7B1%7D%7B2%5Csigma%5E2%7D%5Cint_%5Cmathbb%7BR%7D%5Cleft(%5Cint_%7B%5Cmathbb%7BR%7D%5En%7D%5Csum_%7Bi=1%7D%5En(x-y_i)%5E2p(%5Cboldsymbol%7By%7D%7Cx)%5C,d%5Cboldsymbol%7By%7D%5Cright)%5C,p(x)dx%5C%5C%0A&amp;=%5Cfrac%7Bn%7D%7B2%7D%5Clog(2%5Cpi%5Csigma%5E2)+%5Cfrac%7Bn%5Csigma%5E2%7D%7B2%5Csigma%5E2%7D%5Cint_%5Cmathbb%7BR%7Dp(x)%5C,dx%5C%5C%0A&amp;=%5Cfrac%7Bn%7D%7B2%7D%5Clog(2%5Cpi%5Csigma%5E2)+%5Cfrac%7Bn%7D%7B2%7D.%0A%5Cend%7Balign*%7D"></p></li>
</ol>
<p>これと，<img src="https://latex.codecogs.com/png.latex?y_i"> には <img src="https://latex.codecogs.com/png.latex?x_i"> とこれと独立な分散 <img src="https://latex.codecogs.com/png.latex?%5Csigma%5E2"> のノイズが加わって得られる値であることから，次のように計算できる： <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20I(X,Y)&amp;=H(Y)-%5Cfrac%7Bn%7D%7B2%7D%5Clog(2%5Cpi%5Csigma%5E2)-%5Cfrac%7Bn%7D%7B2%7D%5C%5C%0A%20%20%20%20&amp;=-F_n-%5Cfrac%7Bn%7D%7B2%7D+%5Cfrac%7Bn%7D%7B2%5Csigma%5E2%7D%5Cint_%5Cmathbb%7BR%7Dy_i%5E2p(y_i)%5C,dy_i%5C%5C%0A%20%20%20%20&amp;=-F_n-%5Cfrac%7Bn%7D%7B2%7D+%5Cfrac%7Bn%7D%7B2%5Csigma%5E2%7D%5Cleft(%5Csigma%5E2+%5Cint_%5Cmathbb%7BR%7Dx%5E2p(x)%5C,dx%5Cright)%5C%5C%0A%20%20%20%20&amp;=-F_n+%5Cfrac%7Bn%7D%7B2%5Csigma%5E2%7D%5Cint_%5Cmathbb%7BR%7Dx%5E2p(x)%5C,dx.%0A%5Cend%7Balign*%7D"></p>
</div>
</div>
</div>
</section>
<section id="sec-Nishimori-symmetry" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="sec-Nishimori-symmetry"><span class="header-section-number">2.3</span> 西森対称性</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題 [@西森1980]^[[@Zdeborova-Krzakala2016 p.464]，[@Krzakala-Zdeborova2024 p.123] 定理13，[@Iba1999 pp.3876-3877] などで扱われている．西森ライン上のみで見られる性質であるため，西森対称性と呼ぶ．西森ラインについては [次項](Bayes2.qmd#sec-Nishimori-line) も参照．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題 <span class="citation" data-cites="西森1980">(Nishimori, 1980)</span><sup>4</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?P:%5Cmathbb%7BR%7D%5Cto%5Cmathbb%7BR%7D%5En"> を確率核，<img src="https://latex.codecogs.com/png.latex?X%5E*%5Cin%5Cmathcal%7BL%7D(%5COmega)"> は分布 <img src="https://latex.codecogs.com/png.latex?%5Cnu%5Cin%5Cmathcal%7BP%7D(%5Cmathbb%7BR%7D)"> を持ち，<img src="https://latex.codecogs.com/png.latex?Y%5Cin%5Cmathcal%7BL%7D(%5COmega;%5Cmathbb%7BR%7D%5En)"> の分布は <img src="https://latex.codecogs.com/png.latex?%0A%5Cmu(dy)=%5Cint_%5Cmathbb%7BR%7D%5Cnu(dx)P(x,dy)%0A"> で定まるとする．ここで，<img src="https://latex.codecogs.com/png.latex?Y"> で条件づけた <img src="https://latex.codecogs.com/png.latex?X%5E*"> の確率分布を <img src="https://latex.codecogs.com/png.latex?P%5E%7BX%7CY%7D"> とする： <img src="https://latex.codecogs.com/png.latex?%0A%5Cnu(dx)=%5Cint_%7B%5Cmathbb%7BR%7D%5En%7D%5Cmu(dy)P%5E%7BX%7CY%7D(y,dx).%0A"> <img src="https://latex.codecogs.com/png.latex?%0AX%5E%7B(1)%7D,%5Ccdots,X%5E%7B(k)%7D%5Coverset%7B%5Ctext%7Biid%7D%7D%7B%5Csim%7DP%5E%7BX%7CY%7D%0A"> を独立な確率変数列とすると，次が成り立つ：任意の <img src="https://latex.codecogs.com/png.latex?f%5Cin%5Cmathcal%7BL%7D_b(%5Cmathbb%7BR%7D%5E%7Bn+k%7D)"> について，</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20&amp;%5Cquad%5Coperatorname%7BE%7D%5Cbiggl%5Bf(Y,X%5E%7B(1)%7D,%5Ccdots,X%5E%7B(k)%7D)%5Cbiggr%5D%5C%5C%0A%20%20%20%20&amp;=%5Coperatorname%7BE%7D%5Cleft%5Bf(Y,X%5E%7B(1)%7D,%5Ccdots,X%5E%7B(k-1)%7D,X%5E*)%5Cright%5D.%0A%5Cend%7Balign*%7D"></p>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?X%5E%7B(1)%7D,%5Ccdots,X%5E%7B(k)%7D"> で表した確率変数の <img src="https://latex.codecogs.com/png.latex?P%5E%7BX%7CY%7D"> に関する積分を Boltzmann 積分または熱平均と呼び，観測を作り出す過程 <img src="https://latex.codecogs.com/png.latex?(X%5E*,Y)"> に関する積分を無秩序積分 (disorder expectation) または quenched average という．<sup>5</sup></p>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>この設定の下で，<img src="https://latex.codecogs.com/png.latex?(X%5E*,Y)"> の結合分布が次の２通りで表せていることに注意： <img src="https://latex.codecogs.com/png.latex?%0A%5Cnu(dx)P(x,dy)=%5Cmu(dy)P%5E%7BX%7CY%7D(y,dx).%0A"> 従って， <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20&amp;%5Cquad%5Cnu(dx)P(x,dy)P%5E%7BX%7CY%7D(y,dx%5E%7B(1)%7D,%5Ccdots,dx%5E%7B(k)%7D)%5C%5C%0A%20%20%20%20&amp;=%5Cmu(dy)P%5E%7BX%7CY%7D(y,dx)P%5E%7BX%7CY%7D(y,dx%5E%7B(1)%7D,%5Ccdots,dx%5E%7B(k)%7D)%0A%5Cend%7Balign*%7D"> に関して <img src="https://latex.codecogs.com/png.latex?f(Y,X%5E%7B(1)%7D,%5Ccdots,X%5E%7B(k)%7D)"> の期待値を取ると，次のように計算できる： <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20&amp;%5Cquad%5Coperatorname%7BE%7D%5Cbiggl%5Bf(Y,X%5E%7B(1)%7D,%5Ccdots,X%5E%7B(k)%7D)%5Cbiggr%5D%5C%5C%0A%20%20%20%20&amp;=%5Cint_%7B%5Cmathbb%7BR%7D%5E%7Bn+k%7D%7Df(y,x%5E%7B(1)%7D,%5Ccdots%20,x%5E%7B(k-1)%7D,x%5E%7B(k)%7D)P%5E%7BX%7CY%7D(y,dx%5E%7B(1)%7D)%5Ccdots%20P%5E%7BX%7CY%7D(y,dx%5E%7B(k)%7D)%5Cmu(dy)%5C%5C%0A%20%20%20%20&amp;=%5Cint_%7B%5Cmathbb%7BR%7D%5E%7Bn+k%7D%7Df(y,x%5E%7B(1)%7D,%5Ccdots,x%5E%7B(k-1)%7D,x)P%5E%7BX%7CY%7D(y,dx%5E%7B(1)%7D)%5Ccdots%20P%5E%7BX%7CY%7D(y,dx%5E%7B(k-1)%7D)%5Cnu(dx)P(x,dy)%5C%5C%0A%20%20%20%20&amp;=%5Coperatorname%7BE%7D%5Cleft%5Bf(Y,X%5E%7B(1)%7D,%5Ccdots,X%5E%7B(k-1)%7D,X%5E*)%5Cright%5D.%0A%5Cend%7Balign*%7D"></p>
<p>確率核 <img src="https://latex.codecogs.com/png.latex?P"> にまつわる記法は次の記事も参照：</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/static/Notations.html" target="_blank">
            <img src="https://162348.github.io/static/Notations.svg" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">数学記法一覧</h3>
                <p class="article-description">本サイトで用いる記法と規約</p>
            </div>
        </a>
    </div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="物理的な解釈">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
物理的な解釈
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?P%5E%7BX%7CY%7D"> に関する積分を <img src="https://latex.codecogs.com/png.latex?%5Clangle-%5Crangle"> で表すことで，何をどのように物理的に解釈しているかが明確になる： <img src="https://latex.codecogs.com/png.latex?%0A%5Clangle%20X%5Crangle=%5Coperatorname%7BE%7D%5BX%7CY%5D.%0A"></p>
<p>この見方を採用すると，期待値を <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BE%7D%5Cbiggl%5Bf(Y,X%5E%7B(1)%7D,%5Ccdots,X%5E%7B(k)%7D)%5Cbiggr%5D=%5Coperatorname%7BE%7D%5EY%5Cleft%5B%5Cleft%5Clangle%20f(Y,X%5E%7B(1)%7D,%5Ccdots,X%5E%7B(k)%7D)%5Cright%5Crangle%5Cright%5D%0A"> と二段階で捉えていることになる．右辺の外側の期待値は単に <img src="https://latex.codecogs.com/png.latex?Y"> のみに関してとっていることになる．</p>
<p>第 2.2 節で考えたモデル <img src="https://latex.codecogs.com/png.latex?H"> における Boltzmann 分布が <img src="https://latex.codecogs.com/png.latex?P%5E%7BX%7CY%7D"> となり，平均 <img src="https://latex.codecogs.com/png.latex?%5Clangle-%5Crangle"> はこれに関する平均となる．</p>
<p>一方で，Hamiltonian <img src="https://latex.codecogs.com/png.latex?H"> にもランダム性が残っているのであり，これに関する平均が <img src="https://latex.codecogs.com/png.latex?(X%5E*,Y)"> に関する平均に当たる．</p>
<p>こうして，ベイズ統計モデルはスピングラス系（特にランダムエネルギーモデル <span class="citation" data-cites="Derrida1980">(Derrida, 1980)</span>）と同一視できるようになる．</p>
<p>だが同時に，スピングラスのサンプリングを困難にする多谷構造も，ベイズ統計に輸入されるのである……．</p>
<p>スピングラスについては，次の記事も参照：</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Nature/StatisticalMechanics1.html" target="_blank">
            <img src="https://162348.github.io/posts/2024/Nature/SG.png" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">数学者のための統計力学１</h3>
                <p class="article-description">Ising 模型とスピングラス</p>
            </div>
        </a>
    </div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-MMSE-via-Nishimori" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="sec-MMSE-via-Nishimori"><span class="header-section-number">2.4</span> 最小自乗誤差推定量</h3>
<p>第 1.4.1 節で扱った最小自乗誤差推定量の自乗誤差は次のように計算できる：</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（最小自乗誤差の表示）">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（最小自乗誤差の表示）
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Clangle%20X%5Crangle:=%5Coperatorname%7BE%7D%5BX%7CY%5D"> と表す．事後平均推定量の自乗誤差は次のように表せる： <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5CDeclareMathOperator%7B%5CMMSE%7D%7BMMSE%7D%0A%20%20%20%20%5CMMSE&amp;:=%5Coperatorname%7BE%7D%5Cbiggl%5B%5Cbiggr(X-%5Coperatorname%7BE%7D%5BX%7CY%5D%5Cbiggl)%5E2%5Cbiggr%5D%5C%5C%0A%20%20%20%20&amp;=%5Coperatorname%7BE%7D%5BX%5E2%5D-%5Coperatorname%7BE%7D%5Cbiggl%5B%5Clangle%20X%5Crangle%5E2%5Cbiggr%5D.%0A%5Cend%7Balign*%7D"></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Coperatorname%7BE%7D%5B%5Cmathrm%7BV%7D%5BX%7CY%5D%5D&amp;=%5Coperatorname%7BE%7D%5Cbiggl%5B%5Cbiggr(%5Coperatorname%7BE%7D%5BX%7CY%5D-X%5Cbiggl)%5E2%5Cbiggr%5D%5C%5C%0A%20%20%20%20&amp;=%5Coperatorname%7BE%7D%5Cbiggl%5B%5Coperatorname%7BE%7D%5BX%7CY%5D%5E2-2X%5Coperatorname%7BE%7D%5BX%7CY%5D+X%5E2%5Cbiggr%5D%5C%5C%0A%20%20%20%20&amp;=%5Coperatorname%7BE%7D%5Cbiggl%5B%5Coperatorname%7BE%7D%5BX%7CY%5D%5E2%5Cbiggr%5D-2%5Coperatorname%7BE%7D%5Cbiggl%5BX%5Coperatorname%7BE%7D%5BX%7CY%5D%5Cbiggr%5D+%5Coperatorname%7BE%7D%5BX%5E2%5D%5C%5C%0A%20%20%20%20&amp;=%5Coperatorname%7BE%7D%5BX%5E2%5D-%5Coperatorname%7BE%7D%5Cbiggl%5B%5Coperatorname%7BE%7D%5BX%7CY%5D%5E2%5Cbiggr%5D.%0A%5Cend%7Balign*%7D"></p>
<p>この変形では，繰り返し期待値の法則 <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Coperatorname%7BE%7D%5Cbiggl%5BX%5Coperatorname%7BE%7D%5BX%7CY%5D%5Cbiggr%5D&amp;=%5Coperatorname%7BE%7D%5Cbiggl%5B%5Cbiggl%5BX%5Coperatorname%7BE%7D%5BX%7CY%5D%5C,%5Cbigg%7C%5C,Y%5Cbiggr%5D%5Cbiggr%5D%5C%5C%0A%20%20%20%20&amp;=%5Coperatorname%7BE%7D%5Cbiggl%5B%5Coperatorname%7BE%7D%5BX%7CY%5D%5E2%5Cbiggr%5D%0A%5Cend%7Balign*%7D"> を西森の対称性の代わりに用いたことになる．</p>
<p>換言すれば，西森の対称性を証明したのと同様の方法を本命題にも適用したため，直接命題の適用は回避したことになる．</p>
</div>
</div>
</div>
</section>
<section id="sec-I-MMSE" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="sec-I-MMSE"><span class="header-section-number">2.5</span> KL 乖離度の微分としての分散</h3>
<p>次の定理は，相互情報量 <img src="https://latex.codecogs.com/png.latex?I"> と MMSE を結びつける定理であるため，<span class="citation" data-cites="Guo+2005">(Guo et al., 2005)</span> 以来，<strong>I-MMSE 定理</strong> と呼ばれている．</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（自由エネルギーによる特徴付け） [@Guo+2005]^[[@Krzakala-Zdeborova2024 p.124] 定理14．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（自由エネルギーによる特徴付け） <span class="citation" data-cites="Guo+2005">(Guo et al., 2005)</span><sup>6</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p>簡単のため，<img src="https://latex.codecogs.com/png.latex?n=1"> とする．このとき，<img src="https://latex.codecogs.com/png.latex?%5Cbeta:=%5Csigma%5E%7B-2%7D"> に関して，次の式が成り立つ：</p>
<ol type="1">
<li><p>自由エネルギー <img src="https://latex.codecogs.com/png.latex?F_1"> について， <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20F_1%7D%7B%5Cpartial%20%5Cbeta%7D=%5Cfrac%7B%5Coperatorname%7BE%7D%5B%5Clangle%20X%5Crangle%5E2%5D%7D%7B2%7D.%0A"></p></li>
<li><p>相互情報量 <img src="https://latex.codecogs.com/png.latex?I(X,Y)"> について，</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20I(X,Y)%7D%7B%5Cpartial%20%5Cbeta%7D&amp;=%5Cfrac%7B%5Coperatorname%7BE%7D%5BX%5E2%5D-%5Coperatorname%7BE%7D%5B%5Clangle%20X%5Crangle%5E2%5D%7D%7B2%7D%5C%5C%0A%20%20%20%20&amp;=%5Cfrac%7B%5CMMSE%7D%7B2%7D%0A%5Cend%7Balign*%7D"></p></li>
</ol>
<p>ただし，<img src="https://latex.codecogs.com/png.latex?%5Clangle%20X%5Crangle:=%5Coperatorname%7BE%7D%5BX%7CY%5D"> と定めた．</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Clog%5Cfrac%7Bp(y)%7D%7Bq(y)%7D&amp;=%5Cfrac%7B%5Cdisplaystyle%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%5Csigma%5E2%7D%7D%5Cint_%5Cmathbb%7BR%7De%5E%7B-%5Cfrac%7B(x-y)%5E2%7D%7B2%5Csigma%5E2%7D%7Dp(x)%5C,dx%7D%7B%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%5Csigma%5E2%7D%7De%5E%7B-%5Cfrac%7By%5E2%7D%7B2%5Csigma%5E2%7D%7D%7D%5C%5C%0A%20%20%20%20&amp;=%5Cint_%5Cmathbb%7BR%7De%5E%7B-%5Cfrac%7Bx%5E2-2xy%7D%7B2%5Csigma%5E2%7D%7Dp(x)%5C,dx.%0A%5Cend%7Balign*%7D"></p>
<p>この <img src="https://latex.codecogs.com/png.latex?p(y)dy"> に関する積分を <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> で微分すれば良いのであるが，<img src="https://latex.codecogs.com/png.latex?p(y)"> 自体が <img src="https://latex.codecogs.com/png.latex?%5Csigma"> に依存し，そのまま計算したのでは大変煩雑になる．</p>
<p>そこで，<img src="https://latex.codecogs.com/png.latex?y=%5Csigma%20z+x%5E*"> と変数変換をすることで，標準 Gauss 確率変数 <img src="https://latex.codecogs.com/png.latex?Z%5Csim%5Cgamma_1"> と真値 <img src="https://latex.codecogs.com/png.latex?X%5E*"> は独立で，<img src="https://latex.codecogs.com/png.latex?%5Csigma"> も含まないから，次のように計算ができる： <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20F_1(%5Cbeta)&amp;=%5Cint_%5Cmathbb%7BR%7D%5Clog%5Cfrac%7Bp(y)%7D%7Bq(y)%7Dp(y)%5C,dy%5C%5C%0A%20%20%20%20&amp;=%5Coperatorname%7BE%7D%5Cbiggl%5B%5Clog%5Cleft(%5Cint_%5Cmathbb%7BR%7De%5E%7B-%5Cfrac%7Bx%5E2-2xY%7D%7B2%5Csigma%5E2%7D%7Dp(x)%5C,dx%5Cright)%5Cbiggr%5D%5C%5C%0A%20%20%20%20&amp;=%5Coperatorname%7BE%7D%5Cbiggl%5B%5Clog%5Cleft(%5Cint_%5Cmathbb%7BR%7D%5Cexp%5Cleft(-%5Cfrac%7Bx%5E2%7D%7B2%5Csigma%5E2%7D+%5Cfrac%7BxZ%7D%7B%5Csigma%7D+%5Cfrac%7BxX%5E*%7D%7B%5Csigma%5E2%7D%5Cright)p(x)%5C,dx%5Cright)%5Cbiggr%5D%5C%5C%0A%20%20%20%20&amp;=%5Coperatorname%7BE%7D%5Cbiggl%5B%5Clog%5Cleft(%5Cint_%5Cmathbb%7BR%7D%5Cexp%5Cleft(-%5Cfrac%7Bx%5E2%5Cbeta%7D%7B2%7D+xZ%5Csqrt%7B%5Cbeta%7D+xX%5E*%5Cbeta%5Cright)p(x)%5C,dx%5Cright)%5Cbiggr%5D.%0A%5Cend%7Balign*%7D"></p>
<p>こうして，最右辺の期待値に関する密度はもう <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> に依存しないから，次のように微分が計算できる．ただし， <img src="https://latex.codecogs.com/png.latex?%0A%5Cexp%5Cleft(-%5Cfrac%7Bx%5E2%5Cbeta%7D%7B2%7D+xZ%5Csqrt%7B%5Cbeta%7D+xX%5E*%5Cbeta%5Cright)p(x)%5C,dx%0A"> は <img src="https://latex.codecogs.com/png.latex?p(x%7Cy)"> の定数倍，すなわち Gibbs 測度 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Be%5E%7B-H(x,y)%7D%7D%7BZ(y)%7Ddx"> の定数倍であることに注意して，これらに関する平均を引き続き <img src="https://latex.codecogs.com/png.latex?%5Clangle-%5Crangle:=%5Coperatorname%7BE%7D%5B-%7CY%5D"> で表すこととすると，</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20F_1(%5Cbeta)%7D%7B%5Cpartial%20%5Cbeta%7D&amp;=%0A%20%20%20%20%5Coperatorname%7BE%7D%5Cleft%5B%5Cfrac%7B%5Cdisplaystyle%5Cint_%5Cmathbb%7BR%7D%5Cbiggr(-%5Cfrac%7Bx%5E2%7D%7B2%7D+%5Cfrac%7BxZ%7D%7B2%5Csqrt%7B%5Cbeta%7D%7D+xX%5E*%5Cbiggl)e%5E%7B-%5Cfrac%7Bx%5E2%5Cbeta%7D%7B2%7D+xZ%5Csqrt%7B%5Cbeta%7D+xX%5E*%5Cbeta%7Dp(x)dx%7D%7B%5Cdisplaystyle%5Cint_%5Cmathbb%7BR%7D%5Cexp%5Cleft(-%5Cfrac%7Bx%5E2%5Cbeta%7D%7B2%7D+xZ%5Csqrt%7B%5Cbeta%7D+xX%5E*%5Cbeta%5Cright)p(x)%5C,dx%7D%5Cright%5D%5C%5C%0A%20%20%20%20&amp;=-%5Cfrac%7B%5Coperatorname%7BE%7D%5B%5Clangle%20X%5E2%5Crangle%5D%7D%7B2%7D+%5Cfrac%7B1%7D%7B2%5Csqrt%7B%5Cbeta%7D%7D%5Coperatorname%7BE%7D%5B%5Clangle%20X%5Crangle%20Z%5D+%5Coperatorname%7BE%7D%5B%5Clangle%20X%5Crangle%20X%5E*%5D.%0A%5Cend%7Balign*%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Clangle%20X%5Crangle"> が中に入っているのは，<img src="https://latex.codecogs.com/png.latex?%5Csigma%5BX%5E*,Z%5D"> に関する条件付き期待値を <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BE%7D"> 内で取ったためと捉えられる．</p>
<p>まず，第二項は，Stein の補題 2.6 の系から， <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Cfrac%7B1%7D%7B2%5Csqrt%7B%5Cbeta%7D%7D%5Coperatorname%7BE%7D%5B%5Clangle%20X%5Crangle%20Z%5D&amp;=%5Cfrac%7B1%7D%7B2%5Csqrt%7B%5Cbeta%7D%7D%5Csqrt%7B%5Cbeta%7D%5Cbiggr(%5Coperatorname%7BE%7D%5B%5Clangle%20X%5E2%5Crangle%5D-%5Coperatorname%7BE%7D%5B%5Clangle%20X%5Crangle%5E2%5D%5Cbiggl)%5C%5C%0A%20%20%20%20&amp;=%5Cfrac%7B%5Coperatorname%7BE%7D%5B%5Clangle%20X%5E2%5Crangle%5D%7D%7B2%7D-%5Cfrac%7B%5Coperatorname%7BE%7D%5B%5Clangle%20X%5Crangle%5E2%5D%7D%7B2%7D%0A%5Cend%7Balign*%7D"></p>
<p>第三項は，西森の対称性から， <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Coperatorname%7BE%7D%5B%5Clangle%20X%5Crangle%20X%5E*%5D=%5Coperatorname%7BE%7D%5B%5Clangle%20X%5Crangle%5E2%5D.%0A%5Cend%7Balign*%7D"></p>
<p>以上を併せると， <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20F_1(%5Cbeta)%7D%7B%5Cpartial%20%5Cbeta%7D=%5Cfrac%7B%5Coperatorname%7BE%7D%5B%5Clangle%20X%5Crangle%5E2%5D%7D%7B2%7D.%0A"></p>
<ol type="1">
<li>の主張も，<img src="https://latex.codecogs.com/png.latex?n=1"> のときは <img src="https://latex.codecogs.com/png.latex?%0AI(X,Y)=%5Cfrac%7B%5Cbeta%7D%7B2%7D%5Cint_%5Cmathbb%7BR%7Dx%5E2p(x)%5C,dx-F_1%0A"> であったために従う： <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20I(X,Y)%7D%7B%5Cpartial%20%5Cbeta%7D&amp;=%5Cfrac%7B%5Coperatorname%7BE%7D%5BX%5E2%5D%7D%7B2%7D-%5Cfrac%7B%5Coperatorname%7BE%7D%5B%5Clangle%20X%5Crangle%5E2%5D%7D%7B2%7D%5C%5C%0A&amp;=%5Cfrac%7B%5CMMSE%7D%7B2%7D.%0A%5Cend%7Balign*%7D"></li>
</ol>
</div>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BE%7D%5B%5Clangle%20X%5Crangle%5E2%5D"> は <img src="https://latex.codecogs.com/png.latex?q"> とも表され，スピングラスの <strong>秩序パラメータ</strong> ともいう．<sup>7</sup></p>
<p><img src="https://latex.codecogs.com/png.latex?I"> の <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> に関する二回微分を計算することより，<img src="https://latex.codecogs.com/png.latex?%5Cbeta"> に関する凸関数であることもわかる．</p>
</section>
<section id="sec-Steins-lemma" class="level3" data-number="2.6">
<h3 data-number="2.6" class="anchored" data-anchor-id="sec-Steins-lemma"><span class="header-section-number">2.6</span> Stein の補題</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題 [@Stein1972]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題 <span class="citation" data-cites="Stein1972">(Stein, 1972)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>可積分な確率変数 <img src="https://latex.codecogs.com/png.latex?X%5Cin%5Cmathcal%7BL%7D%5E1(%5COmega)"> について，次は同値：</p>
<ol type="1">
<li><img src="https://latex.codecogs.com/png.latex?X"> の分布は標準Gaussである：<img src="https://latex.codecogs.com/png.latex?X%5Csim%5Cgamma_1">．</li>
<li>任意の <img src="https://latex.codecogs.com/png.latex?f%5Cin%20C%5E1_b(%5Cmathbb%7BR%7D)"> について， <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BE%7D%5Bf'(X)%5D=%5Coperatorname%7BE%7D%5BXf(X)%5D%3C%5Cinfty.%0A"></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>(1)<img src="https://latex.codecogs.com/png.latex?%5CRightarrow">(2)</p>
<p><img src="https://latex.codecogs.com/png.latex?f,f'"> はいずれも有界としたから， <img src="https://latex.codecogs.com/png.latex?%0A%20%20%5Coperatorname%7BE%7D%5Bf'(X)%5D,%5Coperatorname%7BE%7D%5Bf(X)%5D%3C%5Cinfty%0A%20%20"> が成り立つ．</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cgamma_1"> の密度 <img src="https://latex.codecogs.com/png.latex?%5Cphi"> は <img src="https://latex.codecogs.com/png.latex?%5Cphi'(x)=-x%5Cphi(x)"> を満たすことに注意すれば，部分積分により， <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%20%20%5Coperatorname%7BE%7D%5Bf'(X)%5D&amp;=-%5Cint_%5Cmathbb%7BR%7Df(x)%5Cphi'(x)dx%5C%5C%0A%20%20%20%20%20%20&amp;=%5Cint_%5Cmathbb%7BR%7Df(x)x%5Cphi(x)dx=%5Coperatorname%7BE%7D%5Bf(X)X%5D.%0A%20%20%5Cend%7Balign*%7D"></p></li>
<li><p>(2)<img src="https://latex.codecogs.com/png.latex?%5CRightarrow">(1)</p>
<p><img src="https://latex.codecogs.com/png.latex?X"> は可積分としたから，特性関数 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(u):=%5Coperatorname%7BE%7D%5Be%5E%7BiuX%7D%5D"> は少なくとも <img src="https://latex.codecogs.com/png.latex?C%5E1(%5Cmathbb%7BR%7D)">-級で，その微分は <img src="https://latex.codecogs.com/png.latex?%5Cphi(x):=e%5E%7Biux%7D"> に関する仮定 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BE%7D%5B%5Cphi'(X)%5D=%5Coperatorname%7BE%7D%5BX%5Cphi(X)%5D"> を通じて <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%20%20%5Cvarphi'(u)&amp;=i%5Coperatorname%7BE%7D%5BXe%5E%7BiuX%7D%5D=-u%5Coperatorname%7BE%7D%5Be%5E%7BiuX%7D%5D%5C%5C%0A%20%20%20%20%20%20&amp;=-u%5Cvarphi(u),%5Cqquad%20u%5Cin%5Cmathbb%7BR%7D,%0A%20%20%5Cend%7Balign*%7D"> と計算できる．</p>
<p>この微分方程式は規格化条件 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(0)=1"> の下で一意な解 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(u)=e%5E%7B-%5Cfrac%7Bu%5E2%7D%7B2%7D%7D"> を持つ．</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="系">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
系
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Clangle%20X%5Crangle:=%5Coperatorname%7BE%7D%5BX%7CY%5D"> とこれと独立な <img src="https://latex.codecogs.com/png.latex?Z%5Csim%5Cgamma_1"> に関して，次が成り立つ：</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Coperatorname%7BE%7D%5B%5Clangle%20X%5Crangle%20Z%5D&amp;=%5Coperatorname%7BE%7D%5Cleft%5B%5Cfrac%7B%5Cpartial%20%5Clangle%20X%5Crangle%7D%7B%5Cpartial%20Z%7D%5Cright%5D%5C%5C%0A%20%20%20%20&amp;=%5Csqrt%7B%5Cbeta%7D%5Cbiggr(%5Coperatorname%7BE%7D%5B%5Clangle%20X%5E2%5Crangle%5D-%5Coperatorname%7BE%7D%5B%5Clangle%20X%5Crangle%5E2%5D%5Cbiggl)%0A%5Cend%7Balign*%7D"></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>最初の等号 <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BE%7D%5B%5Clangle%20X%5Crangle%20Z%5D=%5Coperatorname%7BE%7D%5Cleft%5B%5Cfrac%7B%5Cpartial%20%5Clangle%20X%5Crangle%7D%7B%5Cpartial%20Z%7D%5Cright%5D%0A"> は Stein の補題による．</p>
<p>続いて， <img src="https://latex.codecogs.com/png.latex?%0A%5Clangle%20X%5Crangle=%5Cint_%5Cmathbb%7BR%7Dxp(x%7CY)%5C,dx%0A"> は <img src="https://latex.codecogs.com/png.latex?Y=%5Csigma%20Z+X%5E*"> を通じてのみ <img src="https://latex.codecogs.com/png.latex?Z"> に依存するから， <span id="eq-chain-rule"><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%5Clangle%20X%5Crangle%7D%7B%5Cpartial%20Z%7D=%5Cfrac%7B%5Cpartial%20%5Clangle%20X%5Crangle%7D%7B%5Cpartial%20Y%7D%5Cfrac%7Bd%20Y%7D%7Bd%20Z%7D=%5Csigma%5Cfrac%7B%5Cpartial%20%5Clangle%20X%5Crangle%7D%7B%5Cpartial%20Y%7D%0A%5Ctag%7B2%7D"></span> が成り立つ．あとは <img src="https://latex.codecogs.com/png.latex?%5Clangle%20X%5Crangle=%5Coperatorname%7BE%7D%5BX%7CY%5D"> の <img src="https://latex.codecogs.com/png.latex?Y"> に関する微分を計算すれば良い．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20p(y%7Cx)%7D%7B%5Cpartial%20y%7D=-%5Cfrac%7By-x%7D%7B%5Csigma%5E2%7Dp(y%7Cx).%0A"> また， <img src="https://latex.codecogs.com/png.latex?%0Ap(y)=%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%5Csigma%5E2%7D%7D%5Cint_%5Cmathbb%7BR%7De%5E%7B-%5Cfrac%7B(x-y)%5E2%7D%7B2%5Csigma%5E2%7D%7Dp(x)%5C,dx%0A"> であったから， <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20p'(y)&amp;=%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%5Csigma%5E2%7D%7D%5Cint_%5Cmathbb%7BR%7D-%5Cfrac%7By-x%7D%7B%5Csigma%5E2%7De%5E%7B-%5Cfrac%7B(x-y)%5E2%7D%7B2%5Csigma%5E2%7D%7Dp(x)%5C,dx%5C%5C%0A%20%20%20%20&amp;=-%5Cint_%5Cmathbb%7BR%7D%5Cfrac%7By-x%7D%7B%5Csigma%5E2%7Dp(y%7Cx)p(x)%5C,dx%5C%5C%0A%20%20%20%20&amp;=-%5Cint_%5Cmathbb%7BR%7D%5Cfrac%7By-x%7D%7B%5Csigma%5E2%7Dp(x%7Cy)p(y)%5C,dx%5C%5C%0A%20%20%20%20&amp;=-%5Cfrac%7By-%5Clangle%20X%5Crangle%7D%7B%5Csigma%5E2%7Dp(y).%0A%5Cend%7Balign*%7D"> <img src="https://latex.codecogs.com/png.latex?%0A%5Ctherefore%5Cquad%5Cfrac%7Bp'(Y)%7D%7Bp(Y)%7D=%5Cfrac%7B%5Clangle%20X%5Crangle-Y%7D%7B%5Csigma%5E2%7D%0A"></p>
<p>に注意すれば，次のように計算できる：</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5Clangle%20X%5Crangle%7D%7B%5Cpartial%20Y%7D&amp;=%5Cfrac%7B%5Cpartial%20%7D%7B%5Cpartial%20Y%7D%5Cint_%5Cmathbb%7BR%7Dxp(x%7CY)%5C,dx%5C%5C%0A%20%20%20%20&amp;=%5Cfrac%7B%5Cpartial%20%7D%7B%5Cpartial%20Y%7D%5Cint_%5Cmathbb%7BR%7Dx%5Cfrac%7Bp(Y%7Cx)p(x)%7D%7Bp(Y)%7D%5C,dx%5C%5C%0A%20%20%20%20&amp;=%5Cint_%5Cmathbb%7BR%7Dx%5Cfrac%7B%5Cpartial%20%7D%7B%5Cpartial%20Y%7D%5Cfrac%7Bp(Y%7Cx)p(x)%7D%7Bp(Y)%7D%5C,dx%5C%5C%0A%20%20%20%20&amp;=%5Cint_%5Cmathbb%7BR%7Dx%5Cfrac%7B%5Cpartial%20p(Y%7Cx)%7D%7B%5Cpartial%20Y%7D%5Cfrac%7Bp(x)%7D%7Bp(Y)%7D%5C,dx%5C%5C%0A%20%20%20%20&amp;%5Cqquad+%5Cint_%5Cmathbb%7BR%7Dx%5Cleft(%5Cfrac%7B%5Cpartial%20%7D%7B%5Cpartial%20Y%7D%5Cfrac%7B1%7D%7Bp(Y)%7D%5Cright)p(Y%7Cx)p(x)%5C,dx%5C%5C%0A%20%20%20%20&amp;=-%5Cint_%5Cmathbb%7BR%7Dx%5Cfrac%7BY-x%7D%7B%5Csigma%5E2%7Dp(x%7CY)%5C,dx%5C%5C%0A%20%20%20%20&amp;%5Cqquad-%5Cfrac%7Bp'(Y)%7D%7Bp(Y)%7D%5Cint_%5Cmathbb%7BR%7Dxp(x%7CY)%5C,dx%5C%5C%0A%20%20%20%20&amp;=-%5Cfrac%7BY%7D%7B%5Csigma%5E2%7D%5Clangle%20X%5Crangle+%5Cfrac%7B%5Clangle%20X%5E2%5Crangle%7D%7B%5Csigma%5E2%7D%5C%5C%0A%20%20%20%20&amp;%5Cqquad-%5Clangle%20X%5Crangle%5Cfrac%7B%5Clangle%20X%5Crangle-Y%7D%7B%5Csigma%5E2%7D%5C%5C%0A%20%20%20%20&amp;=%5Cfrac%7B1%7D%7B%5Csigma%5E2%7D%5Cbiggr(%5Clangle%20X%5E2%5Crangle-%5Clangle%20X%5Crangle%5E2%5Cbiggl).%0A%5Cend%7Balign*%7D"></p>
<p>最後，式 (<img src="https://latex.codecogs.com/png.latex?%5Cref%7Beq-chain-rule%7D">) より， <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5Clangle%20X%5Crangle%7D%7B%5Cpartial%20Z%7D&amp;=%5Csigma%5Cfrac%7B%5Cpartial%20%5Clangle%20X%5Crangle%7D%7B%5Cpartial%20Y%7D%5C%5C%0A%20%20%20%20&amp;=%5Csqrt%7B%5Cbeta%7D%5Cbiggr(%5Clangle%20X%5E2%5Crangle-%5Clangle%20X%5Crangle%5E2%5Cbiggl).%0A%5Cend%7Balign*%7D"></p>
<!-- 
\begin{align*}
    \E\Square{\pp{\brac{X}}{Z}}&=\E\Square{\pp{}{Z}\E[X|Y=\sigma Z+x^*]}\\
    &=\E\Square{\pp{}{Z}\int_\R xp(x|\sigma Z+x^*)\,dx}
\end{align*}

$p(x|y)$ は Boltzmann 分布である（第 [-@sec-identification] 節）から，次のように計算を進められる：

\begin{align*}
    &\quad\E\Square{\pp{}{Z}\int_\R xp(x|\sigma Z+x^*)\,dx}\\
    &=\E\Square{\pp{}{Z}\int_\R\frac{xe^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}\,dx}\\
    &=\E\Square{\int_\R x\pp{}{Z}\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}\,dx}
\end{align*}

として計算し，結果が絶対可積分であったならば Fubini-Tonelli の定理により，最後の等号が正当化される．

また，記号の混同を避けるため，分配関数は $\cZ$ で表した．$Z\sim\gamma_1$ であった．

$$
H(x,y)=\frac{1}{2\sigma^2}(x^2-2xy)-\log p(x)
$$
$$
\therefore\quad\pp{H(x,y)}{y}=-\frac{x}{\sigma^2}
$$

より，

\begin{align*}
    &\quad\pp{}{Z}\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}\\
    &=-\pp{H(x,\sigma Z+x^*)}{Z}\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}+\pp{}{Z}\paren{\frac{1}{\cZ(\sigma Z+x^*)}}e^{-H(x,\sigma Z+x^*)}\\
    &=\frac{x}{\sigma^2}\sigma\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}-\frac{\cZ'(\sigma Z+x^*)}{\cZ(\sigma Z+x^*)}\sigma\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}
\end{align*}

さらに，$\cZ(y)=\frac{q(y)}{p(y)}$ であるが，
$$
\cZ'(y)=-\frac{1}{\sigma^2}\frac{yq(y)}{p(y)}-\frac{p'(y)q(y)}{p(y)^2}
$$

\begin{align*}
    \frac{\cZ'(Y)}{\cZ(Y)}=-\frac{Y}{\sigma^2}-\frac{p'(Y)}{p(Y)}
\end{align*}

続いて
$$
p(y)=\frac{1}{\sqrt{2\pi\sigma^2}}\int_\R e^{-\frac{(x-y)^2}{2\sigma^2}}p(x)\,dx
$$
であったから，
\begin{align*}
    p'(y)&=\frac{1}{\sqrt{2\pi\sigma^2}}\int_\R-\frac{y-x}{\sigma^2}e^{-\frac{(x-y)^2}{2\sigma^2}}p(x)\,dx\\
    &=-\int_\R\frac{y-x}{\sigma^2}p(y|x)p(x)\,dx\\
    &=-\int_\R\frac{y-x}{\sigma^2}p(x|y)p(y)\,dx\\
    &=-\frac{y-\brac{X}}{\sigma^2}p(y).
\end{align*}
$$
\therefore\quad\frac{p'(Y)}{p(Y)}=\frac{\brac{X}-Y}{\sigma^2}
$$
\begin{align*}
    \therefore\quad\frac{\cZ'(Y)}{\cZ(Y)}&=-\frac{Y}{\sigma^2}-\frac{p'(Y)}{p(Y)}=-\frac{\brac{X}}{\sigma^2}
\end{align*}

と計算できるから，

\begin{align*}
    &\quad\E\Square{\int_\R x\pp{}{Z}\frac{e^{-H(x,\sigma Z+x^*)}}{\cZ(\sigma Z+x^*)}\,dx}\\
    &=\E\Square{\int_\R x\Paren{\frac{x}{\sigma^2}\sigma p(x|Y)-\frac{\cZ'(\sigma Z+x^*)}{\cZ(\sigma Z+x^*)}\sigma p(x|Y)}dx}\\
    &=\E\Square{\int_\R\frac{x^2}{\sigma}p(x|Y)\,dx}+\E\Square{\int_\R x\sigma\frac{\brac{X}}{\sigma^2}p(x|Y)dx}\\
    &=\sqrt{\beta}\E[\brac{X^2}]+\sqrt{\beta}\E[\brac{X}^2]
\end{align*}
-->
</div>
</div>
</div>
</section>
</section>
<section id="sec-sparse-vector-denoising" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="sec-sparse-vector-denoising"><span class="header-section-number">3</span> スパースベクトルの復号</h2>
<p>スパースベクトルの信号推定問題を考える．ここまで，<img src="https://latex.codecogs.com/png.latex?x,x%5E*"> は <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D"> の点としてきたが，本節では，<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ed,d=2%5EN"> の one-hot ベクトルであるとする．</p>
<section id="sec-settings" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="sec-settings"><span class="header-section-number">3.1</span> 設定</h3>
<p>真の信号 <img src="https://latex.codecogs.com/png.latex?x%5E*%5Cin%5Cmathbb%7BR%7D%5Ed"> は，<img src="https://latex.codecogs.com/png.latex?d"> 次元の one-hot ベクトルであるとする．すなわち，次の集合 <img src="https://latex.codecogs.com/png.latex?%5CDelta_d"> の元であるとする： <img src="https://latex.codecogs.com/png.latex?%0A%5CDelta_d:=%5Cleft%5C%7Bx%5Cin%5Cmathbb%7BZ%7D%5Ed%5Cmid%5C%7Cx%5C%7C_1=1%5Cright%5C%7D.%0A"></p>
<p>加えて，<img src="https://latex.codecogs.com/png.latex?%5CDelta_d"> 上の一様分布に従うとする：<img src="https://latex.codecogs.com/png.latex?x%5E*%5Csim%5Cmathrm%7BU%7D(%5CDelta_d)">．</p>
<p>これを分散 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Csigma%5E2%7D%7BN%7D"> を持った Gauss ノイズを通じて観測する： <img src="https://latex.codecogs.com/png.latex?%0AY%5Csim%5Cmathrm%7BN%7D_d%5Cleft(x%5E*,%5Cfrac%7B%5Csigma%5E2%7D%7BN%7DI_d%5Cright).%0A"></p>
<p>事前分布を <img src="https://latex.codecogs.com/png.latex?p(x)">，<img src="https://latex.codecogs.com/png.latex?Y"> の分布を <img src="https://latex.codecogs.com/png.latex?p(y)"> とすると，Bayes の定理より， <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20p(x%7Cy)&amp;=%5Cfrac%7Bp(x)%7D%7Bp(y)%7D%5Cprod_%7Bi=1%7D%5Ed%5Cfrac%7Be%5E%7B-%5Cfrac%7B(y_i-x_i)%5E2%7D%7B2%5Csigma%5E2/N%7D%7D%7D%7B%5Csqrt%7B2%5Cpi%5Csigma%5E2/N%7D%7D%5C%5C%0A%20%20%20%20&amp;=%5Cfrac%7B%5Cprod_%7Bi=1%7D%5Ed%5Cphi(y_i;0,%5Csigma%5E2/N)%7D%7Bp(y)%7D%5C%5C%0A%20%20%20%20&amp;%5Cqquad%5Ctimes%20%5Cfrac%7B1%7D%7B2%5EN%7D%5Cprod_%7Bi=1%7D%5Ed%5Cexp%5Cleft(-%5Cfrac%7Bx_i%5E2-2x_iy_i%7D%7B2%5Csigma%5E2/N%7D%5Cright)%0A%5Cend%7Balign*%7D"></p>
<p>ただし，<img src="https://latex.codecogs.com/png.latex?%5Cphi(-;%5Cmu,%5Csigma):=%5Cfrac%7Bd%20%5Cmathrm%7BN%7D_1(%5Cmu,%5Csigma)%7D%7Bd%20%5Cell_1%7D"> を正規密度とした．</p>
</section>
<section id="スピングラス系との同一視" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="スピングラス系との同一視"><span class="header-section-number">3.2</span> スピングラス系との同一視</h3>
<p>この事後分布 <img src="https://latex.codecogs.com/png.latex?p(x%7Cy)"> は，次の Hamiltonian <img src="https://latex.codecogs.com/png.latex?H"> に関する，逆温度 <img src="https://latex.codecogs.com/png.latex?%5Cbeta=%5Csigma%5E%7B-2%7D"> での Boltzmann 分布とみなせる：</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20p(x%7Cy)&amp;=%5Cfrac%7B1%7D%7B%5Cmathcal%7BZ%7D%7De%5E%7B-%5Cbeta%20H(x,y)%7D%5C%5C%0A%20%20%20%20H(x,y)&amp;:=-N%5Csigma%5E2%5Clog2%5C%5C%0A%20%20%20%20&amp;%5Cqquad-%5Cfrac%7BN%7D%7B2%7D%5Csum_%7Bi,j=1%7D%5Edx_i%5E*x_j%5E*%5Csqrt%7B(1-2y_i)(1-2y_j)%7D%0A%5Cend%7Balign*%7D"></p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="注">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
注
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>この Hamiltonian は非物理的なものであり，planted ensemble とも呼ばれる．詳しくは次項参照：</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Stat/Bayes2.html" target="_blank">
            <img src="https://raw.githubusercontent.com/162348/162348.github.io/main/thumbnail.svg" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">ベイズ統計学とスピングラス</h3>
                <p class="article-description">誤り訂正符号を題材にして</p>
            </div>
        </a>
    </div>
</div>
<p>また，<img src="https://latex.codecogs.com/png.latex?H"> の表示については，<img src="https://latex.codecogs.com/png.latex?x%5E*%5Cin%5CDelta_d"> であるから，<img src="https://latex.codecogs.com/png.latex?i,j%5Cin%5Bd%5D"> と２つの和をとっているように見えるが，二つの添え字が一致している場合しか非零な値は取らず，結局 <img src="https://latex.codecogs.com/png.latex?%0AH(x,y)=-%5Cfrac%7BN%7D%7B2%7D%5Csum_%7Bj=1%7D%5Ed(2y_j-1)x_j+N%5Csigma%5E2%5Clog2%0A"> であることに注意．</p>
</div>
</div>
</div>
<p>なお，分配関数は <img src="https://latex.codecogs.com/png.latex?%0A%5Cmathcal%7BZ%7D:=%5Cfrac%7B1%7D%7B2%5EN%7D%5Csum_%7Bi=1%7D%5Ed%5Cexp%5Cleft(%5Cfrac%7BN%7D%7B2%5Csigma%5E2%7D(2y_i-1)%5Cright),%0A"> と表される．</p>
</section>
<section id="自由エネルギー密度の計算" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="自由エネルギー密度の計算"><span class="header-section-number">3.3</span> 自由エネルギー密度の計算</h3>
<p>系が用意されたら，統計力学はまず，代表的な物理量の熱力学極限を計算する．特に自由エネルギー密度は，熱力学極限 <img src="https://latex.codecogs.com/png.latex?N%5Cto%5Cinfty"> において自己平均性（確率論では集中性という性質）を示すことが期待される．</p>
<p>自由エネルギー密度 <img src="https://latex.codecogs.com/png.latex?%5CPhi"> は，熱力学極限を通じて <img src="https://latex.codecogs.com/png.latex?%0A%5CPhi(%5Cbeta):=%5Clim_%7BN%5Cto%5Cinfty%7D%5Cfrac%7B%5Coperatorname%7BE%7D%5B%5Clog%5Cmathcal%7BZ%7D%5D%7D%7BN%7D%0A"> と定まる．</p>
<p>I-MMSE 定理（第 2.5 節）はこの多次元の <img src="https://latex.codecogs.com/png.latex?X"> に関しても有効であり， <img src="https://latex.codecogs.com/png.latex?%0A%5CPhi_N(%5Cbeta):=%5Cfrac%7B%5Coperatorname%7BE%7D%5B%5Clog%5Cmathcal%7BZ%7D%5D%7D%7BN%7D%0A"> に関して， <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%5CPhi_N(%5Cbeta)%7D%7B%5Cpartial%20%5Cbeta%7D=%5Cfrac%7B%5Coperatorname%7BE%7D%5Cbiggl%5B%5Clvert%5Clangle%20X%5Crangle%5Crvert%5E2%5Cbiggr%5D%7D%7B2%7D%0A"> が成り立つ．</p>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>まず有限の <img src="https://latex.codecogs.com/png.latex?N%5Cin%5Cmathbb%7BN%7D%5E+"> で計算する．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%5CPhi_N(%5Cbeta)%7D%7B%5Cpartial%20%5Cbeta%7D=%5Cfrac%7B1%7D%7BN%7D%5Coperatorname%7BE%7D%5Cleft%5B%5Cfrac%7B1%7D%7B%5Cmathcal%7BZ%7D%7D%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BZ%7D%7D%7B%5Cpartial%20%5Cbeta%7D%5Cright%5D%0A"> の右辺を求めれば良い．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AY_i=X_i%5E*+%5Cfrac%7B%5Csigma%7D%7B%5Csqrt%7BN%7D%7DZ_i%0A"> であり，one-hot ベクトル <img src="https://latex.codecogs.com/png.latex?x%5Cin%5CDelta_d"> については <img src="https://latex.codecogs.com/png.latex?%0Ax_j=x_j%5E2,%5Cquad%5Clvert%20x%5Crvert%5E2=1%0A"> でもあることに注意すれば，</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Cmathcal%7BZ%7D&amp;=%5Csum_%7Bi=1%7D%5Ede%5E%7B-H(x%5E%7B(i)%7D,Y)%7D%5C%5C%0A%20%20%20%20&amp;=%5Cfrac%7B1%7D%7B2%5EN%7D%5Csum_%7Bi=1%7D%5Ed%5Cexp%5Cleft(-%5Cfrac%7BN%5Cbeta%7D%7B2%7D%5Clvert%20x%5E%7B(i)%7D%5Crvert%5E2+N%5Cbeta(Y%7Cx%5E%7B(i)%7D)%5Cright)%5C%5C%0A%20%20%20%20&amp;=%5Cfrac%7B1%7D%7B2%5EN%7D%5Csum_%7Bi=1%7D%5Ed%5Cexp%5Cleft(-%5Cfrac%7BN%5Cbeta%7D%7B2%7D%5Clvert%20x%5E%7B(i)%7D%5Crvert%5E2+N(X%5E*%7Cx%5E%7B(i)%7D)%5Cbeta+(Z%7Cx%5E%7B(i)%7D)%5Csqrt%7BN%5Cbeta%7D%5Cright)%0A%5Cend%7Balign*%7D"> <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BZ%7D%7D%7B%5Cpartial%20%5Cbeta%7D=%5Csum_%7Bi%7D%5Ed%5Cbiggr(-%5Cfrac%7BN%7D%7B2%7D%5Clvert%20x%5E%7B(i)%7D%5Crvert%5E2+N(X%5E*%7Cx%5E%7B(i)%7D)+%5Cfrac%7B%5Csqrt%7BN%7D%7D%7B2%5Csqrt%7B%5Cbeta%7D%7D(Z%7Cx%5E%7B(i)%7D)%5Cbiggl)e%5E%7B-H(x%5E%7B(i)%7D,Y)%7D%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B1%7D%7B%5Cmathcal%7BZ%7D%7D%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BZ%7D%7D%7B%5Cpartial%20%5Cbeta%7D=-%5Cfrac%7BN%7D%7B2%7D%5Cleft%5Clangle%5Clvert%20X%5Crvert%5E2%5Cright%5Crangle+N%5Cbiggl%5Clangle(X%5E*%7CX)%5Cbiggr%5Crangle+%5Cfrac%7B%5Csqrt%7BN%7D%7D%7B2%5Csqrt%7B%5Cbeta%7D%7D%5Cbiggl%5Clangle(Z%7CX)%5Cbiggr%5Crangle%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B1%7D%7BN%7D%5Coperatorname%7BE%7D%5Cleft%5B%5Cfrac%7B1%7D%7B%5Cmathcal%7BZ%7D%7D%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BZ%7D%7D%7B%5Cpartial%20%5Cbeta%7D%5Cright%5D=%5Coperatorname%7BE%7D%5Cleft%5B%5Cleft%5Clangle-%5Cfrac%7B%5Clangle%5Clvert%20X%5Crvert%5E2%5Crangle%7D%7B2%7D+%5Cbiggl%5Clangle(X%5E*%7CX)%5Cbiggr%5Crangle+%5Cfrac%7B%5Cbiggl%5Clangle(Z%7CX)%5Cbiggr%5Crangle%7D%7B2%5Csqrt%7BN%5Cbeta%7D%7D%5Cright%5Crangle%5Cright%5D%0A"> これは１次元の場合の計算（第 2.5 節）と同様に， <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%5CPhi_N(%5Cbeta)%7D%7B%5Cpartial%20%5Cbeta%7D=%5Cfrac%7B%5Coperatorname%7BE%7D%5B%5Clvert%5Clangle%20X%5Crangle%5Crvert%5E2%5D%7D%7B2%7D%0A"> と計算できる．</p>
</div>
</div>
</div>
<p>よって，<img src="https://latex.codecogs.com/png.latex?N%5Cto%5Cinfty"> の極限でも右辺が定数に収束し（右辺は <img src="https://latex.codecogs.com/png.latex?2%5EN"> 項和を含む），この種の関係式が成り立ち続けるならば，<img src="https://latex.codecogs.com/png.latex?%5CPhi"> は <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> の一次関数の形であるはずである．実際，次が示せる：</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題^[[@Krzakala-Zdeborova2024 p.125] 定理15，[@樺島-杉浦2008 p.14] なども参照．証明は [@Krzakala-Zdeborova2024 p.133] 7.B 節 を参考にした．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題<sup>8</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5CDelta:=%5Csigma%5E2"> の関数として，自由エネルギー密度 <img src="https://latex.codecogs.com/png.latex?%5CPhi"> は次で定まる関数 <img src="https://latex.codecogs.com/png.latex?f:%5Cmathbb%7BR%7D%5E+%5Cto%5Cmathbb%7BR%7D_+"> に一致する： <img src="https://latex.codecogs.com/png.latex?%0Af(%5CDelta):=%0A%5Cbegin%7Bcases%7D%0A%5Cfrac%7B1%7D%7B2%5CDelta%7D-%5Clog%202&amp;%5CDelta%5Cle%5CDelta_c,%5C%5C%0A0&amp;%5CDelta%5Cge%5CDelta_c.%0A%5Cend%7Bcases%7D%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5CDelta_c:=%5Cfrac%7B1%7D%7B2%5Clog%202%7D%0A"></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>次節 3.4 では <img src="https://latex.codecogs.com/png.latex?%5CPhi_N"> を <img src="https://latex.codecogs.com/png.latex?f"> によって上下から評価することで，数学的に厳密な証明を与える．ここでは，本ベイズモデルをランダムエネルギーモデルとみなし，レプリカ法によって計算した場合の証明の概略を付す．</p>
<p><img src="https://latex.codecogs.com/png.latex?n"> 個のレプリカを複製した際の，それぞれの配置 <img src="https://latex.codecogs.com/png.latex?(i_1,%5Ccdots,i_n)%5Cin%5Bd%5D%5En"> について足し合わせることで，<img src="https://latex.codecogs.com/png.latex?Z%5En"> の disorder average を取る．</p>
<p>最終的に次の表示を得る： <img src="https://latex.codecogs.com/png.latex?%0Ae%5E%7BnN%5Cleft(%5Clog%202+%5Cfrac%7B%5Cbeta%7D%7B2%7D%5Cright)%7D%5Capprox%5Cint%20dQdM%5C,e%5E%7BNs(Q,M)+N%5Cbeta%5Cleft(%5Csum_%7Ba=1%7D%5EnM_a+%5Cfrac%7B1%7D%7B2%7D%5Csum_%7Ba,b=1%7D%5EnQ_%7Ba,b%7D%5Cright)%7D%0A"> <span id="eq-Laplace"><img src="https://latex.codecogs.com/png.latex?%0A=:%5Cint%20dQdM%5C,e%5E%7BNg(%5CDelta,Q,M)%7D.%0A%5Ctag%7B3%7D"></span> ただし，<img src="https://latex.codecogs.com/png.latex?M_a:=%5Cdelta_%7Bi_a,1%7D%5Cin2"> は磁化のベクトル，<img src="https://latex.codecogs.com/png.latex?Q_%7Bab%7D:=%5Cdelta_%7Bi_a,i_b%7D"> は overlap matrix と呼ばれる．</p>
<p>積分はこの <img src="https://latex.codecogs.com/png.latex?M_a,Q_%7Bab%7D"> の全体について実行され，同じ <img src="https://latex.codecogs.com/png.latex?M_a,Q_%7Bab%7D"> の値を取る配置の数を <img src="https://latex.codecogs.com/png.latex?%0A%5C#(Q,M)=:e%5E%7BNs(Q,M)%7D%0A"> と表した．</p>
<p><img src="https://latex.codecogs.com/png.latex?N%5Cto%5Cinfty"> の極限では，式 (3) に対して Laplace 近似を実行すれば良い．</p>
<p>従って，<img src="https://latex.codecogs.com/png.latex?Q,M"> の構造のうち，特に支配的なものの特定に成功すれば，解が求まることになる．</p>
<p>最初の仮定として，レプリカ <img src="https://latex.codecogs.com/png.latex?i_1,%5Ccdots,i_d"> は交換可能で見分けがつかないはずだろう，という replica symmetric ansatz が考えられる．</p>
<p>このレプリカ対称性を仮定すると，次の３通りまでシナリオが絞られる：</p>
<ol type="1">
<li><p>任意のレプリカは同一の状態にある：<img src="https://latex.codecogs.com/png.latex?i_a%5Cequiv%20i%5Cin%5Bd%5D">．だが，正しいレプリカではない <img src="https://latex.codecogs.com/png.latex?i%5Cne1">．</p>
<p>このとき，<img src="https://latex.codecogs.com/png.latex?Q_%7Bab%7D%5Cequiv%201,M_a%5Cequiv0"> となり，<img src="https://latex.codecogs.com/png.latex?s(Q,M)=%5Clog2">，かつ <img src="https://latex.codecogs.com/png.latex?g(%5Cbeta,Q)=%5Clog2+n%5E2/%5CDelta">．</p>
<p>これは <img src="https://latex.codecogs.com/png.latex?N%5Cto%5Cinfty"> の極限で <img src="https://latex.codecogs.com/png.latex?n"> に関して線型ではなく，物理的な解が得られるとは思えず，レプリカ法も解析接続に失敗する．</p></li>
<li><p>任意のレプリカは全て正しい状態にある：<img src="https://latex.codecogs.com/png.latex?i_a%5Cequiv1">．</p>
<p><img src="https://latex.codecogs.com/png.latex?Q_%7Bab%7D=M_a%5Cequiv1"> となり，<img src="https://latex.codecogs.com/png.latex?s(Q,M)=0,g(%5Cbeta,Q)=n/%5CDelta+n%5E2/2%5CDelta">．</p></li>
<li><p>レプリカ内に少なくとも２つの違う状態がある：</p>
<p>このとき，<img src="https://latex.codecogs.com/png.latex?g(%5Cbeta,Q)=n/2%5CDelta+n%5Clog2">．</p></li>
</ol>
<p>２と３の場合から，次の２つが解の候補として回収できた： <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BE%7D%5BZ%5En%5D=e%5E%7B-nN%5Cleft(%5Clog%202-%5Cfrac%7B%5Cbeta%7D%7B2%7D%5Cright)%7D,%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BE%7D%5BZ%5En%5D=0.%0A"></p>
<p>この２つは，次節 3.4 から導かれる厳密な結果に一致する．</p>
<p>最後，自由エネルギーの <img src="https://latex.codecogs.com/png.latex?%5CDelta"> に関する凸性と解析性から，結論を得る．</p>
</div>
</div>
</div>
</section>
<section id="sec-bounds-on-Phi" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="sec-bounds-on-Phi"><span class="header-section-number">3.4</span> 自由エネルギーの上下評価</h3>
<p>レプリカ法を回避し，数学的に厳密な証明を与えるには，次のように上下から評価することになる．</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="補題（下界）^[[@Krzakala-Zdeborova2024 p.125]補題８．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
補題（下界）<sup>9</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%0A%5CPhi_N(%5CDelta)%5Cge%20f(%5CDelta)%0A"></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>一般に下からの評価は，<img src="https://latex.codecogs.com/png.latex?Z_i"> に関する項をまとめて無視して良いために，簡単である．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AY_i=X_i%5E*+%5Cfrac%7B%5Csigma%7D%7B%5Csqrt%7BN%7D%7DZ_i,%0A"> <img src="https://latex.codecogs.com/png.latex?%0AZ_i%5Coverset%7B%5Ctext%7Biid%7D%7D%7B%5Csim%7D%5Cmathrm%7BN%7D_1(0,1),%0A"></p>
<p>であることから，<img src="https://latex.codecogs.com/png.latex?i%5E*"> を <img src="https://latex.codecogs.com/png.latex?X%5E*_%7Bi%5E*%7D=1"> を満たす添字 <img src="https://latex.codecogs.com/png.latex?i%5E*%5Cin%5Bd%5D"> とすると，</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Cmathcal%7BZ%7D&amp;=%5Cfrac%7B1%7D%7B2%5EN%7D%5Csum_%7Bi=1%7D%5Ed%5Cexp%5Cleft(%5Cfrac%7BNY_i%7D%7B%5Csigma%5E2%7D-%5Cfrac%7BN%7D%7B2%5Csigma%5E2%7D%5Cright)%5C%5C%0A%20%20%20%20&amp;=%5Cfrac%7B1%7D%7B2%5EN%7D%5Csum_%7Bi=1%7D%5Ed%5Cexp%5Cleft(%5Cfrac%7BNX%5E*_i%7D%7B%5Csigma%5E2%7D+%5Cfrac%7B%5Csqrt%7BN%7D%7D%7B%5Csigma%7DZ_i-%5Cfrac%7BN%7D%7B2%5Csigma%5E2%7D%5Cright)%5C%5C%0A%20%20%20%20&amp;%5Cge%5Cfrac%7B1%7D%7B2%5EN%7D%5Cexp%5Cleft(%5Cfrac%7BN%7D%7B%5Csigma%5E2%7D+%5Cfrac%7B%5Csqrt%7BN%7D%7D%7B%5Csigma%7DZ_%7Bi%5E*%7D-%5Cfrac%7BN%7D%7B2%5Csigma%5E2%7D%5Cright)%5C%5C%0A%20%20%20%20&amp;=%5Cfrac%7B1%7D%7B2%5EN%7D%5Cexp%5Cleft(%5Cfrac%7BN%7D%7B2%5Csigma%5E2%7D+%5Cfrac%7B%5Csqrt%7BN%7D%7D%7B%5Csigma%7DZ_%7Bi%5E*%7D%5Cright)%0A%5Cend%7Balign*%7D"></p>
<p>と評価できる．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Clog%5Cmathcal%7BZ%7D%5Cge%5Cfrac%7BN%7D%7B2%5Csigma%5E2%7D+%5Cfrac%7B%5Csqrt%7BN%7D%7D%7B%5Csigma%7DZ_%7Bi%5E*%7D-N%5Clog%202.%0A"> <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5CPhi_N(%5CDelta)&amp;=%5Cfrac%7B%5Coperatorname%7BE%7D%5B%5Clog%5Cmathcal%7BZ%7D%5D%7D%7BN%7D%5C%5C%0A%20%20%20%20&amp;%5Cge%5Cfrac%7B1%7D%7BN%7D%5Cleft(%5Cfrac%7BN%7D%7B2%5Csigma%5E2%7D-N%5Clog%202%5Cright)%5C%5C%0A%20%20%20%20&amp;=%5Cfrac%7B1%7D%7B2%5CDelta%7D-%5Clog2.%0A%5Cend%7Balign*%7D"></p>
<p>これより，低温領域に於ては， <img src="https://latex.codecogs.com/png.latex?%0A%5CPhi_N%5Cge%20f%5C;%5Cmathrm%7Bon%7D%5C;(0,%5CDelta_c)%0A"> が確認できた．</p>
<p>続いて， <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5CPhi_N(%5CDelta)%7D%7B%5Cpartial%20%5CDelta%7D&amp;=%5Cfrac%7B%5Cpartial%20%5CPhi_N(%5CDelta)%7D%7B%5Cpartial%20%5Cbeta%7D%5Cfrac%7Bd%20%5Cbeta%7D%7Bd%20%5CDelta%7D%5C%5C%0A%20%20%20%20&amp;=%5Cfrac%7B%5Coperatorname%7BE%7D%5B%5Clvert%5Clangle%20X%5Crangle%5Crvert%5E2%5D%7D%7B2%7D%5Cleft(-%5Cfrac%7B1%7D%7B%5CDelta%5E2%7D%5Cright)%5Cle0%0A%5Cend%7Balign*%7D"> であることと， <img src="https://latex.codecogs.com/png.latex?%0A%5Clim_%7B%5CDelta%5Cto%5Cinfty%7D%5CPhi_N(%5CDelta)=0%0A"> であることから，<img src="https://latex.codecogs.com/png.latex?%5B%5CDelta_c,%5Cinfty)"> 上においても非負であることがわかる．</p>
<p>以上より， <img src="https://latex.codecogs.com/png.latex?%0A%5CPhi_N%5Cge%20f%5C;%5Cmathrm%7Bon%7D%5C;%5Cmathbb%7BR%7D_+.%0A"></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="補題（上界）^[[@Krzakala-Zdeborova2024 p.126]補題９．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
補題（上界）<sup>10</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%0A%5CPhi_N(%5CDelta)%5Cle%20f(%5CDelta)+o(1)%5Cquad(N%5Cto%5Cinfty)%0A"></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5CPhi_N"> の上界は，Boltzmann 分布 <img src="https://latex.codecogs.com/png.latex?p(x%7Cy)"> に関する期待値に対して，Jensen の不等式を用いることで導かれる．このような不等式は annealed bound とも呼ばれる．</p>
<p>真値 <img src="https://latex.codecogs.com/png.latex?x%5E*"> とノイズ <img src="https://latex.codecogs.com/png.latex?z"> が確定している（従って，<img src="https://latex.codecogs.com/png.latex?x%5E*_%7Bi%5E*%7D=1"> を満たす <img src="https://latex.codecogs.com/png.latex?i%5E*%5Cin%5Bd%5D"> も確定している）とすると， <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Cmathcal%7BZ%7D&amp;=%5Cfrac%7B1%7D%7B2%5EN%7D%5Csum_%7Bi=1%7D%5Ed%5Cexp%5Cleft(-%5Cfrac%7BN%5Cbeta%7D%7B2%7D+Nx_i%5E*%5Cbeta+z_i%5Csqrt%7BN%5Cbeta%7D%5Cright)%5C%5C%0A%20%20%20%20&amp;=%5Cfrac%7B1%7D%7B2%5EN%7D%5Cleft(%5Cexp%5Cleft(%5Cfrac%7BN%5Cbeta%7D%7B2%7D+z_%7Bi%5E*%7D%5Csqrt%7BN%5Cbeta%7D%5Cright)+%5Csum_%7Bi%5Cne%20i%5E*%7D%5Cexp%5Cleft(-%5Cfrac%7BN%5Cbeta%7D%7B2%7D+z_i%5Csqrt%7BN%5Cbeta%7D%5Cright)%5Cright)%0A%5Cend%7Balign*%7D"> <img src="https://latex.codecogs.com/png.latex?%0A%5Clog%5Cmathcal%7BZ%7D=%5Clog%5Cleft(%5Cexp%5Cleft(%5Cfrac%7BN%5Cbeta%7D%7B2%7D+z_%7Bi%5E*%7D%5Csqrt%7BN%5Cbeta%7D-N%5Clog%202%5Cright)+%5Csum_%7Bi%5Cne%20i%5E*%7D%5Cfrac%7B1%7D%7B2%5EN%7D%5Cexp%5Cleft(-%5Cfrac%7BN%5Cbeta%7D%7B2%7D*Z_i%5Csqrt%7BN%5Cbeta%7D%5Cright)%5Cright)%0A"> と計算できる．凹関数 <img src="https://latex.codecogs.com/png.latex?%5Clog"> に対する Jensen の不等式より， <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Coperatorname%7BE%7D%5B%5Clog%5Cmathcal%7BZ%7D%5D&amp;%5Cle%5Coperatorname%7BE%7D%5Cbiggl%5B%5Clog%5Cbiggr(%5Cexp%5Cbiggr(%5Cfrac%7BN%5Cbeta%7D%7B2%7D+Z_%7Bi%5E*%7D%5Csqrt%7BN%5Cbeta%7D-N%5Clog%202%5Cbiggl)%5C%5C%0A%20%20%20%20&amp;%5Cqquad%5Cquad%5Cqquad+%5Csum_%7Bi%5Cne%20i%5E*%7D%5Coperatorname%7BE%7D_%7BZ_%7B-i%5E*%7D%7D%5Cbiggl%5B%5Cfrac%7B1%7D%7B2%5EN%7D%5Cexp%5Cbiggr(-%5Cfrac%7BN%5Cbeta%7D%7B2%7D+Z_i%5Csqrt%7BN%5Cbeta%7D%5Cbiggl)%5Cbiggr%5D%5Cbiggl)%5Cbiggr%5D%5C%5C%0A%20%20%20%20&amp;=%5Coperatorname%7BE%7D%5Cleft%5B%5Clog%5Cleft(%5Cexp%5Cleft(%5Cfrac%7BN%5Cbeta%7D%7B2%7D+Z_%7Bi%5E*%7D%5Csqrt%7BN%5Cbeta%7D-N%5Clog%202%5Cright)+%5Cfrac%7B2%5E%7BN-1%7D%7D%7B2%5EN%7D%5Cright)%5Cright%5D%5C%5C%0A%20%20%20%20&amp;%5Cle%5Coperatorname%7BE%7D%5Cleft%5B%5Clog%5Cleft(%5Cexp%5Cleft(%5Cfrac%7BN%5Cbeta%7D%7B2%7D+Z_%7Bi%5E*%7D%5Csqrt%7BN%5Cbeta%7D-N%5Clog%202%5Cright)+1%5Cright)%5Cright%5D%5C%5C%0A%20%20%20%20&amp;=%5Coperatorname%7BE%7D%5Cleft%5B%5Clog%5Cbiggr(e%5E%7BN%5Cleft(%5Cfrac%7B%5Cbeta%7D%7B2%7D-%5Clog%202%5Cright)%7De%5E%7BZ_%7Bi%5E*%7D%5Csqrt%7BN%5Cbeta%7D%7D+1%5Cbiggl)%5Cright%5D.%0A%5Cend%7Balign*%7D"></p>
<p>最初の等号にて，<img src="https://latex.codecogs.com/png.latex?%5Cxi%5Csim%5Cmathrm%7BN%7D(%5Cmu,%5Csigma%5E2)"> の積率母関数が <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BE%7D%5Be%5E%7Bt%5Cxi%7D%5D=%5Cexp%5Cleft(%5Cmu%20t+%5Cfrac%7B%5Csigma%5E2t%5E2%7D%7B2%7D%5Cright)%0A"> で表せることを用いた．</p>
<p>この <img src="https://latex.codecogs.com/png.latex?Z_%7Bi%5E*%7D"> という確率変数は複雑に定まっており，これを直接議論することは後回しにする．</p>
<p>本補題の主張は，純粋に関数 <img src="https://latex.codecogs.com/png.latex?%0Ag(z):=%5Cexp%5Cleft(N%5Cleft(%5Cfrac%7B%5Cbeta%7D%7B2%7D-%5Clog%202%5Cright)+z%5Csqrt%7BN%5Cbeta%7D%5Cright)+1%0A"> の性質を考察するだけで従う．この関数 <img src="https://latex.codecogs.com/png.latex?g"> を用いると， <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5CPhi_N(%5Cbeta)&amp;=%5Cfrac%7B%5Coperatorname%7BE%7D%5B%5Clog%5Cmathcal%7BZ%7D%5D%7D%7BN%7D%5C%5C%0A%20%20%20%20&amp;%5Cle%5Cfrac%7B1%7D%7BN%7D%5Coperatorname%7BE%7D%5Cbiggl%5B%5Clog(g(Z_%7Bi%5E*%7D))%5Cbiggr%5D%0A%5Cend%7Balign*%7D"> と表せる．<img src="https://latex.codecogs.com/png.latex?g"> も <img src="https://latex.codecogs.com/png.latex?%5Clog%20g"> も凸関数であるから， <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Clog%20g(%5Clvert%20z%5Crvert)&amp;%5Cle%5Clog%20g(0)+%5Clvert%20z%5Crvert%5Cfrac%7Bd%20%7D%7Bd%20z%7D%5Clog%20g(%5Clvert%20z%5Crvert)%5C%5C%0A%20%20%20%20&amp;=%5Clog%20g(0)+%5Cfrac%7Bg'(%5Clvert%20z%5Crvert)%7D%7Bg(%5Clvert%20z%5Crvert)%7D%5C%5C%0A%20%20%20%20&amp;%5Cle%5Clog%20g(0)+%5Clvert%20z%5Crvert%5Csqrt%7BN%5Cbeta%7D%5C%5C%0A%20%20%20%20&amp;=%5Clog%5Cbiggr(e%5E%7BN%5Cleft(%5Cfrac%7B%5Cbeta%7D%7B2%7D-%5Clog%202%5Cright)%7D+1%5Cbiggl)+%5Clvert%20z%5Crvert%5Csqrt%7BN%5Cbeta%7D.%0A%5Cend%7Balign*%7D"></p>
<p>これより， <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5CPhi_N(%5Cbeta)&amp;%5Cle%5Cfrac%7B1%7D%7BN%7D%5Coperatorname%7BE%7D%5Cbiggl%5B%5Clog(g(%5Clvert%20Z_%7Bi%5E*%7D%5Crvert))%5Cbiggr%5D%5C%5C%0A%20%20%20%20&amp;%5Cle%5Cfrac%7B1%7D%7BN%7D%5Clog%5Cbiggr(e%5E%7BN%5Cleft(%5Cfrac%7B%5Cbeta%7D%7B2%7D-%5Clog%202%5Cright)%7D+1%5Cbiggl)+%5Csqrt%7B%5Cfrac%7B%5Cbeta%7D%7BN%7D%7D%5Coperatorname%7BE%7D%5B%5Clvert%20Z_%7Bi%5E*%7D%5Crvert%5D.%0A%5Cend%7Balign*%7D"></p>
<p>よって，<img src="https://latex.codecogs.com/png.latex?Z_%7Bi%5E*%7D"> が可積分であることさえ認めれば，<img src="https://latex.codecogs.com/png.latex?N%5Cto%5Cinfty"> のとき， <img src="https://latex.codecogs.com/png.latex?%0A%5CDelta%5Cge%5CDelta_c%5Cquad%5CLeftrightarrow%5Cquad%5Cfrac%7B%5Cbeta%7D%7B2%7D%5Cle%5Clog2%0A"> のとき，<img src="https://latex.codecogs.com/png.latex?%5Clog%5Cbiggr(e%5E%7BN%5Cleft(%5Cfrac%7B%5Cbeta%7D%7B2%7D-%5Clog%202%5Cright)%7D+1%5Cbiggl)%5Cge0"> であり，そうでない場合は <img src="https://latex.codecogs.com/png.latex?%0A%5Clog(1+e%5Ex)%5Cle%20x%5Cquad%20x%5Cin%5Cmathbb%7BR%7D_+%0A"> より， <img src="https://latex.codecogs.com/png.latex?%0A%5CPhi_N(%5CDelta)%5Cle%5Cfrac%7B%5Cbeta%7D%7B2%7D-%5Clog2+o(1)%5Cquad(N%5Cto%5Cinfty)%0A"> を得る．</p>
</div>
</div>
</div>
</section>
<section id="解釈" class="level3" data-number="3.5">
<h3 data-number="3.5" class="anchored" data-anchor-id="解釈"><span class="header-section-number">3.5</span> 解釈</h3>
<p><img src="https://latex.codecogs.com/png.latex?N%5Cto%5Cinfty"> の極限において，高温領域 <img src="https://latex.codecogs.com/png.latex?%5CDelta%3E%5CDelta_c"> において，最小自乗誤差（MMSE）は <img src="https://latex.codecogs.com/png.latex?1"> であり，何をどうしても復号することはできない．Gauss ノイズ <img src="https://latex.codecogs.com/png.latex?%5CDelta=%5Csigma%5E2"> が大きすぎるのである．</p>
<p>一方で，低温領域 <img src="https://latex.codecogs.com/png.latex?%5CDelta%3C%5CDelta_c"> において，<img src="https://latex.codecogs.com/png.latex?%5Cpartial_%5Cbeta%20f=%5Cfrac%7B1%7D%7B2%7D"> であり，従って MMSE は <img src="https://latex.codecogs.com/png.latex?0"> になる．よって完全な誤りのない復号が可能であるはずである．</p>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>設定（第 3.1 節）が与えられたならば，立ち所に，<img src="https://latex.codecogs.com/png.latex?%5CDelta"> が大きいほど復号が難しいことは予想がつく．しかし，ある閾値 <img src="https://latex.codecogs.com/png.latex?%5CDelta_c"> に依存して，少なくとも <img src="https://latex.codecogs.com/png.latex?N%5Cto%5Cinfty"> の極限では，</p>
<ul>
<li>２つの領域で全く異なる振る舞いをすること</li>
<li>２つの振る舞いのみに分類される（ある一定以上の確率で復号が可能である，などの中間状態がない）こと</li>
</ul>
<p>は驚きである．</p>
</div>
</div>
</div>
<p>実は，高温領域 <img src="https://latex.codecogs.com/png.latex?%5CDelta%3E%5CDelta_c"> では，自由エネルギー <img src="https://latex.codecogs.com/png.latex?F_N"> が <img src="https://latex.codecogs.com/png.latex?0"> に指数収束する．<img src="https://latex.codecogs.com/png.latex?F_N"> とは，完全な Gauss ノイズ <img src="https://latex.codecogs.com/png.latex?%0Aq(y)dy:=%5Cmathrm%7BN%7D_d%5Cbiggr(0,%5Cfrac%7B%5CDelta%7D%7BN%7DI_d%5Cbiggl)%0A"> と <img src="https://latex.codecogs.com/png.latex?p(y)"> との KL 距離距離であったから，メッセージ <img src="https://latex.codecogs.com/png.latex?x%5E*"> を完全な雑音と見分けることが加速度的に難しくなっていくのである．</p>
</section>
<section id="自由エネルギーのさらに鋭い評価" class="level3" data-number="3.6">
<h3 data-number="3.6" class="anchored" data-anchor-id="自由エネルギーのさらに鋭い評価"><span class="header-section-number">3.6</span> 自由エネルギーのさらに鋭い評価</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（KL 乖離度は指数収束する）^[[@Krzakala-Zdeborova2024 p.132]補題10．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（KL 乖離度は指数収束する）<sup>11</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p>高温領域 <img src="https://latex.codecogs.com/png.latex?%5CDelta%3E%5CDelta_c"> において，ある <img src="https://latex.codecogs.com/png.latex?C%3E0"> が存在して，任意の <img src="https://latex.codecogs.com/png.latex?N%5Cin%5Cmathbb%7BN%7D%5E+"> について次が成り立つ：</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20F_N(%5CDelta)=%5Cmathop%7B%5Cmathrm%7BKL%7D%7D%5Cbiggr(p(y)%5C,%5Cbigg%7C%5C,q(y)%5Cbiggl)%5Cle%20e%5E%7B-CN%7D%0A%5Cend%7Balign*%7D"></p>
<p>ただし，<img src="https://latex.codecogs.com/png.latex?p"> は観測信号 <img src="https://latex.codecogs.com/png.latex?Y%5Csim%5Cmathrm%7BN%7D_d%5Cleft(X%5E*,%5Cfrac%7B%5CDelta%7D%7BN%7DI_d%5Cright)"> の密度，<img src="https://latex.codecogs.com/png.latex?q"> は <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BN%7D_d%5Cleft(0,%5Cfrac%7B%5CDelta%7D%7BN%7DI_d%5Cright)"> の密度とした．</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-31-contents" aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-31" class="callout-31-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>第 3.4 節で示した <img src="https://latex.codecogs.com/png.latex?%5CPhi_N"> の上界評価では， <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5CPhi_N(%5Cbeta)&amp;=%5Cfrac%7B%5Coperatorname%7BE%7D%5B%5Clog%5Cmathcal%7BZ%7D%5D%7D%7BN%7D%5C%5C%0A%20%20%20%20&amp;%5Cle%5Cfrac%7B1%7D%7BN%7D%5Coperatorname%7BE%7D%5Cleft%5B%5Clog%5Cleft(%5Cexp%5Cleft(N%5Cleft(%5Cfrac%7B%5Cbeta%7D%7B2%7D-%5Clog%202%5Cright)+Z_i%5E*%5Csqrt%7BN%5Cbeta%7D%5Cright)+1%5Cright)%5Cright%5D%0A%5Cend%7Balign*%7D"> を得て，<img src="https://latex.codecogs.com/png.latex?Z_i%5E*"> の評価を回避したのであった．</p>
<p>これに正面から取り組むことで，高温領域 <img src="https://latex.codecogs.com/png.latex?%5CDelta%3E%5CDelta_c"> での <img src="https://latex.codecogs.com/png.latex?%5CPhi_N"> の指数収束を示すことができる．</p>
<p>高温領域 <img src="https://latex.codecogs.com/png.latex?%5CDelta%3E%5CDelta_c"> では， <img src="https://latex.codecogs.com/png.latex?%0Af:=-%5Cfrac%7B%5Cbeta%7D%7B2%7D+%5Clog2%3E0%0A"> が成り立つ．</p>
<p><img src="https://latex.codecogs.com/png.latex?Z_%7Bi%5E*%7D"> は，まず <img src="https://latex.codecogs.com/png.latex?X%5E*"> によって条件付ければ <img src="https://latex.codecogs.com/png.latex?Z_%7Bi%5E*%7D%7CX%5E*%5Csim%5Cmathrm%7BN%7D(0,1)"> であるから， <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20N%5CPhi_N(%5Cbeta)&amp;%5Cle%5Coperatorname%7BE%7D%5Cleft%5B%5Clog%5Cbiggr(e%5E%7B-fN+Z_%7Bi%5E*%7D%5Csqrt%7BN%5Cbeta%7D%7D+1%5Cbiggl)%5Cright%5D%5C%5C%0A%20%20%20%20&amp;=%5Cint_%5Cmathbb%7BR%7D%5Cfrac%7Be%5E%7B-%5Cfrac%7Bz%5E2%7D%7B2%7D%7D%7D%7B%5Csqrt%7B2%5Cpi%7D%7D%5Clog%5Cbiggr(e%5E%7B-fN+z%5Csqrt%7BN%5Cbeta%7D%7D+1%5Cbiggl)%5C,dz%5C%5C%0A%20%20%20%20&amp;=%5Cleft(%5Cint%5E%7BR%7D_%7B-%5Cinfty%7D+%5Cint_%7BR%7D%5E%5Cinfty%5Cright)%5Cfrac%7Be%5E%7B-%5Cfrac%7Bz%5E2%7D%7B2%7D%7D%7D%7B%5Csqrt%7B2%5Cpi%7D%7D%5Clog%5Cbiggr(e%5E%7B-fN+z%5Csqrt%7BN%5Cbeta%7D%7D+1%5Cbiggl)%5C,dz%0A%5Cend%7Balign*%7D"> と分解すると，まず <img src="https://latex.codecogs.com/png.latex?(-%5Cinfty,R)"> 上の積分は <img src="https://latex.codecogs.com/png.latex?N%5Cto%5Cinfty"> に関して指数収束する．</p>
<p>実際，<img src="https://latex.codecogs.com/png.latex?R%3E0"> に対して <img src="https://latex.codecogs.com/png.latex?N%5Cin%5Cmathbb%7BN%7D%5E+"> を十分大きく取ることで，ある <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%3E0"> が存在して <img src="https://latex.codecogs.com/png.latex?%0A-fN+z%5Csqrt%7BN%5Cbeta%7D%5Cle-%5Cepsilon%20fN%0A"> を満たすようにできるから，</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20&amp;%5Cquad%5Cint%5E%7BR%7D_%7B-%5Cinfty%7D%5Cfrac%7Be%5E%7B-%5Cfrac%7Bz%5E2%7D%7B2%7D%7D%7D%7B%5Csqrt%7B2%5Cpi%7D%7D%5Clog%5Cbiggr(e%5E%7B-fN+z%5Csqrt%7BN%5Cbeta%7D%7D+1%5Cbiggl)%5C,dz%5C%5C%0A%20%20%20%20&amp;%3C%5Cint_%5Cmathbb%7BR%7D%5Cfrac%7Be%5E%7B-%5Cfrac%7Bz%5E2%7D%7B2%7D%7D%7D%7B%5Csqrt%7B2%5Cpi%7D%7D%5Clog%5Cbiggr(e%5E%7B-%5Cepsilon%20fN%7D+1%5Cbiggl)%5C,dz%5C%5C%0A%20%20%20%20&amp;=%5Clog%5Cleft(1+e%5E%7B-%5Cepsilon%20fN%7D%5Cright)%5Cle%20e%5E%7B-%5Cepsilon%20fN%7D.%0A%5Cend%7Balign*%7D"> 最後の不等式は <img src="https://latex.codecogs.com/png.latex?%0A%5Clog(1+x)%5Cle%20x%5Cquad%20x%5Cin%5Cmathbb%7BR%7D%0A"> による．</p>
<p>従って，あとは <img src="https://latex.codecogs.com/png.latex?(R,%5Cinfty)"> 上の積分が指数収束することを示せば良いが，再び <img src="https://latex.codecogs.com/png.latex?%5Clog(1+x)%5Cle%20x"> に注意して <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20&amp;%5Cquad%5Cint%5E%5Cinfty_%5Cmathbb%7BR%7D%5Cfrac%7Be%5E%7B-%5Cfrac%7Bz%5E2%7D%7B2%7D%7D%7D%7B%5Csqrt%7B2%5Cpi%7D%7D%5Clog%5Cleft(e%5E%7B-fN+z%5Csqrt%7BN%5Cbeta%7D%7D+1%5Cright)%5C,dz%5C%5C%0A%20%20%20%20&amp;%5Cle%5Cint%5E%5Cinfty_%5Cmathbb%7BR%7D%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%7D%7De%5E%7B-fN+z%5Csqrt%7BN%5Cbeta%7D-%5Cfrac%7Bz%5E2%7D%7B2%7D%7D%5C,dz%5C%5C%0A%20%20%20%20&amp;=e%5E%7B%5Cfrac%7BN%5Cbeta%7D%7B2%7D-fN%7D%5Cint%5E%5Cinfty_%5Cmathbb%7BR%7D%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%7D%7De%5E%7B-%5Cfrac%7B(z-%5Csqrt%7BN%5Cbeta%7D)%5E2%7D%7B2%7D%7D%5C,dz%5C%5C%0A%20%20%20%20&amp;=e%5E%7B%5Cfrac%7BN%5Cbeta%7D%7B2%7D-fN%7D%5Coperatorname%7BP%7D%5Cbiggl%5BZ%3ER-%5Csqrt%7BN%5Cbeta%7D%5Cbiggr%5D%0A%5Cend%7Balign*%7D"> と評価できるから，あとは <img src="https://latex.codecogs.com/png.latex?Z%5Csim%5Cgamma_1"> の尾部確率が指数収束するかどうか（正確には劣 Gauss 性を持つかどうか）の問題に帰着する．</p>
<p>実はこれは yes である．中心化された確率変数の積率母関数が，ある <img src="https://latex.codecogs.com/png.latex?%5Csigma%3E0"> に関して <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BE%7D%5Be%5E%7B%5Clambda%5Cxi%7D%5D%5Cle%20e%5E%7B%5Cfrac%7B%5Clambda%5E2%5Csigma%5E2%7D%7B2%7D%7D%5Cquad%5Clambda%5Cin%5Cmathbb%7BR%7D%0A"> を満たすことは，ある <img src="https://latex.codecogs.com/png.latex?%5Ckappa%3E0"> が存在して <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BP%7D%5B%5Clvert%5Cxi%5Crvert%5Cge%20t%5D%5Cle%202e%5E%7B-%5Cfrac%7Bt%5E2%7D%7B2%5Ckappa%5E2%7D%7D%0A"> を満たすことに同値になる．特に，<img src="https://latex.codecogs.com/png.latex?%5CRightarrow"> 方向には <img src="https://latex.codecogs.com/png.latex?%5Ckappa=%5Csigma"> ととれる．<sup>12</sup> <img src="https://latex.codecogs.com/png.latex?%5CPhi_N"> の上界評価（第 3.4 節）で触れたように，（中心化された）Gauss 確率変数はこれを満たす．</p>
<p>よって， <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20&amp;%5Cquad%20e%5E%7B%5Cfrac%7BN%5Cbeta%7D%7B2%7D-fN%7D%5Coperatorname%7BP%7D%5Cbiggl%5BZ%3ER-%5Csqrt%7BN%5Cbeta%7D%5Cbiggr%5D%5C%5C%0A%20%20%20%20&amp;%5Cle%20e%5E%7B%5Cfrac%7BN%5Cbeta%7D%7B2%7D-fN%7De%5E%7B-%5Cfrac%7B(R-%5Csqrt%7BN%5Cbeta%7D)%5E2%7D%7B2%7D%7D%5C%5C%0A%20%20%20%20&amp;=e%5E%7B%5Cfrac%7BN%5Cbeta%7D%7B2%7D-fN%7De%5E%7B-%5Cfrac%7BR%5E2%7D%7B2%7D+%5Csqrt%7BN%5Cbeta%7DR-%5Cfrac%7BN%5Cbeta%7D%7B2%7D%7D%5C%5C%0A%20%20%20%20&amp;=%5Cexp%5Cleft(-%5Cfrac%7BR%5E2%7D%7B2%7D+%5Csqrt%7BN%5Cbeta%7DR-Nf%5Cright).%0A%5Cend%7Balign*%7D"></p>
<p>この最右辺，ある定数 <img src="https://latex.codecogs.com/png.latex?C%3E0"> が存在して，<img src="https://latex.codecogs.com/png.latex?e%5E%7B-CN%7D"> で抑えられる．</p>
<div class="footnote-size">
<p>あるいは，任意の <img src="https://latex.codecogs.com/png.latex?N%5Cin%5Cmathbb%7BN%7D%5E+"> に対して <img src="https://latex.codecogs.com/png.latex?%0AR:=%5Csqrt%7B%5Cfrac%7BN%7D%7B%5Cbeta%7D%7Df-%5Cdelta%5Cquad%5Cdelta%3E0%0A"> と取ることで，<img src="https://latex.codecogs.com/png.latex?(-%5Cinfty,R),(R,%5Cinfty)"> 上の積分のそれぞれについて，同様の評価を得る．</p>
</div>
<p>以上より， <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20F_N(%5CDelta)&amp;=N%5CPhi_N%5C%5C%0A%20%20%20%20&amp;%5Cle%20e%5E%7B-KN%7D.%0A%5Cend%7Balign*%7D"></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題（劣 Gauss 確率変数の特徴付け）^[[@Vershynin18-HighDimensional p.25]命題2.5.2．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題（劣 Gauss 確率変数の特徴付け）<sup>13</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?X%5Cin%20L(%5COmega)"> を確率変数とする．このとき，次の４条件は同値で，さらに <img src="https://latex.codecogs.com/png.latex?%5C%7BK_1,%5Ccdots,K_5%5C%7D%5Csubset%5Cmathbb%7BR%7D%5E+"> はある <img src="https://latex.codecogs.com/png.latex?C%5Cin%5Cmathbb%7BR%7D"> が存在して，<img src="https://latex.codecogs.com/png.latex?%5Cforall_%7Bi,j%5Cin%5B5%5D%7D%5C;K_j%5Cle%20CK_i"> を満たすように取れる．</p>
<ol type="1">
<li>尾部確率の評価：ある <img src="https://latex.codecogs.com/png.latex?K_1%3E0"> が存在して，<sup>14</sup> <img src="https://latex.codecogs.com/png.latex?%0A%5Cmathrm%7BP%7D%5B%5Clvert%20X%5Crvert%5Cge%20t%5D%5Cle%202e%5E%7B-%5Cfrac%7Bt%5E2%7D%7BK_1%5E2%7D%7D,%5Cqquad%20t%5Cge0.%0A"></li>
<li><img src="https://latex.codecogs.com/png.latex?L%5Ep">-ノルムの評価：ある <img src="https://latex.codecogs.com/png.latex?K_2%3E0"> が存在して， <img src="https://latex.codecogs.com/png.latex?%0A%5C%7CX%5C%7C_%7BL%5Ep%7D%5Cle%20K_2%5Csqrt%7Bp%7D,%5Cqquad%20p%5Cge1.%0A"></li>
<li><img src="https://latex.codecogs.com/png.latex?X%5E2"> の積率母関数の <img src="https://latex.codecogs.com/png.latex?0"> の近傍での評価：ある <img src="https://latex.codecogs.com/png.latex?K_3%3E0"> が存在して， <img src="https://latex.codecogs.com/png.latex?%0A%5Clvert%5Clambda%5Crvert%5Cle%5Cfrac%7B1%7D%7BK_3%7D%5Cquad%5CRightarrow%5Cquad%20%5Cmathrm%7BE%7D%5Be%5E%7B%5Clambda%5E2%20X%5E2%7D%5D%5Cle%20e%5E%7BK_3%5E2%5Clambda%5E2%7D.%0A"></li>
<li><img src="https://latex.codecogs.com/png.latex?X%5E2"> の積率母関数のある1点での値：ある <img src="https://latex.codecogs.com/png.latex?K_4%3E0"> が存在して， <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BE%7D%5Cleft%5Be%5E%7B%5Cfrac%7BX%5E2%7D%7BK_4%5E2%7D%7D%5Cright%5D%5Cle2.%0A"></li>
<li>さらに，<img src="https://latex.codecogs.com/png.latex?X"> が中心化されている場合，次とも同値：ある <img src="https://latex.codecogs.com/png.latex?K_5%3E0"> が存在して， <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BE%7D%5Be%5E%7B%5Clambda%20X%7D%5D%5Cle%20e%5E%7BK%5E2_5%5Clambda%5E2%7D,%5Cqquad%5Clambda%5Cin%5Cmathbb%7BR%7D.%0A"></li>
</ol>
<p>以上の同値な条件を満たす確率変数 <img src="https://latex.codecogs.com/png.latex?X"> を <strong>劣 Gauss</strong> (sub-Gaussian) という．</p>
</div>
</div>
</section>
<section id="まとめ" class="level3" data-number="3.7">
<h3 data-number="3.7" class="anchored" data-anchor-id="まとめ"><span class="header-section-number">3.7</span> まとめ</h3>
<p>大変単純化された設定 toy model であったが，比例的高次元極限 <img src="https://latex.codecogs.com/png.latex?N%5Cto%5Cinfty"> において，厳密に示せる相転移を示す模型である．</p>
<p>すなわち，ただ一つの非零成分 <img src="https://latex.codecogs.com/png.latex?1"> に対して，ノイズの分散 <img src="https://latex.codecogs.com/png.latex?%5Csigma%5E2"> が <img src="https://latex.codecogs.com/png.latex?(2%5Clog2)%5E%7B-1%7D"> より大きいかどうかで，これが復号可能かどうかが決まる．</p>
<p>この <img src="https://latex.codecogs.com/png.latex?2%5Clog2"> という値は <span class="citation" data-cites="Donoho-Johnstone1994">(Donoho &amp; Johnstone, 1994)</span> が universal threshold と呼ぶ値の例であり，ランダムエネルギーモデルのスピングラス相転移境界と対応する．<sup>15</sup></p>
<p>一般のモデルでは，この臨界温度の値は不明である上に，<img src="https://latex.codecogs.com/png.latex?%5CDelta%3E%5CDelta_c"> の高温領域での効率的な推定法が見つかっていない場合も多い．</p>
<p>このような，高次元統計推測の問題においては，統計物理学，特にスピングラス理論の知見が活発に応用されて，漸近極限における相図の解明，統計計算手法の開発が目指されている．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/Stat/scheme.jpeg" class="img-fluid figure-img"></p>
<figcaption>Schematic representation of a typical high-dimensional inference problem from <span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, p. 466)</span></figcaption>
</figure>
</div>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Stat/Bayes2.html" target="_blank">
            <img src="https://raw.githubusercontent.com/162348/162348.github.io/main/thumbnail.svg" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">ベイズ統計学とスピングラス</h3>
                <p class="article-description">誤り訂正符号を題材にして</p>
            </div>
        </a>
    </div>
</div>
</section>
</section>



<div id="quarto-appendix" class="default"><section id="終わりに" class="level2 appendix" data-number="4"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">4</span> 終わりに</h2><div class="quarto-appendix-contents">

<p>第 3 節において，統計力学の知見は，レプリカ法などの計算手法を通じて，<img src="https://latex.codecogs.com/png.latex?N%5Cto%5Cinfty"> における漸近極限として，「大規模な確率分布から平均値を計算するための”ツールボックス”」<span class="citation" data-cites="樺島祥介2003">(樺島祥介, 2003)</span> として働いている．</p>
<blockquote class="blockquote">
<p>大自由度系では，次元に関して計算量が指数約に爆発してしまう．平衡統計力学の歴史はこの問題との戦いの歴史である，と言っても過言ではない．<span class="citation" data-cites="樺島-杉浦2008">(樺島祥介 &amp; 杉浦正康, 2008, p. 22)</span></p>
</blockquote>



</div></section><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-Derrida1980" class="csl-entry">
Derrida, B. (1980). Random-energy model: Limit of a family of disordered models. <em>Phys. Rev. Lett.</em>, <em>45</em>, 79–82. <a href="https://doi.org/10.1103/PhysRevLett.45.79">https://doi.org/10.1103/PhysRevLett.45.79</a>
</div>
<div id="ref-Donoho-Johnstone1994" class="csl-entry">
Donoho, D. L., &amp; Johnstone, I. M. (1994). Ideal spatial adaptation by wavelet shrinkage. <em>Biometrika</em>, <em>81</em>(3), 425–455. <a href="http://www.jstor.org/stable/2337118">http://www.jstor.org/stable/2337118</a>
</div>
<div id="ref-Guo+2005" class="csl-entry">
Guo, D., Shamai, S., &amp; Verdu, S. (2005). Mutual information and minimum mean-square error in gaussian channels. <em>IEEE Transactions on Information Theory</em>, <em>51</em>(4), 1261–1282. <a href="https://doi.org/10.1109/TIT.2005.844072">https://doi.org/10.1109/TIT.2005.844072</a>
</div>
<div id="ref-Iba1999" class="csl-entry">
Iba, Y. (1999). <span class="nocase">The Nishimori line and Bayesian statistics</span>. <em>Journal of Physics A: Mathematical and General</em>, <em>32</em>(21), 3875. <a href="https://doi.org/10.1088/0305-4470/32/21/302">https://doi.org/10.1088/0305-4470/32/21/302</a>
</div>
<div id="ref-Jaynes1957" class="csl-entry">
Jaynes, E. T. (1957). Information theory and statistical mechanics. <em>Phys. Rev.</em>, <em>106</em>, 620–630. <a href="https://doi.org/10.1103/PhysRev.106.620">https://doi.org/10.1103/PhysRev.106.620</a>
</div>
<div id="ref-Krzakala-Zdeborova2024" class="csl-entry">
Krazakala, F., &amp; Zdeborová, L. (2024). <em>Statistical physics methods in optimization and machine learning</em>. <a href="https://sphinxteam.github.io/EPFLDoctoralLecture2021/Notes.pdf">https://sphinxteam.github.io/EPFLDoctoralLecture2021/Notes.pdf</a>
</div>
<div id="ref-Krzakala+2015" class="csl-entry">
Krzakala, F., Zdeborova, L., Angelini, M. C., &amp; Caltagirone, F. (2015). <em>Statistical physics of inference and bayesian estimation</em>. <a href="https://indico.ictp.it/event/a14244/material/10/0.pdf">https://indico.ictp.it/event/a14244/material/10/0.pdf</a>
</div>
<div id="ref-Mezard-Montanari2009" class="csl-entry">
Mézard, M., &amp; Montanari, A. (2009). <em>Information, physics, and computation</em>. Oxford University Press. <a href="https://doi.org/10.1093/acprof:oso/9780198570837.001.0001">https://doi.org/10.1093/acprof:oso/9780198570837.001.0001</a>
</div>
<div id="ref-西森1980" class="csl-entry">
Nishimori, H. (1980). Exact results and critical properties of the ising model with competing interactions. <em>Journal of Physics C: Solid State Physics</em>, <em>13</em>(21), 4071. <a href="https://doi.org/10.1088/0022-3719/13/21/012">https://doi.org/10.1088/0022-3719/13/21/012</a>
</div>
<div id="ref-Shalev-Shwartz-Ben-David2014" class="csl-entry">
Shalev-Shwartz, S., &amp; Ben-David, S. (2014). <em>Understanding machine learning: From theory to algorithms</em>. Cambridge University Press. <a href="https://doi.org/10.1017/CBO9781107298019">https://doi.org/10.1017/CBO9781107298019</a>
</div>
<div id="ref-Stein1972" class="csl-entry">
Stein, C. (1972). <em><span class="nocase">A Bound for the Error in the Normal Approximation to the Distribution of a Sum of Dependent Random Variables</span></em>. Stanford University. <a href="https://purl.stanford.edu/jc818sv7483">https://purl.stanford.edu/jc818sv7483</a>
</div>
<div id="ref-Storopoli2021" class="csl-entry">
Storopoli, J. (2021). <em>Bayesian statistics with julia and turing</em>. <a href="https://storopoli.io/Bayesian-Julia">https://storopoli.io/Bayesian-Julia</a>
</div>
<div id="ref-Vershynin18-HighDimensional" class="csl-entry">
Vershynin, R. (2018). <em>High-dimensional probability</em> (Vol. 47). Cambridge University Press.
</div>
<div id="ref-Zdeborova-Krzakala2016" class="csl-entry">
Zdeborová, L., &amp; Krzakala, F. (2016). Statistical physics of inference: Thresholds and algorithms. <em>Advances in Physics</em>, <em>65</em>(5), 453–552. <a href="https://doi.org/10.1080/00018732.2016.1211393">https://doi.org/10.1080/00018732.2016.1211393</a>
</div>
<div id="ref-樺島祥介2003" class="csl-entry">
樺島祥介. (2003). コトの物理学：誤り訂正符号を例として. <em>日本物理学会誌</em>, <em>58</em>(4), 239–246. <a href="https://doi.org/10.11316/butsuri1946.58.239">https://doi.org/10.11316/butsuri1946.58.239</a>
</div>
<div id="ref-樺島-杉浦2008" class="csl-entry">
樺島祥介, &amp; 杉浦正康. (2008). コトの物理学. <em>物性研究</em>, <em>91</em>(1), 1–33. <a href="http://hdl.handle.net/2433/142666">http://hdl.handle.net/2433/142666</a>
</div>
<div id="ref-西森秀稔2005" class="csl-entry">
西森秀稔. (2005). <em>相転移・臨界現象の統計物理学</em> (Vol. 35). 培風館. <a href="https://www.kyoritsu-pub.co.jp/book/b10003637.html">https://www.kyoritsu-pub.co.jp/book/b10003637.html</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, p. 467)</span> も参照．↩︎</p></li>
<li id="fn2"><p><span class="citation" data-cites="Shalev-Shwartz-Ben-David2014">(Shalev-Shwartz &amp; Ben-David, 2014, p. 25)</span> や <span class="citation" data-cites="Krzakala-Zdeborova2024">(Krazakala &amp; Zdeborová, 2024, p. 119)</span> に倣った．↩︎</p></li>
<li id="fn3"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(Krazakala &amp; Zdeborová, 2024, p. 122)</span>．↩︎</p></li>
<li id="fn4"><p><span class="citation" data-cites="Zdeborova-Krzakala2016">(Zdeborová &amp; Krzakala, 2016, p. 464)</span>，<span class="citation" data-cites="Krzakala-Zdeborova2024">(Krazakala &amp; Zdeborová, 2024, p. 123)</span> 定理13，<span class="citation" data-cites="Iba1999">(Iba, 1999, pp. 3876–3877)</span> などで扱われている．西森ライン上のみで見られる性質であるため，西森対称性と呼ぶ．西森ラインについては <a href="../../../posts/2024/Stat/Bayes2.html#sec-Nishimori-line">次項</a> も参照．↩︎</p></li>
<li id="fn5"><p><span class="citation" data-cites="Mezard-Montanari2009">(Mézard &amp; Montanari, 2009, p. 249)</span> や <span class="citation" data-cites="Iba1999">(Iba, 1999, p. 3876)</span> などでは thermal average と quenched average の用語が採用されている．↩︎</p></li>
<li id="fn6"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(Krazakala &amp; Zdeborová, 2024, p. 124)</span> 定理14．↩︎</p></li>
<li id="fn7"><p><span class="citation" data-cites="西森秀稔2005">(西森秀稔, 2005, p. 123)</span>なども参照．↩︎</p></li>
<li id="fn8"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(Krazakala &amp; Zdeborová, 2024, p. 125)</span> 定理15，<span class="citation" data-cites="樺島-杉浦2008">(樺島祥介 &amp; 杉浦正康, 2008, p. 14)</span> なども参照．証明は <span class="citation" data-cites="Krzakala-Zdeborova2024">(Krazakala &amp; Zdeborová, 2024, p. 133)</span> 7.B 節 を参考にした．↩︎</p></li>
<li id="fn9"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(Krazakala &amp; Zdeborová, 2024, p. 125)</span>補題８．↩︎</p></li>
<li id="fn10"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(Krazakala &amp; Zdeborová, 2024, p. 126)</span>補題９．↩︎</p></li>
<li id="fn11"><p><span class="citation" data-cites="Krzakala-Zdeborova2024">(Krazakala &amp; Zdeborová, 2024, p. 132)</span>補題10．↩︎</p></li>
<li id="fn12"><p><span class="citation" data-cites="Vershynin18-HighDimensional">(Vershynin, 2018, p. 25)</span>命題2.5.2など．↩︎</p></li>
<li id="fn13"><p><span class="citation" data-cites="Vershynin18-HighDimensional">(Vershynin, 2018, p. 25)</span>命題2.5.2．↩︎</p></li>
<li id="fn14"><p>この定数2は，1よりも真に大きい定数ならばなんでも良い．<span class="citation" data-cites="Vershynin18-HighDimensional">(Vershynin, 2018, p. 27)</span>注2.5.3 も参照．↩︎</p></li>
<li id="fn15"><p><span class="citation" data-cites="Krzakala+2015">(Krzakala et al., 2015, p. 8)</span> また p.16 も参照すべし．↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Bayesian</category>
  <category>Nature</category>
  <category>Information</category>
  <guid>https://162348.github.io/posts/2024/Stat/Bayes1.html</guid>
  <pubDate>Wed, 19 Jun 2024 15:00:00 GMT</pubDate>
  <media:content url="https://162348.github.io/posts/2024/Stat/posterior.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>R による記号微分入門</title>
  <dc:creator>司馬博文 </dc:creator>
  <link>https://162348.github.io/posts/2024/Computation/calculus.html</link>
  <description><![CDATA[ 





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<div class="callout callout-style-simple callout-tip callout-titled" title="calculus リンク集">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
calculus リンク集
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="https://cran.r-project.org/web/packages/calculus/index.html">CRAN パッケージページ</a></li>
<li><a href="https://github.com/eguidotti/calculus">GitHub</a></li>
<li><a href="https://www.r-package.org/">r-package.org</a></li>
<li>論文 <span class="citation" data-cites="Guidotti2022">(Guidotti, 2022)</span></li>
</ul>
</div>
</div>
<section id="概要" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="概要">概要</h2>
<p>R パッケージ<code>calculus</code>は，記号微分と数値微分・積分をシームレスに繋いだ機能を提供するパッケージである．</p>
<p>数値微積分は<code>Rcpp</code>パッケージと<code>cubature</code>パッケージを通じて<code>C++</code>バックエンドを用いて提供する．記号微分は外部の記号計算ソフトウェアに依らない実装を提供している．</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"calculus"</span>)</span></code></pre></div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="例">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
例
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Einstein の縮約記法</li>
<li>Levi-Civita 記号の計算</li>
<li>一般化 Kronecker デルタ</li>
<li>Taylor 展開</li>
<li>高階導関数</li>
<li>多変数 Hermite 多項式</li>
<li>常微分方程式</li>
<li>微分作用素</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="関連パッケージとの違い">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
関連パッケージとの違い
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><a href="https://cran.r-project.org/web/packages/numDeriv/index.html"><code>numDeriv</code></a>は数値微分による Jacobian, Hessian 計算を提供するが，それ以上の高階の微分ができず，テンソル値関数の微分もできない．</li>
<li><a href="https://cran.r-project.org/web/packages/tensorA/index.html"><code>tensorA</code></a>は Einstein の縮約記法を提供するが，２階のテンソルまでに限る．</li>
<li><a href="https://cran.r-project.org/web/packages/mpoly/index.html"><code>mpoly</code></a>は１変数の Hermite 多項式を提供するが，多変数には対応していない．</li>
<li><a href="https://cran.r-project.org/web/packages/pracma/index.html"><code>pracma</code></a>は１変数の Taylor 展開を提供するが，多変数には対応していない．</li>
<li><a href="https://cran.r-project.org/web/packages/cubature/index.html"><code>cubature</code></a>は多変数関数の数値積分に対応しているが，その他の（直交）座標には対応していない．</li>
</ul>
<p>特に R は記号計算が苦手である．外部の記号計算ソフトウェアに繋ぐことは試みがあるかもしれないが，R 独自のパッケージ内で扱うシステムは従来なかった．</p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/Ryacas/index.html"><code>Ryacas</code></a>は<a href="http://www.yacas.org/index.html"><code>Yacas</code></a>という外部の記号計算ソフトウェアへのインターフェースを提供する．</li>
<li><a href="https://cran.r-project.org/web/packages/caracas/index.html"><code>caracas</code></a>は R-Python インターフェース<a href="https://rstudio.github.io/reticulate/"><code>reticulate</code></a>を通じて<a href="https://www.sympy.org/en/index.html"><code>SymPy</code></a>という Python の記号計算ライブラリへのインターフェースを提供する．</li>
</ul>
<p>これにより，R の，新たな統計推測手法を実装し論文として公開するために用いる言語という性質を活かすことが，パッケージ<code>calculus</code>の目的にある <span class="citation" data-cites="Guidotti2022">(Guidotti, 2022, p. 4)</span>．</p>
</div>
</div>
</div>
<p>確率過程に対する漸近展開公式では，1000 を超える連立常微分方程式系を解き，その解を通じて多変数 Hermite 多項式の和を計算する必要があり，その際に YUIMA パッケージにおいて記号微分を実行する際に用いられている：</p>
<div class="article-card-container">
  <div class="article-card">
    <a href="https://162348.github.io/posts/2024/Computation/YUIMA.html" target="_blank">
      <img src="https://162348.github.io/posts/2024/Computation/YUIMA_files/figure-html/unnamed-chunk-5-1.png" alt="Article Image" class="article-image">
      <div class="article-content">
        <h3 class="article-title anchored">YUIMA 入門</h3>
        <p class="article-description">確率微分方程式のシミュレーションと推測のためのパッケージ`yuima`の構造と使い方をまとめます．</p>
      </div>
    </a>
  </div>
</div>
</section>
<section id="基本" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="基本"><span class="header-section-number">1</span> 基本</h2>
<section id="概観" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="概観"><span class="header-section-number">1.1</span> 概観</h3>
<p>ベクトル，行列，テンソルはいずれも配列 <code>array</code> として実装されている．特に，ベクトルと行列はテンソルの特殊な場合と理解できるように，実装上も，統一的に Einstein の縮約記法が適用可能である．</p>
<p>すべての関数（＝数学的演算）は，数値バージョンと記号演算バージョンのディスパッチとして実装される．</p>
</section>
<section id="演算" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="演算"><span class="header-section-number">1.2</span> 演算</h3>
<p><code>numeric</code>, <code>complex</code>, <code>character</code>, <code>expression</code> のいずれかの型を持つ，同次元の配列に対して定義されている．</p>
<p>例えば１次元の<code>character</code>に対しては：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(calculus)</span>
<span id="cb2-2">(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a + b"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%prod%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>i) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%sum%</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%prod%</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%diff%</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> e) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%div%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "((a + b) * (0+1i)) - ((d + e) / 3)"</code></pre>
</div>
</div>
<p>ここで，<code>1i</code>, <code>0</code>, <code>expression(d+e)</code>,<code>3</code>はいずれも<code>character</code>に変換されてから実行されている：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">typeof</span>(.Last.value)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
</div>
<p>この段階では<code>+0</code>などを省くのみで，評価や簡約化はされない．</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="() の消去">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
() の消去
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%0A(a+b)(c+d)%0A"> を <img src="https://latex.codecogs.com/png.latex?%0Aa+bc+d%0A"> と解釈してしまうことなどを防ぐため，すべての変数は<code>()</code>で囲まれる．</p>
<p>この挙動は<code>options(calculus.auto.wrap=FALSE)</code>で無効にできる．</p>
</div>
</div>
</div>
</section>
<section id="評価" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="評価"><span class="header-section-number">1.3</span> 評価</h3>
<p>関数<code>evaluate</code>が提供されている．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">array</span>(letters[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">evaluate</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">a=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">c=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">e=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">f=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    3    5
[2,]    2    4    6</code></pre>
</div>
</div>
<p>関数<code>evaluate</code>はベクトル化されている：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">var <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">a=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">c=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">e=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">f=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)</span>
<span id="cb8-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">evaluate</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var=</span>var)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    1    2    3    4    5    6
[2,]    3    3    4    5    6    7</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="R Base の eval 関数との違い">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
R Base の eval 関数との違い
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><code>eval</code>関数では，１つの変数の代入しか行えない．</p>
<p>複数与えられた場合でも，最後の１つのみ評価した結果が返される：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">var_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">a=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">c=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">e=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">f=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">eval</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parse</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text=</span>x), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">envir=</span>var_list)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
<p><code>evaluate</code>関数と同様の結果を得るには，成分ごとに繰り返し適用する必要がある．例えば次のように：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply</span>(x, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(expr) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">eval</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parse</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text=</span>expr), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">envir=</span>var_list))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    3    5
[2,]    2    4    6</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="微積分" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="微積分"><span class="header-section-number">2</span> 微積分</h2>
<section id="記号微分" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="記号微分"><span class="header-section-number">2.1</span> 記号微分</h3>
<p>関数<code>derivative</code>は関数を表す文字列<code>f</code>と，微分する変数名を表す<code>var</code>の２つの引数を取る．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">derivative</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">f=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sin(x)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "cos(x)"</code></pre>
</div>
</div>
<p>多変数も同様．高階微分は引数<code>order</code>で指定する： <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%7D%7B%5Cpartial%20x%7D%5Cfrac%7B%5Cpartial%20%5E2%7D%7B%5Cpartial%20y%5E2%7Dy%5E2%5Csin(x)=2%5Ccos(x)%0A"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">derivative</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">f =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y^2 * sin(x)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2 * cos(x)"</code></pre>
</div>
</div>
</section>
<section id="比較" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="比較"><span class="header-section-number">2.2</span> 比較</h3>
<section id="基本的な構文の違い" class="level4" data-number="2.2.1">
<h4 data-number="2.2.1" class="anchored" data-anchor-id="基本的な構文の違い"><span class="header-section-number">2.2.1</span> 基本的な構文の違い</h4>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%7D%7B%5Cpartial%20x%7D%5Csin(x)%5Cbigg%7C_%7Bx_0%7D%0A"></p>
<p>は次のように計算できる：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">sym <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">derivative</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">f=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sin(x)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb18-2">num <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">derivative</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">f=</span><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(x), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span></code></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>出力</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">result <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb19-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Method =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Symbolic"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Numeric"</span>),</span>
<span id="cb19-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(sym, num)</span>
<span id="cb19-4">)</span>
<span id="cb19-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Method Value
1 Symbolic     1
2  Numeric     1</code></pre>
</div>
</div>
</section>
<section id="階微分での比較" class="level4" data-number="2.2.2">
<h4 data-number="2.2.2" class="anchored" data-anchor-id="階微分での比較"><span class="header-section-number">2.2.2</span> ４階微分での比較</h4>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%5E4%7D%7B%5Cpartial%20x%5E4%7D%5Csin(x)%5Cbigg%7C_%7Bx=0%7D%0A"> は次のように計算できる：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">sym <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">derivative</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">f=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sin(x)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb21-2">num <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">derivative</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">f=</span><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(x), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>出力</summary>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">result <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb22-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Method =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Symbolic"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Numeric"</span>),</span>
<span id="cb22-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(sym, num)</span>
<span id="cb22-4">)</span>
<span id="cb22-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Method         Value
1 Symbolic  0.000000e+00
2  Numeric -9.767766e-12</code></pre>
</div>
</div>
</section>
<section id="多変数での比較" class="level4" data-number="2.2.3">




</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">2.2.3 多変数での比較</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-Guidotti2022" class="csl-entry">
Guidotti, E. (2022). Calculus: High-dimensional numerical and symbolic calculus in r. <em>Journal of Statistical Software</em>, <em>104</em>(5), 1–37. <a href="https://doi.org/10.18637/jss.v104.i05">https://doi.org/10.18637/jss.v104.i05</a>
</div>
</div></section></div> ]]></description>
  <category>R</category>
  <category>YUIMA</category>
  <guid>https://162348.github.io/posts/2024/Computation/calculus.html</guid>
  <pubDate>Mon, 17 Jun 2024 15:00:00 GMT</pubDate>
  <media:content url="https://162348.github.io/posts/2024/Computation/Files/calculus.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>総合研究大学院大学５年一貫博士課程のすすめ</title>
  <dc:creator>司馬博文 </dc:creator>
  <link>https://162348.github.io/posts/2024/Life/SOKENDAI.html</link>
  <description><![CDATA[ 





<!--







-->
<div class="article-card-container">
<blockquote class="twitter-tweet blockquote"><p lang="ja" dir="ltr">総研大と鎌谷研の学生募集ですわ〜！ <a href="https://t.co/kv27wI4wtV">https://t.co/kv27wI4wtV</a></p>— 総合研究大学院大学お嬢様部 (@sokenojou) <a href="https://twitter.com/sokenojou/status/1798237358514643257?ref_src=twsrc%5Etfw">June 5, 2024</a></blockquote> <script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script> 
</div>
<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<div class="callout callout-style-simple callout-caution">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>筆者は <strong>2023 年度入学</strong> であり，その場合についてのみ述べます．</p>
<p>特に，本稿で紹介している 2023 年度の制度から変更がある可能性がありますから，本格的に進学を検討する場合は，記事中に適宜付しました「チェックすべきリンク集」のリンク先もご確認ください．</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled" title="チェックすべきリンク集">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
チェックすべきリンク集
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="https://www.soken.ac.jp/">総研大の HP</a></li>
<li><a href="https://www.ism.ac.jp/senkou/">統計科学コースの HP</a></li>
<li><a href="https://www.soken.ac.jp/campuslife/handbook/">総研大の学生便覧</a></li>
</ul>
</div>
</div>
<section id="統数研での５年一貫博士課程" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="統数研での５年一貫博士課程"><span class="header-section-number">1</span> 統数研での５年一貫博士課程</h2>
<section id="総合研究大学院大学について" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="総合研究大学院大学について"><span class="header-section-number">1.1</span> 総合研究大学院大学について</h3>
<p>統計数理研究所において研究教育を受けたい場合，大学院生としては</p>
<div class="callout callout-style-simple callout-caution no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li>総合研究大学院大学
<ul>
<li>先端学術院先端学術専攻
<ul>
<li><a href="https://www.ism.ac.jp/senkou/">統計科学コース</a></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</div>
<p>に所属することになります．</p>
<p>上位概念から解説して参ります．</p>
<ol type="1">
<li><p><u>総合研究大学院大学（略して <strong>総研大</strong>）</u></p>
<p>学部を持たない国立（大学院）大学です．<sup>1</sup> 1988 年の開学以来 35 年の歴史を持ちます．</p></li>
<li><p><u>先端学術院先端学術専攻</u></p>
<p>総合研究大学院大学はもともと複数の専攻に分かれてしましたが，１つの「先端学術院先端学術専攻」に統合され，20 個のコースに分かれている，という扱いになりました．このことにより，定員に関する融通がより効くようになっており，統計科学コースは定員２名ですが，2024 年度のように受験者数２名でも合格者が０名のことも十分に起こり得ます．</p></li>
<li><p><u>統計科学コース</u></p>
<p>全 20 コースの一覧は <a href="https://www.soken.ac.jp/prog/">こちら</a> からご覧になれます．それぞれのコースが <strong>基盤機関</strong> と呼ばれる研究所と対応しており，実際の教育研究はその研究所で行われます．<sup>2</sup> 統数研の他には，国立天文台，宇宙科学研究所（JAXA の一部），国立民俗学博物館，国立情報学研究所などが基盤機関としてあります．</p></li>
</ol>
</section>
<section id="学生数について" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="学生数について"><span class="header-section-number">1.2</span> 学生数について</h3>
<div class="callout callout-style-default callout-caution callout-titled" title="定員について">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定員について
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>５年一貫博士課程の定員は２名ですが，2021 年度から2023 年度は１名（筆者），2024 年度は０名でした．</p>
<p>一方で，３年次編入の定員が６名で，毎年ほとんど６名の方が入学されます．例年，そのうちの <img src="https://latex.codecogs.com/png.latex?2/3"> が社会人です．</p>
</div>
</div>
</div>
<p>2024 年４月１日の学生総数は <img src="https://latex.codecogs.com/png.latex?34"> 名で，うち社会人が <img src="https://latex.codecogs.com/png.latex?24"> 名になります．それ以外の学生を <strong>フルタイム学生</strong> と呼ぶ伝統があります．</p>
<p>社会人学生の方は基本的にリモートでの研究指導を受けることになりますから，研究所には半年に一回来れれば良い方だという人も多いです．</p>
<p>そのため，フルタイム学生は，例え研究所に来てもほとんど学生に会えないことが多いです．ましてや同期の存在は期待できないでしょう．</p>
</section>
<section id="sec-teachers" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="sec-teachers"><span class="header-section-number">1.3</span> 教員陣について</h3>
<div class="callout callout-style-simple callout-tip callout-titled" title="チェックすべきリンク集">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
チェックすべきリンク集
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="https://www.ism.ac.jp/ism_info_j/theme_j.html">統数研の教員と専門一覧</a></li>
<li><a href="https://www.ism.ac.jp/senkou/subject/teacher.html">統数研の教員の主な教育内容</a></li>
<li><a href="https://cplan-public.soken.ac.jp/public/web/Syllabus/WebSyllabusKensaku/UI/WSL_SyllabusKensaku.aspx">総研大のシラバス</a></li>
</ul>
</div>
</div>
<p>統数研には授業を開講している専任教員だけで 81 人います．</p>
<p>また，上掲の <a href="https://www.ism.ac.jp/ism_info_j/theme_j.html">統数研の教員と専門一覧</a> から分かる通り，凡そ統計に関連のある分野が理論・応用を分けずに網羅されており，それもスター研究者が揃っています．</p>
<p>統計と言ってもあまりにその関連分野が広いため，筆者は統数研の真の裾の広さは，入学後に <a href="https://www.ism.ac.jp/meetings/seminar.html">統計数理セミナー</a> を通じて，やっと気づきました．</p>
<div class="callout callout-style-default callout-caution callout-titled" title="統計数理セミナーについて">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
統計数理セミナーについて
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>統数研では <a href="https://www.ism.ac.jp/meetings/seminar.html">統計数理セミナー</a> と呼ばれるセミナーが毎週水曜日 16:00~17:20 に開催されており，全ての教員は毎年１回は発表することになっています．</p>
<p>統計数理セミナーは学生は出席報告とレポート提出をすることで単位を取得することも出来ます．そこで多くの分野の最新の研究に触れることになり，必ずや新たな発見があることでしょう．</p>
<p>特に，数学と数理統計の一部しか知らずに入学した筆者にとっては，実際の統計モデリングの研究（地震データ，天文データ，統数研が実施している <a href="https://www.ism.ac.jp/kokuminsei/">国民性調査</a> のサーベイデータ）から，機械学習の理論研究からマテリアルズインフォマティクスへの応用まで，無限次元の情報幾何から MCMC まで，思いつく順番に挙げたまでですが，多岐に渡る研究分野の存在と，その分野でのスターが揃っていることを，入学してしばらくしてようやく理解されてきました．</p>
<p>統計数理セミナーは２年目ですが，何周しても飽きないように思われます．</p>
</div>
</div>
</div>
</section>
<section id="授業について" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="授業について"><span class="header-section-number">1.4</span> 授業について</h3>
<p>ここまでご説明しました通り，統数研では教員が学生数の３倍近くいるため，授業は大変充実しています．しかしその分，多くの授業では教員と１対１になることが想定されます．</p>
<p>ですが実際は，先生がメーリングリストで追加の参加者を呼びかけたり，学生側が他の学生を誘い合わせたりするため，１対１になることは少ないです．<sup>3</sup></p>
<p>開講が珍しい授業ですと，教員陣も学生として参加していることも珍しくありません．</p>
<p>また，社会人学生が <img src="https://latex.codecogs.com/png.latex?2/3"> を占めている以上，リモートやハイブリッドでの開講や日程調整については極めて柔軟に対応されます．</p>
<p>筆者は統数研から遠い片道２時間弱の場所に住んでいるため，なるべく対面授業の日は１日にまとめたく，日程を調整していただきました．</p>
</section>
<section id="sec-library" class="level3" data-number="1.5">
<h3 data-number="1.5" class="anchored" data-anchor-id="sec-library"><span class="header-section-number">1.5</span> 図書室について</h3>
<p>ここで特筆したいのは，<a href="https://www.ism.ac.jp/library/index_j.html">図書室</a> の存在です．</p>
<p>統数研の歴史は極めて長く，戦前の 1944 年に設立され，2004 年度までは文部省直轄の研究機関でした．</p>
<p>そのこともあってか，統計と数学に関する膨大な文献が揃っており，筆者は今のところ参照したい書籍が統数研図書室で見当たらなかったことはほとんどありません．</p>
<p>貴重な文献も，「文部省統計数理研究所」の印と共に２冊ほど所蔵されている，という経験が何度もあります．最新の書籍も寄贈や同研究所の先生方がすでに買っているかなどのことも多く，よく揃っています．</p>
<p>なお，電子リソース（論文や e-book）も，統数研内のネットワークからアクセスすることで殆どが閲覧できます．自宅にいても，<code>ssh</code> を通じた所内ネットワークへのリモートアクセスで随時論文や電子リソースにアクセスすることができます．</p>
</section>
<section id="sec-support" class="level3" data-number="1.6">
<h3 data-number="1.6" class="anchored" data-anchor-id="sec-support"><span class="header-section-number">1.6</span> 金銭支援について</h3>
<div class="callout callout-style-simple callout-tip callout-titled" title="チェックすべきリンク集">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
チェックすべきリンク集
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="https://www.ism.ac.jp/senkou/life/scholarship.html">統数研のページ「奨学金等」</a></li>
<li><a href="https://www.soken.ac.jp/campuslife/tuition/">総研大のページ「学費・各種経済支援」</a></li>
</ul>
</div>
</div>
<ol type="1">
<li><p>リサーチ・アシスタント</p>
<p>５年の間いつでも，申請をすることで RA としての雇用を希望することができます．月額 10 万円弱の給与が７月から３月まで支給されます．１年ごとの更新です．<sup>4</sup></p></li>
<li><p><a href="https://www.soken.ac.jp/campuslife/tuition/sp_researcher_ch/">総研大特別研究員</a></p>
<p>博士後期課程では，特別研究員制度へ応募することができます．すなわち，学振の特別研究員（DC1, DC2）に加えて，総研大独自の特別研究員制度もあるということです．</p></li>
</ol>
<p><a href="https://www.soken.ac.jp/campuslife/tuition/exemption/">授業料免除</a> や <a href="https://www.soken.ac.jp/campuslife/tuition/jasso/">奨学金</a> を除いて，統計科学コース独自のものは基本この２つです．</p>
<p>他にも，次の研究支援があります：</p>
<ul>
<li><p>研究環境整備費</p>
<p>初年度に 20 万円を上限に，PC やモニターなどの研究環境を整えるために，学生に予算が配分されます．</p></li>
<li><p><a href="https://www.soken.ac.jp/education/dispatch/sokendai_studentdispatchprogram/">SOKENDAI 研究派遣プログラム</a></p>
<p>３ヶ月前後の海外での研究滞在を支援するプログラムです．</p></li>
</ul>
</section>
<section id="修士号について" class="level3" data-number="1.7">
<h3 data-number="1.7" class="anchored" data-anchor-id="修士号について"><span class="header-section-number">1.7</span> 修士号について</h3>
<p>五年一貫博士課程では，基本的には博士（統計科学）の学位のみが授与されます．<sup>5</sup></p>
<p>しかし，特例として，２年以上在籍し，特定の要件を満たした場合は，中途退学と同時に修士の学位を得ることもできます <span class="citation" data-cites="総合研究大学院大学学生便覧2023">(学生便覧, 2023, p. 5)</span>．</p>
</section>
</section>
<section id="学生生活私の場合" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="学生生活私の場合"><span class="header-section-number">2</span> 学生生活（私の場合）</h2>
<p>以上が統数研で学生生活をするにあたっての，基本的な環境です．いかが思われたでしょうか？</p>
<p>私にとっては現状，この上なく理想的な環境だと感じています．主な理由は次の通りです：</p>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<ol type="1">
<li>図書室が充実していて，殆どの文献をすぐに参照することができる 1.5</li>
<li>計算機準備予算も付いたので，大きなモニターと高性能な計算機で研究・勉強ができる 1.6</li>
<li>先生方との距離が近く，研究に関する相談もしやすい 1.3</li>
<li>事務の方との距離が近く，込み入った相談や提出物の忘れなども，時には先回りをして親切に対応していただける 2.2</li>
<li>およそ統計に関連する分野のエキスパートが，単一の機関に揃っている 2.4</li>
</ol>
</div>
</div>
</div>
<p>というように，研究のための環境はこれ以上ないほどのものだと言って過言でないでしょう．</p>
<section id="sec-warning" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="sec-warning"><span class="header-section-number">2.1</span> 【注意喚起】同期が居ないことについて</h3>
<p>ただし，通常の大学院生活とは全く違うものになることは確かです．最大の違いは，研究室の同期・先輩が居ない代わりに，教員・事務の先生方との距離が近い，ということです．<sup>6</sup></p>
<p>最初から「大人」としての振る舞いが求められる，とでも言うべきでしょうか．</p>
<p>換言すれば，学生は研究所内では極めて少数派ですので，先生方も事務の方々も，学生が何で困っているのか，本当に想像がつかない場合が多いのです．さらに言えば，あなたが学生であることも言わなきゃわからないことが多いです．</p>
<p>ですから，少しでもわからないことや不安なことがあれば，はっきりと「自分は学生である」ということと「こういうことに困っている」と言語化してコミュニケーションを取らないと，困った状況に陥りやすいことが，最大の注意点でしょう．</p>
<p>例えば研究や資料準備などがうまく行っていなくて後ろめたい気持ちがあり，コミュニケーションを避けがちな状態では尚更で，普通の大学院生活よりも，「時すでに遅し」という状況に陥りやすいと言えるかも知れません．</p>
<p>この点から，「基本的には，特別な理由がない限り，５年一貫博士課程は勧めない」という立場の先生方も多いです．</p>
<p>研究室内に溜まった暗黙のノウハウ，のようなものもありませんから，奨学金申請，授業料免除申請，研究費の使い方，申請書の書き方，ポスターの作り方などは，積極的に先生方と事務の方々に，時には，「すみません，一から何をすべきか分からないかもしれません」と「迷惑」をかけていく姿勢が必要になることもあるかもしれません．</p>
<p>その点，研究所外でのつながりも重要です．</p>
<div class="callout callout-style-default callout-caution callout-titled" title="さらに踏み込んだアドバイス">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
さらに踏み込んだアドバイス
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>「迷惑」と書きましたのは，実際は迷惑ではないからです．自分で調べて解決しようとしても，すでに慣習やルールがあるかもしれませんから，自己流にやって手遅れになるよりかは，わからないことはわからないと聞くのが「正解」で想定されています．</p>
<p>自分からアクションを起こさなきゃいけないのは，５年一貫制博士課程の入学者が毎年０か１かですので，先生方も事務の方も本当に忘れている場合の方が多いです．その意味で，学生はマイノリティですから，「自分は学生としてここにいる」という気持ちを強く持って，研究生活を歩むのが大事だと思います．</p>
<p>社会人学生が大半を占めるように，実際，学生数が少ないため一人当たりのリソースが多く，社会人の方が共同研究を遂行するには最高の環境でしょう．しかし，学生のみなさんも，以上の理由からみすみすこの環境を逃すにはもったいないと考えます．</p>
<p>そこで，本記事を用意したのでした．</p>
</div>
</div>
</div>
</section>
<section id="sec-life-support" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="sec-life-support"><span class="header-section-number">2.2</span> 学生生活の支援</h3>
<p>しかし，先生方も事務の方も，困っている学生を助けたいと常に配慮してくださいますし，上述の通り，支援制度と研究環境は大変充実しています．</p>
<p>また，とりわけ，大学院担当の事務の方々は，学生の背景も覚えていてくださり，申請書を書く際にいくつかわからない項目や揃わない書類があった際は親身になって相談に乗ってくださいましたし，筆者のミスで出席連絡メールが不着であったときは「司馬くん出席してるよね？もしかして送信先ミスってない？」と気づいてくださったりもしました．</p>
<p>ですから，良い環境で研究したいと主体的に思える方は，ぜひ統数研の５年一貫博士課程を検討してみて欲しい，その気持ちで筆を取っております．</p>
<p>ただし，健康診断も職員と同一扱いです．めっちゃすごいところでの検診になります．</p>
</section>
<section id="研究室の様子" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="研究室の様子"><span class="header-section-number">2.3</span> 研究室の様子</h3>
<p>先ほど第 2.1 節で「同期がいない」と強調しました．５年一貫博士課程の場合は，通例あなたひとりになりますから，同期はいないと思って良いでしょう．</p>
<p>一方で，研究室には先輩がいる可能性があります．次に述べます通り，学生がいる研究室が集中しているためです．</p>
<p>筆者の入学時，５年一貫博士課程生は筆者を入れて４名，３年次編入学生が33名でした．</p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="学生が３名以上居る研究室（2023 年度当時）">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
学生が３名以上居る研究室（2023 年度当時）
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="https://www.ism.ac.jp/senkou/subject/teacher.html#page_13">野間研究室</a> ５名</li>
<li><a href="https://www.ism.ac.jp/senkou/subject/teacher.html#page_07">日野研究室</a> ５名</li>
<li><a href="https://www.ism.ac.jp/senkou/subject/teacher.html#page_28">二宮研究室</a> ５名</li>
<li><a href="https://www.ism.ac.jp/senkou/subject/teacher.html#page_30">藤澤研究室</a> ４名</li>
<li><a href="https://www.ism.ac.jp/senkou/subject/teacher.html#page_39">持橋研究室</a> ４名</li>
</ul>
<!--
* 上野研究室 ２名
* 中野研究室 ２名
* 福水研究室 ２名
* 吉田研究室 １名
* 庄研究室 １名
* 松井研究室 １名
* 南研究室 １名
* 山下研究室 １名
* 金藤研究室 １名
* 志村研究室 １名
* 鎌谷研究室 １名
-->
</div>
</div>
<p></p><div id="tweet-31724"></div><script>tweet={"url":"https:\/\/twitter.com\/daiti_m\/status\/1801219144446320867","author_name":"Daichi Mochihashi","author_url":"https:\/\/twitter.com\/daiti_m","html":"\u003Cblockquote class=\"twitter-tweet\" align=\"center\"\u003E\u003Cp lang=\"ja\" dir=\"ltr\"\u003E総研大統計科学コース(統数研)の現役学生の司馬さんによる紹介、とても良い記事だと思いました。\u003Cbr\u003E同期が少ないのは国立研究所全体に共通ですが、研究室によっては(私の研究室も含めて)、学生が複数いることもあります。機械学習に関しては研究室を越えた交流があるかと思います。 \u003Ca href=\"https:\/\/t.co\/gSrGCg3kv4\"\u003Ehttps:\/\/t.co\/gSrGCg3kv4\u003C\/a\u003E\u003C\/p\u003E&mdash; Daichi Mochihashi (@daiti_m) \u003Ca href=\"https:\/\/twitter.com\/daiti_m\/status\/1801219144446320867?ref_src=twsrc%5Etfw\"\u003EJune 13, 2024\u003C\/a\u003E\u003C\/blockquote\u003E\n\u003Cscript async src=\"https:\/\/platform.twitter.com\/widgets.js\" charset=\"utf-8\"\u003E\u003C\/script\u003E\n\n","width":550,"height":null,"type":"rich","cache_age":"3153600000","provider_name":"Twitter","provider_url":"https:\/\/twitter.com","version":"1.0"};document.getElementById("tweet-31724").innerHTML = tweet["html"];</script><p></p>
</section>
<section id="sec-lectures" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="sec-lectures"><span class="header-section-number">2.4</span> 授業について</h3>
<div class="callout callout-style-simple callout-tip callout-titled" title="チェックすべきリンク集">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
チェックすべきリンク集
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="https://www.ism.ac.jp/senkou/subject/">統数研ページ「担当教員・授業科目」</a></li>
<li><a href="https://www.ism.ac.jp/senkou/about/doctoral_thesis.html">統数研ページ「終了要件」</a></li>
</ul>
</div>
</div>
<p>５年一貫博士課程の卒業要件では，必修授業（研究指導）を除いて 20 単位の取得が必要です <span class="citation" data-cites="総合研究大学院大学学生便覧2023">(学生便覧, 2023, p. 22)</span>．</p>
<p>私は修士の１年の間に（必修を除いて）12 単位を取得しましたので，あと４授業分を４年で消化すれば良いことになります．</p>
<p>その 12 単位は１年の間に取るべきだと考えた入門的なオムニバス講義でしたから，単位取得や成績の確保に追われることなく，自分の学びたいことをじっくり学ぶことができます．<sup>7</sup></p>
<div class="callout callout-style-default callout-caution callout-titled" title="筆者が１年目にとった授業">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
筆者が１年目にとった授業
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>統計科学コースには準必修と呼ぶべき「取らなきゃいけない授業」はありませんが，修士のうちに履修すべきとされる基本的な内容を扱う <a href="https://www.ism.ac.jp/senkou/subject/subject1.html"><strong>基礎科目</strong></a> と呼ばれる授業が全部で８つあります．</p>
<p>そのうち，次の３つを筆者は履修しました．</p>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="多変量解析">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
多変量解析
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>疫学と医療統計の <a href="https://www.ism.ac.jp/senkou/subject/teacher.html#page_13">野間先生</a> や，環境統計の <a href="https://www.ism.ac.jp/senkou/subject/teacher.html#page_12">金藤先生</a>，調査の <a href="https://www.ism.ac.jp/senkou/subject/teacher.html#page_23">前田先生</a> と <a href="https://www.ism.ac.jp/senkou/subject/teacher.html#page_21">朴先生</a>，金融データの <a href="https://www.ism.ac.jp/senkou/subject/teacher.html#page_15">山下先生</a>，差分プライバシーの <a href="https://www.ism.ac.jp/senkou/subject/teacher.html#page_14">南先生</a> と，各分野で多変量解析を実際に使って研究なさっている先生方によるオムニバス講義です．</p>
<p>何よりも，各分野によって多変量解析への姿勢が少しずつ違い，教科書で読むだけでは無味乾燥であった多変量解析が極めて身近で手触りを感じました．</p>
<p>以下はシラバスの抜粋です．</p>
<blockquote class="blockquote">
<p>下記の構成で授業を行う。（）内は主な担当教員である。</p>
</blockquote>
<ol type="1">
<li>ガイダンス（多変量データ解析概観）（野間）</li>
<li>多変量データの取得と合成変量モデルによる解析（前田）</li>
<li>多変量の推測統計の初歩（多変量正規分布，多変量T2検定など）（金藤）</li>
<li>カテゴリカルデータの解析（分割表の解析）（野間）</li>
<li>多変量データのための回帰分析・重回帰分析 (1)（南）</li>
<li>多変量データのための回帰分析・重回帰分析 (2)（南）</li>
<li>離散変数と定性データの分類・統計モデル (1) （山下）</li>
<li>離散変数と定性データの分類・統計モデル (2)（山下）</li>
<li>一般化線型モデル(1) 一般論，推測手法（金藤）</li>
<li>一般化線形モデル(2) ロジスティック回帰，ポアソン回帰（野間）</li>
<li>主成分分析と関連手法（朴）</li>
<li>因子分析・共分散構造分析（朴）</li>
<li>正準相関分析と数量化の方法（前田）</li>
<li>クラスター分析・MDS（前田）</li>
<li>まとめ・発展的話題（山下・南）</li>
</ol>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="計算推論基礎">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
計算推論基礎
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>指導教員の <a href="https://www.ism.ac.jp/senkou/subject/teacher.html#page_03">鎌谷先生</a> による MCMC の授業だけでなく，データ同化を研究する <a href="https://www.ism.ac.jp/senkou/subject/teacher.html#page_06">中野先生</a> から粒子フィルターについて，統計物理学出身の <a href="https://www.ism.ac.jp/senkou/subject/teacher.html#page_33">坂田先生</a> からグラフィカルモデルについて，自然言語処理のエキスパートである <a href="https://www.ism.ac.jp/senkou/subject/teacher.html#page_39">持橋先生</a> からノンパラメトリックベイズについて学べた授業です．</p>
<p>どの内容に対しても先生方の背景がピッタリであることにお気づきでしょうか．</p>
<p>計算推論の手法は数理的に高度ですが，どの分野から生まれた手法で，どのような問題に適用されているかをセットで学ぶことで，稀有な直感が醸成されます．</p>
<p>指定の教科書を読むだけでは得られない肌感を得るのに最適な授業で，出席する前と後での理解度の差が歴然としていました．</p>
<p>以下はシラバスの抜粋です．</p>
<ol type="1">
<li>イントロダクション</li>
<li>乱数の使い方：ブートストラップ法，モンテカルロ法</li>
<li>ＭＣＭＣ入門</li>
<li>ベイズ統計入門</li>
<li>階層ベイズモデルとベイズ平滑化</li>
<li>状態空間モデル，逐次ベイズ推定，粒子フィルタ</li>
<li>粒子フィルタの応用と発展</li>
<li>グラフィカルモデルの基礎</li>
<li>有向グラフと無向グラフ</li>
<li>様々なグラフィカルモデル</li>
<li>確率伝搬法とその周辺</li>
<li>混合ガウス分布とK-means法</li>
<li>EMアルゴリズム</li>
<li>変分ベイズEMアルゴリズムとその応用</li>
<li>Variational Autoencoder (VAE)とその応用</li>
</ol>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="統計的機械学習基礎">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
統計的機械学習基礎
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>日本のカーネル法・深層学習研究の第一線を走っていらっしゃる <a href="https://www.ism.ac.jp/senkou/subject/teacher.html#page_29">福水先生</a> から直接深層学習について学べたことが大変印象深かったものでした．</p>
<p>それだけでなく，マテリアルズインフォマティクスで機械学習がどう活かされるかを <a href="https://www.ism.ac.jp/senkou/subject/teacher.html#page_16">吉田先生</a> と <a href="https://www.ism.ac.jp/senkou/subject/teacher.html#page_19">Wu 先生</a> 先生から学び，学習理論を <a href="https://www.ism.ac.jp/senkou/subject/teacher.html#page_07">日野先生</a> から学び，Gauss 過程法を <a href="https://www.ism.ac.jp/senkou/subject/teacher.html#page_08">松井先生</a> から学ぶことが出来る授業です．</p>
<p>以下はシラバスの抜粋です．</p>
<ol type="1">
<li>総論（機械学習とは？　教師あり学習、教師無し学習、モデル選択）</li>
<li>カーネル法　（カーネル法の基礎と方法）</li>
<li>サポートベクターマシン I　（SVMの基礎）</li>
<li>サポートベクターマシン　II　（SVMの基礎と発展）</li>
<li>アンサンブル法（ランダムフォレスト、バギング、ブースティングなど）</li>
<li>深層学習 I　（深層学習の基礎）</li>
<li>深層学習 II 　（深層学習の発展）</li>
<li>ガウス過程I（ガウス過程の概念と基礎）</li>
<li>ガウス過程II（カウス過程の方法）</li>
<li>様々な問題設定 I（転移学習、半教師付き学習）</li>
<li>様々な問題設定II （強化学習）</li>
<li>様々な問題設定III （能動学習、実験計画、応用的話題）</li>
<li>統計的学習理論 I　（訓練誤差と汎化誤差の理論）</li>
<li>統計的学習理論 II　（訓練誤差と汎化誤差の理論）</li>
<li>まとめ</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
<p>また，統数研が毎年開催している公開講座も，学生ならば無料で参加ができます．</p>
<!--

## 受験に当たって

### 定員

### 入試の基本情報

::: {.callout-tip appearance="simple" title="チェックすべきリンク集"}
* [統数研のページ](https://www.ism.ac.jp/senkou/admission/examination.html)
* [総研大のページ](https://www.soken.ac.jp/admission/application_info/stat/index.html)
:::

### 過去問と解答

a

-->
</section>
</section>



<div id="quarto-appendix" class="default"><section id="終わりに" class="level2 appendix" data-number="3"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">3</span> 終わりに</h2><div class="quarto-appendix-contents">

<p>ページ下部のコメントからもぜひお気軽にお問い合わせください．</p>



</div></section><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-総合研究大学院大学学生便覧2023" class="csl-entry">
学生便覧. (2023). <em>総合研究大学院大学</em>. <a href="https://www.soken.ac.jp/campuslife/handbook/">https://www.soken.ac.jp/campuslife/handbook/</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>なお，博士課程のみの国立大学院大学としては，日本初であるという（<a href="https://ja.wikipedia.org/wiki/%E7%B7%8F%E5%90%88%E7%A0%94%E7%A9%B6%E5%A4%A7%E5%AD%A6%E9%99%A2%E5%A4%A7%E5%AD%A6">Wikipedia</a>）．↩︎</p></li>
<li id="fn2"><p>総研大本部は葉山にキャンパスありますが，そこに通うことは，統合進化科学研究センターに対応する統合進化科学コースを除いてありません．↩︎</p></li>
<li id="fn3"><p>筆者もまだ経験していませんが，受講者が２人だけということは３回ほど経験しています．↩︎</p></li>
<li id="fn4"><p>収入の要件はあります．また，指導教員が別の予算を持っている場合は，その予算から追加で（二重に）雇用される場合もあります．↩︎</p></li>
<li id="fn5"><p>場合によっては博士（学術）も授与されます．↩︎</p></li>
<li id="fn6"><p>現在，統数研では，複数名の学生がいる教員も５名ほど居ます．ですが，それでも同期は基本的におらず，先輩もすぐに卒業してしまったり，社会人であり殆ど連絡を取る機会がない，という場合が多いです．同期・先輩の存在を期待して進学するのは危険でしょう．↩︎</p></li>
<li id="fn7"><p>成績が気になるなら，計 20 単位を５年で消化することにすれば，１学期に１授業ずつ取ることも出来ますからね．↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Opinion</category>
  <category>Life</category>
  <guid>https://162348.github.io/posts/2024/Life/SOKENDAI.html</guid>
  <pubDate>Fri, 24 May 2024 15:00:00 GMT</pubDate>
  <media:content url="https://162348.github.io/posts/2024/Life/Images/博士（統計科学）.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>新時代の MCMC を迎えるために</title>
  <dc:creator>司馬博文 </dc:creator>
  <link>https://162348.github.io/posts/2024/Computation/MCMC.html</link>
  <description><![CDATA[ 





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../../../static/Posters/ISM-OH2024.pdf"><img src="https://162348.github.io/static/Posters/ISM-OH2024.jpg" class="img-fluid figure-img" style="width:50.0%" alt="「新時代の MCMC を迎えるために」統数研オープンハウス（タップで PDF 閲覧）"></a></p>
<figcaption>「新時代の MCMC を迎えるために」統数研オープンハウス（タップで PDF 閲覧）</figcaption>
</figure>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>以下は，5月24日 10:30~12:30 （コアタイム：10:30~11:10）に行われた <a href="../../../static/Sessions.html#sec-ISM-openhouse2024">2024年度統数研オープンハウス</a> ポスターセッション（掲載 No.&nbsp;E1）に於て発表されたポスターに関する解説記事です．</p>
</div>
</div>
</div>
<section id="導入" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="導入"><span class="header-section-number">1</span> 導入</h2>
<section id="mcmc-小史" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="mcmc-小史"><span class="header-section-number">1.1</span> MCMC 小史</h3>
<p>現状，HMC (Hamiltonian Monte Carlo) という約 40 年前に提案された MCMC 手法が，Stan などの確率的プログラミング言語のデフォルト MCMC 手法として採用されています．<sup>1</sup></p>
<p>この手法はもともと <span class="citation" data-cites="Duane+1987">(Duane et al., 1987)</span> が場の量子論に特化した Monte Carlo 法として提案したものであったところを，<span class="citation" data-cites="Neal1994">(Neal, 1994)</span> が一般の統計モデルに適用可能な形式に翻訳する形で提案されたものでした．</p>
<p>ということで，HMC は，オリジナルの MCMC が物理学者 <span class="citation" data-cites="Metropolis+1953">(Metropolis et al., 1953)</span> に由るように，物理学において着想された MCMC 手法であったのです．</p>
<p><strong>そのHMC が，提案から 40 年目を迎える前に，更なる効率的な手法によって代替されようとしています</strong>．</p>
<p>そのきっかけ <span class="citation" data-cites="Peters-deWith2012">(Peters &amp; de&nbsp;With, 2012)</span> も，やはり，物理学（正確には物質科学）からの着想でした．</p>
</section>
<section id="mcmc-とは何か" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="mcmc-とは何か"><span class="header-section-number">1.2</span> MCMC とは何か？</h3>
<p>MCMC とは，確率変数をシミュレーションする際に用いられる汎用的アルゴリズムです．</p>
<p>一様分布や正規分布などの名前がついた分布ではない場合，どのようにすればその分布に従う確率変数をシミュレーションできるのか？は，古くからの問題でした．</p>
<p>実際，「MCMC では空間を探索するマルコフ連鎖を構成し，その足跡を辿るとちょうど確率変数のシミュレーションになっている」と種明かしを聞いても，「なぜそのような回りくどい方法を使うのか？」「もっと良い方法はないのか？」と思っても当然でしょう．</p>
<p>ですが，MCMC を，発明された経緯を辿り，物理学の問題意識から見てみると，実は極めて自然な発想に思えてくるかもしれません．</p>
<p>以降，MCMC の起源である物理系のシミュレーション（第 2 節）を例に取り，分子動力学法（第 2.1 節），Metropolis 法（第 2.2 節）を復習します．</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/docs/posts/2024/Computation/MCMC_files/figure-html/fig-md-output-1.png" class="img-fluid figure-img"></p>
<figcaption>分子動力学法の出力（第 2.1 節）<sup>2</sup></figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/docs/posts/2024/Computation/MCMC_files/figure-html/fig-mh-output-1.png" class="img-fluid figure-img"></p>
<figcaption>Metropolis 法の出力（第 2.2 節）</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>これを基礎として，近年提案された非対称な MCMC 手法（第 3 章），そして最新の連続時間 MCMC 手法（第 4 章）を紹介します．</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/docs/posts/2024/Computation/MCMC_files/figure-html/fig-lmh-output-1.png" class="img-fluid figure-img"></p>
<figcaption>非対称 MCMC 法（Lifted Metropolis 法）の出力（第 3 章）</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/docs/posts/2024/Computation/MCMC_files/figure-html/fig-pdmp-output-1.png" class="img-fluid figure-img"></p>
<figcaption>連続時間 MCMC 法（Zig-Zag サンプラー）の出力（第 4 章）</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="sec-figs" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="sec-figs"><span class="header-section-number">1.3</span> 自己相関・軌跡の一覧</h3>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/docs/posts/2024/Computation/MCMC_files/figure-html/fig-mh-auto-output-1.png" class="img-fluid figure-img"></p>
<figcaption>Metropolis 法の自己相関関数（第 2.2 節）</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/docs/posts/2024/Computation/MCMC_files/figure-html/fig-lmh-auto-output-1.png" class="img-fluid figure-img"></p>
<figcaption>非対称 MCMC 法（Lifted Metropolis 法）の自己相関関数（第 3 章）</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/docs/posts/2024/Computation/MCMC_files/figure-html/fig-pdmp-auto-output-1.png" class="img-fluid figure-img"></p>
<figcaption>連続時間 MCMC 法（Zig-Zag サンプラー）の自己相関関数（第 4 章）</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/docs/posts/2024/Computation/MCMC_files/figure-html/fig-1-output-1.png" class="img-fluid figure-img"></p>
<figcaption>Metropolis 法の軌跡（第 2.2 節）</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/docs/posts/2024/Computation/MCMC_files/figure-html/fig-4-output-1.png" class="img-fluid figure-img"></p>
<figcaption>非対称 MCMC 法（Lifted Metropolis 法）の軌跡（第 3 章）</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/docs/posts/2024/Computation/MCMC_files/figure-html/fig-6-output-1.png" class="img-fluid figure-img"></p>
<figcaption>連続時間 MCMC 法（Zig-Zag サンプラー）の軌跡（第 4 章）</figcaption>
</figure>
</div>
</div>
</div>
</div>
<!--

### Comparison

::: {layout-ncol=3}
![Autocorrelation of the random walk Metropolis algorithm from section [-@sec-MH]](../../../docs/posts/2024/Computation/MCMC_files/figure-html/fig-mh-auto-output-1.png)

![Autocorrelation of the lifted Metropolis algorithm from chapter [-@sec-LMH]](../../../docs/posts/2024/Computation/MCMC_files/figure-html/fig-lmh-auto-output-1.png)

![Autocorrelation of the Zig-Zag sampler from chapter [-@sec-PDMP]](../../../docs/posts/2024/Computation/MCMC_files/figure-html/fig-pdmp-auto-output-1.png)
:::

::: {layout-ncol=3}
![Trajectory of the random walk Metropolis algorithm from section [-@sec-MH]](../../../docs/posts/2024/Computation/MCMC_files/figure-html/fig-1-output-1.png)

![Trajectory of the lifted Metropolis algorithm from chapter [-@sec-LMH]](../../../docs/posts/2024/Computation/MCMC_files/figure-html/fig-4-output-1.png)

![Trajectory of the Zig-Zag sampler from chapter [-@sec-PDMP]](../../../docs/posts/2024/Computation/MCMC_files/figure-html/fig-6-output-1.png)
:::

-->
</section>
</section>
<section id="sec-origin" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="sec-origin"><span class="header-section-number">2</span> MCMC の起源</h2>
<div class="callout callout-style-default callout-caution callout-titled" title="よりみち：どうして MCMC が必要だったのか？">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
よりみち：どうして MCMC が必要だったのか？
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="citation" data-cites="Metropolis+1953">(Metropolis et al., 1953)</span> では，温度 <img src="https://latex.codecogs.com/png.latex?T"> 一定の条件下で <img src="https://latex.codecogs.com/png.latex?N"> 粒子系をシミュレートし，任意の物理量 <img src="https://latex.codecogs.com/png.latex?F"> に対してその相空間上の平均 <img src="https://latex.codecogs.com/png.latex?%0A%5Clangle%20F%5Crangle=%5Cfrac%7B%5Cint%20Fe%5E%7B-%5Cfrac%7BE%7D%7BkT%7D%7Ddp%7D%7B%5Cint%20e%5E%7B-%5Cfrac%7BE%7D%7BkT%7D%7Ddp%7D%0A"> を効率的に計算する汎用アルゴリズムが提案された．これが現在では Metropolis 法と呼ばれている．<sup>3</sup></p>
<p><span class="citation" data-cites="Metropolis+1953">(Metropolis et al., 1953)</span> では <img src="https://latex.codecogs.com/png.latex?N"> が数百になる場合を考えており（時代を感じるスケール感），当然愚直な数値積分は現代の計算機でも実行可能ではない．そこで Monte Carlo 法を考えることになるが，当時 Monte Carlo 法といえば，一様乱数を用いた計算法の全般を指し，具体的には <img src="https://latex.codecogs.com/png.latex?%5Clangle%20F%5Crangle"> を重点サンプリング推定量 <img src="https://latex.codecogs.com/png.latex?%0A%5Cwidehat%7BF%7D=%5Cfrac%7B%5Csum_%7Bn=1%7D%5ENF(%5Comega)e%5E%7B-%5Cfrac%7BE(%5Comega)%7D%7BkT%7D%7D%7D%7B%5Csum_%7Bn=1%7D%5ENe%5E%7B-%5Cfrac%7BE(%5Comega)%7D%7BkT%7D%7D%7D%0A"> で推定することを指した．<sup>4</sup></p>
<p>しかしこれでは，高エネルギーな状態・低エネルギーな状態を全く区別せず，状態 <img src="https://latex.codecogs.com/png.latex?%5Comega%5Cin%5COmega"> を完全に一様に生成するため，その分だけ非効率である．</p>
<p>これを低減することが出来れば Monte Carlo 法の更なる効率改善に繋がる．こうして，Gibbs 分布 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7BZ%7De%5E%7B-%5Cfrac%7BE%7D%7BkT%7D%7D"> から直接的サンプリングする方法が模索されたのである．</p>
</div>
</div>
</div>
<p><span class="citation" data-cites="Metropolis+1953">(Metropolis et al., 1953)</span> では，エネルギー <img src="https://latex.codecogs.com/png.latex?E"> を持つ系の Boltzmann-Gibbs 分布 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7BZ%7De%5E%7B-%5Cfrac%7BE%7D%7BkT%7D%7D"> から直接サンプリングする方法が探求されました．</p>
<p>ここでは簡単のため，１粒子が次のようなポテンシャル <img src="https://latex.codecogs.com/png.latex?%0AU(x)=%5Cfrac%7Bx%5E2%7D%7B2%7D+%5Cfrac%7Bx%5E4%7D%7B4%7D%0A"> に従って運動する場合を考えましょう：</p>
<div id="fig-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://162348.github.io/posts/2024/Computation/Files/potential.svg" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;1: ポテンシャル <img src="https://latex.codecogs.com/png.latex?U"> のプロット
</figcaption>
</figure>
</div>
<p>このポテンシャルに関する Boltzmann-Gibbs 分布 <img src="https://latex.codecogs.com/png.latex?%5Cpi%5C,%5Cpropto%5C,e%5E%7B-%5Cbeta%20U%7D"> は次のような形になります：<sup>5</sup></p>
<div id="fig-3" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://162348.github.io/posts/2024/Computation/Files/Gibbs.svg" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;2: ポテンシャル <img src="https://latex.codecogs.com/png.latex?U"> が定める Botlzmann-Gibbs 分布のプロット
</figcaption>
</figure>
</div>
<!--
```
\begin{tikzpicture}
\begin{axis}[
    axis lines = middle,
    axis line style={->},
    xlabel = $x$,
    ylabel = {$e^{-\beta U(x)}$},
    xlabel style={at={(ticklabel* cs:1)}, anchor=north west},
    ylabel style={at={(ticklabel* cs:1)}, anchor=south west},
    xmin=-1.2, xmax=1.2,
    ymin=0, ymax=1,
    xtick distance=1,
    ytick=\empty,
    grid=both,
    grid style={gray!30, dashed},
    minor tick num=1,
    width=10cm,
    height=8cm,
    legend pos=north east,
    legend cell align=left,
    legend style={fill=white, fill opacity=0.8, draw opacity=1, text opacity=1, font=\small},
]
\addplot[domain=-2:2, samples=100, smooth, thick, minty] {exp(-x^2 - x^4)};
\addlegendentry{$y = e^{-\frac{U(x)}{kT}}$}
\end{axis}
\end{tikzpicture}
```
-->
<p>２つのプロットを見比べると，低エネルギー状態ほど出現確率が高く，エネルギーが上がるにつれて急激に出現確率が下がることがわかります．以降，<img src="https://latex.codecogs.com/png.latex?%5Cbeta=1"> としましょう．<sup>6</sup></p>
<section id="sec-MD" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="sec-MD"><span class="header-section-number">2.1</span> 分子動力学法</h3>
<p>統計力学によれば，<img src="https://latex.codecogs.com/png.latex?%5Cbeta=1"> で定まる温度とポテンシャル <img src="https://latex.codecogs.com/png.latex?U"> を持つ Boltzmann-Gibbs 分布 <img src="https://latex.codecogs.com/png.latex?e%5E%7B-U%7D"> は，温度 <img src="https://latex.codecogs.com/png.latex?T=%5Cfrac%7B1%7D%7Bk_B%5Cbeta%7D"> を持つ熱浴に接している力学系を，長時間シミュレーションして時間平均を取ることでサンプリングできるはずです．</p>
<p>このように，力学に基づいて物理過程を数値シミュレーションをすることを通じてサンプリングを達成する方法を <a href="https://ja.wikipedia.org/wiki/%E5%88%86%E5%AD%90%E5%8B%95%E5%8A%9B%E5%AD%A6%E6%B3%95"><strong>分子動力学法</strong></a> といいます．</p>
<p>これを実際にやってみます．図 1 で定めたポテンシャルを持つ粒子を考えます．<sup>7</sup></p>
<p>続いてこれを温度 <img src="https://latex.codecogs.com/png.latex?T=%5Cfrac%7B1%7D%7Bk_B%5Cbeta%7D"> を持つ熱浴と相互作用させます．例えば，ポテンシャル 1 の <img src="https://latex.codecogs.com/png.latex?x=0"> の位置に半透性の壁を置き，確率 <img src="https://latex.codecogs.com/png.latex?1/2"> でこの温度 <img src="https://latex.codecogs.com/png.latex?T"> の壁の粒子と弾性衝突するとします．（残りの確率 <img src="https://latex.codecogs.com/png.latex?1/2"> では衝突せずに通過する）．</p>
<p>壁の粒子の速度は Maxwell の境界条件から与えられるものとすれば，次のようにして粒子の位置 <img src="https://latex.codecogs.com/png.latex?x"> がシミュレートできます：<sup>8</sup></p>
<div id="0dda1a40" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-2"></span>
<span id="cb1-3">np.random.seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2024</span>)</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> U(x):</span>
<span id="cb1-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> pi(x):</span>
<span id="cb1-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> np.exp(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>U(x))</span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> md(num_samples, initial_state, initial_velocity, timestep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>):</span>
<span id="cb1-12">    samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [initial_state]</span>
<span id="cb1-13">    current_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> initial_state</span>
<span id="cb1-14">    current_velocity <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> initial_velocity</span>
<span id="cb1-15">    current_time <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb1-16"></span>
<span id="cb1-17">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(num_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):</span>
<span id="cb1-18">        proposed_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> current_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> current_velocity <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> timestep</span>
<span id="cb1-19">        current_time <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> timestep</span>
<span id="cb1-20">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> current_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> proposed_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">and</span> np.random.rand() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>:</span>
<span id="cb1-21">            current_velocity <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sign(current_velocity) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sqrt(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.log(np.random.rand() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-7</span>))</span>
<span id="cb1-22">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb1-23">            current_velocity <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> current_velocity <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> ( current_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> current_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> ) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> timestep</span>
<span id="cb1-24">            current_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> proposed_state</span>
<span id="cb1-25">        samples.append(current_state)</span>
<span id="cb1-26"></span>
<span id="cb1-27">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> np.array(samples)</span>
<span id="cb1-28"></span>
<span id="cb1-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># サンプル数と初期条件を固定</span></span>
<span id="cb1-30">num_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span></span>
<span id="cb1-31">initial_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span></span>
<span id="cb1-32">initial_velocity <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span></span>
<span id="cb1-33"></span>
<span id="cb1-34">samples_MD <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> md(num_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, initial_state, initial_velocity, timestep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>)</span></code></pre></div>
</details>
</div>
<div id="cell-fig-MD" class="cell" data-execution_count="3">
<div class="cell-output cell-output-display">
<div id="fig-md" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-md-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://162348.github.io/posts/2024/Computation/MCMC_files/figure-html/fig-md-output-1.png" width="310" height="263" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-md-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;3: 分子動力学法からのサンプル
</figcaption>
</figure>
</div>
</div>
</div>
<p>この方法は極めて収束が遅く，イテレーション数を <img src="https://latex.codecogs.com/png.latex?10%5E6"> 以上に取らないと目標分布 <img src="https://latex.codecogs.com/png.latex?e%5E%7B-U%7D"> の良い近似とならないことを思い知りました（上図も <img src="https://latex.codecogs.com/png.latex?10%5E6"> サンプルで生成しています）．なお，以降の MCMC 法ではいずれもイテレーション数は一桁少ない <img src="https://latex.codecogs.com/png.latex?10%5E5"> としています．</p>
<div id="fc556262" class="cell" data-execution_count="4">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/Computation/MCMC_files/figure-html/cell-5-output-1.png" width="329" height="287" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>たしかに，目標分布 <img src="https://latex.codecogs.com/png.latex?e%5E%7B-U%7D"> に収束しそうですね．</p>
</section>
<section id="sec-MH" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="sec-MH"><span class="header-section-number">2.2</span> Metropolis 法</h3>
<p>もちろん，分布 <img src="https://latex.codecogs.com/png.latex?e%5E%7B-U%7D"> をサンプリングするために，必ずしも背景にある物理過程まで戻ってシミュレーションをする必要はありません．</p>
<p>そこで，シミュレーションは簡単なランダムウォークで行い，その結果を適切に修正することで目標分布に収束させる方法が <span class="citation" data-cites="Metropolis+1953">(Metropolis et al., 1953)</span> で考えられました．</p>
<p><span class="citation" data-cites="Metropolis+1953">(Metropolis et al., 1953)</span> の手法は，現在では random walk Metropolis-Hastings 法と呼ばれます．</p>
<p>この背後の物理現象から離陸する一歩が，分子動力学法と MCMC 法とを分けるものでした．</p>
<div id="c0c7617a" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> metropolis(num_samples, initial_state, verbose<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>):</span>
<span id="cb2-2">    samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [initial_state]</span>
<span id="cb2-3">    current_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> initial_state</span>
<span id="cb2-4"></span>
<span id="cb2-5">    accept <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb2-6"></span>
<span id="cb2-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(num_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):</span>
<span id="cb2-8">        proposed_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> current_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> np.random.uniform(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb2-9">        acceptance_ratio <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pi(proposed_state) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> pi(current_state)</span>
<span id="cb2-10">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> np.random.rand() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> acceptance_ratio:</span>
<span id="cb2-11">            current_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> proposed_state</span>
<span id="cb2-12">            accept.append(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb2-13">        samples.append(current_state)</span>
<span id="cb2-14"></span>
<span id="cb2-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> verbose:</span>
<span id="cb2-16">        rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(accept) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> num_samples</span>
<span id="cb2-17">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'acceptance rate : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>rate<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb2-18"></span>
<span id="cb2-19">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> np.array(samples)</span></code></pre></div>
</details>
</div>
<div id="cell-fig-MH" class="cell" data-execution_count="6">
<div class="cell-output cell-output-display">
<div id="fig-mh" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mh-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://162348.github.io/posts/2024/Computation/MCMC_files/figure-html/fig-mh-output-1.png" width="310" height="266" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mh-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;4: Metropolis 法からのサンプル
</figcaption>
</figure>
</div>
</div>
</div>
<p>サンプル数は分子動力学法の <img src="https://latex.codecogs.com/png.latex?1/10"> であるにも拘らず，目標分布 <img src="https://latex.codecogs.com/png.latex?e%5E%7B-U%7D"> の良い近似を得ています．</p>
<p>一般に，MCMC からのサンプルの質の良さは，<a href="https://ja.wikipedia.org/wiki/%E8%87%AA%E5%B7%B1%E7%9B%B8%E9%96%A2">自己相関関数</a> を見ることで評価できます．<sup>9</sup></p>
<p>Metropolis 法の自己相関関数を計算してみると，横軸の Lag が大きくなればなるほど Autocorrelation の値は小さくなっています．</p>
<div id="cell-fig-MH-auto" class="cell" data-execution_count="7">
<div class="cell-output cell-output-display">
<div id="fig-mh-auto" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mh-auto-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://162348.github.io/posts/2024/Computation/MCMC_files/figure-html/fig-mh-auto-output-1.png" width="328" height="302" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mh-auto-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;5: Metropolis 法の自己相関関数
</figcaption>
</figure>
</div>
</div>
</div>
<div id="cell-fig-1" class="cell" data-execution_count="8">
<div class="cell-output cell-output-display">
<div id="fig-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://162348.github.io/posts/2024/Computation/MCMC_files/figure-html/fig-1-output-1.png" width="324" height="302" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;6: Metropolis 法の軌跡
</figcaption>
</figure>
</div>
</div>
</div>
<p>上図は Metropolis 法で構成される Markov 連鎖の軌跡を表しています．行ったり来たりしているのがわかります．棄却率は５割弱です．<sup>10</sup></p>
</section>
<section id="統計学への応用" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="統計学への応用"><span class="header-section-number">2.3</span> 統計学への応用</h3>
<p>こうして MCMC が発明されれば，すぐにイノベーションとして理解されたかというとそうではありませんでした．</p>
<p>この Metropolis の手法が極めて賢いシミュレーション手法であることは一目瞭然でも，一般の確率分布からのサンプリングに使える汎用アルゴリズムになっているという抽象的な観点が得られるまでには時間を要しました．これを成し遂げたのが <span class="citation" data-cites="Hastings1970">(Hastings, 1970)</span> でした．<sup>11</sup></p>
<p>さらに，Hastings のこの結果も見過ごされたと言って良いでしょう．真にMCMC を統計学界隈に広め，現代におけるベイズ統計学の興隆の契機となったのは階層モデリングにおける Gibbs サンプリングの有用性を強調した <span class="citation" data-cites="Gelfand-Smith1990">(Gelfand &amp; Smith, 1990)</span> だと言われます．<sup>12</sup></p>
<p>当時，代替手法としては複雑な数値アルゴリズムしかなかったベイズ統計学において，MCMC は汎用的で実装も容易であることが周知され，ベイズ統計学が普及するきっかけとなりました．</p>
</section>
</section>
<section id="sec-LMH" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="sec-LMH"><span class="header-section-number">3</span> 非対称化への試み</h2>
<section id="対称性という制約" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="対称性という制約"><span class="header-section-number">3.1</span> 対称性という制約</h3>
<p>ここでもう一度 Metropolis 法の軌跡 図&nbsp;6 を見てみましょう．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/docs/posts/2024/Computation/MCMC_files/figure-html/fig-1-output-1.png" class="img-fluid figure-img" style="width:3.19444in"></p>
<figcaption>図&nbsp;6 Metropolis 法の軌跡</figcaption>
</figure>
</div>
<p>最初の 50 サンプルしか表示していませんから，運が悪いとうまく見つからないかもしれませんが，「一度歩んだルートを，その後すぐに逆に戻ってしまう」という事象が発生しやすいことが観察できますでしょうか？</p>
<p>これを <strong>対称性</strong> (reversibility) または <strong>可逆性</strong> と言います．</p>
<p>Metropolis 法は構成上，この対称性を持つことが必要ですが，対称であるが故に一箇所に長時間とどまってしまうことが多くなります．</p>
<p>その結果，対象分布が複雑で多峰性を持つ場合は，もっといろんなモード（峰）からもサンプリングをしてほしいのに，長時間１つの峰から離れられずにいることがあります．</p>
<p>コーヒーに砂糖を溶かすことを考えてみましょう．砂糖の粒が拡散するのに任せておくと，最終的には均一に溶けるでしょうが，莫大な時間がかかります．スプーンで混ぜるなどして，砂糖が元の場所にとどまらずに移動し続けるようにすれば，はるかに速く平衡状態に到達できるでしょう．</p>
<p>これが <strong>非対称化</strong> のアイデアです．数ある Metropolis 法の改良の方向の中でも，この対称性を破るという試みは特に注目されてきました．</p>
</section>
<section id="リフティング" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="リフティング"><span class="header-section-number">3.2</span> リフティング</h3>
<p>Metropolis 法を非対称化するアプローチに，<strong>リフティング</strong> <span class="citation" data-cites="Chen+1999">(Chen et al., 1999)</span> と呼ばれる方法があります．</p>
<p>これは，元々の状態空間を２つの「モード」<img src="https://latex.codecogs.com/png.latex?+1"> と <img src="https://latex.codecogs.com/png.latex?-1"> に分裂させ，<img src="https://latex.codecogs.com/png.latex?+1"> のモードではひたすら右側に，<img src="https://latex.codecogs.com/png.latex?-1"> のモードではひたすら左側に移動するようする方法です．</p>
<p>２つのモード <img src="https://latex.codecogs.com/png.latex?+1,-1"> の間を遷移する確率を調整することで，最終的な不変分布は変わらないようにすることができます．</p>
<p>こうすることで，対称性を破り，一度「この方向に行く！」と決めたら行き続けるようにしながら，収束先は変わらないように変更することが出来るのです．</p>
<p>実際に Metropolis 法に適用した Lifted Metropolis-Hastings 法 <span class="citation" data-cites="Turitsyn+2011">(Turitsyn et al., 2011)</span> を実装してみましょう：</p>
<div id="e6bb3df8" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> lifted_metropolis(num_samples, initial_state, verbose<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>):</span>
<span id="cb3-2">    samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [initial_state]</span>
<span id="cb3-3">    current_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> initial_state</span>
<span id="cb3-4">    lifting_variable <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb3-5">    accept <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb3-6"></span>
<span id="cb3-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(num_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):</span>
<span id="cb3-8">        delta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.uniform(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb3-9">        proposed_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> current_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> lifting_variable <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> delta</span>
<span id="cb3-10">        acceptance_ratio <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pi(proposed_state) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> pi(current_state)</span>
<span id="cb3-11"></span>
<span id="cb3-12">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> np.random.rand() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> acceptance_ratio:</span>
<span id="cb3-13">            current_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> proposed_state</span>
<span id="cb3-14">            accept.append(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb3-15">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb3-16">            lifting_variable <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> lifting_variable</span>
<span id="cb3-17"></span>
<span id="cb3-18">        samples.append(current_state)</span>
<span id="cb3-19">    </span>
<span id="cb3-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> verbose:</span>
<span id="cb3-21">        rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(accept) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> num_samples</span>
<span id="cb3-22">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'acceptance rate : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>rate<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb3-23"></span>
<span id="cb3-24">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> np.array(samples)</span></code></pre></div>
</details>
</div>
<p>新しく追加されたリフティング変数 <img src="https://latex.codecogs.com/png.latex?%5Csigma%5Cin%5C%7B%5Cpm1%5C%7D"> に依存して，<img src="https://latex.codecogs.com/png.latex?%5Csigma=+1"> の場合には右方向に，<img src="https://latex.codecogs.com/png.latex?%5Csigma=-1"> の場合は左方向にしか提案を出さない MH 法と見れます．</p>
<div id="cell-fig-LMH" class="cell" data-execution_count="10">
<div class="cell-output cell-output-display">
<div id="fig-lmh" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lmh-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://162348.github.io/posts/2024/Computation/MCMC_files/figure-html/fig-lmh-output-1.png" width="310" height="267" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lmh-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;7: 非対称 Metropolis 法からのサンプル
</figcaption>
</figure>
</div>
</div>
</div>
<div id="cell-fig-LMH-auto" class="cell" data-execution_count="11">
<div class="cell-output cell-output-display">
<div id="fig-lmh-auto" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lmh-auto-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://162348.github.io/posts/2024/Computation/MCMC_files/figure-html/fig-lmh-auto-output-1.png" width="340" height="302" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lmh-auto-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;8: 非対称 Metropolis 法の自己相関関数
</figcaption>
</figure>
</div>
</div>
</div>
<p>自己相関関数を見ると，Metropolis 法よりも急速に減衰していることがわかります．むしろ，過減衰のように自己相関関数が負になっていることもあります．</p>
<p>これは，一度「この方向に行く！」と決めたら行き続けるように設計したために，正の値が出たしばらくあとは負の値が，負の値が出たしばらくあとは正の値が出やすいようになってしまっているためです．</p>
<p>したがってこれは１次元の分布を考えていることに起因するため，殊更問題とすべきではないでしょう．</p>
<div id="cell-fig-4" class="cell" data-execution_count="12">
<div class="cell-output cell-output-display">
<div id="fig-4" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://162348.github.io/posts/2024/Computation/MCMC_files/figure-html/fig-4-output-1.png" width="324" height="302" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;9: 非対称 Metropolis 法の軌跡
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="リフティングの有用性" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="リフティングの有用性"><span class="header-section-number">3.3</span> リフティングの有用性</h3>
<p>今回のような単純なポテンシャル <img src="https://latex.codecogs.com/png.latex?U"> （図&nbsp;1） だけでなく，統計力学における磁性体のモデルである Curie-Weiss モデルのハミルトニアン</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AH_n(x)=-%5Cfrac%7Bd%5Cbeta%7D%7B2n%7D%5Csum_%7Bi,j=1%7D%5Enx_ix_j-h%5Csum_%7Bi=1%7D%5Enx_i,%0A"> <img src="https://latex.codecogs.com/png.latex?%0Ah%5Cin%5Cmathbb%7BR%7D,x%5Cin%5C%7B%5Cpm1%5C%7D%5En,%5Cquad%20n,d=1,2,%5Ccdots%0A"></p>
<p>が定める Boltzmann-Gibbs 分布 <img src="https://latex.codecogs.com/png.latex?e%5E%7B-H%7D"> に対する Lifted Metropolis-Hastings も，単純な Metropolis-Hastings 法よりも効率的であることが知られています．<sup>13</sup></p>
<p>具体的には，モデルのパラメータ数 <img src="https://latex.codecogs.com/png.latex?n"> に対して，緩和時間を <img src="https://latex.codecogs.com/png.latex?%5Csqrt%7Bn%7D"> のオーダーだけ改善することが，<span class="citation" data-cites="Turitsyn+2011">(Turitsyn et al., 2011)</span> では数値実験で，<span class="citation" data-cites="Bierkens-Roberts2017">(Bierkens &amp; Roberts, 2017)</span> では理論的に検証されているのです．</p>
<!--

### HMC

Hamiltonian Monte Carlo 法も一種のリフティングと見ることができ，

-->
</section>
</section>
<section id="sec-PDMP" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="sec-PDMP"><span class="header-section-number">4</span> 新たな MCMC</h2>
<!--

こうして MCMC は物理学者から物質科学者，そして統計学者から機械学習家まで，多くの人が幅広く用いる手法になりました．

その結果，多くの同一の手法が違う名前で呼ばれていることも多く，現状の最先端ではどのようなことが起こっているのか見極めるのが困難です．

ここでは，上述のすべての分野に渡って共通して起こりつつある大きな地殻変動を紹介します．キーワードは **連続時間 MCMC** です．^[[@Fearnhead+2018-PDMC] から取った用語です．コンピュータシミュレーションである以上，結局は離散化するのですが，粒子の動きは（従来の Metropolis-Hastings 法のような）Markov 連鎖であるというより，連続時間確率過程のような動きをする手法群であることには間違いありません．]

-->
<section id="背後の物理現象からの更なる離陸" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="背後の物理現象からの更なる離陸"><span class="header-section-number">4.1</span> 背後の物理現象からの更なる離陸</h3>
<p>第 2 章で，分子動力学法（第 2.1 節）から，提案分布を背後の物理現象とは全く関係ないランダムウォークとすることで，Metropolis 法（第 2.2 節）は一気に効率的なサンプリング法となったことを見ました．</p>
<p>しかし，Metropolis 法はまだ思考が物理に引っ張られているのかも知れません．平衡統計力学において，ミクロの状態は等価で，ミクロなダイナミクスは可逆と考えられます．その前提が，知らず知らずのうちにまだ埋め込まれたままだと言えるでしょう．</p>
<p>そこで，スプーンでかき混ぜるように，遷移を非対称にすることで，より効率的なサンプリング法となることを前章 3 で見ました．</p>
<p>ここでは，さらに暗黙の思い込みから解き放たれようとします．それは，<strong>シミュレーションするにあたって，必ずしも離散時間ステップに囚われる必要はない</strong> ということです．</p>
<p>もう一度，Lifted Metropolis-Hastings 法の軌跡を見てみましょう：</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/docs/posts/2024/Computation/MCMC_files/figure-html/fig-4-output-1.png" class="img-fluid figure-img" style="width:3.19444in"></p>
<figcaption>図&nbsp;9 非対称 Metropolis 法の軌跡</figcaption>
</figure>
</div>
<p>この軌跡から得られる情報のほとんどは，「どこで折り返したか？」です．</p>
<p>ですから，この軌跡をシミュレーションするにあたって，一歩一歩採択-棄却のステップを繰り返す必要はなく，「どこで折り返すか？」を先に計算できてしまえば，あとは好きなステップサイズで切り出してサンプルとすれば良いのです．</p>
<p>実は，「折り返す地点だけを効率的に計算する」ことが可能であり，それが <strong>連続時間 MCMC</strong> のアイデアです．</p>
</section>
<section id="連続時間-mcmc" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="連続時間-mcmc"><span class="header-section-number">4.2</span> 連続時間 MCMC</h3>
<p>Lifted Metropolis-Hastings の適切な連続時間極限 <img src="https://latex.codecogs.com/png.latex?%5CDelta%20t%5Cto0"> を考えることで，「折り返す」という事象（が起こった回数）は Poisson 過程に従うことが導けます．</p>
<p>すると，「折り返す」事象が起こるまでの待ち時間 (interarrival time) は指数分布に従うことがわかります．これに基づいて，「折り返す」事象が起こる時刻を計算し，そこまでの軌跡を直線で補間すれば，Lifted Metropolis-Hastings 法（の連続時間極限）の軌跡が模倣できることになります．</p>
<p>最終的に得られる過程は，ランダムな時刻に「折り返す」事象が起こり，その間は確定的な動き（等速直線運動）をするというもので，このような過程を <strong>区分確定的 Markov 過程</strong> (PDMP: Piecewise Deterministic Markov Process) と呼びます．</p>
<p>このような PDMP は，Lifted Metropolis-Hastings 以外にも種々の MCMC 法の極限から見つかっており，その中でも特に有名なのが次の <strong>Zig-Zag sampler</strong> です：</p>
<div id="e92a1c43" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> math</span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> zigzag(num_samples, initial_state, step<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):</span>
<span id="cb4-4">    samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [initial_state]</span>
<span id="cb4-5">    trajectory <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [initial_state]</span>
<span id="cb4-6">    current_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> initial_state</span>
<span id="cb4-7">    lifting_variable <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb4-8">    t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb4-9"></span>
<span id="cb4-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span> t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> num_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> step:</span>
<span id="cb4-11">        state_event <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> lifting_variable <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sqrt(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> np.sqrt( <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.log(np.random.rand()) ))</span>
<span id="cb4-12">        t_event <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(state_event <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> current_state)</span>
<span id="cb4-13">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> np.arange(np.ceil(t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>step)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>step, np.ceil(t_event<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>step)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>step, step):</span>
<span id="cb4-14">              samples.append(current_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> lifting_variable <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t))</span>
<span id="cb4-15">        current_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state_event</span>
<span id="cb4-16">        trajectory.append(current_state)</span>
<span id="cb4-17">        lifting_variable <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> lifting_variable</span>
<span id="cb4-18">        t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> t_event</span>
<span id="cb4-19"></span>
<span id="cb4-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> np.array(samples), np.array(trajectory)</span></code></pre></div>
</details>
</div>
<!--
自己相関関数こんなに spiky になるっけ？
いや，多分この設定だと zig-zag は普通に悪いんだろうな．
棄却率が高くて７割くらいある LMH に負けるのが「正しい」のかも知れない．

そして１次元なのに等間隔でサンプリングしているから，自己相関関数は sine curve に（むしろ）なるべきなのか！
-->
<div id="cell-fig-PDMP" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">samples_zigzag, trajectory_zigzag <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> zigzag(num_samples, initial_state, step<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb5-2">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span>
<span id="cb5-3">plt.hist(samples_zigzag, bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>minty)</span>
<span id="cb5-4">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-pdmp" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pdmp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://162348.github.io/posts/2024/Computation/MCMC_files/figure-html/fig-pdmp-output-1.png" width="310" height="263" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pdmp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;10: Zig-Zag サンプラーからのサンプル
</figcaption>
</figure>
</div>
</div>
</div>
<div id="cell-fig-PDMP-auto" class="cell" data-execution_count="15">
<div class="cell-output cell-output-display">
<div id="fig-pdmp-auto" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pdmp-auto-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://162348.github.io/posts/2024/Computation/MCMC_files/figure-html/fig-pdmp-auto-output-1.png" width="340" height="302" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pdmp-auto-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;11: Zig-Zag サンプラーの自己相関関数
</figcaption>
</figure>
</div>
</div>
</div>
<p>自己相関関数は，Lifted Metropolis-Hastings 法と同様に急激に下がって負の値に突き抜けたあとは，少し振動が残っているのがわかります．</p>
<p>全３サンプラーの比較は第 1.3 節をご覧ください．</p>
<p>次の軌跡を見て分かる通り，モードである <img src="https://latex.codecogs.com/png.latex?x=0"> を中心に激しく往復するので，直後のサンプルとは負の相関が出やすいようです．</p>
<div id="cell-fig-6" class="cell" data-execution_count="16">
<div class="cell-output cell-output-display">
<div id="fig-6" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://162348.github.io/posts/2024/Computation/MCMC_files/figure-html/fig-6-output-1.png" width="328" height="302" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;12: Zig-Zag サンプラーの軌跡
</figcaption>
</figure>
</div>
</div>
</div>
<p>連続時間極限 <img src="https://latex.codecogs.com/png.latex?%5CDelta%20t%5Cto0"> をとっているということは，「極めて小さいステップサイズでの random walk Metropolis 法（第 2.2 節）」に相当します．従って，一度折り返したら，原点 <img src="https://latex.codecogs.com/png.latex?x=0"> を超えるまでは絶対に棄却されません．</p>
<p>そのため，このように往復するような軌跡が得られます．</p>
</section>
<section id="sec-PDMP-advantages" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="sec-PDMP-advantages"><span class="header-section-number">4.3</span> 連続時間 MCMC の美点</h3>
<p>前節では，必ずしも PDMP 法である Zig-Zag sampler が，Lifted Metropolis-Hastings 法より，自己相関関数の観点で良いとは言い切れないことを見ました．</p>
<p>しかし，今回の設定は１次元という特殊な条件下であることを考慮に入れる必要があります．</p>
<p>１次元なので Zig-Zag サンプラーは行き来することしか出来ていませんが，<sup>14</sup> ２次元以上，特に高次元の場合は，Zig-Zag サンプラーは極めて効率的に状態空間を探索できることが期待されます．</p>
<p>例えば，標準正規分布に対する２次元での軌跡は次の通りです：</p>
<div id="fig-5" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://162348.github.io/posts/2024/Computation/Files/ZigZag_2d.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;13: Zig-Zag Sampler in <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5E2">
</figcaption>
</figure>
</div>
<p>そして何より，軌道が効率的な空間の探索に有利であるだけでなく，正確なサブサンプリングを取り入れることが可能です．すなわち，ほとんどの他手法と違って，<strong>バイアスを導入することなく</strong>，データの一部のみを用いてアルゴリズムを走らせることができます．</p>
<p>したがって，従来の MCMC 法が採択-棄却のステップにおいて尤度を評価する必要があり，データサイズ <img src="https://latex.codecogs.com/png.latex?n"> に対して <img src="https://latex.codecogs.com/png.latex?O(n)"> の計算量を要するのに対して，<img src="https://latex.codecogs.com/png.latex?O(n)"> に比例する焼き入れのステップを除けば，<img src="https://latex.codecogs.com/png.latex?O(1)"> の複雑でほとんど i.i.d. なサンプルを得ることができます <span class="citation" data-cites="Bierkens+2019">(Bierkens et al., 2019)</span>．</p>
<!-- 

### 筆者の目標：新時代のサンプラーの開発

情報通信機器の発達によりデータが複雑で大規模化する現代では，モデルも同様に大規模で複雑化していく必要があります．OpenAI の ChatGPT や Sora，Anthropic の Claude-3 などの **基盤モデル** はその象徴と言えるでしょう．

筆者は，その中で **新時代の MCMC** の開発を目標としています．

高次元空間上の複雑な分布からも効率的にサンプリングできる MCMC 手法が開発された際には，多くの人が自分のノートパソコンで気軽にできるベイズ統計分析の幅が大きく広がることでしょう．

それこそ，ニューラルネットワークの表現力をフルに活用するだけでなく，ベイズ手法の強みも併せて，小規模データでも鮮やかな分析が簡単に出来るようになるかもしれません．

そのような世界線こそ，AI 技術の民主化と呼ぶにふさわしい，来るべき未来だと筆者は信じています．

また，基盤モデルの Bayes 的な理解を進めることも，実は壮大ながらも，筆者の最終的な目標の一つであります．

-->
</section>
</section>




<div id="quarto-appendix" class="default"><section id="終わりに" class="level2 appendix" data-number="5"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">5</span> 終わりに</h2><div class="quarto-appendix-contents">

<p>こうみると，MCMC は物理学の問題意識から生まれた手法でありながら，背後の物理現象を模倣することから離れていくことで，計算手法としての効率を高めていく一途を辿っていることがわかります．</p>
<p>そう見ると，新時代の大規模データと大規模モデルが課す MCMC の次なる脱皮は，連続時間 MCMC で間違いないような気がしてくるのですが……．まだ筆者にははっきりとは見えてきません．</p>
<p>また本稿では１つの流れしか取り上げておらず，例えば HMC とその非対称化がどのような位置づけにあるかもまだ考慮中です．</p>
<p>統計力学，統計学，機械学習が交差するなんとも面白いテーマです．</p>


</div></section><section id="執筆のきっかけ" class="level3 appendix" data-number="5.1"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">5.1</span> 執筆のきっかけ</h2><div class="quarto-appendix-contents">

<p>本ポスター，そして本解説記事の執筆のきっかけは，<a href="../../../posts/2024/Particles/PF.html">MLSS でのポスター発表</a> で連続時間 MCMC のことが機械学習の界隈では全く知られていないことを知ったことと，情報統計力学の研究集会に出席し，連続時間 MCMC が物理学の方からも研究されていることを知ったことでした．</p>
<p>統計界隈では（本稿で解説しました通り） PDMP や連続時間 MCMC と呼ばれる手法は，物理学界隈では event-based simulation，rejection-free と呼ばれる手法群の１つとして活発に研究されていました．</p>
<p>全く同じ問題を解こうとしているのに，用語法が全く異なることに驚かされました．</p>
<p>２つの分野の相互理解と知見の交換が進むことを目指し，これからも研究していきたいと考えます．</p>
</div></section><section id="アルゴリズムのステップサイズについて" class="level3 appendix" data-number="5.2"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">5.2</span> アルゴリズムのステップサイズについて</h2><div class="quarto-appendix-contents">

<p>コードからわかります通り，提案分布のスケールは次のようになっています：</p>
<div class="table-responsive-sm">
<table class="table-striped table-hover table">
<caption>３手法のスケーリング</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">手法</th>
<th style="text-align: center;">提案分布</th>
<th style="text-align: center;">平均移動距離<sup>15</sup></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">MH</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BU%7D(%5B-2,2%5D)"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?1"></td>
</tr>
<tr class="even">
<td style="text-align: center;">LMH</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BU%7D(%5B0,2%5D)"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?1"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Zig-Zag</td>
<td style="text-align: center;">なし</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?2"></td>
</tr>
</tbody>
</table>
</div>
<p>ですので，平均した隣接（提案）サンプル間距離について，Zig-Zag サンプラーはズルをしているともいえます．</p>
<p>しかし，必ずしもアンフェアな比較をしていたわけではありません．</p>
<p>もし，３手法で計算量を揃えるならば，Zig-Zag サンプラーにとっての１回のループは方向転換をするまでであり，２つの方向転換の間の平均距離はだいたい <img src="https://latex.codecogs.com/png.latex?1.93"> になります．</p>
<div id="3042cdc3" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">diffs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.diff(trajectory_zigzag)</span>
<span id="cb6-2">abs_diffs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(diffs)</span>
<span id="cb6-3">mean_abs_diff <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.mean(abs_diffs)</span>
<span id="cb6-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(mean_abs_diff)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1.9232887144203465</code></pre>
</div>
</div>
<p>MH, LMH については，ほとんど最適なスケーリングになるように調節してありますが，Zig-Zag サンプラーにおいては最適なスケーリングという概念は存在しません．あらかじめ 図&nbsp;12 の軌跡があり，どれくらい距離を空けてサンプルとするか，という問題しかありません．</p>
<p>ここでは，アルゴリズムのループ１回が１回のサンプリングになるように，３つの手法を揃えて比較の根拠としました．</p>
<p>なお，このように，Zig-Zag サンプラーなどの連続時間 MCMC と，従来の離散時間 MCMC の直接の性能比較は，微妙な問題が多く，筆者もまだ十分に説明できる準備はありません．</p>
<p>しかし，次年度以降のオープンハウスで，より詳細な解説を行う予定です．</p>
<div id="940996f5" class="cell" data-execution_count="18">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/Computation/MCMC_files/figure-html/cell-19-output-1.png" width="574" height="278" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Zig-Zag サンプラーのサンプリングステップを <img src="https://latex.codecogs.com/png.latex?1"> や <img src="https://latex.codecogs.com/png.latex?1.5"> にすると，たしかに自己相関は悪化します．</p>
</div></section><section id="参考文献" class="level2 appendix" data-number="6"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">6</span> 参考文献</h2><div class="quarto-appendix-contents">

<p>本稿では，用いたコードの導出を一切触れませんでした．これについては，文献 <span class="citation" data-cites="Tartero-Krauth2023">(Tartero &amp; Krauth, 2023)</span> をご参照ください．非調和振動子を系にとり，正準集団とみなすことで，分子動力学法，メトロポリス法からそのリフティングまで，種々のサンプラーを同じ題材で比較するアイデアをもらいました．こんなにわかりやすい解析ができるのかと心底驚きました．</p>
<p>続いて，Metropolis-Hastings 法 → 非対称 MCMC → 連続時間 MCMC という発展の過程を，背後の物理過程の模倣からの離陸という視点で統一的に捉えることが出来るということは，<span class="citation" data-cites="Turitsyn+2011">(Turitsyn et al., 2011)</span> の魅力的なイントロダクションで気付かされました．本文献はリフティングによる MCMC の非可逆化を抽象的に定式化して数値実験で検証したものであり，「ねじれ詳細釣り合い条件」を導入した点で，アイデアの宝庫といえます．</p>
<p>リフティングによる Metropolis 法の非対称化について，<span class="citation" data-cites="酒井佑士2017">(酒井佑士, 2017)</span> は貴重な日本語文献です．当該文献の第３章（の第２節）にここで紹介した内容が詳しくまとめられています．</p>
<p>第 4.3 節で紹介しましたように，Zig-Zag サンプラーを用いたサンプリングではそのスケーラビリティが魅力です．この点については，Zig-Zag サンプラーが提案された論文 <span class="citation" data-cites="Bierkens+2019">(Bierkens et al., 2019)</span> でも，前面に押し出して解説されています．</p>



</div></section><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-Bierkens+2019" class="csl-entry">
Bierkens, J., Fearnhead, P., &amp; Roberts, G. (2019). <span class="nocase">The Zig-Zag Process and Super-Efficient Sampling for Bayesian Analysis of Big Data</span>. <em>The Annals of Statistics</em>, <em>47</em>(3), 1288–1320. <a href="https://doi.org/10.1214/18-AOS1715">https://doi.org/10.1214/18-AOS1715</a>
</div>
<div id="ref-Bierkens-Roberts2017" class="csl-entry">
Bierkens, J., &amp; Roberts, G. (2017). <span class="nocase">A Piecewise Deterministic Scaling Limit of Lifted Metropolis-Hastings in the Curie-Weiss Model</span>. <em>The Annals of Applied Probability</em>, <em>27</em>(2), 846–882. <a href="http://www.jstor.org/stable/44249153">http://www.jstor.org/stable/44249153</a>
</div>
<div id="ref-Chen+1999" class="csl-entry">
Chen, F., Lovász, L., &amp; Pak, I. (1999). Lifting markov chains to speed up mixing. <em>Proceedings of the Thirty-First Annual ACM Symposium on Theory of Computing</em>, 275–281. <a href="https://doi.org/10.1145/301250.301315">https://doi.org/10.1145/301250.301315</a>
</div>
<div id="ref-Duane+1987" class="csl-entry">
Duane, S., Kennedy, A. D., Pendleton, B. J., &amp; Roweth, D. (1987). Hybrid monte carlo. <em>Physics Letters B</em>, <em>195</em>(2), 216–222. <a href="https://doi.org/10.1016/0370-2693(87)91197-X">https://doi.org/10.1016/0370-2693(87)91197-X</a>
</div>
<div id="ref-Gelfand-Smith1990" class="csl-entry">
Gelfand, A. E., &amp; Smith, A. F. M. (1990). Sampling-based approaches to calculating marginal densities. <em>Journal of the American Statistical Association</em>, <em>85</em>(410), 398–409. <a href="https://doi.org/10.2307/2289776">https://doi.org/10.2307/2289776</a>
</div>
<div id="ref-Gelman+1996" class="csl-entry">
Gelman, A., Roberts, G. O., &amp; Gilks, W. R. (1996). <span>Efficient Metropolis Jumping Rules</span>. In <em><span class="nocase">Bayesian Statistics 5: Proceedings of the Fifth Valencia International Meeting</span></em>. Oxford University Press. <a href="https://doi.org/10.1093/oso/9780198523567.003.0038">https://doi.org/10.1093/oso/9780198523567.003.0038</a>
</div>
<div id="ref-Hastings1970" class="csl-entry">
Hastings, W. K. (1970). Monte carlo sampling methods using markov chains and their applications. <em>Biometrika</em>, <em>57</em>(1), 97–109. <a href="https://www.jstor.org/stable/2334940">https://www.jstor.org/stable/2334940</a>
</div>
<div id="ref-Martin+2023-history" class="csl-entry">
Martin, G. M., Fraizier, D. T., &amp; Robert, C. P. (2023). Computing bayes: From then ‘til now. <em>Statistical Science</em>, <em>Advanced Publication</em>, 1–17.
</div>
<div id="ref-Metropolis+1953" class="csl-entry">
Metropolis, N., Rosenbluth, A. W., Rosenbluth, M. N., Teller, A. H., &amp; Teller, E. (1953). Equation of state calculations by fast computing machines. <em>The Journal of Chemical Physics</em>, <em>21</em>(6), 1087–1092. <a href="https://doi.org/10.1063/1.1699114">https://doi.org/10.1063/1.1699114</a>
</div>
<div id="ref-Neal1994" class="csl-entry">
Neal, R. M. (1994). An improved acceptance procedure for the hybrid monte carlo algorithm. <em>Journal of Computational Physics</em>, <em>111</em>(1), 194–203. <a href="https://doi.org/10.1006/jcph.1994.1054">https://doi.org/10.1006/jcph.1994.1054</a>
</div>
<div id="ref-Neal2011-HMC" class="csl-entry">
Neal, R. M. (2011). (S. Brooks, A. Gelman, G. Jones, &amp; X.-L. Meng, Eds.; pp. 113–162). Chapman; Hall/CRC. <a href="https://www.taylorfrancis.com/chapters/edit/10.1201/b10905-6/mcmc-using-hamiltonian-dynamics-radford-neal">https://www.taylorfrancis.com/chapters/edit/10.1201/b10905-6/mcmc-using-hamiltonian-dynamics-radford-neal</a>
</div>
<div id="ref-Peters-deWith2012" class="csl-entry">
Peters, E. A. J. F., &amp; de&nbsp;With, G. (2012). Rejection-free monte carlo sampling for general potentials. <em>Physical Review E</em>, <em>85</em>(2). <a href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.85.026703">https://journals.aps.org/pre/abstract/10.1103/PhysRevE.85.026703</a>
</div>
<div id="ref-Robert-Casella2011" class="csl-entry">
Robert, C., &amp; Casella, G. (2011). A short history of markov chain monte carlo: Subjective recollections from incomplete data. <em>Statistical Science</em>, <em>26</em>(1), 102–115. <a href="http://www.jstor.org/stable/23059158">http://www.jstor.org/stable/23059158</a>
</div>
<div id="ref-Roberts+1997" class="csl-entry">
Roberts, G. O., Gelman, A., &amp; Gilks, W. R. (1997). <span class="nocase">Weak Convergence and Optimal Scaling of Random Walk Metropolis Algorithms</span>. <em>The Annals of Applied Probability</em>, <em>7</em>(1), 110–120. <a href="http://www.jstor.org/stable/2245134">http://www.jstor.org/stable/2245134</a>
</div>
<div id="ref-Tartero-Krauth2023" class="csl-entry">
Tartero, G., &amp; Krauth, W. (2023). <em>Concepts in monte carlo sampling</em>. <a href="https://arxiv.org/abs/2309.03136">https://arxiv.org/abs/2309.03136</a>
</div>
<div id="ref-Turitsyn+2011" class="csl-entry">
Turitsyn, K. S., Chertkov, M., &amp; Vucelja, M. (2011). <span class="nocase">Irreversible Monte Carlo algorithms for Efficient Sampling</span>. <em>Physica D-Nonlinear Phenomena</em>, <em>240</em>(5-Apr), 410–414. <a href="https://doi.org/10.1016/j.physd.2010.10.003">https://doi.org/10.1016/j.physd.2010.10.003</a>
</div>
<div id="ref-Vasdekis-Roberts2022" class="csl-entry">
Vasdekis, G., &amp; Roberts, G. O. (2022). A note on the polynomial ergodicity of the one-dimensional zig-zag process. <em>Journal of Applied Probability</em>, <em>59</em>(3), 895–903. <a href="https://doi.org/10.1017/jpr.2021.97">https://doi.org/10.1017/jpr.2021.97</a>
</div>
<div id="ref-酒井佑士2017" class="csl-entry">
酒井佑士. (2017). <em>マルコフ連鎖モンテカルロ法における詳細つり合い条件の破れの効果と応用</em> [PhD thesis, 東京大学]. <a href="https://repository.dl.itc.u-tokyo.ac.jp/records/50422">https://repository.dl.itc.u-tokyo.ac.jp/records/50422</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Hamiltonian Monte Carlo の名称は <span class="citation" data-cites="Neal2011-HMC">(Neal, 2011)</span> からで，元々は Hybrid Monte Carlo と呼ばれていました．分子動力学法 (Molecular Dynamics) と MCMC のハイブリッド，という意味でした．Stan で実装されている MCMC アルゴリズムについては <a href="https://mc-stan.org/docs/reference-manual/mcmc.html">こちら</a> を参照．↩︎</p></li>
<li id="fn2"><p>特に収束が遅く，他の手法と比べてイテレーション数を 10　倍にしています．↩︎</p></li>
<li id="fn3"><p>統計学界隈では <span class="citation" data-cites="Hastings1970">(Hastings, 1970)</span> を入れて，Metropolis-Hastings 法とも呼ばれる．↩︎</p></li>
<li id="fn4"><p>ただし，配置 <img src="https://latex.codecogs.com/png.latex?%5Comega%5Cin%5COmega"> は空間内にランダム（一様）に粒子 <img src="https://latex.codecogs.com/png.latex?N"> 個を配置することで生成することとする．↩︎</p></li>
<li id="fn5"><p>１粒子系なので相互作用はなく，<img src="https://latex.codecogs.com/png.latex?E=U">．↩︎</p></li>
<li id="fn6"><p><img src="https://latex.codecogs.com/png.latex?%5Cbeta=1"> と約束することは，系の温度を <img src="https://latex.codecogs.com/png.latex?T=k_B%5E%7B-1%7D"> に固定することにあたります．↩︎</p></li>
<li id="fn7"><p>図 1 で定めたポテンシャルを持つ力学系には，代表的なものは（非調和）振動子や，あるいは <img src="https://latex.codecogs.com/png.latex?U"> の形をした谷を行ったり来たりするボールを考えても構いません．↩︎</p></li>
<li id="fn8"><p>詳しい議論は <span class="citation" data-cites="Tartero-Krauth2023">(Tartero &amp; Krauth, 2023)</span> をご参照ください．大変教育的な入門です．↩︎</p></li>
<li id="fn9"><p>自己相関関数が大きいほど，その Markov 連鎖を用いて構成した Monte Carlo 推定量の漸近分散が大きくなります．加えて，自己相関関数の裾が重すぎると，例えエルゴード性を持っており大数の法則が成り立とうとも，中心極限定理が成り立たなくなります．換言すれば，<img src="https://latex.codecogs.com/png.latex?n%5E%7B-1/2%7D"> よりも遅い収束レートになってしまいます．↩︎</p></li>
<li id="fn10"><p>一般には，ランダムウォーク MH 法において，採択率を <img src="https://latex.codecogs.com/png.latex?0.2%5Cle%5Calpha%5Cle0.4"> 前後に抑えるのが良いとされています <span class="citation" data-cites="Roberts+1997">(Roberts et al., 1997)</span>．これは状態空間の次元が無限に漸近する設定下での，漸近論的な結果ですが，低次元の場合でも極めて良い指標になることが <span class="citation" data-cites="Gelman+1996">(Gelman et al., 1996)</span> で実証されています．また今回も，１次元であるにも拘らず，たしかに棄却率が半分を越さないほうが，自己相関が小さくなる傾向が確認されました．しかし今回は対象分布の裾が極めて軽いので，あまり大きなムーブは要らず，ステップサイズの最大値を <img src="https://latex.codecogs.com/png.latex?2">，採択率は <img src="https://latex.codecogs.com/png.latex?0.5"> 近くにしました．他の手法，LMH と Zig-Zag もステップサイズの最大値が <img src="https://latex.codecogs.com/png.latex?2"> になるように統一しました．↩︎</p></li>
<li id="fn11"><p>“While <span class="citation" data-cites="Metropolis+1953">(Metropolis et al., 1953)</span> proposed the use of MCMC sampling to compute particular integrals in statistical mechanics, <strong>it was the Hastings paper that elevated the concept to a general one, and introduced it to the broader statistics community</strong>.” <span class="citation" data-cites="Martin+2023-history">(Martin et al., 2023, p. 7)</span> 3.5節．↩︎</p></li>
<li id="fn12"><p><span class="citation" data-cites="Martin+2023-history">(Martin et al., 2023, p. 8)</span> 4節，<span class="citation" data-cites="Robert-Casella2011">(Robert &amp; Casella, 2011, p. 102)</span> など．↩︎</p></li>
<li id="fn13"><p>ただし，<img src="https://latex.codecogs.com/png.latex?e%5E%7B-H%7D"> が多峰性を示す低温領域では，LMH の方が効率的であるというはっきりとした理論保証はまだありません．↩︎</p></li>
<li id="fn14"><p>今回は対象分布の減衰が極めて激しかったために差が現れにくかったのだと考えられます．Zig-Zag サンプラーは１次元でも，（広い設定の下で）（そして特に目標分布の裾が重いときに）ランダムウォーク・メトロポリス法や Metripolis-adjusted Langevin algorithm よりも速い収束レートを持ちます <span class="citation" data-cites="Vasdekis-Roberts2022">(Vasdekis &amp; Roberts, 2022)</span>，↩︎</p></li>
<li id="fn15"><p>提案分布の．実際の軌跡の１ステップでの移動距離とは違う．↩︎</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-copyright"><h2 class="anchored quarto-appendix-heading">Copyright</h2><div class="quarto-appendix-contents"><div>Copyright Hirofumi Shiba 2024. All Rights Reserved</div></div></section></div> ]]></description>
  <category>MCMC</category>
  <category>Simulation</category>
  <category>Poster</category>
  <guid>https://162348.github.io/posts/2024/Computation/MCMC.html</guid>
  <pubDate>Thu, 23 May 2024 15:00:00 GMT</pubDate>
  <media:content url="https://162348.github.io/static/Posters/ISM-OH2024.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>R によるベイズ混合モデリング入門</title>
  <dc:creator>司馬博文 </dc:creator>
  <link>https://162348.github.io/posts/2024/Computation/brms.html</link>
  <description><![CDATA[ 





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<div class="callout callout-style-simple callout-tip callout-titled" title="brms: Bayesian Regression Models using 'Stan' リンク集">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
brms: Bayesian Regression Models using ‘Stan’ リンク集
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="https://cran.r-project.org/web/packages/brms/">r-project</a></li>
<li><a href="https://paul-buerkner.github.io/brms/">Documentation</a></li>
<li><a href="https://github.com/paul-buerkner/brms">GitHub</a></li>
<li><a href="https://discourse.mc-stan.org/">discourse</a></li>
<li><span class="citation" data-cites="Burkner2017">(Bürkner, 2017)</span></li>
<li><span class="citation" data-cites="Burkner2018">(Bürkner, 2018)</span></li>
<li><span class="citation" data-cites="Burkner2021">(Bürkner, 2021)</span></li>
</ul>
</div>
</div>
<p>ダウンロードは：<sup>1</sup></p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"brms"</span>)</span></code></pre></div>
<section id="sec-example" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="sec-example"><span class="header-section-number">1</span> 例：カウントデータのモデリング</h2>
<p>Documentation で紹介されている，<a href="https://search.r-project.org/CRAN/refmans/dhglm/html/epilepsy.html"><code>Epilepsy Seizures Data</code></a> <span class="citation" data-cites="Leppik+1987">(Leppik et al., 1987)</span>，<span class="citation" data-cites="Thall-Vail1990">(Thall &amp; Vail, 1990)</span> を用いた <a href="https://paul-buerkner.github.io/brms/">例</a> を実行してみる：</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(brms)</span>
<span id="cb2-2">fit1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brm</span>(count <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> zAge <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> zBase <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Trt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span>patient),</span>
<span id="cb2-3">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> epilepsy, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">poisson</span>())</span></code></pre></div>
<p>てんかん (epilepsy) 患者の発作回数<code>count</code>を被説明変数とし，処置の効果を表す説明変数<code>Trt</code>と患者毎のランダムな切片項<code>(1|patient)</code>と<code>zAge</code>,<code>zBase</code>への依存構造を調べたい．被説明変数<code>count</code>のモデルとしては，Poisson 分布族を用いる．</p>
<div class="callout callout-style-simple callout-note callout-titled" title="説明変数">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
説明変数
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>zAge</code>：標準化された年齢</li>
<li><code>zBase</code>：ベースの発作回数</li>
<li><code>Trt</code>：治療の有無を表す２値変数</li>
<li><code>(1|patient)</code>：患者ごとに異なるとした切片項</li>
</ul>
<p><code>zBase * Trt</code>という記法は，この２つの交互作用もモデルに含めることを意味する．</p>
<p><code>epilepsy</code>は59 人の患者に関して，４回の入院時の発作回数を記録した，全 236 データからなる．<code>patient</code>が患者を識別する ID であり，<code>(1|patient)</code>は患者ごとのランダム効果ということになる．</p>
<p>従って本モデルは<code>zAge</code>, <code>zBase</code>, <code>Trt</code>, <code>Trt*zBase</code>という固定効果，<code>(1|patient)</code>というランダム効果を取り入れた混合効果モデルということになり，回帰式は次の通りである： <img src="https://latex.codecogs.com/png.latex?%0Ay_%7Bit%7D%20=%20%5Cbeta_1%20%5Ccdot%5Ctexttt%7BzAge%7D_i+%20%5Cbeta_2%20%5Ccdot%20%5Ctexttt%7BzBase%7D_i%20+%20%5Cbeta_3%20%5Ccdot%20%5Ctexttt%7BTrt%7D_i%0A"> <img src="https://latex.codecogs.com/png.latex?%0A+%20%5Cbeta_4%20%5Ccdot%20(%5Ctexttt%7BzBase%7D_i%20%5Ccdot%20%5Ctexttt%7BTrt%7D_i)%20+%20%5Calpha_i%20+%5Cepsilon_%7Bit%7D.%0A"> ただし，<img src="https://latex.codecogs.com/png.latex?%5Ctexttt%7Bcount%7D_%7Bit%7D"> の Poisson 母数を <img src="https://latex.codecogs.com/png.latex?%5Clambda_%7Bit%7D"> として，<img src="https://latex.codecogs.com/png.latex?y_%7Bit%7D:=%5Clog(%5Clambda_%7Bit%7D)"> とした．</p>
<p>ベースの発作回数が高いほど，治療効果が高い／低いのではないか？という仮説を検証する，<code>zBase*Trt</code>を曝露因子としたモデルである．</p>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled" title="全データ">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
全データ
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">epilepsy</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Age Base Trt patient visit count obs        zAge        zBase
1    31   11   0       1     1     5   1  0.42499501 -0.757172825
2    30   11   0       2     1     3   2  0.26528351 -0.757172825
3    25    6   0       3     1     2   3 -0.53327400 -0.944403322
4    36    8   0       4     1     4   4  1.22355252 -0.869511123
5    22   66   0       5     1     7   5 -1.01240850  1.302362646
6    29   27   0       6     1     5   6  0.10557201 -0.158035233
7    31   12   0       7     1     6   7  0.42499501 -0.719726725
8    42   52   0       8     1    40   8  2.18182153  0.778117253
9    37   23   0       9     1     5   9  1.38326402 -0.307819631
10   28   10   0      10     1    14  10 -0.05413949 -0.794618924
11   36   52   0      11     1    26  11  1.22355252  0.778117253
12   24   33   0      12     1    12  12 -0.69298550  0.066641363
13   23   18   0      13     1     4  13 -0.85269700 -0.495050128
14   36   42   0      14     1     7  14  1.22355252  0.403656259
15   26   87   0      15     1    16  15 -0.37356249  2.088730734
16   26   50   0      16     1    11  16 -0.37356249  0.703225054
17   28   18   0      17     1     0  17 -0.05413949 -0.495050128
18   31  111   0      18     1    37  18  0.42499501  2.987437121
19   32   18   0      19     1     3  19  0.58470651 -0.495050128
20   21   20   0      20     1     3  20 -1.17212000 -0.420157930
21   29   12   0      21     1     3  21  0.10557201 -0.719726725
22   21    9   0      22     1     3  22 -1.17212000 -0.832065024
23   32   17   0      23     1     2  23  0.58470651 -0.532496228
24   25   28   0      24     1     8  24 -0.53327400 -0.120589134
25   30   55   0      25     1    18  25  0.26528351  0.890455552
26   40    9   0      26     1     2  26  1.86239852 -0.832065024
27   19   10   0      27     1     3  27 -1.49154300 -0.794618924
28   22   47   0      28     1    13  28 -1.01240850  0.590886756
29   18   76   1      29     1    11  29 -1.65125450  1.676823640
30   32   38   1      30     1     8  30  0.58470651  0.253871861
31   20   19   1      31     1     0  31 -1.33183150 -0.457604029
32   30   10   1      32     1     3  32  0.26528351 -0.794618924
33   18   19   1      33     1     2  33 -1.65125450 -0.457604029
34   24   24   1      34     1     4  34 -0.69298550 -0.270373532
35   30   31   1      35     1    22  35  0.26528351 -0.008250835
36   35   14   1      36     1     5  36  1.06384102 -0.644834526
37   27   11   1      37     1     2  37 -0.21385099 -0.757172825
38   20   67   1      38     1     3  38 -1.33183150  1.339808745
39   22   41   1      39     1     4  39 -1.01240850  0.366210159
40   28    7   1      40     1     2  40 -0.05413949 -0.906957223
41   23   22   1      41     1     0  41 -0.85269700 -0.345265731
42   40   13   1      42     1     5  42  1.86239852 -0.682280626
43   33   46   1      43     1    11  43  0.74441801  0.553440656
44   21   36   1      44     1    10  44 -1.17212000  0.178979662
45   35   38   1      45     1    19  45  1.06384102  0.253871861
46   25    7   1      46     1     1  46 -0.53327400 -0.906957223
47   26   36   1      47     1     6  47 -0.37356249  0.178979662
48   25   11   1      48     1     2  48 -0.53327400 -0.757172825
49   22  151   1      49     1   102  49 -1.01240850  4.485281100
50   32   22   1      50     1     4  50  0.58470651 -0.345265731
51   25   41   1      51     1     8  51 -0.53327400  0.366210159
52   35   32   1      52     1     1  52  1.06384102  0.029195264
53   21   56   1      53     1    18  53 -1.17212000  0.927901651
54   41   24   1      54     1     6  54  2.02211002 -0.270373532
55   32   16   1      55     1     3  55  0.58470651 -0.569942327
56   26   22   1      56     1     1  56 -0.37356249 -0.345265731
57   21   25   1      57     1     2  57 -1.17212000 -0.232927432
58   36   13   1      58     1     0  58  1.22355252 -0.682280626
59   37   12   1      59     1     1  59  1.38326402 -0.719726725
60   31   11   0       1     2     3  60  0.42499501 -0.757172825
61   30   11   0       2     2     5  61  0.26528351 -0.757172825
62   25    6   0       3     2     4  62 -0.53327400 -0.944403322
63   36    8   0       4     2     4  63  1.22355252 -0.869511123
64   22   66   0       5     2    18  64 -1.01240850  1.302362646
65   29   27   0       6     2     2  65  0.10557201 -0.158035233
66   31   12   0       7     2     4  66  0.42499501 -0.719726725
67   42   52   0       8     2    20  67  2.18182153  0.778117253
68   37   23   0       9     2     6  68  1.38326402 -0.307819631
69   28   10   0      10     2    13  69 -0.05413949 -0.794618924
70   36   52   0      11     2    12  70  1.22355252  0.778117253
71   24   33   0      12     2     6  71 -0.69298550  0.066641363
72   23   18   0      13     2     4  72 -0.85269700 -0.495050128
73   36   42   0      14     2     9  73  1.22355252  0.403656259
74   26   87   0      15     2    24  74 -0.37356249  2.088730734
75   26   50   0      16     2     0  75 -0.37356249  0.703225054
76   28   18   0      17     2     0  76 -0.05413949 -0.495050128
77   31  111   0      18     2    29  77  0.42499501  2.987437121
78   32   18   0      19     2     5  78  0.58470651 -0.495050128
79   21   20   0      20     2     0  79 -1.17212000 -0.420157930
80   29   12   0      21     2     4  80  0.10557201 -0.719726725
81   21    9   0      22     2     4  81 -1.17212000 -0.832065024
82   32   17   0      23     2     3  82  0.58470651 -0.532496228
83   25   28   0      24     2    12  83 -0.53327400 -0.120589134
84   30   55   0      25     2    24  84  0.26528351  0.890455552
85   40    9   0      26     2     1  85  1.86239852 -0.832065024
86   19   10   0      27     2     1  86 -1.49154300 -0.794618924
87   22   47   0      28     2    15  87 -1.01240850  0.590886756
88   18   76   1      29     2    14  88 -1.65125450  1.676823640
89   32   38   1      30     2     7  89  0.58470651  0.253871861
90   20   19   1      31     2     4  90 -1.33183150 -0.457604029
91   30   10   1      32     2     6  91  0.26528351 -0.794618924
92   18   19   1      33     2     6  92 -1.65125450 -0.457604029
93   24   24   1      34     2     3  93 -0.69298550 -0.270373532
94   30   31   1      35     2    17  94  0.26528351 -0.008250835
95   35   14   1      36     2     4  95  1.06384102 -0.644834526
96   27   11   1      37     2     4  96 -0.21385099 -0.757172825
97   20   67   1      38     2     7  97 -1.33183150  1.339808745
98   22   41   1      39     2    18  98 -1.01240850  0.366210159
99   28    7   1      40     2     1  99 -0.05413949 -0.906957223
100  23   22   1      41     2     2 100 -0.85269700 -0.345265731
101  40   13   1      42     2     4 101  1.86239852 -0.682280626
102  33   46   1      43     2    14 102  0.74441801  0.553440656
103  21   36   1      44     2     5 103 -1.17212000  0.178979662
104  35   38   1      45     2     7 104  1.06384102  0.253871861
105  25    7   1      46     2     1 105 -0.53327400 -0.906957223
106  26   36   1      47     2    10 106 -0.37356249  0.178979662
107  25   11   1      48     2     1 107 -0.53327400 -0.757172825
108  22  151   1      49     2    65 108 -1.01240850  4.485281100
109  32   22   1      50     2     3 109  0.58470651 -0.345265731
110  25   41   1      51     2     6 110 -0.53327400  0.366210159
111  35   32   1      52     2     3 111  1.06384102  0.029195264
112  21   56   1      53     2    11 112 -1.17212000  0.927901651
113  41   24   1      54     2     3 113  2.02211002 -0.270373532
114  32   16   1      55     2     5 114  0.58470651 -0.569942327
115  26   22   1      56     2    23 115 -0.37356249 -0.345265731
116  21   25   1      57     2     3 116 -1.17212000 -0.232927432
117  36   13   1      58     2     0 117  1.22355252 -0.682280626
118  37   12   1      59     2     4 118  1.38326402 -0.719726725
119  31   11   0       1     3     3 119  0.42499501 -0.757172825
120  30   11   0       2     3     3 120  0.26528351 -0.757172825
121  25    6   0       3     3     0 121 -0.53327400 -0.944403322
122  36    8   0       4     3     1 122  1.22355252 -0.869511123
123  22   66   0       5     3     9 123 -1.01240850  1.302362646
124  29   27   0       6     3     8 124  0.10557201 -0.158035233
125  31   12   0       7     3     0 125  0.42499501 -0.719726725
126  42   52   0       8     3    21 126  2.18182153  0.778117253
127  37   23   0       9     3     6 127  1.38326402 -0.307819631
128  28   10   0      10     3     6 128 -0.05413949 -0.794618924
129  36   52   0      11     3     6 129  1.22355252  0.778117253
130  24   33   0      12     3     8 130 -0.69298550  0.066641363
131  23   18   0      13     3     6 131 -0.85269700 -0.495050128
132  36   42   0      14     3    12 132  1.22355252  0.403656259
133  26   87   0      15     3    10 133 -0.37356249  2.088730734
134  26   50   0      16     3     0 134 -0.37356249  0.703225054
135  28   18   0      17     3     3 135 -0.05413949 -0.495050128
136  31  111   0      18     3    28 136  0.42499501  2.987437121
137  32   18   0      19     3     2 137  0.58470651 -0.495050128
138  21   20   0      20     3     6 138 -1.17212000 -0.420157930
139  29   12   0      21     3     3 139  0.10557201 -0.719726725
140  21    9   0      22     3     3 140 -1.17212000 -0.832065024
141  32   17   0      23     3     3 141  0.58470651 -0.532496228
142  25   28   0      24     3     2 142 -0.53327400 -0.120589134
143  30   55   0      25     3    76 143  0.26528351  0.890455552
144  40    9   0      26     3     2 144  1.86239852 -0.832065024
145  19   10   0      27     3     4 145 -1.49154300 -0.794618924
146  22   47   0      28     3    13 146 -1.01240850  0.590886756
147  18   76   1      29     3     9 147 -1.65125450  1.676823640
148  32   38   1      30     3     9 148  0.58470651  0.253871861
149  20   19   1      31     3     3 149 -1.33183150 -0.457604029
150  30   10   1      32     3     1 150  0.26528351 -0.794618924
151  18   19   1      33     3     7 151 -1.65125450 -0.457604029
152  24   24   1      34     3     1 152 -0.69298550 -0.270373532
153  30   31   1      35     3    19 153  0.26528351 -0.008250835
154  35   14   1      36     3     7 154  1.06384102 -0.644834526
155  27   11   1      37     3     0 155 -0.21385099 -0.757172825
156  20   67   1      38     3     7 156 -1.33183150  1.339808745
157  22   41   1      39     3     2 157 -1.01240850  0.366210159
158  28    7   1      40     3     1 158 -0.05413949 -0.906957223
159  23   22   1      41     3     4 159 -0.85269700 -0.345265731
160  40   13   1      42     3     0 160  1.86239852 -0.682280626
161  33   46   1      43     3    25 161  0.74441801  0.553440656
162  21   36   1      44     3     3 162 -1.17212000  0.178979662
163  35   38   1      45     3     6 163  1.06384102  0.253871861
164  25    7   1      46     3     2 164 -0.53327400 -0.906957223
165  26   36   1      47     3     8 165 -0.37356249  0.178979662
166  25   11   1      48     3     0 166 -0.53327400 -0.757172825
167  22  151   1      49     3    72 167 -1.01240850  4.485281100
168  32   22   1      50     3     2 168  0.58470651 -0.345265731
169  25   41   1      51     3     5 169 -0.53327400  0.366210159
170  35   32   1      52     3     1 170  1.06384102  0.029195264
171  21   56   1      53     3    28 171 -1.17212000  0.927901651
172  41   24   1      54     3     4 172  2.02211002 -0.270373532
173  32   16   1      55     3     4 173  0.58470651 -0.569942327
174  26   22   1      56     3    19 174 -0.37356249 -0.345265731
175  21   25   1      57     3     0 175 -1.17212000 -0.232927432
176  36   13   1      58     3     0 176  1.22355252 -0.682280626
177  37   12   1      59     3     3 177  1.38326402 -0.719726725
178  31   11   0       1     4     3 178  0.42499501 -0.757172825
179  30   11   0       2     4     3 179  0.26528351 -0.757172825
180  25    6   0       3     4     5 180 -0.53327400 -0.944403322
181  36    8   0       4     4     4 181  1.22355252 -0.869511123
182  22   66   0       5     4    21 182 -1.01240850  1.302362646
183  29   27   0       6     4     7 183  0.10557201 -0.158035233
184  31   12   0       7     4     2 184  0.42499501 -0.719726725
185  42   52   0       8     4    12 185  2.18182153  0.778117253
186  37   23   0       9     4     5 186  1.38326402 -0.307819631
187  28   10   0      10     4     0 187 -0.05413949 -0.794618924
188  36   52   0      11     4    22 188  1.22355252  0.778117253
189  24   33   0      12     4     4 189 -0.69298550  0.066641363
190  23   18   0      13     4     2 190 -0.85269700 -0.495050128
191  36   42   0      14     4    14 191  1.22355252  0.403656259
192  26   87   0      15     4     9 192 -0.37356249  2.088730734
193  26   50   0      16     4     5 193 -0.37356249  0.703225054
194  28   18   0      17     4     3 194 -0.05413949 -0.495050128
195  31  111   0      18     4    29 195  0.42499501  2.987437121
196  32   18   0      19     4     5 196  0.58470651 -0.495050128
197  21   20   0      20     4     7 197 -1.17212000 -0.420157930
198  29   12   0      21     4     4 198  0.10557201 -0.719726725
199  21    9   0      22     4     4 199 -1.17212000 -0.832065024
200  32   17   0      23     4     5 200  0.58470651 -0.532496228
201  25   28   0      24     4     8 201 -0.53327400 -0.120589134
202  30   55   0      25     4    25 202  0.26528351  0.890455552
203  40    9   0      26     4     1 203  1.86239852 -0.832065024
204  19   10   0      27     4     2 204 -1.49154300 -0.794618924
205  22   47   0      28     4    12 205 -1.01240850  0.590886756
206  18   76   1      29     4     8 206 -1.65125450  1.676823640
207  32   38   1      30     4     4 207  0.58470651  0.253871861
208  20   19   1      31     4     0 208 -1.33183150 -0.457604029
209  30   10   1      32     4     3 209  0.26528351 -0.794618924
210  18   19   1      33     4     4 210 -1.65125450 -0.457604029
211  24   24   1      34     4     3 211 -0.69298550 -0.270373532
212  30   31   1      35     4    16 212  0.26528351 -0.008250835
213  35   14   1      36     4     4 213  1.06384102 -0.644834526
214  27   11   1      37     4     4 214 -0.21385099 -0.757172825
215  20   67   1      38     4     7 215 -1.33183150  1.339808745
216  22   41   1      39     4     5 216 -1.01240850  0.366210159
217  28    7   1      40     4     0 217 -0.05413949 -0.906957223
218  23   22   1      41     4     0 218 -0.85269700 -0.345265731
219  40   13   1      42     4     3 219  1.86239852 -0.682280626
220  33   46   1      43     4    15 220  0.74441801  0.553440656
221  21   36   1      44     4     8 221 -1.17212000  0.178979662
222  35   38   1      45     4     7 222  1.06384102  0.253871861
223  25    7   1      46     4     3 223 -0.53327400 -0.906957223
224  26   36   1      47     4     8 224 -0.37356249  0.178979662
225  25   11   1      48     4     0 225 -0.53327400 -0.757172825
226  22  151   1      49     4    63 226 -1.01240850  4.485281100
227  32   22   1      50     4     4 227  0.58470651 -0.345265731
228  25   41   1      51     4     7 228 -0.53327400  0.366210159
229  35   32   1      52     4     5 229  1.06384102  0.029195264
230  21   56   1      53     4    13 230 -1.17212000  0.927901651
231  41   24   1      54     4     0 231  2.02211002 -0.270373532
232  32   16   1      55     4     3 232  0.58470651 -0.569942327
233  26   22   1      56     4     8 233 -0.37356249 -0.345265731
234  21   25   1      57     4     1 234 -1.17212000 -0.232927432
235  36   13   1      58     4     0 235  1.22355252 -0.682280626
236  37   12   1      59     4     2 236  1.38326402 -0.719726725</code></pre>
</div>
</div>
</div>
</div>
</div>
<section id="モデルの推定とプロット" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="モデルの推定とプロット"><span class="header-section-number">1.1</span> モデルの推定とプロット</h3>
<div class="callout callout-style-default callout-caution callout-titled" title="フィッティングの出力">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
フィッティングの出力
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(brms)</span>
<span id="cb5-2">fit1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brm</span>(count <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> zAge <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> zBase <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Trt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span>patient),</span>
<span id="cb5-3">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> epilepsy, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">poisson</span>())</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Compiling Stan program...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Start sampling</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 5.2e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.52 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.907 seconds (Warm-up)
Chain 1:                0.743 seconds (Sampling)
Chain 1:                1.65 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 1.3e-05 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.13 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.918 seconds (Warm-up)
Chain 2:                0.721 seconds (Sampling)
Chain 2:                1.639 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 1.4e-05 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.14 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.864 seconds (Warm-up)
Chain 3:                0.726 seconds (Sampling)
Chain 3:                1.59 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 1.3e-05 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.13 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 1.074 seconds (Warm-up)
Chain 4:                0.806 seconds (Sampling)
Chain 4:                1.88 seconds (Total)
Chain 4: </code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: poisson 
  Links: mu = log 
Formula: count ~ zAge + zBase * Trt + (1 | patient) 
   Data: epilepsy (Number of observations: 236) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Multilevel Hyperparameters:
~patient (Number of levels: 59) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.58      0.07     0.46     0.74 1.00      804     1363

Regression Coefficients:
           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept      1.77      0.12     1.53     2.00 1.01      636      888
zAge           0.10      0.09    -0.07     0.27 1.00      715     1483
zBase          0.70      0.12     0.46     0.95 1.00      589     1231
Trt1          -0.26      0.17    -0.59     0.07 1.01      656     1034
zBase:Trt1     0.05      0.16    -0.27     0.38 1.00      680     1426

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<p>基本的な解析の前提がまず出力され，推定結果はグループ毎（今回は患者毎）の変数（今回は <img src="https://latex.codecogs.com/png.latex?%5Calpha_i">）から表示される．</p>
<p>後半に固定効果の係数，すなわち回帰係数の推定結果が表示される．</p>
<p>治療効果<code>Trt</code>の係数は負で，平均的に処置効果はある可能性があるが，95% 信頼区間は <img src="https://latex.codecogs.com/png.latex?0"> を跨いでいるという意味で，有意とは言えない．また，交差項<code>zBase*Trt</code>の係数は小さく，交互効果の存在を示す証拠はないと思われる．</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cwidehat%7BR%7D"> が１より大きい場合，MCMC が収束していない可能性を意味する <span class="citation" data-cites="Vehtari+2021">(Vehtari et al., 2021)</span>．通説には <img src="https://latex.codecogs.com/png.latex?%5Cwidehat%7BR%7D%5Cle1.1"> などの基準がある．</p>
<p>変数を指定して，事後分布と MCMC の軌跡をプロットできる：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(fit1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variable =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b_Trt1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b_zBase"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/Computation/brms_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>より詳しく見るには<code>conditional_effects</code>関数を用いることもできる．交差項の効果はほとんどないことがわかる：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conditional_effects</span>(fit1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">effects =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zBase:Trt"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/Computation/brms_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="モデルによる予測" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="モデルによる予測"><span class="header-section-number">1.2</span> モデルによる予測</h3>
<p>fit したモデル <code>fit1</code> を用いて，平均年齢と平均ベースレートを持つ患者に対する治療効果を予測する：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">newdata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Trt =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">zAge =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">zBase =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb13-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(fit1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> newdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">re_formula =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Estimate Est.Error Q2.5 Q97.5
[1,]   5.8870  2.501858    2    11
[2,]   4.5655  2.156588    1     9</code></pre>
</div>
</div>
<p>関数<a href="https://paul-buerkner.github.io/brms/reference/predict.brmsfit.html"><code>predict()</code></a>は事後予測分布からのサンプリングを行う．一方で，関数<a href="https://paul-buerkner.github.io/brms/reference/fitted.brmsfit.html"><code>fitted()</code></a>は平均を返す．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fitted</span>(fit1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> newdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">re_formula =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Estimate Est.Error     Q2.5    Q97.5
[1,] 5.905118 0.7105245 4.614680 7.413713
[2,] 4.537683 0.5298045 3.559239 5.647088</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled" title="予測の出力">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
予測の出力
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>従って，もう１度ずつ実行すると，<code>predict</code>では値が変わるが，<code>fitted</code>では同じ値が出力される．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(fit1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> newdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">re_formula =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Estimate Est.Error Q2.5 Q97.5
[1,]  5.94525  2.551251    2    12
[2,]  4.57525  2.225101    1     9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fitted</span>(fit1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> newdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">re_formula =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Estimate Est.Error     Q2.5    Q97.5
[1,] 5.905118 0.7105245 4.614680 7.413713
[2,] 4.537683 0.5298045 3.559239 5.647088</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-model-comparison" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="sec-model-comparison"><span class="header-section-number">1.3</span> モデルの比較</h3>
<p>モデル<code>fit1</code>で行った Poisson 回帰分析は，<code>fit1</code>に含めた説明変数の違いを除けば，個々の観測が独立になる，という仮定の上に成り立っている（第 4.3 節）．</p>
<p>この仮定が破れているとき＝全ての説明変数をモデルに含めきれていないとき，Poisson 分布の性質 <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BE%7D%5BX%5D=%5Cmathrm%7BV%7D%5BX%5D=%5Clambda%5Cqquad%20(X%5Csim%5Cmathrm%7BPois%7D(%5Clambda))%0A"> からの離反として現れ，この現象は <strong>過分散</strong>（overdispersion）とも呼ばれる．</p>
<section id="観測レベルランダム効果" class="level4" data-number="1.3.1">
<h4 data-number="1.3.1" class="anchored" data-anchor-id="観測レベルランダム効果"><span class="header-section-number">1.3.1</span> 観測レベルランダム効果</h4>
<p>ということで，他の説明変数が存在した場合を想定して， Poisson 分布族ではなく，分散が平均よりも大きいような別の分布族を用いて，フィット度合いを比較してみることを考えたい．</p>
<p>そこで，追加の変動をモデルに追加するべく，モデル<code>fit1</code>に観測ごとの切片項 <img src="https://latex.codecogs.com/png.latex?%5Ceta_%7Bit%7D"> を追加してみる（この手法は観測レベルランダム効果と呼ばれる．第 3.2 節参照）．</p>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">fit2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brm</span>(count <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> zAge <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> zBase <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Trt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span>patient) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span>obs),</span>
<span id="cb21-2">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> epilepsy, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">poisson</span>())</span></code></pre></div>
<div class="callout callout-style-default callout-caution callout-titled" title="フィッティングの出力">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
フィッティングの出力
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">fit2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brm</span>(count <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> zAge <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> zBase <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Trt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span>patient) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span>obs),</span>
<span id="cb22-2">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> epilepsy, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">poisson</span>())</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Compiling Stan program...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Start sampling</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 7.4e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.74 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 2.09 seconds (Warm-up)
Chain 1:                1.138 seconds (Sampling)
Chain 1:                3.228 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 1.9e-05 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.19 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 1.918 seconds (Warm-up)
Chain 2:                1.139 seconds (Sampling)
Chain 2:                3.057 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 1.9e-05 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.19 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 1.983 seconds (Warm-up)
Chain 3:                1.133 seconds (Sampling)
Chain 3:                3.116 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 2.4e-05 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.24 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 1.971 seconds (Warm-up)
Chain 4:                1.151 seconds (Sampling)
Chain 4:                3.122 seconds (Total)
Chain 4: </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>こうして得た２つのモデル<code>fit1</code>,<code>fit2</code>を比較する．</p>
<p>LLO (Leave-One-Out) cross-validation が関数<code>loo</code>によって実行できる：</p>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">loo</span>(fit1, fit2)</span></code></pre></div>
<div class="callout callout-style-default callout-caution callout-titled" title="LOO-CV の結果">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
LOO-CV の結果
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">loo</span>(fit1, fit2)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Found 8 observations with a pareto_k &gt; 0.7 in model 'fit1'. We
recommend to set 'moment_match = TRUE' in order to perform moment matching for
problematic observations.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Found 59 observations with a pareto_k &gt; 0.7 in model 'fit2'. We
recommend to set 'moment_match = TRUE' in order to perform moment matching for
problematic observations.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Output of model 'fit1':

Computed from 4000 by 236 log-likelihood matrix.

         Estimate   SE
elpd_loo   -670.9 36.0
p_loo        93.2 13.7
looic      1341.7 72.1
------
MCSE of elpd_loo is NA.
MCSE and ESS estimates assume MCMC draws (r_eff in [0.4, 2.0]).

Pareto k diagnostic values:
                         Count Pct.    Min. ESS
(-Inf, 0.7]   (good)     228   96.6%   77      
   (0.7, 1]   (bad)        5    2.1%   &lt;NA&gt;    
   (1, Inf)   (very bad)   3    1.3%   &lt;NA&gt;    
See help('pareto-k-diagnostic') for details.

Output of model 'fit2':

Computed from 4000 by 236 log-likelihood matrix.

         Estimate   SE
elpd_loo   -595.2 14.0
p_loo       108.0  7.2
looic      1190.4 28.0
------
MCSE of elpd_loo is NA.
MCSE and ESS estimates assume MCMC draws (r_eff in [0.4, 1.6]).

Pareto k diagnostic values:
                         Count Pct.    Min. ESS
(-Inf, 0.7]   (good)     177   75.0%   85      
   (0.7, 1]   (bad)       52   22.0%   &lt;NA&gt;    
   (1, Inf)   (very bad)   7    3.0%   &lt;NA&gt;    
See help('pareto-k-diagnostic') for details.

Model comparisons:
     elpd_diff se_diff
fit2   0.0       0.0  
fit1 -75.7      26.5  </code></pre>
</div>
</div>
</div>
</div>
</div>
<p><code>elpd_diff</code> は expected log posterior density の差異を表す．<code>fit2</code>の方が大きく当てはまりが良いことが見て取れる．</p>
<p>また，WAIC (Watanabe-Akaike Information Criterion) も実装されている：</p>
<div class="sourceCode" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">waic</span>(fit1))</span></code></pre></div>
<div class="callout callout-style-default callout-caution callout-titled" title="WAIC の結果">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
WAIC の結果
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">waic</span>(fit1))</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 
53 (22.5%) p_waic estimates greater than 0.4. We recommend trying loo instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Computed from 4000 by 236 log-likelihood matrix.

          Estimate   SE
elpd_waic   -667.4 36.1
p_waic        89.8 13.8
waic        1334.9 72.3

53 (22.5%) p_waic estimates greater than 0.4. We recommend trying loo instead. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">waic</span>(fit2))</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 
63 (26.7%) p_waic estimates greater than 0.4. We recommend trying loo instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Computed from 4000 by 236 log-likelihood matrix.

          Estimate   SE
elpd_waic   -571.4 11.9
p_waic        84.3  5.1
waic        1142.8 23.9

63 (26.7%) p_waic estimates greater than 0.4. We recommend trying loo instead. </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>他にも，<code>reloo</code>, <code>kfold</code> などの関数もある．</p>
<div class="callout callout-style-default callout-caution callout-titled" title="他の関数一覧">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
他の関数一覧
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">methods</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">class=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"brmsfit"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          default_prior          
[22] expose_functions        family                  fitted                 
[25] fixef                   formula                 getCall                
[28] hypothesis              kfold                   log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] psis                    ranef                   reloo                  
[82] residuals               restructure             rhat                   
[85] stancode                standata                stanplot               
[88] summary                 update                  VarCorr                
[91] variables               vcov                    waic                   
[94] WAIC                   
see '?methods' for accessing help and source code</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="患者内の相関構造のモデリング" class="level4" data-number="1.3.2">
<h4 data-number="1.3.2" class="anchored" data-anchor-id="患者内の相関構造のモデリング"><span class="header-section-number">1.3.2</span> 患者内の相関構造のモデリング</h4>
<p>また，<code>fit1</code>において，同一患者の異なる訪問の間には全く相関がないと仮定されており，これは全く非現実的な仮定をおいてしまっていると言える．<sup>2</sup></p>
<p>患者内の相関構造は，<code>brm()</code>関数の<code>autocor</code>引数で指定できる（第 4.3.2 節）．</p>
<p>例えば，全く構造を仮定しない場合は，<a href="http://paul-buerkner.github.io/brms/reference/unstr.html"><code>unstr</code></a>を指定する：</p>
<div class="sourceCode" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1">fit3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brm</span>(count <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> zAge <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> zBase <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Trt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span>patient),</span>
<span id="cb40-2">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">autocor =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unstr</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time=</span>visit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gr=</span>patient),</span>
<span id="cb40-3">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> epilepsy, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">poisson</span>())</span></code></pre></div>
<div class="callout callout-style-default callout-caution callout-titled" title="フィッティングの出力">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
フィッティングの出力
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1">fit3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brm</span>(count <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> zAge <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> zBase <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Trt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span>patient),</span>
<span id="cb41-2">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">autocor =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unstr</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time=</span>visit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gr=</span>patient),</span>
<span id="cb41-3">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> epilepsy, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">poisson</span>())</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Argument 'autocor' should be specified within the 'formula' argument.
See ?brmsformula for help.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Compiling Stan program...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Start sampling</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 0.000148 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 1.48 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 4.102 seconds (Warm-up)
Chain 1:                2.262 seconds (Sampling)
Chain 1:                6.364 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 3.9e-05 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.39 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 4.034 seconds (Warm-up)
Chain 2:                3.134 seconds (Sampling)
Chain 2:                7.168 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 4.4e-05 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.44 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 4.157 seconds (Warm-up)
Chain 3:                2.383 seconds (Sampling)
Chain 3:                6.54 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 3.8e-05 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.38 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 4.12 seconds (Warm-up)
Chain 4:                2.316 seconds (Sampling)
Chain 4:                6.436 seconds (Total)
Chain 4: </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.
Running the chains for more iterations may help. See
https://mc-stan.org/misc/warnings.html#bulk-ess</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.
Running the chains for more iterations may help. See
https://mc-stan.org/misc/warnings.html#tail-ess</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>このモデルも<code>fit1</code>より遥かに当てはまりが良く，<code>fit2</code>とほとんど同じ当てはまりの良さが見られる：</p>
<div class="callout callout-style-default callout-caution callout-titled" title="LOO-CV の結果">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
LOO-CV の結果
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">loo</span>(fit2,fit3)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Found 59 observations with a pareto_k &gt; 0.7 in model 'fit2'. We
recommend to set 'moment_match = TRUE' in order to perform moment matching for
problematic observations.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Found 51 observations with a pareto_k &gt; 0.7 in model 'fit3'. We
recommend to set 'moment_match = TRUE' in order to perform moment matching for
problematic observations.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Output of model 'fit2':

Computed from 4000 by 236 log-likelihood matrix.

         Estimate   SE
elpd_loo   -595.2 14.0
p_loo       108.0  7.2
looic      1190.4 28.0
------
MCSE of elpd_loo is NA.
MCSE and ESS estimates assume MCMC draws (r_eff in [0.4, 1.6]).

Pareto k diagnostic values:
                         Count Pct.    Min. ESS
(-Inf, 0.7]   (good)     177   75.0%   85      
   (0.7, 1]   (bad)       52   22.0%   &lt;NA&gt;    
   (1, Inf)   (very bad)   7    3.0%   &lt;NA&gt;    
See help('pareto-k-diagnostic') for details.

Output of model 'fit3':

Computed from 4000 by 236 log-likelihood matrix.

         Estimate   SE
elpd_loo   -599.7 14.6
p_loo       111.2  7.7
looic      1199.5 29.2
------
MCSE of elpd_loo is NA.
MCSE and ESS estimates assume MCMC draws (r_eff in [0.4, 1.5]).

Pareto k diagnostic values:
                         Count Pct.    Min. ESS
(-Inf, 0.7]   (good)     185   78.4%   55      
   (0.7, 1]   (bad)       45   19.1%   &lt;NA&gt;    
   (1, Inf)   (very bad)   6    2.5%   &lt;NA&gt;    
See help('pareto-k-diagnostic') for details.

Model comparisons:
     elpd_diff se_diff
fit2  0.0       0.0   
fit3 -4.5       2.9   </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>思ったよりも<code>fit2</code>の当てはまりが良いため，Poisson-対数正規混合モデリングを本格的に実施してみることが，次の選択肢になり得る（第 3.2 節参照）．</p>
</section>
</section>
<section id="その他の例" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="その他の例"><span class="header-section-number">1.4</span> その他の例</h3>
<p>Sebastian Weber らにより，<a href="https://opensource.nibr.com/bamdd/">新薬の治験における実際の解析事例をまとめたウェブサイト</a> が公開されている．<sup>3</sup></p>
<p>特に，<a href="https://opensource.nibr.com/bamdd/src/02h_mmrm.html#brms-implementation">13 章</a>で，同様の経時的繰り返し観測データを扱っているが，ここではカウントデータではなく連続な応用変数が扱われている．</p>
</section>
</section>
<section id="ランダム効果モデルの正しい使い方" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="ランダム効果モデルの正しい使い方"><span class="header-section-number">2</span> ランダム効果モデルの正しい使い方</h2>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="概要">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
概要
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>ランダム効果モデルとは，グループ毎に異なる切片項 <img src="https://latex.codecogs.com/png.latex?%5Calpha_%7Bs%5Bi%5D%7D"> を追加し，これにも誤差を仮定してモデルに入れて得る階層モデルである．</li>
<li>しかし，<img src="https://latex.codecogs.com/png.latex?%5Calpha_%7Bs%5Bi%5D%7D"> が（ユニットレベルの）説明変数 <img src="https://latex.codecogs.com/png.latex?x_i"> と相関を持つ場合，推定量の一致性が失われる．これを回避するために，<img src="https://latex.codecogs.com/png.latex?x_i"> の係数 <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> にのみ関心がある場合は，固定効果モデルが用いられることも多い．</li>
<li>だが，簡単なトリック（<img src="https://latex.codecogs.com/png.latex?%5Calpha_%7Bs%5Bi%5D%7D"> の説明変数に <img src="https://latex.codecogs.com/png.latex?%5Coverline%7Bx%7D_s"> を追加すること）で，推定量の一致性を回復することができる．</li>
<li>このトリックを取り入れたランダム効果モデルは，<img src="https://latex.codecogs.com/png.latex?x_i"> と <img src="https://latex.codecogs.com/png.latex?%5Calpha_%7Bs%5Bi%5D%7D"> に相関がない場合は固定効果モデルと等価な <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> の推定量を与え，相関がある場合でも，<img src="https://latex.codecogs.com/png.latex?%5Cbeta"> を一致推定し，各変動切片項 <img src="https://latex.codecogs.com/png.latex?%5Calpha_%7Bs%5Bi%5D%7D"> の構造にも洞察を与えてくれる．</li>
</ul>
</div>
</div>
<section id="sec-RF" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="sec-RF"><span class="header-section-number">2.1</span> ランダム効果のモデル</h3>
<p>ランダム効果は，変動する切片項と呼んだ方がわかりやすい <span class="citation" data-cites="Bafumi-Gelman2007">(Bafumi &amp; Gelman, 2007)</span> と言われるように，サブグループ毎に異なる切片を加えたモデルである．</p>
<p>従って，ユニットレベルの回帰式を書き下すと，グループ選択関数 <img src="https://latex.codecogs.com/png.latex?s:%5Bn%5D%5Cto%5BS%5D%5C;(S%5Cle%20n)"> を通じて， <span id="eq-stage-1"><img src="https://latex.codecogs.com/png.latex?%0Ay_i=%5Calpha_%7Bs%5Bi%5D%7D+%5Cbeta%20x_i+%5Cepsilon_i,%5Cqquad%20i%5Cin%5Bn%5D,%0A%5Ctag%7B1%7D"></span> というようになる．</p>
<p>これは，確率変数 <img src="https://latex.codecogs.com/png.latex?%5Calpha_%7Bs%5Bi%5D%7D"> の平均を <img src="https://latex.codecogs.com/png.latex?%5Calpha_0"> とすると，グループレベルの回帰式 <span id="eq-stage-2"><img src="https://latex.codecogs.com/png.latex?%0A%5Calpha_s=%5Calpha_0+%5Ceta_s,%5Cqquad%20s%5Cin%5BS%5D%0A%5Ctag%7B2%7D"></span> が背後にある階層モデルだとみなすこともできる．</p>
</section>
<section id="説明変数との相関の問題" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="説明変数との相関の問題"><span class="header-section-number">2.2</span> 説明変数との相関の問題</h3>
<section id="問題の所在" class="level4" data-number="2.2.1">
<h4 data-number="2.2.1" class="anchored" data-anchor-id="問題の所在"><span class="header-section-number">2.2.1</span> 問題の所在</h4>
<p>ランダム効果では，ユニットレベルの説明変数 <img src="https://latex.codecogs.com/png.latex?x_i"> と変動切片項 <img src="https://latex.codecogs.com/png.latex?%5Calpha_%7Bs%5Bi%5D%7D"> が相関を持たないという仮定が Gauss-Markov の定理の仮定に等価になるため，これが違反されると推定量の不偏性・一致性が約束されず，推定量の分散も大きくなる．<sup>4</sup></p>
<p>実際，ランダム効果モデルの階層構造を，式&nbsp;2 を 式&nbsp;1 に代入することで一つの式にまとめると <span id="eq-RF"><img src="https://latex.codecogs.com/png.latex?%0Ay_i=%5Calpha_0+%5Cbeta%20x_i+%5Cunderbrace%7B%5Cepsilon_i'%7D_%7B%5Cepsilon_i+%5Ceta_%7Bs%5Bi%5D%7D%7D%0A%5Ctag%7B3%7D"></span> を得る．<sup>5</sup> <img src="https://latex.codecogs.com/png.latex?x_i"> と <img src="https://latex.codecogs.com/png.latex?%5Calpha_%7Bs%5Bi%5D%7D"> の相関をモデルに含めていない場合，<img src="https://latex.codecogs.com/png.latex?x_i"> と <img src="https://latex.codecogs.com/png.latex?%5Ceta_s"> が相関を持ってしまい，結果として 式&nbsp;3 では説明変数と誤差 <img src="https://latex.codecogs.com/png.latex?%5Cepsilon_i'"> に相関が生じてしまう．<sup>6</sup></p>
</section>
<section id="業界の現状" class="level4" data-number="2.2.2">
<h4 data-number="2.2.2" class="anchored" data-anchor-id="業界の現状"><span class="header-section-number">2.2.2</span> 業界の現状</h4>
<p>そのため，ランダム効果モデルは避けられる傾向にあり，切片項 <img src="https://latex.codecogs.com/png.latex?%5Calpha_%7Bs%5Bi%5D%7D%5Cequiv%5Calpha_0"> は変動しないとし，グループレベルの効果を無視してモデリングすることも多い： <img src="https://latex.codecogs.com/png.latex?%0Ay_i=%5Calpha_0+%5Cbeta%20x_i+%5Cepsilon_i.%0A"> このことを complete pooling model と呼び，ランダム効果モデルを partial pooling model と対比させることがある．<sup>7</sup></p>
<p>実際，これ以上の仮定を置かず，ランダム効果は局外母数として一般化推定方程式の方法（第 2.4.1 節）によれば，<img src="https://latex.codecogs.com/png.latex?%5Cbeta"> の不偏推定が可能である．</p>
<p>リンク関数 <img src="https://latex.codecogs.com/png.latex?g"> を通じた非線型モデル <img src="https://latex.codecogs.com/png.latex?%0Ag(%5Coperatorname%7BE%7D%5By_i%7Cx_i%5D)=%5Cbeta%20x_i%0A"> であっても，指数型分布族を仮定すれば，<img src="https://latex.codecogs.com/png.latex?%5Cbeta"> の一致推定が可能である．</p>
<p>このような場合は，marginal model や population-average model とも呼ばれる <span class="citation" data-cites="Gardiner+2009">(Gardiner et al., 2009, p. 228)</span>．</p>
</section>
<section id="sec-fixed-effects-model" class="level4" data-number="2.2.3">
<h4 data-number="2.2.3" class="anchored" data-anchor-id="sec-fixed-effects-model"><span class="header-section-number">2.2.3</span> 固定効果モデルという解決</h4>
<p>問題を起こさずに，しかしながらグループレベルの効果をモデリングしたい場合， <img src="https://latex.codecogs.com/png.latex?%0Ay_i=%5Calpha_%7Bs%5Bi%5D%7D%5E%7B%5Ctext%7Bunmodeled%7D%7D+%5Cbeta%20x_i+%5Cepsilon_i%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Calpha_s%5E%7B%5Ctext%7Bunmodeled%7D%7D%5Csim%5Cmathrm%7BN%7D(%5Calpha_0,%5Cinfty)%0A"> として，グループ毎に変動する切片項 <img src="https://latex.codecogs.com/png.latex?%5Calpha_%7Bs%5Bi%5D%7D%5E%7B%5Ctext%7Bunmodeled%7D%7D"> を許すが，この変数自体にモデルは仮定しない．</p>
<p>このようなモデルは，グループ毎に別々の回帰分析を実行し，<img src="https://latex.codecogs.com/png.latex?%5Cbeta"> の値はこれらのグループの間で適切に重みづけて最終的な推定値としているに等しい．</p>
<p>すなわち，グループの数だけ，グループへの所属を表す２値変数 <img src="https://latex.codecogs.com/png.latex?1_%7Bs%5Bi%5D=s%7D"> を導入し，<img src="https://latex.codecogs.com/png.latex?S"> 個の項 <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bs=1%7D%5ES1_%7Bs%5Bi%5D=s%7D%5Calpha_%7Bs%5Bi%5D%7D%5E%7B%5Ctext%7Bunmodeled%7D%7D"> を説明変数に加えて回帰分析を行うことに等しい．</p>
<div class="callout callout-style-simple callout-caution no-icon callout-titled" title="名前">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
名前
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><span class="citation" data-cites="Bafumi-Gelman2007">(Bafumi &amp; Gelman, 2007)</span> は unmodeled varying intercept と呼んでいる．</li>
<li><span class="citation" data-cites="Hansen2022">(Hansen, 2022)</span> をはじめ，計量経済学では fixed effects model と呼ばれる．</li>
<li>least squares dummy variable regression とも呼べる．<sup>8</sup></li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-caution no-icon callout-titled" title="利点">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
利点
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?x_i"> と <img src="https://latex.codecogs.com/png.latex?%5Calpha_%7Bs%5Bi%5D%7D"> が相関を持ち得る場合も，固定効果モデルでは関係がない．<sup>9</sup></p>
</div>
</div>
<div class="callout callout-style-simple callout-caution no-icon callout-titled" title="問題点">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
問題点
</div>
</div>
<div class="callout-body-container callout-body">
<p>異なるグループのデータが相互作用する機構がランダム効果モデルに比べて貧しい．</p>
<p>（正しく特定された）ランダム効果モデルの方は，外れ値グループが存在しても，<img src="https://latex.codecogs.com/png.latex?%5Ceta_s"> を通じて緩やかに情報が伝達され，<img src="https://latex.codecogs.com/png.latex?%5Cbeta"> の値は平均へ縮小されて推定されるが，固定効果モデルではそのような頑健性を持たない．<sup>10</sup></p>
</div>
</div>
<p>固定効果モデルは <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> （のみ）に関心がある場合，<img src="https://latex.codecogs.com/png.latex?%5Calpha_%7Bs%5Bi%5D%7D"> と <img src="https://latex.codecogs.com/png.latex?x_i"> の相関の存在に対してロバストな推定法として有用であり，その理由で計量経済学（特に線型パネルデータ）では主流の推定手法となっている．<sup>11</sup> 実際，<img src="https://latex.codecogs.com/png.latex?%5Calpha_%7Bs%5Bi%5D%7D"> と <img src="https://latex.codecogs.com/png.latex?x_i"> が無相関であるとき，<img src="https://latex.codecogs.com/png.latex?%5Cbeta"> に関しては等価な推定量を与える．</p>
<blockquote class="blockquote">
<p>Current econometric practice is to prefer robustness over efficiency. Consequently, current practice is (nearly uniformly) to use the fixed effects estmimator for linear panel data models. <span class="citation" data-cites="Hansen2022">(Hansen, 2022, p. 624)</span></p>
</blockquote>
<p>逆に言えば，固定効果モデルは <img src="https://latex.codecogs.com/png.latex?x_i"> と <img src="https://latex.codecogs.com/png.latex?%5Calpha_%7Bs%5Bi%5D%7D"> の構造のモデリングを放棄したモデリング法であり，各 <img src="https://latex.codecogs.com/png.latex?%5Calpha_%7Bs%5Bi%5D%7D"> の値にも興味がある場合，および <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> のグループ毎の値も考えたい場合にはやはり <img src="https://latex.codecogs.com/png.latex?%5Calpha_%7Bs%5Bi%5D%7D"> の誤差と相関構造もモデルに取り入れたランダム効果モデルを用いたい，ということになる．</p>
</section>
</section>
<section id="ランダム効果モデルにおける相関のモデリング" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="ランダム効果モデルにおける相関のモデリング"><span class="header-section-number">2.3</span> ランダム効果モデルにおける相関のモデリング</h3>
<p><img src="https://latex.codecogs.com/png.latex?x_i"> と <img src="https://latex.codecogs.com/png.latex?%5Calpha_%7Bs%5Bi%5D%7D"> との相関は，欠落変数が存在するため，と考えることができる．</p>
<p>そして，この相関は，説明変数の平均 <img src="https://latex.codecogs.com/png.latex?%5Coverline%7Bx%7D_s"> を変動する切片項 <img src="https://latex.codecogs.com/png.latex?%5Calpha_s"> の説明変数として追加することで除去できる：<sup>12</sup></p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ay_i=%5Calpha_%7Bs%5Bi%5D%7D+%5Cbeta%20x_i+%5Cepsilon_i%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Calpha_s=%5Calpha_0+%5Calpha_1%5Coverline%7Bx%7D_s+%5Ceta_s%0A"></p>
<p>これにより，Gauss-Markov の仮定（外生性）が回復される．</p>
<p><span class="citation" data-cites="Bafumi-Gelman2007">(Bafumi &amp; Gelman, 2007, pp. 7–9)</span> にシミュレーションによる検証が掲載されている．</p>
<blockquote class="blockquote">
<p>Practitioners can get around this problem by taking advantage of the multilevel structure of their regression equation. <span class="citation" data-cites="Bafumi-Gelman2007">(Bafumi &amp; Gelman, 2007, p. 12)</span></p>
</blockquote>
</section>
<section id="名前の混乱をどうするか" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="名前の混乱をどうするか"><span class="header-section-number">2.4</span> 名前の混乱をどうするか？</h3>
<p>以上，解説してきた「ランダム効果モデル」であるが，混合効果モデルとも呼ばれる．<sup>13</sup></p>
<p>何を言っているのかわからないかもしれないが，式 式&nbsp;1 <img src="https://latex.codecogs.com/png.latex?%0Ay_i=%5Calpha_%7Bs%5Bi%5D%7D+%5Cbeta%20x_i+%5Cepsilon_i,%5Cqquad%20i%5Cin%5Bn%5D,%0A"> において，<img src="https://latex.codecogs.com/png.latex?%5Calpha_%7Bs%5Bi%5D%7D"> がランダム効果であるが，回帰係数 <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> を固定効果とも呼ぶのである．</p>
<p>現代的には，必要ならば <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> を確率変数とみなしても良いだろうが，慣習的にそう呼ぶため，これに従わざるを得ない，というのが <span class="citation" data-cites="Hansen2022">(Hansen, 2022, p. 625)</span> などを見る限り共通了解であるようである．</p>
<p>これが計量経済学における固定効果モデル（第 2.2.3 節）の名前の由来である．<sup>14</sup> 固定効果モデルは，たしかに（ユニットレベルでの回帰係数という意味での）「固定効果」を表す変数しか含んでいない（少なくとも見た目上は）．</p>
<p>そこで，式 式&nbsp;1 自体は，固定効果と変量効果の両方を含んだ <strong>混合（効果）モデル</strong> というのである．</p>
<div class="callout callout-style-simple callout-caution no-icon callout-titled" title="名前">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
名前
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="citation" data-cites="Chung+2013">(Chung et al., 2013)</span> によると</p>
<ul>
<li>線型混合モデル (linear mixed models) <span class="citation" data-cites="Kincaid2005">(Kincaid, 2005)</span></li>
<li>階層モデル (hierarchical models)</li>
<li>マルチレベル線型モデル (multilevel linear models)</li>
<li>混合効果モデル (mixed-effects models) <span class="citation" data-cites="Chung+2015">(Chung et al., 2015)</span></li>
<li>ランダム効果モデル (random effects model) <span class="citation" data-cites="Hubbard+2010">(Hubbard et al., 2010)</span> （え？）</li>
<li>分散成分モデル (variance component model)<sup>15</sup></li>
</ul>
<p>などと呼ばれる．</p>
<p>ただし，ランダム効果モデルと呼んでしまうことも多い．<span class="citation" data-cites="Bafumi-Gelman2007">(Bafumi &amp; Gelman, 2007)</span> のアブストラクトなど．</p>
</div>
</div>
<section id="sec-GEE" class="level4" data-number="2.4.1">
<h4 data-number="2.4.1" class="anchored" data-anchor-id="sec-GEE"><span class="header-section-number">2.4.1</span> GEE との違い</h4>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="一般化推定方程式 (GEE: Generalized Estimating Equation) との違い">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
一般化推定方程式 (GEE: Generalized Estimating Equation) との違い
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><u>回帰式が違う</u></p>
<p>線型の場合の GEE は <img src="https://latex.codecogs.com/png.latex?%0A%20%20%20Y_%7Bit%7D=%5Calpha+%5Cbeta_1x_%7B1,i,t%7D+%5Ccdots+%5Cbeta_px_%7Bp,i,t%7D%0A%20%20%20"> とも表され，ランダムな切片項というものは見当たらない．その代わり，グループ間の影響は相関係数行列としてモデル化を行う．ランダム効果モデルでは，この相関構造を，ランダムな切片項を追加し，その回帰式も立てることでモデルに取り込む．</p></li>
<li><p><u>推定目標が違う</u></p>
<p>GEE は population average model でよく用いられる <span class="citation" data-cites="Hubbard+2010">(Hubbard et al., 2010)</span> ように，あくまで応答 <img src="https://latex.codecogs.com/png.latex?Y_%7Bit%7D"> の平均の不偏推定が目標であり，共分散構造はいわば局外母数である．一方，混合効果モデルは，その階層モデルとしての性質の通り，平均構造と分散構造のいずれも推定対象として扱う志向性がある．</p></li>
<li><p><u>推定方法が違う</u></p>
<p>混合効果モデルは主に最尤法により推定される <span class="citation" data-cites="Hubbard+2010">(Hubbard et al., 2010)</span>．GEE はモーメント法により推定され，最尤法ベースではないため，完全にランダムとは言えない欠測がある場合は弱く，IPW などの方法が用いられる．</p></li>
</ol>
</div>
</div>
<p>GEE にとって相関構造は局外母数であり，正確な特定は目的に含まれない．この意味で GEE の相関係数⾏列におく仮定は「間違えていてもよい便宜的な仮定」であるため，作業相関係数行列 (working correlation coefficient matrix) とも呼ばれる．相関構造を誤特定していても，平均構造は一致推定が可能であり，ロバストである．両方の特定に成功した場合はセミパラメトリック有効性が達成される．</p>
<p>一方で，混合効果モデルは，階層モデルとして，平均構造と分散構造のいずれにも明示的な仮定をおくため，片方（例えば共分散構造）の特定を間違えていた場合，もう片方の解釈性が失われる，というリスクがあると論じることができる．特に <span class="citation" data-cites="Hubbard+2010">(Hubbard et al., 2010)</span> に見られる論調である．</p>
<p>しかし，子供の身長の成長曲線の描画が主な研究目標である場合など，ユニットの平均効果ではなく各個人に注目したい場合には，（特に変動係数を取り入れた）混合効果モデルの方が適していることになる <span class="citation" data-cites="Gardiner+2009">(Gardiner et al., 2009)</span>．実際，モデルの特定に成功していれば，いずれのパラメータも最尤推定されるため，一致性を持つ．</p>
<p>従って，モデル選択において用いられる基準も違う．GEE における作業相関係数行列と説明変数の選択には QIC (Quasi-likelihood Information Criterion) が，混合効果モデルには AIC や BIC （または cAIC や mAIC <span class="citation" data-cites="Vaida-Blanchard2005">(Vaida &amp; Blanchard, 2005)</span>）が用いられる <span class="citation" data-cites="Gardiner+2009">(Gardiner et al., 2009, p. 228)</span>．</p>
<!--

本データを扱った論文 [@Thall-Vail1990] では，[@Liang-Zeger1986] の一般化推定方程式の枠組みに則り，共分散の構造にどのようなパラメトリック分布を仮定するのが良いかが，漸近論の観点から議論されている．

-->
</section>
<section id="ベイズ混合効果モデルという光" class="level4" data-number="2.4.2">
<h4 data-number="2.4.2" class="anchored" data-anchor-id="ベイズ混合効果モデルという光"><span class="header-section-number">2.4.2</span> ベイズ混合効果モデルという光……？</h4>
<p>しかし，結局ベイズ統計学の立場からは，２つの違いはほとんど重要ではなく，混合効果モデルを推定した後に，周辺化をして平均構造に関する marginal estimator を構成すれば，GEE の代用になっているのではないか？</p>
<p>計算機の性能と，計算統計手法の発展が目まぐるしい現代にて，過去の議論を踏襲しすぎることは，問題の本質を誤るということもあるのだろう．</p>
<p>ということで，以上議論したグループレベル構造を持ったデータに対する２階の階層モデルを，本稿では「混合効果モデル」と呼ぶことにする．</p>
<p>この節はこれで終わり．</p>
</section>
</section>
</section>
<section id="混合効果モデリングにおける注意点" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="混合効果モデリングにおける注意点"><span class="header-section-number">3</span> 混合効果モデリングにおける注意点</h2>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="概要">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
概要
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>混合効果モデルの推定において，グループレベル変動 <img src="https://latex.codecogs.com/png.latex?%5Calpha_%7Bs%5Bi%5D%7D"> の共分散行列 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BV%7D%5B%5Ceta_s%5D"> の推定が不安定になり得る．特に，グループ数 <img src="https://latex.codecogs.com/png.latex?S"> が小さい場合に顕著である．</li>
<li>カウントデータの Poisson モデルでは，観測レベルのランダム効果を追加することで，実質的に Poisson-対数正規混合モデリングを実行できる．</li>
</ul>
</div>
</div>
<section id="sec-group-level-variance-estimation" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="sec-group-level-variance-estimation"><span class="header-section-number">3.1</span> グループレベル分散の推定</h3>
<p>混合効果モデル（階層モデル）の推定において，特にグループ数 <img src="https://latex.codecogs.com/png.latex?S"> が小さい場合，グループレベルの変動切片項 <img src="https://latex.codecogs.com/png.latex?%5Calpha_%7Bs%5Bi%5D%7D"> の共分散行列 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BV%7D%5B%5Ceta_s%5D"> の推定が不安定になるという問題点が古くからの問題である <span class="citation" data-cites="Harville1977">(Harville, 1977)</span>．<sup>16</sup></p>
<p>この <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BV%7D%5B%5Ceta_s%5D"> は何の仮定も置かれておらず，グループ間の相関構造のモデリングを一手に引き受けている．EM アルゴリズムが提案されたばかりの頃 <span class="citation" data-cites="Laird-Ware1982">(Laird &amp; Ware, 1982)</span> では，共分散構造にパラメトリックな仮定をおいていたが，現代ではこれを取り去った最尤推定法・ベイズ推定法が主流である．</p>
<p>しかし，最尤推定法と，一定の事前分布を仮定したベイズ MAP 推定法では，推定された共分散行列が退化してしまうことがある．これは Wishart 事前分布を仮定することでこれが回避される <span class="citation" data-cites="Chung+2015">(Chung et al., 2015)</span>．<sup>17</sup> これは最尤法の文脈では，penalized likelihood と等価になる <span class="citation" data-cites="Chung+2013">(Chung et al., 2013)</span>．</p>
<p>モデルのサイズによっては，完全なベイズ推定を実行することが難しく，一部は等価な頻度論的な方法や近似を用いることもある．その際，最適化ソルバーの収束を速めるために，共分散構造に（データや計画とは無関係に）パラメトリックモデルを仮定してしまうこともある <span class="citation" data-cites="Kincaid2005">(Kincaid, 2005)</span>．</p>
</section>
<section id="sec-subsec-count-data" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="sec-subsec-count-data"><span class="header-section-number">3.2</span> カウントデータのモデリング</h3>
<p>カウントデータの基本は Poisson 分布であろうが，過分散を考慮するために，負の二項分布でモデリングすることもできる．これは例えば，マーケティングにおいて，顧客の購買回数をモデル化する際に用いられる <span class="citation" data-cites="森岡-今西16-確率思考の戦略論">(森岡毅，今西聖貴, 2016)</span>．</p>
<p>この行為は，Poisson 分布の Gamma 分布による混合分布族を用いた，混合モデリングを行っているとみなせる：</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題
</div>
</div>
<div class="callout-body-container callout-body">
<p>Poisson 分布 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BPois%7D(%5Ctheta)"> の <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BGamma%7D(%5Calpha,%5Cnu)">-混合は負の二項分布 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BNB%7D%5Cleft(%5Cnu,%5Cfrac%7B%5Calpha%7D%7B%5Calpha+1%7D%5Cright)"> になる．</p>
<p>ただし，負の二項分布 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BNB%7D(%5Cnu,p)"> は，次の確率質量関数 <img src="https://latex.codecogs.com/png.latex?p(x;%5Cnu,p)"> が定める <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BN%7D"> 上の確率分布である： <img src="https://latex.codecogs.com/png.latex?%0Ap(x;%5Cnu,p)=%5Cbegin%7Bpmatrix%7Dx+%5Cnu-1%5C%5Cx%5Cend%7Bpmatrix%7Dp%5E%5Cnu(1-p)%5Ex.%0A"></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>確率分布の変換則より，次のように計算できる：</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20p(x)&amp;=%5Cint_%7B%5Cmathbb%7BR%7D_+%7D%5Cfrac%7B%5Ctheta%5Ex%7D%7Bx!%7De%5E%7B-%5Ctheta%7D%5Cfrac%7B1%7D%7B%5CGamma(%5Cnu)%7D%5Calpha%5E%5Cnu%5Ctheta%5E%7B%5Cnu-1%7De%5E%7B-%5Calpha%5Ctheta%7Dd%5Ctheta%5C%5C%0A%20%20&amp;=%5Cfrac%7B%5Calpha%5E%5Cnu%7D%7Bx!%5CGamma(%5Cnu)%7D%5Cint_%7B%5Cmathbb%7BR%7D_+%7D%5Ctheta%5E%7Bx+%5Cnu-1%7De%5E%7B-(%5Calpha+1)%5Ctheta%7Dd%5Ctheta%5C%5C%0A%20%20&amp;=%5Cfrac%7B%5Calpha%5E%5Cnu%7D%7Bx!%5CGamma(%5Cnu)%7D%5Cfrac%7B%5CGamma(x+%5Cnu)%7D%7B(%5Calpha+1)%5E%7Bx+%5Cnu%7D%7D%5C%5C%0A%20%20&amp;=%5Cbegin%7Bpmatrix%7D%5Cnu+x-1%5C%5Cx%5Cend%7Bpmatrix%7D%5Cleft(%5Cfrac%7B1%7D%7B%5Calpha+1%7D%5Cright)%5Ex%5Cleft(%5Cfrac%7B%5Calpha%7D%7B%5Calpha+1%7D%5Cright)%5E%5Cnu.%0A%5Cend%7Balign*%7D"></p>
<p>この最右辺は，たしかに負の二項分布の質量関数である．</p>
<p>この証明方法と，Gamma 分布については次の記事を参照：</p>
<div class="article-card-container">
  <div class="article-card">
    <a href="https://162348.github.io/posts/2023/Probability/Beta-Gamma.html" target="_blank">
      <img src="https://162348.github.io/posts/2023/Probability/Beta-Gamma_files/figure-html/cell-4-output-1.png" alt="Article Image" class="article-image">
      <div class="article-content">
        <h3 class="article-title anchored">確率測度の変換則</h3>
        <p class="article-description">Gamma 分布とBeta 分布を例に</p>
      </div>
    </a>
  </div>
</div>
</div>
</div>
</div>
<p>Poisson 回帰</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%20y_%7Bit%7D%20&amp;%20%5Csim%20%5Coperatorname%7BPois%7D(%5Clambda_%7Bs%5Bi%5D%7D)%20%5C%5C%20%5Clog(%5Clambda_%7Bs%5Bi%5D%7D)%20&amp;%20=%20%5Calpha_i%20+%20%5Ceta_%7Bit%7D%20%5C%5C%20%5Ceta_%7Bit%7D%20&amp;%20%5Csim%20%5Coperatorname%7BN%7D(0,%20%5Csigma).%20%5Cend%7Balign*%7D%0A"></p>
<p>を考えると，各 <img src="https://latex.codecogs.com/png.latex?y_%7Bit%7D"> を，（グループ毎に条件付ければ）Poisson 分布の対数正規分布による混合分布を用いてモデル化していることにあたる．</p>
<p>この，Poisson-対数正規分布族は，<span class="citation" data-cites="Bulmer1974">(Bulmer, 1974)</span> により生物種の個体数分布のモデリングで，過分散を説明するために用いられている．</p>
<p>すなわち，第 1 節のモデルの比較 1.3 で扱った，<strong>観測レベルランダム効果</strong> (OLRE: Observation-level Random Effects) の方法は，<u>観測毎に <img src="https://latex.codecogs.com/png.latex?%5Ceta_%7Bit%7D"> というランダム切片項を追加するだけで，本質的には Poisson-対数正規混合モデリングを実施する</u> という，いわばハックのような使い方である．<sup>18</sup></p>
<p>今回はモデル比較の結果が良かったため，本格的に対数正規混合を実施してみるのも良いかもしれない．</p>
</section>
</section>
<section id="brmsの実装" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="brmsの実装"><span class="header-section-number">4</span> <code>brms</code>の実装</h2>
<p><a href="https://paul-buerkner.github.io/brms/reference/brm.html"><code>brm</code> 関数</a>（コードは <a href="https://github.com/paul-buerkner/brms/blob/master/R/brm.R">こちら</a>）の実装を調べる．</p>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li><a href="https://github.com/paul-buerkner/brms/blob/master/R/brm.R#L436"><code>brms</code></a></li>
</ul>
<p>Stan コードを扱っている関数は <a href="https://github.com/paul-buerkner/brms/blob/d42adcd22f5af441870038b1d78ad4d9408f344f/R/stancode.R"><code>.stancode()</code></a> であった．最終的に，<a href="https://github.com/paul-buerkner/brms/blob/d42adcd22f5af441870038b1d78ad4d9408f344f/R/backends.R#L67"><code>.compile_model_rstan()</code></a> と <a href="https://github.com/paul-buerkner/brms/blob/d42adcd22f5af441870038b1d78ad4d9408f344f/R/backends.R#L145"><code>.fit_model_rstan()</code></a> が呼ばれるようになっている．</p>
<ul>
<li><a href="https://github.com/paul-buerkner/brms/blob/d42adcd22f5af441870038b1d78ad4d9408f344f/R/standata.R#L109"><code>.standata</code></a></li>
</ul>
</div>
</div>
</div>
<section id="事前分布" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="事前分布"><span class="header-section-number">4.1</span> 事前分布</h3>
<p><a href="https://paul-buerkner.github.io/brms/reference/brm.html"><code>brm</code>関数</a> では，デフォルトでは無情報事前分布が用いられる．</p>
<blockquote class="blockquote">
<p>Default priors are chosen to be non or very weakly informative so that their influence on the results will be negligible and you usually don’t have to worry about them. However, after getting more familiar with Bayesian statistics, I recommend you to start thinking about reasonable informative priors for your model parameters: Nearly always, there is at least some prior information available that can be used to improve your inference.<br><a href="https://paul-buerkner.github.io/brms/reference/brm.html">brm(): Fit Bayesian Generalized (Non-)Linear Multivariate Multilevel Models</a></p>
</blockquote>
</section>
<section id="回帰式" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="回帰式"><span class="header-section-number">4.2</span> 回帰式</h3>
<p><code>brm()</code>関数の第一引数は，<code>validate_formula</code>関数に渡される．</p>
<p>この関数は S3 のメソッドのディスパッチを用いて実装されており，<code>brmsformula</code>オブジェクトに対しては，<code>validate_formula.brmsformula</code>関数が呼び出される．</p>
<p>ここでは<code>autocor</code>引数が引かれている場合，出力の<code>formula</code>属性に追加される：<sup>19</sup></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1">fit3<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>formula</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>count ~ zAge + zBase * Trt + (1 | patient) 
autocor ~ unstr(time = visit, gr = patient)</code></pre>
</div>
</div>
<p>なお，<code>brmsformula</code>オブジェクトのコンストラクタは <a href="http://paul-buerkner.github.io/brms/reference/brmsformula.html"><code>brmsformula()</code>関数</a> である．これは，R の<code>formula</code>オブジェクトを通じて，階層モデルを定義できるようになっている（実装は<a href="../../../posts/2024/Computation/R3.html">リスト</a>）．</p>
</section>
<section id="sec-ubsubsec-covariance-structure" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="sec-ubsubsec-covariance-structure"><span class="header-section-number">4.3</span> 共分散構造</h3>
<p>共分散構造は２つの観点から，<code>brmsformula</code>オブジェクトから自動的に指定される．</p>
<p>１つ目がグルーピング構造（共分散行列のブロック構造）であり，これは<a href="https://paul-buerkner.github.io/brms/reference/gr.html"><code>gr</code>関数</a> が使用される．</p>
<p>２つ目がグループ内の相関構造であり，これは<code>brm()</code>関数の<code>autocor</code>引数を用いる．</p>
<section id="gr関数" class="level4" data-number="4.3.1">
<h4 data-number="4.3.1" class="anchored" data-anchor-id="gr関数"><span class="header-section-number">4.3.1</span> <code>gr</code>関数</h4>
<p>この関数は<code>brm</code>関数の第一引数として与えられたモデル定義式から，暗黙のうちに内部で呼び出される．</p>
<p>例えば，回帰式に<code>(1|patient)</code>が含まれていた場合，<code>gr(patient)</code>が呼び出される．</p>
<p>共分散構造におく仮定について，重要なデフォルト設定が２つある：</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li><p>グループ間の相関構造は想定されている：<code>cor=True</code>．</p>
<blockquote class="blockquote">
<p>If <code>TRUE</code> (the default), group-level terms will be modelled as correlated.<br><a href="https://paul-buerkner.github.io/brms/reference/gr.html">gr(): Set up basic grouping terms in brms</a></p>
</blockquote></li>
<li><p>一方で，グループ内の相関構造は想定されておらず，独立とされている．具体的に指定したい場合は引数<code>cov</code>を用いる．</p>
<blockquote class="blockquote">
<p>By default, levels of the same grouping factor are modeled as independent of each other.<br><a href="https://paul-buerkner.github.io/brms/reference/gr.html">gr(): Set up basic grouping terms in brms</a></p>
</blockquote></li>
</ul>
<p>すなわち，<img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BV%7D%5B%5Ceta_s%5D"> には一切仮定が置かれておらず（第 3.1 節），一方で <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Cepsilon_%7Bit%7D%5C%7D_%7Bt=1%7D%5ET"> は互いに独立とされている．</p>
</div>
</div>
</div>
<p>また，この二階層目の分布族（第 2.1 節での <img src="https://latex.codecogs.com/png.latex?%5Calpha_i"> と <img src="https://latex.codecogs.com/png.latex?%5Ceta_%7Bit%7D">）は，分散共分散行列 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BV%7D%5B%5Ceta_s%5D"> を持った正規分布がデフォルトで，現状他の分布族は指定できないでいる．</p>
<blockquote class="blockquote">
<p>dist: Name of the distribution of the group-level effects. Currently “gaussian” is the only option.<br><a href="https://paul-buerkner.github.io/brms/reference/gr.html">gr(): Set up basic grouping terms in brms</a></p>
</blockquote>
</section>
<section id="sec-autocor-argument" class="level4" data-number="4.3.2">
<h4 data-number="4.3.2" class="anchored" data-anchor-id="sec-autocor-argument"><span class="header-section-number">4.3.2</span> <code>autocor</code>引数</h4>
<p><code>brm()</code>関数には，<a href="http://paul-buerkner.github.io/brms/reference/autocor-terms.html"><code>autocor</code>引数</a> が用意されている．</p>
<p><code>gr()</code>のデフォルト値では独立とされていたグループ内の相関構造を，具体的に指定するのに用いられる．</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li><code>unstr</code>：一才の仮定を置かない．</li>
<li><code>AR</code>：一次の自己相関構造．</li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="推論エンジン" class="level3" data-number="4.4">
<h3 data-number="4.4" class="anchored" data-anchor-id="推論エンジン"><span class="header-section-number">4.4</span> 推論エンジン</h3>
<p><a href="https://paul-buerkner.github.io/brms/reference/brm.html"><code>brm</code>関数</a> は，Stan による MCMC サンプリングを通じて，事後分布を計算する．</p>
</section>
</section>



<div id="quarto-appendix" class="default"><section id="acknowledgements" class="level2 appendix" data-number="5"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">5</span> Acknowledgements</h2><div class="quarto-appendix-contents">

<p>I would like to extend my gratitude to Robert Long, who kindly shared me the knowledge about the covariance structure implicitly defined via <code>brms</code> formula on <a href="https://stats.stackexchange.com/questions/649358/the-default-covariance-structure-implicitly-assumed-in-the-brms-formula/650015#650015">this Cross Validated post</a>. His insights were instrumental in enhancing this work.</p>



</div></section><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-Bafumi-Gelman2007" class="csl-entry">
Bafumi, J., &amp; Gelman, A. (2007). <span class="nocase">Fitting Multilevel Models When Predictors and Group Effects Correlate</span>. <em>SSRN</em>. <a href="https://dx.doi.org/10.2139/ssrn.1010095">https://dx.doi.org/10.2139/ssrn.1010095</a>
</div>
<div id="ref-Bulmer1974" class="csl-entry">
Bulmer, M. G. (1974). On fitting the poisson lognormal distribution to species-abundance data. <em>Biometrics</em>, <em>30</em>(1), 101–110. <a href="http://www.jstor.org/stable/2529621">http://www.jstor.org/stable/2529621</a>
</div>
<div id="ref-Burkner2017" class="csl-entry">
Bürkner, P.-C. (2017). Brms: An r package for bayesian multilevel models using stan. <em>Journal of Statistical Software</em>, <em>80</em>(1), 1–28. <a href="https://doi.org/10.18637/jss.v080.i01">https://doi.org/10.18637/jss.v080.i01</a>
</div>
<div id="ref-Burkner2018" class="csl-entry">
Bürkner, P.-C. (2018). <span class="nocase">Advanced Bayesian Multilevel Modeling with the R Package brms</span>. <em><span>The R Journal</span></em>, <em>10</em>(1), 395–411. <a href="https://doi.org/10.32614/RJ-2018-017">https://doi.org/10.32614/RJ-2018-017</a>
</div>
<div id="ref-Burkner2021" class="csl-entry">
Bürkner, P.-C. (2021). Bayesian item response modeling in r with brms and stan. <em>Journal of Statistical Software</em>, <em>100</em>(5), 1–54. <a href="https://doi.org/10.18637/jss.v100.i05">https://doi.org/10.18637/jss.v100.i05</a>
</div>
<div id="ref-Chung+2015" class="csl-entry">
Chung, Y., Gelman, A., Rabe-Hesketh, S., Liu, J., &amp; Dorie, V. (2015). Weakly informative prior for point estimation of covariance matrices in hierarchical models. <em>Journal of Educational and Behavioral Statistics</em>, <em>40</em>(2), 136–157. <a href="https://doi.org/10.3102/1076998615570945">https://doi.org/10.3102/1076998615570945</a>
</div>
<div id="ref-Chung+2013" class="csl-entry">
Chung, Y., Rabe-Hesketh, S., Dorie, V., Gelman, A., &amp; Liu, J. (2013). A nondegenerate penalized likelihood estimator for variance parameters in multilevel models. <em>Psychometrika</em>, <em>78</em>(4), 685–709. <a href="https://doi.org/10.1007/s11336-013-9328-2">https://doi.org/10.1007/s11336-013-9328-2</a>
</div>
<div id="ref-Cunningham21-Mixtape" class="csl-entry">
Cunningham, S. (2021). <em>Causal inference : The mixtape</em>. Yale University Press.
</div>
<div id="ref-Gardiner+2009" class="csl-entry">
Gardiner, J. C., Luo, Z., &amp; Roman, L. A. (2009). Fixed effects, random effects and GEE: What are the differences? <em>Statistics in Medicine</em>, <em>28</em>(2), 221–239. https://doi.org/<a href="https://doi.org/10.1002/sim.3478">https://doi.org/10.1002/sim.3478</a>
</div>
<div id="ref-Hansen2022" class="csl-entry">
Hansen, B. E. (2022). <em>Econometrics</em>. Princeton University Press.
</div>
<div id="ref-Harville1977" class="csl-entry">
Harville, D. A. (1977). Maximum likelihood approaches to variance component estimation and to related problems. <em>Journal of the American Statistical Association</em>, <em>72</em>(358), 320–338. <a href="https://doi.org/10.1080/01621459.1977.10480998">https://doi.org/10.1080/01621459.1977.10480998</a>
</div>
<div id="ref-Hubbard+2010" class="csl-entry">
Hubbard, A. E., Ahern, J., Fleischer, N. L., Laan, M. V. der, Lippman, S. A., Jewell, N., Bruckner, T., &amp; Satariano, W. A. (2010). To GEE or not to GEE: Comparing population average and mixed models for estimating the associations between neighborhood risk factors and health. <em>Epidemiology</em>, <em>21</em>(4). <a href="https://journals.lww.com/epidem/fulltext/2010/07000/to_gee_or_not_to_gee__comparing_population_average.7.aspx">https://journals.lww.com/epidem/fulltext/2010/07000/to_gee_or_not_to_gee__comparing_population_average.7.aspx</a>
</div>
<div id="ref-Kincaid2005" class="csl-entry">
Kincaid, C. D. (2005). <span class="nocase">Guidelines for Selecting the Covariance Structure in Mixed Model Analysis</span>. <em>SAS User Group International</em>, <em>30</em>, 198–130. <a href="https://support.sas.com/resources/papers/proceedings/proceedings/sugi30/198-30.pdf">https://support.sas.com/resources/papers/proceedings/proceedings/sugi30/198-30.pdf</a>
</div>
<div id="ref-Laird-Ware1982" class="csl-entry">
Laird, N. M., &amp; Ware, J. H. (1982). Random-effects models for longitudinal data. <em>Biometrics</em>, <em>38</em>(4), 963–974. <a href="http://www.jstor.org/stable/2529876">http://www.jstor.org/stable/2529876</a>
</div>
<div id="ref-Leppik+1987" class="csl-entry">
Leppik, I. E., Dreifuss, F. E., Porter, R., Bowman, T., Santilli, N., Jacobs, M., Crosby, C., Cloyd, J., Stackman, J., Graves, N., Sutula, T., Welty, T., Vickery, J., Brundage, R., Gates, J., Gumnit, R. J., &amp; Gutierrez, A. (1987). A controlled study of progabide in partial seizures. <em>Neurology</em>, <em>37</em>(6), 963–963. <a href="https://doi.org/10.1212/WNL.37.6.963">https://doi.org/10.1212/WNL.37.6.963</a>
</div>
<div id="ref-Thall-Vail1990" class="csl-entry">
Thall, P. F., &amp; Vail, S. C. (1990). Some covariance models for longitudinal count data with overdispersion. <em>Biometrics</em>, <em>46</em>(3), 657–671. <a href="http://www.jstor.org/stable/2532086">http://www.jstor.org/stable/2532086</a>
</div>
<div id="ref-Vaida-Blanchard2005" class="csl-entry">
Vaida, F., &amp; Blanchard, S. (2005). Conditional akaike information for mixed-effects models. <em>Biometrika</em>, <em>92</em>(2), 351–370. <a href="http://www.jstor.org/stable/20441193">http://www.jstor.org/stable/20441193</a>
</div>
<div id="ref-Vehtari+2021" class="csl-entry">
Vehtari, A., Gelman, A., Simpson, D., Carpenter, B., &amp; Bürkner, P.-C. (2021). <span class="nocase">Rank-Normalization, Folding, and Localization: An Improved <img src="https://latex.codecogs.com/png.latex?%5Cwidehat%7BR%7D"> for Assessing Convergence of MCMC (with Discussion)</span>. <em>Bayesian Analysis</em>, <em>16</em>(2), 667–718. <a href="https://doi.org/10.1214/20-BA1221">https://doi.org/10.1214/20-BA1221</a>
</div>
<div id="ref-森岡-今西16-確率思考の戦略論" class="csl-entry">
森岡毅，今西聖貴. (2016). <em>確率思考の戦略論―ＵＳＪでも実証された数学マーケティングの力</em>. 角川書店.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>R を最新バージョン 4.3.1 → 4.4.0 にアップデートしなければインストールに失敗したことに注意．↩︎</p></li>
<li id="fn2"><p>通常は時間的に離れている観測は相関が薄いとしても，直近の観測と関連性が高いだろう．↩︎</p></li>
<li id="fn3"><p>Statistical Modeling, Causal Inference, and Social Science における <a href="https://statmodeling.stat.columbia.edu/2024/05/08/bamdd/">こちらのエントリ</a> も参照．↩︎</p></li>
<li id="fn4"><p><span class="citation" data-cites="Hansen2022">(Hansen, 2022, p. 333)</span> 第12.3節，<span class="citation" data-cites="Bafumi-Gelman2007">(Bafumi &amp; Gelman, 2007, p. 3)</span>, <span class="citation" data-cites="Hansen2022">(Hansen, 2022, p. 604)</span>，<span class="citation" data-cites="Gardiner+2009">(Gardiner et al., 2009, p. 228)</span>．↩︎</p></li>
<li id="fn5"><p>このような誤差項の構造 <img src="https://latex.codecogs.com/png.latex?e_%7Bit%7D=%5Calpha_i+%5Cepsilon_%7Bit%7D"> を一元誤差成分モデル (one-way error component model) ともいう <span class="citation" data-cites="Hansen2022">(Hansen, 2022, p. 600)</span>．↩︎</p></li>
<li id="fn6"><p>この，説明変数と誤差の間に相関があることを，計量経済学では <strong>内生性</strong> (endogeneity) という．↩︎</p></li>
<li id="fn7"><p><span class="citation" data-cites="Bafumi-Gelman2007">(Bafumi &amp; Gelman, 2007, p. 5)</span>．↩︎</p></li>
<li id="fn8"><p><span class="citation" data-cites="Bafumi-Gelman2007">(Bafumi &amp; Gelman, 2007, p. 5)</span>，<span class="citation" data-cites="Hansen2022">(Hansen, 2022, p. 609)</span> 17.11節 など．狭義では，fixed effects model は within transformation を行い，グループ間の影響を引いたあとに回帰を実行する……という手続きを指すこともあるが，２つは等価な結果を生む．詳しくは <span class="citation" data-cites="Cunningham21-Mixtape">(Cunningham, 2021)</span> なども参照．↩︎</p></li>
<li id="fn9"><p><span class="citation" data-cites="Hansen2022">(Hansen, 2022, p. 624)</span> 17.25節．↩︎</p></li>
<li id="fn10"><p><span class="citation" data-cites="Bafumi-Gelman2007">(Bafumi &amp; Gelman, 2007, pp. 4–5)</span>．↩︎</p></li>
<li id="fn11"><p><span class="citation" data-cites="Hansen2022">(Hansen, 2022, p. 624)</span>，<span class="citation" data-cites="Bafumi-Gelman2007">(Bafumi &amp; Gelman, 2007, p. 6)</span>．↩︎</p></li>
<li id="fn12"><p><span class="citation" data-cites="Bafumi-Gelman2007">(Bafumi &amp; Gelman, 2007, p. 6)</span>．↩︎</p></li>
<li id="fn13"><p><span class="citation" data-cites="Hubbard+2010">(Hubbard et al., 2010)</span> では両方の名前で呼んでいる．↩︎</p></li>
<li id="fn14"><p><span class="citation" data-cites="Hansen2022">(Hansen, 2022, p. 625)</span> 17.25節．疫学・生物統計学では，実験計画法でしか「固定効果」「変量効果モデル」とは言わない，という認識であることも筆者は聞いたことがある．↩︎</p></li>
<li id="fn15"><p><img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BV%7D%5B%5Ceta_s%5D"> はブロック行列の構造を持つためこう呼ばれるs．↩︎</p></li>
<li id="fn16"><p><span class="citation" data-cites="Laird-Ware1982">(Laird &amp; Ware, 1982)</span>，<span class="citation" data-cites="Chung+2013">(Chung et al., 2013)</span>，<span class="citation" data-cites="Chung+2015">(Chung et al., 2015)</span>，<a href="https://statmodeling.stat.columbia.edu/2023/06/02/blme-bayesian-linear-mixed-effects-models/">Statistical Modeling, Causal Inference, and Social Science ブログ 6/2/2023</a>．↩︎</p></li>
<li id="fn17"><p>逆 Wishart ではないらしい <span class="citation" data-cites="Chung+2015">(Chung et al., 2015)</span>．↩︎</p></li>
<li id="fn18"><p><a href="https://solomonkurz.netlify.app/blog/2021-07-12-got-overdispersion-try-observation-level-random-effects-with-the-poisson-lognormal-mixture/#negative-binomial-counts">Solomon Kurtz (2021)</a> による解説，<a href="https://rpubs.com/INBOstats/OLRE">RPubs</a> も参照．↩︎</p></li>
<li id="fn19"><p><a href="https://github.com/paul-buerkner/brms/blob/deb56d02d0f897422a4d1d5a43d18e99400f80a0/R/brmsformula.R#L1363">Line 1363</a>．↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>MCMC</category>
  <category>Stan</category>
  <category>R</category>
  <guid>https://162348.github.io/posts/2024/Computation/brms.html</guid>
  <pubDate>Sat, 11 May 2024 15:00:00 GMT</pubDate>
  <media:content url="https://162348.github.io/posts/2024/Computation/brms_files/figure-html/unnamed-chunk-4-1.png" medium="image" type="image/png" height="96" width="144"/>
</item>
<item>
  <title>志学・応用数学</title>
  <dc:creator>司馬博文 </dc:creator>
  <link>https://162348.github.io/posts/2024/Life/AppliedMath.html</link>
  <description><![CDATA[ 





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<section id="はじめに" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="はじめに"><span class="header-section-number">1</span> はじめに</h2>
<p>現在，AI，専門的には機械学習と呼ばれる分野の研究と社会実装が急速に進んでいる．</p>
<p>機械学習は，元々は情報理論と計算機科学に源流を持つが，ロボティクス，コンピュータビジョン，認知科学，統計力学，統計学を巻き込んで，かつてないほど学際的な研究テーマとして雪だるま式に成長している．</p>
<p>特に，トランスフォーマーや状態空間モデルなどを取り入れた大規模な深層学習モデルは学術・産業の両面で大きな成功を見ている．同時に，大自由度モデルとしての深層学習モデルは，平均場理論をはじめとした統計力学の手法を通じての理論解析も進んでいる．</p>
<p>Tensor Programs <span class="citation" data-cites="Yang2019">(Yang, 2019)</span> など，実際に応用に貢献できる理論も急速に発達してきている．この応用と理論の関係は，今後さらに密接になっていくだろう．</p>
<p>高次元統計学，情報統計力学などがキーワードとなっていくだろう．しかし筆者は，ここに新たなキーワードを提案したい．それは <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> である．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/Life/Images/ModernAppliedMath.svg" class="img-fluid figure-img"></p>
<figcaption>現代の応用数学では，応用分野が増えただけでなく，応用分野間で相互に知見の交換がある．数学は「共通言語」としての役割も期待されていくだろう．</figcaption>
</figure>
</div>
</section>
<section id="mathcalpe-とは" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="mathcalpe-とは"><span class="header-section-number">2</span> <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> とは</h2>
<p>可測空間 <img src="https://latex.codecogs.com/png.latex?(E,%5Cmathcal%7BE%7D)"> に対して，その上の確率測度の全体からなる空間を <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> と表そう．有限な測度の全体 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BM%7D%5E1(E)"> は Banach 空間をなし，<img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> はその閉凸集合である．</p>
<p>統計モデルとは，<img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> の適当に切り出した部分集合をいう．例えば指数分布族のなす部分集合 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D%5Csubset%5Cmathcal%7BP%7D(E)"> などに注目し，その上の微分幾何的な構造を調べる分野は情報幾何学と呼ばれる．</p>
<p>このように統計学で <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> は重要な研究対象であるが，ベイズ統計学ではあらゆる不確実性の表現に確率分布を用いるため，特に重要な役割を果たす．事前分布を条件付けて事後分布を求める手続きは，<img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> 上の写像を与えており，いわば <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> 上の（適切な）移動がベイズ推論といっても過言でないのである．</p>
<p>統計力学において，ランダムな系（時々刻々と物理量の確率分布が移り変わっていく系）は，<img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> 上でみれば決定論的な系として解析できる．例えば，平衡分布とは <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> 上の力学系として見たときの不動点である．このような不動点は複数あり，実際，熱力学極限において等価な予測を与えるモデルは複数存在する．そのうち，計算しやすいものを選ぶのが統計力学の立場であり，統計学でいうモデル選択と対応する．このような統計的な問題を，古典的な推測統計の問題と対比して <strong>順問題</strong> と呼ぶこととする．<sup>1</sup></p>
<div class="article-card-container">
  <div class="article-card">
    <a href="https://162348.github.io/posts/2024/Nature/StatisticalMechanics2.html" target="_blank">
      <img src="https://162348.github.io/posts/2024/Nature/canon.svg" alt="Article Image" class="article-image">
      <div class="article-content">
        <h3 class="article-title anchored">数学者のための統計力学２</h3>
        <p class="article-description">小正準集団・正準集団・大正準集団</p>
      </div>
    </a>
  </div>
</div>
<p>機械学習では，統計的な逆問題を解くという問題意識を古典的な統計学と共有しており，特に <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> 上に真のデータ分布 <img src="https://latex.codecogs.com/png.latex?P_0%5Cin%5Cmathcal%7BP%7D(E)"> を特定することを目標とする．しかし古典的なデータ解析の手法でこれを達成するのではなく，様々な尺度（汎函数 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)%5E2%5Cto%5Cmathbb%7BR%7D">）を通じて，<img src="https://latex.codecogs.com/png.latex?P_0"> に最も近い分布を選び出すという原則を採る．この <strong>乖離度</strong> (divergence) と呼ばれる汎函数を最適化することにより，データ解析の手続きを自動化することが，機械学習に通底する精神である．</p>
</section>
<section id="物理学と機械学習の双対性" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="物理学と機械学習の双対性"><span class="header-section-number">3</span> 物理学と機械学習の双対性</h2>
<p>ここで筆者は，この <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> を中心に据えてこれらの分野を見渡してみると，物理学と機械学習の間に双対的な関係があると考える．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/Life/Images/AppliedMath.svg" class="img-fluid figure-img"></p>
<figcaption>左：数学における幾何と解析の双対性．右：これからの応用数学における物理的アプローチと機械学習的アプローチの双対性．</figcaption>
</figure>
</div>
<section id="幾何学と解析学は双対である" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="幾何学と解析学は双対である"><span class="header-section-number">3.1</span> 幾何学と解析学は双対である</h3>
<p>数学者 <a href="https://en.wikipedia.org/wiki/Mikhael_Gromov_(mathematician)">Mikhael Gromov</a> によると，空間 <img src="https://latex.codecogs.com/png.latex?X"> の解析学とは <img src="https://latex.codecogs.com/png.latex?X"> <strong>上の</strong> 関数の研究で，<img src="https://latex.codecogs.com/png.latex?X"> の幾何学とは <img src="https://latex.codecogs.com/png.latex?X"> <strong>への</strong> 関数の研究である <span class="citation" data-cites="深谷賢治1997">(深谷賢治, 1997, p. 11)</span>．<sup>2</sup></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.math.kyoto-u.ac.jp/~fukaya/shzuok.pdf"><img src="https://162348.github.io/posts/2024/Kernels/Images/Gromov.png" class="img-fluid figure-img" alt="Gromov による幾何と解析の解釈（深谷賢治講義録より）"></a></p>
<figcaption>Gromov による幾何と解析の解釈（深谷賢治講義録より）</figcaption>
</figure>
</div>
<p>だからといって何だというわけではないが，幾何と解析の，未知の対象 <img src="https://latex.codecogs.com/png.latex?X"> へのアプローチの違いを上手く捉えた，大変簡潔な定義である．</p>
</section>
<section id="物理学は" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="物理学は"><span class="header-section-number">3.2</span> 物理学は</h3>
<p>いわば統計の <strong>順問題</strong> を解いてきたと言える．</p>
<p>（平衡）統計力学は系の統計的ふるまいを記述するために，正準集団を代表としていくつかの等価なモデルを用意しており，<sup>3</sup> 場合に応じて計算しやすいものを用いるというモデル選択の立場に立っていると言える．<sup>4</sup></p>
<p>系の確率的なダイナミクスを予測するために <span class="citation" data-cites="Metropolis+1953">(Metropolis et al., 1953)</span> や <span class="citation" data-cites="Glauber1963">(Glauber, 1963)</span> の方法など，現在 MCMC として知られる重要なシミュレーション法が開発された．</p>
<p>つまり，現代ではベイズ統計学では事後分布からの推論手法として用いられる MCMC は，物理学においては「実際の系よりも高速に平衡に至るように設計された Markov ダイナミクス」として発明されたものであり，平衡分布の統計的な性質を調べようとするサンプリング法として開発されたということである．</p>
<p>MCMC の近年の発展はこちらの記事も参照：</p>
<div class="article-card-container">
  <div class="article-card">
    <a href="https://162348.github.io/posts/2024/Computation/MCMC.html" target="_blank">
      <img src="https://162348.github.io/static/Posters/ISM-OH2024.jpg" alt="Article Image" class="article-image">
      <div class="article-content">
        <h3 class="article-title anchored">新時代の MCMC を迎えるために</h3>
        <p class="article-description">連続時間アルゴリズムへの進化</p>
      </div>
    </a>
  </div>
</div>
<!--

Markov 連鎖のエルゴード性の研究は，統計力学の発展と両輪であった．Markov 性はなんといってもランダムな自然現象の基本的なモデルであり，これを通じて確率的なダイナミクスを調べるという方法は強力な計算科学の手法として受け入れられた．

統計力学は順問題的である側面があり，コレを逆問題に応用したのがベイズ統計学であると捉えられる．

加えて，SDE と拡散過程は熱方程式をはじめとする PDE の幾何学的な解釈を与える．

-->
</section>
<section id="機械学習では" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="機械学習では"><span class="header-section-number">3.3</span> 機械学習では，</h3>
<p>基本的には統計的な逆問題，すなわちデータから背後の確率分布を推定する問題を解く．</p>
<p>だが，特に統計的な手続きを <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> 上の力学系を通じて自動化しようという志向が古典的な統計学と異なる．</p>
<p>ベイズ手法を例にとれば，推論を MCMC などのダイナミクスに任せるのではなく，KL-乖離度を最小にする最適化によって実行する（変分推論という）．</p>
<p>変分推論だけでなく，多くの物理学的な原理が，何かしらの汎函数の最小化問題として変分法的に理解されるのと同様，<sup>5</sup> 機械学習の多くのアルゴリズムは <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> 上の汎函数（特に KL-乖離度）の最適化問題として理解される．</p>
</section>
</section>
<section id="双対性の未来" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="双対性の未来"><span class="header-section-number">4</span> 双対性の未来</h2>
<p>こうして，<strong><img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> への写像</strong> を志向する物理学と，<strong><img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> からの写像</strong> を志向する機械学習の間に，基本的な立場の違いを見るのである．</p>
<p>今までも，そしておそらくこれからも，逆問題（統計的推論）においては，変分法と最適化によるアプローチの方が計算が速い．従って，たとえベイズ推論が必要な場面でも，MCMC よりは変分推論アルゴリズムを実装に用いることが多い．</p>
<p>しかし，MCMC をはじめとしたサンプリング法には，物理学的な美点がある．Ising 模型などの統計力学のモデルの平衡分布の様子を調べるのが MCMC の第一義的な用途であったように，機械学習モデルでも事後分布の様子を直接観察できる貴重な手段になるという点である．</p>
<p>すなわち，計算機シミュレーションは物理学においては実験を補間する「第三の手法」として位置付けられるかもしれないが，機械学習においては「唯一の実験手段」としての立場を確立するかもしれない．</p>
<div class="article-card-container">
  <div class="article-card">
    <a href="https://162348.github.io/posts/2024/Computation/AboutSimulation.html" target="_blank">
      <img src="https://162348.github.io/posts/2024/Computation/Files/computation.png" alt="Article Image" class="article-image">
      <div class="article-content">
        <h3 class="article-title anchored">計算とは何か</h3>
        <p class="article-description">数値実験と LLM とはいずれもシミュレーションに使えるが，用いる形式が違う（数字と文字）．これにより，物理的な用途と社会的な用途とに別れている．この形式の違いを超克するのが機械学習の悲願であるとするならば，計算とはなんだろうか？ Monte Carlo 法とはシミュレーションにより計算を実行する手段である．</p>
      </div>
    </a>
  </div>
</div>
<p>物理学において，変分原理とその他の理論との間に相補的な関係があるように，統計においても，変分推論と MCMC，果てには（本稿でいう）機械学習的なアプローチと物理学的なアプローチとは相補的な関係を果たしていくと考えられる．</p>
</section>
<section id="これからの応用数学" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="これからの応用数学"><span class="header-section-number">5</span> これからの応用数学</h2>
<p>そのためには，統計的な営みを <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> 上での数学的現象として捉え直し，物理学と機械学習の互いに双対的な２つの観点からの意味を比較考慮することが重要である．</p>
<p>そうすれば，ベイズ模型の物理的な意味を解析する場面と，高速なデータ解析を実行したい場面とに，明瞭な架け橋が渡されるのである．</p>
<p>統計的推論というダイナミクスを，変分原理の眼から捉える，情報の物理学になるかもしれない．変分原理に，かつてなかったベイズ推論としての意味や事前分布が明確化されることで，種々の推論アルゴリズムを統一的に理解することができるかもしれない．</p>
<p>このような観点から，<img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> という共通言語を中心に据えて，物理学と機械学習の２つのアプローチを融和させる，新たな応用数学を建てたい．</p>
<div class="table-responsive-sm">
<table class="table-striped table-hover table">
<caption>これからの統計数学と２つのアプローチ</caption>
<colgroup>
<col style="width: 10%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">物理的アプローチ</th>
<th style="text-align: center;">機械学習的アプローチ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">数学的内容</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> 上の幾何</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> 上の解析</td>
</tr>
<tr class="even">
<td style="text-align: center;">統計的関心</td>
<td style="text-align: center;">順問題</td>
<td style="text-align: center;">逆問題</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ベイズ推論エンジン</td>
<td style="text-align: center;">MCMC</td>
<td style="text-align: center;">変分推論</td>
</tr>
<tr class="even">
<td style="text-align: center;">解析者</td>
<td style="text-align: center;">人間</td>
<td style="text-align: center;">計算機</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="例" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="例"><span class="header-section-number">6</span> 例</h2>
<p>現時点で筆者が集めている例は次のとおりである：</p>
<section id="機械学習とはmathcalpx-上の力学系である" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="機械学習とはmathcalpx-上の力学系である"><span class="header-section-number">6.1</span> 機械学習とは，<img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(X)"> 上の力学系である</h3>
<p>機械学習の過程が，相互情報量の最小化の過程として特徴付けられたのは <span class="citation" data-cites="Ackley+1985">(Ackley et al., 1985)</span> 以来であるようである．</p>
</section>
<section id="smc-テンパリング" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="smc-テンパリング"><span class="header-section-number">6.2</span> SMC テンパリング</h3>
<p>例えば，MCMC よりも多峰性に強いサンプリング法として期待されている <a href="../../../posts/Surveys/SMCSamplers.html">テンパリング SMC 法</a><sup>6</sup> は，最適化の観点からは，KL ダイバージェンスを <a href="https://en.wikipedia.org/wiki/Mirror_descent">鏡映降下法</a> によって最小化した際の離散力学系と等価になると報告されている <span class="citation" data-cites="Chopin+2023">(Chopin et al., 2023)</span>．</p>



</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-Ackley+1985" class="csl-entry">
Ackley, D. H., Hinton, G. E., &amp; Sejnowski, T. J. (1985). A learning algorithm for boltzmann machines. <em>Cognitive Science</em>, <em>9</em>(1), 147–169. https://doi.org/<a href="https://doi.org/10.1016/S0364-0213(85)80012-4">https://doi.org/10.1016/S0364-0213(85)80012-4</a>
</div>
<div id="ref-Chopin+2023" class="csl-entry">
Chopin, N., Crucinio, F. R., &amp; Korba, A. (2023). <em>A connection between tempering and entropic mirror descent</em>. <a href="https://arxiv.org/abs/2310.11914">https://arxiv.org/abs/2310.11914</a>
</div>
<div id="ref-Chopin-Papaspiliopoulos20-SMC" class="csl-entry">
Chopin, N., &amp; Papaspiliopoulos, O. (2020). <em>An introduction to sequential monte carlo</em>. Springer Cham.
</div>
<div id="ref-Glauber1963" class="csl-entry">
Glauber, R. J. (1963). <span class="nocase">Time‐Dependent Statistics of the Ising Model</span>. <em>Journal of Mathematical Physics</em>, <em>4</em>(2), 294–307. <a href="https://doi.org/10.1063/1.1703954">https://doi.org/10.1063/1.1703954</a>
</div>
<div id="ref-Metropolis+1953" class="csl-entry">
Metropolis, N., Rosenbluth, A. W., Rosenbluth, M. N., Teller, A. H., &amp; Teller, E. (1953). Equation of state calculations by fast computing machines. <em>The Journal of Chemical Physics</em>, <em>21</em>(6), 1087–1092. <a href="https://doi.org/10.1063/1.1699114">https://doi.org/10.1063/1.1699114</a>
</div>
<div id="ref-Yang2019" class="csl-entry">
Yang, G. (2019). Wide feedforward or recurrent neural networks of any architecture are gaussian processes. In H. Wallach, H. Larochelle, A. Beygelzimer, F. dAlché-Buc, E. Fox, &amp; R. Garnett (Eds.), <em>Advances in neural information processing systems</em> (Vol. 32). Curran Associates, Inc. <a href="https://proceedings.neurips.cc/paper_files/paper/2019/file/5e69fda38cda2060819766569fd93aa5-Paper.pdf">https://proceedings.neurips.cc/paper_files/paper/2019/file/5e69fda38cda2060819766569fd93aa5-Paper.pdf</a>
</div>
<div id="ref-戸田+2011" class="csl-entry">
戸田盛和, 斎藤信彦, 久保亮五, &amp; 橋爪夏樹. (2011). <em>統計物理学</em> (新装版, Vol. 5). 岩波書店. <a href="https://www.iwanami.co.jp/book/b259545.html">https://www.iwanami.co.jp/book/b259545.html</a>
</div>
<div id="ref-樺島祥介2002" class="csl-entry">
樺島祥介. (2002). <em>学習と情報の平均場理論</em> (Vol. 2). 岩波書店. <a href="https://www.iwanami.co.jp/book/b476277.html">https://www.iwanami.co.jp/book/b476277.html</a>
</div>
<div id="ref-深谷賢治1997" class="csl-entry">
深谷賢治. (1997). <em>「位相的場の理論」 集中講義ノート</em>. <a href="https://www.math.kyoto-u.ac.jp/~fukaya/">https://www.math.kyoto-u.ac.jp/~fukaya/</a>
</div>
<div id="ref-田崎晴明2008II" class="csl-entry">
田崎晴明. (2008). <em>統計力学II</em> (Vol. 38). 培風館.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><span class="citation" data-cites="樺島祥介2002">(樺島祥介, 2002, p. 4)</span> に倣った．ここでは，「効率的な平均計算法の開発は統計力学ではエルゴード理論と同じくらい重要な意味を持つ」と，このような計算の問題を順問題と呼んでいる．そして，次のように続ける：「実のところ，歴史的に統計学は観測データからそれを生成した統計モデルを推定することで事実を説明する <strong>逆問題</strong> を中心に発展してきたという経緯があり，<strong>順問題</strong> 的な難しさが広く意識されはじめたのは計算機が発達し大規模な統計モデルが盛んに用いられるようになった比較的最近のことである．」↩︎</p></li>
<li id="fn2"><p>同講義録 <span class="citation" data-cites="深谷賢治1997">(深谷賢治, 1997, p. 12)</span> にて，平面幾何とは，例えば円とは <img src="https://latex.codecogs.com/png.latex?S%5E1%5Chookrightarrow%5Cmathbb%7BR%7D%5E2"> なる写像を調べるもの，<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5E2"> 上の解析とは，<img src="https://latex.codecogs.com/png.latex?f(x,y)"> などの２変数関数を調べる，という例を挙げている．↩︎</p></li>
<li id="fn3"><p>主な目標が熱力学極限にあり，この極限において等価な予測を与えるモデルとして等価である，という意味である <span class="citation" data-cites="田崎晴明2008II">(田崎晴明, 2008, p. 333)</span> など．↩︎</p></li>
<li id="fn4"><p><span class="citation" data-cites="樺島祥介2002">(樺島祥介, 2002, pp. 4–5)</span>，<span class="citation" data-cites="戸田+2011">(戸田盛和 et al., 2011, p. 34)</span> など．↩︎</p></li>
<li id="fn5"><p>幾何光学における Fermat の原理から懐胎されていたアイデアであり，解析力学の最小作用の原理に代表され，同様の原理は量子力学，電磁気学など多くの分野で通用する．↩︎</p></li>
<li id="fn6"><p><span class="citation" data-cites="Chopin-Papaspiliopoulos20-SMC">(Chopin &amp; Papaspiliopoulos, 2020, p. 28)</span> など．↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Opinion</category>
  <category>Life</category>
  <guid>https://162348.github.io/posts/2024/Life/AppliedMath.html</guid>
  <pubDate>Thu, 09 May 2024 15:00:00 GMT</pubDate>
  <media:content url="https://162348.github.io/posts/2024/Life/Images/AppliedMath.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>Roberts and Tweedie (1996) Exponential Convergence of Langevin Distributions and Their Discrete Approximations</title>
  <dc:creator>司馬博文 </dc:creator>
  <link>https://162348.github.io/posts/2024/Review/Roberts-Tweedie1996.html</link>
  <description><![CDATA[ 





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<section id="概要" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="概要">概要</h2>
<section id="研究の立ち位置" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="研究の立ち位置">研究の立ち位置</h3>
<p>MALA は <span class="citation" data-cites="Besag1994">(Besag, 1994)</span> で提案され，<span class="citation" data-cites="Roberts-Tweedie1996">(Roberts &amp; Tweedie, 1996a)</span> で指数エルゴード性の必要十分条件が示されている．後の研究 <span class="citation" data-cites="Roberts-Rosenthal1998">(Roberts &amp; Rosenthal, 1998)</span> で最適スケーリングが論じられる．</p>
<div class="article-card-container">
  <div class="article-card">
    <a href="https://162348.github.io/posts/2024/Review/Roberts-Rosenthal1998.html" target="_blank">
      <img src="https://162348.github.io/posts/2024/Review/Roberts-Rosenthal1998.svg" alt="Article Image" class="article-image">
      <div class="article-content">
        <h3 class="article-title anchored">Roberts and Rosenthal (1998) Optimal Scaling of Discrete Approximations to Langevin Diffusions</h3>
        <p class="article-description">Roberts and Rosenthal [Journal of the Royal Statistical Society. Series B 60(1998) 255-268] は MALA (Metropolis-Adjusted Langevin Algorithm) の最適スケーリングを論じたもの．</p>
      </div>
    </a>
  </div>
</div>
<p><span class="citation" data-cites="Roberts-Tweedie1996">(Roberts &amp; Tweedie, 1996a)</span> は <span class="citation" data-cites="Roberts-Tweedie1996MH">(Roberts &amp; Tweedie, 1996b)</span> とセットである．後者はランダムウォーク MH に対象を限定して，指数エルゴード性がどのような含意を持つかを検証している（積率も指数収束するための条件，中心極限定理など）．</p>
</section>
<section id="mala-とは" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="mala-とは">MALA とは</h3>
<p>MALA は，提案核を対象分布 <img src="https://latex.codecogs.com/png.latex?%5Cpi"> から Langevin 拡散の形で構成する，problem-specific な Metropolis-Hastings 法であり，ランダムウォーク MH よりも速く収束することが期待される．<span class="citation" data-cites="Corenflos-Finke2024">(Corenflos &amp; Finke, 2024)</span> でも state-of-the-art と呼ばれているサンプリング法である．</p>
<p><span class="citation" data-cites="Fearnhead+2018-PDMC">(Fearnhead et al., 2018)</span> において，MALA は BPS と比較されている．モデルは AR(1) を用いており，低次元ではほとんど変わらないが，高次元では BPS の方が自己相関時間が５倍良いという結論が得られている．</p>
<p>MALA の他に，<span class="citation" data-cites="Neal1994">(Neal, 1994)</span> などの hybrid-Monte Carlo アルゴリズムも MALA と「提案核をよく考えている」という点で関係が深いが，本論文では扱わない．</p>
</section>
<section id="mala-のエルゴード性について" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="mala-のエルゴード性について">MALA のエルゴード性について</h3>
<p>Langevin 拡散 <img src="https://latex.codecogs.com/png.latex?%0AdL_t=dB_t+%5Cfrac%7B1%7D%7B2%7D%5Cnabla%5Clog%5Cpi(L_t)dt%0A"> は，例えば１次元では，尾部確率が指数減衰するならば，指数エルゴード性を持つ．つまり，<img src="https://latex.codecogs.com/png.latex?%5Cpi(x)%5C,%5Cpropto%5C,e%5E%7B-%5Cgamma%5Clvert%20x%5Crvert%5E%5Cbeta%7D%5C;(%5Cbeta%5Cge1)"> など．</p>
<p>このように，確率分布の裾の重さに影響されるという現象が普遍的である．</p>
<p>続いて，Langevin 拡散の離散化が，元の Langevin 拡散に収束するかどうかも別問題である．</p>
<p>最後に，Langevin 拡散の離散化を Metropolis 法によって修正したアルゴリズムである MALA が指数収束する条件を示す．</p>
</section>
</section>
<section id="導入" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="導入"><span class="header-section-number">1</span> 導入</h2>
<section id="mcmc-手法の指数エルゴード性について" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="mcmc-手法の指数エルゴード性について"><span class="header-section-number">1.1</span> MCMC 手法の指数エルゴード性について</h3>
<p><span class="citation" data-cites="Gelfand-Smith1990">(Gelfand &amp; Smith, 1990)</span> 以来，MH 法の利用が爆発している</p>
<blockquote class="blockquote">
<p>There has recently been a real explosion in the use of the Hastings and Metropolis algorithms</p>
</blockquote>
<p>乱歩 MH などは対象分布に依らずに実装できる汎用アルゴリズムであるが，対象分布の情報を取り入れて収束を高速にすることが考えられる．その例が MALA である．</p>
<p>Langevin 動力学は極めて優秀なモデリング手法であるが，シミュレーションのための離散化が入ることで，収束は遅くなるどころかそもそも収束性が失われることさえある．</p>
<p><span class="citation" data-cites="Neal1994">(Neal, 1994)</span> を引用しながら，hybrid Monte Carlo が Langevin アルゴリズムに似ていると触れながら，話が対称性と非対称性の話に変わる．</p>
<blockquote class="blockquote">
<p>However, it is worth remarking that often methods induced by non-reversible methods can be shown to converge more quickly than their reversible counterparts (see, for example, <span class="citation" data-cites="Sheu1991">(Sheu, 1991)</span>).</p>
</blockquote>
<p>しかし <span class="citation" data-cites="Sheu1991">(Sheu, 1991)</span> は <img src="https://latex.codecogs.com/png.latex?P_t"> の評価を上下からしているのみで，非対称性どころか収束の議論は全くしていない．議論に飛躍があるか，引用が間違っているかが考えられる．</p>
</section>
<section id="langevin-拡散について" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="langevin-拡散について"><span class="header-section-number">1.2</span> Langevin 拡散について</h3>
<p>本論文が研究する MH 法は，提案を Langevin 拡散により取り入れたものである．</p>
<p>密度 <img src="https://latex.codecogs.com/png.latex?%5Cpi"> が可微分であるとき，<img src="https://latex.codecogs.com/png.latex?%5Cnabla%5Clog%5Cpi"> が考えられる．これに対して，Langevin 拡散 <img src="https://latex.codecogs.com/png.latex?%5C%7BL_t%5C%7D%5Csubset%5Cmathbb%7BR%7D%5Ek"> とは <img src="https://latex.codecogs.com/png.latex?%0AdL_t=dW_t+%5Cfrac%7B1%7D%7B2%7D%5Cnabla%5Clog%5Cpi(L_t)dt%0A"> と定義される．</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cpi"> が十分滑らかであるとき，これはエルゴード性を持つ： <img src="https://latex.codecogs.com/png.latex?%0A%5C%7CP%5Et_L(x,-)-%5Cpi%5C%7C_%5Cmathrm%7BTV%7D%5Cto0.%0A"></p>
<p>本論文では，この収束が指数レートで起こる場合，そして同様の積率収束も起こる場合に興味がある．</p>
</section>
<section id="指数収束する例" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="指数収束する例"><span class="header-section-number">1.3</span> 指数収束する例</h3>
<section id="次元クラス-mathcalebetagamma" class="level4" data-number="1.3.1">
<h4 data-number="1.3.1" class="anchored" data-anchor-id="次元クラス-mathcalebetagamma"><span class="header-section-number">1.3.1</span> １次元クラス <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BE%7D(%5Cbeta,%5Cgamma)"></h4>
<p><img src="https://latex.codecogs.com/png.latex?k=1"> とする．<img src="https://latex.codecogs.com/png.latex?%5Cpi%5Cin%5Cmathcal%7BE%7D(%5Cbeta,%5Cgamma)%5Csubset%20C%5E%5Cinfty(%5Cmathbb%7BR%7D)"> であるとは，可微分であり，加えてある <img src="https://latex.codecogs.com/png.latex?x_0%5Cin%5Cmathbb%7BR%7D"> と <img src="https://latex.codecogs.com/png.latex?%5Cgamma,%5Cbeta%3E0"> が存在して， <img src="https://latex.codecogs.com/png.latex?%0A%5Cpi(x)%5C,%5Cpropto%5C,e%5E%7B-%5Cgamma%5Clvert%20x%5Crvert%5E%5Cbeta%7D,%5Cquad%5Clvert%20x%5Crvert%5Cge%20x_0,%0A"> が成り立つことをいう．このとき， <img src="https://latex.codecogs.com/png.latex?%0A%5Cnabla%5Clog%5Cpi(x)=-%5Cgamma%5Cbeta%5Cmathop%7B%5Cmathrm%7Bsgn%7D%7D(x)%5Clvert%20x%5Crvert%5E%7B%5Cbeta-1%7D,%5Cquad%5Clvert%20x%5Crvert%3Ex_0.%0A"></p>
<p>2.3 節にて，指数収束するための必要十分条件は <img src="https://latex.codecogs.com/png.latex?%5Cbeta%5Cge1"> であることを見る．この結論は乱歩 MH アルゴリズムと全く同様である <span class="citation" data-cites="Mengersen-Robert1996">(Mengersen &amp; Robert, 1996, p. 定理3.5)</span>．</p>
</section>
<section id="多次元指数分布族-mathcalp_m" class="level4" data-number="1.3.2">
<h4 data-number="1.3.2" class="anchored" data-anchor-id="多次元指数分布族-mathcalp_m"><span class="header-section-number">1.3.2</span> 多次元指数分布族 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D_m"></h4>
<p><span class="citation" data-cites="Roberts-Tweedie1996MH">(Roberts &amp; Tweedie, 1996b)</span> で乱歩 MH 法について考えたように，多次元の統計モデルとしては指数分布族を考えることとする．特に，次の場合を考える： <img src="https://latex.codecogs.com/png.latex?%0A%5Cpi(x)%5C,%5Cpropto%5C,e%5E%7B-p(x)%7D%5Cquad%20%5Clvert%20x%5Crvert%5Cge%20x_0,%0A"> ただし <img src="https://latex.codecogs.com/png.latex?p"> は <img src="https://latex.codecogs.com/png.latex?m"> 次の多項式で，次の表示を持つ： <img src="https://latex.codecogs.com/png.latex?%0Ap=p_m+q_%7Bm-1%7D.%0A"> <img src="https://latex.codecogs.com/png.latex?%5Cpi%5Cin%5Cmathcal%7BP%7D_m%5Csubset%20C%5E%5Cinfty(%5Cmathbb%7BR%7D%5Ek)"> とは，<img src="https://latex.codecogs.com/png.latex?p_m%5Cxrightarrow%7B%5Clvert%20x%5Crvert%5Cto%5Cinfty%7D%5Cinfty"> を満たすことをいう．特に，<img src="https://latex.codecogs.com/png.latex?m%5Cge2"> であることに注意．</p>
</section>
</section>
<section id="langevin-拡散-l_t-の離散近似" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="langevin-拡散-l_t-の離散近似"><span class="header-section-number">1.4</span> Langevin 拡散 <img src="https://latex.codecogs.com/png.latex?L_t"> の離散近似</h3>
<p>実際の実装で <img src="https://latex.codecogs.com/png.latex?L_t"> をそのまま用いることは出来ず，これを離散化することが必要である．</p>
<section id="ula-unadjusted-langevin-algorithm" class="level4" data-number="1.4.1">
<h4 data-number="1.4.1" class="anchored" data-anchor-id="ula-unadjusted-langevin-algorithm"><span class="header-section-number">1.4.1</span> ULA (unadjusted Langevin algorithm)</h4>
<blockquote class="blockquote">
<p>The unadjusted Langevin algorithm (ULA) is a discrete-time Markov chain <img src="https://latex.codecogs.com/png.latex?U_n"> which is the natural discretization of ordinary Langevin diffusion <img src="https://latex.codecogs.com/png.latex?L_t">.</p>
</blockquote>
<p><span class="citation" data-cites="Parisi1980">(Parisi, 1980)</span>, <span class="citation" data-cites="Grenander-Miller1994">(Grenander &amp; Miller, 1994)</span> で考えられたものである．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AU_n%5Csim%5Cmathrm%7BN%7D_k%5Cleft(U_%7Bn-1%7D+%5Cfrac%7Bh%7D%7B2%7D%5Cnabla%5Clog%5Cpi(U_%7Bn-1%7D),hI_k%5Cright)%0A"> によって構成できる． <span class="citation" data-cites="Besag1994">(Besag, 1994)</span> が指摘したように，元の <img src="https://latex.codecogs.com/png.latex?L_t"> と似た（しかしステップサイズ <img src="https://latex.codecogs.com/png.latex?h"> に依存する変換を受けた）不変分布を持つ．</p>
<div class="callout callout-style-default callout-caution callout-titled" title="例">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
例
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Cpi=%5Cmathrm%7BN%7D_1(0,1)"> であり，ステップサイズを <img src="https://latex.codecogs.com/png.latex?h=2"> とすると，<img src="https://latex.codecogs.com/png.latex?%5Cnabla%5Clog%5Cpi(x)">=-x$ であるから， <img src="https://latex.codecogs.com/png.latex?%0AU_%7Bn-1%7D+%5Cfrac%7Bh%7D%7B2%7D%5Cnabla%5Clog%5Cpi(U_%7Bn-1%7D)=U_%7Bn-1%7D-%5Cfrac%7B2%7D%7B2%7D%5Cfrac%7BU_%7Bn-1%7D%7D%7B1%7D=0%0A"> より，<img src="https://latex.codecogs.com/png.latex?U_n%5Csim%5Cmathrm%7BN%7D_1(0,2)"> となる．</p>
</div>
</div>
</div>
</section>
<section id="mala-metropolis-adjusted-langevin-algorithm" class="level4" data-number="1.4.2">
<h4 data-number="1.4.2" class="anchored" data-anchor-id="mala-metropolis-adjusted-langevin-algorithm"><span class="header-section-number">1.4.2</span> MALA (Metropolis-Adjusted Langevin Algorithm)</h4>
<p><span class="citation" data-cites="Besag1994">(Besag, 1994)</span> に従い，修正を加える．<img src="https://latex.codecogs.com/png.latex?U_n"> を提案として，Metropolis-Hastings 法を実行するのである．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Aq(M_%7Bn-1%7D,-):=%5Cmathrm%7BN%7D_k%5Cleft(M_%7Bn-1%7D+%5Cfrac%7B1%7D%7B2%7Dh%5Cnabla%5Clog%5Cpi(M_%7Bn-1%7D),hI_k%5Cright)%0A"> を提案核とし， <img src="https://latex.codecogs.com/png.latex?%0A%5Calpha(M_%7Bn-1%7D,U_n):=1%5Cland%5Cfrac%7B%5Cpi(U_n)q(U_n,M_%7Bn-1%7D)%7D%7B%5Cpi(M_%7Bn-1%7D)q(M_%7Bn-1%7D,U_n)%7D%0A"> を採択確率とする．</p>
<p>この場合，必ずエルゴード性が成り立つ．<span class="citation" data-cites="Roberts-Tweedie1996MH">(Roberts &amp; Tweedie, 1996b)</span> の結論と同様，<img src="https://latex.codecogs.com/png.latex?%5Cell_k">-既約かつ周期的だからである．<sup>1</sup> 特に，殆ど至る所の <img src="https://latex.codecogs.com/png.latex?x%5Cin%5Cmathbb%7BR%7D%5Ek"> について， <img src="https://latex.codecogs.com/png.latex?%0A%5C%7CP%5En_M(x,-)-%5Cpi%5C%7C_%5Cmathrm%7BTV%7D%5Cto0.%0A"> また，本論文が提示する指数収束の条件の下では，任意の <img src="https://latex.codecogs.com/png.latex?x%5Cin%5Cmathbb%7BR%7D%5Ek"> で起こる．</p>
<p>ULA が推移的であるとき，MALA も指数エルゴード性を持たないことが判る．だが，これは尾部確率が指数よりも重い場合にしか起こらない．</p>
</section>
<section id="malta-metropolis-adjusted-langevin-truncated-algorithm" class="level4" data-number="1.4.3">
<h4 data-number="1.4.3" class="anchored" data-anchor-id="malta-metropolis-adjusted-langevin-truncated-algorithm"><span class="header-section-number">1.4.3</span> MALTA (Metropolis-Adjusted Langevin Truncated Algorithm)</h4>
<p><img src="https://latex.codecogs.com/png.latex?%0AT_n%5Csim%5Cmathrm%7BN%7D_k%5Cbiggr(M_%7Bn-1%7D+R(M_%7Bn-1%7D),hI_k%5Cbiggl)%0A"> <img src="https://latex.codecogs.com/png.latex?%0AR(x):=%5Cfrac%7BD%5Cnabla%5Clog%5Cpi(x)%7D%7B2(D%5Clor%5Clvert%5Cnabla%5Clog%5Cpi(x)%5Crvert)%7D.%0A"> を提案とし，MH 法を適用する．</p>
<p>MALTA は大変ロバストで，指数収束が起こりやすい．</p>
</section>
</section>
</section>
<section id="langevin-拡散アルゴリズムの指数収束" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="langevin-拡散アルゴリズムの指数収束"><span class="header-section-number">2</span> Langevin 拡散アルゴリズムの指数収束</h2>
<section id="一般の収束結果" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="一般の収束結果"><span class="header-section-number">2.1</span> 一般の収束結果</h3>
<p><img src="https://latex.codecogs.com/png.latex?%0AdL_t=dW_t+%5Cfrac%7B1%7D%7B2%7D%5Cnabla%5Clog%5Cpi(L_t)dt%0A"></p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定理2.1（Langevin 拡散のエルゴード性）">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定理2.1（Langevin 拡散のエルゴード性）
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Cnabla%5Clog%5Cpi"> は <img src="https://latex.codecogs.com/png.latex?C%5E1(%5Cmathbb%7BR%7D%5Ek)">-級で，<sup>2</sup> ある <img src="https://latex.codecogs.com/png.latex?N,a,b%3E0"> が存在して <img src="https://latex.codecogs.com/png.latex?%0A%5Cnabla%5Clog%5Cpi(x)%5Ccdot%20x%5Cle%20a%5Clvert%20x%5Crvert%5E2+b,%5Cqquad%5Clvert%20x%5Crvert%3EN,%0A"> を満たすとする．このとき，Langevin 拡散 <img src="https://latex.codecogs.com/png.latex?%5C%7BL_t%5C%7D"> について次が成り立つ：</p>
<ol type="1">
<li><img src="https://latex.codecogs.com/png.latex?L"> は爆発的でなく，<img src="https://latex.codecogs.com/png.latex?%5Cell_k">-既約で，周期的で，強 Feller であり，任意のコンパクト集合は小集合である．</li>
<li><img src="https://latex.codecogs.com/png.latex?L"> は <img src="https://latex.codecogs.com/png.latex?%5Cpi">-不変であり，任意の <img src="https://latex.codecogs.com/png.latex?x%5Cin%5Cmathbb%7BR%7D%5Ek"> について <img src="https://latex.codecogs.com/png.latex?%0A%5C%7CP%5Et_L(x,-)-%5Cpi%5C%7C_%5Cmathrm%7BTV%7D%5Cto0.%0A"></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><img src="https://latex.codecogs.com/png.latex?%5Clvert%20L_t%5Crvert"> と OU 過程を比較することで，<img src="https://latex.codecogs.com/png.latex?%5Clvert%20L_t%5Crvert"> が爆発しないことが判る．</p>
<p>続いて，ドリフト係数が局所有界であるため，<span class="citation" data-cites="Bhattacharya1978">(Bhattacharya, 1978)</span> と同様の議論により強 Feller である．加えて，<img src="https://latex.codecogs.com/png.latex?%5Cell_k">-既約であることも判る．<sup>3</sup></p>
<blockquote class="blockquote">
<p>Theorem 2.1. <em>If, in addition to the hypothesis (A), <img src="https://latex.codecogs.com/png.latex?a_%7Bij%7D(-)"> and <img src="https://latex.codecogs.com/png.latex?b_i(-)"> are bounded on <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ek">, then for each <img src="https://latex.codecogs.com/png.latex?x"> in <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ek"> there exists a unique probability measure <img src="https://latex.codecogs.com/png.latex?P_x"> on <img src="https://latex.codecogs.com/png.latex?(%5COmega',%5Cmathcal%7BM%7D')"> such that (i) <img src="https://latex.codecogs.com/png.latex?P_x(X_0=x)=1">, (ii) for every bounded real <img src="https://latex.codecogs.com/png.latex?f"> on <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ek"> having bounded continuous first and second order derivatives, the process <img src="https://latex.codecogs.com/png.latex?f(X_t)-%5Cint%5Et_0Lf(X_s)ds"> is a martingale under <img src="https://latex.codecogs.com/png.latex?P_x">. Further, (a) <img src="https://latex.codecogs.com/png.latex?X"> is strong Markov and strong Feller, and (b) support of <img src="https://latex.codecogs.com/png.latex?P_x"> is <img src="https://latex.codecogs.com/png.latex?%5COmega_x':=%5Cleft%5C%7B%5Comega%5Cin%5COmega%5Cmid%5Comega(0)=x%5Cright%5C%7D">. <span class="citation" data-cites="Bhattacharya1978">(Bhattacharya, 1978)</span></em></p>
</blockquote>
<p>任意の <img src="https://latex.codecogs.com/png.latex?%5Cell_k">-正集合 <img src="https://latex.codecogs.com/png.latex?A%5Csubset%5Cmathbb%7BR%7D%5Ek"> に対して， <img src="https://latex.codecogs.com/png.latex?%0A%20%20%20%5Cwidetilde%7BA%7D:=%5Cleft%5C%7B%5Comega%5Cin%5COmega_x'%5Cmid%20%5Comega(t)%5Cin%20A%5Cright%5C%7D%0A%20%20%20"> は <img src="https://latex.codecogs.com/png.latex?P_x">-正集合である．実際，<img src="https://latex.codecogs.com/png.latex?A"> が <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ek"> 上の開集合を含むために <img src="https://latex.codecogs.com/png.latex?%5Cwidetilde%7BA%7D"> は <img src="https://latex.codecogs.com/png.latex?%5COmega_x'"> 上の開集合を含むので，<img src="https://latex.codecogs.com/png.latex?P_x">-零であったら <img src="https://latex.codecogs.com/png.latex?P_x"> の台が <img src="https://latex.codecogs.com/png.latex?%5COmega_x'"> 全体であることに矛盾する．これより，<img src="https://latex.codecogs.com/png.latex?L_t"> は <img src="https://latex.codecogs.com/png.latex?A"> に到達可能である．よって <img src="https://latex.codecogs.com/png.latex?L_t"> は <img src="https://latex.codecogs.com/png.latex?%5Cell_k">-既約．</p>
<p>（強）Feller かつ <img src="https://latex.codecogs.com/png.latex?%5Cell_k">-既約ならば，任意のコンパクト集合は小集合である <span class="citation" data-cites="Tweedie1994">(Tweedie, 1994, p. 定理5.1)</span>．<sup>4</sup></p>
<p>非周期性は，任意のスケルトンも <img src="https://latex.codecogs.com/png.latex?%5Cell_k">-既約であることから従う．<sup>5</sup></p></li>
<li><p><span class="citation" data-cites="Ikeda-Watanabe1981">(Ikeda &amp; Watanabe, 1981, p. 5.4節)</span> により，<img src="https://latex.codecogs.com/png.latex?%5Cpi"> は <img src="https://latex.codecogs.com/png.latex?L"> の不変分布であることが，生成作用素 <img src="https://latex.codecogs.com/png.latex?%0A%20%20%20A_Lf(x)=%5Cleft(%5Cfrac%7B1%7D%7B2%7D%5Cnabla%5Clog%5Cpi(x)%5Cright)%5Ccdot%5Cnabla%20f(x)+%5Cfrac%7B1%7D%7B2%7D%5Cmathop%7B%7D%5C!%5Cmathbin%5Cbigtriangleup%20f(x)%0A%20%20%20"> <img src="https://latex.codecogs.com/png.latex?%0A%20%20%20f%5Cin%20C%5E2(%5Cmathbb%7BR%7D%5Ek)%0A%20%20%20"> に関して，<img src="https://latex.codecogs.com/png.latex?(%5Cpi%7CA_Lf)=0%5C;(f%5Cin%20C%5E2(%5Cmathbb%7BR%7D%5Ek))"> を満たすために従う．<img src="https://latex.codecogs.com/png.latex?C%5E2(%5Cmathbb%7BR%7D%5Ek)"> は，爆発しない拡散過程の生成作用素の核をなす．<sup>6</sup></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cell_k">-既約な Makrov 過程であって不変確率分布を持つから，再帰的ではある．<span class="citation" data-cites="Meyn-Tweedie2009">(S. Meyn &amp; Tweedie, 2009, p. 172)</span>定理8.0.1．これは，<img src="https://latex.codecogs.com/png.latex?%5Cpsi">-既約な Markov 連鎖は再帰的であるか推移的であるかの２択だからである<span class="citation" data-cites="Tweedie1994">(Tweedie, 1994, p. 定理2.3)</span>．</p>
<p><strong>また連続な過程であるから，これは Harris 再帰性を意味する．</strong></p>
<p>不変確率分布を持つ非周期的な Harris 再帰的な Markov 連鎖であるから，全変動収束が従う <span class="citation" data-cites="Meyn-Tweedie1993">(S. P. Meyn &amp; Tweedie, 1993, p. 定理6.1)</span>．</p>
<blockquote class="blockquote">
<p><em>Proposition 6.1</em>. Suppose that <img src="https://latex.codecogs.com/png.latex?%5CPhi"> is positive Harris recurrent, and that some skeleton chain is irreducible. If <img src="https://latex.codecogs.com/png.latex?C"> is petite, then there exists a constant <img src="https://latex.codecogs.com/png.latex?T%3E0"> and a non-trivial measure <img src="https://latex.codecogs.com/png.latex?%5Cmu"> such that <img src="https://latex.codecogs.com/png.latex?P%5Es(x,-)%5Cge%5Cmu(-)%5C;(s%5Cge%20T,x%5Cin%20C)">. <span class="citation" data-cites="Meyn-Tweedie1993">(S. P. Meyn &amp; Tweedie, 1993)</span>_</p>
</blockquote></li>
</ol>
</div>
</div>
</div>
</section>
<section id="l_t-の指数エルゴード性" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="l_t-の指数エルゴード性"><span class="header-section-number">2.2</span> <img src="https://latex.codecogs.com/png.latex?L_t"> の指数エルゴード性</h3>
<section id="指数エルゴード性の必要条件" class="level4" data-number="2.2.1">
<h4 data-number="2.2.1" class="anchored" data-anchor-id="指数エルゴード性の必要条件"><span class="header-section-number">2.2.1</span> 指数エルゴード性の必要条件</h4>
<p><img src="https://latex.codecogs.com/png.latex?V:%5Cmathbb%7BR%7D%5Ek%5Cto%5B1,%5Cinfty)"> に対して，<strong><img src="https://latex.codecogs.com/png.latex?V">-一様エルゴード的</strong> であるとは，任意の <img src="https://latex.codecogs.com/png.latex?x%5Cin%5Cmathbb%7BR%7D%5Ek"> に対して，ある <img src="https://latex.codecogs.com/png.latex?R%3E0,%5Crho%5Cin(0,1)"> が存在して <img src="https://latex.codecogs.com/png.latex?%0A%5C%7CP%5Et_L(x,-)-%5Cpi%5C%7C_V%5Cle%20V(x)R%5Crho%5Et,%5Cqquad%20t%5Cge0,%0A"> が成り立つことをいう．ただし， <img src="https://latex.codecogs.com/png.latex?%0A%5C%7CA%5C%7C_V:=%5Csup_%7B%5Clvert%20f%5Crvert%5Cle%20V%7D%5Cint_%7B%5Cmathbb%7BR%7D%5Ek%7Df(x)A(dx).%0A"></p>
<p><span class="citation" data-cites="Meyn-Tweedie2009">(S. Meyn &amp; Tweedie, 2009, pp. 336–337)</span> 第 14 章にいう <img src="https://latex.codecogs.com/png.latex?f">-エルゴード性に当たる概念であることに注意．<img src="https://latex.codecogs.com/png.latex?V">-一様エルゴード性は第 16 章で別の意味に使われている．</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定理2.2（Langevin 拡散の指数エルゴード性）">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定理2.2（Langevin 拡散の指数エルゴード性）
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Cnabla%5Clog%5Cpi"> は <img src="https://latex.codecogs.com/png.latex?C%5E1(%5Cmathbb%7BR%7D%5Ek)">-級で，ある <img src="https://latex.codecogs.com/png.latex?N,a,b%3E0"> が存在して <img src="https://latex.codecogs.com/png.latex?%0A%5Cnabla%5Clog%5Cpi(x)%5Ccdot%20x%5Cle%20a%5Clvert%20x%5Crvert%5E2+b,%5Cqquad%5Clvert%20x%5Crvert%3EN,%0A"> を満たすとする．このとき，Langevin 拡散 <img src="https://latex.codecogs.com/png.latex?%5C%7BL_t%5C%7D"> について次が成り立つ：</p>
<ol type="1">
<li>任意の <img src="https://latex.codecogs.com/png.latex?V%5Cin%20C%5E2(%5Cmathbb%7BR%7D%5Ek)"> であって，<img src="https://latex.codecogs.com/png.latex?V%5Cge1"> かつ，ある <img src="https://latex.codecogs.com/png.latex?b,c%3E0"> と非空コンパクト集合 <img src="https://latex.codecogs.com/png.latex?C%5Coverset%7B%5Ctextrm%7Bcpt%7D%7D%7B%5Csubset%7D%5Cmathbb%7BR%7D%5Ek"> とについて <img src="https://latex.codecogs.com/png.latex?%0AA_LV%5Cle-cV+b1_C%0A"> を満たすものについて，<img src="https://latex.codecogs.com/png.latex?V">-一様エルゴード的である．</li>
<li><img src="https://latex.codecogs.com/png.latex?L"> が指数エルゴード的ならば，ある非空コンパクト集合 <img src="https://latex.codecogs.com/png.latex?C%5Coverset%7B%5Ctextrm%7Bcpt%7D%7D%7B%5Csubset%7D%5Cmathbb%7BR%7D%5Ek"> について，ある <img src="https://latex.codecogs.com/png.latex?%5Ckappa%3E1,%5Cdelta%3E0"> が存在して，任意のスタート地点 <img src="https://latex.codecogs.com/png.latex?x%5Cin%20%5Cmathbb%7BR%7D%5Ek"> について， <img src="https://latex.codecogs.com/png.latex?%0A%5Csup_%7Bx%5Cin%20C%7D%5Coperatorname%7BE%7D%5B%5Ckappa%5E%7B%5Ctau_C%5E%5Cdelta%7D%5D%3C%5Cinfty,%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Ctau%5E%5Cdelta_C:=%5Cinf%5Cleft%5C%7Bt%5Cge%5Cdelta%5Cmid%20L_t%5Cin%20C%5Cright%5C%7D.%0A"></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>非空コンパクト集合 <img src="https://latex.codecogs.com/png.latex?C%5Coverset%7B%5Ctextrm%7Bcpt%7D%7D%7B%5Csubset%7D%5Cmathbb%7BR%7D%5Ek"> は小集合であるから，これは成り立つ．<span class="citation" data-cites="Meyn-Tweedie2009">(S. Meyn &amp; Tweedie, 2009, pp. 336–337)</span> 定理 14.0.1 が Markov 連鎖に関して与えている消息である．</p></li>
<li><p>任意の <img src="https://latex.codecogs.com/png.latex?%5Cdelta%3E0"> について，<img src="https://latex.codecogs.com/png.latex?%5Cdelta">-スケルトンも幾何エルゴード的である．この <img src="https://latex.codecogs.com/png.latex?%5Cdelta">-スケルトンに関する <img src="https://latex.codecogs.com/png.latex?C"> への到着時刻は <img src="https://latex.codecogs.com/png.latex?%5Ctau%5E%5Cdelta_C"> よりも必ず大きくなる．</p>
<p><img src="https://latex.codecogs.com/png.latex?L_t"> は強 Feller であるから，<img src="https://latex.codecogs.com/png.latex?C"> は <img src="https://latex.codecogs.com/png.latex?%5Cdelta">-スケルトンに関しても小集合である．あとは，Markov 連鎖に関する幾何エルゴード定理より従う．<sup>7</sup></p></li>
</ol>
</div>
</div>
</div>
</section>
<section id="指数エルゴード性の十分条件" class="level4" data-number="2.2.2">
<h4 data-number="2.2.2" class="anchored" data-anchor-id="指数エルゴード性の十分条件"><span class="header-section-number">2.2.2</span> 指数エルゴード性の十分条件</h4>
<p><img src="https://latex.codecogs.com/png.latex?-%5Cnabla%5Clog%5Cpi=O(%5Clvert%20x%5Crvert%5E%7B2k-1%7D)%5C;(%5Clvert%20x%5Crvert%5Cto%5Cinfty)"> としたとき，後述の定理 2.4 の条件である <img src="https://latex.codecogs.com/png.latex?k%3C1/2"> を満たさない限り，<img src="https://latex.codecogs.com/png.latex?k%5Cge1/2"> まで指数エルゴード性は成り立ち続ける．<sup>8</sup></p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定理2.3（Langevin 拡散の指数エルゴード性）">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定理2.3（Langevin 拡散の指数エルゴード性）
</div>
</div>
<div class="callout-body-container callout-body">
<p>ある <img src="https://latex.codecogs.com/png.latex?S%3E0"> が存在して， <img src="https://latex.codecogs.com/png.latex?%5Clvert%20x%5Crvert%5Cge%20S"> 上で <img src="https://latex.codecogs.com/png.latex?%5Cpi"> は有界であるとする．加えて，ある <img src="https://latex.codecogs.com/png.latex?d%5Cin(0,1)"> が存在して <img src="https://latex.codecogs.com/png.latex?%0A%5Climinf_%7B%5Clvert%20x%5Crvert%5Cto%5Cinfty%7D(1-d)%5Clvert%5Cnabla%5Clog%5Cpi(x)%5Crvert%5E2+%5Cnabla%5E2%5Clog%5Cpi(x)%3E0%0A"> を満たすならば，<img src="https://latex.codecogs.com/png.latex?%5C%7BL_t%5C%7D"> は指数エルゴード的である．</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>上の定理の 1. のドリフト条件を示せば良い．<img src="https://latex.codecogs.com/png.latex?V=%5Cpi%5E%7B-d%7D%5C;(0%3Cd%3C1)"> と取れば良い．このとき， <img src="https://latex.codecogs.com/png.latex?%0A2A_LV=V%5Cbiggr(%5Clvert%5Cnabla%5Clog%5Cpi%5Crvert%5E2(d%5E2-d)-d%5Cnabla%5E2%5Clog%5Cpi%5Cbiggl).%0A"></p>
</div>
</div>
</div>
</section>
<section id="指数エルゴード性が成り立たないとき" class="level4" data-number="2.2.3">
<h4 data-number="2.2.3" class="anchored" data-anchor-id="指数エルゴード性が成り立たないとき"><span class="header-section-number">2.2.3</span> 指数エルゴード性が成り立たないとき</h4>
<p>指数エルゴード性が成り立たない場合は，返ってこない時，棄却率が高すぎる時，急に動く場合の３つが考えられる．</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定理2.4（Langevin 拡散が指数エルゴード性を失うとき）">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定理2.4（Langevin 拡散が指数エルゴード性を失うとき）
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Clvert%5Cnabla%5Clog%5Cpi(x)%5Crvert%5Cto0"> ならば，<img src="https://latex.codecogs.com/png.latex?%5C%7BL_t%5C%7D"> は指数エルゴード的でない．</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>上の定理の 2. と矛盾させれば良い．幾何エルゴード的だと仮定し，コンパクトな Kendall 集合 <img src="https://latex.codecogs.com/png.latex?C%5Coverset%7B%5Ctextrm%7Bcpt%7D%7D%7B%5Csubset%7D%5Cmathbb%7BR%7D%5Ek"> が存在するとする： <img src="https://latex.codecogs.com/png.latex?%0A%5Csup_%7Bx%5Cin%20C%7D%5Coperatorname%7BE%7D%5B%5Ckappa%5E%7B%5Ctau%5E%5Cdelta_C%7D%5D%3C%5Cinfty.%0A"> ある <img src="https://latex.codecogs.com/png.latex?R%3E0"> が存在して， <img src="https://latex.codecogs.com/png.latex?%0A%5Clvert%5Cnabla%5Clog%5Cpi(x)%5Crvert%5Cle2(%5Clog%5Ckappa)%5E%7B1/2%7D%5Cquad(%5Clvert%20x%5Crvert%5Cge%20R).%0A"> このとき，<img src="https://latex.codecogs.com/png.latex?S%5Cge%5Csup_%7Bx%5Cin%20C%7D%5Clvert%20x%5Crvert%5Clor%20R"> を取り，<img src="https://latex.codecogs.com/png.latex?%5Clvert%20y%5Crvert%5Cge2S"> を満たす地点 <img src="https://latex.codecogs.com/png.latex?y%5Cin%5Cmathbb%7BR%7D%5Ek"> からスタートしたとすると，<img src="https://latex.codecogs.com/png.latex?Z_t:=%5Clvert%20L_t%5Crvert"> は，<img src="https://latex.codecogs.com/png.latex?a(x)%3E-(%5Clog%5Ckappa)%5E%7B1/2%7D%5C;(%5Clvert%20x%5Crvert%3ES)"> を満たす係数について <img src="https://latex.codecogs.com/png.latex?%0AdZ_t=dW_t+a(L_t)dt%0A"> を満たす．<img src="https://latex.codecogs.com/png.latex?B_t:=W_t-(%5Clog%5Ckappa)%5E%7B1/2%7Dt"> とし，それぞれの過程の <img src="https://latex.codecogs.com/png.latex?S"> への到着時刻 <img src="https://latex.codecogs.com/png.latex?%5Csigma(Z),%5Csigma(B)"> を考えると，<img src="https://latex.codecogs.com/png.latex?%5Csigma(Z)%5Cge%5Csigma(B)%5C;%5C;%5Ctext%7Ba.s.%7D"> が成り立つ．このとき， <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%5Coperatorname%7BP%7D_y%5B%5Ctau_C%3Et%5D&amp;%5Cge%5Coperatorname%7BP%7D_y%5B%5Csigma(Z)%3Et%5D%5C%5C%0A%20%20&amp;%5Cge%5Coperatorname%7BP%7D_y%5B%5Csigma(B)%3Et%5D%5C%5C%0A%20%20&amp;%5Cge%5CPhi%5Cleft(%5Cfrac%7B-S+t(%5Clog%5Ckappa)%5E%7B1/2%7D%7D%7B%5Csqrt%7Bt%7D%7D%5Cright)-e%5E%7B2S(%5Clog%5Ckappa)%5E%7B1/2%7D%7D%5CPhi%5Cleft(%5Cfrac%7B-S-t(%5Clog%5Ckappa)%5E%7B1/2%7D%7D%7B%5Csqrt%7Bt%7D%7D%5Cright).%0A%5Cend%7Balign*%7D"> 最後の式は Bachelier-Lévy の公式による．<img src="https://latex.codecogs.com/png.latex?%5Csigma(B)"> の密度を <img src="https://latex.codecogs.com/png.latex?f"> とすると， <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Clog%20f(t)%7D%7Bt%7D%5Cto-%5Cfrac%7B%5Clog%5Ckappa%7D%7B2%7D.%0A"> これは矛盾を起こすらしい．</p>
</div>
</div>
</div>
</section>
</section>
<section id="指数収束する例-1" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="指数収束する例-1"><span class="header-section-number">2.3</span> 指数収束する例</h3>
<section id="次元クラス-mathcalebetagamma-1" class="level4" data-number="2.3.1">
<h4 data-number="2.3.1" class="anchored" data-anchor-id="次元クラス-mathcalebetagamma-1"><span class="header-section-number">2.3.1</span> １次元クラス <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BE%7D(%5Cbeta,%5Cgamma)"></h4>
</section>
<section id="多次元指数分布族-mathcalp_m-1" class="level4" data-number="2.3.2">
<h4 data-number="2.3.2" class="anchored" data-anchor-id="多次元指数分布族-mathcalp_m-1"><span class="header-section-number">2.3.2</span> 多次元指数分布族 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D_m"></h4>
</section>
</section>
</section>
<section id="ula-アルゴリズム" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="ula-アルゴリズム"><span class="header-section-number">3</span> ULA アルゴリズム</h2>
</section>
<section id="mala-アルゴリズム" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="mala-アルゴリズム"><span class="header-section-number">4</span> MALA アルゴリズム</h2>
</section>
<section id="結論" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="結論"><span class="header-section-number">5</span> 結論</h2>
</section>
<section id="references" class="level2" data-number="6">




</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">6 References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-Besag1994" class="csl-entry">
Besag, J. E. (1994). Comments on <span>“representations of knowledge in complex systems”</span> by u. Grenander and MI miller. <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, <em>56</em>(4), 591–592. <a href="https://www.jstor.org/stable/2346184">https://www.jstor.org/stable/2346184</a>
</div>
<div id="ref-Bhattacharya1978" class="csl-entry">
Bhattacharya, R. N. (1978). <span class="nocase">Criteria for Recurrence and Existence of Invariant Measures for Multidimensional Diffusions</span>. <em>The Annals of Probability</em>, <em>6</em>(4), 541–553. <a href="https://doi.org/10.1214/aop/1176995476">https://doi.org/10.1214/aop/1176995476</a>
</div>
<div id="ref-Corenflos-Finke2024" class="csl-entry">
Corenflos, A., &amp; Finke, A. (2024). <em>Particle-MALA and particle-mGRAD: Gradient-based MCMC methods for high-dimensional state-space models</em>. <a href="https://arxiv.org/abs/2401.14868">https://arxiv.org/abs/2401.14868</a>
</div>
<div id="ref-Fearnhead+2018-PDMC" class="csl-entry">
Fearnhead, P., Bierkens, J., Pollock, M., &amp; Roberts, G. O. (2018). Piecewise deterministic markov processes for continuous-time monte carlo. <em>Statistical Science</em>, <em>33</em>(3), 386–412. <a href="https://www.jstor.org/stable/26771007">https://www.jstor.org/stable/26771007</a>
</div>
<div id="ref-Gelfand-Smith1990" class="csl-entry">
Gelfand, A. E., &amp; Smith, A. F. M. (1990). Sampling-based approaches to calculating marginal densities. <em>Journal of the American Statistical Association</em>, <em>85</em>(410), 398–409. <a href="https://doi.org/10.2307/2289776">https://doi.org/10.2307/2289776</a>
</div>
<div id="ref-Grenander-Miller1994" class="csl-entry">
Grenander, U., &amp; Miller, M. I. (1994). Representations of knowledge in complex systems. <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, <em>56</em>(4), 549–603. <a href="http://www.jstor.org/stable/2346184">http://www.jstor.org/stable/2346184</a>
</div>
<div id="ref-Hairer2021-Convergence" class="csl-entry">
Hairer, M. (2021). <em>Convergence of markov processes</em>. <a href="https://www.hairer.org/notes/Convergence.pdf">https://www.hairer.org/notes/Convergence.pdf</a>
</div>
<div id="ref-Ikeda-Watanabe1981" class="csl-entry">
Ikeda, N., &amp; Watanabe, S. (1981). <em>Stochastic differential equations and diffusion processes</em> (Vol. 24). Elsevier. <a href="https://doi.org/10.1016/S0924-6509(08)70217-4">https://doi.org/10.1016/S0924-6509(08)70217-4</a>
</div>
<div id="ref-Mengersen-Robert1996" class="csl-entry">
Mengersen, K. L., &amp; Robert, C. P. (1996). Testing for mixtures: A bayesian entropic approach. <em>Bayesian Statistics 5: Proceedings of the Fifth Valencia International Meetings</em>, 255–276. <a href="https://academic.oup.com/book/54042/chapter-abstract/422209682">https://academic.oup.com/book/54042/chapter-abstract/422209682</a>
</div>
<div id="ref-Meyn-Tweedie1993" class="csl-entry">
Meyn, S. P., &amp; Tweedie, R. L. (1993). Stability of markovian processes II: Continuous-time processes and sampled chains. <em>Advances in Applied Probability</em>, <em>25</em>(3), 487–517. <a href="http://www.jstor.org/stable/1427521">http://www.jstor.org/stable/1427521</a>
</div>
<div id="ref-Meyn-Tweedie2009" class="csl-entry">
Meyn, S., &amp; Tweedie, R. L. (2009). <em>Markov chains and stochastic stability</em>. Cambridge University Press. <a href="https://doi.org/10.1017/CBO9780511626630">https://doi.org/10.1017/CBO9780511626630</a>
</div>
<div id="ref-Neal1994" class="csl-entry">
Neal, R. M. (1994). An improved acceptance procedure for the hybrid monte carlo algorithm. <em>Journal of Computational Physics</em>, <em>111</em>(1), 194–203. <a href="https://doi.org/10.1006/jcph.1994.1054">https://doi.org/10.1006/jcph.1994.1054</a>
</div>
<div id="ref-Parisi1980" class="csl-entry">
Parisi, G. (1980). A sequence of approximated solutions to the s-k model for spin glasses. <em>Journal of Physics A: Mathematical and General</em>, <em>13</em>(4), L115. <a href="https://doi.org/10.1088/0305-4470/13/4/009">https://doi.org/10.1088/0305-4470/13/4/009</a>
</div>
<div id="ref-Roberts-Rosenthal1998" class="csl-entry">
Roberts, G. O., &amp; Rosenthal, J. S. (1998). Optimal scaling of discrete approximations to langevin diffusions. <em>Journal of the Royal Statistical Society. Series B (Statistical Methodology)</em>, <em>60</em>(1), 255–268. <a href="http://www.jstor.org/stable/2985986">http://www.jstor.org/stable/2985986</a>
</div>
<div id="ref-Roberts-Tweedie1996" class="csl-entry">
Roberts, G. O., &amp; Tweedie, R. L. (1996a). Exponential convergence of langevin distributions and their discrete approximations. <em>Bernoulli</em>, <em>2</em>(4), 341–363. <a href="https://www.jstor.org/stable/3318418">https://www.jstor.org/stable/3318418</a>
</div>
<div id="ref-Roberts-Tweedie1996MH" class="csl-entry">
Roberts, G. O., &amp; Tweedie, R. L. (1996b). Geometric convergence and central limit theorems for multidimensional hastings and metropolis algorithms. <em>Biometrika</em>, <em>83</em>(1), 95–110. <a href="http://www.jstor.org/stable/2337435">http://www.jstor.org/stable/2337435</a>
</div>
<div id="ref-Sheu1991" class="csl-entry">
Sheu, S.-J. (1991). Some estimates of the transition density of a nondegenerate diffusion markov process. <em>The Annals of Probability</em>, <em>19</em>(2), 538–561. <a href="http://www.jstor.org/stable/2244362">http://www.jstor.org/stable/2244362</a>
</div>
<div id="ref-Tweedie1994" class="csl-entry">
Tweedie, R. L. (1994). Topological conditions enabling use of harris methods in discrete and continuous time. <em>Acta Applicandae Mathematica</em>, <em>34</em>(1), 175–188. <a href="https://doi.org/10.1007/BF00994264">https://doi.org/10.1007/BF00994264</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Doob の定理から，で良くないか？↩︎</p></li>
<li id="fn2"><p><img src="https://latex.codecogs.com/png.latex?%5Clog%5Cpi"> が <img src="https://latex.codecogs.com/png.latex?C%5E1">-級，の間違いでは？↩︎</p></li>
<li id="fn3"><p>これは，Langevin 拡散の分布は <img src="https://latex.codecogs.com/png.latex?%5Cleft%5C%7B%5Comega%5Cin%20C(%5Cmathbb%7BR%7D_+;%5Cmathbb%7BR%7D%5Ek)%5Cmid%5Comega(0)=x%5Cright%5C%7D"> 全体を台に持つから，<img src="https://latex.codecogs.com/png.latex?%5Cell_k"> と同値な分布を持つことになることが<span class="citation" data-cites="Bhattacharya1978">(Bhattacharya, 1978)</span> 定理2.1で触れられている．すると，<img src="https://latex.codecogs.com/png.latex?%5Cell_k">-非零集合は必ず到達可能である．↩︎</p></li>
<li id="fn4"><p><span class="citation" data-cites="Meyn-Tweedie2009">(S. Meyn &amp; Tweedie, 2009, p. 124)</span> 第６章がこのテーマを扱っている．定理6.0.1の(iii)は <img src="https://latex.codecogs.com/png.latex?%5Cpsi">-既約な Feller Markov 過程が <img src="https://latex.codecogs.com/png.latex?(%5Cmathrm%7Bsupp%7D%5C;%5Cpsi)%5E%5Ccirc%5Cne%5Cemptyset"> であるとき，<img src="https://latex.codecogs.com/png.latex?T">-連鎖であること，(ii)は <img src="https://latex.codecogs.com/png.latex?%5Cpsi">-既約な <img src="https://latex.codecogs.com/png.latex?T">-連鎖は任意のコンパクト集合を petite にすることを述べている．<span class="citation" data-cites="Tweedie1994">(Tweedie, 1994, p. 定理5.1)</span> は連続過程について述べているが結局「<span class="citation" data-cites="Meyn-Tweedie2009">(S. Meyn &amp; Tweedie, 2009)</span>と同様に示せる」としか言っていない．最後に，既約かつ非周期的ならば，任意の petite 集合は小さい．↩︎</p></li>
<li id="fn5"><p><img src="https://latex.codecogs.com/png.latex?%5Cell_k"> と <img src="https://latex.codecogs.com/png.latex?L_t"> の分布が同値であるから，任意の <img src="https://latex.codecogs.com/png.latex?%5Cell_k">-正集合には，任意のスケルトンが到達可能であるはずである．このことは周期性を破る．↩︎</p></li>
<li id="fn6"><p>分布を定める (distribution-determining class)という言い方をしている．↩︎</p></li>
<li id="fn7"><p>例えば <span class="citation" data-cites="Meyn-Tweedie2009">(S. Meyn &amp; Tweedie, 2009, p. 定理15.0.1)</span>．↩︎</p></li>
<li id="fn8"><p><span class="citation" data-cites="Hairer2021-Convergence">(Hairer, 2021, p. 34)</span> など．↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Review</category>
  <guid>https://162348.github.io/posts/2024/Review/Roberts-Tweedie1996.html</guid>
  <pubDate>Mon, 22 Apr 2024 15:00:00 GMT</pubDate>
  <media:content url="https://162348.github.io/posts/2024/Review/Roberts-Tweedie1996.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>Duane+ (1987) Hybrid Monte Carlo</title>
  <dc:creator>司馬博文 </dc:creator>
  <link>https://162348.github.io/posts/2024/Review/Duane+1987.html</link>
  <description><![CDATA[ 





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<section id="概要と背景" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="概要と背景"><span class="header-section-number">1</span> 概要と背景</h2>
<section id="hmc-とは" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="hmc-とは"><span class="header-section-number">1.1</span> HMC とは</h3>
<p>hybrid Monte Carlo とは，MD と MC（＝Metropolis 法） の融合を指す．</p>
<p>すなわち，粒子を動かして，これを棄却手続きによって正準集団を作る MCMC 法を指すが，粒子の動かし方＝提案核を運動論から構成するというのである．<sup>1</sup></p>
<p>そもそも著者は <span class="citation" data-cites="Duane1985">(Duane, 1985)</span> において，場の量子論をシミュレーションするための “hybrid algorithm” を提案していた．これは第三の量子化と呼ばれる <span class="citation" data-cites="Parisi-Wu1981">(Parisi &amp; Wu, 1981)</span> の確率過程量子化に基づく Langevin algorithm と 小正準法（量子系に対する MD 法）のいいとこ取りをする確率的アルゴリズムである．</p>
<p>ここからさらに Monte Carlo を導入し，「MD を提案分布にする」という発想の転換がある．正確には，任意の Hamilton 力学系を提案分布にとっても，Metropolis 法が使えるということを示唆したのである．この Hamilton 力学系を正確に取ると，これは hybrid algorithm になる（古典系に対しては MD に一致するだろう）が，必ずしも正確に取る必要はないのである．</p>
</section>
<section id="概要" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="概要"><span class="header-section-number">1.2</span> 概要</h3>
<p><span class="citation" data-cites="Duane+1987">(Duane et al., 1987)</span> は格子上の場の理論における数値シミュレーション法として提案している．格子ゲージ理論は量子色力学で扱われる模型である．</p>
<ul>
<li>大きなステップサイズを用いても離散化誤差がない</li>
<li>フェルミオン自由度を含む量子色力学系のシミュレーションに有効</li>
</ul>
<p>である点が abstract で触れられている．</p>
</section>
<section id="導入" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="導入"><span class="header-section-number">1.3</span> 導入</h3>
<p>フェルミオン自由度がある系では，“Grassmann nature of the fermions” を除去するためにまず積分をして有効作用のみを取り出し，残りのボゾンのみを考えるが，このときに非常に遠距離な（非局所的な）相互作用になってしまう．</p>
<p>従来法には次の２つがある：</p>
<ol type="1">
<li>exact / entire Monte Carlo：ボゾンの局所的なアップデートは系の全体の状態をシミュレーションしないとわからないから，nested Monte Carlo ともいうべきサブルーチンを回す必要がある．pseudofermion を導入して，有効作用の変化を効率的に計算し，これを用いて元々のボゾン場をアップデートする．要は棄却のステップが大変に高価ということだろうか？</li>
<li>運動方程式の計算：MD に対応する方法である．小さいステップサイズで系全体を運動方程式に沿ってアップデートしていくことで，非局所的な有効作用というものは考えなくて済む．しかし，運動方程式の決定論的計算に伴う truncation error が導入される．</li>
</ol>
<p>後者の計算効率性と，前者の正確性を両取りすることを考える．</p>
</section>
</section>
<section id="本論" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="本論"><span class="header-section-number">2</span> 本論</h2>
<p>HMC は結局完全に Metropolis 法 <span class="citation" data-cites="Metropolis+1953">(Metropolis et al., 1953)</span> の枠内であり，詳細釣り合い条件を満たしにいくことを考える．ただし，この枠組みの中で最も優秀な方法を考える，というのである．</p>
<p>採択関数は <img src="https://latex.codecogs.com/png.latex?%0A%5Calpha(x,y)=1%5Cland%5Cfrac%7B%5Cpi(y)q(y,x)%7D%7B%5Cpi(x)q(x,y)%7D%0A"> で与えられるから，<sup>2</sup> <img src="https://latex.codecogs.com/png.latex?q(x,y)"> の計算が速いだけでなく，<img src="https://latex.codecogs.com/png.latex?q(y,x)"> も得られやすい理論的に都合の良い提案核 <img src="https://latex.codecogs.com/png.latex?Q"> を探すことを考える．</p>
<section id="先行研究" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="先行研究"><span class="header-section-number">2.1</span> 先行研究</h3>
<p>この考えは molecular dynamics と Langevin algorithm をハイブリッドするアルゴリズム <span class="citation" data-cites="Duane1985">(Duane, 1985)</span>, <span class="citation" data-cites="Duane-Kogut1986">(Duane &amp; Kogut, 1986)</span> に基づく．</p>
<p>場の理論において，<a href="https://ja.wikipedia.org/wiki/%E7%A2%BA%E7%8E%87%E9%81%8E%E7%A8%8B%E9%87%8F%E5%AD%90%E5%8C%96">確率過程量子化</a> (stochastic quantization) <span class="citation" data-cites="Parisi-Wu1981">(Parisi &amp; Wu, 1981)</span> に基づく Langevin 方程式の方法と，小正準集団の方法（MD に近い，QCD の熱力学のシミュレーションにも使われる）という２つの方法が，特に力学的フェルミオンを含んだ系の数値シミュレーションにおいて魅力的な代替理論になっている．</p>
<p>この２つのシミュレーションのいいとこ取りをする hybrid algorithm が <span class="citation" data-cites="Duane1985">(Duane, 1985)</span> で提案されており，<span class="citation" data-cites="Duane-Kogut1986">(Duane &amp; Kogut, 1986)</span> で理論的な解析が進められた．これは，確率 <img src="https://latex.codecogs.com/png.latex?p%5CDelta"> によって，Langevin 法を用いるか，小正準法を決めるというアルゴリズムである．これは系をある熱浴に接続するという物理的な解釈を持つ．加えて，このアルゴリズムの軌跡は，ある古典的な運動方程式に従った奇跡ともみなせる．</p>
</section>
<section id="アイデア" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="アイデア"><span class="header-section-number">2.2</span> アイデア</h3>
<p>Parisi-Wu の確率過程量子化では，仮想的な時間 <img src="https://latex.codecogs.com/png.latex?t"> を導入して，場の量 <img src="https://latex.codecogs.com/png.latex?%5Cphi_i(x)"> が Langevin 方程式に従って発展するとする．こうして定まる確率過程が <img src="https://latex.codecogs.com/png.latex?t%5Cto%5Cinfty"> の極限で場の量子論を与えるというのである．</p>
<p>これに倣い，仮想的な時間パラメータ <img src="https://latex.codecogs.com/png.latex?%5Ctau"> と Hamilton 力学系を導入する．ここで補助変数として，共役運動量 <img src="https://latex.codecogs.com/png.latex?%5Cpi(t)"> が導入される．</p>
<p>もし Hamiltonian <img src="https://latex.codecogs.com/png.latex?H"> を正確に対象の系と同様に取れば，採択率は <img src="https://latex.codecogs.com/png.latex?1"> になり，これが hybrid algorithm <span class="citation" data-cites="Duane1985">(Duane, 1985)</span> に他ならない．しかし，ずらしても良いのである．</p>
</section>
<section id="検証" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="検証"><span class="header-section-number">2.3</span> 検証</h3>
<p>詳細釣り合い条件を満たすことを示している．詳細釣り合い条件が満たされる主な理由は Hamilton 力学系が可逆であることによる．</p>



</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-Duane1985" class="csl-entry">
Duane, S. (1985). Stochastic quantization versus the microcanonical ensemble: Getting the best of both worlds. <em>Nuclear Physics B</em>, <em>257</em>, 652–662. <a href="https://doi.org/10.1016/0550-3213(85)90369-4">https://doi.org/10.1016/0550-3213(85)90369-4</a>
</div>
<div id="ref-Duane+1987" class="csl-entry">
Duane, S., Kennedy, A. D., Pendleton, B. J., &amp; Roweth, D. (1987). Hybrid monte carlo. <em>Physics Letters B</em>, <em>195</em>(2), 216–222. <a href="https://doi.org/10.1016/0370-2693(87)91197-X">https://doi.org/10.1016/0370-2693(87)91197-X</a>
</div>
<div id="ref-Duane-Kogut1986" class="csl-entry">
Duane, S., &amp; Kogut, J. B. (1986). The theory of hybrid stochastic algorithms. <em>Nuclear Physics B</em>, <em>275</em>(3), 398–420. <a href="https://doi.org/10.1016/0550-3213(86)90606-1">https://doi.org/10.1016/0550-3213(86)90606-1</a>
</div>
<div id="ref-Metropolis+1953" class="csl-entry">
Metropolis, N., Rosenbluth, A. W., Rosenbluth, M. N., Teller, A. H., &amp; Teller, E. (1953). Equation of state calculations by fast computing machines. <em>The Journal of Chemical Physics</em>, <em>21</em>(6), 1087–1092. <a href="https://doi.org/10.1063/1.1699114">https://doi.org/10.1063/1.1699114</a>
</div>
<div id="ref-Neal1996" class="csl-entry">
Neal, R. M. (1996). <em>Bayesian learning for neural networks</em> (Vol. 118). Springer New York. <a href="https://link.springer.com/book/10.1007/978-1-4612-0745-0">https://link.springer.com/book/10.1007/978-1-4612-0745-0</a>
</div>
<div id="ref-Parisi-Wu1981" class="csl-entry">
Parisi, G., &amp; Wu, Y. (1981). PERTURBATION THEORY WITHOUT GAUGE FIXING. <em>Scientia Sinica</em>, <em>24</em>(4), 483–483. <a href="https://www.sciengine.com/Math%20A0/doi/10.1360/ya1981-24-4-483">https://www.sciengine.com/Math%20A0/doi/10.1360/ya1981-24-4-483</a>
</div>
<div id="ref-鎌谷20-モンテカルロ" class="csl-entry">
鎌谷研吾. (2020). <em>モンテカルロ統計計算</em>. 講談社.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>“a form of the Metropolis algorithm in which candidate states are found by means of dynamical simulation.” <span class="citation" data-cites="Neal1996">(Neal, 1996, p. 55)</span>↩︎</p></li>
<li id="fn2"><p><span class="citation" data-cites="鎌谷20-モンテカルロ">(鎌谷研吾, 2020)</span> より．↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Review</category>
  <guid>https://162348.github.io/posts/2024/Review/Duane+1987.html</guid>
  <pubDate>Wed, 17 Apr 2024 15:00:00 GMT</pubDate>
  <media:content url="https://162348.github.io/posts/2024/Review/Duane+1987.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>Tartero and Krauth (2023) Concepts in Monte Carlo Sampling</title>
  <dc:creator>司馬博文 </dc:creator>
  <link>https://162348.github.io/posts/2024/Review/Tartero-Krauth2023.html</link>
  <description><![CDATA[ 





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<section id="背景" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="背景"><span class="header-section-number">1</span> 背景</h2>
<p>Krauth は <span class="citation" data-cites="Bernard+2009">(Bernard et al., 2009)</span> において event-chain Monte Carlo アルゴリズムを提案した．</p>
<p>その後この手法は一般の連続系に適用できる形に拡張され，連続スピン系などにも適用されている <span class="citation" data-cites="酒井佑士2017">(酒井佑士, 2017, p. 24)</span>．</p>
</section>
<section id="本論" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="本論"><span class="header-section-number">2</span> 本論</h2>
<p>１粒子が次の one-dimensional anharmonic potential <img src="https://latex.codecogs.com/png.latex?%0AU_%7B24%7D(x)=%5Cfrac%7Bx%5E2%7D%7B2%7D+%5Cfrac%7Bx%5E4%7D%7B4%7D%0A"> に従って運動する場合を考える．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/Computation/Files/potential.svg" class="img-fluid figure-img"></p>
<figcaption>ポテンシャル <img src="https://latex.codecogs.com/png.latex?U"> のプロット</figcaption>
</figure>
</div>
<p>このポテンシャルに関する Boltzmann-Gibbs 分布 <img src="https://latex.codecogs.com/png.latex?%5Cpi_%7B24%7D"> は次の通り：</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/Computation/Files/Gibbs.svg" class="img-fluid figure-img"></p>
<figcaption>ポテンシャル <img src="https://latex.codecogs.com/png.latex?U"> が定める Botlzmann-Gibbs 分布のプロット</figcaption>
</figure>
</div>
<p><img src="https://latex.codecogs.com/png.latex?%0AZ(%5Cbeta)=%5Cint%5E%5Cinfty_%7B-%5Cinfty%7D%5Cpi_%7B24%7D(x)%5C,dx=%5Cfrac%7Be%5E%7B%5Cfrac%7B%5Cbeta%7D%7B8%7D%7D%7D%7B%5Csqrt%7B2%7D%7DK_%7B1/4%7D%5Cleft(%5Cfrac%7B%5Cbeta%7D%7B8%7D%5Cright)%0A"></p>
<p>１粒子非調和振動子は，孤立系としては決定論的な力学系であるが，熱浴に接続すると区分確定的な系になる <span class="citation" data-cites="Davis1984">(Davis, 1984)</span>．この系からは，Newton 力学と熱浴との相互作用の MD モデリングによって，<img src="https://latex.codecogs.com/png.latex?%5Cpi_%7B24%7D"> からサンプリングすることができる．</p>
<p>この系を「熱浴に接続する」とは，速度を交換出来る仕組みを導入すれば良い．例えば振動中心 <img src="https://latex.codecogs.com/png.latex?x=0"> に半透性の弾性的な物体（thermostat）を固定し，振動子が <img src="https://latex.codecogs.com/png.latex?x=0"> を通る度に確率 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B2%7D"> で弾性衝突して速度を交換する系などとして考えられる．この半透性で弾性的な物体は無視できる幅で振動しながら熱浴と接続されており，温度が一定に保たれているとする．<sup>1</sup></p>
<p>この系を十分に放置すると，粒子の位置 <img src="https://latex.codecogs.com/png.latex?x"> は Boltzmann-Gibbs 分布 <img src="https://latex.codecogs.com/png.latex?%5Cpi_%7B24%7D%5C,%5Cpropto%5C,e%5E%7B-%5Cbeta%20U_%7B24%7D%7D"> に従う．</p>
<ol type="1">
<li>これを，粒子の位置 <img src="https://latex.codecogs.com/png.latex?x"> を力学に基づいて追跡することで <img src="https://latex.codecogs.com/png.latex?%5Cpi_%7B24%7D"> からサンプリングすることも考えられる．これを MD 法という．</li>
<li>一方で Monte Carlo 法によりサンプリングすることが出来る．ここでは Gauss 分布の方が裾が重いので，これを提案分布とした棄却法によりサンプリングできる．積分を実行する場合も重点サンプリング法の考え方で実行できる．</li>
<li><span class="citation" data-cites="Metropolis+1953">(Metropolis et al., 1953)</span> などではこの提案分布と対象分布の距離が離れすぎていることが問題なのであった．そこで Markov 連鎖を用いるのである．Metropolis 法とは，正方形の範囲への一様ランダムウォークから，採択-棄却のフィルターを通じて Markov 核を構成する普遍的手続きだと言える．</li>
<li>目標分布が因子分解可能であるとき，別のフィルター factorized Metropolis filter を通じても詳細釣り合い条件から Markov 核が構成できる．これは独立な乱数を生成して，全員可決したときに採択する，というよりスピーディーな棄却手続きが可能で consensus と呼ばれている．</li>
<li><span class="citation" data-cites="Chen+1999">(Chen et al., 1999)</span>, <span class="citation" data-cites="Diaconis+2000">(Diaconis et al., 2000)</span> によって詳細釣り合い条件を破る方法 lifting が提案された．これは補助変数法により，同じ方向に進み続けるように設計された Markov 連鎖である．<sup>2</sup></li>
<li>lifting を通じて，アルゴリズムを連続時間ベースにできる．これは，いちいち細かいステップサイズで「提案」するのではなく，次に棄却される位置と時刻をサンプリングすれば良い，というのである．event-driven にすることで連続時間ベースのシミュレーションが可能になるのである．</li>
<li>この event-driven なバージョンでも，factorized filter と consensus を応用できる．</li>
<li><img src="https://latex.codecogs.com/png.latex?U"> の評価が高価である場合，これよりも採択率が下がるような bounding potential <img src="https://latex.codecogs.com/png.latex?%5Cwidehat%7BU%7D"> を用いることができる．これをフィルターを狭めるという感覚で thining <span class="citation" data-cites="Lewis-Shedler1979">(Lewis &amp; Shedler, 1979)</span> という．棄却された場合に，本格的に <img src="https://latex.codecogs.com/png.latex?U"> を評価する．</li>
</ol>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-Bernard+2009" class="csl-entry">
Bernard, E. P., Krauth, W., &amp; Wilson, D. B. (2009). Event-chain monte carlo algorithms for hard-sphere systems. <em>Phys. Rev. E</em>, <em>80</em>, 056704. <a href="https://doi.org/10.1103/PhysRevE.80.056704">https://doi.org/10.1103/PhysRevE.80.056704</a>
</div>
<div id="ref-Chen+1999" class="csl-entry">
Chen, F., Lovász, L., &amp; Pak, I. (1999). Lifting markov chains to speed up mixing. <em>Proceedings of the Thirty-First Annual ACM Symposium on Theory of Computing</em>, 275–281. <a href="https://doi.org/10.1145/301250.301315">https://doi.org/10.1145/301250.301315</a>
</div>
<div id="ref-Davis1984" class="csl-entry">
Davis, M. H. A. (1984). Piecewise-deterministic markov processes: A general class of non-diffusion stochastic models. <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, <em>46</em>(3), 353–388. <a href="https://www.jstor.org/stable/2345677">https://www.jstor.org/stable/2345677</a>
</div>
<div id="ref-Diaconis+2000" class="csl-entry">
Diaconis, P., Holmes, S., &amp; Neal, R. M. (2000). Analysis of a nonreversible markov chain sampler. <em>The Annals of Applied Probability</em>, <em>10</em>(3), 726–752. <a href="http://www.jstor.org/stable/2667319">http://www.jstor.org/stable/2667319</a>
</div>
<div id="ref-Lewis-Shedler1979" class="csl-entry">
Lewis, P. A. W., &amp; Shedler, G. S. (1979). Simulation of nonhomogeneous poisson processes by thinning. <em>Naval Research Logistics Quarterly</em>, <em>26</em>(3), 403–413. <a href="https://doi.org/10.1002/nav.3800260304">https://doi.org/10.1002/nav.3800260304</a>
</div>
<div id="ref-Metropolis+1953" class="csl-entry">
Metropolis, N., Rosenbluth, A. W., Rosenbluth, M. N., Teller, A. H., &amp; Teller, E. (1953). Equation of state calculations by fast computing machines. <em>The Journal of Chemical Physics</em>, <em>21</em>(6), 1087–1092. <a href="https://doi.org/10.1063/1.1699114">https://doi.org/10.1063/1.1699114</a>
</div>
<div id="ref-Turitsyn+2011" class="csl-entry">
Turitsyn, K. S., Chertkov, M., &amp; Vucelja, M. (2011). <span class="nocase">Irreversible Monte Carlo algorithms for Efficient Sampling</span>. <em>Physica D-Nonlinear Phenomena</em>, <em>240</em>(5-Apr), 410–414. <a href="https://doi.org/10.1016/j.physd.2010.10.003">https://doi.org/10.1016/j.physd.2010.10.003</a>
</div>
<div id="ref-酒井佑士2017" class="csl-entry">
酒井佑士. (2017). <em>マルコフ連鎖モンテカルロ法における詳細つり合い条件の破れの効果と応用</em> [PhD thesis, 東京大学]. <a href="https://repository.dl.itc.u-tokyo.ac.jp/records/50422">https://repository.dl.itc.u-tokyo.ac.jp/records/50422</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>このとき，thermostat は Maxwell 分布に従うわけではない点に注意．熱浴内の粒子と違って，thermostat は <img src="https://latex.codecogs.com/png.latex?x=0"> に固定されているため（例えば無視できる幅で振動しているとする），Maxwell boundary condition と呼ばれる分布に従い，比較的に簡単にサンプリングできる．↩︎</p></li>
<li id="fn2"><p>元の状態空間を拡張した上で詳細釣り合い条件の破れを導入する手法を総称して lifting と呼ぶ <span class="citation" data-cites="酒井佑士2017">(酒井佑士, 2017)</span>．特に２値空間との席をとってリフティングをする手法は <span class="citation" data-cites="Turitsyn+2011">(Turitsyn et al., 2011)</span> による方法で，<span class="citation" data-cites="酒井佑士2017">(酒井佑士, 2017, pp. 24–24)</span> で詳細な解析が与えられている．↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Review</category>
  <guid>https://162348.github.io/posts/2024/Review/Tartero-Krauth2023.html</guid>
  <pubDate>Wed, 17 Apr 2024 15:00:00 GMT</pubDate>
</item>
<item>
  <title>Metropolis+ (1953) Equation of State Calculations by Fast Computing Machines</title>
  <dc:creator>司馬博文 </dc:creator>
  <link>https://162348.github.io/posts/2024/Review/Metropolis+1953.html</link>
  <description><![CDATA[ 





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<section id="概要" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="概要"><span class="header-section-number">1</span> 概要</h2>
<p>相互作用する分子系からなる物質の状態方程式などの性質を調べるために使える汎用手法（ fast computing machine にぴったり！）を提案する．</p>
<p>この手法は配置空間上の，提案分布を正確にした「修正版 Monte Carlo 積分法」だと捉えられる，としている．</p>
<p>現代的には，１度に一つの粒子ずつを動かすことで，棄却率の低下を防いだ Metropolis-within-Gibbs サンプラーと理解できる．<sup>1</sup></p>
<p>MANIAC を用いて，２次元剛体円板の液相転移のシミュレーション結果を付した．その結果を，自由体積状態方程式と，４項ビリアル係数展開と比較した．<sup>2</sup></p>
<p>一方，<span class="citation" data-cites="Wood-Parker1957">(Wood &amp; Parker, 1957)</span> ではこの手法を３次元の Lennard-Jones ポテンシャルに適用しており，相転移の痕跡を掴んでいる．</p>
<p>この手法を Ising 模型に応用した <span class="citation" data-cites="Glauber1963">(Glauber, 1963)</span> は (random scan) Gibbs サンプラーの先駆けとみなされている．</p>
</section>
<section id="背景" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="背景"><span class="header-section-number">2</span> 背景</h2>
<section id="サンプリング法としては見られていない" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="サンプリング法としては見られていない"><span class="header-section-number">2.1</span> サンプリング法としては見られていない</h3>
<p>むしろ cell method などの計算手法との類似で捉えており，<span class="citation" data-cites="Hastings1970">(Hastings, 1970)</span> に取り上げられるまで全く別個の，広く抽象的に応用されるポテンシャルを持つサンプリング法であるという抽象的な観点とは離れた泥臭い探索を感じる．</p>
<p>まだ Markov 連鎖という単語も使われていない．</p>
</section>
<section id="分子シミュレーションの延長としての-monte-carlo-法" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="分子シミュレーションの延長としての-monte-carlo-法"><span class="header-section-number">2.2</span> 分子シミュレーションの延長としての Monte Carlo 法</h3>
<p>話の展開は，分子系のシミュレーションの問題を，Gibbs 分布に関する積分計算の問題に帰着し，Monte Carlo 法を用いるところまで還元するが，そこで不適当な提案分布による重点サンプリングを実行するよりかは，系の Gibbs 分布を直接シミュレーションすれば良い，というものである．</p>
<p>よってここでいう修正 Monte Carlo 法とは，Monte Carlo 法（ここでは重点サンプリングと同義，（一様）乱数を用いた数値計算，くらいの意味）による乱数生成過程を，少しだけ MD 法の考え方を取り入れて，より Gibbs 分布に則した乱数生成をする，くらいの提案である．</p>
<p>後世では次のようにも説明されている始末である：</p>
<blockquote class="blockquote">
<p>The Monte Carlo method addresses the sampling problem more abstractly than molecular dynamics, as it samples (obtains samples <img src="https://latex.codecogs.com/png.latex?x"> from) the distribution <img src="https://latex.codecogs.com/png.latex?%5Cpi_%7B24%7D(x)"> without simulating a physical process. <span class="citation" data-cites="Tartero-Krauth2023">(Tartero &amp; Krauth, 2023)</span></p>
</blockquote>
<p>もはや，愚直な Monte Carlo 法が MD 法で，運動方程式を解かない MD 法が Monte Carlo 法，という具合である．事実，気体の状態方程式は，気体分子の運動の力学には無関係に成り立つので，必ずしも正しい力学に従ったシミュレーションが必要というわけではないのである．<sup>3</sup></p>
<p>なお，Monte Carlo 法の提案者として <a href="https://en.wikipedia.org/wiki/Joseph_Edward_Mayer">Joseph Edward Mayer</a> と <a href="https://en.wikipedia.org/wiki/Stanis%C5%82aw_Ulam">Stanisław Ulam</a> の名前を挙げている．</p>
<p>ここで <a href="https://en.wikipedia.org/wiki/Berni_Alder">Berni Alder</a> の名前が上がっており，やはり MCMC の開発は MD と極めて深い関係にあることが伺える．</p>
<blockquote class="blockquote">
<p>This method has been proposed independently by J. E. Mayer and by S. Ulam. Mayer suggested the method as a tool to deal with the problem of the liquid state, while Ulam proposed it as a procedure of general usefulness. B. Alder, J. Kirkwood, S. Frankel, and V. Lewinson discussed an application very similar to ours.</p>
</blockquote>
</section>
<section id="monte-carlo-法の起源について" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="monte-carlo-法の起源について"><span class="header-section-number">2.3</span> Monte Carlo 法の起源について</h3>
<p>John von Neumann は Edward Teller と同郷であり，戦時中の ENIAC の開発にも関わっていたことから，偉い人たちを説得して最初の ENIAC のテストに熱核融合反応の計算問題を用いることにした．</p>
<p>計算可能なモデルの構築をしたのが Metropolis である．これが完成し，実際にテストが行われたのは戦後の 1946 年であったが．</p>
<p>そのお披露目会に居合わせた Stanislaw Ulam が，統計的サンプリング技術を電子計算機で復活させることを提案し，Johnny がすぐさまその重要性を理解した．これがモンテカルロ法の始まりとなった，という <span class="citation" data-cites="Metropolis1987">(Metropolis, 1987)</span>．</p>
<p>Metropolis は Ulam が着想を得た理由として，数学的な背景を持っていたために，統計的サンプリング技術が計算の難しさのために歴史に埋没したことを知っており，ENIAC のポテンシャルを見てこれと関連づけることに成功したのではないかと示唆している．</p>
<p>そして Johnny の熱の入り用が周りも刺激した．1947 年には統計的サンプリングの中でも特に中性子の拡散問題を取り上げて当時の Los Alamos の理論部リーダーであった Robert Richtmyer に手紙を送った <span class="citation" data-cites="Eckhardt1987">(Eckhardt, 1987)</span>．こうして周りを巻き込んで大ごとになっていった．Monte Carlo 法という命名も 1947 年だったという</p>
<blockquote class="blockquote">
<p>It was at that time that I suggested an obvious name for the statistical method—a suggestion not unrelated to the fact that Stan had an uncle who would borrow money from relatives because he “just had to go to Monte Carlo.”</p>
</blockquote>
<blockquote class="blockquote">
<p>On a less grand scale these events brought about a renascence of a mathematical technique known to the old guard as statistical sampling; in its new surroundings and owing to its nature, there was no denying its new name of the Monte Carlo method. <span class="citation" data-cites="Metropolis1987">(Metropolis, 1987)</span></p>
</blockquote>
<p>特に戦時中の関心もあり，核分裂時の <strong>中性子の拡散</strong> のシミュレーションが問題であった．Monte Carlo 法と呼んでいるが本質的に MD 法チックであり，ここの中性子の散乱・吸収・分裂の系譜をシミュレートすることで全体の統計的性質がわかる，というだけの話であった．</p>
<p>その後 1952 年には後続機の MANIAC が開発され，nucleaer cascade と状態方程式も射程に入った．</p>
<p>この状態方程式を取り扱う際に <span class="citation" data-cites="Metropolis+1953">(Metropolis et al., 1953)</span> がさらに効率的な「モンテカルロ法」を発明したのである．これは Gibbs 分布を直接シミュレーションできるというブレイクスルーであり，「一般の確率分布からサンプリングできる」という今の理解とは大きく異なる文脈の中で発見されたと言うべきである．</p>
</section>
<section id="monte-carlo-法とはなんだろうか" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="monte-carlo-法とはなんだろうか"><span class="header-section-number">2.4</span> Monte Carlo 法とはなんだろうか</h3>
<p>思うに，「ランダムな方法を使って計算する」というのは外道に思えるかもしれない．</p>
<p>だが，実はランダムな系の <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> 上のダイナミクスの決定論的な計算になっているのかもしれない．</p>
<p>そう思わせるだけの透徹性が測度論にはある．</p>
<p>ただ，<span class="citation" data-cites="Metropolis1987">(Metropolis, 1987)</span> は Monte Carlo 法を <strong>実験数学</strong> (experimental mathematics) と呼んでおり，極めて物理学的な見方で評している：</p>
<blockquote class="blockquote">
<p>At long last, mathematics achieved a certain parity–the twofold aspect of experiment and theory–that all other sciences enjoy.</p>
</blockquote>
</section>
<section id="他のコメント" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="他のコメント"><span class="header-section-number">2.5</span> 他のコメント</h3>
<blockquote class="blockquote">
<p>Note that <span class="citation" data-cites="Metropolis+1953">(Metropolis et al., 1953)</span> move one particle at a time, rather than moving all of them together, which makes the initial algorithm appear a primitive kind of Gibbs sampler! <span class="citation" data-cites="Robert-Casella2011">(Robert &amp; Casella, 2011)</span></p>
</blockquote>
<p>この点は，Metropolis 法と MD 法の違いとも通じる．</p>
<p>Metropolis の方法は１つの粒子を順番に動かすが，MD 法では全ての粒子を同時に動かす．</p>
<p>加えて，Metropolis 法は平衡状態のシミュレーションのみを想定しているという点で，本質的にはサンプリング法であるが，MD 法は非平衡系の時間発展も同等に扱うシミュレーション法である．<sup>4</sup></p>
<p>本質的に Metropolis 法がサンプリング法であるならば，MD 法は <img src="https://latex.codecogs.com/png.latex?N">-体問題に対する数値解法である．</p>
</section>
</section>
<section id="本論" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="本論"><span class="header-section-number">3</span> 本論</h2>
<section id="設定" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="設定"><span class="header-section-number">3.1</span> 設定</h3>
<p>古典統計を仮定し，２体間相互作用のみを考え，ポテンシャルは球対称であるとする（流体力学では通常の仮定である）．だが，温度や密度には全く仮定を置かない．<sup>5</sup></p>
<p>実際の計算のために，粒子数 <img src="https://latex.codecogs.com/png.latex?N"> は several hundred に取る．そして正方形の中にいれ，境界条件を最小化するために同様の系が２次元に無限に連なっているとする．２つの粒子 <img src="https://latex.codecogs.com/png.latex?A"> の他の粒子 <img src="https://latex.codecogs.com/png.latex?B"> との最短距離を <img src="https://latex.codecogs.com/png.latex?d_%7BA,B%7D"> とし，これのみが粒子 <img src="https://latex.codecogs.com/png.latex?A"> にかかる主な力になるとする．</p>
<p>仮に <img src="https://latex.codecogs.com/png.latex?N=1"> だとしたら，これは <a href="https://ja.wikipedia.org/wiki/Particle-in-Cell%E6%B3%95">cell method</a> と呼ばれるモデルでもある．こうして粒子を増やすことで，単一相のシステムに対するより良いモデルになるだろうが，二相以上のシステムには限界がある．</p>
<p>以上の仮定から，系のエネルギーが次のように与えられる： <img src="https://latex.codecogs.com/png.latex?%0AE=%5Cfrac%7B1%7D%7B2%7D%5Csum_%7Bi%5Cne%20j%5Cin%5BN%5D%7DV(d_%7Bij%7D).%0A"></p>
<p>この系の平衡状態の性質を計算するには，Gibbs の正準分布を利用し，計算したい物理量 <img src="https://latex.codecogs.com/png.latex?F"> に対して <img src="https://latex.codecogs.com/png.latex?%0A%5Coverline%7BF%7D=%5Cfrac%7B%5Cint%20Fe%5E%7B-%5Cfrac%7BE%7D%7BkT%7D%7Dd%5E%7B2N%7Dpd%5E%7B2N%7Dq%7D%7B%5Cint%20e%5E%7B-%5Cfrac%7BE%7D%7BkT%7D%7Dd%5E%7B2N%7Dpd%5E%7B2N%7Dq%7D%0A"> を計算すれば良い．ただし，<img src="https://latex.codecogs.com/png.latex?d%5E%7B2n%7Dpd%5E%7B2n%7Dq"> は <img src="https://latex.codecogs.com/png.latex?4N"> 次元相空間上の体積要素である．</p>
<p>加えて，ここではポテンシャル <img src="https://latex.codecogs.com/png.latex?V"> は位置のみの引数としているから，<img src="https://latex.codecogs.com/png.latex?2N"> 次元上でのみ計算すれば良い．</p>
<p>このような数百次元上での積分を数値的方法で実行するのは明らかに実行可能でないから，Monte Carlo 法に頼らざるを得ない．と言っても，決定論的な点で値を計算する代わりに，ランダムに点をうつ，というだけの違いではある．</p>
<p>最も簡単な実装としては，ランダムに <img src="https://latex.codecogs.com/png.latex?N"> 粒子を配置してエネルギーを計算し（重点荷重），これにウェイトをつけて足していくということが考えられる（重点サンプリングだ！）．しかし，高エネルギーの配置もたくさん生成してしまうから，これによる効率の低減が避けられない（提案分布が悪いのだ！）．</p>
<p>そこで我々は <strong>modified Monte Carlo method</strong> を考える．<strong>そもそも確率 <img src="https://latex.codecogs.com/png.latex?e%5E%7B-%5Cfrac%7BE%7D%7BkT%7D%7D"> からサンプルを生成し，荷重を一様にすることを目指す</strong>．</p>
</section>
<section id="アルゴリズムの記述" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="アルゴリズムの記述"><span class="header-section-number">3.2</span> アルゴリズムの記述</h3>
<p>これは次のようにする．まず適当に初期分布を決める（格子点上に <img src="https://latex.codecogs.com/png.latex?N"> 粒子を配置するなど）．そしてこれをアップデートしていく： <img src="https://latex.codecogs.com/png.latex?%0AX%5Cmapsto%20X+%5Calpha%5Cxi_1%0A"> <img src="https://latex.codecogs.com/png.latex?%0AY%5Cmapsto%20Y+%5Calpha%5Cxi_2%0A"> <img src="https://latex.codecogs.com/png.latex?%5Calpha%3E0"> は一度にどれくらい動かすかを調節するパラメータであり，<img src="https://latex.codecogs.com/png.latex?%5Cxi_1,%5Cxi_2%5Cin(0,1)"> は一様乱数とする．<sup>6</sup></p>
<p>すなわち，<img src="https://latex.codecogs.com/png.latex?(X,Y)"> を中心とした一辺 <img src="https://latex.codecogs.com/png.latex?2%5Calpha"> の正方形の中で，新たな位置をランダムに決めるのである．<sup>7</sup></p>
<p>この動きによるエネルギーの変化量 <img src="https://latex.codecogs.com/png.latex?%5CDelta%20E"> を計算し，<img src="https://latex.codecogs.com/png.latex?%5CDelta%20E%3C0"> ならばこれを実行するが，<img src="https://latex.codecogs.com/png.latex?%5CDelta%20E%3E0"> ならば確率 <img src="https://latex.codecogs.com/png.latex?e%5E%7B-%5Cfrac%7B%5CDelta%20E%7D%7BkT%7D%7D"> によって採択する．</p>
<p>仮に棄却されたとしても，そのポジションから新たな Monte Carlo 標本を取り，最終的に <img src="https://latex.codecogs.com/png.latex?%0A%5Coverline%7BF%7D=%5Cfrac%7B1%7D%7BM%7D%5Csum_%7Bj=1%7D%5EMF_j%0A"> を推定量とする．</p>
</section>
<section id="アルゴリズムの有効性の検証" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="アルゴリズムの有効性の検証"><span class="header-section-number">3.3</span> アルゴリズムの有効性の検証</h3>
<p>まずこの系はエルゴードであると主張しているが，その論証は「任意の粒子が任意の位置に行くポテンシャルがあるため，この手法はエルゴード的である」で終わっている．エルゴードという単語を「任意の状態からもう一つの任意の状態に遷移可能である」という意味で使っている．これは現代的には既約性という．<sup>8</sup></p>
<p>続いて，この系をたくさんコピーしてアンサンブルを考えたとき，状態 <img src="https://latex.codecogs.com/png.latex?r"> にいるアンサンブルの数 <img src="https://latex.codecogs.com/png.latex?%5Cnu_r"> は <img src="https://latex.codecogs.com/png.latex?%0A%5Cnu_r%5C,%5Cpropto%5C,e%5E%7B-%5Cfrac%7BE_r%7D%7BkT%7D%7D%0A"> を満たすことを示したい．その論証は，上の比率から崩れていたら，平衡に至る方向へ移動が起こるということを具体的に議論している．</p>
<p>以上の２点から，提案されたアルゴリズムは正準分布に収束することの根拠としている．</p>
<p>このアンサンブルによる考え方は極めて直感的に訴える．実際，この語彙を用いて，棄却された場合は元々の状態を Monte Carlo サンプルとしてダブルカウントすべきであることを説明している．これをしなければ，低エネルギー状態のアンサンブルの数を不当に低く評価してしまう，という説明である．</p>
<p>ただし，<strong>このアンサンブルによる考え方は自然に我々の思考を詳細釣り合い条件に絞っている</strong>．</p>
</section>
<section id="附言" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="附言"><span class="header-section-number">3.4</span> 附言</h3>
<p>収束の速さについて注意喚起しているのみで，ステップサイズ <img src="https://latex.codecogs.com/png.latex?%5Calpha%3E0"> は大きすぎても棄却率が高まり，小さすぎても攪拌が遅くなるということ以外具体的なことは触れていない．</p>
</section>
</section>
<section id="実験" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="実験"><span class="header-section-number">4</span> 実験</h2>
<blockquote class="blockquote">
<p>In the case of two-dimensional rigid spheres, runs made with 56 particles and with 224 particles agreed within statistical error. For a computing time of a few hours with presently available electronic computers, it seems possible to obtain the pressure for a given volume and temperature to an accuracy of a few percent. In the case of two-dimensional rigid spheres our results are in agreement with the free volume approximation for <img src="https://latex.codecogs.com/png.latex?A/A_0%3C%201.8"> and with a five-term virial expansion for <img src="https://latex.codecogs.com/png.latex?A/A_0%3E%202.5">. There is no indication of a phase transition.</p>
</blockquote>
<p>16 step を焼き入れとし，48-64 いてレーションを実行するのに，MANIAC で 4-5時間かかったという．</p>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-Eckhardt1987" class="csl-entry">
Eckhardt, R. (1987). <span class="nocase">Stan Ulam, John von Neumann, and the Monte Carlo Method</span>. <em>Los Alamos Science Special Issue</em>, <em>15</em>, 131–143. <a href="http://www-star.st-and.ac.uk/~kw25/teaching/mcrt/MC_history_3.pdf">http://www-star.st-and.ac.uk/~kw25/teaching/mcrt/MC_history_3.pdf</a>
</div>
<div id="ref-Faulkner-Livingstone2024" class="csl-entry">
Faulkner, M. F., &amp; Livingstone, S. (2024). <span class="nocase">Sampling Algorithms in Statistical Physics: A Guide for Statistics and Machine Learning</span>. <em>Statistical Science</em>, <em>39</em>(1), 137–164. <a href="https://doi.org/10.1214/23-STS893">https://doi.org/10.1214/23-STS893</a>
</div>
<div id="ref-Glauber1963" class="csl-entry">
Glauber, R. J. (1963). <span class="nocase">Time‐Dependent Statistics of the Ising Model</span>. <em>Journal of Mathematical Physics</em>, <em>4</em>(2), 294–307. <a href="https://doi.org/10.1063/1.1703954">https://doi.org/10.1063/1.1703954</a>
</div>
<div id="ref-Hastings1970" class="csl-entry">
Hastings, W. K. (1970). Monte carlo sampling methods using markov chains and their applications. <em>Biometrika</em>, <em>57</em>(1), 97–109. <a href="https://www.jstor.org/stable/2334940">https://www.jstor.org/stable/2334940</a>
</div>
<div id="ref-Metropolis1987" class="csl-entry">
Metropolis, N. (1987). The beginning of the monte carlo method. <em>Los Alamos Science Special Issue</em>, <em>15</em>, 125–130. <a href="https://library.lanl.gov/cgi-bin/getfile?00326866.pdf">https://library.lanl.gov/cgi-bin/getfile?00326866.pdf</a>
</div>
<div id="ref-Metropolis+1953" class="csl-entry">
Metropolis, N., Rosenbluth, A. W., Rosenbluth, M. N., Teller, A. H., &amp; Teller, E. (1953). Equation of state calculations by fast computing machines. <em>The Journal of Chemical Physics</em>, <em>21</em>(6), 1087–1092. <a href="https://doi.org/10.1063/1.1699114">https://doi.org/10.1063/1.1699114</a>
</div>
<div id="ref-Peters-deWith2012" class="csl-entry">
Peters, E. A. J. F., &amp; de&nbsp;With, G. (2012). Rejection-free monte carlo sampling for general potentials. <em>Physical Review E</em>, <em>85</em>(2). <a href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.85.026703">https://journals.aps.org/pre/abstract/10.1103/PhysRevE.85.026703</a>
</div>
<div id="ref-Robert-Casella2011" class="csl-entry">
Robert, C., &amp; Casella, G. (2011). A short history of markov chain monte carlo: Subjective recollections from incomplete data. <em>Statistical Science</em>, <em>26</em>(1), 102–115. <a href="http://www.jstor.org/stable/23059158">http://www.jstor.org/stable/23059158</a>
</div>
<div id="ref-Tartero-Krauth2023" class="csl-entry">
Tartero, G., &amp; Krauth, W. (2023). <em>Concepts in monte carlo sampling</em>. <a href="https://arxiv.org/abs/2309.03136">https://arxiv.org/abs/2309.03136</a>
</div>
<div id="ref-Wood-Parker1957" class="csl-entry">
Wood, W. W., &amp; Parker, F. R. (1957). <span class="nocase">Monte Carlo Equation of State of Molecules Interacting with the Lennard‐Jones Potential. I. A Supercritical Isotherm at about Twice the Critical Temperature</span>. <em>The Journal of Chemical Physics</em>, <em>27</em>(3), 720–733. <a href="https://doi.org/10.1063/1.1743822">https://doi.org/10.1063/1.1743822</a>
</div>
<div id="ref-戸田+2011" class="csl-entry">
戸田盛和, 斎藤信彦, 久保亮五, &amp; 橋爪夏樹. (2011). <em>統計物理学</em> (新装版, Vol. 5). 岩波書店. <a href="https://www.iwanami.co.jp/book/b259545.html">https://www.iwanami.co.jp/book/b259545.html</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><span class="citation" data-cites="Faulkner-Livingstone2024">(Faulkner &amp; Livingstone, 2024, p. 13)</span> 4.1 節も参照．↩︎</p></li>
<li id="fn2"><p>このシミュレーションでは相転移は全く観察されなかった．これはこの方法が極めて収束が遅いことによる．その理由は <span class="citation" data-cites="Peters-deWith2012">(Peters &amp; de&nbsp;With, 2012)</span> が導入部で説明する通りである．↩︎</p></li>
<li id="fn3"><p><span class="citation" data-cites="戸田+2011">(戸田盛和 et al., 2011, p. 14)</span>↩︎</p></li>
<li id="fn4"><p><span class="citation" data-cites="Faulkner-Livingstone2024">(Faulkner &amp; Livingstone, 2024, p. 15)</span> 4.3 節も参照．↩︎</p></li>
<li id="fn5"><p>さらに，Lennard-Jones ポテンシャルについての２次元のケースも考えており，次のレポートで報告される予定であるという．↩︎</p></li>
<li id="fn6"><p>ここで乱数生成法に関して注記されている．これは <strong>middle square process</strong> で生成する，としている．↩︎</p></li>
<li id="fn7"><p>なお，periodic assumption をしているため（長方形の系の外には同様の系が無数に並んでいるとしたため），境界の外に出ようとした場合は衝突するのではなく，反対側の辺から入ってくるものとする．↩︎</p></li>
<li id="fn8"><p><span class="citation" data-cites="Robert-Casella2011">(Robert &amp; Casella, 2011)</span> も指摘している．だが，<span class="citation" data-cites="戸田+2011">(戸田盛和 et al., 2011, p. 5)</span> にも同じ意味で「エルゴード的」という単語を使っている記述がある．↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Review</category>
  <guid>https://162348.github.io/posts/2024/Review/Metropolis+1953.html</guid>
  <pubDate>Wed, 17 Apr 2024 15:00:00 GMT</pubDate>
  <media:content url="https://162348.github.io/posts/2024/Review/Metropolis+1953.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>アンサンブルと熱力学極限</title>
  <dc:creator>司馬博文 </dc:creator>
  <link>https://162348.github.io/posts/2024/Nature/StatisticalMechanics2.html</link>
  <description><![CDATA[ 





<p>統計力学で用いられる種々の模型については前稿参照：</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Nature/StatisticalMechanics1.html" target="_blank">
            <img src="https://162348.github.io/posts/2024/Nature/Lennard-Jones.svg" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">数学者のための統計力学１</h3>
                <p class="article-description">Ising 模型とスピングラス</p>
            </div>
        </a>
    </div>
</div>
<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<section id="導入" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="導入"><span class="header-section-number">1</span> 導入</h2>
<p>殆どの力学的現象は，相空間 <img src="https://latex.codecogs.com/png.latex?%5COmega%5Csubset%5Cmathbb%7BR%7D%5E%7B6N%7D"> と呼ばれる <a href="https://ncatlab.org/nlab/show/symplectic+manifold">シンプレクティック多様体</a> 上の Hamiltonian flow <img src="https://latex.codecogs.com/png.latex?(S_t)"> として理解される．統計力学では，その上に確率測度 <img src="https://latex.codecogs.com/png.latex?P"> を導入して運動を理解する．組 <img src="https://latex.codecogs.com/png.latex?(%5COmega,P)"> を統計集団という．</p>
<p>例えば，<img src="https://latex.codecogs.com/png.latex?N">-粒子系 <img src="https://latex.codecogs.com/png.latex?%5COmega_%7B%5CLambda,N%7D"> の統計的な振る舞いを最もよく記述する確率分布 <img src="https://latex.codecogs.com/png.latex?P%5Cin%5Cmathcal%7BP%7D(%5COmega_%7B%5CLambda,N%7D)"> を推定することを考える．</p>
<p>系が平衡状態にない場合は分子の衝突などを追加で考える必要があり，現在でも理論は発展中であるが，すでに平衡状態に至ったとみなせる場合には，この確率分布 <img src="https://latex.codecogs.com/png.latex?P"> というのは殆どわかる．</p>
<p>仮に初期分布 <img src="https://latex.codecogs.com/png.latex?P_0%5Cin%5Cmathcal%7BP%7D(%5COmega_%7B%5CLambda,N%7D)"> を持っていた場合，分布は Hamilton 流の押し出しにより <img src="https://latex.codecogs.com/png.latex?(S_t)_*P_0"> というように <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(%5COmega_%7B%5CLambda,N%7D)"> 上の力学系として発展していく．<sup>1</sup></p>
<p>従って，平衡分布は必ず <img src="https://latex.codecogs.com/png.latex?S_t"> の不動点，不変確率分布である必要があるが，これを満たす分布は複数存在する．そのうち特に意味のあるものが，小正準集団 <img src="https://latex.codecogs.com/png.latex?(%5COmega_%7B%5CLambda,N,E%7D,P%5E%7B%5Ctext%7Bmicrocanon%7D%7D_%7B%5CLambda,N,E%7D)">，正準集団 <img src="https://latex.codecogs.com/png.latex?(%5COmega_%7B%5CLambda,N%7D,P%5E%7B%5Ctext%7Bcanon%7D%7D_%7B%5CLambda,N,%5Cbeta%7D)">，大正準集団 <img src="https://latex.codecogs.com/png.latex?(%5COmega_%5CLambda,P%5E%7B%5Ctext%7Bgrandcanon%7D%7D_%7B%5CLambda,%5Cbeta,%5Cmu%7D)"> などである．「小」「大」などの接頭辞は分布の台の大きさとも思える．</p>
<p><strong>確率的な系も，確率分布の空間 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(%5COmega_%7B%5CLambda,N%7D)"> 上で見れば決定論的な発展をするのが数理の妙である</strong>．</p>
<p>これら３つの分布はどれもそれだけで完全なものではなく，熱力学極限において真に物理的に意味のある量になると理解する．</p>
</section>
<section id="小正準分布" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="小正準分布"><span class="header-section-number">2</span> 小正準分布</h2>
<p><a href="../../../posts/2024/Nature/StatisticalMechanics1.html#sec-microcanonical">小正準測度</a> <img src="https://latex.codecogs.com/png.latex?%5Cnu_%7B%5CLambda,N,E%7D"> を正規化したものも <img src="https://latex.codecogs.com/png.latex?S_t"> の不変確率分布である： <img src="https://latex.codecogs.com/png.latex?%0AP%5E%7B%5Ctext%7Bmicrocanon%7D%7D_%7B%5CLambda,N,E%7D(A):=%5Cfrac%7B%5Cnu_%7B%5CLambda,N,E%7D(A)%7D%7B%5Cnu_%7B%5CLambda,N,E%7D(%5COmega_%7B%5CLambda,N,E%7D)%7D%0A"></p>
<p>改めて，<img src="https://latex.codecogs.com/png.latex?P%5E%7B%5Ctext%7Bmicrocanon%7D%7D_%7B%5CLambda,N,E%7D"> は等エネルギー面 <img src="https://latex.codecogs.com/png.latex?%5COmega_%7B%5CLambda,N,E%7D"> 上にしか台を持たないことに注意．そのため，<img src="https://latex.codecogs.com/png.latex?P%5E%7B%5Ctext%7Bmicrocanon%7D%7D_%7B%5CLambda,N,E%7D"> は <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5E%7B6N%7D"> 上の Lebesgue 測度 <img src="https://latex.codecogs.com/png.latex?%5Cell_%7B6N%7D"> に関しては絶対連続ではない．<sup>2</sup></p>
<blockquote class="blockquote">
<p>このようにエネルギーが一定であるような力学系の集団を<strong>ミクロカノニカル集団</strong>，この集団の分布，すなわちそのエネルギーに対応する全ての微視状態へ，等しい確率を持って存在するような分布を<strong>ミクロカノニカル分布</strong>という．<span class="citation" data-cites="久保亮五2003">(久保亮五, 2003, p. 27)</span></p>
</blockquote>
<p>孤立系など，エネルギー一定の系は Hamiltonian の等位集合上で運動をする．その上の小正準測度 / Gelfand-Leray 測度は，相空間上の自然な体積要素から誘導される．<sup>3</sup> 従って小正準分布は運動に関して不変ではあるが，だからと言ってどのようなマクロ系に対しても小正準分布が平衡分布になると約束する法則は何もない．孤立したマクロ系（エネルギー一定以外に制約がない場合）が小正準分布に従うことは，等重率の仮定の具体的な表現と見れる，一種のモデルの仮定である．<sup>4</sup></p>
</section>
<section id="gibbs-の正準分布" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="gibbs-の正準分布"><span class="header-section-number">3</span> Gibbs の正準分布</h2>
<p>系のエネルギーを指定するのではなく，逆温度を指定することで，相空間上で密度 <img src="https://latex.codecogs.com/png.latex?%0Ap%5E%7B%5Ctext%7Bcanon%7D%7D_%7B%5CLambda,N,%5Cbeta%7D(Q,V)=%5Cfrac%7B1%7D%7BZ_%7B%5CLambda,N,%5Cbeta%7D%7De%5E%7B-%5Cbeta%20H_%7B%5CLambda,N%7D(Q,V)%7D%0A"> を持つ不変確率分布を得る．<sup>5</sup> これを <strong>正準分布</strong> (canonical distribution) という．</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbeta%3E0"> を <strong>逆温度</strong>，<img src="https://latex.codecogs.com/png.latex?Z_%7B%5CLambda,N,%5Cbeta%7D"> を <strong>分配関数</strong> (partition function / statistical sum) という．</p>
<p>古典気体の <img src="https://latex.codecogs.com/png.latex?H"> において位置に依存する項と速度に依存する項とが分かれているため，<img src="https://latex.codecogs.com/png.latex?P%5E%7B%5Ctext%7Bcanon%7D%7D_%7B%5CLambda,N,%5Cbeta%7D"> において位置と速度は独立であり，速度 <img src="https://latex.codecogs.com/png.latex?v_1,%5Ccdots,v_N"> も互いに独立でそれぞれは Gauss 分布に従う．これを <a href="https://ja.wikipedia.org/wiki/%E3%83%9E%E3%82%AF%E3%82%B9%E3%82%A6%E3%82%A7%E3%83%AB%E5%88%86%E5%B8%83"><strong>Maxwell の法則</strong></a> という．</p>
<p>また特に，Gibbs 測度の配置空間上での周辺分布は，configuration gas の Gibbs 測度に一致する．この意味で，古典気体の統計力学的性質は，configuration gas に帰着すると言える．</p>
</section>
<section id="つの関係と熱力学極限" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="つの関係と熱力学極限"><span class="header-section-number">4</span> ２つの関係と熱力学極限</h2>
<p>大雑把に捉えれば，エネルギー一定の力学系（例えば孤立系）の全ての状態の上の分布がミクロカノニカル分布であり，このエネルギーも動かした場合（例えば孤立系の部分系），各エネルギー上の分布はカノニカル分布になる．</p>
<p><img src="https://latex.codecogs.com/png.latex?%5CLambda_0%5Csubset%5CLambda"> を部分領域として，この領域に <img src="https://latex.codecogs.com/png.latex?s"> 個の粒子が存在する状態 <img src="https://latex.codecogs.com/png.latex?%0A%5COmega_%7B%5CLambda,N%7D%5E%7B%5CLambda_0,s%7D:=%5Cleft%5C%7B(Q,V)%5Cin%5COmega_%7BV,N%7D%5Cmid%5Clvert%20Q%5Ccap%5CLambda_0%5Crvert=s%5Cright%5C%7D%0A"> を考え，この部分領域への小正準分布 <img src="https://latex.codecogs.com/png.latex?P%5E%7B%5Ctext%7Bmicrocanon%7D%7D_%7B%5CLambda,N,E%7D"> の制限を考えると，ある極限に関して正準分布になる <span class="citation" data-cites="Minlos2000">(Minlos, 2000)</span>．これがいわば <strong>熱浴</strong> や thermostat の概念である．</p>
<p>すなわち，ある領域 <img src="https://latex.codecogs.com/png.latex?%5CLambda_0"> に <img src="https://latex.codecogs.com/png.latex?s"> 個の粒子が存在する限り値が変わらないような量 <img src="https://latex.codecogs.com/png.latex?F:%5COmega_%7B%5CLambda,N%7D%5Cto%5Cmathbb%7BR%7D"> は，小正準平均も正準平均も「ほとんど」変わらないことになる．この極限の正確な意味は <img src="https://latex.codecogs.com/png.latex?%0A%5CLambda%5Cnearrow%5Cmathbb%7BR%7D%5Ev,N%5Cto%5Cinfty,%5Cfrac%7BN%7D%7B%5Clvert%5CLambda%5Crvert%7D%5Cto%5Crho%5Cin%5Cmathbb%7BR%7D,%5Cfrac%7BE_i%7D%7B%5Clvert%5CLambda_i%5Crvert%7D%5Cto%20e%5Cin%5Cmathbb%7BR%7D,%0A"> というものであり，これを <strong>熱力学極限</strong> という（第 6 節）．</p>
<blockquote class="blockquote">
<p>一般に極めて多数の自由度を持つ力学系 B と，問題の対象たる一つの力学系 A（上の例では <img src="https://latex.codecogs.com/png.latex?s"> 個の粒子からなる系）とが結合しているときに，系 A の一つの微視状態の実現確率を与える．これはそのような条件の下に，前節に述べた等重率の仮定に代わるものである． 物理的な言葉に引き直せば，結局，熱容量の大きい物体と熱平衡を保つ任意の力学系の統計的分布を表す集団がカノニカル集団である．<span class="citation" data-cites="久保亮五2003">(久保亮五, 2003, p. 30)</span></p>
</blockquote>
</section>
<section id="大正準集団" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="大正準集団"><span class="header-section-number">5</span> 大正準集団</h2>
<p>大正準集団は，領域 <img src="https://latex.codecogs.com/png.latex?%5CLambda%5Csubset%5Cmathbb%7BR%7D%5E3"> に粒子数 <img src="https://latex.codecogs.com/png.latex?N%5Cin%5Cmathbb%7BN%7D"> を定めずに存在する互いに区別できない粒子の系を考えることになる（エネルギーの交換だけでなく粒子も交換する部分系など）： <img src="https://latex.codecogs.com/png.latex?%0A%5COmega_%5CLambda=C_%5CLambda%5E%7B(0)%7D%5Ccup%20C_%5CLambda%5E%7B(1)%7D%5Ccup%5Ccdots%5Ccup%20C_%5Clambda%5E%7B(N)%7D%5Ccup%5Ccdots%0A"></p>
<p>この <img src="https://latex.codecogs.com/png.latex?%5COmega_%5CLambda"> 上に，各 <img src="https://latex.codecogs.com/png.latex?C_%5CLambda%5E%7B(N)%7D"> 上での Lebesgue 測度が誘導する測度 (Lebesgue-Poisson measure) <img src="https://latex.codecogs.com/png.latex?%0A%5Cmu_%5CLambda%5E%7B(N)%7D(A):=%5Cfrac%7B%5Cell_%7B3N%7D(A)%7D%7BN!%7D%0A"> の貼り合わせとして定義される測度を正規化したものを <img src="https://latex.codecogs.com/png.latex?%5Cmu"> とし，これを体積の代わりとする．</p>
<p>これを基底測度として密度 <img src="https://latex.codecogs.com/png.latex?%0Ap%5E%7B%5Ctext%7Bgrandcanon%7D%7D_%7B%5CLambda,%5Cbeta,%5Cmu%7D(c):=%5Cfrac%7B1%7D%7B%5CXi(%5CLambda,%5Cbeta,%5Cmu)%7De%5E%7B-%5Cbeta(H_%5CLambda(c)+%5Cmu%20N(c))%7D%0A"> が定める分布を <strong>大正準分布</strong> という．</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbeta%3E0"> は逆温度であるが，<img src="https://latex.codecogs.com/png.latex?%5Cmu%5Cin%5Cmathbb%7BR%7D"> は化学ポテンシャルである．</p>
<p>小正準集団が正準集団になる際に，エネルギー一定の制約は解放されて，代わりに新たなパラメータ <img src="https://latex.codecogs.com/png.latex?%5Cbeta%3E0"> を得た．ここからさらに粒子数一定の制約を解放し，代わりに新たなパラメータ <img src="https://latex.codecogs.com/png.latex?%5Cmu%5Cin%5Cmathbb%7BR%7D"> を得たものが大正準集団である．この順に解析が容易になる．</p>
<p>大正準分布を粒子数一定の条件で条件付けて得る <img src="https://latex.codecogs.com/png.latex?C_%5CLambda%5E%7B(N)%7D"> 上の分布は正準分布に一致する．</p>
</section>
<section id="sec-thermodynamic-limit" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="sec-thermodynamic-limit"><span class="header-section-number">6</span> 熱力学極限</h2>
<section id="極限-gibbs-測度" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="極限-gibbs-測度"><span class="header-section-number">6.1</span> 極限 Gibbs 測度</h3>
<p><img src="https://latex.codecogs.com/png.latex?F_B:%5COmega_%5CLambda%5Cto%5Cmathbb%7BR%7D"> が <strong>局所変数</strong> であるとは， <img src="https://latex.codecogs.com/png.latex?%0AF_B(c)=F_B(c%5Ccap%20B)%5Cquad(c%5Cin%5COmega_%5CLambda)%0A"> を満たすことをいう．</p>
<p>熱力学極限 <img src="https://latex.codecogs.com/png.latex?%0A%5Clim_%7B%5CLambda%5Cnearrow%5Cmathbb%7BR%7D%5E3%7D%5Clangle%20F_B%5Crangle_%7B%5CLambda,%5Cbeta,%5Cmu%7D=%5Clangle%20F_B%5Crangle_%7B%5Cinfty,%5Cbeta,%5Cmu%7D%0A"> は，ある空間上のある積分と捉えられる．これを <strong>極限 Gibbs 測度</strong> (limit Gibbs distribution) という．</p>
<p>この極限 Gibbs 測度が複数存在したり，良い性質が失われたりする現象を <strong>相転移</strong> といい，その際の <img src="https://latex.codecogs.com/png.latex?(%5Cbeta,%5Cmu)"> を特異点という．</p>
</section>
<section id="熱力学極限におけるアンサンブルの等価性" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="熱力学極限におけるアンサンブルの等価性"><span class="header-section-number">6.2</span> 熱力学極限におけるアンサンブルの等価性</h3>
<p>熱力学では，系の変化が極めて緩慢であるために，一瞬一瞬において平衡状態が保たれているとみなせる物理的過程が扱われるため，大正準集団では <img src="https://latex.codecogs.com/png.latex?T=%5Cbeta%5E%7B-1%7D,%5Cmu">，正準集団では <img src="https://latex.codecogs.com/png.latex?T,%5Crho">，小正準集団では <img src="https://latex.codecogs.com/png.latex?%5Crho,e"> などのマクロ変量によって記述できる理論になっている．</p>
<p>そして熱力学極限において，これら３集団は等価であるから，これらはパラメータ変換の問題でしかなく，さらにこのパラメータ空間上に別の関数も導入される．特にエントロピー <img src="https://latex.codecogs.com/png.latex?s(e,%5Crho)">，Helmholz の自由エネルギー（密度） <img src="https://latex.codecogs.com/png.latex?f(%5Cbeta,%5Crho)">，圧力 <img src="https://latex.codecogs.com/png.latex?p(%5Cbeta,%5Cmu)"> などであり，これらは互いに Legendre 変換により関係し合っている．</p>
<p>これらの熱力学的関数も，特定の統計力学的な量の熱力学極限として理解できる．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0As(%5Crho,e)=%5Clim_%7B%5Csubstack%7B%5CLambda%5Cnearrow%5Cmathbb%7BZ%7D%5Ev%5C%5C%5Cfrac%7BN%7D%7B%5Clvert%5CLambda%5Crvert%7D%5Cto%5Crho%5C%5C%5Cfrac%7BE%7D%7B%5CLambda%7D%5Cto%20e%7D%7D%5Cfrac%7B%5Clog%20Q%5E%7B%5Ctext%7Bindistin%7D%7D(%5CLambda,E,N)%7D%7B%5Clvert%5CLambda%5Crvert%7D%0A"> <img src="https://latex.codecogs.com/png.latex?%0Af(%5Cbeta,%5Crho)=-%5Cfrac%7B1%7D%7B%5Cbeta%7D%5Clim_%7B%5Csubstack%7B%5CLambda%5Cnearrow%5Cmathbb%7BZ%7D%5E3%5C%5C%5Cfrac%7BN%7D%7B%5Clvert%5CLambda%5Crvert%7D%5Cto%5Crho%7D%7D%5Cfrac%7B%5Clog%20Z%5E%7B%5Ctext%7Bindistin%7D%7D(%5CLambda,N,%5Cbeta)%7D%7B%5Clvert%5CLambda%5Crvert%7D%0A"> <img src="https://latex.codecogs.com/png.latex?%0Ap(%5Cbeta,%5Cmu)=%5Cfrac%7B1%7D%7B%5Cbeta%7D%5Clim_%7BN%5Cnearrow%5Cmathbb%7BZ%7D%5E3%7D%5Cfrac%7B%5Clog%5CXi(%5CLambda,%5Cmu,%5Cbeta)%7D%7B%5Clvert%5CLambda%5Crvert%7D%0A"></p>
<p>ただし，<img src="https://latex.codecogs.com/png.latex?Q%5E%7B%5Ctext%7Bindistin%7D%7D,Z%5E%7B%5Ctext%7Bindistin%7D%7D,%5CXi"> はそれぞれ，（粒子が互いに区別がつかない場合の）小正準集団，正準集団，大正準集団の正規化定数とした．</p>
</section>
<section id="相転移の定義" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="相転移の定義"><span class="header-section-number">6.3</span> 相転移の定義</h3>
<p>極限 Gibbs 測度に依らずとも，次のように直接的な方法で相転移を定義することができる：</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定義 (thermodynamic phase)^[[@Faulkner-Livingstone2024 p.4 2.3節] に倣った．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定義 (thermodynamic phase)<sup>6</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>相空間上の可測関数 <img src="https://latex.codecogs.com/png.latex?(%5Cbeta,%5Ctheta,N)%5Cmapsto%5Cchi(%5Cbeta,%5Ctheta,N)"> に対して，写像 <img src="https://latex.codecogs.com/png.latex?%0A(%5Cbeta,%5Ctheta)%5Cmapsto%5Clim_%7BN%5Cto%5Cinfty%7D%5Clangle%5Cchi(%5Cbeta,%5Ctheta,N)%5Crangle%0A"> の値域を <strong>熱力学的相空間</strong> という．</li>
<li><strong>熱力学的相</strong> とは，上述の関数が <img src="https://latex.codecogs.com/png.latex?(%5Cbeta,%5Ctheta)"> の解析的関数になるような領域をいう．</li>
<li>熱力学的相の境界を横断するダイナミクスを <strong>相転移</strong> という．</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="相転移と統計学^[[@Faulkner-Livingstone2024 pp.4-5] 2.4節も参照．]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
相転移と統計学<sup>7</sup>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>情報理論や統計学において，エントロピーは確率分布の不確実性として理解されている．</p>
<p>同様にして，熱力学的な相の変化は，エントロピーの急激な変化として検出されるわけである．</p>
<p>自由エネルギーは平均ポテンシャルとエントロピーの競争を表す量である．統計的には，周辺対数尤度として理解できる．</p>
<p>自由エネルギーが低い状態ほど現れやすい．このような見方はまさにベイズ因子によるモデル選択と同じ観点に立っていることになる．</p>
<p>また，自由エネルギーはキュムラント母関数でもあり，その微分係数は多くの統計学的な意味を持つ．</p>
<p>次の稿で紹介した I-MMSE 定理もその例である：</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Stat/Bayes1.html" target="_blank">
            <img src="https://162348.github.io/posts/2024/Stat/posterior.svg" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">ベイズ統計学と統計物理学</h3>
                <p class="article-description">スパース符号の復元を題材として</p>
            </div>
        </a>
    </div>
</div>
<p>次の式は状態方程式と呼ばれ，<span class="citation" data-cites="Metropolis+1953">(Metropolis et al., 1953)</span> はこれの推定のために Monte Carlo 法を開発したのであった： <img src="https://latex.codecogs.com/png.latex?%0A%5Clangle%20p(%5Cbeta,%5Ctheta,N)%5Crangle:=-%5Cpartial_VF(%5Cbeta,%5Ctheta(N,V),N).%0A"></p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Review/Metropolis+1953.html" target="_blank">
            <img src="https://162348.github.io/posts/2024/Review/Metropolis+1953.svg" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">Metropolis+ (1953) Equation of State Calculations by Fast Computing Machines</h3>
                <p class="article-description">Metropolis et. al. [The Journal of Chemical Physics 21(1953) 1087-1092] は初の MCMC（乱歩 Metropolis 法）を，対称分布を Gibbs の正準分布として，“modified Monte Carlo scheme” という名前の下で提案した論文である．重点サンプリングを “Monte Carlo method” と呼び，「目標分布から直接サンプルを生成できるために提案分布と目標分布とのズレによる性能劣化がない」ことを美点として挙げている．この手法は後の (Hastings, 1970) による改良と併せて，Metropolis-Hastings 法と呼ばれるようになる．</p>
            </div>
        </a>
    </div>
</div>
</div>
</div>
</div>
</section>
</section>



<div id="quarto-appendix" class="default"><section id="参考文献" class="level2 appendix" data-number="7"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">7</span> 参考文献</h2><div class="quarto-appendix-contents">

<p><span class="citation" data-cites="Minlos2000">(Minlos, 2000)</span>, <span class="citation" data-cites="西森秀稔2003">(西森秀稔, 2003)</span>, <span class="citation" data-cites="Baxter1982">(Baxter, 1982)</span> の書籍と，<span class="citation" data-cites="Faulkner-Livingstone2024">(Faulkner &amp; Livingstone, 2024)</span> のレビューを参考にした．</p>



</div></section><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-Baxter1982" class="csl-entry">
Baxter, R. J. (1982). <em>Exactly solved models in statistical mechanics</em>. Academic Press. <a href="https://physics.anu.edu.au/research/ftp/mpg/baxter_book.php">https://physics.anu.edu.au/research/ftp/mpg/baxter_book.php</a>
</div>
<div id="ref-Faulkner-Livingstone2024" class="csl-entry">
Faulkner, M. F., &amp; Livingstone, S. (2024). <span class="nocase">Sampling Algorithms in Statistical Physics: A Guide for Statistics and Machine Learning</span>. <em>Statistical Science</em>, <em>39</em>(1), 137–164. <a href="https://doi.org/10.1214/23-STS893">https://doi.org/10.1214/23-STS893</a>
</div>
<div id="ref-Khinchin1949" class="csl-entry">
Khinchin, A. (1949). <em><a href="">Mathematical foundations of statistical mechanics</a></em>. Courier Corporation.
</div>
<div id="ref-Metropolis+1953" class="csl-entry">
Metropolis, N., Rosenbluth, A. W., Rosenbluth, M. N., Teller, A. H., &amp; Teller, E. (1953). Equation of state calculations by fast computing machines. <em>The Journal of Chemical Physics</em>, <em>21</em>(6), 1087–1092. <a href="https://doi.org/10.1063/1.1699114">https://doi.org/10.1063/1.1699114</a>
</div>
<div id="ref-Minlos2000" class="csl-entry">
Minlos, R. A. (2000). <em>Introduction to mathematical statistical physics</em> (Vol. 19). American Mathematical Society. <a href="https://doi.org/10.1090/ulect/019">https://doi.org/10.1090/ulect/019</a>
</div>
<div id="ref-久保亮五2003" class="csl-entry">
久保亮五. (2003). <em>新装版統計力学</em>. 共立出版. <a href="https://www.kyoritsu-pub.co.jp/book/b10011230.html">https://www.kyoritsu-pub.co.jp/book/b10011230.html</a>
</div>
<div id="ref-戸田+2011" class="csl-entry">
戸田盛和, 斎藤信彦, 久保亮五, &amp; 橋爪夏樹. (2011). <em>統計物理学</em> (新装版, Vol. 5). 岩波書店. <a href="https://www.iwanami.co.jp/book/b259545.html">https://www.iwanami.co.jp/book/b259545.html</a>
</div>
<div id="ref-田崎晴明2008" class="csl-entry">
田崎晴明. (2008). <em>統計力学I</em> (Vol. 37). 培風館. <a href="https://www.gakushuin.ac.jp/~881791/statbook/">https://www.gakushuin.ac.jp/~881791/statbook/</a>
</div>
<div id="ref-砂田利一2004" class="csl-entry">
砂田利一. (2004). <em>数学から見た統計学と熱力学</em> (Vol. 4). 岩波書店. <a href="https://www.iwanami.co.jp/book/b476285.html">https://www.iwanami.co.jp/book/b476285.html</a>
</div>
<div id="ref-西森秀稔2003" class="csl-entry">
西森秀稔. (2003). <em>スピングラスと連想記憶</em>. 岩波書店. <a href="https://www.iwanami.co.jp/book/b476276.html">https://www.iwanami.co.jp/book/b476276.html</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>運動は相空間の自然な体積形式 (Liouville 形式ともいう) を不変に保つという Liouville の定理 <span class="citation" data-cites="Khinchin1949">(Khinchin, 1949)</span> は量子論でも成り立つ．<span class="citation" data-cites="戸田+2011">(戸田盛和 et al., 2011, p. 23)</span> これらの性質を抽象した形で，古典・量子力学は，統計力学に等重率の仮定を課す．↩︎</p></li>
<li id="fn2"><p>ただし，<img src="https://latex.codecogs.com/png.latex?%5COmega_%7B%5CLambda,N,E%7D"> 上に制限された体積測度に関しては，密度 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B%5Clvert%5Cmathop%7B%5Cmathrm%7B%5Cmathrm%7Bgrad%7D%7D%7DH%5Crvert%7D"> を持つ <span class="citation" data-cites="Khinchin1949">(Khinchin, 1949)</span>．↩︎</p></li>
<li id="fn3"><p>これを Liouville 形式だけでなく Liouville 測度ということもあるようである <span class="citation" data-cites="砂田利一2004">(砂田利一, 2004)</span>．↩︎</p></li>
<li id="fn4"><p>等重率の仮定は量子論の観点から「マクロな量子系では，ある平衡状態に対応する許容される量子状態の全てが区別できない」と説明されることも多い．いずれにしろ極めて非自明な主張であるが，これを認めてみると良い理論を得る．実際 <span class="citation" data-cites="田崎晴明2008">(田崎晴明, 2008, p. 89)</span> では等重率の仮定を「戦略」「等重率の原理に基づく確率モデル」と説明している．いわば，統計モデルの１つであり，モデル選択の観点に立っているのである．↩︎</p></li>
<li id="fn5"><p><img src="https://latex.codecogs.com/png.latex?S_t"> は体積を保存し Hamiltonian も保存するため，これは明らかに <img src="https://latex.codecogs.com/png.latex?S_t"> の不変確率分布である．↩︎</p></li>
<li id="fn6"><p><span class="citation" data-cites="Faulkner-Livingstone2024">(Faulkner &amp; Livingstone, 2024, pp. 4 2.3節)</span> に倣った．↩︎</p></li>
<li id="fn7"><p><span class="citation" data-cites="Faulkner-Livingstone2024">(Faulkner &amp; Livingstone, 2024, pp. 4–5)</span> 2.4節も参照．↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Nature</category>
  <guid>https://162348.github.io/posts/2024/Nature/StatisticalMechanics2.html</guid>
  <pubDate>Sat, 06 Apr 2024 15:00:00 GMT</pubDate>
  <media:content url="https://162348.github.io/posts/2024/Nature/canon.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>数学者のための統計力学１</title>
  <dc:creator>司馬博文 </dc:creator>
  <link>https://162348.github.io/posts/2024/Nature/StatisticalMechanics1.html</link>
  <description><![CDATA[ 





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<section id="導入" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="導入"><span class="header-section-number">1</span> 導入</h2>
<p>統計力学では多数の粒子系のマクロな性質の記述・予測を目指す．</p>
<p>そのモデルは大きく２つに大別される：<sup>1</sup></p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li>古典粒子系（第 2 節）：連続な位置と速度変数を持つ粒子系．主に <a href="https://ja.wikipedia.org/wiki/ソフトマター">ソフトマター</a> の解析で用いられる模型である．</li>
<li>格子模型（第 3 節）：位置は <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D%5Ed"> の部分集合に固定され，速度も持たないスピンの系．主に <a href="https://ja.wikipedia.org/wiki/物性物理学">ハードな凝縮系の解析</a> で用いられる．</li>
</ul>
</div>
</div>
</div>
</section>
<section id="sec-soft-matter" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="sec-soft-matter"><span class="header-section-number">2</span> 古典粒子系</h2>
<section id="導入-1" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="導入-1"><span class="header-section-number">2.1</span> 導入</h3>
<p>古典粒子を支配する物理法則は古典力学の枠組みで記述される．</p>
<p>しかし，その運動方程式を解析的に分析するのではなく，相空間 <img src="https://latex.codecogs.com/png.latex?%5COmega"> 上の（有界）測度に注目して，確率統計学，果てには計算統計学を利用して展開していく．</p>
<p>ちょうど，統計学では個々のサンプル <img src="https://latex.codecogs.com/png.latex?%5Comega%5Cin%5COmega"> よりも全体的な振る舞い <img src="https://latex.codecogs.com/png.latex?P%5Cin%5Cmathcal%7BP%7D(%5COmega)"> や統計量 <img src="https://latex.codecogs.com/png.latex?%5COmega%5Cto%5Cmathbb%7BR%7D"> の平均値や分散などの統計的な振る舞いに興味があるのと同じことである．</p>
</section>
<section id="相空間-omega_lambdan" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="相空間-omega_lambdan"><span class="header-section-number">2.2</span> 相空間 <img src="https://latex.codecogs.com/png.latex?%5COmega_%7B%5CLambda,N%7D"></h3>
<p>有界集合 <img src="https://latex.codecogs.com/png.latex?%5CLambda%5Csubset%5Cmathbb%7BR%7D%5E3"> に囚われた古典的な <img src="https://latex.codecogs.com/png.latex?N"> 粒子系を考えると，位置と速度によって各粒子は記述できるから， <img src="https://latex.codecogs.com/png.latex?%0A%5COmega_%7B%5CLambda,N%7D:=(%5CLambda%5Ctimes%5Cmathbb%7BR%7D%5E3)%5EN%0A"> 内の点によって系が記述できる．これを <strong>相空間</strong> (phase space) という．<sup>2</sup></p>
<p>また，系が周期的な境界条件を満たす場合など，相空間として <img src="https://latex.codecogs.com/png.latex?d">-次元トーラス <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BT%7D%5Ed"> 上の余接束を考えた方がより良い模型となる場合も多い．<sup>3</sup></p>
</section>
<section id="ハミルトニアン-h_lambdan" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="ハミルトニアン-h_lambdan"><span class="header-section-number">2.3</span> ハミルトニアン <img src="https://latex.codecogs.com/png.latex?H_%7B%5CLambda,N%7D"></h3>
<p>古典粒子系では，相空間上の <strong>ハミルトニアン</strong> の形で力学が与えられることが典型的である：<sup>4</sup> <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%20%20%20%20H_%7B%5CLambda,N%7D(Q,V)&amp;=%5Csum_%7Bi=1%7D%5EN%5Cfrac%7Bmv_i%5E2%7D%7B2%7D+%5Csum_%7Bi%3Cj%5Cin%5BN%5D%7DU(q_i-q_j)%5C%5C%0A%20%20%20%20&amp;%5Cqquad%5Cqquad+%5Csum_%7Bi=1%7D%5ENV_b(q_i)%0A%5Cend%7Balign*%7D%0A"> <img src="https://latex.codecogs.com/png.latex?%0AQ=(q_1,%5Ccdots,q_N)%5Cin%5CLambda%5E%7B3N%7D%0A"></p>
<p>多くの場合，ポテンシャル関数 <img src="https://latex.codecogs.com/png.latex?U"> はコンパクト台を持つ，すなわち，<strong>相互作用半径</strong> (radius of interaction) <img src="https://latex.codecogs.com/png.latex?R"> をもつとする：<img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7Bsupp%7D%5C;U%5Csubset%20U_R(0)">．<sup>5</sup></p>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="ポテンシャルの例（Lennard-Jones ポテンシャル）">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
ポテンシャルの例（Lennard-Jones ポテンシャル）
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>経験則的に，分子系は Lennard-Jones ポテンシャル（第 2.8.1 節） <img src="https://latex.codecogs.com/png.latex?%0AU(r)=%5Cfrac%7BA%7D%7Br%5E%7B12%7D%7D-%5Cfrac%7BB%7D%7Br%5E6%7D%5Cquad%20A,B%3E0%0A"> を用いてモデリングする場合が多い．</p>
<p>次の論文 <span class="citation" data-cites="Peters-deWith2012">(Peters &amp; de&nbsp;With, 2012)</span> では，この Lennard-Jones ポテンシャルを用いた分子動力学法を考察している：</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Review/Peters-deWith2012.html" target="_blank">
            <img src="https://162348.github.io/posts/2024/Review/Peters-deWith2012.svg" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">Peters and de With (2012) Rejection-Free Monte Carlo Sampling for General Potentials</h3>
                <p class="article-description">Peters and de With [Phys. E 85(2012) 026703] は Metropolis 法による棄却-採択の代わりに，衝突により方向を変える粒子を想定することで，効率的な Monte Carlo 法を実行することを目指した．ただの event-driven な molecular dynamics と違い，一般の滑らかなポテンシャルに適用可能である点が革新的である．しかし，粒子系のポテンシャルは常に和の形で表されるように，一般の PDMP に基づいた連続時間 MCMC 手法も，適用可能なモデルの範囲が限定されている点が難点である (Nemeth &amp; Fearnhead, 2021)．</p>
            </div>
        </a>
    </div>
</div>
</div>
</div>
</div>
</section>
<section id="ダイナミクス-s_t" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="ダイナミクス-s_t"><span class="header-section-number">2.4</span> ダイナミクス <img src="https://latex.codecogs.com/png.latex?%5C%7BS_t%5C%7D"></h3>
<p>系の時間発展は変換の1-径数群 <img src="https://latex.codecogs.com/png.latex?%5C%7BS_t%5C%7D%5Csubset%5Cmathrm%7BAut%7D(%5COmega_%7B%5CLambda,N%7D)"> （<strong>動力学</strong> dynamics という）によって記述される．</p>
<p>この動力学は Hamiltonian を通じた運動方程式から導出される． <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7Bd%20q_i%7D%7Bd%20t%7D=v_i%0A"> <img src="https://latex.codecogs.com/png.latex?%0Am%5Cfrac%7Bd%20v_i%7D%7Bd%20t%7D=-%5Csum_%7Bi%5Cne%20j%7D%5Cnabla%20U(q_j-q_i)-%5Cnabla%20V_b(q_i)%0A"></p>
</section>
<section id="sec-microcanonical" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="sec-microcanonical"><span class="header-section-number">2.5</span> 部分多様体 <img src="https://latex.codecogs.com/png.latex?%5COmega_%7B%5CLambda,N,E%7D"> と小正準分布</h3>
<p>この動力学 <img src="https://latex.codecogs.com/png.latex?%5C%7BS_t%5C%7D"> は体積とエネルギーを保存量にもつ．すなわち，各 <img src="https://latex.codecogs.com/png.latex?S_t"> は保測的で，等エネルギー集合 <img src="https://latex.codecogs.com/png.latex?%0A%5COmega_%7B%5CLambda,N,E%7D:=%5Cleft%5C%7B(Q,%5CLambda)%5Cin%5COmega_%7B%5CLambda,N%7D%5Cmid%20H_%7B%5CLambda,N%7D(Q,%5CLambda)=E%5Cright%5C%7D%0A"> を不変部分集合にもつ．</p>
<p><img src="https://latex.codecogs.com/png.latex?%5COmega_%7B%5CLambda,N,E%7D"> 上の測度 <img src="https://latex.codecogs.com/png.latex?%0A%5Cnu_%7B%5CLambda,N,E%7D(B):=%5Clim_%7B%5CDelta%20E%5Cto0%7D%5Cfrac%7B%5Cell(%5CDelta%20B)%7D%7B%5CDelta%20E%7D%0A"> は <img src="https://latex.codecogs.com/png.latex?S_t"> によって保存される．<sup>6</sup> これを <strong>小正準分布</strong> (microcanonical measures) または Gelfand-Leray measures という．<sup>7</sup></p>
<p>ただし，<img src="https://latex.codecogs.com/png.latex?%5CDelta%20B"> は <img src="https://latex.codecogs.com/png.latex?x%5Cin%20B"> から始まった <img src="https://latex.codecogs.com/png.latex?%5COmega_%7B%5CLambda,N,E%7D"> の法線（面）で，<img src="https://latex.codecogs.com/png.latex?%5COmega_%7B%5CLambda,N,E+%5CDelta%20E%7D"> との交点で終わる線分の <img src="https://latex.codecogs.com/png.latex?x%5Cin%20B"> に関する合併である．</p>
</section>
<section id="エルゴード仮説" class="level3" data-number="2.6">
<h3 data-number="2.6" class="anchored" data-anchor-id="エルゴード仮説"><span class="header-section-number">2.6</span> エルゴード仮説</h3>
<p>エネルギー以外にも，等位集合が <img src="https://latex.codecogs.com/png.latex?S_t"> によって保存される相空間上の関数 <img src="https://latex.codecogs.com/png.latex?I_i:%5COmega_%7B%5CLambda,N%7D%5Cto%5Cmathbb%7BR%7D"> は存在し得て，その場合は全ての合併 <img src="https://latex.codecogs.com/png.latex?%5COmega_%7B%5CLambda,N,E,I_1,%5Ccdots,I_k%7D"> 上にも小正準分布が遺伝することになる．</p>
<p>しかし，他の積分 <img src="https://latex.codecogs.com/png.latex?I_i"> が存在しない場合，<img src="https://latex.codecogs.com/png.latex?%5COmega_%7B%5CLambda,N,E%7D"> 上の <img src="https://latex.codecogs.com/png.latex?S_t">-不変で <img src="https://latex.codecogs.com/png.latex?%5Cnu_%7B%5CLambda,N,E%7D">-絶対連続な測度は，<img src="https://latex.codecogs.com/png.latex?%5Cnu_%7B%5CLambda,N,E%7D"> の定数倍に限る．これを Boltzman のエルゴード仮説という．</p>
<p>この仮説により，特定の系が運動 <img src="https://latex.codecogs.com/png.latex?S_t"> によって平衡状態に至った際，相空間上を旅する際に特定の状態が現れる頻度分布は，必ず小正準分布に一致することが帰結される．</p>
</section>
<section id="円板模型" class="level3" data-number="2.7">
<h3 data-number="2.7" class="anchored" data-anchor-id="円板模型"><span class="header-section-number">2.7</span> 円板模型</h3>
<p>３次元ではなく，２次元で考えた古典粒子形を，<strong>円板モデル</strong> (disk model) という．</p>
<section id="剛体円板模型" class="level4" data-number="2.7.1">
<h4 data-number="2.7.1" class="anchored" data-anchor-id="剛体円板模型"><span class="header-section-number">2.7.1</span> 剛体円板模型</h4>
<p><strong>剛体円板模型</strong> (hard-disk model) では，粒子の半径 <img src="https://latex.codecogs.com/png.latex?%5Csigma%3E0"> が定める密度 <img src="https://latex.codecogs.com/png.latex?%0A%5Ceta:=%5Cfrac%7BN%5Cpi%5Csigma%5E2%7D%7BL%5E2%7D%0A"> ハイパーパラメータとし，粒子同士が重なっていない任意の配置は全て一様に現れるとする模型である．<sup>8</sup></p>
<p>この模型ですでに相転移 (melting transition) が起こることが知られている．<sup>9</sup></p>
</section>
<section id="液相転移" class="level4" data-number="2.7.2">
<h4 data-number="2.7.2" class="anchored" data-anchor-id="液相転移"><span class="header-section-number">2.7.2</span> 液相転移</h4>
<p>しかし，液相転移（特に fluid-hexatic 相転移）の完全な熱力学的性質の解明は，<span class="citation" data-cites="Metropolis+1953">(Metropolis et al., 1953)</span> の時点から数値実験によるアプローチが試みられていたが，<span class="citation" data-cites="Bernard-Krauth2011">(Bernard &amp; Krauth, 2011)</span> の event chain Monte Carlo 法によるシミュレーションを通じた研究まで待つ必要があった．</p>
<p><span class="citation" data-cites="Bernard-Krauth2011">(Bernard &amp; Krauth, 2011)</span> は液相転移における種々の物理量（位置相関関数，方向相関関数など）の平均を記述する理論も提示した．<sup>10</sup></p>
<p>これは <span class="citation" data-cites="Engel+2013">(Engel et al., 2013)</span> の分子動力学と大規模並行 Metropolis 計算により補強され，最終的にコロイドを用いた実験で確証された <span class="citation" data-cites="Thorneywork2017">(Thorneywork et al., 2017)</span>．</p>
<p>この剛体円板模型における相転移を基本として，種々のより複雑なソフトマター（フィルム，懸濁液など）の液相転移の研究に応用が進んでいる．</p>
</section>
<section id="sec-soft-disk" class="level4" data-number="2.7.3">
<h4 data-number="2.7.3" class="anchored" data-anchor-id="sec-soft-disk"><span class="header-section-number">2.7.3</span> 柔らかい円板模型</h4>
<p>次のポテンシャル <img src="https://latex.codecogs.com/png.latex?U"> を持った粒子系を <strong>柔らかい円板模型</strong> (soft-disk model) という： <img src="https://latex.codecogs.com/png.latex?%0AU(x;k,%5Ceta,%5Cepsilon,N):=%5Csum_%7Bi%3Cj%7DU'(x_i,x_j;k,%5Ceta,%5Cepsilon),%0A"> <img src="https://latex.codecogs.com/png.latex?%0AU'(x_i,x_j;k,%5Ceta,%5Cepsilon):=%5Cepsilon%5Cleft(%5Cfrac%7B2%5Csigma%7D%7Bd(x_i,x_j)%7D%5Cright)%5Ek.%0A"></p>
<p>剛体円板模型は <img src="https://latex.codecogs.com/png.latex?k%5Cto%5Cinfty"> の極限を取ったものと理解できる．</p>
</section>
<section id="混合模型" class="level4" data-number="2.7.4">
<h4 data-number="2.7.4" class="anchored" data-anchor-id="混合模型"><span class="header-section-number">2.7.4</span> 混合模型</h4>
<p>上述の模型はそれぞれ単独で興味の対称であるが，実際の粒子系をモデリングする際は，適切な重みを持って足し合わせることで，より当てはまりのよい模型を作る際の１成分として用いることも多い．<sup>11</sup></p>
</section>
</section>
<section id="剛球模型" class="level3" data-number="2.8">
<h3 data-number="2.8" class="anchored" data-anchor-id="剛球模型"><span class="header-section-number">2.8</span> 剛球模型</h3>
<section id="sec-Lennard-Jones" class="level4" data-number="2.8.1">
<h4 data-number="2.8.1" class="anchored" data-anchor-id="sec-Lennard-Jones"><span class="header-section-number">2.8.1</span> Lennard-Jones 模型</h4>
<p>次で定まるポテンシャルを持つ，<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BT%7D%5E3"> 上の模型を <strong>Lennard-Jones 模型</strong> という： <img src="https://latex.codecogs.com/png.latex?%0AU(x;%5Ceta,%5Csigma,%5Cepsilon,N):=%5Csum_%7Bi%3Cj%7DU'(x_i,x_j;%5Csigma,%5Cepsilon),%0A"> <img src="https://latex.codecogs.com/png.latex?%0AU'(x_i,x_j;%5Csigma,%5Cepsilon):=4%5Cepsilon%5Cleft(%5Cleft(%5Cfrac%7B%5Csigma%7D%7Bd(x_i,x_j)%7D%5Cright)%5E%7B12%7D-%5Cleft(%5Cfrac%7B%5Csigma%7D%7Bd(x_i,x_j)%7D%5Cright)%5E6%5Cright).%0A"></p>
<div id="a4be1ae5" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">using</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Plots</span></span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lennard_jones</span>(r, σ, ε)</span>
<span id="cb1-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> ε <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> ((σ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> r)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (σ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> r)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span>
<span id="cb1-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb1-6"></span>
<span id="cb1-7">ε <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># スケーリング</span></span>
<span id="cb1-8">σ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 粒子の半径</span></span>
<span id="cb1-9"></span>
<span id="cb1-10">r_range <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span></span>
<span id="cb1-11"></span>
<span id="cb1-12">V <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lennard_jones</span>(r, σ, ε) for r <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> r_range]</span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># プロットを作成</span></span>
<span id="cb1-15">plt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(r_range, V, </span>
<span id="cb1-16">    xlabel<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"r/σ"</span>, ylabel<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"V(r)/ε"</span>, </span>
<span id="cb1-17">    title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Lennard-Jones Potential"</span>,</span>
<span id="cb1-18">    label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LJ Potential"</span>,</span>
<span id="cb1-19">    lw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb1-20">    legend<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=:</span>topright,</span>
<span id="cb1-21">    ylims<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb1-22">    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#80c4ac"</span>)</span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># x軸とy軸に0の線を追加</span></span>
<span id="cb1-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hline!</span>([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=:</span>black, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=:</span>dash, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb1-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># vline!([0], color=:black, linestyle=:dash, label="")</span></span>
<span id="cb1-27"></span>
<span id="cb1-28"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">display</span>(plt)</span>
<span id="cb1-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># savefig(plt, "Lennard-Jones.svg")</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="576" height="384" viewbox="0 0 2304 1536">
<defs>
  <clippath id="clip900">
    <rect x="0" y="0" width="2304" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip900)" d="M0 1536 L2304 1536 L2304 8.52651e-14 L0 8.52651e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip901">
    <rect x="460" y="0" width="1614" height="1536"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip900)" d="M256.244 1359.82 L2256.76 1359.82 L2256.76 123.472 L256.244 123.472  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip902">
    <rect x="256" y="123" width="2002" height="1237"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="484.433,1359.82 484.433,123.472 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="913.359,1359.82 913.359,123.472 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1342.29,1359.82 1342.29,123.472 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1771.21,1359.82 1771.21,123.472 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2200.14,1359.82 2200.14,123.472 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="256.244,1359.82 2256.76,1359.82 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="484.433,1359.82 484.433,1340.92 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="913.359,1359.82 913.359,1340.92 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1342.29,1359.82 1342.29,1340.92 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1771.21,1359.82 1771.21,1340.92 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2200.14,1359.82 2200.14,1340.92 "></polyline>
<path clip-path="url(#clip900)" d="M451.586 1417.52 L459.225 1417.52 L459.225 1391.15 L450.914 1392.82 L450.914 1388.56 L459.178 1386.89 L463.854 1386.89 L463.854 1417.52 L471.493 1417.52 L471.493 1421.45 L451.586 1421.45 L451.586 1417.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M480.937 1415.57 L485.822 1415.57 L485.822 1421.45 L480.937 1421.45 L480.937 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M506.007 1389.97 Q502.396 1389.97 500.567 1393.54 Q498.761 1397.08 498.761 1404.21 Q498.761 1411.31 500.567 1414.88 Q502.396 1418.42 506.007 1418.42 Q509.641 1418.42 511.447 1414.88 Q513.275 1411.31 513.275 1404.21 Q513.275 1397.08 511.447 1393.54 Q509.641 1389.97 506.007 1389.97 M506.007 1386.27 Q511.817 1386.27 514.872 1390.87 Q517.951 1395.46 517.951 1404.21 Q517.951 1412.93 514.872 1417.54 Q511.817 1422.12 506.007 1422.12 Q500.197 1422.12 497.118 1417.54 Q494.062 1412.93 494.062 1404.21 Q494.062 1395.46 497.118 1390.87 Q500.197 1386.27 506.007 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M881.01 1417.52 L888.648 1417.52 L888.648 1391.15 L880.338 1392.82 L880.338 1388.56 L888.602 1386.89 L893.278 1386.89 L893.278 1417.52 L900.917 1417.52 L900.917 1421.45 L881.01 1421.45 L881.01 1417.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M910.361 1415.57 L915.246 1415.57 L915.246 1421.45 L910.361 1421.45 L910.361 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M925.477 1386.89 L943.833 1386.89 L943.833 1390.83 L929.759 1390.83 L929.759 1399.3 Q930.778 1398.95 931.796 1398.79 Q932.815 1398.6 933.833 1398.6 Q939.62 1398.6 943 1401.78 Q946.38 1404.95 946.38 1410.36 Q946.38 1415.94 942.907 1419.04 Q939.435 1422.12 933.116 1422.12 Q930.94 1422.12 928.671 1421.75 Q926.426 1421.38 924.019 1420.64 L924.019 1415.94 Q926.102 1417.08 928.324 1417.63 Q930.546 1418.19 933.023 1418.19 Q937.028 1418.19 939.366 1416.08 Q941.704 1413.98 941.704 1410.36 Q941.704 1406.75 939.366 1404.65 Q937.028 1402.54 933.023 1402.54 Q931.148 1402.54 929.273 1402.96 Q927.421 1403.37 925.477 1404.25 L925.477 1386.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1313.52 1417.52 L1329.84 1417.52 L1329.84 1421.45 L1307.9 1421.45 L1307.9 1417.52 Q1310.56 1414.76 1315.14 1410.13 Q1319.75 1405.48 1320.93 1404.14 Q1323.18 1401.61 1324.06 1399.88 Q1324.96 1398.12 1324.96 1396.43 Q1324.96 1393.67 1323.01 1391.94 Q1321.09 1390.2 1317.99 1390.2 Q1315.79 1390.2 1313.34 1390.97 Q1310.91 1391.73 1308.13 1393.28 L1308.13 1388.56 Q1310.95 1387.42 1313.41 1386.85 Q1315.86 1386.27 1317.9 1386.27 Q1323.27 1386.27 1326.46 1388.95 Q1329.66 1391.64 1329.66 1396.13 Q1329.66 1398.26 1328.85 1400.18 Q1328.06 1402.08 1325.95 1404.67 Q1325.38 1405.34 1322.27 1408.56 Q1319.17 1411.75 1313.52 1417.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1339.66 1415.57 L1344.54 1415.57 L1344.54 1421.45 L1339.66 1421.45 L1339.66 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1364.73 1389.97 Q1361.12 1389.97 1359.29 1393.54 Q1357.48 1397.08 1357.48 1404.21 Q1357.48 1411.31 1359.29 1414.88 Q1361.12 1418.42 1364.73 1418.42 Q1368.36 1418.42 1370.17 1414.88 Q1372 1411.31 1372 1404.21 Q1372 1397.08 1370.17 1393.54 Q1368.36 1389.97 1364.73 1389.97 M1364.73 1386.27 Q1370.54 1386.27 1373.59 1390.87 Q1376.67 1395.46 1376.67 1404.21 Q1376.67 1412.93 1373.59 1417.54 Q1370.54 1422.12 1364.73 1422.12 Q1358.92 1422.12 1355.84 1417.54 Q1352.78 1412.93 1352.78 1404.21 Q1352.78 1395.46 1355.84 1390.87 Q1358.92 1386.27 1364.73 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1742.95 1417.52 L1759.27 1417.52 L1759.27 1421.45 L1737.32 1421.45 L1737.32 1417.52 Q1739.98 1414.76 1744.57 1410.13 Q1749.17 1405.48 1750.36 1404.14 Q1752.6 1401.61 1753.48 1399.88 Q1754.38 1398.12 1754.38 1396.43 Q1754.38 1393.67 1752.44 1391.94 Q1750.52 1390.2 1747.42 1390.2 Q1745.22 1390.2 1742.76 1390.97 Q1740.33 1391.73 1737.55 1393.28 L1737.55 1388.56 Q1740.38 1387.42 1742.83 1386.85 Q1745.29 1386.27 1747.32 1386.27 Q1752.69 1386.27 1755.89 1388.95 Q1759.08 1391.64 1759.08 1396.13 Q1759.08 1398.26 1758.27 1400.18 Q1757.48 1402.08 1755.38 1404.67 Q1754.8 1405.34 1751.7 1408.56 Q1748.6 1411.75 1742.95 1417.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1769.08 1415.57 L1773.97 1415.57 L1773.97 1421.45 L1769.08 1421.45 L1769.08 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1784.2 1386.89 L1802.55 1386.89 L1802.55 1390.83 L1788.48 1390.83 L1788.48 1399.3 Q1789.5 1398.95 1790.52 1398.79 Q1791.54 1398.6 1792.55 1398.6 Q1798.34 1398.6 1801.72 1401.78 Q1805.1 1404.95 1805.1 1410.36 Q1805.1 1415.94 1801.63 1419.04 Q1798.16 1422.12 1791.84 1422.12 Q1789.66 1422.12 1787.39 1421.75 Q1785.15 1421.38 1782.74 1420.64 L1782.74 1415.94 Q1784.82 1417.08 1787.04 1417.63 Q1789.27 1418.19 1791.74 1418.19 Q1795.75 1418.19 1798.09 1416.08 Q1800.42 1413.98 1800.42 1410.36 Q1800.42 1406.75 1798.09 1404.65 Q1795.75 1402.54 1791.74 1402.54 Q1789.87 1402.54 1787.99 1402.96 Q1786.14 1403.37 1784.2 1404.25 L1784.2 1386.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M2181.45 1402.82 Q2184.8 1403.54 2186.68 1405.8 Q2188.58 1408.07 2188.58 1411.41 Q2188.58 1416.52 2185.06 1419.32 Q2181.54 1422.12 2175.06 1422.12 Q2172.88 1422.12 2170.57 1421.68 Q2168.27 1421.27 2165.82 1420.41 L2165.82 1415.9 Q2167.77 1417.03 2170.08 1417.61 Q2172.39 1418.19 2174.92 1418.19 Q2179.32 1418.19 2181.61 1416.45 Q2183.92 1414.72 2183.92 1411.41 Q2183.92 1408.35 2181.77 1406.64 Q2179.64 1404.9 2175.82 1404.9 L2171.79 1404.9 L2171.79 1401.06 L2176.01 1401.06 Q2179.45 1401.06 2181.28 1399.69 Q2183.11 1398.3 2183.11 1395.71 Q2183.11 1393.05 2181.21 1391.64 Q2179.34 1390.2 2175.82 1390.2 Q2173.9 1390.2 2171.7 1390.62 Q2169.5 1391.04 2166.86 1391.91 L2166.86 1387.75 Q2169.52 1387.01 2171.84 1386.64 Q2174.18 1386.27 2176.24 1386.27 Q2181.56 1386.27 2184.66 1388.7 Q2187.77 1391.1 2187.77 1395.23 Q2187.77 1398.1 2186.12 1400.09 Q2184.48 1402.05 2181.45 1402.82 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M2197.44 1415.57 L2202.33 1415.57 L2202.33 1421.45 L2197.44 1421.45 L2197.44 1415.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M2222.51 1389.97 Q2218.9 1389.97 2217.07 1393.54 Q2215.26 1397.08 2215.26 1404.21 Q2215.26 1411.31 2217.07 1414.88 Q2218.9 1418.42 2222.51 1418.42 Q2226.14 1418.42 2227.95 1414.88 Q2229.78 1411.31 2229.78 1404.21 Q2229.78 1397.08 2227.95 1393.54 Q2226.14 1389.97 2222.51 1389.97 M2222.51 1386.27 Q2228.32 1386.27 2231.38 1390.87 Q2234.45 1395.46 2234.45 1404.21 Q2234.45 1412.93 2231.38 1417.54 Q2228.32 1422.12 2222.51 1422.12 Q2216.7 1422.12 2213.62 1417.54 Q2210.57 1412.93 2210.57 1404.21 Q2210.57 1395.46 2213.62 1390.87 Q2216.7 1386.27 2222.51 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1236.26 1473.07 Q1235.27 1472.5 1234.09 1472.24 Q1232.95 1471.96 1231.55 1471.96 Q1226.58 1471.96 1223.91 1475.2 Q1221.27 1478.42 1221.27 1484.47 L1221.27 1503.24 L1215.38 1503.24 L1215.38 1467.6 L1221.27 1467.6 L1221.27 1473.13 Q1223.11 1469.89 1226.07 1468.33 Q1229.03 1466.74 1233.27 1466.74 Q1233.87 1466.74 1234.6 1466.83 Q1235.33 1466.9 1236.23 1467.05 L1236.26 1473.07 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1252.81 1455.72 L1258.22 1455.72 L1241.67 1509.29 L1236.26 1509.29 L1252.81 1455.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1278.18 1472.24 Q1273.34 1472.24 1270.73 1475.74 Q1267.99 1479.4 1267.99 1485.45 Q1267.99 1491.85 1270.7 1495.54 Q1273.43 1499.2 1278.18 1499.2 Q1282.85 1499.2 1285.59 1495.51 Q1288.33 1491.82 1288.33 1485.45 Q1288.33 1479.63 1285.59 1475.74 Q1283.08 1472.24 1278.18 1472.24 M1278.18 1467.6 L1297.62 1467.6 L1297.62 1473.45 L1291.07 1473.45 Q1294.54 1478.42 1294.54 1485.45 Q1294.54 1494.2 1290.17 1499.17 Q1285.81 1504.17 1278.18 1504.17 Q1270.5 1504.17 1266.18 1499.17 Q1261.82 1494.2 1261.82 1485.45 Q1261.82 1476.64 1266.18 1471.7 Q1269.77 1467.6 1278.18 1467.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="256.244,1247.42 2256.76,1247.42 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="256.244,966.436 2256.76,966.436 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="256.244,685.448 2256.76,685.448 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="256.244,404.46 2256.76,404.46 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="256.244,123.472 2256.76,123.472 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="256.244,1359.82 256.244,123.472 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="256.244,1247.42 275.142,1247.42 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="256.244,966.436 275.142,966.436 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="256.244,685.448 275.142,685.448 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="256.244,404.46 275.142,404.46 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="256.244,123.472 275.142,123.472 "></polyline>
<path clip-path="url(#clip900)" d="M114.74 1247.88 L144.416 1247.88 L144.416 1251.81 L114.74 1251.81 L114.74 1247.88 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M155.319 1260.77 L162.957 1260.77 L162.957 1234.4 L154.647 1236.07 L154.647 1231.81 L162.911 1230.14 L167.587 1230.14 L167.587 1260.77 L175.226 1260.77 L175.226 1264.7 L155.319 1264.7 L155.319 1260.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M184.67 1258.82 L189.555 1258.82 L189.555 1264.7 L184.67 1264.7 L184.67 1258.82 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M209.74 1233.22 Q206.129 1233.22 204.3 1236.79 Q202.494 1240.33 202.494 1247.46 Q202.494 1254.57 204.3 1258.13 Q206.129 1261.67 209.74 1261.67 Q213.374 1261.67 215.179 1258.13 Q217.008 1254.57 217.008 1247.46 Q217.008 1240.33 215.179 1236.79 Q213.374 1233.22 209.74 1233.22 M209.74 1229.52 Q215.55 1229.52 218.605 1234.13 Q221.684 1238.71 221.684 1247.46 Q221.684 1256.19 218.605 1260.79 Q215.55 1265.38 209.74 1265.38 Q203.929 1265.38 200.851 1260.79 Q197.795 1256.19 197.795 1247.46 Q197.795 1238.71 200.851 1234.13 Q203.929 1229.52 209.74 1229.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M115.736 966.888 L145.411 966.888 L145.411 970.823 L115.736 970.823 L115.736 966.888 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M165.504 952.235 Q161.893 952.235 160.064 955.8 Q158.258 959.342 158.258 966.471 Q158.258 973.578 160.064 977.142 Q161.893 980.684 165.504 980.684 Q169.138 980.684 170.944 977.142 Q172.772 973.578 172.772 966.471 Q172.772 959.342 170.944 955.8 Q169.138 952.235 165.504 952.235 M165.504 948.531 Q171.314 948.531 174.369 953.138 Q177.448 957.721 177.448 966.471 Q177.448 975.198 174.369 979.804 Q171.314 984.388 165.504 984.388 Q159.694 984.388 156.615 979.804 Q153.559 975.198 153.559 966.471 Q153.559 957.721 156.615 953.138 Q159.694 948.531 165.504 948.531 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M185.666 977.837 L190.55 977.837 L190.55 983.716 L185.666 983.716 L185.666 977.837 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M200.781 949.156 L219.138 949.156 L219.138 953.092 L205.064 953.092 L205.064 961.564 Q206.082 961.217 207.101 961.055 Q208.119 960.869 209.138 960.869 Q214.925 960.869 218.304 964.041 Q221.684 967.212 221.684 972.629 Q221.684 978.207 218.212 981.309 Q214.74 984.388 208.42 984.388 Q206.244 984.388 203.976 984.017 Q201.73 983.647 199.323 982.906 L199.323 978.207 Q201.406 979.342 203.629 979.897 Q205.851 980.453 208.328 980.453 Q212.332 980.453 214.67 978.346 Q217.008 976.24 217.008 972.629 Q217.008 969.017 214.67 966.911 Q212.332 964.805 208.328 964.805 Q206.453 964.805 204.578 965.221 Q202.726 965.638 200.781 966.517 L200.781 949.156 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M164.508 671.247 Q160.897 671.247 159.069 674.812 Q157.263 678.353 157.263 685.483 Q157.263 692.59 159.069 696.154 Q160.897 699.696 164.508 699.696 Q168.143 699.696 169.948 696.154 Q171.777 692.59 171.777 685.483 Q171.777 678.353 169.948 674.812 Q168.143 671.247 164.508 671.247 M164.508 667.543 Q170.319 667.543 173.374 672.15 Q176.453 676.733 176.453 685.483 Q176.453 694.21 173.374 698.816 Q170.319 703.4 164.508 703.4 Q158.698 703.4 155.62 698.816 Q152.564 694.21 152.564 685.483 Q152.564 676.733 155.62 672.15 Q158.698 667.543 164.508 667.543 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M184.67 696.849 L189.555 696.849 L189.555 702.728 L184.67 702.728 L184.67 696.849 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M209.74 671.247 Q206.129 671.247 204.3 674.812 Q202.494 678.353 202.494 685.483 Q202.494 692.59 204.3 696.154 Q206.129 699.696 209.74 699.696 Q213.374 699.696 215.179 696.154 Q217.008 692.59 217.008 685.483 Q217.008 678.353 215.179 674.812 Q213.374 671.247 209.74 671.247 M209.74 667.543 Q215.55 667.543 218.605 672.15 Q221.684 676.733 221.684 685.483 Q221.684 694.21 218.605 698.816 Q215.55 703.4 209.74 703.4 Q203.929 703.4 200.851 698.816 Q197.795 694.21 197.795 685.483 Q197.795 676.733 200.851 672.15 Q203.929 667.543 209.74 667.543 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M165.504 390.259 Q161.893 390.259 160.064 393.824 Q158.258 397.365 158.258 404.495 Q158.258 411.601 160.064 415.166 Q161.893 418.708 165.504 418.708 Q169.138 418.708 170.944 415.166 Q172.772 411.601 172.772 404.495 Q172.772 397.365 170.944 393.824 Q169.138 390.259 165.504 390.259 M165.504 386.555 Q171.314 386.555 174.369 391.162 Q177.448 395.745 177.448 404.495 Q177.448 413.222 174.369 417.828 Q171.314 422.412 165.504 422.412 Q159.694 422.412 156.615 417.828 Q153.559 413.222 153.559 404.495 Q153.559 395.745 156.615 391.162 Q159.694 386.555 165.504 386.555 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M185.666 415.861 L190.55 415.861 L190.55 421.74 L185.666 421.74 L185.666 415.861 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M200.781 387.18 L219.138 387.18 L219.138 391.115 L205.064 391.115 L205.064 399.588 Q206.082 399.24 207.101 399.078 Q208.119 398.893 209.138 398.893 Q214.925 398.893 218.304 402.064 Q221.684 405.236 221.684 410.652 Q221.684 416.231 218.212 419.333 Q214.74 422.412 208.42 422.412 Q206.244 422.412 203.976 422.041 Q201.73 421.671 199.323 420.93 L199.323 416.231 Q201.406 417.365 203.629 417.921 Q205.851 418.476 208.328 418.476 Q212.332 418.476 214.67 416.37 Q217.008 414.263 217.008 410.652 Q217.008 407.041 214.67 404.935 Q212.332 402.828 208.328 402.828 Q206.453 402.828 204.578 403.245 Q202.726 403.662 200.781 404.541 L200.781 387.18 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M155.319 136.817 L162.957 136.817 L162.957 110.451 L154.647 112.118 L154.647 107.859 L162.911 106.192 L167.587 106.192 L167.587 136.817 L175.226 136.817 L175.226 140.752 L155.319 140.752 L155.319 136.817 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M184.67 134.873 L189.555 134.873 L189.555 140.752 L184.67 140.752 L184.67 134.873 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M209.74 109.271 Q206.129 109.271 204.3 112.836 Q202.494 116.377 202.494 123.507 Q202.494 130.613 204.3 134.178 Q206.129 137.72 209.74 137.72 Q213.374 137.72 215.179 134.178 Q217.008 130.613 217.008 123.507 Q217.008 116.377 215.179 112.836 Q213.374 109.271 209.74 109.271 M209.74 105.567 Q215.55 105.567 218.605 110.174 Q221.684 114.757 221.684 123.507 Q221.684 132.234 218.605 136.84 Q215.55 141.423 209.74 141.423 Q203.929 141.423 200.851 136.84 Q197.795 132.234 197.795 123.507 Q197.795 114.757 200.851 110.174 Q203.929 105.567 209.74 105.567 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M65.9242 810.762 L18.4042 828.904 L18.4042 822.188 L58.4126 807.133 L18.4042 792.046 L18.4042 785.362 L65.9242 803.473 L65.9242 810.762 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M16.4626 764.61 Q23.7832 768.875 30.9446 770.944 Q38.106 773.013 45.4584 773.013 Q52.8108 773.013 60.0359 770.944 Q67.2291 768.843 74.5179 764.61 L74.5179 769.703 Q67.0382 774.477 59.8131 776.864 Q52.588 779.22 45.4584 779.22 Q38.3606 779.22 31.1674 776.864 Q23.9742 774.509 16.4626 769.703 L16.4626 764.61 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M35.7507 732.591 Q35.1778 733.577 34.9232 734.755 Q34.6367 735.901 34.6367 737.301 Q34.6367 742.267 37.8832 744.94 Q41.0979 747.582 47.1453 747.582 L65.9242 747.582 L65.9242 753.47 L30.2762 753.47 L30.2762 747.582 L35.8144 747.582 Q32.5679 745.736 31.0083 742.776 Q29.4168 739.816 29.4168 735.583 Q29.4168 734.978 29.5123 734.246 Q29.576 733.514 29.7351 732.623 L35.7507 732.591 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M16.4626 727.371 L16.4626 722.278 Q23.9742 717.504 31.1674 715.149 Q38.3606 712.762 45.4584 712.762 Q52.588 712.762 59.8131 715.149 Q67.0382 717.504 74.5179 722.278 L74.5179 727.371 Q67.2291 723.138 60.0359 721.069 Q52.8108 718.968 45.4584 718.968 Q38.106 718.968 30.9446 721.069 Q23.7832 723.138 16.4626 727.371 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M18.4042 690.609 L18.4042 685.198 L71.9716 701.749 L71.9716 707.16 L18.4042 690.609 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M46.6997 672.626 Q45.9358 676.191 43.867 678.1 Q41.83 680.01 38.8699 680.01 Q34.3821 680.01 31.8676 676.382 Q29.385 672.785 29.385 666.547 Q29.385 664.128 29.7669 661.422 Q30.1489 658.717 30.9128 655.598 L36.2281 655.598 Q35.3051 658.685 34.8913 661.231 Q34.4776 663.809 34.4776 666.069 Q34.4776 669.857 35.9417 672.053 Q37.4058 674.281 39.4428 674.281 Q41.6708 674.281 43.1031 672.117 Q44.5036 669.984 44.5036 666.292 L44.5036 661.359 L49.3415 661.359 L49.3415 666.069 Q49.3415 670.43 50.9647 672.721 Q52.7471 675.204 55.5481 675.204 Q58.4126 675.204 60.195 672.53 Q61.9774 669.825 61.9774 665.019 Q61.9774 662.059 61.4045 659.353 Q60.7998 656.648 59.6221 654.388 L65.0648 654.388 Q65.956 657.253 66.4016 659.926 Q66.8472 662.632 66.8472 665.178 Q66.8472 672.753 63.9508 676.859 Q61.0544 680.965 55.5481 680.965 Q52.1106 680.965 49.7871 678.769 Q47.4636 676.573 46.6997 672.626 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M772.68 12.096 L780.863 12.096 L780.863 65.6895 L810.313 65.6895 L810.313 72.576 L772.68 72.576 L772.68 12.096 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M855.926 48.0275 L855.926 51.6733 L821.656 51.6733 Q822.142 59.3701 826.274 63.421 Q830.446 67.4314 837.859 67.4314 Q842.153 67.4314 846.164 66.3781 Q850.215 65.3249 854.184 63.2184 L854.184 70.267 Q850.174 71.9684 845.961 72.8596 Q841.748 73.7508 837.414 73.7508 Q826.557 73.7508 820.197 67.4314 Q813.878 61.1119 813.878 50.3365 Q813.878 39.1965 819.873 32.6746 Q825.909 26.1121 836.117 26.1121 Q845.272 26.1121 850.579 32.0264 Q855.926 37.9003 855.926 48.0275 M848.473 45.84 Q848.392 39.7232 845.029 36.0774 Q841.708 32.4315 836.198 32.4315 Q829.96 32.4315 826.193 35.9558 Q822.466 39.4801 821.899 45.8805 L848.473 45.84 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M905.874 45.1919 L905.874 72.576 L898.42 72.576 L898.42 45.4349 Q898.42 38.994 895.909 35.7938 Q893.397 32.5936 888.374 32.5936 Q882.338 32.5936 878.854 36.4419 Q875.371 40.2903 875.371 46.9338 L875.371 72.576 L867.876 72.576 L867.876 27.2059 L875.371 27.2059 L875.371 34.2544 Q878.044 30.163 881.65 28.1376 Q885.295 26.1121 890.035 26.1121 Q897.853 26.1121 901.864 30.9732 Q905.874 35.7938 905.874 45.1919 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M958.455 45.1919 L958.455 72.576 L951.001 72.576 L951.001 45.4349 Q951.001 38.994 948.489 35.7938 Q945.978 32.5936 940.955 32.5936 Q934.919 32.5936 931.435 36.4419 Q927.951 40.2903 927.951 46.9338 L927.951 72.576 L920.457 72.576 L920.457 27.2059 L927.951 27.2059 L927.951 34.2544 Q930.625 30.163 934.23 28.1376 Q937.876 26.1121 942.616 26.1121 Q950.434 26.1121 954.444 30.9732 Q958.455 35.7938 958.455 45.1919 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M993.941 49.7694 Q984.907 49.7694 981.423 51.8354 Q977.94 53.9013 977.94 58.8839 Q977.94 62.8538 980.532 65.2034 Q983.165 67.5124 987.662 67.5124 Q993.86 67.5124 997.586 63.1374 Q1001.35 58.7219 1001.35 51.4303 L1001.35 49.7694 L993.941 49.7694 M1008.81 46.6907 L1008.81 72.576 L1001.35 72.576 L1001.35 65.6895 Q998.802 69.8214 994.994 71.8063 Q991.186 73.7508 985.677 73.7508 Q978.709 73.7508 974.577 69.8619 Q970.486 65.9325 970.486 59.3701 Q970.486 51.7138 975.59 47.825 Q980.735 43.9361 990.902 43.9361 L1001.35 43.9361 L1001.35 43.2069 Q1001.35 38.0623 997.951 35.2672 Q994.589 32.4315 988.472 32.4315 Q984.583 32.4315 980.897 33.3632 Q977.21 34.295 973.808 36.1584 L973.808 29.2718 Q977.899 27.692 981.747 26.9223 Q985.596 26.1121 989.242 26.1121 Q999.085 26.1121 1003.95 31.2163 Q1008.81 36.3204 1008.81 46.6907 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1050.45 34.1734 Q1049.19 33.4443 1047.7 33.1202 Q1046.24 32.7556 1044.46 32.7556 Q1038.14 32.7556 1034.73 36.8875 Q1031.37 40.9789 1031.37 48.6757 L1031.37 72.576 L1023.88 72.576 L1023.88 27.2059 L1031.37 27.2059 L1031.37 34.2544 Q1033.72 30.1225 1037.49 28.1376 Q1041.26 26.1121 1046.64 26.1121 Q1047.41 26.1121 1048.34 26.2337 Q1049.28 26.3147 1050.41 26.5172 L1050.45 34.1734 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1086.67 34.0924 L1086.67 9.54393 L1094.12 9.54393 L1094.12 72.576 L1086.67 72.576 L1086.67 65.7705 Q1084.32 69.8214 1080.71 71.8063 Q1077.15 73.7508 1072.12 73.7508 Q1063.9 73.7508 1058.71 67.1883 Q1053.57 60.6258 1053.57 49.9314 Q1053.57 39.2371 1058.71 32.6746 Q1063.9 26.1121 1072.12 26.1121 Q1077.15 26.1121 1080.71 28.0971 Q1084.32 30.0415 1086.67 34.0924 M1061.27 49.9314 Q1061.27 58.1548 1064.63 62.8538 Q1068.03 67.5124 1073.95 67.5124 Q1079.86 67.5124 1083.26 62.8538 Q1086.67 58.1548 1086.67 49.9314 Q1086.67 41.7081 1083.26 37.0496 Q1079.86 32.3505 1073.95 32.3505 Q1068.03 32.3505 1064.63 37.0496 Q1061.27 41.7081 1061.27 49.9314 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1105.71 46.5287 L1127.54 46.5287 L1127.54 53.1722 L1105.71 53.1722 L1105.71 46.5287 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1144.35 12.096 L1152.53 12.096 L1152.53 68.3631 Q1152.53 79.3005 1148.36 84.2426 Q1144.23 89.1847 1135.03 89.1847 L1131.91 89.1847 L1131.91 82.2982 L1134.47 82.2982 Q1139.89 82.2982 1142.12 79.26 Q1144.35 76.2218 1144.35 68.3631 L1144.35 12.096 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1186.07 32.4315 Q1180.08 32.4315 1176.6 37.1306 Q1173.11 41.7891 1173.11 49.9314 Q1173.11 58.0738 1176.56 62.7728 Q1180.04 67.4314 1186.07 67.4314 Q1192.03 67.4314 1195.51 62.7323 Q1199 58.0333 1199 49.9314 Q1199 41.8701 1195.51 37.1711 Q1192.03 32.4315 1186.07 32.4315 M1186.07 26.1121 Q1195.8 26.1121 1201.35 32.4315 Q1206.9 38.7509 1206.9 49.9314 Q1206.9 61.0714 1201.35 67.4314 Q1195.8 73.7508 1186.07 73.7508 Q1176.31 73.7508 1170.76 67.4314 Q1165.25 61.0714 1165.25 49.9314 Q1165.25 38.7509 1170.76 32.4315 Q1176.31 26.1121 1186.07 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1256.97 45.1919 L1256.97 72.576 L1249.51 72.576 L1249.51 45.4349 Q1249.51 38.994 1247 35.7938 Q1244.49 32.5936 1239.47 32.5936 Q1233.43 32.5936 1229.95 36.4419 Q1226.46 40.2903 1226.46 46.9338 L1226.46 72.576 L1218.97 72.576 L1218.97 27.2059 L1226.46 27.2059 L1226.46 34.2544 Q1229.14 30.163 1232.74 28.1376 Q1236.39 26.1121 1241.13 26.1121 Q1248.95 26.1121 1252.96 30.9732 Q1256.97 35.7938 1256.97 45.1919 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1310.64 48.0275 L1310.64 51.6733 L1276.37 51.6733 Q1276.86 59.3701 1280.99 63.421 Q1285.16 67.4314 1292.57 67.4314 Q1296.87 67.4314 1300.88 66.3781 Q1304.93 65.3249 1308.9 63.2184 L1308.9 70.267 Q1304.89 71.9684 1300.68 72.8596 Q1296.46 73.7508 1292.13 73.7508 Q1281.27 73.7508 1274.91 67.4314 Q1268.59 61.1119 1268.59 50.3365 Q1268.59 39.1965 1274.59 32.6746 Q1280.62 26.1121 1290.83 26.1121 Q1299.99 26.1121 1305.29 32.0264 Q1310.64 37.9003 1310.64 48.0275 M1303.19 45.84 Q1303.11 39.7232 1299.74 36.0774 Q1296.42 32.4315 1290.91 32.4315 Q1284.67 32.4315 1280.91 35.9558 Q1277.18 39.4801 1276.61 45.8805 L1303.19 45.84 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1351.8 28.5427 L1351.8 35.5912 Q1348.64 33.9709 1345.24 33.1607 Q1341.83 32.3505 1338.19 32.3505 Q1332.64 32.3505 1329.84 34.0519 Q1327.09 35.7533 1327.09 39.156 Q1327.09 41.7486 1329.07 43.2475 Q1331.06 44.7058 1337.05 46.0426 L1339.6 46.6097 Q1347.54 48.3111 1350.87 51.4303 Q1354.23 54.509 1354.23 60.0587 Q1354.23 66.3781 1349.2 70.0644 Q1344.22 73.7508 1335.47 73.7508 Q1331.83 73.7508 1327.86 73.0216 Q1323.93 72.3329 1319.55 70.9151 L1319.55 63.2184 Q1323.68 65.3654 1327.69 66.4591 Q1331.71 67.5124 1335.63 67.5124 Q1340.9 67.5124 1343.74 65.73 Q1346.57 63.9071 1346.57 60.6258 Q1346.57 57.5877 1344.51 55.9673 Q1342.48 54.3469 1335.55 52.8481 L1332.96 52.2405 Q1326.03 50.7821 1322.96 47.7845 Q1319.88 44.7463 1319.88 39.4801 Q1319.88 33.0797 1324.41 29.5959 Q1328.95 26.1121 1337.3 26.1121 Q1341.43 26.1121 1345.07 26.7198 Q1348.72 27.3274 1351.8 28.5427 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1400.98 18.8205 L1400.98 41.5461 L1411.26 41.5461 Q1416.98 41.5461 1420.1 38.5889 Q1423.21 35.6318 1423.21 30.163 Q1423.21 24.7348 1420.1 21.7777 Q1416.98 18.8205 1411.26 18.8205 L1400.98 18.8205 M1392.79 12.096 L1411.26 12.096 Q1421.43 12.096 1426.62 16.714 Q1431.84 21.2916 1431.84 30.163 Q1431.84 39.1155 1426.62 43.6931 Q1421.43 48.2706 1411.26 48.2706 L1400.98 48.2706 L1400.98 72.576 L1392.79 72.576 L1392.79 12.096 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1457.12 32.4315 Q1451.13 32.4315 1447.64 37.1306 Q1444.16 41.7891 1444.16 49.9314 Q1444.16 58.0738 1447.6 62.7728 Q1451.09 67.4314 1457.12 67.4314 Q1463.08 67.4314 1466.56 62.7323 Q1470.04 58.0333 1470.04 49.9314 Q1470.04 41.8701 1466.56 37.1711 Q1463.08 32.4315 1457.12 32.4315 M1457.12 26.1121 Q1466.84 26.1121 1472.39 32.4315 Q1477.94 38.7509 1477.94 49.9314 Q1477.94 61.0714 1472.39 67.4314 Q1466.84 73.7508 1457.12 73.7508 Q1447.36 73.7508 1441.81 67.4314 Q1436.3 61.0714 1436.3 49.9314 Q1436.3 38.7509 1441.81 32.4315 Q1447.36 26.1121 1457.12 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1497.67 14.324 L1497.67 27.2059 L1513.02 27.2059 L1513.02 32.9987 L1497.67 32.9987 L1497.67 57.6282 Q1497.67 63.1779 1499.17 64.7578 Q1500.71 66.3376 1505.37 66.3376 L1513.02 66.3376 L1513.02 72.576 L1505.37 72.576 Q1496.74 72.576 1493.46 69.3758 Q1490.18 66.1351 1490.18 57.6282 L1490.18 32.9987 L1484.71 32.9987 L1484.71 27.2059 L1490.18 27.2059 L1490.18 14.324 L1497.67 14.324 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1561.63 48.0275 L1561.63 51.6733 L1527.36 51.6733 Q1527.85 59.3701 1531.98 63.421 Q1536.15 67.4314 1543.57 67.4314 Q1547.86 67.4314 1551.87 66.3781 Q1555.92 65.3249 1559.89 63.2184 L1559.89 70.267 Q1555.88 71.9684 1551.67 72.8596 Q1547.46 73.7508 1543.12 73.7508 Q1532.27 73.7508 1525.91 67.4314 Q1519.59 61.1119 1519.59 50.3365 Q1519.59 39.1965 1525.58 32.6746 Q1531.62 26.1121 1541.83 26.1121 Q1550.98 26.1121 1556.29 32.0264 Q1561.63 37.9003 1561.63 48.0275 M1554.18 45.84 Q1554.1 39.7232 1550.74 36.0774 Q1547.42 32.4315 1541.91 32.4315 Q1535.67 32.4315 1531.9 35.9558 Q1528.17 39.4801 1527.61 45.8805 L1554.18 45.84 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1611.58 45.1919 L1611.58 72.576 L1604.13 72.576 L1604.13 45.4349 Q1604.13 38.994 1601.62 35.7938 Q1599.11 32.5936 1594.08 32.5936 Q1588.05 32.5936 1584.56 36.4419 Q1581.08 40.2903 1581.08 46.9338 L1581.08 72.576 L1573.58 72.576 L1573.58 27.2059 L1581.08 27.2059 L1581.08 34.2544 Q1583.75 30.163 1587.36 28.1376 Q1591 26.1121 1595.74 26.1121 Q1603.56 26.1121 1607.57 30.9732 Q1611.58 35.7938 1611.58 45.1919 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1633.82 14.324 L1633.82 27.2059 L1649.17 27.2059 L1649.17 32.9987 L1633.82 32.9987 L1633.82 57.6282 Q1633.82 63.1779 1635.32 64.7578 Q1636.86 66.3376 1641.52 66.3376 L1649.17 66.3376 L1649.17 72.576 L1641.52 72.576 Q1632.89 72.576 1629.61 69.3758 Q1626.33 66.1351 1626.33 57.6282 L1626.33 32.9987 L1620.86 32.9987 L1620.86 27.2059 L1626.33 27.2059 L1626.33 14.324 L1633.82 14.324 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1658.98 27.2059 L1666.43 27.2059 L1666.43 72.576 L1658.98 72.576 L1658.98 27.2059 M1658.98 9.54393 L1666.43 9.54393 L1666.43 18.9825 L1658.98 18.9825 L1658.98 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1702.65 49.7694 Q1693.61 49.7694 1690.13 51.8354 Q1686.65 53.9013 1686.65 58.8839 Q1686.65 62.8538 1689.24 65.2034 Q1691.87 67.5124 1696.37 67.5124 Q1702.57 67.5124 1706.29 63.1374 Q1710.06 58.7219 1710.06 51.4303 L1710.06 49.7694 L1702.65 49.7694 M1717.51 46.6907 L1717.51 72.576 L1710.06 72.576 L1710.06 65.6895 Q1707.51 69.8214 1703.7 71.8063 Q1699.89 73.7508 1694.38 73.7508 Q1687.41 73.7508 1683.28 69.8619 Q1679.19 65.9325 1679.19 59.3701 Q1679.19 51.7138 1684.3 47.825 Q1689.44 43.9361 1699.61 43.9361 L1710.06 43.9361 L1710.06 43.2069 Q1710.06 38.0623 1706.66 35.2672 Q1703.29 32.4315 1697.18 32.4315 Q1693.29 32.4315 1689.6 33.3632 Q1685.92 34.295 1682.51 36.1584 L1682.51 29.2718 Q1686.6 27.692 1690.45 26.9223 Q1694.3 26.1121 1697.95 26.1121 Q1707.79 26.1121 1712.65 31.2163 Q1717.51 36.3204 1717.51 46.6907 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1732.87 9.54393 L1740.32 9.54393 L1740.32 72.576 L1732.87 72.576 L1732.87 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip902)" style="stroke:#80c4ac; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="312.862,-23450.8 321.441,-19536.5 330.019,-16243 338.598,-13469 347.176,-11130.6 355.755,-9157.71 364.333,-7492.22 372.912,-6085.51 381.49,-4896.98 390.069,-3892.62 398.648,-3043.89 407.226,-2326.84 415.805,-1721.29 424.383,-1210.25 432.962,-779.384 441.54,-416.573 450.119,-111.568 458.697,144.312 467.276,358.432 475.854,537.04 484.433,685.448 493.011,808.175 501.59,909.066 510.168,991.398 518.747,1057.97 527.325,1111.15 535.904,1152.99 544.482,1185.23 553.061,1209.34 561.639,1226.59 570.218,1238.08 578.797,1244.73 587.375,1247.33 595.954,1246.55 604.532,1242.99 613.111,1237.13 621.689,1229.4 630.268,1220.15 638.846,1209.69 647.425,1198.28 656.003,1186.15 664.582,1173.48 673.16,1160.43 681.739,1147.14 690.317,1133.71 698.896,1120.25 707.474,1106.82 716.053,1093.51 724.631,1080.35 733.21,1067.39 741.789,1054.68 750.367,1042.23 758.946,1030.06 767.524,1018.2 776.103,1006.66 784.681,995.447 793.26,984.562 801.838,974.009 810.417,963.79 818.995,953.903 827.574,944.343 836.152,935.108 844.731,926.192 853.309,917.588 861.888,909.289 870.466,901.288 879.045,893.578 887.623,886.149 896.202,878.993 904.78,872.103 913.359,865.47 921.938,859.085 930.516,852.94 939.095,847.026 947.673,841.336 956.252,835.861 964.83,830.593 973.409,825.525 981.987,820.65 990.566,815.96 999.144,811.448 1007.72,807.107 1016.3,802.93 1024.88,798.912 1033.46,795.046 1042.04,791.325 1050.62,787.745 1059.19,784.3 1067.77,780.983 1076.35,777.792 1084.93,774.719 1093.51,771.761 1102.09,768.913 1110.67,766.17 1119.24,763.529 1127.82,760.985 1136.4,758.535 1144.98,756.175 1153.56,753.9 1162.14,751.708 1170.71,749.596 1179.29,747.56 1187.87,745.598 1196.45,743.706 1205.03,741.881 1213.61,740.122 1222.19,738.425 1230.76,736.788 1239.34,735.208 1247.92,733.685 1256.5,732.214 1265.08,730.794 1273.66,729.424 1282.24,728.101 1290.81,726.824 1299.39,725.59 1307.97,724.399 1316.55,723.248 1325.13,722.136 1333.71,721.061 1342.29,720.023 1350.86,719.019 1359.44,718.049 1368.02,717.111 1376.6,716.204 1385.18,715.327 1393.76,714.479 1402.33,713.658 1410.91,712.864 1419.49,712.096 1428.07,711.352 1436.65,710.633 1445.23,709.936 1453.81,709.262 1462.38,708.609 1470.96,707.977 1479.54,707.364 1488.12,706.771 1496.7,706.196 1505.28,705.639 1513.86,705.1 1522.43,704.577 1531.01,704.07 1539.59,703.579 1548.17,703.102 1556.75,702.64 1565.33,702.192 1573.91,701.758 1582.48,701.336 1591.06,700.927 1599.64,700.531 1608.22,700.146 1616.8,699.772 1625.38,699.409 1633.96,699.057 1642.53,698.716 1651.11,698.384 1659.69,698.062 1668.27,697.749 1676.85,697.445 1685.43,697.15 1694,696.863 1702.58,696.584 1711.16,696.313 1719.74,696.05 1728.32,695.794 1736.9,695.546 1745.48,695.304 1754.05,695.069 1762.63,694.84 1771.21,694.618 1779.79,694.402 1788.37,694.192 1796.95,693.987 1805.53,693.788 1814.1,693.595 1822.68,693.406 1831.26,693.223 1839.84,693.044 1848.42,692.871 1857,692.702 1865.58,692.537 1874.15,692.377 1882.73,692.221 1891.31,692.069 1899.89,691.92 1908.47,691.776 1917.05,691.636 1925.62,691.499 1934.2,691.366 1942.78,691.236 1951.36,691.109 1959.94,690.986 1968.52,690.865 1977.1,690.748 1985.67,690.634 1994.25,690.522 2002.83,690.414 2011.41,690.308 2019.99,690.204 2028.57,690.103 2037.15,690.005 2045.72,689.909 2054.3,689.816 2062.88,689.724 2071.46,689.635 2080.04,689.548 2088.62,689.464 2097.2,689.381 2105.77,689.3 2114.35,689.221 2122.93,689.144 2131.51,689.069 2140.09,688.996 2148.67,688.924 2157.25,688.854 2165.82,688.786 2174.4,688.719 2182.98,688.654 2191.56,688.59 2200.14,688.528 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" stroke-dasharray="16, 10" points="-1744.27,685.448 4257.27,685.448 "></polyline>
<path clip-path="url(#clip900)" d="M1735.97 268.364 L2190.07 268.364 L2190.07 164.684 L1735.97 164.684  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1735.97,268.364 2190.07,268.364 2190.07,164.684 1735.97,164.684 1735.97,268.364 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#80c4ac; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="1758.2,216.524 1891.57,216.524 "></polyline>
<path clip-path="url(#clip900)" d="M1913.79 199.244 L1918.47 199.244 L1918.47 229.869 L1935.3 229.869 L1935.3 233.804 L1913.79 233.804 L1913.79 199.244 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1940.21 199.244 L1944.88 199.244 L1944.88 231.396 Q1944.88 237.646 1942.5 240.47 Q1940.14 243.294 1934.88 243.294 L1933.1 243.294 L1933.1 239.359 L1934.56 239.359 Q1937.66 239.359 1938.93 237.623 Q1940.21 235.887 1940.21 231.396 L1940.21 199.244 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1973.93 203.086 L1973.93 216.072 L1979.81 216.072 Q1983.08 216.072 1984.86 214.383 Q1986.64 212.693 1986.64 209.568 Q1986.64 206.466 1984.86 204.776 Q1983.08 203.086 1979.81 203.086 L1973.93 203.086 M1969.26 199.244 L1979.81 199.244 Q1985.62 199.244 1988.59 201.883 Q1991.57 204.498 1991.57 209.568 Q1991.57 214.683 1988.59 217.299 Q1985.62 219.915 1979.81 219.915 L1973.93 219.915 L1973.93 233.804 L1969.26 233.804 L1969.26 199.244 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M2006.02 210.864 Q2002.59 210.864 2000.6 213.549 Q1998.61 216.211 1998.61 220.864 Q1998.61 225.517 2000.58 228.202 Q2002.57 230.864 2006.02 230.864 Q2009.42 230.864 2011.41 228.179 Q2013.4 225.494 2013.4 220.864 Q2013.4 216.258 2011.41 213.572 Q2009.42 210.864 2006.02 210.864 M2006.02 207.253 Q2011.57 207.253 2014.74 210.864 Q2017.91 214.475 2017.91 220.864 Q2017.91 227.23 2014.74 230.864 Q2011.57 234.475 2006.02 234.475 Q2000.44 234.475 1997.27 230.864 Q1994.12 227.23 1994.12 220.864 Q1994.12 214.475 1997.27 210.864 Q2000.44 207.253 2006.02 207.253 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M2029.19 200.517 L2029.19 207.878 L2037.96 207.878 L2037.96 211.188 L2029.19 211.188 L2029.19 225.262 Q2029.19 228.433 2030.04 229.336 Q2030.92 230.239 2033.59 230.239 L2037.96 230.239 L2037.96 233.804 L2033.59 233.804 Q2028.66 233.804 2026.78 231.975 Q2024.91 230.123 2024.91 225.262 L2024.91 211.188 L2021.78 211.188 L2021.78 207.878 L2024.91 207.878 L2024.91 200.517 L2029.19 200.517 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M2065.74 219.776 L2065.74 221.859 L2046.16 221.859 Q2046.43 226.257 2048.79 228.572 Q2051.18 230.864 2055.41 230.864 Q2057.87 230.864 2060.16 230.262 Q2062.47 229.66 2064.74 228.457 L2064.74 232.484 Q2062.45 233.456 2060.04 233.966 Q2057.64 234.475 2055.16 234.475 Q2048.96 234.475 2045.32 230.864 Q2041.71 227.253 2041.71 221.095 Q2041.71 214.73 2045.14 211.003 Q2048.59 207.253 2054.42 207.253 Q2059.65 207.253 2062.68 210.633 Q2065.74 213.989 2065.74 219.776 M2061.48 218.526 Q2061.43 215.031 2059.51 212.947 Q2057.61 210.864 2054.47 210.864 Q2050.9 210.864 2048.75 212.878 Q2046.62 214.892 2046.29 218.549 L2061.48 218.526 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M2094.28 218.156 L2094.28 233.804 L2090.02 233.804 L2090.02 218.295 Q2090.02 214.614 2088.59 212.785 Q2087.15 210.957 2084.28 210.957 Q2080.83 210.957 2078.84 213.156 Q2076.85 215.355 2076.85 219.151 L2076.85 233.804 L2072.57 233.804 L2072.57 207.878 L2076.85 207.878 L2076.85 211.906 Q2078.38 209.568 2080.44 208.41 Q2082.52 207.253 2085.23 207.253 Q2089.7 207.253 2091.99 210.031 Q2094.28 212.785 2094.28 218.156 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M2106.99 200.517 L2106.99 207.878 L2115.76 207.878 L2115.76 211.188 L2106.99 211.188 L2106.99 225.262 Q2106.99 228.433 2107.84 229.336 Q2108.72 230.239 2111.39 230.239 L2115.76 230.239 L2115.76 233.804 L2111.39 233.804 Q2106.46 233.804 2104.58 231.975 Q2102.71 230.123 2102.71 225.262 L2102.71 211.188 L2099.58 211.188 L2099.58 207.878 L2102.71 207.878 L2102.71 200.517 L2106.99 200.517 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M2121.36 207.878 L2125.62 207.878 L2125.62 233.804 L2121.36 233.804 L2121.36 207.878 M2121.36 197.785 L2125.62 197.785 L2125.62 203.179 L2121.36 203.179 L2121.36 197.785 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M2146.32 220.771 Q2141.15 220.771 2139.16 221.952 Q2137.17 223.132 2137.17 225.98 Q2137.17 228.248 2138.65 229.591 Q2140.16 230.91 2142.73 230.91 Q2146.27 230.91 2148.4 228.41 Q2150.55 225.887 2150.55 221.72 L2150.55 220.771 L2146.32 220.771 M2154.81 219.012 L2154.81 233.804 L2150.55 233.804 L2150.55 229.869 Q2149.09 232.23 2146.92 233.364 Q2144.74 234.475 2141.59 234.475 Q2137.61 234.475 2135.25 232.253 Q2132.91 230.007 2132.91 226.257 Q2132.91 221.882 2135.83 219.66 Q2138.77 217.438 2144.58 217.438 L2150.55 217.438 L2150.55 217.021 Q2150.55 214.082 2148.61 212.484 Q2146.69 210.864 2143.19 210.864 Q2140.97 210.864 2138.86 211.396 Q2136.76 211.929 2134.81 212.994 L2134.81 209.058 Q2137.15 208.156 2139.35 207.716 Q2141.55 207.253 2143.63 207.253 Q2149.26 207.253 2152.03 210.17 Q2154.81 213.086 2154.81 219.012 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M2163.59 197.785 L2167.84 197.785 L2167.84 233.804 L2163.59 233.804 L2163.59 197.785 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
<p>柔らかい円板模型（第 2.7.3 節）の，３次元における精緻化として理解できる．</p>
</section>
</section>
</section>
<section id="sec-hard-matter" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="sec-hard-matter"><span class="header-section-number">3</span> 格子模型</h2>
<p>一部は実際の物理系の良いモデルとなっているが，より複雑なモデルの統計物理学的性質の良い第一近似としても用いられる．</p>
<p>加えて，特にスピングラス（第 4 節）は，このような離散的なグラフとしての表現を通じて，機械学習や情報科学との関わりを持つ．そのような分野は情報統計力学と呼ばれる <span class="citation" data-cites="西森秀稔2003">(西森秀稔, 2003)</span>．<sup>12</sup></p>
<section id="格子気体" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="格子気体"><span class="header-section-number">3.1</span> 格子気体</h3>
<p>古典粒子模型（第 2 節）のうち，位置は格子点上に固定され，速度も持たないとしたものである．</p>
<section id="格子気体模型の骨格" class="level4" data-number="3.1.1">
<h4 data-number="3.1.1" class="anchored" data-anchor-id="格子気体模型の骨格"><span class="header-section-number">3.1.1</span> 格子気体模型の骨格</h4>
<p>粒子の位置は必ず格子点上にあるとすれば，配置空間はさらに <img src="https://latex.codecogs.com/png.latex?%5CLambda%5Csubset%5Cmathbb%7BZ%7D%5E3"> に対して <img src="https://latex.codecogs.com/png.latex?%0A%5COmega_%7B%5CLambda,N%7D=%5Cleft%5C%7BQ=%5Cbegin%7Bpmatrix%7Dq_1%5C%5C%5Cvdots%5C%5Cq_N%5Cend%7Bpmatrix%7D%5Cin%5CLambda%5EN%5C,%5Cmiddle%7C%5C,%20q_i%5Cne%20q_j%5C;(i%5Cne%20j)%5Cright%5C%7D%0A"> と簡略化される．</p>
<p>仮に外場もないとすると，ハミルトニアンは単にポテンシャルの和 <img src="https://latex.codecogs.com/png.latex?%0AH(Q)=%5Csum_%7Bi%3Cj%7DU(q_i-q_j)%0A"> となる．</p>
</section>
<section id="平均場模型" class="level4" data-number="3.1.2">
<h4 data-number="3.1.2" class="anchored" data-anchor-id="平均場模型"><span class="header-section-number">3.1.2</span> 平均場模型</h4>
<p>van der Waals の格子気体の模型に，平均場近似を導入したものを，独立に考察した者の名前から，<span class="citation" data-cites="Husimi1954">(Husimi, 1954)</span>-<span class="citation" data-cites="Temperley1954">(Temperley, 1954)</span> 模型という．<sup>13</sup></p>
<p>Ising 模型における Curie-Weiss 模型（第 3.4 節）に対応する．</p>
</section>
</section>
<section id="スピン系" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="スピン系"><span class="header-section-number">3.2</span> スピン系</h3>
<p>格子気体のように，あるグラフ <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BG%7D=(%5CGamma,%5Cmathcal%7BE%7D)"> 上に粒子が配置されていると考える．<sup>14</sup></p>
<p>ただし，この粒子は <strong>スピン</strong> と呼ばれ，特定の追加の自由度を持つとする．</p>
<p>スピン系の相空間は，関数の集合 <img src="https://latex.codecogs.com/png.latex?%0A%5COmega_%5CLambda:=S%5E%5CLambda%0A"> になる．</p>
<section id="n-ベクトル模型" class="level4" data-number="3.2.1">
<h4 data-number="3.2.1" class="anchored" data-anchor-id="n-ベクトル模型"><span class="header-section-number">3.2.1</span> <img src="https://latex.codecogs.com/png.latex?n">-ベクトル模型</h4>
<p><img src="https://latex.codecogs.com/png.latex?S=%5Cpartial%20B%5En%5Csubset%5Cmathbb%7BR%7D%5En"> と，<img src="https://latex.codecogs.com/png.latex?n-1"> 次元球面上に取る場合を，<strong><img src="https://latex.codecogs.com/png.latex?n">-ベクトル模型</strong> という．<sup>15</sup></p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li><img src="https://latex.codecogs.com/png.latex?n=2"> の場合を <a href="https://ja.wikipedia.org/wiki/XY模型"><strong><img src="https://latex.codecogs.com/png.latex?XY"> 模型</strong></a> という．</li>
<li><img src="https://latex.codecogs.com/png.latex?n=3"> の場合を <a href="https://ja.wikipedia.org/wiki/古典ハイゼンベルク模型"><strong>Heisenberg 模型</strong></a> という．</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="[@Kosterlitz-Thouless1973] 転移^[[@西森秀稔2005 p.100] も参照．]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="citation" data-cites="Kosterlitz-Thouless1973">(Kosterlitz &amp; Thouless, 1973)</span> 転移<sup>16</sup>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>XY 模型では <a href="https://ja.wikipedia.org/wiki/ベレジンスキー＝コステリッツ＝サウレス転移">Kosterlitz-Thouless 転移</a> が起こることが予想され，1978年にヘリウム４で観測された．</p>
<p>一般に低次元ではゆらぎが大きくなり秩序相が不安定になって相転移が起こらなくなる．</p>
<p>Ising 模型では 1-2 次元の境界で，Heisenberg 模型では 2-3 次元の境界でこの現象が見られる．</p>
<p>一方で，XY 模型は２次元で特殊な相転移（トポロジカル相転移）を起こす．このような転移は他にも Josephson 接合で見られる．</p>
</div>
</div>
</div>
</section>
<section id="sec-Potts" class="level4" data-number="3.2.2">
<h4 data-number="3.2.2" class="anchored" data-anchor-id="sec-Potts"><span class="header-section-number">3.2.2</span> Potts 模型</h4>
<p><strong><img src="https://latex.codecogs.com/png.latex?q">-状態 Potts 模型</strong> <span class="citation" data-cites="Potts1952">(Potts, 1952)</span> とは，<img src="https://latex.codecogs.com/png.latex?S:=%5Bq%5D=%5C%7B1,%5Ccdots,q%5C%7D"> として，<img src="https://latex.codecogs.com/png.latex?q"> 種類のスピンを持つ模型のことをいう：<sup>17</sup></p>
<p><img src="https://latex.codecogs.com/png.latex?q=2"> の場合が Ising 模型に当たる．</p>
<p>Potts 模型は特に，画像のモデルとしても用いられる <span class="citation" data-cites="Storath+2015">(Storath et al., 2015)</span>．</p>
</section>
<section id="ising-スピン" class="level4" data-number="3.2.3">
<h4 data-number="3.2.3" class="anchored" data-anchor-id="ising-スピン"><span class="header-section-number">3.2.3</span> Ising スピン</h4>
<p><img src="https://latex.codecogs.com/png.latex?S=%5C%7B%5Cpm1%5C%7D"> としても，物理系のモデルとして磁性体の第一近似として使える模型になる．これを <strong>Ising スピン</strong> という．<sup>18</sup></p>
<p>ハミルトニアンは，相互作用と外場の和として <img src="https://latex.codecogs.com/png.latex?%0AH_%5CLambda(%5Csigma)=%5Csum_%7Bx%5Cne%20y%5Cin%5CLambda%7DU(x-y)%5Csigma(x)%5Csigma(y)+h%5Csum_%7Bx%5Cin%5CLambda%7D%5Csigma(x)%0A"> の形で与えられる．</p>
</section>
</section>
<section id="ising-模型" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="ising-模型"><span class="header-section-number">3.3</span> Ising 模型</h3>
<section id="一般的な定義" class="level4" data-number="3.3.1">
<h4 data-number="3.3.1" class="anchored" data-anchor-id="一般的な定義"><span class="header-section-number">3.3.1</span> 一般的な定義</h4>
<p>一般に，Ising 模型では２粒子間の相互作用のみが考えられる．</p>
<p>この場合，一般のグラフ <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BG%7D=(%5Cmathcal%7BV%7D,%5Cmathcal%7BE%7D)"> に対して， <img src="https://latex.codecogs.com/png.latex?%0AH_%5Cmathcal%7BG%7D(%5Csigma):=-%5Cfrac%7BJ%7D%7B2%7D%5Csum_%7Bi=1%7D%5EN%5Csum_%7B(i,j)%5Cin%5Cmathcal%7BE%7D%7Dx_ix_j-h%5Csum_%7Bi=1%7D%5ENx_i%0A"> という形で Hamiltonian を定義することが多い．</p>
<p><img src="https://latex.codecogs.com/png.latex?J"> を <strong>交換相互作用定数</strong> (exchange / coupling constant) という．<img src="https://latex.codecogs.com/png.latex?h"> は外場である．</p>
</section>
<section id="最近傍-ising-模型" class="level4" data-number="3.3.2">
<h4 data-number="3.3.2" class="anchored" data-anchor-id="最近傍-ising-模型"><span class="header-section-number">3.3.2</span> 最近傍 Ising 模型</h4>
<p>ポテンシャル <img src="https://latex.codecogs.com/png.latex?U"> が <img src="https://latex.codecogs.com/png.latex?U_1(0)%5Ccap%5Cmathbb%7BZ%7D%5E3"> を台に持つ場合を <strong>最近傍 Ising 模型</strong> ともいい，<img src="https://latex.codecogs.com/png.latex?U"> は <img src="https://latex.codecogs.com/png.latex?J"> でも表す：<sup>19</sup> <img src="https://latex.codecogs.com/png.latex?%0AH_%5CLambda(%5Csigma)=-J%5Csum_%7B%5Clvert%20x-y%5Crvert=1%7D%5Csigma(x)%5Csigma(y)-h%5Csum_%7Bx%5Cin%5CLambda%7D%5Csigma(x).%0A"></p>
<p>これは，上述のグラフによる定義で，グラフとして <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D%5E3"> 上の格子を取った場合に当たる．</p>
<p>１次元の最近傍 Ising 模型には相転移が存在しない <span class="citation" data-cites="Ising1925">(Ising, 1925)</span> が，２次元以上では存在することが知られている．<sup>20</sup> その場合，低温秩序相は強磁性，高温相は常磁性を示す．</p>
</section>
</section>
<section id="sec-Curie-Weiss" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="sec-Curie-Weiss"><span class="header-section-number">3.4</span> Curie-Weiss 模型</h3>
<p>最近傍 Ising 模型に，Weiss 近似 <span class="citation" data-cites="Weiss1907">(Weiss, 1907)</span> という平均場近似を施して得る Curie-Weiss Hamiltonian <img src="https://latex.codecogs.com/png.latex?%0AH_%7B%5CLambda%7D(%5Csigma)=-%5Cfrac%7BdJ%7D%7B%5Clvert%5CGamma%5Crvert%7D%5Csum_%7Bx%5Cne%20y%5Cin%5CLambda%7D%5Csigma(x)%5Csigma(y)-h%5Csum_%7Bx%5Cin%5CLambda%7D%5Csigma(x)%0A"> を用いる模型を <a href="../../../posts/2024/Computation/PGM2.html#sec-Curie-Weiss">Curie-Weiss 模型</a> という．<sup>21</sup></p>
<p>この式からは，各スピンが，具体的な他のスピンと相互作用するというより，全ての他スピンからなる平均場（<strong>有効磁場</strong>）と相互作用していると読める．<sup>22</sup></p>
<p>このような平均場近似を施していても，Curie-Weiss 模型は（連続な）相転移を示す．<sup>23</sup> しかし，自由エネルギーは非凸関数になっており，他にも <img src="https://latex.codecogs.com/png.latex?h=0"> の場合に非物理的な解が現れるなど，平均場近似の痕跡が随所に見られる．</p>
<p>Curie-Weiss 模型における磁化の Lifted Metropolis-Hastings サンプラーのスケール極限には，Zig-Zag 過程が現れる <span class="citation" data-cites="Bierkens-Roberts2017">(Bierkens &amp; Roberts, 2017)</span>．</p>
</section>
</section>
<section id="sec-spin-glass" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="sec-spin-glass"><span class="header-section-number">4</span> スピングラス</h2>
<p>スピングラスも格子模型の一種であるが，新たなランダム性と相を持つ模型である．</p>
<section id="スピングラスの定義" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="スピングラスの定義"><span class="header-section-number">4.1</span> スピングラスの定義</h3>
<p>Hamiltonian</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AH(%5Csigma):=-%5Csum_%7Bp=1%7D%5E%7BP%7D%5Csum_%7Bi_1%3C%5Ccdots%3Ci_p%7DJ_%7Bi_1,%5Ccdots,i_p%7D%5Csigma_%7Bi_p%7D%5Ccdots%5Csigma_%7Bi_p%7D%0A"></p>
<p>において，<img src="https://latex.codecogs.com/png.latex?p%5Cge2"> かつ <img src="https://latex.codecogs.com/png.latex?J_%7Bi_1,%5Ccdots,i_p%7D"> の符号がバラバラである場合，これをスピングラスの模型という．<sup>24</sup></p>
<p>このような模型では，低温秩序相が消えて，スピンがバラバラである状態（スピングラス相）が出現し得る．特に，安定な状態が複数存在し，温度を少し変えるだけで全く性質の異なる別の状態へ系が移ることもよくある．換言すれば，自由エネルギーが強い多峰性を示すことは，スピングラスの特徴付けと理解される．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/Nature/SG.png" class="img-fluid figure-img"></p>
<figcaption><a href="https://ocw.u-tokyo.ac.jp/lecture_files/issp_02/1/notes/ja/takayama-lecture.pdf">最終講義 スピングラスと計算物性物理</a> p.28</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-caution callout-titled" title="スピングラスの例">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
スピングラスの例
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>CuMn などはスピン間の相互作用が，RKKY (Ruderman-Kittel-Kazuya-Yoshida) 相互作用 <img src="https://latex.codecogs.com/png.latex?%0AJ%5C,%5Cpropto%5C,%5Cfrac%7B%5Ccos(2k_Fr_%7B12%7D)%7D%7Br_%7B12%7D%5E3%7D%0A"> により表され，これは符号が分子の <img src="https://latex.codecogs.com/png.latex?%5Ccos"> により正にも負にもなり得る．</p>
<p>AuFe もスピングラスである <span class="citation" data-cites="Cannella-Mydosh1972">(Cannella &amp; Mydosh, 1972)</span>．<sup>25</sup></p>
</div>
</div>
</div>
</section>
<section id="edwards-anderson-模型-edwards-anderson1975" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="edwards-anderson-模型-edwards-anderson1975"><span class="header-section-number">4.2</span> Edwards-Anderson 模型 <span class="citation" data-cites="Edwards-Anderson1975">(Edwards &amp; Anderson, 1975)</span></h3>
<p><img src="https://latex.codecogs.com/png.latex?(J_%7Bx,y%7D)_%7B%5Clvert%20x-y%5Crvert=1%7D"> を，グラフのエッジの集合上に定義された独立な Gauss 確率場とし，外場を考えないものを，<strong>Edwards-Anderson 模型</strong> という： <img src="https://latex.codecogs.com/png.latex?%0AH(%5Csigma)=-%5Csum_%7B%5Clvert%20x-y%5Crvert=1%7DJ_%7Bx,y%7D%5Csigma(x)%5Csigma(y).%0A"></p>
<p>確率変数 <img src="https://latex.codecogs.com/png.latex?J_%7Bx,y%7D%5Csim%5Cmathrm%7BN%7D_1(0,N)"> の平均（配位平均）と，アンサンブル平均という２つの平均を扱う必要がある点で極めて難しい模型となっている．</p>
<p>この模型において自由エネルギーを計算するために，分配関数の対数の平均を，分配関数の積率によって計算する <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BE%7D%5B%5Clog%20Z%5D=%5Clim_%7Bn%5Cto%5Cinfty%7D%5Cfrac%7B%5Coperatorname%7BE%7D%5BZ%5En%5D-1%7D%7Bn%7D%0A"> という関係式を用いた．これを <strong>レプリカ法</strong> という．ただし，期待値は <img src="https://latex.codecogs.com/png.latex?J_%7Bx,y%7D"> に関するもので，アンサンブル平均 <img src="https://latex.codecogs.com/png.latex?%5Clangle-%5Crangle"> とは関係ないことに注意．</p>
<p>現状，特に Talagrand はレプリカ法の数学的妥当性について極めて懐疑的であるが，多くは数値実験により検証されており，何らかの本質を捉えていることは間違いない．<sup>26</sup></p>
</section>
<section id="sherrington-kirkpatrick-模型-sherrington-kirkpatrick1975" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="sherrington-kirkpatrick-模型-sherrington-kirkpatrick1975"><span class="header-section-number">4.3</span> Sherrington-Kirkpatrick 模型 <span class="citation" data-cites="Sherrington-Kirkpatrick1975">(Sherrington &amp; Kirkpatrick, 1975)</span></h3>
<p>EA 模型を無限レンジにすることで，平均場近似が厳密解を与えるようにし，熱力学極限 <img src="https://latex.codecogs.com/png.latex?%0A%5Clim_%7BN%5Cto%5Cinfty%7D%5Cfrac%7B%5Coperatorname%7BE%7D%5B%5Clog%20Z_N%5D%7D%7BN%7D%0A"> を与えることでこれを解いたものである．その際にもレプリカ法が用いられた．</p>
<p>著者のうちの Scott Kirkpatrick は <a href="../../../posts/Surveys/SMCSamplers.html#sec-SA">擬似アニーリング</a> <span class="citation" data-cites="Kirkpartick+1983">(Kirkpartick et al., 1983)</span> の開発者でもある．</p>
<p>しかしこの解（レプリカ対称な解）は初め低温域では破綻を起こすとされていた．<span class="citation" data-cites="Parisi1980">(Parisi, 1980)</span> がこの問題を解決し，任意の温度 <img src="https://latex.codecogs.com/png.latex?T%3E0"> での厳密解（レプリカ対称性破れ解）が得られた．これは Parisi ansatz と呼ばれる．<sup>27</sup> この解は計算機シミュレーションと高い精度で一致し，常磁性相と強磁性相に加えて，スピングラス相を示す．</p>
<p>Parisi はこの業績で 2021 年にノーベル物理学賞を受賞した．その３番目に多く引用されている論文 <span class="citation" data-cites="Marinari-Parisi1992">(Marinari &amp; Parisi, 1992)</span> は <a href="../../../posts/Surveys/SMCSamplers.html#sec-ST"><strong>擬似テンパリング</strong></a> の提案論文である．</p>
</section>
<section id="thouless-anderson-plamer-方程式-thouless1977-と近似メッセージ伝播-bolthausen2014" class="level3" data-number="4.4">
<h3 data-number="4.4" class="anchored" data-anchor-id="thouless-anderson-plamer-方程式-thouless1977-と近似メッセージ伝播-bolthausen2014"><span class="header-section-number">4.4</span> Thouless-Anderson-Plamer 方程式 <span class="citation" data-cites="Thouless+1977">(Thouless et al., 1977)</span> と近似メッセージ伝播 <span class="citation" data-cites="Bolthausen2014">(Bolthausen, 2014)</span></h3>
<p>一方で，SK 模型に対して高温摂動展開により自由エネルギーを与えるアプローチもある．</p>
<p>特に，熱力学極限に向かって漸近的に成り立つ次の方程式を TAP 方程式という： <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Clangle%5Csigma_i%5Crangle&amp;%5Capprox%5Ctanh%5Cbiggr(%5Cfrac%7B%5Cbeta%7D%7B%5Csqrt%7BN%7D%7D%5Csum_%7Bj%5Cne%20i%7DJ_%7Bij%7D%5Clangle%5Csigma_j%5Crangle%5C%5C%0A%20%20%20%20&amp;%5Cqquad%5Cquad%5Cqquad%5Cquad+h-%5Cbeta%5E2(1-q)%5Clangle%5Csigma_i%5Crangle%5Cbiggl)%0A%5Cend%7Balign*%7D"></p>
<p>これの数学からの証明も近年試みられている <span class="citation" data-cites="Talagrand2003">(Talagrand, 2003)</span>, <span class="citation" data-cites="Chatterjee2010">(Chatterjee, 2010)</span>．しかし，厳密な証明は高温に限られ，低温域では解の一意性が失われるのが困難を窺わせる．２つの層の分離面としては Almeida-Thouless 線が提案されている．</p>
<p>しかし <span class="citation" data-cites="Bolthausen2014">(Bolthausen, 2014)</span> は <strong>近似メッセージパッシング</strong> に基づいて，この TAP 方程式の解を与えるアルゴリズムを提案した．このアルゴリズムは，高次元統計学において <img src="https://latex.codecogs.com/png.latex?M">-推定量を計算するのにも応用されている <span class="citation" data-cites="Donoho-Montanari2016">(Donoho &amp; Montanari, 2016)</span>．高次元漸近論は計算科学の進歩とともにあるのである．</p>
</section>
<section id="hopfield-模型-hopfield1982" class="level3" data-number="4.5">
<h3 data-number="4.5" class="anchored" data-anchor-id="hopfield-模型-hopfield1982"><span class="header-section-number">4.5</span> Hopfield 模型 <span class="citation" data-cites="Hopfield1982">(Hopfield, 1982)</span></h3>
<p>のちにスピングラスの理論は <strong>連想記憶</strong> にも応用され，広く情報処理の問題を統計力学の技法によって研究する情報統計力学という新たな分野が開拓された．</p>
<p><a href="../../../posts/2024/Kernels/Deep.html#sec-Hopfield">連想記憶のニューラルネットワーク</a> は無限レンジ，すなわち全結合のニューラルネットワークで，素子 <img src="https://latex.codecogs.com/png.latex?%5C%7BS_i%5C%7D_%7Bi=1%7D%5EN%5Csubset%5Cmathrm%7BMap%7D(T;%5C%7B%5Cpm1%5C%7D)"> からなるとき， <img src="https://latex.codecogs.com/png.latex?%0AS_i(t+%5CDelta%20t)=%5Cmathop%7B%5Cmathrm%7Bsgn%7D%7D%5Cleft(%5Csum_%7Bj%5Cne%20i%7DJ_%7Bij%7D%5Cfrac%7BS_j(t)+1%7D%7B2%7D-%5Ctheta_i%5Cright)%0A"> という規則で運動する．<img src="https://latex.codecogs.com/png.latex?J_%7Bij%7D,%5Ctheta_i"> がモデルパラメータである．</p>
<p><img src="https://latex.codecogs.com/png.latex?J_%7Bij%7D"> をうまく「学習」できた際には，一部の初期値について，この運動の収束先として画像が「連想」出来る．記憶しておけるのである．<sup>28</sup></p>
<p>実は，<img src="https://latex.codecogs.com/png.latex?p"> 個のパターン <img src="https://latex.codecogs.com/png.latex?(%5Cxi%5E%5Cmu_i)_%7Bi=1%7D%5EN%5Cin%5COmega%5C;(%5Cmu=1,%5Ccdots,p)"> を記憶させるには， <img src="https://latex.codecogs.com/png.latex?%0AJ_%7Bij%7D=1_%7B%5Cleft%5C%7Bi%5Cne%20j%5Cright%5C%7D%7D%5Cfrac%7B1%7D%7BN%7D%5Csum_%7B%5Cmu=1%7D%5Ep%5Cxi_i%5E%5Cmu%5Cxi_j%5E%5Cmu%0A"> と設定すると良いことが知られており，これを <strong>Hebb 則</strong> <span class="citation" data-cites="Hebb1949">(Hebb, 1949)</span> という．</p>
<p>連想記憶がうまくいくためには，互いの直交性 <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B1%7D%7BN%7D(%5Cxi%5E%5Cmu%7C%5Cxi%5E%5Cnu)=%5Cdelta_%7B%5Cmu,%5Cnu%7D+O%5Cleft(%5Cfrac%7B1%7D%7B%5Csqrt%7BN%7D%7D%5Cright)%0A"> が重要であることも知られている．</p>
<p>実は，Hebb 則によるパラメータを備えた Hopfield 模型は，結合が対称である <img src="https://latex.codecogs.com/png.latex?J_%7Bij%7D=J_%7Bji%7D"> とき，次の Hamiltonian を減少させる方向に運動する： <img src="https://latex.codecogs.com/png.latex?%0AH=-%5Cfrac%7B1%7D%7B2%7D%5Csum_%7Bi%5Cne%20j%7DJ_%7Bij%7DS_iS_j%0A"></p>
<p>ここで係数 <img src="https://latex.codecogs.com/png.latex?J_%7Bij%7D"> はデータ <img src="https://latex.codecogs.com/png.latex?(%5Cxi%5E%5Cmu)_%7B%5Cmu=1%7D%5Ep"> から決まっているという意味では，確率変数であることに注意．</p>
<p>この模型を統計力学的に解析すると，Hopfield 模型は，想起相だけでなく，常磁性相ももち，その間にスピングラス相がある．これは <img src="https://latex.codecogs.com/png.latex?%5Calpha=%5Cfrac%7Bp%7D%7BN%7D"> を大きくすると到達することができる <span class="citation" data-cites="西森秀稔2003">(西森秀稔, 2003, p. 57)</span>．</p>
<p>素子数一定の状況下で，覚えるパターン数を増やしすぎると，ある瞬間に相転移を起こして何も覚えなくなるのである．</p>
</section>
<section id="因子グラフ" class="level3" data-number="4.6">
<h3 data-number="4.6" class="anchored" data-anchor-id="因子グラフ"><span class="header-section-number">4.6</span> 因子グラフ</h3>
<p>特に近距離相互作用のみを仮定している場面では，ハミルトニアン <img src="https://latex.codecogs.com/png.latex?H"> やその他の物理量の <strong>局所性</strong> が目立った（コンパクト台を持つ関数になっている）．</p>
<p>そのこともあり，物理系はグラフィカルモデル（Bayesian networks, Markov networks）としての表現と親和性があり，特に <a href="../../../posts/2024/Computation/PGM1.html#sec-Factor-Graph"><strong>因子グラフ</strong></a> が重要な形式として用いられる <span class="citation" data-cites="Mezard-Montanari2009">(Mézard &amp; Montanari, 2009, p. 100)</span>．</p>
</section>
</section>



<div id="quarto-appendix" class="default"><section id="参考文献" class="level2 appendix" data-number="5"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">5</span> 参考文献</h2><div class="quarto-appendix-contents">

<p><span class="citation" data-cites="Minlos2000">(Minlos, 2000)</span>, <span class="citation" data-cites="西森秀稔2003">(西森秀稔, 2003)</span>, <span class="citation" data-cites="Altieri-Baity-Jesi2024">(Altieri &amp; Baity-Jesi, 2024)</span>, <span class="citation" data-cites="Chatterjee2023">(Chatterjee, 2023)</span>, <span class="citation" data-cites="Panchenko2012">(Panchenko, 2012)</span>, <span class="citation" data-cites="Talagrand2003">(Talagrand, 2003)</span>, <span class="citation" data-cites="Bolthausen2014">(Bolthausen, 2014)</span>, <span class="citation" data-cites="Faulkner-Livingstone2024">(Faulkner &amp; Livingstone, 2024)</span>．</p>



</div></section><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-Altieri-Baity-Jesi2024" class="csl-entry">
Altieri, A., &amp; Baity-Jesi, M. (2024). An introduction to the theory of spin glasses. In <em>Encyclopedia of condensed matter physics</em> (pp. 361–370). Elsevier. <a href="https://doi.org/10.1016/b978-0-323-90800-9.00249-3">https://doi.org/10.1016/b978-0-323-90800-9.00249-3</a>
</div>
<div id="ref-Baxter1982" class="csl-entry">
Baxter, R. J. (1982). <em>Exactly solved models in statistical mechanics</em>. Academic Press. <a href="https://physics.anu.edu.au/research/ftp/mpg/baxter_book.php">https://physics.anu.edu.au/research/ftp/mpg/baxter_book.php</a>
</div>
<div id="ref-Bernard-Krauth2011" class="csl-entry">
Bernard, E. P., &amp; Krauth, W. (2011). Two-step melting in two dimensions: First-order liquid-hexatic transition. <em>Phys. Rev. Lett.</em>, <em>107</em>, 155704. <a href="https://doi.org/10.1103/PhysRevLett.107.155704">https://doi.org/10.1103/PhysRevLett.107.155704</a>
</div>
<div id="ref-Bierkens-Roberts2017" class="csl-entry">
Bierkens, J., &amp; Roberts, G. (2017). <span class="nocase">A Piecewise Deterministic Scaling Limit of Lifted Metropolis-Hastings in the Curie-Weiss Model</span>. <em>The Annals of Applied Probability</em>, <em>27</em>(2), 846–882. <a href="http://www.jstor.org/stable/44249153">http://www.jstor.org/stable/44249153</a>
</div>
<div id="ref-Bolthausen2014" class="csl-entry">
Bolthausen, E. (2014). An iterative construction of solutions of the TAP equations for the sherrington–kirkpatrick model. <em>Communications in Mathematical Physics</em>, <em>325</em>(1), 333–366. <a href="https://doi.org/10.1007/s00220-013-1862-3">https://doi.org/10.1007/s00220-013-1862-3</a>
</div>
<div id="ref-Cannella-Mydosh1972" class="csl-entry">
Cannella, V., &amp; Mydosh, J. A. (1972). Magnetic ordering in gold-iron alloys. <em>Phys. Rev. B</em>, <em>6</em>, 4220–4237. <a href="https://doi.org/10.1103/PhysRevB.6.4220">https://doi.org/10.1103/PhysRevB.6.4220</a>
</div>
<div id="ref-Chatterjee2010" class="csl-entry">
Chatterjee, S. (2010). Spin glasses and stein’s method. <em>Probability Theory and Related Fields</em>, <em>148</em>(3), 567–600. <a href="https://doi.org/10.1007/s00440-009-0240-8">https://doi.org/10.1007/s00440-009-0240-8</a>
</div>
<div id="ref-Chatterjee2023" class="csl-entry">
Chatterjee, S. (2023). <em>Spin glass phase at zero temperature in the edwards-anderson model</em>. <a href="https://arxiv.org/abs/2301.04112">https://arxiv.org/abs/2301.04112</a>
</div>
<div id="ref-Donoho-Montanari2016" class="csl-entry">
Donoho, D., &amp; Montanari, A. (2016). High dimensional robust m-estimation: Asymptotic variance via approximate message passing. <em>Probability Theory and Related Fields</em>, <em>166</em>(3), 935–969. <a href="https://doi.org/10.1007/s00440-015-0675-z">https://doi.org/10.1007/s00440-015-0675-z</a>
</div>
<div id="ref-Edwards-Anderson1975" class="csl-entry">
Edwards, S. F., &amp; Anderson, P. W. (1975). Theory of spin glasses. <em>Journal of Physics F: Metal Physics</em>, <em>5</em>(5), 965. <a href="https://doi.org/10.1088/0305-4608/5/5/017">https://doi.org/10.1088/0305-4608/5/5/017</a>
</div>
<div id="ref-Engel+2013" class="csl-entry">
Engel, M., Anderson, J. A., Glotzer, S. C., Isobe, M., Bernard, E. P., &amp; Krauth, W. (2013). Hard-disk equation of state: First-order liquid-hexatic transition in two dimensions with three simulation methods. <em>Phys. Rev. E</em>, <em>87</em>, 042134. <a href="https://doi.org/10.1103/PhysRevE.87.042134">https://doi.org/10.1103/PhysRevE.87.042134</a>
</div>
<div id="ref-Faulkner-Livingstone2024" class="csl-entry">
Faulkner, M. F., &amp; Livingstone, S. (2024). <span class="nocase">Sampling Algorithms in Statistical Physics: A Guide for Statistics and Machine Learning</span>. <em>Statistical Science</em>, <em>39</em>(1), 137–164. <a href="https://doi.org/10.1214/23-STS893">https://doi.org/10.1214/23-STS893</a>
</div>
<div id="ref-Friedli-Velenik2017" class="csl-entry">
Friedli, S., &amp; Velenik, Y. (2017). <em>Statistical mechanics of lattice systems</em>. Cambridge University Press.
</div>
<div id="ref-Hebb1949" class="csl-entry">
Hebb, D. O. (1949). <em>The organization of behavior: A neuropsychological theory</em>. John Wiley &amp; Sons, Chapman; Hall. <a href="https://www.taylorfrancis.com/books/mono/10.4324/9781410612403/organization-behavior-hebb">https://www.taylorfrancis.com/books/mono/10.4324/9781410612403/organization-behavior-hebb</a>
</div>
<div id="ref-Hopfield1982" class="csl-entry">
Hopfield, J. J. (1982). Neural networks and physical systems with emergent collective computational abilities. <em>Proceedings of the National Academy of Science</em>, <em>79</em>(8), 2554–2558. <a href="https://www.pnas.org/doi/10.1073/pnas.79.8.2554">https://www.pnas.org/doi/10.1073/pnas.79.8.2554</a>
</div>
<div id="ref-Husimi1954" class="csl-entry">
Husimi, K. (1954). <a href="">Statistical mechanics of condensation</a>. In H. Yukawa (Ed.), <em>Proceedings of the international conference of theoretical physics. Science council of japan</em>.
</div>
<div id="ref-Ising1925" class="csl-entry">
Ising, E. (1925). Beitrag zur theorie des ferromagnetismus. <em>Zeitschrift Für Physik</em>, <em>31</em>, 253–258. <a href="https://link.springer.com/article/10.1007/BF02980577">https://link.springer.com/article/10.1007/BF02980577</a>
</div>
<div id="ref-Kac-Thompson1966" class="csl-entry">
Kac, M., &amp; Thompson, C. J. (1966). On the mathematical mechanism of phase transition. <em>Proceedings of the National Academy of Sciences of the United States of America</em>, <em>55</em>(4), 676–683. <a href="http://www.jstor.org/stable/57450">http://www.jstor.org/stable/57450</a>
</div>
<div id="ref-Kirkpartick+1983" class="csl-entry">
Kirkpartick, S., Gelatt, C. D., &amp; Vecchi, M. P. (1983). Optimization by simulated annealing. <em>Science</em>, <em>220</em>(4598), 671–680.
</div>
<div id="ref-Kosterlitz-Thouless1973" class="csl-entry">
Kosterlitz, J. M., &amp; Thouless, D. J. (1973). Ordering, metastability and phase transitions in two-dimensional systems. <em>Journal of Physics C: Solid State Physics</em>, <em>6</em>(7), 1181. <a href="https://doi.org/10.1088/0022-3719/6/7/010">https://doi.org/10.1088/0022-3719/6/7/010</a>
</div>
<div id="ref-Marinari-Parisi1992" class="csl-entry">
Marinari, E., &amp; Parisi, G. (1992). Simulated tempering: A new monte carlo scheme. <em>Europhysics Letters</em>, <em>19</em>(6), 451–458.
</div>
<div id="ref-Metropolis+1953" class="csl-entry">
Metropolis, N., Rosenbluth, A. W., Rosenbluth, M. N., Teller, A. H., &amp; Teller, E. (1953). Equation of state calculations by fast computing machines. <em>The Journal of Chemical Physics</em>, <em>21</em>(6), 1087–1092. <a href="https://doi.org/10.1063/1.1699114">https://doi.org/10.1063/1.1699114</a>
</div>
<div id="ref-Mezard-Montanari2009" class="csl-entry">
Mézard, M., &amp; Montanari, A. (2009). <em>Information, physics, and computation</em>. Oxford University Press. <a href="https://doi.org/10.1093/acprof:oso/9780198570837.001.0001">https://doi.org/10.1093/acprof:oso/9780198570837.001.0001</a>
</div>
<div id="ref-Minlos2000" class="csl-entry">
Minlos, R. A. (2000). <em>Introduction to mathematical statistical physics</em> (Vol. 19). American Mathematical Society. <a href="https://doi.org/10.1090/ulect/019">https://doi.org/10.1090/ulect/019</a>
</div>
<div id="ref-Onsager1944" class="csl-entry">
Onsager, L. (1944). Crystal statistics. I. A two-dimensional model with an order-disorder transition. <em>Phys. Rev.</em>, <em>65</em>, 117–149. <a href="https://doi.org/10.1103/PhysRev.65.117">https://doi.org/10.1103/PhysRev.65.117</a>
</div>
<div id="ref-Panchenko2012" class="csl-entry">
Panchenko, D. (2012). The sherrington-kirkpatrick model: An overview. <em>Journal of Statistical Physics</em>, <em>149</em>(2), 362–383. <a href="https://doi.org/10.1007/s10955-012-0586-7">https://doi.org/10.1007/s10955-012-0586-7</a>
</div>
<div id="ref-Parisi1980" class="csl-entry">
Parisi, G. (1980). A sequence of approximated solutions to the s-k model for spin glasses. <em>Journal of Physics A: Mathematical and General</em>, <em>13</em>(4), L115. <a href="https://doi.org/10.1088/0305-4470/13/4/009">https://doi.org/10.1088/0305-4470/13/4/009</a>
</div>
<div id="ref-Peters-deWith2012" class="csl-entry">
Peters, E. A. J. F., &amp; de&nbsp;With, G. (2012). Rejection-free monte carlo sampling for general potentials. <em>Physical Review E</em>, <em>85</em>(2). <a href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.85.026703">https://journals.aps.org/pre/abstract/10.1103/PhysRevE.85.026703</a>
</div>
<div id="ref-Petersen1983" class="csl-entry">
Petersen, K. E. (1983). <em>Ergodic theory</em> (Vol. 2). Cambridge University Press. <a href="https://doi.org/10.1017/CBO9780511608728">https://doi.org/10.1017/CBO9780511608728</a>
</div>
<div id="ref-Potts1952" class="csl-entry">
Potts, R. B. (1952). Some generalized order-disorder transformations. <em>Mathematical Proceedings of the Cambridge Philosophical Society</em>, <em>48</em>(1), 106–109. <a href="https://doi.org/10.1017/S0305004100027419">https://doi.org/10.1017/S0305004100027419</a>
</div>
<div id="ref-Sherrington-Kirkpatrick1975" class="csl-entry">
Sherrington, D., &amp; Kirkpatrick, S. (1975). Solvable model of a spin-glass. <em>Phys. Rev. Lett.</em>, <em>35</em>, 1792–1796. <a href="https://doi.org/10.1103/PhysRevLett.35.1792">https://doi.org/10.1103/PhysRevLett.35.1792</a>
</div>
<div id="ref-Storath+2015" class="csl-entry">
Storath, M., Weinmann, A., Frikel, J., &amp; Unser, M. (2015). Joint image reconstruction and segmentation using the potts model. <em>Inverse Problems</em>, <em>31</em>(2), 025003. <a href="https://doi.org/10.1088/0266-5611/31/2/025003">https://doi.org/10.1088/0266-5611/31/2/025003</a>
</div>
<div id="ref-Talagrand2003" class="csl-entry">
Talagrand, M. (2003). <em>Spin glasses: A challenge for mathematicians: Cavity and mean field models</em>. Springer Berlin, Heidelberg. <a href="https://link.springer.com/book/9783540003564">https://link.springer.com/book/9783540003564</a>
</div>
<div id="ref-Temperley1954" class="csl-entry">
Temperley, H. N. V. (1954). The mayer theory of condensation tested against a simple model of the imperfect gas. <em>Proceedings of the Physical Society. Section A</em>, <em>67</em>(3), 233. <a href="https://doi.org/10.1088/0370-1298/67/3/306">https://doi.org/10.1088/0370-1298/67/3/306</a>
</div>
<div id="ref-Thorneywork2017" class="csl-entry">
Thorneywork, A. L., Abbott, J. L., Aarts, D. G. A. L., &amp; Dullens, R. P. A. (2017). Two-dimensional melting of colloidal hard spheres. <em>Phys. Rev. Lett.</em>, <em>118</em>, 158001. <a href="https://doi.org/10.1103/PhysRevLett.118.158001">https://doi.org/10.1103/PhysRevLett.118.158001</a>
</div>
<div id="ref-Thouless+1977" class="csl-entry">
Thouless, D. J., Anderson, P. W., &amp; Palmer, R. G. (1977). Solution of ’solvable model of a spin glass’. <em>Philosophical Magazine</em>, <em>35</em>(3), 593–601. <a href="https://doi.org/10.1080/14786437708235992">https://doi.org/10.1080/14786437708235992</a>
</div>
<div id="ref-Weiss1907" class="csl-entry">
Weiss, P. (1907). L’hypothèse du champ moléculaire et la propriété ferromagnétique. <em>Journal of Physics: Theories and Applications</em>, <em>6</em>(1), 661–690. <a href="https://hal.science/jpa-00241247/en">https://hal.science/jpa-00241247/en</a>
</div>
<div id="ref-田中利幸2007" class="csl-entry">
田中利幸. (2007). レプリカ法における解析接続について(情報物理学の数学的構造). <em>数理解析研究所講究録</em>, <em>1532</em>, 118–129. <a href="http://hdl.handle.net/2433/58952">http://hdl.handle.net/2433/58952</a>
</div>
<div id="ref-西森秀稔2003" class="csl-entry">
西森秀稔. (2003). <em>スピングラスと連想記憶</em>. 岩波書店. <a href="https://www.iwanami.co.jp/book/b476276.html">https://www.iwanami.co.jp/book/b476276.html</a>
</div>
<div id="ref-西森秀稔2005" class="csl-entry">
西森秀稔. (2005). <em>相転移・臨界現象の統計物理学</em> (Vol. 35). 培風館. <a href="https://www.kyoritsu-pub.co.jp/book/b10003637.html">https://www.kyoritsu-pub.co.jp/book/b10003637.html</a>
</div>
<div id="ref-都福仁1977" class="csl-entry">
都福仁. (1977). スピングラス. <em>日本物理学会誌</em>, <em>32</em>(6), 463–473. <a href="https://doi.org/10.11316/butsuri1946.32.463">https://doi.org/10.11316/butsuri1946.32.463</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><span class="citation" data-cites="Faulkner-Livingstone2024">(Faulkner &amp; Livingstone, 2024, p. 3)</span> 2.1節も参照．↩︎</p></li>
<li id="fn2"><p>すなわち，<img src="https://latex.codecogs.com/png.latex?%5CLambda"> 上の線型束である．↩︎</p></li>
<li id="fn3"><p><span class="citation" data-cites="Faulkner-Livingstone2024">(Faulkner &amp; Livingstone, 2024, pp. 3–4 2.2節)</span> も参照．↩︎</p></li>
<li id="fn4"><p><img src="https://latex.codecogs.com/png.latex?V"> は境界ポテンシャルといい，外場との相互作用がある場合に現れる．↩︎</p></li>
<li id="fn5"><p>これは粒子間相互作用が short-range であると仮定しているためである．重力やクーロン力を考えている訳ではない．↩︎</p></li>
<li id="fn6"><p><span class="citation" data-cites="Petersen1983">(Petersen, 1983, p. 6)</span> 命題2.2．↩︎</p></li>
<li id="fn7"><p>これらの確率測度については <a href="../../../posts/2024/Nature/StatisticalMechanics2.html">次稿</a> も参照．↩︎</p></li>
<li id="fn8"><p><span class="citation" data-cites="Faulkner-Livingstone2024">(Faulkner &amp; Livingstone, 2024, p. 8)</span> 3.2 節に倣った．↩︎</p></li>
<li id="fn9"><p><span class="citation" data-cites="Faulkner-Livingstone2024">(Faulkner &amp; Livingstone, 2024, p. 8)</span> 3.2 節も参照．↩︎</p></li>
<li id="fn10"><p>液相転移においては，まず位置の秩序が破壊され，次に方向性の秩序が破壊される．従って，液相と固体相の間に別の相が定義でき，これを <a href="https://en.wikipedia.org/wiki/Hexatic_phase"><strong>hexatic phase</strong></a> という．これを最初に記述したのが <a href="https://en.wikipedia.org/wiki/KTHNY_theory">KTHNY 理論</a>である <span class="citation" data-cites="Kosterlitz-Thouless1973">(Kosterlitz &amp; Thouless, 1973)</span>．詳しくは <span class="citation" data-cites="Faulkner-Livingstone2024">(Faulkner &amp; Livingstone, 2024, pp. 10–11)</span> 3.2.2 節も参照．↩︎</p></li>
<li id="fn11"><p><span class="citation" data-cites="Faulkner-Livingstone2024">(Faulkner &amp; Livingstone, 2024, p. 8)</span> 3.2 節も参照．↩︎</p></li>
<li id="fn12"><p><a href="https://www.ism.ac.jp/ism_info_j/labo/project/156.html">統数研プロジェクト紹介</a> も参照．↩︎</p></li>
<li id="fn13"><p><span class="citation" data-cites="Kac-Thompson1966">(Kac &amp; Thompson, 1966)</span> も参照．↩︎</p></li>
<li id="fn14"><p>例えば格子点の集合 <img src="https://latex.codecogs.com/png.latex?%5CGamma%5Csubset%5Cmathbb%7BZ%7D%5En"> など．↩︎</p></li>
<li id="fn15"><p><span class="citation" data-cites="西森秀稔2005">(西森秀稔, 2005, p. 100)</span> に倣った．↩︎</p></li>
<li id="fn16"><p><span class="citation" data-cites="西森秀稔2005">(西森秀稔, 2005, p. 100)</span> も参照．↩︎</p></li>
<li id="fn17"><p><span class="citation" data-cites="西森秀稔2005">(西森秀稔, 2005, p. 15)</span>，<span class="citation" data-cites="Mezard-Montanari2009">(Mézard &amp; Montanari, 2009, p. 26)</span> 例2.2 に倣った．↩︎</p></li>
<li id="fn18"><p><span class="citation" data-cites="西森秀稔2003">(西森秀稔, 2003, p. 4)</span>．情報統計力学では，スピンをビットやニューロンの状態に見立て，そのモデルとしても頻繁に用いられる．↩︎</p></li>
<li id="fn19"><p><span class="citation" data-cites="Baxter1982">(Baxter, 1982, p. 21)</span> では nearest-neighbour Ising model と呼んでいる．↩︎</p></li>
<li id="fn20"><p>２次元かつ <img src="https://latex.codecogs.com/png.latex?h=0"> の場合は <span class="citation" data-cites="Onsager1944">(Onsager, 1944)</span> により自由エネルギーの解析形が特定された．↩︎</p></li>
<li id="fn21"><p>Weiss は <strong>分子場</strong> と呼んだ．相互作用がもはや最近傍同士ではなくなっている．この点から <strong>無限レンジ模型</strong> ともいう．<span class="citation" data-cites="西森秀稔2003">(西森秀稔, 2003, p. 24)</span> も参照．↩︎</p></li>
<li id="fn22"><p>無限レンジの仮定をおくと，平均場近似は近似でなくなる，という論理的依存関係がある <span class="citation" data-cites="西森秀稔2003">(西森秀稔, 2003, p. 26)</span>．↩︎</p></li>
<li id="fn23"><p>例えば <span class="citation" data-cites="Friedli-Velenik2017">(Friedli &amp; Velenik, 2017, p. 62)</span> を参照．↩︎</p></li>
<li id="fn24"><p><span class="citation" data-cites="Mezard-Montanari2009">(Mézard &amp; Montanari, 2009, p. 242)</span> <span class="citation" data-cites="西森秀稔2003">(西森秀稔, 2003, p. 16)</span> など．スピングラスはもともと B. Coles が希薄合金の磁性を表現するために造語したが，現在は「全くランダムな状態でスピンが凍結した状態」という意味で使われるようになている <span class="citation" data-cites="都福仁1977">(都福仁, 1977)</span>．↩︎</p></li>
<li id="fn25"><p>Mydosh による講演が，髙山一氏のスピングラス研究の発端となったという（<a href="https://ocw.u-tokyo.ac.jp/lecture_files/issp_02/1/notes/ja/takayama-lecture.pdf">最終講義</a>）．↩︎</p></li>
<li id="fn26"><p><span class="citation" data-cites="田中利幸2007">(田中利幸, 2007)</span>↩︎</p></li>
<li id="fn27"><p><span class="citation" data-cites="Panchenko2012">(Panchenko, 2012)</span> も参照．↩︎</p></li>
<li id="fn28"><p>パターンを記憶させることを「埋め込む」ともいう <span class="citation" data-cites="西森秀稔2003">(西森秀稔, 2003, p. 33)</span>．↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Nature</category>
  <category>Deep</category>
  <guid>https://162348.github.io/posts/2024/Nature/StatisticalMechanics1.html</guid>
  <pubDate>Sat, 06 Apr 2024 15:00:00 GMT</pubDate>
  <media:content url="https://162348.github.io/posts/2024/Nature/Lennard-Jones.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>計算とは何か</title>
  <dc:creator>司馬博文 </dc:creator>
  <link>https://162348.github.io/posts/2024/Computation/AboutSimulation.html</link>
  <description><![CDATA[ 





<section id="今後の世界においてシミュレーションが果たす役割はどこまで拡大するのだろうか" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="今後の世界においてシミュレーションが果たす役割はどこまで拡大するのだろうか"><span class="header-section-number">1</span> 今後の世界においてシミュレーションが果たす役割はどこまで拡大するのだろうか？</h2>
<p>２つの方向で「シミュレーション」へのアプローチが急速に進みつつある．</p>
<section id="sec-physical-simulation" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="sec-physical-simulation"><span class="header-section-number">1.1</span> 物理学的シミュレーション</h3>
<p>従来物理学においては，実験と理論が相補的な関係にあった．</p>
<blockquote class="blockquote">
<p>If it disagrees with experiment, it’s wrong. In that simple statement, is the key to science. <span class="citation" data-cites="Feynman1964">(Feynman, 1964)</span></p>
</blockquote>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/EYPapE-3FRw?si=YmbUd1k8NCZo0s4k" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>しかし今後は，計算機シミュレーションと Monte Carlo 法が新時代の科学の第三の要素になるのかも知れない．</p>
<blockquote class="blockquote">
<p>These are some of the reasons why computer simulation has recently emerged as a third way in science besides the experimental and theoretical approach. <span class="citation" data-cites="Griebel+2007">(Griebel et al., 2007, p. 2)</span></p>
</blockquote>
<p>素粒子論など，実験が出来ないために理論の検証がまたれている場面では，計算機シミュレーションが有望な手法になる．また半導体や製薬業界など，実験が高くつく産業では急速に計算機シミュレーションによる代替が進んでいる．</p>
<p>一方で，多体問題などの解析的な手法では刃が立たない場面では，数値計算が唯一の理論的進歩を与えてくれる手法になる．<strong>数値実験</strong> という言葉に，「実験」の語が含まれている理由である．</p>
<blockquote class="blockquote">
<p>The rapid development of parallel computing systems made it possible to recreate and predict physical processes on computers. <span class="citation" data-cites="Griebel+2007">(Griebel et al., 2007, Preface)</span></p>
</blockquote>
<p>しかし，これには新たな数理の発展が必要である．実験結果には統計的な解釈を加えないと無意味であったように，シミュレーションも新たな統計学・機械学習と共に科学に資される必要がある．</p>
<blockquote class="blockquote">
<p>Experimental practice rests on a long (occasionally blemished) tradition; computer simulation, because of its novelty, is still somewhat more haphazard, but methodologies are gradually evolving. <strong>The output of any simulation should be treated by the same statistical methods used in the analysis of experiments</strong>. <span class="citation" data-cites="Rapaport2004">(Rapaport, 2004, pp. 2–3)</span></p>
</blockquote>
<p>筆者は学部入学直後に物理学実験という全理系学生必修の講義を経験し，その初回講義は不確実性の扱いについてであった．実際に講堂に集まった全学生でサイコロをふり，記録をとり，大数の法則を体験するという極めて印象深い授業であった．</p>
<p>未来の物理学実験の授業は，第２回授業ではコンピュータシミュレーションを扱うようになるのかも知れない．</p>
</section>
<section id="意味論的シミュレーション" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="意味論的シミュレーション"><span class="header-section-number">1.2</span> 意味論的シミュレーション</h3>
<p>大規模言語モデル（LLM）は，物理学的なシミュレーションと相補的な世界モデルを提供しつつある．</p>
</section>
</section>
<section id="計算とシミュレーションの違いとは何だろうか" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="計算とシミュレーションの違いとは何だろうか"><span class="header-section-number">2</span> 計算とシミュレーションの違いとは何だろうか？</h2>
<p>第 1.1 節で指摘した通り，シミュレーションとは本来は計算とは関係がなく，ある物理的な過程を別の物理的な過程によって模倣する行為である．</p>
<blockquote class="blockquote">
<p>What distinguishes computer simulation in general from other forms of computation, if such a distinction can be made, is the manner in which the computer is used: instead of merely performing a calculation, <strong>the computer becomes the virtual laboratory in which a system is studied - a numerical experiment</strong>. <span class="citation" data-cites="Rapaport2004">(Rapaport, 2004, p. 3)</span></p>
</blockquote>
<p>LLM では文字が，数値実験では数字が表象となっているに過ぎない．ここで文字や数字は，人間が人間の理解のために採用している形式である．VAE の中間層に特殊な形式を形式を矯正しているに過ぎない．</p>
<p>すると，ここを最適な形式によって相互接続し，end-to-end にすることで更なる効率化を図ろうとする論理が考えられるが，これが機械学習の悲願なのかも知れない．</p>
<section id="buffon-の針と-monte-carlo-積分法" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="buffon-の針と-monte-carlo-積分法"><span class="header-section-number">2.1</span> Buffon の針と Monte Carlo 積分法</h3>
<p>LLM が計算によりシミュレーションを実行する手法であるとしたら，Monte Carlo 積分法は，シミュレーションによって計算を実行する手法である．</p>
<p><span class="citation" data-cites="Liu2004">(Liu, 2004 Preface)</span> で Monte Carlo computation の最も初源的なアイデアは Buffon の針にあると指摘されている．</p>
<blockquote class="blockquote">
<p>The idea of simulating random processes so as to help evaluate certain quantities of interest is now an essential part of scientific computing. <span class="citation" data-cites="Liu2004">(Liu, 2004)</span></p>
</blockquote>
<p>となると，Bayesian computation とは，本質的にシミュレーションによるコンピューテーションへの反逆なのかもしれない．</p>
<div class="table-responsive-sm">
<table class="table-striped table-hover table">
<caption>Contrast of the two main approachs to Machine Learning</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Bayesian</th>
<th style="text-align: center;">Frequentist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Inference is<sup>1</sup></td>
<td style="text-align: center;">Marginalization</td>
<td style="text-align: center;">Approximation</td>
</tr>
<tr class="even">
<td style="text-align: center;">Mathematical Idea</td>
<td style="text-align: center;">Integration</td>
<td style="text-align: center;">Differentiation<sup>2</sup></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Computational Idea<sup>3</sup></td>
<td style="text-align: center;">Integration</td>
<td style="text-align: center;">Optimization</td>
</tr>
<tr class="even">
<td style="text-align: center;">Computational Solution</td>
<td style="text-align: center;">Simulation</td>
<td style="text-align: center;">Computation</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Objective</td>
<td style="text-align: center;">Uncertainty Quantification</td>
<td style="text-align: center;">Recovery of True Value</td>
</tr>
<tr class="even">
<td style="text-align: center;">Emphasis</td>
<td style="text-align: center;">Modelling</td>
<td style="text-align: center;">Inference</td>
</tr>
</tbody>
</table>
</div>
<p>重要な観察として，</p>
<ul>
<li>決定論的な数値計算法の方が収束が速い．グリッド法などは <img src="https://latex.codecogs.com/png.latex?O(n%5E%7B-1%7D)">．</li>
<li>しかし，シミュレーションベースの方法の方がスケールする．Monte Carlo 積分法にしか太刀打ちできない領域は大きい上に，スケールする MCMC の最も重要な性質は，不偏推定量を通じてサブサンプルのみによる実行が可能である点である．</li>
</ul>
<p>という２点があり，Bayesian / Frequentist 双対性の背後に隠れているものと似ている．</p>
</section>
<section id="最適化-シミュレーションの双対性" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="最適化-シミュレーションの双対性"><span class="header-section-number">2.2</span> 最適化-シミュレーションの双対性</h3>
<p>積分は変分近似を通じて最適化問題としても解けるし，Lengevin 法や HMC などの最適化手法は積分問題を解ける．</p>
<p>また，最適化問題は simulated annealing <span class="citation" data-cites="Kirkpartick+1983">(Kirkpartick et al., 1983)</span> を通じてサンプリング問題としても解ける．</p>
</section>
</section>
<section id="bayesian-computation-に賭ける思い" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="bayesian-computation-に賭ける思い"><span class="header-section-number">3</span> Bayesian Computation に賭ける思い</h2>
<p>もしかしたら，MCMC はシミュレーションで，SMC はコンピューテーションであるというべきなのかも知れない．前者の活躍の場は，誕生から革新まで，ずっと物理学と物質科学にイニシアティブがあった．後者は防衛目的をはじめとした computer vision の文脈から生まれ，現在も機械学習など計算機方面の応用と親和性が高い．</p>
<p>２つは粒子 (particle) というキーワードでつながり合っており，２大ベイズ計算手法として双璧をなしている．</p>
<p>この２つのサンプリング手法はきっと相補的な役割を果たしながら，これからも大きく発展して固有の立ち位置を占めることになるだろう．僕をどのような旅に導いてくれるのだろうか．いずれにしろ，たくさんの人と関わることが出来ると思うと，非常にワクワクするし，良いテーマに出会ったなという感謝の気持ちでいっぱいになる．</p>
<p>この２つの世界樹の上から，自然科学と社会科学，計算機と人間，数学と言葉，どれもバランスよく考え続けることができたらと願っている．</p>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-Feynman1964" class="csl-entry">
Feynman, R. P. (1964). <em>Seeking new laws</em>. <a href="https://www.feynmanlectures.caltech.edu/messenger.html">https://www.feynmanlectures.caltech.edu/messenger.html</a>
</div>
<div id="ref-Ghahramani2015" class="csl-entry">
Ghahramani, Z. (2015). Probabilistic machine learning and artificial intelligence. <em>Nature</em>, <em>521</em>, 452–459. <a href="https://www.nature.com/articles/nature14541">https://www.nature.com/articles/nature14541</a>
</div>
<div id="ref-Griebel+2007" class="csl-entry">
Griebel, M., Zumbusch, G., &amp; Knapek, S. (2007). <em>Numerical simulation in molecular dynamics: Numerics, algorithms, parallelization, applications</em> (Vol. 5). Springer Belin, Heidelberg. <a href="https://link.springer.com/book/10.1007/978-3-540-68095-6">https://link.springer.com/book/10.1007/978-3-540-68095-6</a>
</div>
<div id="ref-Kirkpartick+1983" class="csl-entry">
Kirkpartick, S., Gelatt, C. D., &amp; Vecchi, M. P. (1983). Optimization by simulated annealing. <em>Science</em>, <em>220</em>(4598), 671–680.
</div>
<div id="ref-Liu2004" class="csl-entry">
Liu, J. S. (2004). <em>Monte carlo strategies in scientific computing</em>. Springer New York. <a href="https://doi.org/10.1007/978-0-387-76371-2">https://doi.org/10.1007/978-0-387-76371-2</a>
</div>
<div id="ref-Rapaport2004" class="csl-entry">
Rapaport, D. C. (2004). <em>The art of molecular dynamics simulation</em> (2nd ed.). Cambridge University Press. <a href="https://doi.org/10.1017/CBO9780511816581">https://doi.org/10.1017/CBO9780511816581</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>この違いが「過学習」という現象に見舞われるかの違いでもある．“Fortunately, Bayesian approaches are not prone to this kind of overfitting since they average over, rather than fit, the parameters” <span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 454)</span>．↩︎</p></li>
<li id="fn2"><p>or, variation.↩︎</p></li>
<li id="fn3"><p>“for Bayesian researchers the main computational problem is integration, whereas for much of the rest of the community the focus is on optimization of model parameters.” <span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 454)</span>．↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Computation</category>
  <category>Simulation</category>
  <category>Opinion</category>
  <guid>https://162348.github.io/posts/2024/Computation/AboutSimulation.html</guid>
  <pubDate>Fri, 05 Apr 2024 15:00:00 GMT</pubDate>
  <media:content url="https://162348.github.io/posts/2024/Computation/Files/computation.png" medium="image" type="image/png" height="146" width="144"/>
</item>
<item>
  <title>Peters and de With (2012) Rejection-Free Monte Carlo Sampling for General Potentials</title>
  <dc:creator>司馬博文 </dc:creator>
  <link>https://162348.github.io/posts/2024/Review/Peters-deWith2012.html</link>
  <description><![CDATA[ 





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<section id="概要" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="概要"><span class="header-section-number">1</span> 概要</h2>
<p>統計用語でいう Bouncy Particle Sampler を，Metropolis-Hastings 法の連続時間極限として初めて提案した論文であるが，これが <span class="citation" data-cites="Bouchard-Cote+2018-BPS">(Bouchard-Côté et al., 2018)</span> に発見されるには６年の時間を要した．</p>
<p>これを正準分布からのサンプリング法として導入した <span class="citation" data-cites="Peters-deWith2012">(Peters &amp; de&nbsp;With, 2012)</span> では，この手法を <strong>event-driven rejection-free Monte Carlo</strong> 法と呼ぶ．</p>
<p>連続なポテンシャル <img src="https://latex.codecogs.com/png.latex?E"> を用いることが可能なことが特徴．event-driven アプローチだけでなく，event-chain アプローチ <span class="citation" data-cites="Bernard+2009">(Bernard et al., 2009)</span> での実装も扱った．Lennard-Jones ポテンシャルを持った流体のシミュレーションで検証した．</p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="注">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
注
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>ここでは本質的には連続時間極限をとっているが，直接議論されているのはポテンシャルの細分化の連続極限である．
<ul>
<li><img src="https://latex.codecogs.com/png.latex?U(x(t))"> があったとき，<img src="https://latex.codecogs.com/png.latex?%5CDelta%20U%5Cto0"> の極限を考えているために，実質的に <img src="https://latex.codecogs.com/png.latex?%5CDelta%20t%5Cto0"> を議論している．</li>
</ul></li>
<li>多粒子系のなすカノニカル分布からのサンプリングを考えているため，分布が積の形に分解できることを前提としている．</li>
<li>SEC <span class="citation" data-cites="Bernard+2009">(Bernard et al., 2009)</span> からの改良と読める．</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="関連文献">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
関連文献
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Metropolis 法については</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Review/Metropolis+1953.html" target="_blank">
            <img src="https://162348.github.io/posts/2024/Review/Metropolis+1953.svg" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">Metropolis+ (1953) Equation of State Calculations by Fast Computing Machines</h3>
                <p class="article-description">Metropolis et. al. [The Journal of Chemical Physics 21(1953) 1087-1092] は初の MCMC（乱歩 Metropolis 法）を，対称分布を Gibbs の正準分布として，“modified Monte Carlo scheme” という名前の下で提案した論文である．重点サンプリングを “Monte Carlo method” と呼び，「目標分布から直接サンプルを生成できるために提案分布と目標分布とのズレによる性能劣化がない」ことを美点として挙げている．この手法は後の (Hastings, 1970) による改良と併せて，Metropolis-Hastings 法と呼ばれるようになる．</p>
            </div>
        </a>
    </div>
</div>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Nature/MD.html" target="_blank">
            <img src="https://162348.github.io/posts/2024/Nature/Lennard-Jones.svg" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored">分子動力学法</h3>
                <p class="article-description">物理に寄り添った Monte Carlo 法</p>
            </div>
        </a>
    </div>
</div>
</div>
</div>
</div>
</section>
<section id="導入" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="導入"><span class="header-section-number">2</span> 導入</h2>
<section id="time-driven-から-event-driven-へ" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="time-driven-から-event-driven-へ"><span class="header-section-number">2.1</span> time-driven から event-driven へ</h3>
<p>平衡統計力学に従って粒子系をシミュレーションする際には，MD (molecular dynamics) と MC (Monte Carlo methods) の２つのアプローチがあり得る．</p>
<p>しかし現状，いずれも <span class="citation" data-cites="Metropolis+1953">(Metropolis et al., 1953)</span> の採択-棄却の枠組みで実行されるのが一般的である．</p>
<p>棄却を取り入れた MD 法を，剛体球の系に適用すると，</p>
<ul>
<li>高濃度領域では，タイムステップは小さく取らないと，すぐに他の粒子と重なってしまいやすく，棄却率が高くなる．かといってタイムステップを小さくすると計算量が増大する．</li>
<li>低濃度領域では，タイムスケールは分子の衝突過程に依存するので，シミュレーション時間のほとんどは無駄に使うことになる．</li>
</ul>
<p>という難点がある．</p>
<p>そこで元来 MD 法では，<strong>event-driven</strong> と呼ばれるアプローチが早期に提案された <span class="citation" data-cites="Alder-Wainwright1959">(Alder &amp; Wainwright, 1959)</span>．</p>
<p>実際，このアプローチは，<span class="citation" data-cites="Metropolis+1953">(Metropolis et al., 1953)</span> では叶わなかった，剛体円板系の液相転移のシミュレーションに成功している <span class="citation" data-cites="Alder-Wainwright1962">(Alder &amp; Wainwright, 1962)</span>．<sup>1</sup></p>
<p>従って，Monte Carlo 法の方にも，event-driven なアプローチを取り入れると，大きな効率改善が望めるだろう．</p>
</section>
<section id="ed-md-から改良された点" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="ed-md-から改良された点"><span class="header-section-number">2.2</span> ED-MD から改良された点</h3>
<p>かといって event-driven MD にも難点がある．まず <span class="citation" data-cites="Alder-Wainwright1962">(Alder &amp; Wainwright, 1962)</span> がシミュレーションに成功したのは剛体円板系であり，ポテンシャルは単関数である．</p>
<p>悪いことに，ED-MD はポテンシャルが単関数である場合にまでしか一般化できない．単関数でないと，いつイベントが起こるかが予測できないのである．</p>
<p>しかし本論文で提案する手法は，イベント発生時刻を Poisson 過程でシミュレーションすることにしたので，一般のポテンシャルに適用できる（<a href="../../../posts/2024/Nature/MD.html#sec-effectiveness-of-potentials">分子動力学の稿</a> も参照）．</p>
</section>
<section id="衝突のモデリングには自由度が残る" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="衝突のモデリングには自由度が残る"><span class="header-section-number">2.3</span> 衝突のモデリングには自由度が残る</h3>
<p>提案手法では，Metropolis 的な棄却を実施するのではなく，衝突によって向きを変えるというイベントが起こる．</p>
<p>この衝突のモデリングは，MD 法のように，Newton 力学から衝突の様子をシミュレーションしても良い．</p>
<p>しかし，event-chain Monte Carlo 法 <span class="citation" data-cites="Bernard+2009">(Bernard et al., 2009)</span>, <span class="citation" data-cites="Bernard-Krauth2011">(Bernard &amp; Krauth, 2011)</span> のように，衝突をしたら，衝突を受けた粒子が運動を引き継ぐ，というルールにしても良い．（Monte Carlo 法だから，背後の物理過程に忠実である必要はない．）</p>
</section>
<section id="他のアルゴリズムとの比較" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="他のアルゴリズムとの比較"><span class="header-section-number">2.4</span> 他のアルゴリズムとの比較</h3>
<p>アルゴリズム的には kinetic / dynamic MC <span class="citation" data-cites="Fichthorn-Weinberg1991">(Fichthorn &amp; Weinberg, 1991)</span> <img src="https://latex.codecogs.com/png.latex?n">-fold way MC simulation <span class="citation" data-cites="Bortz+1975">(Bortz et al., 1975)</span> に似て Poisson 過程のシミュレーションに帰着する．</p>
<p>だが上述の手法は，Poisson イベント間は何も起こらないとしている．</p>
<p>一方で本手法は，Poisson イベントをシミュレーションしたのちに，そのイベントの間の粒子系の動きは線形に補間される．</p>
</section>
</section>
<section id="本論" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="本論"><span class="header-section-number">3</span> 本論</h2>
<p>Metropolis scheme のように提案と棄却によって詳細釣り合い条件を満たすのではなく，棄却するところを衝突にすることによって詳細釣り合い条件を達成することを考える．</p>
<p>この状態から連続極限を考えていく．</p>
<p>まず，<img src="https://latex.codecogs.com/png.latex?U"> が階段関数であるとし，<img src="https://latex.codecogs.com/png.latex?q(x,y)"> が提案されたとすると，登った段数の分だけ独立な採択-棄却を実行することで，1回の採択-棄却の手続きを代用できる（ <span class="citation" data-cites="Tartero-Krauth2023">Tartero &amp; Krauth (2023)</span> の consensus 方式）．すなわち，最終的な採択確率は <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%20%20%20%20P_%7B%5Ctext%7Bno-coll%7D%7D(x,y)&amp;=%5Cprod_i1%5Cland%20e%5E%7B-%5Cbeta%5CDelta%20U_i%7D%5C%5C%0A%20%20%20%20&amp;=%5Cexp%5Cleft(-%5Cbeta%5Csum_%7Bi%7D(%5CDelta%20U_i)_+%5Cright)%0A%5Cend%7Balign*%7D%0A"></p>
<p>こうして，連続なポテンシャルを単関数近似して，同様の手続きを実行するアイデアが考えられるが，ここではより洗練された手法を考える．</p>
<p>ポテンシャルのステップ <img src="https://latex.codecogs.com/png.latex?%5CDelta%20U"> が <img src="https://latex.codecogs.com/png.latex?0"> に近づくという連続極限を取ることで，「どの時点まで衝突せずに直進できるか」を計算することに帰着する．例えば時刻 <img src="https://latex.codecogs.com/png.latex?%5Bs,s_0%5D"> の間に衝突しない確率は <img src="https://latex.codecogs.com/png.latex?%0AP_%7B%5Ctext%7Bno-coll%7D%7D(s)=%5Cexp%5Cleft(-%5Cbeta%5Cint_s%5E%7Bs_0%7D(D_t%20U(x(t)))_+dt%5Cright)%0A"> となる．</p>
<p>実際に，衝突する時刻を求めるには，採択-棄却手続きのための一様変数 <img src="https://latex.codecogs.com/png.latex?u%5Csim%5Cmathrm%7BU%7D(%5B0,1%5D)"> を取り，これに対して <img src="https://latex.codecogs.com/png.latex?u=P_%7B%5Ctext%7Bno-coll%7D%7D(s)"> を満たす時刻 <img src="https://latex.codecogs.com/png.latex?s"> を計算すれば良いのである： <img src="https://latex.codecogs.com/png.latex?%0A-k_BT%5Clog%20u=%5Cint%5Es_%7Bs_0%7D(D_tU(x(t)))_+dt.%0A"></p>
<p>衝突のモデルが，例えば新しい速度 <img src="https://latex.codecogs.com/png.latex?v"> を「対称」に決めるようなものであったならば，この手法は対称な手法で詳細釣り合い条件を満たす．ここら辺も evnet-chain Monte Carlo <span class="citation" data-cites="Bernard+2009">(Bernard et al., 2009)</span> に似ている．</p>
</section>
<section id="多粒子系での実装" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="多粒子系での実装"><span class="header-section-number">4</span> 多粒子系での実装</h2>
<p>ポテンシャル <img src="https://latex.codecogs.com/png.latex?U=%5Csum_%7B%5Calpha%5Cin%5CLambda%7DU_%5Calpha"> を持つ多粒子系を考え，衝突規則とその実装の例を提示している．</p>
<p>このとき，粒子の速度 <img src="https://latex.codecogs.com/png.latex?v"> を何かしらの分布に従って refresh するとしているが，これは ECMC <span class="citation" data-cites="Bernard+2009">(Bernard et al., 2009)</span> の名残だろう．</p>
<p>実際，Appendix にて，動力学の不変分布が Boltzmann-Gibbs 分布になっていることが示されており，refresh は必要ないことが注記されている．</p>
<p>また，ここで例示されているアルゴリズムは対称な MCMC を定めるとしているのも懸念点の１つである．</p>
</section>
<section id="議論" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="議論"><span class="header-section-number">5</span> 議論</h2>
<p>３粒子以上が関与するポテンシャルに関しても自然に拡張でき，これが SEC <span class="citation" data-cites="Bernard+2009">(Bernard et al., 2009)</span> にはない美点である．</p>
<p>MD よりも効率的であることは理論的には示していないが，実験的にはそう予想される．</p>
<blockquote class="blockquote">
<p>It remains to be seen if the application of the method is suited for niche applications only or if it can rival with MD and Metropolis-MC for general purpose molecular simulations.</p>
</blockquote>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-Alder-Wainwright1959" class="csl-entry">
Alder, B. J., &amp; Wainwright, T. E. (1959). <span class="nocase">Studies in Molecular Dynamics. I. General Method</span>. <em>The Journal of Chemical Physics</em>, <em>31</em>(2), 459–466. <a href="https://doi.org/10.1063/1.1730376">https://doi.org/10.1063/1.1730376</a>
</div>
<div id="ref-Alder-Wainwright1962" class="csl-entry">
Alder, B. J., &amp; Wainwright, T. E. (1962). Phase transition in elastic disks. <em>Phys. Rev.</em>, <em>127</em>, 359–361. <a href="https://doi.org/10.1103/PhysRev.127.359">https://doi.org/10.1103/PhysRev.127.359</a>
</div>
<div id="ref-Bernard-Krauth2011" class="csl-entry">
Bernard, E. P., &amp; Krauth, W. (2011). Two-step melting in two dimensions: First-order liquid-hexatic transition. <em>Phys. Rev. Lett.</em>, <em>107</em>, 155704. <a href="https://doi.org/10.1103/PhysRevLett.107.155704">https://doi.org/10.1103/PhysRevLett.107.155704</a>
</div>
<div id="ref-Bernard+2009" class="csl-entry">
Bernard, E. P., Krauth, W., &amp; Wilson, D. B. (2009). Event-chain monte carlo algorithms for hard-sphere systems. <em>Phys. Rev. E</em>, <em>80</em>, 056704. <a href="https://doi.org/10.1103/PhysRevE.80.056704">https://doi.org/10.1103/PhysRevE.80.056704</a>
</div>
<div id="ref-Bortz+1975" class="csl-entry">
Bortz, A. B., Kalos, M. H., &amp; Lebowitz, J. L. (1975). A new algorithm for monte carlo simulation of ising spin systems. <em>Journal of Computational Physics</em>, <em>17</em>(1), 10–18. https://doi.org/<a href="https://doi.org/10.1016/0021-9991(75)90060-1">https://doi.org/10.1016/0021-9991(75)90060-1</a>
</div>
<div id="ref-Bouchard-Cote+2018-BPS" class="csl-entry">
Bouchard-Côté, A., Vollmer, S. J., &amp; Doucet, A. (2018). The bouncy particle sampler: A nonreversible rejection-free markov chain monte carlo method. <em>Journal of the American Statistical Association</em>, <em>113</em>(522), 855–867. <a href="https://www.tandfonline.com/doi/full/10.1080/01621459.2017.1294075">https://www.tandfonline.com/doi/full/10.1080/01621459.2017.1294075</a>
</div>
<div id="ref-Faulkner-Livingstone2024" class="csl-entry">
Faulkner, M. F., &amp; Livingstone, S. (2024). <span class="nocase">Sampling Algorithms in Statistical Physics: A Guide for Statistics and Machine Learning</span>. <em>Statistical Science</em>, <em>39</em>(1), 137–164. <a href="https://doi.org/10.1214/23-STS893">https://doi.org/10.1214/23-STS893</a>
</div>
<div id="ref-Fichthorn-Weinberg1991" class="csl-entry">
Fichthorn, K. A., &amp; Weinberg, W. H. (1991). <span class="nocase">Theoretical foundations of dynamical Monte Carlo simulations</span>. <em>The Journal of Chemical Physics</em>, <em>95</em>(2), 1090–1096. <a href="https://doi.org/10.1063/1.461138">https://doi.org/10.1063/1.461138</a>
</div>
<div id="ref-Kosterlitz-Thouless1973" class="csl-entry">
Kosterlitz, J. M., &amp; Thouless, D. J. (1973). Ordering, metastability and phase transitions in two-dimensional systems. <em>Journal of Physics C: Solid State Physics</em>, <em>6</em>(7), 1181. <a href="https://doi.org/10.1088/0022-3719/6/7/010">https://doi.org/10.1088/0022-3719/6/7/010</a>
</div>
<div id="ref-Metropolis+1953" class="csl-entry">
Metropolis, N., Rosenbluth, A. W., Rosenbluth, M. N., Teller, A. H., &amp; Teller, E. (1953). Equation of state calculations by fast computing machines. <em>The Journal of Chemical Physics</em>, <em>21</em>(6), 1087–1092. <a href="https://doi.org/10.1063/1.1699114">https://doi.org/10.1063/1.1699114</a>
</div>
<div id="ref-Nemeth-Fearnhead2021" class="csl-entry">
Nemeth, C., &amp; Fearnhead, P. (2021). Stochastic gradient markov chain monte carlo. <em>Journal of the American Statistical Association</em>, <em>116</em>(533), 433–450. <a href="https://www.tandfonline.com/doi/full/10.1080/01621459.2020.1847120">https://www.tandfonline.com/doi/full/10.1080/01621459.2020.1847120</a>
</div>
<div id="ref-Peters-deWith2012" class="csl-entry">
Peters, E. A. J. F., &amp; de&nbsp;With, G. (2012). Rejection-free monte carlo sampling for general potentials. <em>Physical Review E</em>, <em>85</em>(2). <a href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.85.026703">https://journals.aps.org/pre/abstract/10.1103/PhysRevE.85.026703</a>
</div>
<div id="ref-Tartero-Krauth2023" class="csl-entry">
Tartero, G., &amp; Krauth, W. (2023). <em>Concepts in monte carlo sampling</em>. <a href="https://arxiv.org/abs/2309.03136">https://arxiv.org/abs/2309.03136</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>そしてこの発見は，<span class="citation" data-cites="Kosterlitz-Thouless1973">(Kosterlitz &amp; Thouless, 1973)</span> による液相転移の「２段階モデル」の理論が生まれるきっかけとなった． <span class="citation" data-cites="Faulkner-Livingstone2024">(Faulkner &amp; Livingstone, 2024, p. 15)</span> 4.3 節も参照．↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Review</category>
  <guid>https://162348.github.io/posts/2024/Review/Peters-deWith2012.html</guid>
  <pubDate>Fri, 05 Apr 2024 15:00:00 GMT</pubDate>
  <media:content url="https://162348.github.io/posts/2024/Review/Peters-deWith2012.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>Butkovsky and Veretennikov (2013) On Asymptotics for Vaserstein Coupling of Markov Chains</title>
  <dc:creator>司馬博文 </dc:creator>
  <link>https://162348.github.io/posts/2024/Review/Butkovsky-Veretennikov2013.html</link>
  <description><![CDATA[ 





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<section id="概要" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="概要"><span class="header-section-number">1</span> 概要</h2>
<ul>
<li>マルチンゲールによる導出</li>
<li>Lyapunov 型の条件が簡単に十分条件を与えるような，再帰時刻による取り扱い</li>
</ul>
<p><span class="citation" data-cites="Kulik2018">(Kulik, 2018, pp. 45–45)</span> では，安定性の定理の証明に，マルチンゲールを用いた議論を用いている．エルゴード性を持つ Markov 連鎖は必ず</p>
<ol type="1">
<li>局所的な集合上で良い攪拌性を持ち，</li>
<li>その他の点に行ってしまった場合でも，「十分早く」その局所的な集合に戻ってくる</li>
</ol>
<p>という２つのモードを持つ．これを別々に解析する見通しの良い議論を与えてくれるのがマルチンゲールによる議論であるとしている <span class="citation" data-cites="Kulik2018">(Kulik, 2018, p. 71)</span> が，似たような議論をしているのが本論文 <span class="citation" data-cites="Butkovsky-Veretennikov2013">(Butkovsky &amp; Veretennikov, 2013)</span> である．<sup>1</sup></p>
</section>
<section id="背景" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="背景"><span class="header-section-number">2</span> 背景</h2>
<ul>
<li><p>一様エルゴード性を <strong>strongly ergodic</strong> とも呼んでいる： <img src="https://latex.codecogs.com/png.latex?%0A%5Csup_%7Bx%5Cin%20E%7D%5C%7CP%5En(x,-)-%5Cpi%5C%7C_%5Cmathrm%7BTV%7D%5Cle%20Ce%5E%7B-%5Clambda%20n%7D.%0A"></p></li>
<li><p>一方で，各点 <img src="https://latex.codecogs.com/png.latex?x%5Cin%20E"> で <img src="https://latex.codecogs.com/png.latex?%0A%5C%7CP%5En(x,-)-%5Cpi%5C%7C_%5Cmathrm%7BTV%7D%5Cto0%0A"> が成り立つことを <strong>weakly ergodic</strong> と呼んでいる．</p></li>
</ul>
<p>本論文では，<img src="https://latex.codecogs.com/png.latex?%5Clambda"> を推定する <span class="citation" data-cites="Diaconis-Stroock1991">(Diaconis &amp; Stroock, 1991)</span> 理論を，weakly ergodic の場合と非対称な場合に拡張する．</p>
<p>すると，<span class="citation" data-cites="Diaconis-Stroock1991">(Diaconis &amp; Stroock, 1991)</span> 理論では遷移確率核 <img src="https://latex.codecogs.com/png.latex?P"> のスペクトルギャップであった <img src="https://latex.codecogs.com/png.latex?%5Clambda"> は，一般の設定の下でもある一般化した半群生成作用素のスペクトル半径に関係することがわかった．</p>
<section id="diaconis-stroock1991-理論" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="diaconis-stroock1991-理論"><span class="header-section-number">2.1</span> <span class="citation" data-cites="Diaconis-Stroock1991">(Diaconis &amp; Stroock, 1991)</span> 理論</h3>
<p>一様エルゴード性の収束速度 <img src="https://latex.codecogs.com/png.latex?%5Clambda"> を定量化するアプローチの１つ．</p>
<div class="callout callout-style-default callout-tip callout-titled" title="定理">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定理
</div>
</div>
<div class="callout-body-container callout-body">
<p>有限状態空間 <img src="https://latex.codecogs.com/png.latex?E"> 上の <img src="https://latex.codecogs.com/png.latex?P">-一様 Markov 連鎖は，既約かつ対称ならば， <img src="https://latex.codecogs.com/png.latex?%0A%5Clambda%3C%5Clog%5Coperatorname%7BGap%7D(P)%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BGap%7D(P):=%5Cmax%5Cleft%5C%7B%5Clvert%5Clambda%5Crvert%5Cin%5Cmathbb%7BR%7D_+%5Cmid%201%3E%5Clambda%5Cin%5Cmathrm%7BSp%7D(P)%5Cright%5C%7D%0A"></p>
</div>
</div>
<ul>
<li>対称ならば <img src="https://latex.codecogs.com/png.latex?P=P%5E*">．</li>
<li>スペクトルギャップは一般の正作用素に定義できる．</li>
</ul>
</section>
<section id="vaserstein1969-による最適カップリングの構成" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="vaserstein1969-による最適カップリングの構成"><span class="header-section-number">2.2</span> <span class="citation" data-cites="Vaserstein1969">(Vaserstein, 1969)</span> による最適カップリングの構成</h3>
<p>これを一般化したという．</p>
<p>最適な Markov カップリングよりも，カップリング確率が高いカップリングがあるらしい（しかし Markov にならない）．<a href="../../../posts/2024/Process/Coupling.html">この稿</a> に書いた．</p>
</section>
<section id="lyapunov-型の条件" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="lyapunov-型の条件"><span class="header-section-number">2.3</span> Lyapunov 型の条件</h3>
<p><span class="citation" data-cites="Douc+2004">(Douc et al., 2004)</span>, <span class="citation" data-cites="Kalashinikov1973">(Kalashinikov, 1973)</span>, <span class="citation" data-cites="Lamperti1960">(Lamperti, 1960)</span>, <span class="citation" data-cites="Rosenthal2002">(Rosenthal, 2002)</span>, <span class="citation" data-cites="Tweedie1981">(Tweedie, 1981)</span> による．</p>
</section>
</section>
<section id="本論" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="本論"><span class="header-section-number">3</span> 本論</h2>
<section id="カップリング補題" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="カップリング補題"><span class="header-section-number">3.1</span> カップリング補題</h3>
<p>本論に入る前に，次の結果を準備している：</p>
<div class="callout callout-style-default callout-tip callout-titled" title="補題（カップリング不等式の評価）^[[@Butkovsky-Veretennikov2013 pp.3521-22] 補題2.2]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
補題（カップリング不等式の評価）<sup>2</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?X_1,X_2"> を確率核 <img src="https://latex.codecogs.com/png.latex?P"> を持つ Markov 連鎖，<img src="https://latex.codecogs.com/png.latex?Z=(X_1,X_2)"> をその最適 Markov カップリングを <img src="https://latex.codecogs.com/png.latex?%0AX_n%5E1=:%5Cxi_n1_%7B%5Cleft%5C%7B%5Czeta_n=0%5Cright%5C%7D%7D+%5Ceta_n%5E11_%7B%5Cleft%5C%7B%5Czeta_n=1%5Cright%5C%7D%7D%0A"> <img src="https://latex.codecogs.com/png.latex?%0AX_n%5E2=:%5Cxi_n1_%7B%5Cleft%5C%7B%5Czeta_n=0%5Cright%5C%7D%7D+%5Ceta_n%5E21_%7B%5Cleft%5C%7B%5Czeta_n=1%5Cright%5C%7D%7D%0A"> とする．このとき， <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BP%7D%5BX_n%5E1%5Cne%20X_n%5E2%5D%5Cle%5Cbiggr(1-p_0%5Cbiggl)%5Coperatorname%7BE%7D%5Cleft%5B%5Cprod_%7Bk=0%7D%5E%7Bn-1%7D%5Cbiggr(1-p(%5Ceta_k%5E1,%5Ceta_k%5E2)%5Cbiggl)%5Cright%5D%0A"> <img src="https://latex.codecogs.com/png.latex?%0Ap(x_1,x_2):=1-%5Cfrac%7B1%7D%7B2%7D%5C%7CP(x_1,-)-P(x_2,-)%5C%7C_%5Cmathrm%7BTV%7D%0A"> <img src="https://latex.codecogs.com/png.latex?%0Ap_0:=1-%5Cfrac%7B1%7D%7B2%7D%5C%7C%5Coperatorname%7BP%7D%5E%7BX_0%5E1%7D-%5Coperatorname%7BP%7D%5E%7BX_0%5E2%7D%5C%7C_%5Cmathrm%7BTV%7D=%5Coperatorname%7BP%7D%5BX_0%5E1=X_0%5E2%5D%0A"> が成り立つ．</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>基本的な考え方は <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Coperatorname%7BP%7D%5BX%5E1_n%5Cne%20X_n%5E2%5D&amp;%5Cle%5Coperatorname%7BP%7D%5B%5Czeta_0=1,%5Czeta_1=1,%5Ccdots,%5Czeta_%7Bn%7D=1%5D%5C%5C%0A%20%20%20%20&amp;=%5Coperatorname%7BE%7D%5B1_%7B%5Cleft%5C%7B%5Czeta_0=1%5Cright%5C%7D%7D1_%7B%5Cleft%5C%7B%5Czeta_1=1%5Cright%5C%7D%7D%5Ccdots1_%7B%5Cleft%5C%7B%5Czeta_%7Bn%7D=1%5Cright%5C%7D%7D%5D%0A%5Cend%7Balign*%7D%0A"> である．これは，<img src="https://latex.codecogs.com/png.latex?X_n%5E1%5Cne%20X_n%5E2"> ならば <img src="https://latex.codecogs.com/png.latex?%5Czeta_n=1"> が必要であるため， <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Cleft%5C%7BX_n%5E1%5Cne%20X_n%5E2%5Cright%5C%7D&amp;%5Csubset%5Cleft%5C%7B%5Czeta_n=1%5Cright%5C%7D%5C%5C%0A%20%20%20%20&amp;=%5Cleft%5C%7B%5Czeta_0=1,%5Czeta_1=1,%5Ccdots,%5Czeta_%7Bn%7D=1%5Cright%5C%7D%0A%5Cend%7Balign*%7D%0A"> であるが，逆は必ずしも成り立たないためである．</p>
<p>これに，<img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_n:=%5Csigma%5BX_n%5E1,X_n%5E2%5D"> について， <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%20%20%20%20&amp;%5Coperatorname%7BE%7D%5Cleft%5B%5Cprod_%7Bi=k%7D%5En1_%7B%5Cleft%5C%7B%5Czeta_i=1%5Cright%5C%7D%7D%5C,%5Cmiddle%7C%5C,%5Cmathcal%7BF%7D_%7Bk-1%7D%5Cright%5D%5C%5C%0A%20%20%20%20&amp;=%5Coperatorname%7BE%7D%5Cleft%5B%5Cprod_%7Bi=k-1%7D%5E%7Bn-1%7D%5Cbiggr(1-p(%5Ceta%5E1_i,%5Ceta_i%5E2)%5Cbiggl)%5C,%5Cmiddle%7C%5C,%5Cmathcal%7BF%7D_%7Bk-1%7D%5Cright%5D1_%7B%5Cleft%5C%7B%5Czeta_%7Bk-1%7D=1%5Cright%5C%7D%7D%0A%5Cend%7Balign*%7D%0A"> の <img src="https://latex.codecogs.com/png.latex?k=1"> の場合を併せて結論を得る．この等式自体は降下法により示す．</p>
<p><img src="https://latex.codecogs.com/png.latex?k=n"> の場合の式 <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BE%7D%5B1_%7B%5Cleft%5C%7B%5Czeta_n=1%5Cright%5C%7D%7D%5C,%7C%5C,%5Cmathcal%7BF%7D_%7Bn-1%7D%5D=%5Cbiggr(1-p(%5Ceta_%7Bn-1%7D%5E1,%5Ceta_%7Bn-1%7D%5E2)%5Cbiggl)1_%7B%5Cleft%5C%7B%5Czeta_%7Bn-1%7D=1%5Cright%5C%7D%7D%0A"> は明らかである．<img src="https://latex.codecogs.com/png.latex?k%3Cn"> の場合，帰納法の仮定と，<img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_%7Bk-1%7D"> の下で <img src="https://latex.codecogs.com/png.latex?%5Czeta_k"> と <img src="https://latex.codecogs.com/png.latex?(%5Ceta_k%5E1,%5Ceta_k%5E2)"> は条件付き独立であるから，次のように式変形できる： <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%20%20%20%20&amp;%5Cquad%5Coperatorname%7BE%7D%5Cleft%5B%5Cprod_%7Bi=k%7D%5En1_%7B%5Cleft%5C%7B%5Czeta_i=1%5Cright%5C%7D%7D%5C,%5Cmiddle%7C%5C,%5Cmathcal%7BF%7D_%7Bk-1%7D%5Cright%5D%5C%5C%0A%20%20%20%20&amp;=%5Coperatorname%7BE%7D%5Cleft%5B1_%7B%5Cleft%5C%7B%5Czeta_k=1%5Cright%5C%7D%7D%5Coperatorname%7BE%7D%5Cleft%5B%5Cprod_%7Bi=k+1%7D%5En1_%7B%5Cleft%5C%7B%5Czeta_i=1%5Cright%5C%7D%7D%5C,%5Cmiddle%7C%5C,%5Cmathcal%7BF%7D_k%5Cright%5D%5C,%5Cmiddle%7C%5C,%5Cmathcal%7BF%7D_%7Bk-1%7D%5Cright%5D%5C%5C%0A%20%20%20%20&amp;=%5Coperatorname%7BE%7D%5Cleft%5B1_%7B%5Cleft%5C%7B%5Czeta_k=1%5Cright%5C%7D%7D%5Coperatorname%7BE%7D%5Cleft%5B%5Cprod_%7Bi=k%7D%5E%7Bn-1%7D%5Cbiggr(1-p(%5Ceta%5E1_i,%5Ceta%5E2_i)%5Cbiggl)%5C,%5Cmiddle%7C%5C,%5Cmathcal%7BF%7D_k%5Cright%5D%5C,%5Cmiddle%7C%5C,%5Cmathcal%7BF%7D_%7Bk-1%7D%5Cright%5D%5C%5C%0A%20%20%20%20&amp;=%5Coperatorname%7BE%7D%5B1_%7B%5Cleft%5C%7B%5Czeta_k=1%5Cright%5C%7D%7D%5C,%7C%5C,%5Cmathcal%7BF%7D_%7Bk-1%7D%5D%5Coperatorname%7BE%7D%5Cleft%5B%5Cprod_%7Bi=k%7D%5E%7Bn-1%7D%5Cbiggr(1-p(%5Ceta%5E1_i,%5Ceta%5E2_i)%5Cbiggl)%5C,%5Cmiddle%7C%5C,%5Cmathcal%7BF%7D_%7Bk-1%7D%5Cright%5D%5C%5C%0A%20%20%20%20&amp;=1_%7B%5Cleft%5C%7B%5Czeta_%7Bk-1%7D=1%5Cright%5C%7D%7D%5Cbiggr(1-p(%5Ceta%5E1_%7Bk-1%7D,%5Ceta%5E2_%7Bk-1%7D)%5Cbiggl)%5Coperatorname%7BE%7D%5Cleft%5B%5Cprod_%7Bi=k%7D%5E%7Bn-1%7D%5Cbiggr(1-p(%5Ceta%5E1_i,%5Ceta%5E2_i)%5Cbiggl)%5C,%5Cmiddle%7C%5C,%5Cmathcal%7BF%7D_%7Bk-1%7D%5Cright%5D%5C%5C%0A%20%20%20%20&amp;=1_%7B%5Cleft%5C%7B%5Czeta_%7Bk-1%7D=1%5Cright%5C%7D%7D%5Coperatorname%7BE%7D%5Cleft%5B%5Cprod_%7Bi=k-1%7D%5E%7Bn-1%7D%5Cbiggr(1-p(%5Ceta%5E1_i,%5Ceta%5E2_i)%5Cbiggl)%5C,%5Cmiddle%7C%5C,%5Cmathcal%7BF%7D_%7Bk-1%7D%5Cright%5D%5C%5C%0A%5Cend%7Balign*%7D%0A"></p>
</div>
</div>
</div>
<p>この補題により，確率核 <img src="https://latex.codecogs.com/png.latex?P"> を共有する２つの Markov 過程 <img src="https://latex.codecogs.com/png.latex?(X_n%5E1),(X_n%5E2)"> が与えられたとき，これらのカップリング <img src="https://latex.codecogs.com/png.latex?(%5Cwidetilde%7BX%7D%5E1_n),(%5Cwidetilde%7BX%7D%5E2_n)"> を同一の確率空間 <img src="https://latex.codecogs.com/png.latex?(%5COmega,%5Cmathcal%7BF%7D,%5Coperatorname%7BP%7D)"> 上に構成し，<img src="https://latex.codecogs.com/png.latex?(%5Cwidetilde%7BX%7D_n%5E1)%5Coverset%7B%5Ctext%7Bd%7D%7D%7B=%7D(X_n%5E1),(%5Cwidetilde%7BX%7D_n%5E2)%5Coverset%7B%5Ctext%7Bd%7D%7D%7B=%7D(X_n%5E2)"> であるが，全変動距離を <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BP%7D"> によって評価できるようになる．</p>
</section>
<section id="スペクトルギャップによる一様エルゴード速度" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="スペクトルギャップによる一様エルゴード速度"><span class="header-section-number">3.2</span> スペクトルギャップによる一様エルゴード速度</h3>
<p>次の積分作用素 <img src="https://latex.codecogs.com/png.latex?A:%5Cmathcal%7BL%7D_b(E%5E2)%5Cto%5Cmathcal%7BL%7D_b(E%5E2)"> を考える： <img src="https://latex.codecogs.com/png.latex?%0AAf(x):=%5Cbiggr(1-p(x)%5Cbiggl)%5Coperatorname%7BE%7D%5Bf(%5Ceta_1)%5C,%7C%5C,%5Ceta_0=x%5D%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Ceta_i=%5Cbegin%7Bpmatrix%7D%5Ceta_i%5E1%5C%5C%5Ceta_i%5E2%5Cend%7Bpmatrix%7D,%5Cquad%20x=%5Cbegin%7Bpmatrix%7Dx%5E1%5C%5Cx%5E2%5Cend%7Bpmatrix%7D.%0A"> このスペクトル半径 <img src="https://latex.codecogs.com/png.latex?%0Ar(A):=%5Climsup_%7Bn%5Cto%5Cinfty%7D%5Csqrt%5Bn%5D%7B%5C%7CA%5En%5C%7C%7D%0A"> が一様エルゴード性を引き起こすのである．</p>
<div class="callout callout-style-default callout-caution callout-titled" title="証明の概略">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明の概略
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>なお，この定義式は，後述の <img src="https://latex.codecogs.com/png.latex?r(A)%5Cle1"> と併せると，任意の <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%3E0"> に対して，ある <img src="https://latex.codecogs.com/png.latex?C%3E0"> が存在して，<img src="https://latex.codecogs.com/png.latex?r(A)%5Cle%20r(A)%5E%7B1-%5Cepsilon%7D"> であるから， <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%20%20%20%20%5C%7CA%5En%5C%7C&amp;%5Cle%20C%5Cleft(r(A)%5E%7B1-%5Cepsilon%7D%5Cright)%5En%5C%5C%0A%20%20%20%20&amp;=Ce%5E%7Bn(1-%5Cepsilon)%5Clog%20r(A)%7D%5C%5C%0A%20%20%20%20&amp;=Ce%5E%7B-n(1-%5Cepsilon)%5Clog%5Clvert%20r(A)%5Crvert%7D%0A%5Cend%7Balign*%7D%0A"> を含意することに注意．</p>
<p>実は次の定理の証明は，次の不等式を導いているのみである： <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B1%7D%7B2%7D%5C%7CP%5En(x,-)-P%5En(y,-)%5C%7C_%5Cmathrm%7BTV%7D%5Cle%5C%7CA%5E%7Bn%7D%5C%7C.%0A"></p>
<p>この２式より，直ちに証明が完成する．</p>
</div>
</div>
</div>
<p>ただし，作用素ノルム <img src="https://latex.codecogs.com/png.latex?%5C%7CA%5En%5C%7C"> は任意の <img src="https://latex.codecogs.com/png.latex?%5C%7C1%5C%7C=1"> を満たす関数ノルムに関して構成して良い．<img src="https://latex.codecogs.com/png.latex?C_b(E%5E2)"> を考えることも有用である．</p>
<p>いずれにしろ， <img src="https://latex.codecogs.com/png.latex?%0A%5C%7CA%5C%7C_%5Cinfty=1-%5Cinf_%7Bx%5Cin%20E%5E2%7Dp(x)%5Cle1%0A"> という条件式は変わらない．作用素ノルムの劣乗法性から <img src="https://latex.codecogs.com/png.latex?%0Ar(A)=%5Climsup_%7Bn%5Cto%5Cinfty%7D%5Csqrt%5Bn%5D%7B%5C%7CA%5En%5C%7C_%5Cinfty%7D%5Cle%5C%7CA%5C%7C_%5Cinfty%5Cle1%0A"> であることに注意．</p>
<div class="callout callout-style-default callout-tip callout-titled" title="定理^[[@Butkovsky-Veretennikov2013] 定理2.1．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定理<sup>3</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><img src="https://latex.codecogs.com/png.latex?A:%5Cmathcal%7BL%7D_b(E%5E2)%5Cto%5Cmathcal%7BL%7D_b(E%5E2)"> は有界作用素であり，<img src="https://latex.codecogs.com/png.latex?r(A)%5Cle1"> を満たす．</li>
<li><img src="https://latex.codecogs.com/png.latex?r(A)%3C1"> ならば，<img src="https://latex.codecogs.com/png.latex?X"> はただ一つの不変確率測度を持ち，任意の <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%3E0"> に対して，初期分布 <img src="https://latex.codecogs.com/png.latex?X_0%5E1,X_0%5E2"> に依らないある <img src="https://latex.codecogs.com/png.latex?C%3E0"> が存在して， <img src="https://latex.codecogs.com/png.latex?%0A%5C%7C%5Coperatorname%7BP%7D%5E%7BX_n%5E1%7D-%5Coperatorname%7BP%7D%5E%7BX_n%5E2%7D%5C%7C_%5Cmathrm%7BTV%7D%5Cle%20C(1-p_0)e%5E%7B-n%5Clvert%5Clog%20r(A)%5Crvert(1-%5Cepsilon)%7D.%0A"></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>一般に，任意の <img src="https://latex.codecogs.com/png.latex?f%5Cin%5Cmathcal%7BL%7D_b(E%5E2)"> に対して，<img src="https://latex.codecogs.com/png.latex?(%5Ceta_k)"> のMarkov性より， <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Coperatorname%7BE%7D%5Cleft%5Bf(%5Ceta_n)%5Cprod_%7Bi=0%7D%5E%7Bn-1%7D%5Cbiggr(1-p(%5Ceta_i)%5Cbiggl)%5Cright%5D&amp;=%5Coperatorname%7BE%7D%5Cleft%5B%5Coperatorname%7BE%7D%5Cleft%5Bf(%5Ceta_n)%5Cprod_%7Bi=0%7D%5E%7Bn-1%7D%5Cbiggr(1-p(%5Ceta_i)%5Cbiggl)%5C,%5Cmiddle%7C%5C,%5Ceta_0,%5Ccdots,%5Ceta_%7Bn-1%7D%5Cright%5D%5Cright%5D%5C%5C%0A%20%20%20%20&amp;=%5Coperatorname%7BE%7D%5Cleft%5B%5Cprod_%7Bi=0%7D%5E%7Bn-2%7D%5Cbiggr(1-p(%5Ceta_i)%5Cbiggl)%5Ccdot%5Cbiggr(1-p(%5Ceta_%7Bn-1%7D)%5Cbiggl)%5Coperatorname%7BE%7D%5Bf(%5Ceta_n)%5C,%7C%5C,%5Ceta_%7Bn-1%7D%5D%5Cright%5D%5C%5C%0A%20%20%20%20&amp;=%5Coperatorname%7BE%7D%5Cleft%5B%5Cprod_%7Bi=0%7D%5E%7Bn-2%7D%5Cbiggr(1-p(%5Ceta_i)%5Cbiggl)%5Ccdot%20Af(%5Ceta_%7Bn-1%7D)%5Cright%5D=%5Coperatorname%7BE%7D%5BA%5Enf(%5Ceta_0)%5D.%0A%5Cend%7Balign*%7D%0A"> これより，<img src="https://latex.codecogs.com/png.latex?%5Cleft%5C%7B%5Ceta_n=0%5Cright%5C%7D%5Csupset%5Cleft%5C%7B%5Cprod_%7Bk=0%7D%5E%7Bn-1%7D%5Cbiggr(1-p(Z_k)%5Cbiggl)=0%5Cright%5C%7D"> に注意すれば，次の評価を得る： <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%20%20%20%20%5C%7CP%5En(x,-)-P%5En(y,-)%5C%7C_%5Cmathrm%7BTV%7D&amp;%5Cle2%5Coperatorname%7BP%7D_%7B(x,y)%7D%5EQ%5BX_n%5Cne%20Y_n%5D%5Cle2%5Coperatorname%7BE%7D_%7B(x,y)%7D%5E%7BQ_%5Cperp%7D%5Cleft%5B%5Cprod_%7Bk=0%7D%5E%7Bn-1%7D%5Cbiggr(1-p(Z_k)%5Cbiggl)%5Cright%5D%5C%5C%0A%20%20%20%20&amp;=2%5Coperatorname%7BE%7D_%7B(x,y)%7D%5E%7BQ_%5Cperp%7D%5Cleft%5B%5Cdelta_1(%5Ceta_n)%5Cprod_%7Bk=0%7D%5E%7Bn-1%7D%5Cbiggr(1-p(Z_k)%5Cbiggl)%5Cright%5D=2%5Coperatorname%7BE%7D_%7B(x,y)%7D%5E%7BQ_%5Cperp%7D%5BA%5E%7Bn-1%7D%5Cdelta_1(%5Ceta_1)%5D(1-p(%5Ceta_0))%5C%5C%0A%20%20%20%20&amp;%5Cle2%5Cdelta_%7Bx,y%7D%5C%7CA%5E%7Bn-1%7D%5C%7C_%5Cinfty%0A%5Cend%7Balign*%7D%0A"> よって，<img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B2%7D%5C%7CP%5En(x,-)-P%5En(y,-)%5C%7C"> はちょうど作用素ノルム <img src="https://latex.codecogs.com/png.latex?%5C%7CA%5E%7Bn-1%7D%5C%7C"> を評価する問題に帰着する．</p>
</div>
</div>
</div>
</section>
<section id="再帰性と非一様エルゴード速度" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="再帰性と非一様エルゴード速度"><span class="header-section-number">3.3</span> 再帰性と非一様エルゴード速度</h3>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5C%7CA%5C%7C_%5Cinfty=1-%5Cinf_%7Bx%5Cin%20E%5E2%7Dp(x)=1%0A"> の場合に当たるものであるが， <img src="https://latex.codecogs.com/png.latex?%0AK(%5Cepsilon):=%5Cleft%5C%7Bx%5Cin%20E%5E2%5Cmid%20p(x)%5Cge%5Cepsilon%5Cright%5C%7D%0A"> に無限回再帰するとき，その頻度に依存して，指数的か多項式的か決まる．<sup>4</sup> この頻度は，次の帰着時間 <img src="https://latex.codecogs.com/png.latex?%5Ctau%5EB,T%5EB"> の積率条件で記述される： <img src="https://latex.codecogs.com/png.latex?%0A%5Ctau%5EB:=%5Cinf%5Cleft%5C%7Bn%5Cge%201%5Cmid%5Ceta_n%5Cin%20B%5Cright%5C%7D%0A"> <img src="https://latex.codecogs.com/png.latex?%0AT%5EB:=%5Cinf%5Cleft%5C%7Bn%5Cge%201%5Cmid(X_n%5E1,X_n%5E2)%5Cin%20B%5Cright%5C%7D%0A"> ただし，<img src="https://latex.codecogs.com/png.latex?B%5Cin%5Cmathcal%7BE%7D%5E%7B%5Cotimes2%7D">．</p>
<div class="callout callout-style-default callout-tip callout-titled" title="命題2.1">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題2.1
</div>
</div>
<div class="callout-body-container callout-body">
<p>ある <img src="https://latex.codecogs.com/png.latex?%5Cepsilon,%5Clambda,M%3E0"> と <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BE%7D%5E%7B%5Cotimes2%7D%5Cni%20B%5Csubset%20K(%5Cepsilon)"> について，次が成り立つとする：</p>
<ol type="1">
<li><img src="https://latex.codecogs.com/png.latex?Q:=%5Coperatorname%7BE%7D%5Be%5E%7B%5Clambda%5Ctau%5EB%7D%5D%3C%5Cinfty">．</li>
<li>任意の <img src="https://latex.codecogs.com/png.latex?x%5Cin%20B"> について，<img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BE%7D_x%5Be%5E%7B%5Clambda%5Ctau%5EB%7D%5D%5Cle%20M">．</li>
</ol>
<p>このとき，<img src="https://latex.codecogs.com/png.latex?X"> はただ一つの不変確率測度 <img src="https://latex.codecogs.com/png.latex?%5Cpi"> をもち，またある初期分布 <img src="https://latex.codecogs.com/png.latex?(X_0%5E1,X_0%5E2)"> に依らない <img src="https://latex.codecogs.com/png.latex?C%3E0"> が存在して， <img src="https://latex.codecogs.com/png.latex?%0A%5C%7C%5Coperatorname%7BP%7D%5E%7BX_n%5E1%7D-%5Coperatorname%7BP%7D%5E%7BX_n%5E2%7D%5C%7C_%5Cmathrm%7BTV%7D%5Cle%20CQe%5E%7B-n%5Ctheta%7D%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Ctheta:=%5Cfrac%7B%5Clvert%5Clog(1-%5Cepsilon)%5Crvert%5Clambda%7D%7B%5Clog%20M+%5Clvert%5Clog(1-%5Cepsilon)%5Crvert%7D%0A"></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="定理2.2">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定理2.2
</div>
</div>
<div class="callout-body-container callout-body">
<p>ある <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%3E0,%5Clambda%3E0,M%3E0,%5Cmathcal%7BE%7D%5E%7B%5Cotimes2%7D%5Cni%20B%5Csubset%20K(%5Cepsilon)"> について，次が成り立つとする：</p>
<ol type="1">
<li><img src="https://latex.codecogs.com/png.latex?Q_2:=%5Coperatorname%7BE%7D%5Be%5E%7B%5Clambda%20T%5EB%7D%5D%3C%5Cinfty">．</li>
<li>任意の <img src="https://latex.codecogs.com/png.latex?x%5Cin%20B%5Csetminus%20K(1)"> について，<img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BE%7D_x%5Be%5E%7B%5Clambda%20T%5EB%7D%5D%3CM">．</li>
</ol>
<p>このとき，過程 <img src="https://latex.codecogs.com/png.latex?X"> はただ一つの不変確率分布 <img src="https://latex.codecogs.com/png.latex?%5Cpi"> をもち，ある初期分布 <img src="https://latex.codecogs.com/png.latex?(X_0%5E1,X_0%5E2)"> に依存しない定数 <img src="https://latex.codecogs.com/png.latex?C%3E0"> が存在して， <img src="https://latex.codecogs.com/png.latex?%0A%5C%7C%5Coperatorname%7BP%7D%5E%7BX_n%5E1%7D-%5Coperatorname%7BP%7D%5E%7BX_n%5E2%7D%5C%7C_%5Cmathrm%7BTV%7D%5Cle%20CQ_2e%5E%7B-n%5Ctheta_1%7D%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Ctheta_1:=%5Cfrac%7B%5Clvert%5Clog(1-%5Cepsilon)%5Crvert%5Clambda%7D%7B%5Clog%20M+3%5Clvert%5Clog(1-%5Cepsilon)%5Crvert%7D.%0A"></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="定理2.3">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定理2.3
</div>
</div>
<div class="callout-body-container callout-body">
<p>ある <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%3E0,%5Clambda%5Cge1,M%3E0,%5Cmathcal%7BE%7D%5E%7B%5Cotimes2%7D%5Cni%20B%5Csubset%20K(%5Cepsilon)"> について，次が成り立つとする：</p>
<ol type="1">
<li><img src="https://latex.codecogs.com/png.latex?Q_3:=%5Coperatorname%7BE%7D%5B(T%5EB)%5E%5Clambda%5D%3C%5Cinfty">．</li>
<li>任意の <img src="https://latex.codecogs.com/png.latex?x%5Cin%20B%5Csetminus%20K(1)"> に対して，<img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BE%7D_x%5B(T%5EB)%5E%5Clambda%5D%3CM">．</li>
</ol>
<p>このとき，過程 <img src="https://latex.codecogs.com/png.latex?X"> はただ一つの不変確率分布 <img src="https://latex.codecogs.com/png.latex?%5Cpi"> をもち，任意の <img src="https://latex.codecogs.com/png.latex?%5Clambda_1%5Cin(0,%5Clambda)"> に対して，ある初期分布 <img src="https://latex.codecogs.com/png.latex?(X_0%5E1,X_0%5E2)"> に依存しない定数 <img src="https://latex.codecogs.com/png.latex?C%3E0"> が存在して， <img src="https://latex.codecogs.com/png.latex?%0A%5C%7C%5Coperatorname%7BP%7D%5E%7BX_n%5E1%7D-%5Coperatorname%7BP%7D%5E%7BX_n%5E2%7D%5C%7C_%5Cmathrm%7BTV%7D%5Cle%20CQ_3n%5E%7B-%5Clambda_1%7D%0A"></p>
</div>
</div>
</section>
</section>
<section id="例" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="例"><span class="header-section-number">4</span> 例</h2>
<p>あ</p>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-Butkovsky-Veretennikov2013" class="csl-entry">
Butkovsky, O. A., &amp; Veretennikov, A. Yu. (2013). On asymptotics for vaserstein coupling of markov chains. <em>Stochastic Processes and Their Applications</em>, <em>123</em>(9), 3518–3541. <a href="https://doi.org/10.1016/j.spa.2013.04.016">https://doi.org/10.1016/j.spa.2013.04.016</a>
</div>
<div id="ref-Diaconis-Stroock1991" class="csl-entry">
Diaconis, P., &amp; Stroock, D. (1991). <span class="nocase">Geometric Bounds for Eigenvalues of Markov Chains</span>. <em>The Annals of Applied Probability</em>, <em>1</em>(1), 36–61. <a href="https://doi.org/10.1214/aoap/1177005980">https://doi.org/10.1214/aoap/1177005980</a>
</div>
<div id="ref-Douc+2004" class="csl-entry">
Douc, R., Moulines, E., &amp; Rosenthal, J. S. (2004). <span class="nocase">Quantitative bounds on convergence of time-inhomogeneous Markov chains</span>. <em>The Annals of Applied Probability</em>, <em>14</em>(4), 1643–1665. <a href="https://doi.org/10.1214/105051604000000620">https://doi.org/10.1214/105051604000000620</a>
</div>
<div id="ref-Durmus+2016" class="csl-entry">
Durmus, A., Fort, G., &amp; Moulines, Éric. (2016). <span class="nocase">Subgeometric rates of convergence in Wasserstein distance for Markov chains</span>. <em>Annales de l’Institut Henri Poincar<span>é</span>, Probabilit<span>é</span>s Et Statistiques</em>, <em>52</em>(4), 1799–1822. <a href="https://doi.org/10.1214/15-AIHP699">https://doi.org/10.1214/15-AIHP699</a>
</div>
<div id="ref-Kalashinikov1973" class="csl-entry">
Kalashinikov, V. V. (1973). <a href="">The property of <img src="https://latex.codecogs.com/png.latex?%5Cgamma">-reflexivity for markov sequences</a>. <em>Soviet Mathematics Doklady</em>, <em>14</em>, 1869–1873.
</div>
<div id="ref-Kulik2018" class="csl-entry">
Kulik, A. (2018). <em>Ergodic behavior of markov processes: With applications to limit theorems</em> (Vol. 67). De Gruyter: Berlin, Boston. <a href="https://doi.org/10.1515/9783110458930">https://doi.org/10.1515/9783110458930</a>
</div>
<div id="ref-Lamperti1960" class="csl-entry">
Lamperti, J. (1960). Criteria for the recurrence or transience of stochastic process. i. <em>Journal of Mathematical Analysis and Applications</em>, <em>1</em>(3), 314–330. https://doi.org/<a href="https://doi.org/10.1016/0022-247X(60)90005-6">https://doi.org/10.1016/0022-247X(60)90005-6</a>
</div>
<div id="ref-Rosenthal2002" class="csl-entry">
Rosenthal, J. (2002). <span class="nocase">Quantitative Convergence Rates of Markov Chains: A Simple Account</span>. <em>Electronic Communications in Probability</em>, <em>7</em>(none), 123–128. <a href="https://doi.org/10.1214/ECP.v7-1054">https://doi.org/10.1214/ECP.v7-1054</a>
</div>
<div id="ref-Tweedie1981" class="csl-entry">
Tweedie, R. L. (1981). Criteria for ergodicity, exponential ergodicity and strong ergodicity of markov processes. <em>Journal of Applied Probability</em>, <em>18</em>(1), 122–130. <a href="http://www.jstor.org/stable/3213172">http://www.jstor.org/stable/3213172</a>
</div>
<div id="ref-Vaserstein1969" class="csl-entry">
Vaserstein, L. N. (1969). Markov processes on countable product spaces describing large systems of automata. <em>Problemy Peredachi Informatsii</em>, <em>5</em>(3), 64–72. <a href="https://www.mathnet.ru/php/archive.phtml?wshow=paper&amp;jrnid=ppi&amp;paperid=1811&amp;option_lang=eng">https://www.mathnet.ru/php/archive.phtml?wshow=paper&amp;jrnid=ppi&amp;paperid=1811&amp;option_lang=eng</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>それと <span class="citation" data-cites="Durmus+2016">(Durmus et al., 2016)</span> を挙げている．↩︎</p></li>
<li id="fn2"><p><span class="citation" data-cites="Butkovsky-Veretennikov2013">(Butkovsky &amp; Veretennikov, 2013, pp. 3521–3522)</span> 補題2.2↩︎</p></li>
<li id="fn3"><p><span class="citation" data-cites="Butkovsky-Veretennikov2013">(Butkovsky &amp; Veretennikov, 2013)</span> 定理2.1．↩︎</p></li>
<li id="fn4"><p>前節から判る通り，局所Dobrushin条件を満たす集合（small set ともいう）上では常に指数収束である．↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Review</category>
  <category>Kernel</category>
  <guid>https://162348.github.io/posts/2024/Review/Butkovsky-Veretennikov2013.html</guid>
  <pubDate>Wed, 03 Apr 2024 15:00:00 GMT</pubDate>
  <media:content url="https://162348.github.io/posts/2024/Review/Butkovsky-Veretennikov2013.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>待ち時間の Markov 過程のエルゴード性</title>
  <dc:creator>司馬博文 </dc:creator>
  <link>https://162348.github.io/posts/2024/Process/ResidualWaitingTime.html</link>
  <description><![CDATA[ 





<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<section id="導入" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="導入"><span class="header-section-number">1</span> 導入</h2>
<section id="markov-過程のエルゴード性" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="markov-過程のエルゴード性"><span class="header-section-number">1.1</span> Markov 過程のエルゴード性</h3>
<p>空間 <img src="https://latex.codecogs.com/png.latex?E"> 上の Markov連鎖は，<img src="https://latex.codecogs.com/png.latex?E"> 上の確率測度の空間 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> 上に力学系 <img src="https://latex.codecogs.com/png.latex?((P%5E*)%5En%5Cmu)_%7Bn%5Cin%5Cmathbb%7BN%7D%7D"> を定める．その不動点 <img src="https://latex.codecogs.com/png.latex?P%5E*%5Cmu=%5Cmu%20P=%5Cmu"> が不変確率分布（平衡分布）である．</p>
<p>これは，Markov 連鎖の <a href="../../../posts/2024/Probability/Kernel.html">確率核</a> <img src="https://latex.codecogs.com/png.latex?P"> の <a href="../../../static/Notations.html#sec-kernels">左作用</a> <img src="https://latex.codecogs.com/png.latex?P:%5Cmathcal%7BL%7D_b(E)%5Cto%5Cmathcal%7BL%7D_b(E)"> の随伴作用素 <img src="https://latex.codecogs.com/png.latex?P%5E*:%5Cmathcal%7BP%7D(E)%5Cto%5Cmathcal%7BP%7D(E)"> が <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(E)"> に作用して得られる力学系ともみれる．</p>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>この力学系 <img src="https://latex.codecogs.com/png.latex?(%5Cmathcal%7BP%7D(E),P%5E*)"> は不動点を持つか？持つならば，どのようなノルムについてどのくらいの速さで収束するか？</p>
</div>
</div>
</div>
<p>これが Markov 連鎖のエルゴード性の議論である．</p>
<p>通常，Markov 過程のエルゴード性は全変動ノルムについて考慮されるが，近年は弱位相に関する議論も進んでいる．</p>
</section>
<section id="再起過程" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="再起過程"><span class="header-section-number">1.2</span> 再起過程</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定義 (renewal process, counting process)^[[@Resnick2002 p.174], [@Mitov-Omey2014 p.1], [@Nummelin1984 p.49] 定義4.2 など参照．計数過程の用語については [@Aalen1978 p.701] の解説も参照．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定義 (renewal process, counting process)<sup>1</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p>非負確率変数の独立同分布 <img src="https://latex.codecogs.com/png.latex?%5C%7BT_n%5C%7D%5Csubset%5Cmathcal%7BL%7D(%5COmega)_+"> について，</p>
<ol type="1">
<li><img src="https://latex.codecogs.com/png.latex?%5C%7BT_n%5C%7D"> が定めるランダムウォーク <img src="https://latex.codecogs.com/png.latex?S_0=0,%5Cqquad%20S_n:=T_1+%5Ccdots+T_n,%5Cqquad%20n%5Cge1,"> を <strong>再起過程</strong> または再生過程という．<sup>2</sup> <img src="https://latex.codecogs.com/png.latex?%5C%7BT_n%5C%7D"> を待ち時間 (interarrival times)，<img src="https://latex.codecogs.com/png.latex?S_n"> を <img src="https://latex.codecogs.com/png.latex?n"> 回目到着時刻という．</li>
<li>再起過程 <img src="https://latex.codecogs.com/png.latex?%5C%7BS_n%5C%7D"> の <strong>再起回数過程</strong> とは， <img src="https://latex.codecogs.com/png.latex?N_t:=%5Csum_%7Bn=0%7D%5E%5Cinfty1_%7B%5B0,t%5D%7D(S_n)=%5Csup_%7Bn%5Cin%5Cmathbb%7BN%7D%5Cmid%20S_n%5Cle%20t%7D"> をいう．<img src="https://latex.codecogs.com/png.latex?t%5Cmapsto%5Coperatorname%7BE%7D%5BN_t%5D"> を再起関数という．</li>
</ol>
</div>
</div>
<p>再起過程 <img src="https://latex.codecogs.com/png.latex?%5C%7BS_n%5C%7D"> は通常，繰り返し起こる事象の発生時間をモデル化するために用いられる．</p>
<p>その代表的なものが，待ち時間 <img src="https://latex.codecogs.com/png.latex?%5C%7BT_n%5C%7D"> を指数分布に取った場合である Poisson 過程である．</p>
<p>再起過程は OR を中心として，多くの応用先を持つ：</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/Process/Images/Claude.png" class="img-fluid figure-img"></p>
<figcaption>再起過程の応用例 by Claude 3 Opus</figcaption>
</figure>
</div>
</section>
<section id="付随する待ち時間の-markov-過程" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="付随する待ち時間の-markov-過程"><span class="header-section-number">1.3</span> 付随する待ち時間の Markov 過程</h3>
<p>再起過程 <img src="https://latex.codecogs.com/png.latex?%5C%7BS_n%5C%7D"> は，ある Markov 過程 <img src="https://latex.codecogs.com/png.latex?%5C%7BX_t%5C%7D"> が原点に戻る時刻の列と捉えることで，エルゴード性を議論することができる．</p>
<p>このときの Markov 過程 <img src="https://latex.codecogs.com/png.latex?%5C%7BX_t%5C%7D"> を，本稿では <strong>待ち時間の Markov 過程</strong> と呼ぶことにする．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/Process/Images/ResidualWaitingTime.gif" class="img-fluid figure-img"></p>
<figcaption>待ち時間の Markov 過程 <img src="https://latex.codecogs.com/png.latex?(X_t)"> のアニメーション．原点は左端としている．</figcaption>
</figure>
</div>
<p>以下，第 2 節では離散時間で状態空間も離散 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BN%7D"> の場合，第 3 節では連続時間で状態空間も連続 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D_+"> の場合について，この待ち時間の Markov 過程 <img src="https://latex.codecogs.com/png.latex?X"> のエルゴード性を調べる．</p>
</section>
</section>
<section id="sec-waiting-markov-chain" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="sec-waiting-markov-chain"><span class="header-section-number">2</span> 待ち時間の Markov 連鎖</h2>
<p>まず，待ち時間 <img src="https://latex.codecogs.com/png.latex?T_n"> は非負整数 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BN%7D=%5C%7B0,1,%5Ccdots%5C%7D"> 値とし，その分布を <img src="https://latex.codecogs.com/png.latex?(p_i)%5Csim%5Cmathcal%7BP%7D(%5Cmathbb%7BN%7D)"> とする．</p>
<p>これが定める再生過程 <img src="https://latex.codecogs.com/png.latex?%5C%7BS_n%5C%7D"> は，次の遷移確率 <img src="https://latex.codecogs.com/png.latex?(p_%7Bij%7D)"> を持つ <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BN%7D"> 上の Markov 連鎖 <img src="https://latex.codecogs.com/png.latex?X"> が原点 <img src="https://latex.codecogs.com/png.latex?0"> に到着する時刻の列と同分布である： <img src="https://latex.codecogs.com/png.latex?%0Ap_%7B(i+1)i%7D=1,%5Cqquad%20p_%7B0i%7D=p_i,%5Cqquad%20i%5Cin%5Cmathbb%7BN%7D.%0A"></p>
<p>このとき，（無限次元の）確率行列 <img src="https://latex.codecogs.com/png.latex?P"> は <a href="https://ja.wikipedia.org/wiki/%E5%90%8C%E4%BC%B4%E8%A1%8C%E5%88%97">Frobenius の同伴行列</a> の転置の形をしている．</p>
<section id="エルゴード定理" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="エルゴード定理"><span class="header-section-number">2.1</span> エルゴード定理</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題
</div>
</div>
<div class="callout-body-container callout-body">
<p>上で定義した Markov 連鎖 <img src="https://latex.codecogs.com/png.latex?X=%5C%7BX_n%5C%7D_%7Bn%5Cin%5Cmathbb%7BN%7D%7D"> について，</p>
<ol type="1">
<li>任意の状態 <img src="https://latex.codecogs.com/png.latex?i%5Cin%5Cmathbb%7BN%7D"> に関して <img src="https://latex.codecogs.com/png.latex?p_i%3E0"> が成り立つとする．このとき，<img src="https://latex.codecogs.com/png.latex?X"> は既約で非周期的であり，再帰的である．</li>
<li>さらに，<img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bj=1%7D%5E%5Cinfty%20jp_j%3C%5Cinfty"> も満たすとき，<img src="https://latex.codecogs.com/png.latex?X"> は不変確率測度 <img src="https://latex.codecogs.com/png.latex?%5Cmu_i=%5Cfrac%7B%5Csum_%7Bj=i%7D%5E%5Cinfty%20p_j%7D%7B1+%5Csum_%7Bj=1%7D%5E%5Cinfty%20jp_j%7D"> をもち，正に再帰的である．そうでないときは零再帰的である．</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>分布 <img src="https://latex.codecogs.com/png.latex?(p_i)"> が偶数の上にしか台を持たないなど，<img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7Bsupp%7D%5C;(p)"> に周期がある場合は <img src="https://latex.codecogs.com/png.latex?X"> は周期的になってしまうが，任意の <img src="https://latex.codecogs.com/png.latex?i%5Cin%5Cmathbb%7BN%7D"> に関して <img src="https://latex.codecogs.com/png.latex?p_i%3E0"> ならば，任意の状態 <img src="https://latex.codecogs.com/png.latex?i%5Cin%5Cmathbb%7BN%7D"> は本質的であり，互いに行き来できるため既約であり，周期も持たない．必ず有限時間内に原点に戻ってくるため，再帰的でもある．</p></li>
<li><p>原点 <img src="https://latex.codecogs.com/png.latex?0"> に初めて帰ってくる時刻を <img src="https://latex.codecogs.com/png.latex?T_0"> とすると， <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Coperatorname%7BE%7D_0%5BT_0%5D&amp;=%5Csum_%7Bj=0%7D%5E%5Cinfty(j+1)p_j%5C%5C%0A&amp;=1+%5Csum_%7Bj=0%7D%5E%5Cinfty%20jp_j%5C%5C%0A&amp;=1+%5Csum_%7Bj=1%7D%5E%5Cinfty%20jp_j.%0A%5Cend%7Balign*%7D"> よって，正に再帰的であること <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BE%7D_0%5BT_0%5D%3C%5Cinfty"> は，<img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bj=1%7D%5E%5Cinfty%20jp_j%3C%5Cinfty"> に同値． このとき，離散エルゴード定理より，ただ一つの不変測度 <img src="https://latex.codecogs.com/png.latex?(%5Cmu_n)%5Cin%5Cmathcal%7BP%7D(%5Cmathbb%7BN%7D)"> を持ち， <img src="https://latex.codecogs.com/png.latex?%5Cmu_i=%5Cfrac%7B1%7D%7B%5Coperatorname%7BE%7D_i%5BT_i%5D%7D,%5Cqquad%20i%5Cin%5Cmathbb%7BN%7D,"> と表せる．これにより <img src="https://latex.codecogs.com/png.latex?i=0"> の場合はすぐに計算できるが，<img src="https://latex.codecogs.com/png.latex?i%3E0"> の場合は少し計算の見通しが良くない．そこで，必要条件 <img src="https://latex.codecogs.com/png.latex?%5Cmu_i=%5Cmu_%7Bi+1%7D+%5Cmu_0p_i,%5Cqquad%20i%5Cin%5Cmathbb%7BN%7D,"> に注目すると，これを再帰的に適用することで， <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmu_%7Bi-1%7D&amp;=%5Cmu_%7Bi-1%7D-%5Cmu_0p_%7Bi-1%7D%5C%5C%0A&amp;=%5Cmu_%7Bi-2%7D-%5Cmu_0p_%7Bi-2%7D-%5Cmu_0p_%7Bi-1%7D%5C%5C%0A&amp;=%5Ccdots%5C%5C%0A&amp;=%5Cmu_0-%5Cmu_0%5Csum_%7Bj=0%7D%5E%7Bi-1%7Dp_j%5C%5C%0A&amp;=%5Cmu_0%5Csum_%7Bj=i%7D%5E%5Cinfty%20p_j.%0A%5Cend%7Balign*%7D"></p></li>
</ol>
</div>
</div>
</div>
<p>Markov 連鎖の概念は次節で解説しているので，証明を読む前にぜひチェックしてください．</p>
</section>
<section id="離散-markov-連鎖の概念" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="離散-markov-連鎖の概念"><span class="header-section-number">2.2</span> 離散 Markov 連鎖の概念</h3>
<p>まず，離散状態空間 <img src="https://latex.codecogs.com/png.latex?E"> 上の Markov 連鎖は，各状態 <img src="https://latex.codecogs.com/png.latex?i%5Cin%20E"> の分類から始まる．</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定義：状態の再帰性 (recurrent, transient, positive recurrent, null recurrent)">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定義：状態の再帰性 (recurrent, transient, positive recurrent, null recurrent)
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?E"> を可算集合，<img src="https://latex.codecogs.com/png.latex?%5C%7BX_n%5C%7D"> を <img src="https://latex.codecogs.com/png.latex?E"> 上の Markov 連鎖とする．状態 <img src="https://latex.codecogs.com/png.latex?i%5Cin%20E"> について， <img src="https://latex.codecogs.com/png.latex?%0A%5Ctau_i:=%5Cinf%5C%7Bn%5Cge1%5Cmid%20X_n=i%5C%7D%0A"> を到着時刻とする．</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?i"> が <strong>再帰的</strong> な状態であるとは，Markov 連鎖 <img src="https://latex.codecogs.com/png.latex?%5C%7BX_n%5C%7D"> が <img src="https://latex.codecogs.com/png.latex?i%5Cin%20E"> からスタートした場合，必ずいずれ戻ってくることをいう： <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BP%7D_i%5B%5Ctau_i%3C%5Cinfty%5D=1.%0A"> そうでない場合，<img src="https://latex.codecogs.com/png.latex?i%5Cin%20E"> は <strong>推移的</strong> であるという．</li>
<li>再帰的な状態 <img src="https://latex.codecogs.com/png.latex?i%5Cin%20E"> がさらに <strong>正に再帰的</strong> であるとは，帰ってくる時刻の期待値が有限であることをいう： <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BE%7D_i%5B%5Ctau_i%5D%3C%5Cinfty.%0A"> そうでない場合は <strong>零再帰的</strong> であるという．</li>
</ul>
</div>
</div>
<p>続いて，この状態 <img src="https://latex.codecogs.com/png.latex?i%5Cin%20E"> 毎に定義した性質が，Markov 連鎖 <img src="https://latex.codecogs.com/png.latex?%5C%7BX_n%5C%7D"> 全体の性質に直接に影響するためには，次の「既約性」の条件が必要である．</p>
<p>状態 <img src="https://latex.codecogs.com/png.latex?i%5Cin%20E"> から <img src="https://latex.codecogs.com/png.latex?j%5Cin%20E"> へ <strong>到達可能</strong> であるとは，ある <img src="https://latex.codecogs.com/png.latex?n%5Cin%5Cmathbb%7BN%7D"> が存在して <img src="https://latex.codecogs.com/png.latex?p_%7Bij%7D%5En%3E0"> を満たすことをいう．これを <img src="https://latex.codecogs.com/png.latex?i%5Cto%20j"> と表す．</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定義：既約性と非周期性">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定義：既約性と非周期性
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?E"> を可算集合，<img src="https://latex.codecogs.com/png.latex?%5C%7BX_n%5C%7D"> を <img src="https://latex.codecogs.com/png.latex?E"> 上の Markov 連鎖とし，その遷移確率を <img src="https://latex.codecogs.com/png.latex?p_%7Bij%7D%5En=%5Coperatorname%7BP%7D_i%5BX_n=j%5D"> と表す．</p>
<ul>
<li>状態 <img src="https://latex.codecogs.com/png.latex?i%5Cin%20E"> が <strong>本質的</strong> であるとは，任意の到達可能な状態 <img src="https://latex.codecogs.com/png.latex?i%5Cto%20j"> に対して，<img src="https://latex.codecogs.com/png.latex?j%5Cto%20i"> でもあることをいう．</li>
<li>Markov 連鎖 <img src="https://latex.codecogs.com/png.latex?X"> が <strong>既約</strong> であるとは，任意の本質的な状態 <img src="https://latex.codecogs.com/png.latex?i,j%5Cin%20E"> が互いに到達可能であることをいう：<img src="https://latex.codecogs.com/png.latex?i%5Cleftrightarrow%20j">．</li>
</ul>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?X"> の遷移確率 <img src="https://latex.codecogs.com/png.latex?p"> は，<img src="https://latex.codecogs.com/png.latex?E"> の本質的な状態 <img src="https://latex.codecogs.com/png.latex?E_%5Cmathrm%7Bess%7D"> 上に，互いに到達可能であるという関係 <img src="https://latex.codecogs.com/png.latex?%5Cleftrightarrow"> を通じて同値類 <img src="https://latex.codecogs.com/png.latex?E_%5Cmathrm%7Bess%7D/%5Cleftrightarrow"> を定めることが示せる．この同値類が１つに縮退することを，既約というのである．</p>
<p>また，周期 <img src="https://latex.codecogs.com/png.latex?%0Ad(i):=%5Cgcd%5C%7Bn%5Cge1%5Cmid%20p_%7Bii%7D%5En%3E0%5C%7D%0A"> は，先述の同値類 <img src="https://latex.codecogs.com/png.latex?E_%5Cmathrm%7Bess%7D/%5Cleftrightarrow"> 上に関数を定める．この関数 <img src="https://latex.codecogs.com/png.latex?d:(E_%5Cmathrm%7Bess%7D/%5Cleftrightarrow)%5Cto%5Cmathbb%7BN%7D%5E+"> が 定値関数 <img src="https://latex.codecogs.com/png.latex?1"> となるとき，<img src="https://latex.codecogs.com/png.latex?X"> を <strong>非周期的</strong> という．</p>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>任意の <img src="https://latex.codecogs.com/png.latex?i,j,k%5Cin%20E"> について，必ず <img src="https://latex.codecogs.com/png.latex?%0Ap%5E%7Bn+m%7D_%7Bik%7D%5Cge%20p%5En_%7Bij%7Dp%5Em_%7Bjk%7D%0A"> が成り立つ．<img src="https://latex.codecogs.com/png.latex?i%5Cto%20j"> かつ <img src="https://latex.codecogs.com/png.latex?j%5Cto%20k"> であるとき，ある <img src="https://latex.codecogs.com/png.latex?n,m%5Cge1"> が存在して <img src="https://latex.codecogs.com/png.latex?p%5En_%7Bij%7D%3E0"> かつ <img src="https://latex.codecogs.com/png.latex?p%5Em_%7Bjk%7D%3E0"> であるから，<img src="https://latex.codecogs.com/png.latex?p%5E%7Bn+m%7D_%7Bik%7D%3E0"> である．よって，<img src="https://latex.codecogs.com/png.latex?i%5Cto%20j">．これより <img src="https://latex.codecogs.com/png.latex?%5Cleftrightarrow"> は推移的である．反射性は <img src="https://latex.codecogs.com/png.latex?p_%7Bii%7D%5E0=1%3E0"> であるため，定義上成り立つ．対称性も成り立つ．</p>
<p>続いて，<img src="https://latex.codecogs.com/png.latex?i%5Cleftrightarrow%20j"> ならば，<img src="https://latex.codecogs.com/png.latex?d(i)=d(j)"> を示す． <img src="https://latex.codecogs.com/png.latex?%0AN_i:=%5Cgcd%5C%7Bn%5Cge1%5Cmid%20p_%7Bii%7D%5En%3E0%5C%7D%0A"> と表すと，<img src="https://latex.codecogs.com/png.latex?i%5Cleftrightarrow%20j"> ならば <img src="https://latex.codecogs.com/png.latex?N_i%5Cne%5Cemptyset"> である．任意の <img src="https://latex.codecogs.com/png.latex?s%5Cin%20N_i"> を取ると，仮定 <img src="https://latex.codecogs.com/png.latex?i%5Cleftrightarrow%20j"> より，先ほどの議論と同様にして，ある <img src="https://latex.codecogs.com/png.latex?n,m%5Cge1"> が存在して， <img src="https://latex.codecogs.com/png.latex?%0Ap%5E%7Bn+m+ks%7D_%7Bjj%7D%5Cge%20p%5Em_%7Bji%7Dp%5Es_%7Bii%7Dp%5En_%7Bij%7D%3E0,%5Cqquad%20k=1,2,%5Ccdots.%0A"> よって，<img src="https://latex.codecogs.com/png.latex?d(j)%7Cs"> が必要であるから，<img src="https://latex.codecogs.com/png.latex?d(j)%5Cle%20d(i)"> が結論づけられる．逆も全く同様に議論できるから，<img src="https://latex.codecogs.com/png.latex?d(j)=d(i)">．</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題：既約な Markov 連鎖の再帰性">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題：既約な Markov 連鎖の再帰性
</div>
</div>
<div class="callout-body-container callout-body">
<p>状態 <img src="https://latex.codecogs.com/png.latex?i,j%5Cin%20E"> は互いに到達可能であるとする：<img src="https://latex.codecogs.com/png.latex?i%5Cleftrightarrow%20j">．このとき，<img src="https://latex.codecogs.com/png.latex?i,j"> の推移性・零再帰性・正再帰性は一致する．特に，Markov 連鎖 <img src="https://latex.codecogs.com/png.latex?X"> が既約ならば，全ての状態が同じ再帰性を持つ．</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>ひとまず <span class="citation" data-cites="Hairer2021-Convergence">(Hairer, 2021, p. 2)</span> 参照．</p>
</div>
</div>
</div>
<p>こうして，既約な Markov 連鎖 <img src="https://latex.codecogs.com/png.latex?P"> の再帰性が議論できるようになる．推移的であるか，零再帰的であるか，正に再帰的であるかのいずれかである．</p>
</section>
<section id="離散エルゴード定理" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="離散エルゴード定理"><span class="header-section-number">2.3</span> 離散エルゴード定理</h3>
<p>Markov 連鎖 <img src="https://latex.codecogs.com/png.latex?X"> が再帰的であるためには，既約性と非周期性が十分条件である．加えて，極限が零測度でなければ，正に再帰的である．</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="離散エルゴード定理^[[@Kulik2018 p.16] 定理1.2.5，[@Robert-Casella2004 p.224] を参照．]">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
離散エルゴード定理<sup>3</sup>
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?X=%5C%7BX_n%5C%7D_%7Bn%5Cin%5Cmathbb%7BN%7D%7D%5Csubset%20L(%5COmega;E)"> をMarkov連鎖，<img src="https://latex.codecogs.com/png.latex?E"> を可算集合とする． <img src="https://latex.codecogs.com/png.latex?X"> が既約で非周期的ならば，次が成り立つ：</p>
<ol type="1">
<li>任意の本質的な状態 <img src="https://latex.codecogs.com/png.latex?i%5Cin%20E"> について，次が成り立つ： <img src="https://latex.codecogs.com/png.latex?%0Ap%5En_%7Bij%7D%5Cxrightarrow%7Bn%5Cto%5Cinfty%7D%5Cmu_j=%5Cfrac%7B1%7D%7B%5Coperatorname%7BE%7D_j%5B%5Ctau_j%5D%7D,%5Cqquad%20j%5Cin%20E.%0A"> 特に，任意の開始地点 <img src="https://latex.codecogs.com/png.latex?i%5Cin%20E"> について，<img src="https://latex.codecogs.com/png.latex?(p_%7Bi-%7D%5En)"> は <img src="https://latex.codecogs.com/png.latex?%5Cmu"> に全変動収束する．</li>
<li>加えて <img src="https://latex.codecogs.com/png.latex?X"> が正に再帰的であるならば，<img src="https://latex.codecogs.com/png.latex?%5Cmu:=%5C%7B%5Cmu_i%5C%7D_%7Bi%5Cin%5Cmathcal%7BX%7D%7D"> は <img src="https://latex.codecogs.com/png.latex?X"> のただ一つの不変確率測度である．</li>
<li><img src="https://latex.codecogs.com/png.latex?X"> が零再帰的である場合は <img src="https://latex.codecogs.com/png.latex?%5Cmu_i%5Cequiv0"> であり，<img src="https://latex.codecogs.com/png.latex?X"> の不変確率測度は存在しない．</li>
</ol>
</div>
</div>
<p>状態空間 <img src="https://latex.codecogs.com/png.latex?E"> が有限である場合，正に再帰的＝エルゴード的ならば，必ず収束は（全変動ノルムに関して）指数速度で起こる．</p>
<p>しかし，<img src="https://latex.codecogs.com/png.latex?E"> が可算無限である場合，速度は様々である．</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BN%7D"> 上の待ち時間の Markov 連鎖が，その良い例となっている．</p>
</section>
</section>
<section id="sec-waiting-markov-process" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="sec-waiting-markov-process"><span class="header-section-number">3</span> 待ち時間の Markov 過程</h2>
<section id="過程の定義" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="過程の定義"><span class="header-section-number">3.1</span> 過程の定義</h3>
<p>待ち時間の分布 <img src="https://latex.codecogs.com/png.latex?%5Cnu%5Cin%5Cmathcal%7BP%7D(%5Cmathbb%7BR%7D%5E+)"> は非零な１次の積率を持つとする．</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cnu"> が定める再生過程を作り出す Markov 過程 <img src="https://latex.codecogs.com/png.latex?%5C%7BX_t%5C%7D"> とは，離散時間の場合（第 2 節）と同様，</p>
<ol type="1">
<li><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5E+"> 上で <img src="https://latex.codecogs.com/png.latex?%5Cdot%7BX%7D_t=-1">．</li>
<li><img src="https://latex.codecogs.com/png.latex?X_t=0"> のとき，次の瞬間 <img src="https://latex.codecogs.com/png.latex?%5Cnu"> に従って選択されたある正の値にジャンプする．</li>
</ol>
<p>このとき，次が成り立つ：</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="命題">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
命題
</div>
</div>
<div class="callout-body-container callout-body">
<p>上で定義した Markov 過程 <img src="https://latex.codecogs.com/png.latex?%5C%7BX_t%5C%7D"> について，</p>
<ol type="1">
<li>生成作用素は次で定まる： <img src="https://latex.codecogs.com/png.latex?%0ALf(x)=-%5Cfrac%7Bd%20f(x)%7D%7Bd%20x%7D,%5Cqquad%20f%5Cin%5Cmathcal%7BD%7D(L),%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Cmathcal%7BD%7D(L):=%5Cleft%5C%7Bf%5Cin%5Cmathcal%7BL%7D%5E1(%5Cnu)%5C,%5Cmiddle%7C%5C,f(0)=%5Cint%5E%5Cinfty_0f(x)%5Cnu(dx)%5Cright%5C%7D.%0A"></li>
<li>次で定まる確率分布 <img src="https://latex.codecogs.com/png.latex?%5Cmu_*%5Cin%5Cmathcal%7BP%7D(%5Cmathbb%7BR%7D_+)"> は <img src="https://latex.codecogs.com/png.latex?%5C%7BX_t%5C%7D"> に関して不変である： <img src="https://latex.codecogs.com/png.latex?%0A%5Cmu_*(dx)=c%5Cnu(%5Bx,%5Cinfty%5D)dx,%0A"> <img src="https://latex.codecogs.com/png.latex?%0Ac:=%5Cint%5E%5Cinfty_0y%5Cnu(dy)%5Cin(0,%5Cinfty).%0A"></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>収束 <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7BP_tf(x)-f(x)%7D%7Bt%7D%5Cto-%5Cfrac%7Bd%20f(x)%7D%7Bd%20x%7D%5Cqquad%20t%5Cto%5Cinfty,%0A"> は，<img src="https://latex.codecogs.com/png.latex?x%5Cne0"> の場合直ちに成り立つ．</p>
<p>これが <img src="https://latex.codecogs.com/png.latex?x=0"> の場合も含めて一様に成り立つことと，<img src="https://latex.codecogs.com/png.latex?(%5Cnu%7Cf)=f(0)"> は同値である．</p></li>
<li><p>任意の <img src="https://latex.codecogs.com/png.latex?f%5Cin%20C_c%5E1(%5Cmathbb%7BR%7D_+)%5Ccap%5Cmathcal%7BD%7D(L)"> について，次のようにして <img src="https://latex.codecogs.com/png.latex?(%5Cmu_*%7CLf)=0"> が示せるためである： <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A(%5Cmu_*%7CLf)&amp;=-%5Cint%5E%5Cinfty_0f'(x)%5Cmu_*(dx)=-c%5Cint%5E%5Cinfty_0f'(x)%5Cnu(%5Bx,%5Cinfty))%5C,dx%5C%5C%0A&amp;=-c%5Cbiggl%5Bf(x)%5Cnu(%5Bx,%5Cinfty))%5Cbiggr%5D%5E%5Cinfty_0-c%5Cint%5E%5Cinfty_0f(x)%5Cnu(dx)=cf(0)-cf(0)=0.%0A%5Cend%7Balign*%7D"></p></li>
</ol>
</div>
</div>
</div>
</section>
<section id="多項式エルゴード性" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="多項式エルゴード性"><span class="header-section-number">3.2</span> 多項式エルゴード性</h3>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="定理（待ち時間の Markov 連鎖の多項式エルゴード性）">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
定理（待ち時間の Markov 連鎖の多項式エルゴード性）
</div>
</div>
<div class="callout-body-container callout-body">
<p>待ち時間の分布は <img src="https://latex.codecogs.com/png.latex?%5Cnu%5Cll%5Cell_1"> で密度 <img src="https://latex.codecogs.com/png.latex?p"> をもち，ある <img src="https://latex.codecogs.com/png.latex?%5Czeta%3E2"> が存在して <img src="https://latex.codecogs.com/png.latex?p"> は <img src="https://latex.codecogs.com/png.latex?x%5E%7B-%5Czeta%7D"> のレートを持つとする： <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7Bc_-%7D%7Bx%5E%5Czeta%7D%5Cle%20p(x)%5Cle%5Cfrac%7Bc_+%7D%7Bx%5E%5Czeta%7D%0A"> このとき，次の多項式エルゴード性が成り立つ： <img src="https://latex.codecogs.com/png.latex?%0A%5C%7CP%5Et(x,-)-%5Cmu_*%5C%7C_%5Cmathrm%7BTV%7D%5Cle%20C%5Cfrac%7Bx%5E%5Calpha%7D%7Bt%5E%7B%5Calpha-1%7D%7D,%0A"> <img src="https://latex.codecogs.com/png.latex?%0At%5Cge0,x%5Cin%5Cmathbb%7BR%7D_+,%5Calpha%5Cin(0,%5Czeta-1).%0A"> 加えて，次が成り立つ： <img src="https://latex.codecogs.com/png.latex?%0A%5Clim_%7Bt%5Cto%5Cinfty%7D%5Cfrac%7B%5Clog%5C%7CP_t(x,-)-%5Cmu_*%5C%7C_%5Cmathrm%7BTV%7D%7D%7B%5Clog%20t%7D=2-%5Cxi.%0A"></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?V(x):=x%5E%7B%5Calpha%7D%5C;%5Cmathrm%7Bon%7D%5C;%5B1,%5Cinfty)%5C;(%5Calpha%3E0)"> という形の関数であって，<img src="https://latex.codecogs.com/png.latex?V%5Cin%5Cmathcal%7BD%7D(L)"> を満たすものが存在する．</p>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="証明">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Calpha%5Cin(0,%5Czeta-1)"> を満たすように取れば， <img src="https://latex.codecogs.com/png.latex?%0A%5Cint%5E%5Cinfty_0V(x)%5Cnu(dx)=%5Cint%5E1_0V(x)p(x)dx+c_+%5Cint_1%5E%5Cinfty%20x%5E%7B%5Calpha-%5Cxi%7Ddx%3C%5Cinfty%0A"> より，この値を <img src="https://latex.codecogs.com/png.latex?V(0)"> とし，<img src="https://latex.codecogs.com/png.latex?(0,%5Cinfty)"> 上で <img src="https://latex.codecogs.com/png.latex?C%5E1">-級になるように繋げば良い．</p>
</div>
</div>
</div>
<p>このとき， <img src="https://latex.codecogs.com/png.latex?%0ALV(x)=-%5Calpha%20x%5E%7B%5Calpha-1%7D=-%5Calpha%20V(x)%5E%7B1-%5Cfrac%7B1%7D%7B%5Calpha%7D%7D%5Cqquad%5Cmathrm%7Bon%7D%5C;%5B1,%5Cinfty)%0A"> が成り立つ．即ち，Lyapunov関数 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(x):=%5Calpha%20x%5E%7B1-%5Cfrac%7B1%7D%7B%5Calpha%7D%7D"> に関する劣線型ドリフト条件を満たす．スケルトンの議論を通じて，多項式エルゴード定理より，<img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B(1-1/%5Calpha)%7D%7B1-(1-1/%5Calpha)%7D=%5Calpha-1"> のレートで収束する： <img src="https://latex.codecogs.com/png.latex?%0A%5C%7CP%5Et(x,-)-%5Cmu_*%5C%7C_%5Cmathrm%7BTV%7D%5Cle%20C%5Cfrac%7B%5Clvert%20x%5Crvert%5E%5Calpha%7D%7Bt%5E%7B%5Calpha-1%7D%7D.%0A"> ここで <img src="https://latex.codecogs.com/png.latex?%5Calpha%5Cin(0,%5Czeta-1)"> は任意の値であったから， <img src="https://latex.codecogs.com/png.latex?%0A%5Clog%5C%7CP%5Et(x,-)-%5Cmu_*%5C%7C_%5Cmathrm%7BTV%7D%5Cle%5Clog%20C+%5Calpha%5Clog%20x-(%5Calpha-1)%5Clog%20t%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Ctherefore%5Cqquad%5Climsup_%7Bt%5Cto%5Cinfty%7D%5Cfrac%7B%5Clog%5C%7CP%5Et(x,-)-%5Cmu_*%5C%7C_%5Cmathrm%7BTV%7D%7D%7B%5Clog%20t%7D%5Cle%5Climsup_%7B%5Calpha%3C%5Czeta-1%7D-(%5Calpha-1)=2-%5Czeta.%0A"></p>
<p>最後の主張を示す．まず，<img src="https://latex.codecogs.com/png.latex?LV"> は上に有界であるから， <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7Bd%20%7D%7Bd%20t%7DP_tV(x)=P_tLV(x)%5Cle%20C%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Ctherefore%5Cqquad%20P_tV(x)%5Cle%20Ct+x%5E%5Calpha=:g(x,t).%0A"> 続いて，<img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Bc_-%7D%7Bx%5E%5Czeta%7D%5Cle%20p(x)"> より，<img src="https://latex.codecogs.com/png.latex?%5Cmu_*"> の密度は下から評価できる： <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cmu_*(dx)%7D%7Bdx%7D=%5Cint%5E%5Cinfty_xp(y)%5C,dy%5Cge%5Cint%5E%5Cinfty_x%5Cfrac%7Bc_-%7D%7By%5E%5Czeta%7D%5C,dy=cx%5E%7B1-%5Czeta%7D.%0A"> これより， <img src="https://latex.codecogs.com/png.latex?%0A%5Cmu_*%5BV%3ER%5D=%5Cmu_*%5Bx%3ER%5E%7B1/%5Calpha%7D%5D%5Cge%20CR%5E%7B-%5Cfrac%7B%5Czeta-2%7D%7B%5Calpha%7D%7D=:f(R)%0A"> を得る．以上の評価とから， <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B1%7D%7B2%7D%5C%7CP%5Et(x,-)-%5Cmu_*%5C%7C_%5Cmathrm%7BTV%7D%5Cge%20f(R)-%5Cfrac%7Bg(x,t)%7D%7BR%7D=CR%5E%7B-%5Cfrac%7B%5Czeta-2%7D%7B%5Calpha%7D%7D-%5Cfrac%7B%5Clvert%20x%5Crvert%5E%5Calpha+Ct%7D%7BR%7D%0A"> <img src="https://latex.codecogs.com/png.latex?R%3E0"> について最適化することで， <img src="https://latex.codecogs.com/png.latex?%0A%5C%7CP%5Et(x,-)-%5Cmu_*%5C%7C_%5Cmathrm%7BTV%7D%5Cge%20C%5Cbiggr(%5Clvert%20x%5Crvert%5E%5Calpha+Ct%5Cbiggl)%5E%7B%5Cfrac%7B%5Czeta-2%7D%7B%5Czeta-2-%5Calpha%7D%7D.%0A"> 同様にして，<img src="https://latex.codecogs.com/png.latex?%5Calpha%5Cnearrow%5Czeta-1"> を考えることで結論が従う．</p>
</div>
</div>
</div>
</section>
</section>



<div id="quarto-appendix" class="default"><section id="参考文献" class="level2 appendix" data-number="4"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">4</span> 参考文献</h2><div class="quarto-appendix-contents">

<p>離散時間の場合は <span class="citation" data-cites="Kulik2018">(Kulik, 2018, p. 22)</span> 例 1.3.6, <span class="citation" data-cites="Feller1967">(Feller, 1967, p. 381)</span> 例 XV.2.(k)，連続時間の場合は <span class="citation" data-cites="Hairer2021-Convergence">(Hairer, 2021, pp. 35–36)</span> を参考にした．</p>



</div></section><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-Aalen1978" class="csl-entry">
Aalen, O. (1978). Nonparametric inference for a family of counting processes. <em>The Annals of Statistics</em>, <em>6</em>(4), 701–726. <a href="https://www.jstor.org/stable/2958850">https://www.jstor.org/stable/2958850</a>
</div>
<div id="ref-Feller1967" class="csl-entry">
Feller, W. (1967). <em>An introduction to probability theory and its applications: Vol. I</em> (3rd ed.). Wiley, New York. <a href="https://www.wiley.com/en-us/An+Introduction+to+Probability+Theory+and+Its+Applications%2C+Volume+1%2C+3rd+Edition-p-9780471257080">https://www.wiley.com/en-us/An+Introduction+to+Probability+Theory+and+Its+Applications%2C+Volume+1%2C+3rd+Edition-p-9780471257080</a>
</div>
<div id="ref-Hairer2021-Convergence" class="csl-entry">
Hairer, M. (2021). <em>Convergence of markov processes</em>. <a href="https://www.hairer.org/notes/Convergence.pdf">https://www.hairer.org/notes/Convergence.pdf</a>
</div>
<div id="ref-Kulik2018" class="csl-entry">
Kulik, A. (2018). <em>Ergodic behavior of markov processes: With applications to limit theorems</em> (Vol. 67). De Gruyter: Berlin, Boston. <a href="https://doi.org/10.1515/9783110458930">https://doi.org/10.1515/9783110458930</a>
</div>
<div id="ref-Mitov-Omey2014" class="csl-entry">
Mitov, K. V., &amp; Omey, E. (2014). <em>Renewal processes</em>. Springer Cham. <a href="https://doi.org/10.1007/978-3-319-05855-9">https://doi.org/10.1007/978-3-319-05855-9</a>
</div>
<div id="ref-Nummelin1984" class="csl-entry">
Nummelin, E. (1984). <em><span class="nocase">General Irreducible Markov Chains and Non-Negative Operators</span></em> (Vol. 83). Cambridge University Press. <a href="https://doi.org/10.1017/CBO9780511526237">https://doi.org/10.1017/CBO9780511526237</a>
</div>
<div id="ref-Resnick2002" class="csl-entry">
Resnick, S. I. (2002). <em>Adventures in stochastic processes</em>. Birkhäuser Boston. <a href="https://doi.org/10.1007/978-1-4612-0387-2">https://doi.org/10.1007/978-1-4612-0387-2</a>
</div>
<div id="ref-Robert-Casella2004" class="csl-entry">
Robert, C. P., &amp; Casella, G. (2004). <em>Monte carlo statistical methods</em> (2nd ed.). Springer New York.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><span class="citation" data-cites="Resnick2002">(Resnick, 2002, p. 174)</span>, <span class="citation" data-cites="Mitov-Omey2014">(Mitov &amp; Omey, 2014, p. 1)</span>, <span class="citation" data-cites="Nummelin1984">(Nummelin, 1984, p. 49)</span> 定義4.2 など参照．計数過程の用語については <span class="citation" data-cites="Aalen1978">(Aalen, 1978, p. 701)</span> の解説も参照．↩︎</p></li>
<li id="fn2"><p>一般には和訳「再生過程」が定着しているだろう．だが regeneration process ではなく，renewal process なのである．生死というよりは，再起というべきだと考えるため，ここでは再起過程と呼ぶこととする．最大の欠点は「再帰」と音が同じことである．↩︎</p></li>
<li id="fn3"><p><span class="citation" data-cites="Kulik2018">(Kulik, 2018, p. 16)</span> 定理1.2.5，<span class="citation" data-cites="Robert-Casella2004">(Robert &amp; Casella, 2004, p. 224)</span> を参照．↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Process</category>
  <guid>https://162348.github.io/posts/2024/Process/ResidualWaitingTime.html</guid>
  <pubDate>Sun, 24 Mar 2024 15:00:00 GMT</pubDate>
  <media:content url="https://162348.github.io/posts/2024/Process/Images/ResidualWaitingTime.gif" medium="image" type="image/gif"/>
</item>
<item>
  <title>これからはじめるベイズ機械学習</title>
  <dc:creator>司馬博文 </dc:creator>
  <link>https://162348.github.io/posts/2024/AI/BAI.html</link>
  <description><![CDATA[ 





<p>現在，産業界における “AI” というと専ら，いくつかの限られた巨大 IT 企業が，巨大ニューラルネットワークを最尤推定で学習させ，これを基盤モデルとして公開し，我々一般庶民はそれを有効活用して下流タスクを安価に解くことだけ考えるという営みを指す．</p>
<p>その産業や生活への破壊的な影響を憂慮しながらも，雨乞いをする日々である．</p>
<div id="fig-Altman" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Altman-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-video"><video id="video_shortcode_videojs_video1" class="video-js vjs-default-skin vjs-fluid" controls="" preload="auto" data-setup="{}" title=""><source src="Images/SamAltman.mp4"></video></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Altman-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;1: 3月19日時点，GPT-5 にも Sora にもアクセス権を持たない我々 v.s. <a href="https://youtu.be/jvqFAi7vkBc?si=hwF_LJAs7XE3bNTR&amp;t=2695">Lex Fridman Podcast</a> に出演した Sam Altman
</figcaption>
</figure>
</div>
<p>AI はそんなものではない．AI はこれにかぎるものではない．</p>
<p>AI が真に我々の友となり，我々の日常をほんとうに豊かにするは，AI の進歩だけが必要なのではなく，<strong>人間との協業が得意になる必要がある</strong>．</p>
<p>そのための第一歩はすでに明らかである．<strong>不確実性の定量化</strong> である．</p>
<p>つまり，「その AI には何が出来て何が出来ないか」「AI の出力がいつ信頼にたるもので，いつ人間の介入が必要であるのか」がわかりやすい形で伝わるコミュニケーション様式をそなえている必要があるのである．<sup>1</sup></p>
<hr>
<p>筆者の知る限り，ここにある全てのナラティブは現時点では全く広く語られているものではなく，筆者も最初の１年の研究生活を通じて朧げながら見えて来たばかりのものである．</p>
<p><strong>不確実性の定量化は，機械学習モデルを民主化し，我々の民芸に取り込むための重要な一歩である</strong>（のではないだろうか？）．</p>
<p>本稿はこの発見を共有するために書いた．筆者の反芻不足から，冗長な部分も多いだろうが，少しでも，琴線に触れるものがあれば幸いである．<sup>2</sup></p>
<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
$$ %%% 汎用コード列
<p>%%% 演算子 </p>
%%% 線型代数学
<p>%%% 複素解析学 %%% 集合と位相 </p>
<p>%%% 形式言語理論 %%% Graph Theory </p>
%%% 多様体 %%% 代数 %%% 代数的位相幾何学 %%% 微分幾何学
%%% 函数解析
%%% 積分論
<p>%%% Fourier解析 %%% 数値解析 </p>
%%% 確率論
<p>%%% 情報理論 %%% 量子論 %%% 最適化 %%% 数理ファイナンス </p>
<p>%%% 偏微分方程式 %%% 常微分方程式 %%% 統計力学 %%% 解析力学 </p>
%%% 統計的因果推論 %%% 応用統計学 %%% 数理統計
<p>%%% 計量経済学 </p>
%%% 無限次元統計模型の理論
<p>%%% Banach Lattices </p>
<p>%%% 圏 %代数の圏 %Metric space &amp; Contraction maps %確率空間とMarkov核の圏 %Sober space &amp; continuous map %Category of open subsets %Category of sheave %Category of presheave, PSh(C)=[C^op,set]のこと %Convergence spaceの圏 %一様空間と一様連続写像の圏 %フレームとフレームの射 %その反対圏 %滑らかな多様体の圏 %Quiverの圏 </p>
%%% SMC
%%% 括弧類
<p>%%% 予約語 </p>
<p>%%% 略記 </p>
<p>%%% 矢印類 $$</p>
</div>
<section id="ベイズ機械学習のすすめ" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="ベイズ機械学習のすすめ"><span class="header-section-number">1</span> ベイズ機械学習のすすめ</h2>
<p>我々が AI をより信頼するためには，何が必要だろうか？</p>
<p>筆者の考えでは，信頼への第一歩は <strong>不確実性の定量化</strong> が出来るようになることのはずである．</p>
<p>そしてそのためには <strong>ベイズ機械学習</strong> (Bayesian Machine Learning) の発展による本質的解決が必要不可欠である．本稿はこの点を説明するために執筆されたものである．</p>
<p>筆者に言わせれば，ベイズ機械学習が，今後数年間で AI が経験すべき進展の方向である．この山を越えれば，今まででさえ思っても見なかった未来がひらけてくるだろう．</p>
<blockquote class="blockquote">
<p>Although considerable challenges remain, the coming decade promises substantial advances in artificial intelligence and machine learning based on the probabilistic framework. <span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 452)</span></p>
</blockquote>
<section id="ベイズとは何か" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="ベイズとは何か"><span class="header-section-number">1.1</span> ベイズとは何か？</h3>
<p>機械学習において，確率論的なモデリングに基づいたアプローチを <strong>ベイズ機械学習</strong> ともいう．典型的には，モデルの全変数上の結合分布をモデリングし，ベイズ規則によりパラメータのベイズ推定を行う，という手続きからなる．そのため，<strong>確率論的アプローチ</strong> や <strong>モデルベースアプローチ</strong> も同義語として用いられる．<sup>3</sup></p>
<p>一方で，<strong>頻度論的</strong> という言葉は，よく非ベイズ的アプローチを示す接頭辞として用いられる．典型的には，損失関数を設定し，これを最小化するパラメータを探索することによって実行される．</p>
<p>この２つのアプローチは互いに対照的であり，統計学の始まりから基本的な二項対立の図式をなしてきた．</p>
<div class="table-responsive-sm">
<table class="table-striped table-hover table">
<caption>Contrast of the two main approachs to Machine Learning</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Bayesian</th>
<th style="text-align: center;">Frequentist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Inference is<sup>4</sup></td>
<td style="text-align: center;">Marginalization</td>
<td style="text-align: center;">Approximation</td>
</tr>
<tr class="even">
<td style="text-align: center;">Computational Idea<sup>5</sup></td>
<td style="text-align: center;">Integration</td>
<td style="text-align: center;">Optimization</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Objective</td>
<td style="text-align: center;">Uncertainty Quantification</td>
<td style="text-align: center;">Recovery of True Value</td>
</tr>
<tr class="even">
<td style="text-align: center;">Emphasis</td>
<td style="text-align: center;">Modelling</td>
<td style="text-align: center;">Inference</td>
</tr>
</tbody>
</table>
</div>
<p>しかし，機械学習の時代においては，互いの弱みを補間し合う形で発展していくと筆者は考える．特に，現状の<u><strong>推論偏重でモデリング軽視の風潮が，重要な実世界応用の多くを阻んでしまっている</strong></u>．機械学習の世界樹は実は２本あるのである．</p>
</section>
<section id="ベイズと頻度論との違い" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="ベイズと頻度論との違い"><span class="header-section-number">1.2</span> ベイズと頻度論との違い</h3>
<p>ベイズと頻度論では，確率の解釈も異なるかも知れないが，数学的枠組みとしてはベイズの方が一般的な枠組みであり，また手続き上は，モデリングを重視するか，推論を重視するかの違いでしかない．</p>
<p>実際，殆どの場合，頻度論的手法はある特定の事前分布を持ったベイズ手法とみなせ，逆も然りである．</p>
<p>データから推論を行うには，何らかの仮定が必ず必要であり，それを明示的にモデルに組み込むのがベイズで，推論アルゴリズムにより自動化する精神を持つのが頻度論的手法である．</p>
<p>その結果，優秀な推論アルゴリズムが日夜驚異的なスピードで提案され，今や機械学習手法は教師あり学習・教師なし学習・強化学習の全てで目覚ましい発展を見た．</p>
<p>しかし，ベイズと頻度論の２つの柱のバランスを欠いた発展はここまでである．今や，頻度論的な手法を採用した際に，自分たちがどのような仮定を置いたのか全く明瞭な知識を欠いてしまっている．一方で，現実のビッグで複雑なデータを扱うためには，もはや確率的なモデリングを避けては通れない．<sup>6</sup></p>
<p>極めて本質的で強大な敵に対面しつつあるのである．</p>
<p>だが，現状の病理は明らかであり，頻度論とベイズの手法の間に対応をつけ，足並みを揃えることで次の前進が約束されてる．この意味で，２つの世界樹が必要なのである．</p>
<p>さらに，ベイズ推論は帰納的推論の確率論的拡張と見れるため，エージェントの合理的な学習と意思決定の最良のモデル（の一つ）と信じられている．<sup>7</sup></p>
<p>したがって，<u><strong>ベイズ流解釈により手法を理解し，最適化流解釈により手法を実装する</strong></u>．これがあるべき機械学習の未来であると筆者は考える．</p>
</section>
<section id="つの世界樹" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="つの世界樹"><span class="header-section-number">1.3</span> ２つの世界樹</h3>
<p>今こそ，この２つの手法は根底では繋がっていることをよく周知し，この２つの視座を往来しながら適材適所に使うことが大事だと筆者は考える．</p>
<p>しかしそのためには，ベイズ機械学習の発展が遅れている現状を鑑みて，ベイズの手法のより一層の発展と理解の深化が必要である．<sup>8</sup></p>
<p>本章「ベイズ機械学習のすすめ」は，ベイズの手法の特に肝心と思われる３つの側面を指摘して終わる．以下３章を通じて，</p>
<ol type="1">
<li><p>第 2 節 <u><strong>ベイズは不確実性を定量化する</strong></u></p>
<p>Bayes の方が不確実性の定量化が得意であるため，そのような応用先では頻度論的な手法よりも，Bayes バージョンの手法を用いることが出来ると便利である．</p></li>
<li><p>第 3 節 <u><strong>ベイズは分布という共通言語を与える</strong></u></p>
<p>Bayes による統一的な扱いが理論的に有用である場面が増えている．その際に，Bayes による理論解析と最適化による実際の推論という適材適所の協業が未来の方向であるかも知れない．</p></li>
<li><p>第 4 節 <u><strong>ベイズは理解を促進する</strong></u></p>
<p>ベイズの手法が敬遠されていた理由も，換言すれば，「事前分布」という得体の知れないものを通じて，理論的深淵と直結するためである．ベイズ手法の研究が理論的な解明を要請する．だからこそ，数学者の魂を持った者がこの途を通ることは人類に大きく資すると筆者は考える．</p></li>
</ol>
</section>
</section>
<section id="sec-uncertainty-quantification" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="sec-uncertainty-quantification"><span class="header-section-number">2</span> ベイズは不確実性を定量化する</h2>
<section id="sec-need-for-uncertainty-quantification" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="sec-need-for-uncertainty-quantification"><span class="header-section-number">2.1</span> 不確実性の定量化の必要性</h3>
<p>機械学習と統計学が単なる道具ではなく，人間のより大きなシステムの一環を単独で担う場面が増えてきた．例えば，</p>
<ul>
<li>金融・経営・政策決定などの分野で，意思決定に繋げるデータ解析をするとき</li>
<li>科学において，発見や仮説を検証するためのデータ解析をするとき</li>
<li>ロボットや自動車などの自動化をし，社会に実装するとき<sup>9</sup></li>
<li>医療診断や裁判などの場面で，専門家を補助するシステムを作るとき</li>
</ul>
<p>これらのいずれの例でも，<u><strong>システムの一部を担うにあたって，不確実性を定量化しておくことが欠かせない</strong></u>．その出力を用いるのが人間である場合も勿論，別の機械学習モデルである場合は尚更である．</p>
<p>つまり，人間社会で優秀であるだけでなくホウレンソウと信頼獲得も重要であるように，機械学習モデルも性能の高さと正確さだけでなく，いつその結果を信頼して良いのかを「どの程度」という指標と共に知らせてくれることが信頼関係の基本となるだろう．</p>
<p>実際，殆どの場面で，データから高い確証度で言えることと，そうではないことでは全く違う意味を持つ．それぞれの場面での例には，次のようなものがあるだろう：</p>
<ul>
<li>データから高い確証度で言えることと，意思決定者による采配が必要な部分を分離できない限り，意思決定プロセスの一部として組み込むことが難しく，結局機械学習手法が全く採用されないということもあり得る．</li>
<li>結果の再現可能性が科学の基本的な要請である以上，その結果の不確実性を実験結果に付記することは基本的な科学的態度である．後述（第 2.3.1 節）するが，<img src="https://latex.codecogs.com/png.latex?p">-値や信頼区間などの統計量は<u><strong>これに応えるものではない</strong></u>．</li>
<li>ロボットや自動車の自動化 AI システムは，いくつかのモデルを組み合わせて作ることになるだろう．個々が十分な性能を持っていても，小さな誤差が累積してシステムとしての性能を著しく低下させることがある．これを防ぐために，統一した方法での不確実性の取り扱いが必要である．</li>
<li>個々人の権利と法益が衝突する場面にも AI が利用されより良い生活が実現されるには，法的な解釈可能性が担保される必要があることが，実は大きな難関として我々を待っている．その第一歩は，不確実性の可視化になるだろう．<sup>10</sup></li>
</ul>
<p>以上の内容は，結果の <strong>解釈可能性</strong> でも全く同じことが言えるだろう．</p>
</section>
<section id="信頼のおける-ai-システム" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="信頼のおける-ai-システム"><span class="header-section-number">2.2</span> 信頼のおける AI システム</h3>
<p>上述の点をまとめると，機械学習手法と人間社会がよりよく共生していくには AI の <strong>信頼性</strong> (trustworthyness) が必要とされているのである．不確実性の定量化と解釈可能性は，AI が人間社会で信頼を獲得するにあたって根本的な要素になるだろう．</p>
<p>現状の手法の延長でこの信頼性の問題は扱えず，新たな手法が必要とされている．Bayesian approach や probabilistic approach と呼ばれている試みは，まさにこれに応えるものであり，近年急速に発展している．</p>
</section>
<section id="sec-Bayes-for-uncertainty-quatification" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="sec-Bayes-for-uncertainty-quatification"><span class="header-section-number">2.3</span> 不確実性を扱うには Bayes が必要である</h3>
<p>実装は頻度論的な手法の方が簡単で高速であることが多いが，不確実性の定量化には向かない．</p>
<p>このような場面では，頻度論的手法を頻度論的に改善する，という方向は筋が悪いと思われる．<strong>このようなときこそ，もう一つの世界樹であるベイズの方法を用いるべきである</strong>．</p>
<p>これを，科学における再現性の危機を例にとって確認したい．<sup>11</sup></p>
<section id="sec-replication-crisis" class="level4" data-number="2.3.1">
<h4 data-number="2.3.1" class="anchored" data-anchor-id="sec-replication-crisis"><span class="header-section-number">2.3.1</span> 再現性の危機</h4>
<p>多くの実験科学では不確実性の定量化が必要不可欠である <span class="citation" data-cites="Krzywinski-Altman2013">(Krzywinski &amp; Altman, 2013)</span>．</p>
<blockquote class="blockquote">
<p>It is necessary and true that all of the things we say in science, all of the conclusions, are uncertain … <span class="citation" data-cites="Feynman1998">(Feynman, 1998)</span></p>
</blockquote>
<p><a href="https://ja.wikipedia.org/wiki/%E5%86%8D%E7%8F%BE%E6%80%A7%E3%81%AE%E5%8D%B1%E6%A9%9F"><strong>再現性の危機</strong></a> (replication crisis) とは，多くの実験において報告されている統計的有意性が，再現実験において得られないことが多いという問題を指し，2010年代の初めから多くの科学分野において問題として取り上げられてきた．<sup>12</sup></p>
<p>その理由は明白である．<strong>信頼区間は集合値の推定量であるため，「分散」が十分大きいならば，データセットを変えて何回も計算することでいずれは非自明なものを得ることが出来るのである</strong>．そのため，信頼区間や <img src="https://latex.codecogs.com/png.latex?P">-値を報告するだけでは，結果の信頼性については何も保証されないのである．</p>
<p>その結果多くの科学分野では <strong>Bayes 統計学による不確実性の定量化に移行しつつある</strong> <span class="citation" data-cites="Herzog-Ostwald2013">(Herzog &amp; Ostwald, 2013)</span>, <span class="citation" data-cites="Trafimow-Marks2015">(Trafimow &amp; Marks, 2015)</span>, <span class="citation" data-cites="Nuzzo2014">(Nuzzo, 2014)</span>．</p>
<p>信頼区間と信用区間の違いに注目して，その違いを解説する．</p>
</section>
<section id="信頼区間と信用区間" class="level4" data-number="2.3.2">
<h4 data-number="2.3.2" class="anchored" data-anchor-id="信頼区間と信用区間"><span class="header-section-number">2.3.2</span> 信頼区間と信用区間</h4>
<p>「95 % の信頼区間」と言ったとき，「95 % の確率で真の値がその範囲に含まれるような区間」だと思いがちであるが，これはどちらかというと信用区間の説明であり，<strong>信頼区間は計算するごとに値が変わってしまう確率変数である</strong> ことを見落としがちである．<sup>13</sup></p>
<p>つまり，信頼区間は頻度論的な概念であり，「真の値」がまず存在し，区間自体が変動し，95 % の確率で被覆するというのである．今回見ている信頼区間が，別のデータセットで計算した場合にどう変わるかについては全く未知である．</p>
<p>このことは，信頼区間は「真のパラメータの値」で条件づけて得るものであるが，信用区間はデータによって条件づけて得るものであるという点で違う，とまとめられる．この２つの混同は「何で条件づけているか？」を意識することで回避することができる．<sup>14</sup></p>
<p>誤解を恐れず言うならば，再現性の危機とは，信頼区間というサイコロの出目によって科学が踊らされていたということに他ならない <span class="citation" data-cites="Nuzzo2014">(Nuzzo, 2014)</span>．<sup>15</sup></p>
</section>
<section id="なぜベイズを用いれば良いのか" class="level4" data-number="2.3.3">
<h4 data-number="2.3.3" class="anchored" data-anchor-id="なぜベイズを用いれば良いのか"><span class="header-section-number">2.3.3</span> なぜベイズを用いれば良いのか？</h4>
<p>これは，信頼区間や <img src="https://latex.codecogs.com/png.latex?P">-値などの頻度論的な手法は，しばしば尤度原理に違反するためである．<sup>16</sup></p>
<p>換言すれば，何らかのモデルと事前分布に関するベイズ手法と等価である，すなわち，Bayesianly justifiable <span class="citation" data-cites="Rubin1984">(Rubin, 1984)</span> とみなせない手法は，何らかの意味でデータを十分に反映できていない可能性が高くなる．</p>
<p>従って，ベイズの手法が原理的に最も適切である場面が多い．一方でその計算の困難さや，全てのステップをモデリング段階に組み込む点を回避するために，種々の頻度論的な実装は考え得て，頻度論的な手法はそのような運用においては健全であるとの指標にもなる．<sup>17</sup></p>
<p>Bayes により手法を理解し，頻度論的に手法を実装することが，あるべき姿勢であると思われる．</p>
<blockquote class="blockquote">
<p>The applied statistician should be Bayesian in principle and calibrated to the real world in practice. <span class="citation" data-cites="Rubin1984">(Rubin, 1984)</span></p>
</blockquote>
</section>
</section>
<section id="ベイズ深層学習という夢" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="ベイズ深層学習という夢"><span class="header-section-number">2.4</span> ベイズ深層学習という夢</h3>
<p>深層モデルはその性能の高さから，最も実世界応用が期待されるモデルであるが，パラメータが極めて多いため，特にベイズ化することが難しいと言われている．</p>
<p>例えば，ハルシネーション (hallucination) として，LLM が「事実に基づかない」情報を生成してしまうことが問題とされているが，これも不確実性の定量化の問題に他ならない．<sup>18</sup></p>
<p>その他の場面でも，不確実性の定量化には conformal prediction などの事後的な手法が試みられている．<sup>19</sup> これらはどのようなブラックボックスに対しても適用可能である一方で，対症療法というべきものであり，ベイズ流の解釈をすることで直接的に事後分布を求めるという根本的な解決にも，もっと注力されるべきである．</p>
<p>ベイズによる不確実性の定量化は，自然であるだけでなく，より有用な不確実性の定量化を与えるものだと予想している．<sup>20</sup></p>
<p>加えて，事前分布を変えることで，種々の帰納バイアスを加えるという「プロンプトエンジニアリング」ならぬ「プライヤーエンジニアリング」の理論が樹立できるかもしれない．すでに，公平性，同変性，スパース性，共変量シフトへの頑健性などを達成するための事前分布が考えられている．<sup>21</sup></p>
</section>
<section id="分野全体の動向" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="分野全体の動向"><span class="header-section-number">2.5</span> 分野全体の動向</h3>
<p>現状の機械学習モデルと実応用との乖離は，他の側面でも生じている．</p>
<p>まず，訓練データが実際の運用環境を十分に反映できていないということは極めて頻繁に起こるだろう．この現象を <strong>分布シフト</strong> といい，機械学種モデルの予測性能だけで無く，分布外汎化 (out-of-distribution generalization) 能力も重視するという潮流が生じている．</p>
<p>さらに，一度訓練したモデルを，分布シフト自体が移り変わっていく環境で，微調整のみによって繰り返し使い続けるという使用を想定した <strong>継続学習</strong> (continual learning) という考え方もある．<sup>22</sup></p>
<p>章を変えて別の角度から議論を続けよう．</p>
</section>
</section>
<section id="sec-distributional-representation" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="sec-distributional-representation"><span class="header-section-number">3</span> ベイズは分布という共通言語を与える</h2>
<section id="継続学習という発想" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="継続学習という発想"><span class="header-section-number">3.1</span> 継続学習という発想</h3>
<p>継続学習は，機械学習モデルをより動的で実際的な環境でも使えるようにするための新たな枠組みである．そこまで，教師あり学習モデルがすでに実用的な性能を獲得したということでもある．</p>
<p>つまり，単に「教師あり」「教師なし」の１タスクを解く営みは爛熟しつつあり，機械学習の理論と応用の最先端は，より深い森に分け入りつつあるのである．</p>
<p>ここにおいて，ベイズ流の接近が統一的な取り扱いを与えるという美点が，さらに重要でもはや必要不可欠な役割を果たすものと思われる．</p>
<section id="ベイズ推論が与える統一的枠組み" class="level4" data-number="3.1.1">
<h4 data-number="3.1.1" class="anchored" data-anchor-id="ベイズ推論が与える統一的枠組み"><span class="header-section-number">3.1.1</span> ベイズ推論が与える統一的枠組み</h4>
<p>ベイズ推論とは，<strong>事前分布</strong> というものを設定して，これをデータによって更新するという営みである（その更新規則は Bayes の公式が与える）．</p>
<p>事前分布をどう設定すれば良いか？の問題は，ベイズ推論の初期からの問題であった．極めて自由度が高いことが，逆にベイズ推論が実際のデータ解析の場面において敬遠される一因ともなっていた．</p>
</section>
<section id="ベイズと最適化との協業" class="level4" data-number="3.1.2">
<h4 data-number="3.1.2" class="anchored" data-anchor-id="ベイズと最適化との協業"><span class="header-section-number">3.1.2</span> ベイズと最適化との協業</h4>
<p>しかし，継続学習が当たり前になった社会において，全てのパラメータ値を事前分布と事後分布とみなし，全ての学習過程をベイズの公式という統一的な方法で更新すると捉えられることは，極めて大きな利点になり得る．</p>
<p>というのも，継続学習においては，学習を繰り返すうちに過去に学んだ内容を忘れ去ってしまうという <strong>壊滅的忘却</strong> (catastrophically forgetting) が最大の困難である．</p>
<p>理論的には，分布のベイズ更新の繰り返しとして見る方が極めて見通しが良い．一方で，事後分布の近似が十分でない場合，実際にベイズ更新を行うことは性能に悪影響を与える．</p>
<p>そこで，理論解析や設計をベイズの観点から行い，実際の推論は最適化ベースで行うという適材適所により，壊滅的忘却を緩和できる可能性がある <span class="citation" data-cites="Farquhar-Gal2019">(Farquhar &amp; Gal, 2019)</span>．</p>
</section>
</section>
<section id="例強化学習への分布によるアプローチ" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="例強化学習への分布によるアプローチ"><span class="header-section-number">3.2</span> 例：強化学習への分布によるアプローチ</h3>
<blockquote class="blockquote">
<p>we believe the value distribution has a central role to play in reinforcement learning. <span class="citation" data-cites="Bellemare+2017">(Bellemare et al., 2017)</span></p>
</blockquote>
</section>
</section>
<section id="sec-inductive-bias" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="sec-inductive-bias"><span class="header-section-number">4</span> ベイズは理解を促進する</h2>
<p>我々はもはや機械学習を通じて，自分たちが何をやっているのかわかっていない．この愚かさを AI に継がせてはならない．</p>
<section id="なぜベイズ法の発展が遅れたか" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="なぜベイズ法の発展が遅れたか"><span class="header-section-number">4.1</span> なぜベイズ法の発展が遅れたか？</h3>
<p>ベイズ法の採用は，自分たちが何をやっているかへの理解と解釈可能性を刺激するという側面がある．</p>
<p>その理由は簡単である．ベイズ推論は，モデルとその上の事前分布を定めれば，あとはベイズ更新規則をどう計算するかの問題となり，近似手法は様々あれど，<strong>もはや推論手法に選択の余地はない</strong>．</p>
<p>換言すれば，その分解析者がモデルと事前分布の特定を全てこなす必要があるのであり，<strong>解析者に確率モデリングへの理解を強要する</strong>ところがある．</p>
<p>しかしこれは「面倒なことは全てアルゴリズムにやってほしい」という精神とは対立するため，ベイズの美点であると同時に，ベイズの発展を阻害してきた遠因の一つでもあった．</p>
<p>これを指して「事前分布の選択に恣意性が入る」という通り文句がよく使われるが，<u>実際は，頻度論的手法における「どのような目的関数をどのように最適化すれば良いか？」という恣意性に変換されているのみであり，問題を先送りにして，「ベイズ法 対 頻度論的手法」という虚構の対立を作り上げているのみである</u>．</p>
<p>機械学習のポテンシャルが具現化したいまこそ，この困難に立ち向かう必要があるが，この問題は最適化や頻度論的な立場から見るより，ベイズの立場から見た方が，理論的な見通しが良いようである（第 4.4 節）．</p>
</section>
<section id="帰納バイアスの明確化の必要性" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="帰納バイアスの明確化の必要性"><span class="header-section-number">4.2</span> 帰納バイアスの明確化の必要性</h3>
<p>機械学習の真の理解のためには，各モデルの帰納バイアスを明確化する必要がある．</p>
<section id="帰納バイアスとは何か" class="level4" data-number="4.2.1">
<h4 data-number="4.2.1" class="anchored" data-anchor-id="帰納バイアスとは何か"><span class="header-section-number">4.2.1</span> 帰納バイアスとは何か？</h4>
<p>現状の AI システムは大量のラベル付きデータが必要であり，多くの現実的に有用なタスクでこのような教師データが用意できるわけではない．</p>
<p>一方で，人間は遥かに少ないデータから効率的に学習することができる．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/Kernels/Images/model_sizes.png" class="img-fluid figure-img"></p>
<figcaption>Number of Training Tokens <a href="https://babylm.github.io/">BabyLM Challenge</a></figcaption>
</figure>
</div>
<p>その違いは，進化が我々生物に授けた <strong>帰納バイアス</strong> にあると考えられている．</p>
<p>我々には遺伝的に継がれている生まれ持った学習特性があり，より効率的に学習出来るのかも知れない．</p>
<p>事実，一度事前学習をした LLM は，極めて少ないデータにより新しいタスクを学習することができるがわかりつつある <span class="citation" data-cites="Zhou+2023">(Zhou et al., 2023)</span>．<a href="../../../posts/2024/Kernels/Deep2.html#sec-foundation-model">LLM の事後調整に関する稿</a> も参照．</p>
</section>
<section id="事前分布に向き合わずにやり過ごしてきた" class="level4" data-number="4.2.2">
<h4 data-number="4.2.2" class="anchored" data-anchor-id="事前分布に向き合わずにやり過ごしてきた"><span class="header-section-number">4.2.2</span> 事前分布に向き合わずにやり過ごしてきた</h4>
<p>現状，多くの機械学習手法は確率的な方法を取っていない．これは事前分布を明示せずに（ひょっとしたら明後日の方向に向かって）行われる Bayes 学習手法であるとみなせる．</p>
<p>現状の機械学習の成功は，事前分布に関する知識なしに到達されたものであり，それ故の限界がある．例えば，現状のままではモデルにどのような帰納バイアスが組み込まれているか不明瞭である．<sup>23</sup></p>
</section>
<section id="帰納バイアスに対するベイズ的視点" class="level4" data-number="4.2.3">
<h4 data-number="4.2.3" class="anchored" data-anchor-id="帰納バイアスに対するベイズ的視点"><span class="header-section-number">4.2.3</span> 帰納バイアスに対するベイズ的視点</h4>
<p>データの空間 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BX%7D"> 上の任意のモデル <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BM%7D"> の周辺尤度 <img src="https://latex.codecogs.com/png.latex?p(x%7C%5Cmathcal%7BM%7D)"> は，<sup>24</sup> ベイズ流には事後確率として捉えられ，全てのデータ <img src="https://latex.codecogs.com/png.latex?x%5Cin%5Cmathcal%7BX%7D"> 上に有限な測度を定める．<sup>25</sup></p>
<p>よって，<strong>全てのモデルは，あるデータを得意とするならば他のデータについては不得意であることを免れない</strong>．これは no free lunch 定理と呼ばれる定理の一群により推測されており，分類問題などの簡単なタスクを除いて完全な形式的表現はまだ持たない作業仮設である．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/AI/Images/mackay.png" class="img-fluid figure-img"></p>
<figcaption>A Probabilistic Perspective of Genelization <span class="citation" data-cites="Wilson-Izmailov2020">(Wilson &amp; Izmailov, 2020)</span></figcaption>
</figure>
</div>
<p>例えば，<a href="../../../posts/2024/Kernels/Deep2.html#sec-fine-tuning">基盤モデル</a> とは，インターネット上のデータから最大限人間の言語というものに関する帰納バイアスを取り込んだ，パラメータ上の初期設定であると見れる．</p>
<p>これは，あるパラメータ空間上の理想的な事前分布からのサンプリングであるかも知れない．それ故，種々の下流タスクに対して，小さなモデル変更のみにより適応することが出来る．</p>
<p>大規模言語モデルの能力創発現象は，帰納バイアスを十分取り込むことにより自然に解かれるタスクであったのかもしれない．</p>
</section>
<section id="worst-case-analysis-からの脱皮" class="level4" data-number="4.2.4">
<h4 data-number="4.2.4" class="anchored" data-anchor-id="worst-case-analysis-からの脱皮"><span class="header-section-number">4.2.4</span> worst-case analysis からの脱皮</h4>
<p>帰納バイアスを明確にせず，やり過ごしてきたつけが，特に学習理論においても現れている．</p>
<p>現状の統計的学習理論は全て，worst-case analysis であるが，実用上は全くそうではない．「動くモデル」には暗黙の帰納バイアスが入っており，これに明るくなる必要があるのである．</p>
<p>2024 年に生きる我々は，worst-case analysis からの脱皮を迫られている．</p>
</section>
</section>
<section id="数学者の哲学" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="数学者の哲学"><span class="header-section-number">4.3</span> 数学者の哲学</h3>
<p>Bayes の見方は，機械学習モデルを底流する数理的枠組みになっている．仮に次の <a href="https://ja.wikipedia.org/wiki/%E3%82%BD%E3%83%BC%E3%83%B3%E3%83%80%E3%83%BC%E3%82%B9%E3%83%BB%E3%83%9E%E3%83%83%E3%82%AF%E3%83%AC%E3%83%BC%E3%83%B3">Mac Lane</a> の言葉が数学者のあるべき態度の１つであるとするならば，この意味での数学者には Bayes の立場から機械学習を研究することを特におすすめする．</p>
<blockquote class="blockquote">
<p>However, I persisted in the position that <strong>as mathematicians we must know whereof we speak</strong>, be it a homotopy group or an adjoint functor. <span class="citation" data-cites="MacLane1983">(Mac&nbsp;Lane, 1983, p. 55)</span></p>
</blockquote>
<p>数理統計学に始まり，数学者の統計や機械学習分野への参入は，推論手法の解析が想像されるかも知れない．</p>
<p>しかし，真の数学的理解は，手法の数学的な機械仕掛けを紐解くだけでなく，それぞれの手法がモデルとしてどのような仮定の下で成り立っているかを，モデリングの観点から理解することにもあると筆者には思われる．</p>
<p>現状，後者の視点が大変に不足しており，数理的な知識に支えられた大局観というものがない．<u><strong>個々の数学的な道具に捉われず，大局的な構造を捉える数理的枠組みが必要である</strong></u>．</p>
<p>これに応えるのがベイズの枠組みであると筆者は信じる．</p>
<p>推論とモデリングという双対的な営みは深い数理的な構造を持っていることが明らかになりつつある．この大局的構造の解明と理論構築には，ベイズの観点から光を照らしてくれるような，<strong>Mac Lane の意味での数学者的な魂</strong>が必要とされているのである．</p>
<section id="bayes-の数学" class="level4" data-number="4.3.1">
<h4 data-number="4.3.1" class="anchored" data-anchor-id="bayes-の数学"><span class="header-section-number">4.3.1</span> Bayes の数学</h4>
<p>Bayes 流の解釈では，どんなにモデルが複雑で巨大になろうとも，推論とは積分に他ならない．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://162348.github.io/posts/2024/AI/Images/Bayes.svg" class="img-fluid figure-img"></p>
<figcaption>Bayes’ Theorem (density form)</figcaption>
</figure>
</div>
<p>全ての（尤度原理に則った）推論は，事後分布の関数としてなされる（べきである）．</p>
<p>実際の実装は，その近似として実行される（べきである）．</p>
<p>よって，実装とモデリングの段階を明確に分離する枠組みを提供している上に，極めて普遍的な枠組みである．</p>
<p>というのも，Bayes 流のモデリングは，<a href="../../../posts/2023/Probability/MarkovCategory.html">Markov 圏</a> 上の図式と見ることができ（第 5.2 節），普遍的である上に，数学的にも最も直接的で直感的な表現であると思われる．</p>
<p>圏として持つ代数的性質は，モデルの結合・分解が自由に出来るということに繋がり，<a href="https://ja.wikipedia.org/wiki/%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB">モジュール性</a> が高いということになる．</p>
<blockquote class="blockquote">
<p>I basically know of two principles for treating complicated systems in simple ways: the ﬁrst is the <strong>principle of modularity</strong> and the second is the <strong>principle of abstraction</strong>. I am an apologist for computational probability in machine learning because I believe that <strong>probability theory implements these two principles in deep and intriguing ways</strong> — namely through factorization and through averaging. Exploiting these two mechanisms as fully as possible seems to me to be the way forward in machine learning. Michael I. Jordan excerpted from <span class="citation" data-cites="Frey1998">(Frey, 1998)</span></p>
</blockquote>
<p>分布を明示的に用いた <a href="../../../static/Notations.html#sec-kernels"><strong>確率核</strong></a> を通じてのモデリングは，なぜだか数学的に極めて自然なアプローチを提供してくれるようである．</p>
</section>
<section id="ベイズの代数幾何解析" class="level4" data-number="4.3.2">
<h4 data-number="4.3.2" class="anchored" data-anchor-id="ベイズの代数幾何解析"><span class="header-section-number">4.3.2</span> ベイズの代数・幾何・解析</h4>
<p>上述したように，ベイズのモデリング法と学習規則は本質的に代数的なところがある．</p>
<p>加えて，分布を基本言語とするために，ベイズ推論においては空間 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(%5Cmathcal%7BX%7D)%5Csubset%5Cmathcal%7BM%7D%5E1(%5Cmathcal%7BX%7D)"> が極めて基本的な役割を果たす．</p>
<p>サンプリングは <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(%5Cmathcal%7BX%7D)"> 上の幾何学に関係が深く，情報幾何学や最適輸送などの発展が見られている．</p>
<p>一方で最適化は <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(%5Cmathcal%7BX%7D)"> 上の解析学に関係が深く，古くから機械学習分野では <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(%5Cmathcal%7BX%7D)"> 上の様々な汎函数が <strong>ダイバージェンス</strong> の名前で考察されており，その勾配流として種々の最適化手法が理解できる．</p>
</section>
<section id="bayes-に繋げる数学" class="level4" data-number="4.3.3">
<h4 data-number="4.3.3" class="anchored" data-anchor-id="bayes-に繋げる数学"><span class="header-section-number">4.3.3</span> Bayes に繋げる数学</h4>
<p>通常の頻度論的手法は，うまくいくことが先であり，理論が後付けされる．そしてその理論もどこか ad-hoc というべきであり，worst-case で漸近論的である．</p>
<p>これらに Bayes 的な解釈を与えることで，暗黙のうちにどのような仮定を課しているモデリング手法に相等するのか明確にされる．特に，非漸近論的な知見を与えてくれる数少ないの道の一つである．</p>
</section>
</section>
<section id="sec-Bayesian-rule" class="level3" data-number="4.4">
<h3 data-number="4.4" class="anchored" data-anchor-id="sec-Bayesian-rule"><span class="header-section-number">4.4</span> ベイズ推論とみる美点</h3>
<p>ベイズ推論自体への理解だけでなく，種々の頻度論的手法を（特定の環境下での）ベイズ推論の近似として理解することは，新たなアルゴリズムの開発に有用であるという合意が形成されつつあるようである．<sup>26</sup></p>
<p>最適化に基づく手法の計算効率性は，正確なベイズ推論に勝る場面も多い．ここで注意すべきは，ベイズ推論の実行が肝要であり，その実装は最適化に依ろうと，積分近似に依ろうと大した違いではないのである．</p>
<p>「ベイズ推論は多くの最尤法に基づく手法よりも，自然な正則化がなされるために過学習の問題がない．」と説明されるが<u><strong>本来は逆である</strong></u>．多くの最適化に基づく手法は，目的関数の選択に恣意性があり，その選択を誤り続けているために過学習という問題が生じている，という方が，後世の教科書に載る表現なのではないかと筆者は考えている．</p>
<p>そこで，種々の既存手法のベイズ流の解釈を探究することは，より良い推論アルゴリズムの開発に資すると考えられている．</p>
<p>この方向の近年の発展をいくつか紹介したい．</p>
<section id="ベイズ学習規則" class="level4" data-number="4.4.1">
<h4 data-number="4.4.1" class="anchored" data-anchor-id="ベイズ学習規則"><span class="header-section-number">4.4.1</span> ベイズ学習規則</h4>
<p>現状の機械学習は，統計学，連続最適化，計算機科学の知識を総動員して開発された種々の推論手法によって支えられている．</p>
<p>その性能は驚異的なスピードで向上しているが，それぞれの手法がどのような仮定をモデリングの段階で課しているかが不明瞭であり，どの手法を使うべきかの統一的な枠組みは得られていない．</p>
<p>この現状の抜本的な改善が，それぞれの手法のベイズ流の解釈を探究することで得られると考えられる．</p>
<p>その枠組みの一つが <strong>ベイズ学習規則</strong> <span class="citation" data-cites="Khan-Rue2023">(Khan &amp; Rue, 2023)</span> である．</p>
<p><span class="citation" data-cites="Khan-Rue2023">(Khan &amp; Rue, 2023, p. 4)</span> では，ベイズ流の解釈を持つ種々の手法が他より優れている理由として，目的関数に現れるエントロピー項が <strong>自然勾配</strong> の概念を通じて自然な正則化を与えることが，ベイズ学習規則という新たな理論的枠組みの中で示されている．</p>
</section>
<section id="例強化学習" class="level4" data-number="4.4.2">
<h4 data-number="4.4.2" class="anchored" data-anchor-id="例強化学習"><span class="header-section-number">4.4.2</span> 例：強化学習</h4>
<p>強化学習でも，モデルベースのアプローチが取り入れられつつあり <span class="citation" data-cites="Deisenroth-Rasmussen2011">(Deisenroth &amp; Rasmussen, 2011)</span>，さらに学習と制御をベイズ推論と見ることが，アルゴリズムの設計において有用であることが提唱されつつある：</p>
<blockquote class="blockquote">
<p>Crucially, in the framework of PGMs, it is sufficient to write down the model and pose the question, and the objectives for learning and inference emerge automatically. <span class="citation" data-cites="Levine2018">(Levine, 2018)</span></p>
</blockquote>
</section>
</section>
</section>
<section id="bayes-機械学習の例" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="bayes-機械学習の例"><span class="header-section-number">5</span> Bayes 機械学習の例</h2>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="要約">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
要約
</div>
</div>
<div class="callout-body-container callout-body">
<p>深層学習モデルにより教師あり学習は十分に発展し，多くの訓練データが得られる場面では驚異的な性能を発揮するようになった．</p>
<p>この発展は，モデリングの仮定に捉われずに純粋にアルゴリズムの開発に集中することが出来るという頻度論的な枠組みの利点を有効活用する形で達成された．</p>
<p>しかし，殆どの実世界応用では，不確実性のモデリングが必要不可欠である．この点を後回しにして性能を追求することで得た栄華である．だからこそ，極めて高い性能を誇るモデルを，実世界応用の場面で有効活用する手段を我々はまだ知らないのである．</p>
<p>その鍵はベイズにある．安全性，信頼性，柔軟性……．これらの21世紀の社会の要請に応えるためには，ベイズ機械学習手法の発展と，既存の手法のベイズ流の理解とが追いつくことが，第一歩である．</p>
</div>
</div>
<p>既存の深層学習モデルは，「教師あり学習」という枠組みや，画像の分類タスクや自然言語処理のタスクなど，広く周知された問題設定とデータセットが存在する．</p>
<p>一方で，ベイズ機械学習における対応物はまだ十分に周知されていないようである．</p>
<p>ベイズ機械学習では「損失を最小化する」という枠組みの中でなるべく性能の良い推論手法を探す，というわかりやすい枠組みがある訳ではないようである．</p>
<p>そこで，本章ではベイズ機械学習の近年の発展を概観することを試みる．</p>
<section id="bayes-深層学習" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="bayes-深層学習"><span class="header-section-number">5.1</span> Bayes 深層学習</h3>
<p>ニューラルネットワークモデルは，隠れ素子数が無限大になる極限において，Gauss 過程モデルに漸近することが知られている <span class="citation" data-cites="Neal1996">(Neal, 1996)</span>．Gauss 過程とはノンパラメトリックなベイズ機械学習手法の代表である．この対応を通じて，深層学習のベイズ流の解釈が進められている．</p>
<p>この稿の執筆後，本稿をまとめるかのようなアブストラクトを持ったポジションペーパー <span class="citation" data-cites="Papamarkou+2024">(Papamarkou et al., 2024)</span> が公開された</p>
<blockquote class="blockquote">
<p>In the current landscape of deep learning research, there is a predominant emphasis on achieving high predictive accuracy in supervised tasks involving large image and language datasets. However, a broader perspective reveals a multitude of overlooked metrics, tasks, and data types, such as uncertainty, active and continual learning, and scientific data, that demand attention. Bayesian deep learning (BDL) constitutes a promising avenue, offering advantages across these diverse settings. <span class="citation" data-cites="Papamarkou+2024">(Papamarkou et al., 2024)</span></p>
</blockquote>
<p>深層学習をベイズ化することで，上にあげた</p>
<ul>
<li>不確実性の自然な定量化</li>
<li>継続学習への柔軟な接続</li>
<li>科学的営みの促進</li>
</ul>
<p>などが目指せる．特に，現状の大規模な基盤モデルをベイズ化する悲願を真っ向から論じている．</p>
</section>
<section id="sec-graphical-model" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="sec-graphical-model"><span class="header-section-number">5.2</span> 確率的グラフィカルモデル</h3>
<p>歴史的に，（確率的）モデリングは，主に（確率的）グラフィカルモデルを通じて機械学習の分野に導入された．</p>
<p>そのため，20世紀に入ったばかりの頃は，Bayes 機械学習の唯一の例は確率的グラフィカルモデルなのであった．<sup>27</sup></p>
<p>だが，確率的グラフィカルモデルは，極めて普遍的で，従来の因果推論・階層モデル・欠測モデル・潜在変数モデル・構造方程式モデルなどの発展を包含する統一的な枠組みであることをより広く認識すべきである．</p>
<section id="ベイジアンネットワーク" class="level4" data-number="5.2.1">
<h4 data-number="5.2.1" class="anchored" data-anchor-id="ベイジアンネットワーク"><span class="header-section-number">5.2.1</span> ベイジアンネットワーク</h4>
<p>Bayesian Network は Markov 圏上の図式であり，方向関係のある変数間の関係をモデリングする最も直接的な方法である．</p>
</section>
<section id="構造的因果モデル" class="level4" data-number="5.2.2">
<h4 data-number="5.2.2" class="anchored" data-anchor-id="構造的因果モデル"><span class="header-section-number">5.2.2</span> 構造的因果モデル</h4>
</section>
<section id="階層モデル" class="level4" data-number="5.2.3">
<h4 data-number="5.2.3" class="anchored" data-anchor-id="階層モデル"><span class="header-section-number">5.2.3</span> 階層モデル</h4>
<p>階層モデルとは，ベイズの枠組みでは，観測変数・潜在変数の区別なく，モデルを自由に結合出来る点を利用したモデリング手法である．</p>
</section>
<section id="モデルの属人化" class="level4" data-number="5.2.4">
<h4 data-number="5.2.4" class="anchored" data-anchor-id="モデルの属人化"><span class="header-section-number">5.2.4</span> モデルの属人化</h4>
<p>大きなデータも，属人化医療や推薦システムなど多くの文脈では小さなデータの寄せ集めであり，そうでなくともその構造を正しく捉え，全ての不確実性を取り入れた柔軟なモデリングをすることで，さらに密接な形で社会に取り入れることができる．<sup>28</sup></p>
</section>
</section>
<section id="確率的プログラミング" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="確率的プログラミング"><span class="header-section-number">5.3</span> 確率的プログラミング</h3>
<section id="アルゴリズムのプログラミングからモデルのプログラミングへ" class="level4" data-number="5.3.1">
<h4 data-number="5.3.1" class="anchored" data-anchor-id="アルゴリズムのプログラミングからモデルのプログラミングへ"><span class="header-section-number">5.3.1</span> アルゴリズムのプログラミングから，モデルのプログラミングへ</h4>
<p>ベイズ流の解釈では，解析者の恣意的な選択はモデリングの段階に集中しており，モデルが決定すれば推論手法は自動的に従う．</p>
<p>このパラダイムでは，推論手法は背後に隠し，解析者はモデリングに集中するための新たなプログラミング言語があっても良いはずである．</p>
<p>このような言語を <strong>確率的プログラミング</strong> (Probabilistic Programming) 言語と呼ぶ．</p>
</section>
<section id="確率的プログラミングはグラフィカルモデルの拡張である" class="level4" data-number="5.3.2">
<h4 data-number="5.3.2" class="anchored" data-anchor-id="確率的プログラミングはグラフィカルモデルの拡張である"><span class="header-section-number">5.3.2</span> 確率的プログラミングはグラフィカルモデルの拡張である</h4>
<p>確率的グラフィカルモデルをどのようにプログラムに落とし込むかというと，確率核をシミュレーターとして実装するのである．</p>
<p>逆に，シミュレーションが可能な限りどのようなモデルも実装できるので，確率的グラフィカルモデルの真の拡張であると言える．<sup>29</sup></p>
</section>
<section id="simulation-based-inference" class="level4" data-number="5.3.3">
<h4 data-number="5.3.3" class="anchored" data-anchor-id="simulation-based-inference"><span class="header-section-number">5.3.3</span> Simulation-based Inference</h4>
<p>上述の通り，シミュレーターがあればモデルが定義でき，モデルがあれば推論ができる．さらに，棄却法，重点サンプリング法，MCMC，SMC などの Monte Carlo 法のレパートリーにより，殆どあらゆるシミュレーションと推論が統一的に実行できる．これが Bayes 推論の強みである．</p>
</section>
</section>
<section id="bayes-最適化" class="level3" data-number="5.4">
<h3 data-number="5.4" class="anchored" data-anchor-id="bayes-最適化"><span class="header-section-number">5.4</span> Bayes 最適化</h3>
<p>ベイズはシステムの一部として自然に組み込まれると論じたが（第 2.1 節），現状その最先端をいくのがベイズ最適化の分野である．</p>
<p>ベイズ最適化は最も簡単な形では，未知の関数 <img src="https://latex.codecogs.com/png.latex?f:X%5Cto%5Cmathbb%7BR%7D"> の最大値点を求める問題を，<a href="https://en.wikipedia.org/wiki/Sequential_analysis">逐次意思決定問題</a> として解く手法である．</p>
<p>ベイズ数値計算 <span class="citation" data-cites="Hagen1991">(O’Hagan, 1991)</span> の現代的な再解釈とも捉えられる．<sup>30</sup></p>
<p>この際，未知の関数 <img src="https://latex.codecogs.com/png.latex?f"> を Gauss 過程などでモデリングし，不確実性の高い点からサンプル <img src="https://latex.codecogs.com/png.latex?f(x_1),f(x_2),%5Ccdots"> を取って最も効率の良い方法で最大化していくことを目指す．</p>
<p>ベイズ最適化は多腕バンディット問題と関係が深く，２つの問題は共に一方向のエージェント・環境相互作用しか仮定していないという形での強化学習への入り口である．</p>
</section>
<section id="確率的データ圧縮" class="level3" data-number="5.5">
<h3 data-number="5.5" class="anchored" data-anchor-id="確率的データ圧縮"><span class="header-section-number">5.5</span> 確率的データ圧縮</h3>
<p>殆どの（可逆）データ圧縮アルゴリズムは，シンボルの列に対する確率的モデリングと等価である．<sup>31</sup> そしてモデルの予測精度が良いほど，データの圧縮率は高い．</p>
<p>したがって，より良いベイズ（ノンパラメトリック）モデルの開発と，より幅広いデータに対するデータ圧縮技術の発展とは両輪である．<sup>32</sup></p>
</section>
<section id="モデルの自動発見" class="level3" data-number="5.6">
<h3 data-number="5.6" class="anchored" data-anchor-id="モデルの自動発見"><span class="header-section-number">5.6</span> モデルの自動発見</h3>
<p>機械学習の精神の一つに，データからの知識獲得をなるべく自動化したいというものがある．</p>
<p>ベイズの方から，統計解析自体を自動化する Automatic Statistician <span class="citation" data-cites="Lloyd+2014">(Lloyd et al., 2014)</span> という試みがある．これはデータを説明するモデルを自動発見し，結果を自然言語でまとめてくれる上に，モデルに含まれる不確実性に関しても報告してくれる．</p>



</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-Amershi+2019" class="csl-entry">
Amershi, S., Weld, D., Vorvoreanu, M., Fourney, A., Nushi, B., Collisson, P., Suh, J., Iqbal, S., Bennett, P. N., Inkpen, K., Teevan, J., Kikin-Gil, R., &amp; Horvitz, E. (2019). Guidelines for human-AI interaction. <em>Proceedings of the 2019 CHI Conference on Human Factors in Computing Systems</em>, 1–13. <a href="https://doi.org/10.1145/3290605.3300233">https://doi.org/10.1145/3290605.3300233</a>
</div>
<div id="ref-Angrist-Pischke2010" class="csl-entry">
Angrist, J. D., &amp; Pischke, J.-S. (2010). The credibility revolution in empirical economics: How better research design is taking the con out of econometrics. <em>The Journal of Economic Perspectives</em>, <em>24</em>(2), 3–30. <a href="http://www.jstor.org/stable/25703496">http://www.jstor.org/stable/25703496</a>
</div>
<div id="ref-Bensal+2019" class="csl-entry">
Bansal, G., Nushi, B., Kamar, E., Weld, D. S., Lasecki, W. S., &amp; Horvitz, E. (2019). Updates in human-AI teams: Understanding and addressing the performance/compatibility tradeoff. <em>Proceedings of the AAAI Conference on Artificial Intelligence</em>, <em>33</em>(01), 2429–2437. <a href="https://doi.org/10.1609/aaai.v33i01.33012429">https://doi.org/10.1609/aaai.v33i01.33012429</a>
</div>
<div id="ref-Bellemare+2017" class="csl-entry">
Bellemare, M. G., Dabney, W., &amp; Munos, R. (2017). A distributional perspective on reinforcement learning. In D. Precup &amp; Y. W. Teh (Eds.), <em>Proceedings of the 34th international conference on machine learning</em> (Vol. 70, pp. 449–458). PMLR. <a href="https://proceedings.mlr.press/v70/bellemare17a.html">https://proceedings.mlr.press/v70/bellemare17a.html</a>
</div>
<div id="ref-Broderick+2023" class="csl-entry">
Broderick, T., Gelman, A., Meager, R., Smith, A. L., &amp; Zheng, T. (2023). Toward a taxonomy of trust for probabilistic machine learning. <em>Science Advances</em>, <em>9</em>(7), eabn3999. <a href="https://doi.org/10.1126/sciadv.abn3999">https://doi.org/10.1126/sciadv.abn3999</a>
</div>
<div id="ref-Chen+2023" class="csl-entry">
Chen, J., Monica, J., Chao, W.-L., &amp; Campbell, M. (2023). <em>Probabilistic uncertainty quantification of prediction models with application to visual localization</em>. <a href="https://arxiv.org/abs/2305.20044">https://arxiv.org/abs/2305.20044</a>
</div>
<div id="ref-Deisenroth-Rasmussen2011" class="csl-entry">
Deisenroth, M. P., &amp; Rasmussen, C. E. (2011). PILCO: A model-based and data-efficient approach to policy search. <em>Proceedings of the 28th International Conference on International Conference on Machine Learning</em>, 465–472.
</div>
<div id="ref-Efron1986" class="csl-entry">
Efron, B. (1986). Why isn’t everyone a bayesian? <em>The American Statistician</em>, <em>40</em>(1), 1–5. <a href="http://www.jstor.org/stable/2683105">http://www.jstor.org/stable/2683105</a>
</div>
<div id="ref-Farquhar-Gal2019" class="csl-entry">
Farquhar, S., &amp; Gal, Y. (2019). <em>A unifying bayesian view of continual learning</em>. <a href="https://arxiv.org/abs/1902.06494">https://arxiv.org/abs/1902.06494</a>
</div>
<div id="ref-Feynman1998" class="csl-entry">
Feynman, R. P. (1998). <em><a href="">The meaning of it all: Thoughts of a citizen scientist</a></em>. Addison-Wesley.
</div>
<div id="ref-Frey1998" class="csl-entry">
Frey, B. J. (1998). <em>Graphical models for machine learning and digital communication</em>. The MIT Press. <a href="https://mitpress.mit.edu/9780262062022/graphical-models-for-machine-learning-and-digital-communication/">https://mitpress.mit.edu/9780262062022/graphical-models-for-machine-learning-and-digital-communication/</a>
</div>
<div id="ref-Gal-Ghahramani2016" class="csl-entry">
Gal, Y., &amp; Ghahramani, Z. (2016). Dropout as a bayesian approximation: Representing model uncertainty in deep learning. In M. F. Balcan &amp; K. Q. Weinberger (Eds.), <em>Proceedings of the 33rd international conference on machine learning</em> (Vol. 48, pp. 1050–1059). PMLR. <a href="https://proceedings.mlr.press/v48/gal16.html">https://proceedings.mlr.press/v48/gal16.html</a>
</div>
<div id="ref-Ghahramani2015" class="csl-entry">
Ghahramani, Z. (2015). Probabilistic machine learning and artificial intelligence. <em>Nature</em>, <em>521</em>, 452–459. <a href="https://www.nature.com/articles/nature14541">https://www.nature.com/articles/nature14541</a>
</div>
<div id="ref-Herzog-Ostwald2013" class="csl-entry">
Herzog, S., &amp; Ostwald, D. (2013). Sometimes bayesian statistics are better. <em>Nature</em>, <em>494</em>(7435), 35–35. <a href="https://doi.org/10.1038/494035b">https://doi.org/10.1038/494035b</a>
</div>
<div id="ref-Khan-Rue2023" class="csl-entry">
Khan, M. E., &amp; Rue, H. (2023). The bayesian learning rule. <em>Journal of Machine Learning Research</em>, <em>24</em>(281), 1–46. <a href="http://jmlr.org/papers/v24/22-0291.html">http://jmlr.org/papers/v24/22-0291.html</a>
</div>
<div id="ref-Krzywinski-Altman2013" class="csl-entry">
Krzywinski, M., &amp; Altman, N. (2013). Importance of being uncertain. <em>Nature Methods</em>, <em>10</em>(9), 809–810. <a href="https://doi.org/10.1038/nmeth.2613">https://doi.org/10.1038/nmeth.2613</a>
</div>
<div id="ref-Levine2018" class="csl-entry">
Levine, S. (2018). <em>Reinforcement learning and control as probabilistic inference: Tutorial and review</em>. <a href="https://arxiv.org/abs/1805.00909">https://arxiv.org/abs/1805.00909</a>
</div>
<div id="ref-Lloyd+2014" class="csl-entry">
Lloyd, J. R., Duvenaud, D., Grosse, R., Tenenbaum, J. B., &amp; Ghahramani, Z. (2014). Automatic construction and natural-language description of nonparametric regression models. <em>Proceedings of the Twenty-Eighth AAAI Conference on Artificial Intelligence</em>, 1242–1250.
</div>
<div id="ref-MacLane1983" class="csl-entry">
Mac&nbsp;Lane, S. (1983). The health of mathematics. <em>The Mathematical Intelligencer</em>, <em>5</em>(4), 53–56. <a href="https://doi.org/10.1007/BF03026510">https://doi.org/10.1007/BF03026510</a>
</div>
<div id="ref-Mohri-Hashimoto2024" class="csl-entry">
Mohri, C., &amp; Hashimoto, T. (2024). <em>Language models with conformal factuality guarantees</em>. <a href="https://arxiv.org/abs/2402.10978">https://arxiv.org/abs/2402.10978</a>
</div>
<div id="ref-Murphy2022" class="csl-entry">
Murphy, K. P. (2022). <em>Probabilistic machine learning: An introduction</em>. MIT Press. <a href="https://probml.github.io/pml-book/book1.html">https://probml.github.io/pml-book/book1.html</a>
</div>
<div id="ref-Neal1996" class="csl-entry">
Neal, R. M. (1996). <em>Bayesian learning for neural networks</em> (Vol. 118). Springer New York. <a href="https://link.springer.com/book/10.1007/978-1-4612-0745-0">https://link.springer.com/book/10.1007/978-1-4612-0745-0</a>
</div>
<div id="ref-Neal-Hinton1998" class="csl-entry">
Neal, R. M., &amp; Hinton, G. E. (1998). <em>Learning in graphical models</em> (M. I. Jordan, Ed.; pp. 355–368). Springer Dordrecht. <a href="https://link.springer.com/chapter/10.1007/978-94-011-5014-9_12">https://link.springer.com/chapter/10.1007/978-94-011-5014-9_12</a>
</div>
<div id="ref-Novello+2024" class="csl-entry">
Novello, P., Dalmau, J., &amp; Andeol, L. (2024). <em>Out-of-distribution detection should use conformal prediction (and vice-versa?)</em>. <a href="https://arxiv.org/abs/2403.11532">https://arxiv.org/abs/2403.11532</a>
</div>
<div id="ref-Nuzzo2014" class="csl-entry">
Nuzzo, R. (2014). Scientific method: Statistical errors. <em>Nature</em>, <em>506</em>(7487), 150–152. <a href="https://doi.org/10.1038/506150a">https://doi.org/10.1038/506150a</a>
</div>
<div id="ref-Hagen1991" class="csl-entry">
O’Hagan, A. (1991). Bayes–hermite quadrature. <em>Journal of Statistical Planning and Inference</em>, <em>29</em>(3), 245–260. https://doi.org/<a href="https://doi.org/10.1016/0378-3758(91)90002-V">https://doi.org/10.1016/0378-3758(91)90002-V</a>
</div>
<div id="ref-Papamarkou+2024" class="csl-entry">
Papamarkou, T., Skoularidou, M., Palla, K., Aitchison, L., Arbel, J., Dunson, D., Filippone, M., Fortuin, V., Hennig, P., Lobato, J. M. H., Hubin, A., Immer, A., Karaletsos, T., Khan, M. E., Kristiadi, A., Li, Y., Mandt, S., Nemeth, C., Osborne, M. A., … Zhang, R. (2024). <em>Position paper: Bayesian deep learning in the age of large-scale AI</em>. <a href="https://arxiv.org/abs/2402.00809">https://arxiv.org/abs/2402.00809</a>
</div>
<div id="ref-Rubin1984" class="csl-entry">
Rubin, D. B. (1984). <span class="nocase">Bayesianly Justifiable and Relevant Frequency Calculations for the Applied Statistician</span>. <em>The Annals of Statistics</em>, <em>12</em>(4), 1151–1172. <a href="https://doi.org/10.1214/aos/1176346785">https://doi.org/10.1214/aos/1176346785</a>
</div>
<div id="ref-Steinruecken+2015" class="csl-entry">
Steinruecken, C., Ghahramani, Z., &amp; MacKay, D. (2015). Improving PPM with dynamic parameter updates. <em>2015 Data Compression Conference</em>, 193–202. <a href="https://doi.org/10.1109/DCC.2015.77">https://doi.org/10.1109/DCC.2015.77</a>
</div>
<div id="ref-Trafimow-Marks2015" class="csl-entry">
Trafimow, D., &amp; Marks, M. (2015). Editorial. <em>Basic and Applied Social Psychology</em>, <em>37</em>(1), 1–2. <a href="https://doi.org/10.1080/01973533.2015.1012991">https://doi.org/10.1080/01973533.2015.1012991</a>
</div>
<div id="ref-Wamg+2024" class="csl-entry">
Wang, L., Zhang, X., Su, H., &amp; Zhu, J. (2024). A comprehensive survey of continual learning: Theory, method and application. <em>IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, 1–20. <a href="https://doi.org/10.1109/TPAMI.2024.3367329">https://doi.org/10.1109/TPAMI.2024.3367329</a>
</div>
<div id="ref-Wilson-Izmailov2020" class="csl-entry">
Wilson, A. G., &amp; Izmailov, P. (2020). Bayesian deep learning and a probabilistic perspective of generalization. <em>Proceedings of the 34th International Conference on Neural Information Processing Systems</em>. <a href="https://proceedings.neurips.cc/paper/2020/hash/322f62469c5e3c7dc3e58f5a4d1ea399-Abstract.html">https://proceedings.neurips.cc/paper/2020/hash/322f62469c5e3c7dc3e58f5a4d1ea399-Abstract.html</a>
</div>
<div id="ref-Zhou+2023" class="csl-entry">
Zhou, C., Liu, P., Xu, P., Iyer, S., Sun, J., Mao, Y., Ma, X., Efrat, A., Yu, P., YU, L., Zhang, S., Ghosh, G., Lewis, M., Zettlemoyer, L., &amp; Levy, O. (2023). <span>LIMA</span>: Less is more for alignment. <em>Thirty-Seventh Conference on Neural Information Processing Systems</em>. <a href="https://openreview.net/forum?id=KBMOKmX2he">https://openreview.net/forum?id=KBMOKmX2he</a>
</div>
<div id="ref-平石-中村2022" class="csl-entry">
平石界, &amp; 中村大輝. (2022). 心理学における再現性危機の10年―危機は克服されたのか，克服され得るのか―. <em>科学哲学</em>, <em>54</em>(2), 27–50. <a href="https://www.jstage.jst.go.jp/article/jpssj/54/2/54_27/_article/-char/ja">https://www.jstage.jst.go.jp/article/jpssj/54/2/54_27/_article/-char/ja</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>これは <a href="https://www.microsoft.com/en-us/research/project/guidelines-for-human-ai-interaction/">Human-AI interaction におけるガイドライン</a> <span class="citation" data-cites="Amershi+2019">(Amershi et al., 2019)</span>, <span class="citation" data-cites="Bensal+2019">(Bansal et al., 2019)</span> でも明確にされている点である．この方向への試みの代表がベイズ機械学習，というわけではないが，筆者はベイズ機械学習の興隆は信頼のおける AI システムの構築にための極めて盤石な土台になるだろうと論じる．↩︎</p></li>
<li id="fn2"><p>本稿執筆後に，ほとんど同じ論調を，深層学習や基盤モデルを中心に，遥かに明瞭に述べた論文 <span class="citation" data-cites="Papamarkou+2024">(Papamarkou et al., 2024)</span> を見つけたので，賢明な読者はぜひこちらを参考にしていただきたい．↩︎</p></li>
<li id="fn3"><p><span class="citation" data-cites="Broderick+2023">(Broderick et al., 2023, p. 2)</span> など．↩︎</p></li>
<li id="fn4"><p>この違いが「過学習」という現象に見舞われるかの違いでもある．“Fortunately, Bayesian approaches are not prone to this kind of overfitting since they average over, rather than fit, the parameters” <span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 454)</span>．↩︎</p></li>
<li id="fn5"><p>“for Bayesian researchers the main computational problem is integration, whereas for much of the rest of the community the focus is on optimization of model parameters.” <span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 454)</span>．このように，その用いる手法も鮮やかに対照的に見えるが，積分は変分近似を通じて最適化問題としても解けるし，Lengevin 法や HMC などの最適化手法は積分問題を解ける．↩︎</p></li>
<li id="fn6"><p><span class="citation" data-cites="Broderick+2023">(Broderick et al., 2023)</span> が極めて説得的にこの点を指摘している．↩︎</p></li>
<li id="fn7"><p>合理的な信念の度合い (degree of belief) は確率の公理を満たす必要がある，という主張は <a href="https://en.wikipedia.org/wiki/Cox%27s_theorem">Cox の名前でも呼ばれる</a>．この点から，Bayes の定理は，帰納的推論の確率論的な拡張だとも捉えられる．“This justifies the use of subjective Bayesian probabilistic representations in artificial intelligence.” “Probabilistic modelling also has some conceptual advantages over alternatives because it is a normative theory for learning in artificially intelligent systems.” <span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 453)</span>．↩︎</p></li>
<li id="fn8"><p>現状，日本にてベイズ機械学習を専業として研究を進めている人は <a href="https://emtiyaz.github.io/">Emtiyaz Khan</a> に限ると思われる．<span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 452)</span> でも “Probabilistic approaches have only recently become a mainstream approach to artificial intellifence, robotics, and machine learning.” と述べられている．↩︎</p></li>
<li id="fn9"><p>“The uncertainty quantification of prediction models (e.g., neural networks) is crucial for their adoption in many robotics applications. This is arguably as important as making accurate predictions, especially for safety-critical applications such as self-driving cars.” <span class="citation" data-cites="Chen+2023">(Chen et al., 2023)</span>．↩︎</p></li>
<li id="fn10"><p>モデルの予測結果に不確実性の定量化が伴われていたならば，モデルを信用出来ない場面で意思決定者がこれを信用したため責任があるのか，使用者には非難可能性がないのか，モデル設計者に過失があったと言えるのかの議論に，足場を与えることが出来るだろう．↩︎</p></li>
<li id="fn11"><p><span class="citation" data-cites="Gal-Ghahramani2016">(Gal &amp; Ghahramani, 2016)</span> も参照．↩︎</p></li>
<li id="fn12"><p>心理学においては「再現性問題が大きく注目される大きな契機となった「超能力論文」が出版されたのが 2011 年である」 <span class="citation" data-cites="平石-中村2022">(平石界 &amp; 中村大輝, 2022)</span> ようである．計量経済学における <strong>信頼性革命</strong> <span class="citation" data-cites="Angrist-Pischke2010">(Angrist &amp; Pischke, 2010)</span> は，再現性の危機の，もう一つの革新的な解決法である．↩︎</p></li>
<li id="fn13"><p>「それでは，信頼区間は不確実性の正しい定量化を与えないではないか！」ということになるが，その通りなのである．<img src="https://latex.codecogs.com/png.latex?P">-値を計算する過程とは，帰無仮説で条件付けているだけであり，データの関数でもある．<img src="https://latex.codecogs.com/png.latex?P">-値の確率変数としての分散が大きいほど，何回か同じ実験を繰り返せばすぐに小さな <img src="https://latex.codecogs.com/png.latex?P">-値が得られることになる．これは <a href="../../../posts/2023/数理法務/法律家のための統計数理2.html#sec-Bayes-problem"><strong>基準確率の誤謬</strong></a> と似ている．↩︎</p></li>
<li id="fn14"><p>“Confidence intervals suffer from an inverse inference problem that is not very different from that suffered by the NHSTP. In the NHSTP, the problem is in traversing the distance from the probability of the finding, given the null hypothesis, to the probability of the null hypothesis, given the finding.” <span class="citation" data-cites="Trafimow-Marks2015">(Trafimow &amp; Marks, 2015)</span>↩︎</p></li>
<li id="fn15"><p><span class="citation" data-cites="Nuzzo2014">(Nuzzo, 2014)</span> には，Fisher が最初に用いてから，Neyman-Pearson 理論がこれを排除したものの，コミュニティが <img src="https://latex.codecogs.com/png.latex?P">-値を誤解して都合の良いように利用するようになるまでに至った歴史が説明されている．↩︎</p></li>
<li id="fn16"><p><span class="citation" data-cites="Murphy2022">(Murphy, 2022, p. 201)</span> の議論も参照．↩︎</p></li>
<li id="fn17"><p><span class="citation" data-cites="Efron1986">(Efron, 1986)</span> も示唆深い．↩︎</p></li>
<li id="fn18"><p><span class="citation" data-cites="Mohri-Hashimoto2024">(Mohri &amp; Hashimoto, 2024)</span>, <span class="citation" data-cites="Papamarkou+2024">(Papamarkou et al., 2024, p. 3)</span> 2.1節 なども指摘している．↩︎</p></li>
<li id="fn19"><p><span class="citation" data-cites="Novello+2024">(Novello et al., 2024)</span> では out-of-distribution detection, <span class="citation" data-cites="Mohri-Hashimoto2024">(Mohri &amp; Hashimoto, 2024)</span> は LLM の hallucination への応用．↩︎</p></li>
<li id="fn20"><p>「筆者は，conformal prediction などの post-hoc な手法は，便利かも知れないが，「信頼区間」や「<img src="https://latex.codecogs.com/png.latex?P">-値」のような側面（第 2.3 節）も併せ持つのではないかと危惧しながら見ている．」と当初は書いていたが，どうもそう簡単な話ではないようである．<span class="citation" data-cites="Papamarkou+2024">(Papamarkou et al., 2024)</span> を読んで思った．↩︎</p></li>
<li id="fn21"><p><span class="citation" data-cites="Papamarkou+2024">(Papamarkou et al., 2024, p. 5)</span> 3.4節．↩︎</p></li>
<li id="fn22"><p><span class="citation" data-cites="Wamg+2024">(Wang et al., 2024)</span> が最新のサーベイであるようだ．↩︎</p></li>
<li id="fn23"><p>Philipp Hennig <a href="https://youtu.be/TTo2kjrAuTo?si=QD_pqMkdLOl52OsR&amp;t=3703"><em>Probabilistic ML - Lecture 1 - Introduction</em></a> “Statistical Learning Theory is about Bayesian Reasoning when you don’t say out aloud what the prior is.”↩︎</p></li>
<li id="fn24"><p>これを <a href="https://en.wikipedia.org/wiki/Marginal_likelihood"><strong>証拠</strong></a> (model evidence) ともいう．↩︎</p></li>
<li id="fn25"><p>事前分布として非有限な測度を用いた場合など，例外もある．↩︎</p></li>
<li id="fn26"><p>“most conventional optimization-based machine-learning approaches have probabilistic analogues that handle uncertainty in a more principled manner.” <span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 458)</span>．↩︎</p></li>
<li id="fn27"><p><span class="citation" data-cites="Neal-Hinton1998">(Neal &amp; Hinton, 1998)</span> など．↩︎</p></li>
<li id="fn28"><p><span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 458)</span> はこれを <strong>モデルの属人化</strong> (personalization of models) と呼んでいる．↩︎</p></li>
<li id="fn29"><p><span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 453)</span> “probabilistic programming offers an elegant way of generalizing graphical models, allowing a much richer representation of models.”．↩︎</p></li>
<li id="fn30"><p>“More generally, Bayesian optimization is a special case of Bayesian numerical computation, which is re-emerging as a very active area of research, and includes topics such as solving ordinary differential equations and numerical integration.” <span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 456)</span>．↩︎</p></li>
<li id="fn31"><p>“All commonly used lossless data compression algorithms (for example, <code>gzip</code>) can be viewed as probabilistic models of sequences of symbols.” <span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 456)</span>．↩︎</p></li>
<li id="fn32"><p><span class="citation" data-cites="Steinruecken+2015">(Steinruecken et al., 2015)</span> は記号列に対するノンパラメトリックモデルを改良することで，データ圧縮アルゴリズム <code>PPM</code> を改良した良い例である．↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Bayesian</category>
  <category>AI</category>
  <category>Opinion</category>
  <guid>https://162348.github.io/posts/2024/AI/BAI.html</guid>
  <pubDate>Tue, 19 Mar 2024 15:00:00 GMT</pubDate>
</item>
</channel>
</rss>
